---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/type.20mismatch.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html">type mismatch</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="159492847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492847">(Feb 27 2019 at 09:03)</a>:</h4>
<div class="codehilite"><pre><span></span>has type
  @is_ring_hom.{u (max v u)} R (Π (b : ι), @ideal.quotient.{u} R _inst_1 (f b)) (@comm_ring.to_ring.{u} R _inst_1)
    (@pi.ring.{v u} ι (λ (b : ι), @ideal.quotient.{u} R _inst_1 (f b))
       (λ (i : ι),
          @comm_ring.to_ring.{u} (@ideal.quotient.{u} R _inst_1 (f i)) (@ideal.quotient.comm_ring.{u} R _inst_1 (f i))))
    (λ (x : R) (b : ι), @ideal.quotient.mk.{u} R _inst_1 (f b) x)
but is expected to have type
  @is_ring_hom.{u (max v u)} R (Π (i : ι), @ideal.quotient.{u} R _inst_1 (f i)) (@comm_ring.to_ring.{u} R _inst_1)
    (@comm_ring.to_ring.{(max v u)} (Π (i : ι), @ideal.quotient.{u} R _inst_1 (f i))
       (@pi.comm_ring.{v u} ι (λ (i : ι), @ideal.quotient.{u} R _inst_1 (f i))
          (λ (i : ι), @ideal.quotient.comm_ring.{u} R _inst_1 (f i))))
    (λ (r : R) (i : ι), @ideal.quotient.mk.{u} R _inst_1 (f i) r)
</pre></div>



<a name="159492896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492896">(Feb 27 2019 at 09:04)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="k">have</span> <span class="o">(</span><span class="bp">@</span><span class="n">pi</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="o">{</span><span class="n">v</span> <span class="n">u</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">b</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span>
          <span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))))</span>
<span class="bp">=</span>
<span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{(</span><span class="n">max</span> <span class="n">v</span> <span class="n">u</span><span class="o">)}</span> <span class="o">(</span><span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">v</span> <span class="n">u</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))))</span>
<span class="o">,</span> <span class="k">from</span> <span class="n">rfl</span><span class="o">,</span>
</pre></div>


<p>but this works</p>



<a name="159492905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492905">(Feb 27 2019 at 09:04)</a>:</h4>
<p>Is this thread supposed to be comprehensible to anyone but you?</p>



<a name="159492923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492923">(Feb 27 2019 at 09:05)</a>:</h4>
<div class="codehilite"><pre><span></span>type mismatch at application
  quotient.lift (⨅ (i : ι), f i) (λ (r : R) (i : ι), quotient.mk (f i) r)
term
  pi.is_ring_hom_pi (λ (i : ι) (r : R), quotient.mk (f i) r)
has type
  is_ring_hom (λ (x : R) (b : ι), quotient.mk (f b) x)
but is expected to have type
  is_ring_hom (λ (r : R) (i : ι), quotient.mk (f i) r)
</pre></div>



<a name="159492926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492926">(Feb 27 2019 at 09:05)</a>:</h4>
<p>is this more comprehensible?</p>



<a name="159492932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492932">(Feb 27 2019 at 09:05)</a>:</h4>
<p>Kenny should have a private stream all for himself</p>



<a name="159492943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492943">(Feb 27 2019 at 09:05)</a>:</h4>
<p>What is your question Kenny? I don't think that other people are going to be carefully scanning your output of <code>pp.all true</code>.</p>



<a name="159492983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492983">(Feb 27 2019 at 09:06)</a>:</h4>
<p>well, my question is that, clearly they are equal!</p>



<a name="159492991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492991">(Feb 27 2019 at 09:06)</a>:</h4>
<p>Is that a question?</p>



<a name="159492992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492992">(Feb 27 2019 at 09:06)</a>:</h4>
<p>Well Lean says they're not so they're not.</p>



<a name="159492998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159492998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159492998">(Feb 27 2019 at 09:06)</a>:</h4>
<p>But because we have no way of reproducing the error, how can anyone else help?</p>



<a name="159493000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493000">(Feb 27 2019 at 09:06)</a>:</h4>
<p>then the question is, why does Lean not know that they are equal?</p>



<a name="159493006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493006">(Feb 27 2019 at 09:06)</a>:</h4>
<p>you're the only person who can answer that until you post a lot more context</p>



<a name="159493010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493010">(Feb 27 2019 at 09:06)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">pi_instances</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal_operations</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span>

<span class="kn">open</span> <span class="n">lattice</span>

<span class="kn">namespace</span> <span class="n">ideal</span>

<span class="n">def</span> <span class="n">to_prod</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="bp">→</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="o">:=</span>
<span class="bp">@@</span><span class="n">quotient</span><span class="bp">.</span><span class="n">lift</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span> <span class="n">i</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span>
  <span class="o">(</span><span class="n">pi</span><span class="bp">.</span><span class="n">is_ring_hom_pi</span> <span class="bp">_</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="n">r</span><span class="o">))</span>
  <span class="bp">_</span>

<span class="kn">end</span> <span class="n">ideal</span>
</pre></div>



<a name="159493022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493022">(Feb 27 2019 at 09:07)</a>:</h4>
<p>We can sympathize, this is probably what we should do</p>



<a name="159493030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493030">(Feb 27 2019 at 09:07)</a>:</h4>
<p>After his last post we can now try to help :-)</p>



<a name="159493091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493091">(Feb 27 2019 at 09:08)</a>:</h4>
<p>So they're not the same because the implicit terms are different.</p>



<a name="159493189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493189" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493189">(Feb 27 2019 at 09:10)</a>:</h4>
<p>but they're defeq</p>



<a name="159493194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493194">(Feb 27 2019 at 09:10)</a>:</h4>
<p>as seen in my second post</p>



<a name="159493261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493261">(Feb 27 2019 at 09:12)</a>:</h4>
<p>Indeed, you have now explained the question coherently.</p>



<a name="159493278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493278">(Feb 27 2019 at 09:13)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">pi_instances</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal_operations</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span>

<span class="kn">open</span> <span class="n">lattice</span>

<span class="kn">namespace</span> <span class="n">ideal</span>

<span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">all</span> <span class="n">true</span>
<span class="n">def</span> <span class="n">to_prod</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="bp">→</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="o">:</span> <span class="bp">@</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">v</span> <span class="n">u</span><span class="o">)}</span> <span class="n">R</span> <span class="o">(</span><span class="bp">Π</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">b</span><span class="o">))</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">pi</span><span class="bp">.</span><span class="n">ring</span><span class="bp">.</span><span class="o">{</span><span class="n">v</span> <span class="n">u</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">b</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span>
          <span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))))</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">b</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span>
    <span class="bp">=</span>
<span class="bp">@</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">v</span> <span class="n">u</span><span class="o">)}</span> <span class="n">R</span> <span class="o">(</span><span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{(</span><span class="n">max</span> <span class="n">v</span> <span class="n">u</span><span class="o">)}</span> <span class="o">(</span><span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">v</span> <span class="n">u</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))))</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">,</span>

<span class="n">exact</span> <span class="bp">@@</span><span class="n">quotient</span><span class="bp">.</span><span class="n">lift</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span> <span class="n">i</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span>
  <span class="o">(</span><span class="n">pi</span><span class="bp">.</span><span class="n">is_ring_hom_pi</span> <span class="bp">_</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="n">r</span><span class="o">))</span>
  <span class="bp">_</span>
  <span class="c">/-</span><span class="cm"></span>
<span class="cm">  type mismatch at application</span>
<span class="cm">  @ideal.quotient.lift.{u (max v u)} R (Π (i : ι), @ideal.quotient.{u} R _inst_1 (f i)) _inst_1</span>
<span class="cm">    (@pi.comm_ring.{v u} ι (λ (i : ι), @ideal.quotient.{u} R _inst_1 (f i))</span>
<span class="cm">       (λ (i : ι), @ideal.quotient.comm_ring.{u} R _inst_1 (f i)))</span>
<span class="cm">    (@lattice.infi.{u v+1} (@ideal.{u} R _inst_1) ι</span>
<span class="cm">       (@submodule.lattice.has_Inf.{u u} R R (@comm_ring.to_ring.{u} R _inst_1)</span>
<span class="cm">          (@ring.to_add_comm_group.{u} R (@comm_ring.to_ring.{u} R _inst_1))</span>
<span class="cm">          (@ring.to_module.{u} R (@comm_ring.to_ring.{u} R _inst_1)))</span>
<span class="cm">       (λ (i : ι), f i))</span>
<span class="cm">    (λ (r : R) (i : ι), @ideal.quotient.mk.{u} R _inst_1 (f i) r)</span>
<span class="cm">    (@pi.is_ring_hom_pi.{v u u} ι (λ (a : ι), @ideal.quotient.{u} R _inst_1 (f a))</span>
<span class="cm">       (λ (i : ι),</span>
<span class="cm">          @comm_ring.to_ring.{u} (@ideal.quotient.{u} R _inst_1 (f i)) (@ideal.quotient.comm_ring.{u} R _inst_1 (f i)))</span>
<span class="cm">       R</span>
<span class="cm">       (@comm_ring.to_ring.{u} R _inst_1)</span>
<span class="cm">       (λ (i : ι) (r : R), @ideal.quotient.mk.{u} R _inst_1 (f i) r)</span>
<span class="cm">       (λ (a : ι), @ideal.quotient.is_ring_hom_mk.{u} R _inst_1 (f a)))</span>
<span class="cm">term</span>
<span class="cm">  @pi.is_ring_hom_pi.{v u u} ι (λ (a : ι), @ideal.quotient.{u} R _inst_1 (f a))</span>
<span class="cm">    (λ (i : ι),</span>
<span class="cm">       @comm_ring.to_ring.{u} (@ideal.quotient.{u} R _inst_1 (f i)) (@ideal.quotient.comm_ring.{u} R _inst_1 (f i)))</span>
<span class="cm">    R</span>
<span class="cm">    (@comm_ring.to_ring.{u} R _inst_1)</span>
<span class="cm">    (λ (i : ι) (r : R), @ideal.quotient.mk.{u} R _inst_1 (f i) r)</span>
<span class="cm">    (λ (a : ι), @ideal.quotient.is_ring_hom_mk.{u} R _inst_1 (f a))</span>
<span class="cm">has type</span>
<span class="cm">  @is_ring_hom.{u (max v u)} R (Π (b : ι), @ideal.quotient.{u} R _inst_1 (f b)) (@comm_ring.to_ring.{u} R _inst_1)</span>
<span class="cm">    (@pi.ring.{v u} ι (λ (b : ι), @ideal.quotient.{u} R _inst_1 (f b))</span>
<span class="cm">       (λ (i : ι),</span>
<span class="cm">          @comm_ring.to_ring.{u} (@ideal.quotient.{u} R _inst_1 (f i)) (@ideal.quotient.comm_ring.{u} R _inst_1 (f i))))</span>
<span class="cm">    (λ (x : R) (b : ι), @ideal.quotient.mk.{u} R _inst_1 (f b) x)</span>
<span class="cm">but is expected to have type</span>
<span class="cm">  @is_ring_hom.{u (max v u)} R (Π (i : ι), @ideal.quotient.{u} R _inst_1 (f i)) (@comm_ring.to_ring.{u} R _inst_1)</span>
<span class="cm">    (@comm_ring.to_ring.{(max v u)} (Π (i : ι), @ideal.quotient.{u} R _inst_1 (f i))</span>
<span class="cm">       (@pi.comm_ring.{v u} ι (λ (i : ι), @ideal.quotient.{u} R _inst_1 (f i))</span>
<span class="cm">          (λ (i : ι), @ideal.quotient.comm_ring.{u} R _inst_1 (f i))))</span>
<span class="cm">    (λ (r : R) (i : ι), @ideal.quotient.mk.{u} R _inst_1 (f i) r)</span>
<span class="cm">    -/</span>

<span class="kn">end</span>

<span class="kn">end</span> <span class="n">ideal</span>
</pre></div>



<a name="159493301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493301">(Feb 27 2019 at 09:13)</a>:</h4>
<p>I recommend you fill in the <code>_</code></p>



<a name="159493361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493361">(Feb 27 2019 at 09:14)</a>:</h4>
<p>wat</p>



<a name="159493368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493368">(Feb 27 2019 at 09:14)</a>:</h4>
<p>but what do I know</p>



<a name="159493378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493378">(Feb 27 2019 at 09:15)</a>:</h4>
<p>Maybe some elaboration is taking place in the wrong order or some such nonsense</p>



<a name="159493485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493485">(Feb 27 2019 at 09:17)</a>:</h4>
<p>Do you understand why</p>
<div class="codehilite"><pre><span></span><span class="n">exact</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">lift</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">v</span> <span class="n">u</span><span class="o">)}</span> <span class="n">R</span> <span class="o">(</span><span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">_</span><span class="n">inst_1</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">v</span> <span class="n">u</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">lattice</span><span class="bp">.</span><span class="n">infi</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="n">v</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span> <span class="n">ι</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">submodule</span><span class="bp">.</span><span class="n">lattice</span><span class="bp">.</span><span class="n">has_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">ring</span><span class="bp">.</span><span class="n">to_add_comm_group</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">ring</span><span class="bp">.</span><span class="n">to_module</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">pi</span><span class="bp">.</span><span class="n">is_ring_hom_pi</span><span class="bp">.</span><span class="o">{</span><span class="n">v</span> <span class="n">u</span> <span class="n">u</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span>
          <span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span>
       <span class="n">R</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">is_ring_hom_mk</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span><span class="o">)))</span>
</pre></div>


<p>doesn't work? I have to go and give a lecture on p-adic geometry so I can't think about this any more but this would be one way of trying to fill in the <code>_</code>s to see if that's the issue.</p>



<a name="159493491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493491">(Feb 27 2019 at 09:17)</a>:</h4>
<p>i.e. look at what the term fully elaborates to and try that instead. I just must have failed somehow.</p>



<a name="159493506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493506">(Feb 27 2019 at 09:17)</a>:</h4>
<p>[my error was "you got it wrong" not "these are not defeq"]</p>



<a name="159493907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159493907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159493907">(Feb 27 2019 at 09:24)</a>:</h4>
<p>finally this "worked":</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">pi_instances</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal_operations</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span>

<span class="kn">open</span> <span class="n">lattice</span>

<span class="kn">namespace</span> <span class="n">ideal</span>

<span class="n">def</span> <span class="n">to_pi</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">mk</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="n">r</span>

<span class="kn">instance</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">to_pi</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">pi</span><span class="bp">.</span><span class="n">is_ring_hom_pi</span> <span class="bp">_</span>

<span class="n">def</span> <span class="n">to_prod</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="bp">→</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">lift</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="o">(</span><span class="n">max</span> <span class="n">v</span> <span class="n">u</span><span class="o">)}</span> <span class="n">R</span> <span class="o">(</span><span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">_</span><span class="n">inst_1</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">v</span> <span class="n">u</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">comm_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">lattice</span><span class="bp">.</span><span class="n">infi</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="n">v</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span> <span class="n">ι</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">submodule</span><span class="bp">.</span><span class="n">lattice</span><span class="bp">.</span><span class="n">has_Inf</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">ring</span><span class="bp">.</span><span class="n">to_add_comm_group</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">ring</span><span class="bp">.</span><span class="n">to_module</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">f</span> <span class="n">i</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">to_pi</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="n">v</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">ι</span> <span class="n">f</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="n">v</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="n">ι</span> <span class="n">f</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span> <span class="n">hr</span><span class="o">,</span> <span class="n">funext</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">eq_zero_iff_mem</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">mem_Inf</span><span class="bp">.</span><span class="mi">1</span> <span class="n">hr</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">)</span>

<span class="kn">end</span> <span class="n">ideal</span>
</pre></div>



<a name="159494017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159494017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159494017">(Feb 27 2019 at 09:26)</a>:</h4>
<p>minimzed to:</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">to_prod</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="bp">→</span> <span class="bp">Π</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">quotient</span> <span class="o">:=</span>
<span class="bp">@@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">quotient</span><span class="bp">.</span><span class="n">lift</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="err">⨅</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">ideal</span><span class="bp">.</span><span class="n">to_pi</span> <span class="n">f</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span><span class="bp">.</span><span class="n">is_ring_hom</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span> <span class="n">v</span><span class="o">}</span> <span class="n">R</span> <span class="bp">_</span> <span class="n">ι</span> <span class="n">f</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span> <span class="n">hr</span><span class="o">,</span> <span class="n">funext</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">quotient</span><span class="bp">.</span><span class="n">eq_zero_iff_mem</span><span class="bp">.</span><span class="mi">2</span> <span class="err">$</span> <span class="n">mem_Inf</span><span class="bp">.</span><span class="mi">1</span> <span class="n">hr</span> <span class="bp">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">)</span>
</pre></div>



<a name="159494033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159494033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159494033">(Feb 27 2019 at 09:26)</a>:</h4>
<p>in <code>(@ideal.is_ring_hom.{u v} R _ ι f)</code>, turning <code>ι</code> into underscore creates the error</p>



<a name="159494067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159494067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159494067">(Feb 27 2019 at 09:27)</a>:</h4>
<p>the <code>R</code> is also essential</p>



<a name="159516159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159516159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159516159">(Feb 27 2019 at 14:04)</a>:</h4>
<p>So it's some elaborator nonsense, or do you think it's a bug?</p>



<a name="159516186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159516186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159516186">(Feb 27 2019 at 14:04)</a>:</h4>
<p>Let's try to debug it!</p>



<a name="159516253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159516253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159516253">(Feb 27 2019 at 14:05)</a>:</h4>
<p>Sebastian once told us some set_option to see the rfl machine trying to prove rfl</p>



<a name="159516287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/159516287" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#159516287">(Feb 27 2019 at 14:05)</a>:</h4>
<p>I think it was in the thread where he wrote "got into office" "checks Zulip" "leaves office again"</p>



<a name="208688606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/208688606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#208688606">(Sep 01 2020 at 13:44)</a>:</h4>
<p>I am trying to show that the principal fractional ideals form a subgroup of the group of fractional ideals.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">finite_dimensional</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">field</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">subring</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">integral_closure</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">fractional_ideal</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">algebra</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">algebraic</span>

<span class="kn">open</span> <span class="n">function</span>
<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">big_operators</span>

<span class="n">class</span> <span class="n">number_field</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
   <span class="o">(</span><span class="n">fld</span> <span class="o">:</span> <span class="n">field</span> <span class="n">K</span><span class="o">)</span>
   <span class="o">(</span><span class="n">alg</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">ℚ</span> <span class="n">K</span><span class="o">)</span>
   <span class="o">(</span><span class="n">fd</span> <span class="o">:</span> <span class="n">finite_dimensional</span> <span class="n">ℚ</span> <span class="n">K</span><span class="o">)</span>

<span class="n">def</span> <span class="n">number_ring</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">number_field</span> <span class="n">K</span><span class="o">]</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">integral_closure</span> <span class="bp">ℤ</span> <span class="n">K</span> <span class="bp">_</span> <span class="o">(</span><span class="bp">@</span><span class="n">field</span><span class="bp">.</span><span class="n">to_comm_ring</span> <span class="n">K</span> <span class="bp">_</span><span class="n">inst_1</span><span class="bp">.</span><span class="n">fld</span><span class="o">)</span> <span class="bp">_</span>

<span class="n">noncomputable</span> <span class="n">theory</span>
<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kn">open</span> <span class="n">finite_dimensional</span>
<span class="kn">namespace</span> <span class="n">number_field</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">number_field</span> <span class="n">K</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">[</span><span class="n">g</span> <span class="o">:</span> <span class="n">fraction_map</span> <span class="o">(</span><span class="n">number_ring</span> <span class="n">K</span><span class="o">)</span> <span class="n">K</span> <span class="o">]</span>

<span class="n">def</span> <span class="n">principal_fractional_ideal</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">P</span> <span class="o">:</span> <span class="n">ring</span><span class="bp">.</span><span class="n">fractional_ideal</span> <span class="n">g</span> <span class="bp">//</span> <span class="bp">∃</span> <span class="n">a</span> <span class="o">:</span> <span class="o">(</span><span class="n">number_ring</span> <span class="n">K</span><span class="o">),</span> <span class="n">submodule</span><span class="bp">.</span><span class="n">is_principal</span> <span class="n">P</span><span class="bp">.</span><span class="mi">1</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="n">is_group</span> <span class="o">:</span> <span class="n">group</span> <span class="o">(</span><span class="n">ring</span><span class="bp">.</span><span class="n">fractional_ideal</span> <span class="n">g</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>

<span class="kn">instance</span> <span class="n">is_subgroup</span> <span class="o">:</span> <span class="n">subgroup</span> <span class="o">(</span><span class="n">ring</span><span class="bp">.</span><span class="n">fractional_ideal</span> <span class="n">g</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">use</span> <span class="o">(</span><span class="n">principal_fractional_ideal</span> <span class="n">g</span><span class="o">),</span>
<span class="kn">end</span>
</code></pre></div>


<p>The last proof gives me the error</p>
<div class="codehilite"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">principal_fractional_ideal</span> <span class="n">g</span>
<span class="n">term</span>
  <span class="n">g</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">fraction_map</span> <span class="err">↥</span><span class="o">(</span><span class="n">number_ring</span> <span class="n">K</span><span class="o">)</span> <span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="kt">Type</span> <span class="err">?</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="err">?</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">number_field</span> <span class="n">K</span><span class="o">,</span>
<span class="n">g</span> <span class="o">:</span> <span class="n">fraction_map</span> <span class="err">↥</span><span class="o">(</span><span class="n">number_ring</span> <span class="n">K</span><span class="o">)</span> <span class="n">K</span>
<span class="err">⊢</span> <span class="n">subgroup</span> <span class="o">(</span><span class="n">ring</span><span class="bp">.</span><span class="n">fractional_ideal</span> <span class="n">g</span><span class="o">)</span>
</code></pre></div>


<p>Any help is appreciated, thank you!</p>



<a name="208689405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/208689405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#208689405">(Sep 01 2020 at 13:50)</a>:</h4>
<p>Sounds like you're missing an underscore before the g.</p>



<a name="208690342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/208690342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#208690342">(Sep 01 2020 at 13:57)</a>:</h4>
<p>Your code is not compiling for me :-/</p>



<a name="208691520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/208691520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#208691520">(Sep 01 2020 at 14:06)</a>:</h4>
<p>Okay, looks like there were a bunch of issues. <br>
Here's a hacked together fix.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">finite_dimensional</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">ideal</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">field</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">subring</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">integral_closure</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">fractional_ideal</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">algebra</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">algebraic</span>

<span class="kn">open</span> <span class="n">function</span>
<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">big_operators</span>

<span class="n">class</span> <span class="n">number_field</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
   <span class="o">(</span><span class="n">fld</span> <span class="o">:</span> <span class="n">field</span> <span class="n">K</span><span class="o">)</span>
   <span class="o">(</span><span class="n">alg</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">ℚ</span> <span class="n">K</span><span class="o">)</span>
   <span class="o">(</span><span class="n">fd</span> <span class="o">:</span> <span class="n">finite_dimensional</span> <span class="n">ℚ</span> <span class="n">K</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">number_field</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">number_field</span> <span class="n">K</span><span class="o">]</span>
<span class="kn">instance</span> <span class="o">:</span> <span class="n">field</span> <span class="n">K</span> <span class="o">:=</span> <span class="n">number_field</span><span class="bp">.</span><span class="n">fld</span>
<span class="kn">instance</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">ℚ</span> <span class="n">K</span> <span class="o">:=</span> <span class="n">number_field</span><span class="bp">.</span><span class="n">alg</span>
<span class="kn">instance</span> <span class="o">:</span> <span class="n">finite_dimensional</span> <span class="n">ℚ</span> <span class="n">K</span> <span class="o">:=</span> <span class="n">number_field</span><span class="bp">.</span><span class="n">fd</span>
<span class="kn">end</span> <span class="n">number_field</span>

<span class="n">def</span> <span class="n">number_ring</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">number_field</span> <span class="n">K</span><span class="o">]</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">integral_closure</span> <span class="bp">ℤ</span> <span class="n">K</span> <span class="bp">_</span> <span class="o">(</span><span class="bp">@</span><span class="n">field</span><span class="bp">.</span><span class="n">to_comm_ring</span> <span class="n">K</span> <span class="bp">_</span><span class="n">inst_1</span><span class="bp">.</span><span class="n">fld</span><span class="o">)</span> <span class="bp">_</span>

<span class="n">noncomputable</span> <span class="n">theory</span>
<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kn">open</span> <span class="n">finite_dimensional</span>
<span class="kn">namespace</span> <span class="n">number_field</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">number_field</span> <span class="n">K</span><span class="o">]</span>
<span class="kn">variables</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">fraction_map</span> <span class="o">(</span><span class="n">number_ring</span> <span class="n">K</span><span class="o">)</span> <span class="n">K</span><span class="o">)</span>

<span class="n">def</span> <span class="n">principal_fractional_ideal</span> <span class="o">:=</span> <span class="o">{</span> <span class="n">P</span> <span class="o">:</span> <span class="n">ring</span><span class="bp">.</span><span class="n">fractional_ideal</span> <span class="n">g</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="o">:</span> <span class="o">(</span><span class="n">number_ring</span> <span class="n">K</span><span class="o">),</span> <span class="n">submodule</span><span class="bp">.</span><span class="n">is_principal</span> <span class="n">P</span><span class="bp">.</span><span class="mi">1</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="n">is_group</span> <span class="o">:</span> <span class="n">group</span> <span class="o">(</span><span class="n">ring</span><span class="bp">.</span><span class="n">fractional_ideal</span> <span class="n">g</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>

<span class="bp">#</span><span class="kn">check</span> <span class="n">principal_fractional_ideal</span>

<span class="kn">instance</span> <span class="n">is_subgroup</span> <span class="o">:</span> <span class="n">subgroup</span> <span class="o">(</span><span class="n">ring</span><span class="bp">.</span><span class="n">fractional_ideal</span> <span class="n">g</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">carrier</span> <span class="o">:=</span> <span class="n">principal_fractional_ideal</span> <span class="bp">_</span> <span class="n">g</span><span class="o">,</span>
  <span class="n">one_mem&#39;</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span>
  <span class="n">mul_mem&#39;</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span>
  <span class="n">inv_mem&#39;</span> <span class="o">:=</span> <span class="bp">_</span> <span class="o">}</span>
</code></pre></div>



<a name="208691665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/208691665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#208691665">(Sep 01 2020 at 14:07)</a>:</h4>
<p>Note that <code>subgroup</code> takes a set as its carrier, whereas you defined a <code>principal_fractional_ideal</code> as a subtype.<br>
Also, the <code>field</code>, <code>algebra</code>, etc. instances were not recognized since you didn't extend these classes in your definition of number field.</p>



<a name="208707478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/208707478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#208707478">(Sep 01 2020 at 15:51)</a>:</h4>
<p>Ah, I see.  It seems like the _ is K. So essentially I needed g to be explicit. Thank you!</p>



<a name="208707707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/208707707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#208707707">(Sep 01 2020 at 15:53)</a>:</h4>
<p>You need to make <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> implicit :) (lean will figure out <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>)</p>



<a name="208709639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/208709639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#208709639">(Sep 01 2020 at 16:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/113489-new-members/topic/type.20mismatch/near/208707707">said</a>:</p>
<blockquote>
<p>You need to make <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> implicit :) (lean will figure out <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">K</span></span></span></span> from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>)</p>
</blockquote>
<p>Ah alright, thank you!</p>



<a name="242168539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242168539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242168539">(Jun 10 2021 at 07:28)</a>:</h4>
<p>Why is there a type mismatch problem in the following code?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">constants</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>

<span class="kn">section</span>

<span class="kd">parameter</span>  <span class="n">transr</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">},</span> <span class="n">r</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">r</span> <span class="n">y</span> <span class="n">z</span> <span class="bp">→</span> <span class="n">r</span> <span class="n">x</span> <span class="n">z</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="n">e</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span>

<span class="kd">theorem</span> <span class="n">t1</span> <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">r</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">r</span> <span class="n">b</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">h₃</span> <span class="o">:</span> <span class="n">r</span> <span class="n">c</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">r</span> <span class="n">a</span> <span class="n">d</span> <span class="o">:=</span>
<span class="n">transr</span> <span class="o">(</span><span class="n">transr</span> <span class="n">h₁</span> <span class="n">h₂</span><span class="o">)</span> <span class="n">h₃</span>

<span class="kd">end</span>
</code></pre></div>



<a name="242169761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242169761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242169761">(Jun 10 2021 at 07:41)</a>:</h4>
<p>What's the error message?</p>



<a name="242170198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242170198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242170198">(Jun 10 2021 at 07:46)</a>:</h4>
<p>It's somehow coming from the universe variable for <code>α</code></p>
<p>The error message:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">15</span><span class="o">:</span><span class="mi">9</span><span class="o">:</span> <span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">transr</span> <span class="n">h₁</span>
<span class="n">term</span>
  <span class="n">h₁</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">r</span> <span class="n">a</span> <span class="n">b</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">r</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">?</span><span class="n">m_2</span>
</code></pre></div>
<p>but with <code>set_option pp.universes true</code> it's</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">15</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span> <span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">transr</span> <span class="bp">⁇</span> <span class="n">h₃</span>
<span class="n">term</span>
  <span class="n">h₃</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">r.</span><span class="o">{</span><span class="n">u_6</span> <span class="n">u_7</span><span class="o">}</span> <span class="n">c</span> <span class="n">d</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">r.</span><span class="o">{</span><span class="n">u_2</span> <span class="n">u_3</span><span class="o">}</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">?</span><span class="n">m_2</span>
</code></pre></div>



<a name="242170296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242170296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242170296">(Jun 10 2021 at 07:47)</a>:</h4>
<p>This is fine:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">t1</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">transr</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">α</span><span class="o">},</span> <span class="n">r</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">r</span> <span class="n">y</span> <span class="n">z</span> <span class="bp">→</span> <span class="n">r</span> <span class="n">x</span> <span class="n">z</span><span class="o">)</span>
  <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="n">e</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">r</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">r</span> <span class="n">b</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">h₃</span> <span class="o">:</span> <span class="n">r</span> <span class="n">c</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">r</span> <span class="n">a</span> <span class="n">d</span> <span class="o">:=</span>
<span class="n">transr</span> <span class="o">(</span><span class="n">transr</span> <span class="n">h₁</span> <span class="n">h₂</span><span class="o">)</span> <span class="n">h₃</span>
</code></pre></div>



<a name="242170394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242170394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242170394">(Jun 10 2021 at 07:48)</a>:</h4>
<p>and so is this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">transr</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">α</span><span class="o">},</span> <span class="n">r</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">r</span> <span class="n">y</span> <span class="n">z</span> <span class="bp">→</span> <span class="n">r</span> <span class="n">x</span> <span class="n">z</span><span class="o">)</span>

<span class="kd">theorem</span> <span class="n">t1</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="n">e</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">r</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">r</span> <span class="n">b</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">h₃</span> <span class="o">:</span> <span class="n">r</span> <span class="n">c</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">r</span> <span class="n">a</span> <span class="n">d</span> <span class="o">:=</span>
<span class="n">transr</span> <span class="o">(</span><span class="n">transr</span> <span class="n">h₁</span> <span class="n">h₂</span><span class="o">)</span> <span class="n">h₃</span>
</code></pre></div>



<a name="242170503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242170503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242170503">(Jun 10 2021 at 07:49)</a>:</h4>
<p>If you're wanting to use <code>constants</code>, then one thing that seems to fix it is to put things into a specific type universe:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">constants</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
</code></pre></div>



<a name="242170946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242170946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242170946">(Jun 10 2021 at 07:54)</a>:</h4>
<p>I don't understand... why does the mismatch error occur :(<br>
Could anyone give me an explanation?</p>



<a name="242171340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242171340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242171340">(Jun 10 2021 at 07:58)</a>:</h4>
<p>Mixing constants and parameters like that is kind of strange</p>



<a name="242171561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242171561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242171561">(Jun 10 2021 at 08:00)</a>:</h4>
<p>"there exists some global <code>r</code> that is impossible to prove anything about" + "allow the user to supply a proof that <code>r</code> is transitive" seems like nonsense to me</p>



<a name="242171633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242171633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242171633">(Jun 10 2021 at 08:01)</a>:</h4>
<p>Probably they should both be <code>variables</code></p>



<a name="242171879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242171879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242171879">(Jun 10 2021 at 08:03)</a>:</h4>
<p>I think <code>constants</code> should have been delayed till the final chapter of <a href="https://leanprover.github.io/theorem_proving_in_lean/">#tpil</a>. It's rare that one should need it. Mathlib never uses it.</p>



<a name="242172072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242172072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242172072">(Jun 10 2021 at 08:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/type.20mismatch/near/242171340">said</a>:</p>
<blockquote>
<p>Mixing constants and parameters like that is kind of strange</p>
</blockquote>
<p>Yes, I mixed them purely for the purpose of learning their functionality.<br>
According to Johan, I don't need to study "constant" then :)</p>



<a name="242172278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242172278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242172278">(Jun 10 2021 at 08:07)</a>:</h4>
<p>Unless you are interested in adding new axioms to your foundations. In some sense, every use of <code>constant</code> should be viewed with a lot of suspicion.</p>



<a name="242172329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242172329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242172329">(Jun 10 2021 at 08:08)</a>:</h4>
<p>Because it can make the whole project inconsistent.</p>



<a name="242172346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242172346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242172346">(Jun 10 2021 at 08:08)</a>:</h4>
<p><code>constant x : T</code> is approximately equivalent to <code>def x : T := sorry</code></p>



<a name="242172386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242172386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242172386">(Jun 10 2021 at 08:08)</a>:</h4>
<p>With the difference that the latter contains the word <code>sorry</code> <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span></p>



<a name="242172410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242172410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242172410">(Jun 10 2021 at 08:09)</a>:</h4>
<p><code>constant</code> is for people who don't apologize for their actions</p>



<a name="242174930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/242174930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#242174930">(Jun 10 2021 at 08:37)</a>:</h4>
<p>and, by the looks of things, want to generate universe mismatches</p>



<a name="243305545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305545">(Jun 20 2021 at 14:34)</a>:</h4>
<p>How can I fix the type mismatch problem in the following definition?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">universe</span> <span class="n">u</span>

<span class="kd">inductive</span> <span class="n">vector</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="n">nil</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">vector</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="n">cons</span>   <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">n</span><span class="o">},</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">vector</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">vector</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">vector</span>
<span class="kn">local</span> <span class="kd">notation</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">:=</span> <span class="n">cons</span> <span class="n">h</span> <span class="n">t</span>

<span class="kd">def</span> <span class="n">append</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">},</span> <span class="n">vector</span> <span class="n">α</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">vector</span> <span class="n">α</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">vector</span> <span class="n">α</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="n">m</span> <span class="n">v</span> <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span>

<span class="kd">end</span> <span class="n">vector</span>
</code></pre></div>



<a name="243305579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305579">(Jun 20 2021 at 14:35)</a>:</h4>
<p>The easiest way to fix it is to define <code>vector alpha n</code> as <code>{L : list alpha | L.length = n}</code>.</p>



<a name="243305695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305695">(Jun 20 2021 at 14:38)</a>:</h4>
<p>Yes, I know that I can change the definition. As I am studying the contents of the reference book and trying various exercises, I would like to keep the above definition, which is used in the book.</p>



<a name="243305701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305701">(Jun 20 2021 at 14:38)</a>:</h4>
<p>Mathematically this is the same object, and it turns out that when it comes to implementation issues you have quickly run into the problem with the inductive definition, which is why I'm suggesting that you avoid it completely. As an "end user" of vectors all you need is an API for vectors, so because I can define things like <code>nil</code> and <code>cons</code> and <code>append</code> for my suggested definition, which I can, you do not need to care about these subtle implementation issues, which are matters for computer scientists.</p>



<a name="243305712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305712">(Jun 20 2021 at 14:39)</a>:</h4>
<p>"Sticking to the book" is a big mistake. This is not how to formalise mathematics.</p>



<a name="243305864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305864">(Jun 20 2021 at 14:42)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">append</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">},</span> <span class="n">vector</span> <span class="n">α</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">vector</span> <span class="n">α</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">vector</span> <span class="n">α</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="n">m</span> <span class="n">v</span> <span class="n">w</span> <span class="o">:=</span> <span class="kd">begin</span> <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">+</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">nat.zero_add</span> <span class="n">m</span><span class="o">,</span> <span class="n">rw</span> <span class="n">h</span><span class="o">,</span> <span class="n">exact</span> <span class="n">w</span><span class="o">,</span> <span class="kd">end</span>
</code></pre></div>



<a name="243305871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305871">(Jun 20 2021 at 14:43)</a>:</h4>
<p>This compiles. But your problems are only just beginning.</p>



<a name="243305892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305892">(Jun 20 2021 at 14:43)</a>:</h4>
<p>The problem is that <code>rw</code> introduces an <code>eq.rec</code> into the definition, which means that it will be hard to work with in practice.</p>



<a name="243305939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305939">(Jun 20 2021 at 14:44)</a>:</h4>
<p>(deleted)</p>



<a name="243305943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305943">(Jun 20 2021 at 14:44)</a>:</h4>
<p>I think this is what you're going for?</p>



<a name="243305952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243305952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243305952">(Jun 20 2021 at 14:45)</a>:</h4>
<p>sorry that's backwards</p>



<a name="243306047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306047">(Jun 20 2021 at 14:47)</a>:</h4>
<p>I think this is better?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">universe</span> <span class="n">u</span>

<span class="kd">inductive</span> <span class="n">vector</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="n">nil</span> <span class="o">{}</span> <span class="o">:</span> <span class="n">vector</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="n">cons</span>   <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">n</span><span class="o">},</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">vector</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">vector</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">vector</span>
<span class="kn">local</span> <span class="kd">notation</span> <span class="n">h</span> <span class="o">::</span> <span class="n">t</span> <span class="o">:=</span> <span class="n">cons</span> <span class="n">h</span> <span class="n">t</span>

<span class="kd">def</span> <span class="n">append</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">},</span> <span class="n">vector</span> <span class="n">α</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">vector</span> <span class="n">α</span> <span class="n">m</span> <span class="bp">→</span> <span class="n">vector</span> <span class="n">α</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="n">n</span><span class="o">)</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="n">m</span> <span class="n">_</span> <span class="n">w</span> <span class="o">:=</span> <span class="n">w</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">m</span> <span class="o">(</span><span class="n">cons</span> <span class="n">h</span> <span class="n">v</span><span class="o">)</span> <span class="n">w</span> <span class="o">:=</span> <span class="n">cons</span> <span class="n">h</span> <span class="o">(</span><span class="n">append</span> <span class="n">v</span> <span class="n">w</span><span class="o">)</span>

<span class="kd">end</span> <span class="n">vector</span>
</code></pre></div>



<a name="243306055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306055">(Jun 20 2021 at 14:47)</a>:</h4>
<p>Adam has cheated because he has switched the natural which you're doing induction on and is now abusing Lean's definitional equality. He has used the fact that although <code>0 + m = m</code> is true because of a theorem (it uses induction and hence the proof mentions <code>nat.rec</code>), <code>m + 0 = m</code> is true <em>by definition</em> and this fact can be abused. If Lean were to change its definition of <code>nat</code> then Adam's construction might stop working. what I am trying to emphasize is that you are running into questions which are "non-mathematical" here -- the answer depends on more than the objects you're working with, it depends on precisely how they have been implemented, and mathematics should not depend on such things.</p>



<a name="243306059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306059">(Jun 20 2021 at 14:47)</a>:</h4>
<p>Yes, I should have mentioned that :)</p>



<a name="243306128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306128">(Jun 20 2021 at 14:49)</a>:</h4>
<p>Update: Adam has edited his post and is now cheating in a new way, he has changed your <code>n + m</code> to <code>m + n</code>. The fact that this is an issue should be a red flag, although unfortunately sometimes in mathematics we have to resort to dirty tricks like this, which is exactly why mathematicians like Adam know these tricks.</p>



<a name="243306181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306181">(Jun 20 2021 at 14:50)</a>:</h4>
<p>Just to clarify: I agree with everything Kevin said in this case, but I mentioned that code in case you wanted an example of using the equation compiler</p>



<a name="243306357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306357">(Jun 20 2021 at 14:54)</a>:</h4>
<p>A better cheat would be to change your inductive definition of vector so that append can actually match the recursive definition of addition of natural numbers.</p>



<a name="243306510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306510">(Jun 20 2021 at 14:58)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span>  Could you show exact code of the "better cheat"?</p>



<a name="243306529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306529">(Jun 20 2021 at 14:58)</a>:</h4>
<p>Oh, you can just cons on the right instead of the left</p>



<a name="243306539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306539">(Jun 20 2021 at 14:59)</a>:</h4>
<p>Sorry, I'm away from the computer now so I can't write any code</p>



<a name="243306818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/243306818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#243306818">(Jun 20 2021 at 15:05)</a>:</h4>
<p>The problem is that nat "appends on the right" (succ n := n+1 by definition) but list "appends on the left" (<code>append [h] tl := h :: tl</code> by definition). What is happening here is that if F is a function taking values in types, and <code>a = b</code> by definition, then <code>F a = F b</code> by definition, however if <code>a = b</code> is only true because of a theorem, then <code>F a = F b</code> is true because of an axiom <code>eq.rec</code>, and this axiom needs to be invoked whenever you move from <code>F a</code> to <code>F b</code>, which can be extremely inconvenient in Lean's type theory because of the way things are set up. Hence you either decide to see the red flags and try a new design decision, or you press on and then you have to start thinking hard about which things are true by definition and which things are only true because of theorems, which can be problematic (and can change without warning).</p>



<a name="248525699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/248525699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#248525699">(Aug 05 2021 at 19:38)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kd">theorem</span> <span class="n">test</span> <span class="o">{</span><span class="n">I</span> <span class="n">J</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}:</span>
<span class="bp">∃</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">},</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">I</span> <span class="bp">×</span> <span class="n">J</span><span class="o">),</span> <span class="n">_</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>
<p>This reports error : </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">Exists.intro</span> <span class="o">(</span><span class="n">I</span> <span class="bp">×</span> <span class="n">J</span><span class="o">)</span>
<span class="n">term</span>
  <span class="n">I</span> <span class="bp">×</span> <span class="n">J</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="n">u_1</span> <span class="n">u_2</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">max</span> <span class="o">(</span><span class="n">u_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">u_2</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="kt">Type</span> <span class="n">u_3</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">(</span><span class="n">u_3</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span>
</code></pre></div>
<p>Why should there be a type mismatch problem in this example? How can I fix it?</p>



<a name="248526070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/248526070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#248526070">(Aug 05 2021 at 19:41)</a>:</h4>
<p>Perhaps I should give an explicit universe...</p>



<a name="248526140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/248526140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#248526140">(Aug 05 2021 at 19:42)</a>:</h4>
<p>This is ok</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">test</span> <span class="o">{</span><span class="n">I</span> <span class="n">J</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}:</span>
<span class="bp">∃</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">},</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">I</span> <span class="bp">×</span> <span class="n">I</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="248533929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/type%20mismatch/near/248533929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/type.20mismatch.html#248533929">(Aug 05 2021 at 20:45)</a>:</h4>
<p>this is the <code>example/def</code> vs <code>lemma/theorem</code> stuff we talked about before; the type of a <code>theorem</code> is immutable after it's set, whilst universe metavariables can change in an <code>example/def</code>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>