---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/cast.20vs.20coe.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html">cast vs coe</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="276826011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826011">(Mar 28 2022 at 04:21)</a>:</h4>
<p>Dear All,</p>
<p>I often struggle to know whether a lemma about coercions should have <code>coe</code> or <code>cast</code> in its name.  My vague rule is that most of the time <code>cast</code> is for ℕ, while <code>coe</code> is for everything else.</p>
<p>Is there a stricter convention than this?</p>
<p>Thanks!</p>



<a name="276826211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826211">(Mar 28 2022 at 04:27)</a>:</h4>
<p>The name of the coercion from <code>nat -&gt; A</code> is <code>nat.cast</code>, and similarly for <code>int.cast</code> and <code>rat.cast</code>. Other coercions might have their own names but are usually referred to as <code>coe</code></p>



<a name="276826334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826334" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826334">(Mar 28 2022 at 04:30)</a>:</h4>
<p>In particular, there are two coercions declared for <code>nat -&gt; int</code>, and the usual one does not resolve to <code>nat.cast</code>, it unfolds to <code>int.of_nat</code>. This one is referred to as <code>coe</code> when it is used via <code>coe</code> and <code>of_nat</code> when the <code>int.of_nat</code> function is used directly</p>



<a name="276826352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826352">(Mar 28 2022 at 04:31)</a>:</h4>
<p>Thanks Mario, this helps!</p>



<a name="276826410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826410">(Mar 28 2022 at 04:32)</a>:</h4>
<p>Just to make sure I understand, the "other" coercion ℕ →ℤ is the weird [-1-n] (or whatever the correct symbols are), right?</p>



<a name="276826532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826532">(Mar 28 2022 at 04:36)</a>:</h4>
<p>The other one is <code>nat.cast</code></p>



<a name="276826579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826579">(Mar 28 2022 at 04:36)</a>:</h4>
<p><code>nat.cast : nat -&gt; A</code> where <code>A</code> is any monoid with one</p>



<a name="276826586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826586">(Mar 28 2022 at 04:37)</a>:</h4>
<p>and <code>int</code> is a monoid with one so you can use <code>nat.cast</code> to coerce <code>nat -&gt; int</code></p>



<a name="276826590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826590">(Mar 28 2022 at 04:37)</a>:</h4>
<p>Ok, thanks.  What I said above was nonsense.</p>



<a name="276826591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826591">(Mar 28 2022 at 04:37)</a>:</h4>
<p>but there is another coercion which is defined specifically for <code>nat -&gt; int</code> and overrides this blanket implementation</p>



<a name="276826595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826595">(Mar 28 2022 at 04:37)</a>:</h4>
<p>using <code>int.of_nat</code></p>



<a name="276826644"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826644" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826644">(Mar 28 2022 at 04:38)</a>:</h4>
<p>to get the <code>nat.cast</code> coercion you have to write it out like <code>@coe nat int nat.cast_coe</code> or so</p>



<a name="276826659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826659">(Mar 28 2022 at 04:38)</a>:</h4>
<p>the only place this is done, more or less, is in the proof that this is equal to the preferred coe based on <code>int.of_nat</code></p>



<a name="276826668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826668">(Mar 28 2022 at 04:39)</a>:</h4>
<p>but this is a genuine diamond in the typeclass system that you have to watch out for since it's not a defeq</p>



<a name="276826675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826675">(Mar 28 2022 at 04:39)</a>:</h4>
<p>Ok, I get it now.  In my mistaken comment above, I guess that I was using -1 as the <code>has_one</code>  of ℤ.</p>



<a name="276826721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826721">(Mar 28 2022 at 04:40)</a>:</h4>
<p>yeah that one's not a declared coe (it would probably be even more confusing)</p>



<a name="276826728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826728">(Mar 28 2022 at 04:40)</a>:</h4>
<p>there's probably a way to get it using <code>nat.cast : nat -&gt; opposite int</code> or something</p>



<a name="276826743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826743">(Mar 28 2022 at 04:41)</a>:</h4>
<p>There might be a way, but I'm not sure that I want to learn it, lest I get even more confused!</p>



<a name="276826938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/cast%20vs%20coe/near/276826938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/cast.20vs.20coe.html#276826938">(Mar 28 2022 at 04:47)</a>:</h4>
<p>Thanks Mario!  I have a better understanding now of this <code>cast</code> vs <code>coe</code> issue!  And also I did not realize the subtlety of the two maps ℕ →ℤ.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>