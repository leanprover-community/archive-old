---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html">✔ coercion in inequalities</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="315111899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315111899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315111899">(Dec 10 2022 at 18:05)</a>:</h4>
<p>by the way, in case you want spoilers, here is bernoulli's inequality in mathlib: <a href="https://leanprover-community.github.io/mathlib_docs/algebra/group_power/lemmas.html#one_add_mul_le_pow">https://leanprover-community.github.io/mathlib_docs/algebra/group_power/lemmas.html#one_add_mul_le_pow</a></p>



<a name="315112101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315112101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315112101">(Dec 10 2022 at 18:07)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> that's smart regardless, thanks!</p>



<a name="315113977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315113977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315113977">(Dec 10 2022 at 18:26)</a>:</h4>
<p>so I proved <code>↑(d+1) = ↑d+1</code>, now I can't rewrite it at h5 for some reason? getting</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rewrite</span> <span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">did</span> <span class="n">not</span> <span class="n">find</span> <span class="kd">instance</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pattern</span> <span class="k">in</span> <span class="n">the</span> <span class="n">target</span> <span class="n">expression</span>
  <span class="bp">↑</span><span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>
</code></pre></div>
<p>latest version:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">bernoulli_ineq</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">-</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">+</span> <span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">^</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
  <span class="o">{</span> <span class="c1">-- base case</span>
    <span class="n">rw</span> <span class="n">pow_zero</span><span class="o">,</span>
    <span class="n">norm_cast</span><span class="o">,</span>
    <span class="n">linarith</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="c1">-- inductive step</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">((</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">^</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">),</span>
    <span class="c1">-- two goals again</span>
    <span class="o">{</span> <span class="n">nlinarith</span><span class="o">,</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="n">nat.succ_eq_add_one</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">pow_add</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">pow_one</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">d</span><span class="bp">+</span><span class="mi">1</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">norm_cast</span><span class="o">,</span> <span class="o">},</span>
    <span class="k">have</span> <span class="n">h5</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">),</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="n">h4</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="315114037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114037">(Dec 10 2022 at 18:27)</a>:</h4>
<p>I epected it to rewrite the goal at least to <code>1 + (↑d + 1) * x ≤ (1 + ↑d * x) * (1 + x)</code></p>



<a name="315114044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114044">(Dec 10 2022 at 18:27)</a>:</h4>
<p>What does vscode show when you hover over the arrows (in <code>h4</code> and the goal) in the infoview?</p>



<a name="315114137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114137">(Dec 10 2022 at 18:28)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">h4</span> <span class="o">:</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span>
<span class="bp">⊢</span> <span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span>
</code></pre></div>



<a name="315114161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114161">(Dec 10 2022 at 18:28)</a>:</h4>
<p>Put your mouse over the <code>↑</code>s in vscode</p>



<a name="315114232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114232">(Dec 10 2022 at 18:29)</a>:</h4>
<p>oh i see, h4 is coe ℕ ℕ</p>



<a name="315114291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114291">(Dec 10 2022 at 18:30)</a>:</h4>
<p>and in h5 it's registered as coe ℕ ℝ</p>



<a name="315114381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114381">(Dec 10 2022 at 18:30)</a>:</h4>
<p>Exactly! So the <code>h4</code> you stated wasn't the one you wanted</p>



<a name="315114391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114391">(Dec 10 2022 at 18:30)</a>:</h4>
<p>do I fix h4 then? how?</p>



<a name="315114393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114393">(Dec 10 2022 at 18:30)</a>:</h4>
<p>Try</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">have</span> <span class="n">h4</span> <span class="o">:</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">↑</span><span class="n">d</span><span class="bp">+</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span>
</code></pre></div>



<a name="315114435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114435">(Dec 10 2022 at 18:31)</a>:</h4>
<p>nice that worked! thanks!!!</p>



<a name="315114565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315114565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315114565">(Dec 10 2022 at 18:32)</a>:</h4>
<p>Instead of <code>norm_cast</code> you could also try <code>simp?</code> or <code>library_search</code>, which would tell you if there's a lemma that you could try <code>rw</code>ing by; then you wouldn't need <code>h4</code> at all</p>



<a name="315115771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315115771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315115771">(Dec 10 2022 at 18:46)</a>:</h4>
<p>almost there! this is my final version:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">bernoulli_ineq</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">-</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">+</span> <span class="o">((</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">^</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
  <span class="o">{</span> <span class="c1">-- base case</span>
    <span class="n">rw</span> <span class="n">pow_zero</span><span class="o">,</span>
    <span class="n">norm_cast</span><span class="o">,</span>
    <span class="n">linarith</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="c1">-- inductive step</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">((</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">^</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">),</span>
    <span class="c1">-- two goals again</span>
    <span class="o">{</span> <span class="n">nlinarith</span><span class="o">,</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="n">nat.succ_eq_add_one</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">pow_add</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">pow_one</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">↑</span><span class="n">d</span><span class="bp">+</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">nat.cast_succ</span> <span class="n">d</span><span class="o">,</span> <span class="o">},</span>
    <span class="k">have</span> <span class="n">h5</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">≥</span> <span class="mi">0</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">zero_le</span> <span class="bp">↑</span><span class="n">d</span><span class="o">,</span> <span class="o">},</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">),</span>
    <span class="o">{</span>
      <span class="n">rw</span> <span class="n">h4</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">add_mul</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mul_add</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">one_mul</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mul_one</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">add_mul</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">one_mul</span><span class="o">,</span>
      <span class="gr">sorry</span> <span class="o">},</span>
    <span class="n">nlinarith</span><span class="o">,</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>
<p>the state at the sorry is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">x</span><span class="o">:</span> <span class="n">ℝ</span>
<span class="n">h</span><span class="o">:</span> <span class="bp">-</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">x</span>
<span class="n">d</span><span class="o">:</span> <span class="n">ℕ</span>
<span class="n">hd</span><span class="o">:</span> <span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">^</span> <span class="n">d</span>
<span class="n">h3</span><span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">^</span> <span class="n">d</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span>
<span class="n">h4</span><span class="o">:</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span>
<span class="n">h5</span><span class="o">:</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">≥</span> <span class="mi">0</span>
<span class="bp">⊢</span> <span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≤</span> <span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span>
</code></pre></div>
<p>Question is:</p>
<ul>
<li>is there an elegant way to eliminate <code>1</code>, <code>↑d * x </code> and <code>x</code>? want to be left to prove <code>0 ≤ ↑d * x ^ 2</code></li>
<li>is there a more elegant way to do the rewrite chain at the end of h6?</li>
</ul>



<a name="315116149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315116149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315116149">(Dec 10 2022 at 18:51)</a>:</h4>
<p>Surely <code>nlinarith</code> took over a while ago with this lemma? Your <code>h5</code> should be <code>0 &lt;= (d : \R)</code>, I don't know if <code>nlinarith</code> works with <code>&gt;=</code>. I would avoid all <code>&gt;=</code>, Lean's tactics and terms are not designed for it.</p>



<a name="315116603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315116603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315116603">(Dec 10 2022 at 18:56)</a>:</h4>
<p>rewritten h5 as</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="k">have</span> <span class="n">h5</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="bp">↑</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">nat.cast_nonneg</span> <span class="n">d</span><span class="o">,</span> <span class="o">},</span>
</code></pre></div>
<p>nlinarith still doesn't get it.</p>



<a name="315116652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315116652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315116652">(Dec 10 2022 at 18:57)</a>:</h4>
<p>Your <code>h5</code> doesn't mean what you think it means. The up-arrow means "coerce to a random place" and if you leave Lean to guess then it will just coerce from the naturals to the naturals. </p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="k">have</span> <span class="n">h5</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">nat.cast_nonneg</span> <span class="n">d</span><span class="o">,</span> <span class="o">},</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="n">x</span><span class="o">),</span>
    <span class="o">{</span> <span class="k">have</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">x</span><span class="bp">^</span><span class="mi">2</span><span class="o">,</span> <span class="n">nlinarith</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">pow_two</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">h4</span><span class="o">,</span>
      <span class="n">linarith</span><span class="o">,</span> <span class="o">},</span>
</code></pre></div>
</div></div>
<p>Tactics like <code>nlinarith</code> and <code>linarith</code> are designed to do this stuff for you.</p>



<a name="315116985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315116985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Guy <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315116985">(Dec 10 2022 at 19:00)</a>:</h4>
<p>```have : 0 ≤ ↑d * x^2, nlinarith````<br>
nice</p>
<p>ok I learned alot now, thank you! will also visit the complex number game later for sure.</p>



<a name="315117221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20coercion%20in%20inequalities/near/315117221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20coercion.20in.20inequalities.html#315117221">(Dec 10 2022 at 19:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="514808">Guy</span> has marked this topic as resolved.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>