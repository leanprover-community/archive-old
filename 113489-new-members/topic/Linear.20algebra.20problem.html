---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Linear.20algebra.20problem.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html">Linear algebra problem</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="280221323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280221323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280221323">(Apr 26 2022 at 14:51)</a>:</h4>
<p>Hello! My name is Radu Zevri and I am an undergraduate student working on my 4th year project. I've started learning Lean a few weeks ago and I am struggling to understand it.  I am currently trying to prove that positive definite Hermitian matrices have positive eigenvalues, and I am stuck. Apologies if it's a silly question, but how can I multiply by v conjugate transposed at vmul? (I have <code>vmul: M.mul_vec v = e • v</code> and want to multiply by <code>vec_conj vᵀ</code>).</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">pos_def_pos_eigenvalues</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">M.is_pos_def</span><span class="o">)</span> <span class="o">(</span><span class="n">ev</span> <span class="o">:</span> <span class="n">has_eigenvalue</span> <span class="n">M</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span> <span class="n">e</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">is_pos_def</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenvalue</span> <span class="n">at</span> <span class="n">ev</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ev</span> <span class="k">with</span> <span class="n">v</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenpair</span> <span class="n">at</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">herm</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">is_Hermitian</span> <span class="n">at</span> <span class="n">herm</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ep</span> <span class="k">with</span> <span class="n">vnz</span> <span class="n">vmul</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)):=</span>
  <span class="kd">begin</span>
    <span class="n">apply</span> <span class="n">mul</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">vnz</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vmul</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">dot_product_smul</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">mul</span> <span class="n">v</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">mul</span> <span class="n">vnz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vmul</span> <span class="n">at</span> <span class="n">mul</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>Thank you very much for helping me out.  I am looking forward to hearing back from you! Please let me know if you have any suggestions.</p>



<a name="280221855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280221855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280221855">(Apr 26 2022 at 14:54)</a>:</h4>
<p>Can you edit your post to make it a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> (note: this is a clickable link)? Adding all the imports, variables etc you used will make it easier for others to answer your question.</p>



<a name="280222098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280222098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280222098">(Apr 26 2022 at 14:56)</a>:</h4>
<p>Yes, I will do so shortly. Thank you very much for your advice.</p>



<a name="280222346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280222346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280222346">(Apr 26 2022 at 14:57)</a>:</h4>
<p>Thanks! It's much easier to answer questions if I can easily run your code locally.</p>



<a name="280222731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280222731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280222731">(Apr 26 2022 at 14:59)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.matrix.symmetric</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.trace</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.to_lin</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.eigenspace</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">n</span> <span class="n">m</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">m</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">matrix</span>

<span class="n">open_locale</span> <span class="n">matrix</span>

<span class="kd">def</span> <span class="n">is_Hermitian</span> <span class="o">[</span><span class="n">has_star</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">A</span><span class="bp">ᴴ</span> <span class="bp">=</span> <span class="n">A</span>

<span class="kn">section</span> <span class="n">definite</span>
<span class="n">open_locale</span> <span class="n">complex_order</span>

<span class="kd">def</span> <span class="n">is_pos_def</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">):=</span> <span class="n">M.is_Hermitian</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">,</span> <span class="n">v</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">has_eigenpair</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">mul_vec</span> <span class="n">M</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">•</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvector</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvalue</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>


<span class="kd">theorem</span> <span class="n">pos_def_pos_eigenvalues</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">M.is_pos_def</span><span class="o">)</span> <span class="o">(</span><span class="n">ev</span> <span class="o">:</span> <span class="n">has_eigenvalue</span> <span class="n">M</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span> <span class="n">e</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">is_pos_def</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenvalue</span> <span class="n">at</span> <span class="n">ev</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ev</span> <span class="k">with</span> <span class="n">v</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenpair</span> <span class="n">at</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">herm</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">is_Hermitian</span> <span class="n">at</span> <span class="n">herm</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ep</span> <span class="k">with</span> <span class="n">vnz</span> <span class="n">vmul</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)):=</span>
  <span class="kd">begin</span>
    <span class="n">apply</span> <span class="n">mul</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">vnz</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vmul</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">dot_product_smul</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">mul</span> <span class="n">v</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">mul</span> <span class="n">vnz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vmul</span> <span class="n">at</span> <span class="n">mul</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="c1">--vmul: v M.mul_vec v = e • v</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">definite</span>

<span class="kd">end</span> <span class="n">matrix</span>
</code></pre></div>
<p>I believe this should work as a mwe</p>



<a name="280224191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280224191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280224191">(Apr 26 2022 at 15:08)</a>:</h4>
<p>I don't know my way around this part of the library but searching for "dot product" in the docs (because you just want to take the dot product, right?) gives me <code>matrix.dot_product</code>. I don't know whether this is the idiomatic way to take the complex conjugate of a vector, but <code>apply_fun matrix.dot_product (conj ∘ v) at vmul,</code> does what you want mathematically, although you have to <code>open_locale complex_conjugate</code> to make <code>conj</code> work.</p>



<a name="280224856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280224856" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280224856">(Apr 26 2022 at 15:12)</a>:</h4>
<p>Thank you very much! I will try to work my way from here. Is it ok if I ask further questions if I get stuck?</p>



<a name="280225328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280225328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280225328">(Apr 26 2022 at 15:16)</a>:</h4>
<p>sure -- that's exactly the point of the <a class="stream" data-stream-id="113489" href="/#narrow/stream/113489-new-members">#new members</a> stream. If it's about the same code you can keep asking questions in this thread. Hopefully someone will show up who actually knows this part of the library.</p>



<a name="280227076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280227076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280227076">(Apr 26 2022 at 15:29)</a>:</h4>
<p>The idiomatic spelling for the complex conjugate of a vector is <code>star v</code> I think</p>



<a name="280229210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280229210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280229210">(Apr 26 2022 at 15:47)</a>:</h4>
<p>Yes, that's right! Thank you!</p>



<a name="280233018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280233018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280233018">(Apr 26 2022 at 16:12)</a>:</h4>
<p>Is there any code for the norm/magnitude of a vector? I've tried searching for vec norm and vec mag, but I haven't found anything yet.  If there is nothing written yet, I could start.</p>



<a name="280233805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280233805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280233805">(Apr 26 2022 at 16:18)</a>:</h4>
<p>Yes, you can use <a href="https://leanprover-community.github.io/mathlib_docs/find/norm">docs#norm</a> on <code>(pi_Lp.equiv _ 2).symm v</code> to get the L2-norm (aka magnitude) of a vector</p>



<a name="280233903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280233903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280233903">(Apr 26 2022 at 16:19)</a>:</h4>
<p>Note that if you just use <code>∥v∥</code> you'll get the largest absolute value of the coefficients, which probably isn't what you want</p>



<a name="280234021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280234021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280234021">(Apr 26 2022 at 16:20)</a>:</h4>
<p>(although until <a href="https://github.com/leanprover-community/mathlib/pull/13569">#13569</a> gets merged we don't have any lemmas about <a href="https://leanprover-community.github.io/mathlib_docs/find/pi_Lp.equiv">docs#pi_Lp.equiv</a>)</p>



<a name="280234099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280234099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280234099">(Apr 26 2022 at 16:21)</a>:</h4>
<p>I don't think we have  a name for <code>∥v∥⁻¹ • v</code> anywhere</p>



<a name="280236585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280236585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280236585">(Apr 26 2022 at 16:40)</a>:</h4>
<p>Apologies, but I can't make it work.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.matrix.symmetric</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.trace</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.to_lin</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.eigenspace</span>
<span class="kn">import</span> <span class="n">tactic.find</span>
<span class="kn">import</span> <span class="n">analysis.normed.group.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.pi_L2</span>

<span class="kd">run_cmd</span> <span class="n">tactic.skip</span>
<span class="c1">--#find has_norm,</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">n</span> <span class="n">m</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">m</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">matrix</span>

<span class="n">open_locale</span> <span class="n">matrix</span>

<span class="kd">def</span> <span class="n">is_Hermitian</span> <span class="o">[</span><span class="n">has_star</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">A</span><span class="bp">ᴴ</span> <span class="bp">=</span> <span class="n">A</span>

<span class="kn">section</span> <span class="n">definite</span>
<span class="n">open_locale</span> <span class="n">complex_order</span> <span class="n">complex_conjugate</span>

<span class="kd">def</span> <span class="n">is_pos_def</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">):=</span> <span class="n">M.is_Hermitian</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">,</span> <span class="n">v</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">has_eigenpair</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">mul_vec</span> <span class="n">M</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">•</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvector</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvalue</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">x</span> <span class="n">i</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">vector_magnitude</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">has_norm</span><span class="o">((</span><span class="n">pi_Lp.equiv</span> <span class="n">_</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">theorem</span> <span class="n">pos_def_pos_eigenvalues</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">M.is_pos_def</span><span class="o">)</span> <span class="o">(</span><span class="n">ev</span> <span class="o">:</span> <span class="n">has_eigenvalue</span> <span class="n">M</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span> <span class="n">e</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">is_pos_def</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenvalue</span> <span class="n">at</span> <span class="n">ev</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ev</span> <span class="k">with</span> <span class="n">v</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenpair</span> <span class="n">at</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">herm</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">is_Hermitian</span> <span class="n">at</span> <span class="n">herm</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ep</span> <span class="k">with</span> <span class="n">vnz</span> <span class="n">vmul</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)):=</span>
  <span class="kd">begin</span>
    <span class="n">apply</span> <span class="n">mul</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">vnz</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vmul</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">dot_product_smul</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">mul</span> <span class="n">v</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">mul</span> <span class="n">vnz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vmul</span> <span class="n">at</span> <span class="n">mul</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">star</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="bp">•</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">*</span> <span class="o">(</span><span class="n">dot_product</span> <span class="o">(</span><span class="n">star</span> <span class="n">v</span><span class="o">)</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">simp</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h_1</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">star</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="bp">•</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">*</span>
  <span class="c1">--vmul: v M.mul_vec v = e • v</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">definite</span>

<span class="kd">end</span> <span class="n">matrix</span>
</code></pre></div>
<p>Would it be acceptable to define the magnitude of a vector directly, and use that to reason about it?</p>



<a name="280236704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280236704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280236704">(Apr 26 2022 at 16:41)</a>:</h4>
<p>You wrote <code>has_norm</code> where I said <code>has_norm.norm</code></p>



<a name="280236795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280236795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280236795">(Apr 26 2022 at 16:42)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">vector_magnitude</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∥</span><span class="o">(</span><span class="n">pi_Lp.equiv</span> <span class="n">_</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="n">v</span><span class="bp">∥</span>
</code></pre></div>
<p>should work (<code>∥x∥</code> is notation for <code>has_norm.norm x</code>)</p>



<a name="280237790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280237790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280237790">(Apr 26 2022 at 16:50)</a>:</h4>
<p>My bad, I've replaced it now.  There still seems to be something missing, and I can't figure out what that is.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.matrix.symmetric</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.trace</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.to_lin</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.eigenspace</span>
<span class="kn">import</span> <span class="n">tactic.find</span>
<span class="kn">import</span> <span class="n">analysis.normed.group.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.pi_L2</span>

<span class="kd">run_cmd</span> <span class="n">tactic.skip</span>
<span class="c1">--#find has_norm,</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">n</span> <span class="n">m</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">m</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">matrix</span>

<span class="n">open_locale</span> <span class="n">matrix</span>

<span class="kd">def</span> <span class="n">is_Hermitian</span> <span class="o">[</span><span class="n">has_star</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">A</span><span class="bp">ᴴ</span> <span class="bp">=</span> <span class="n">A</span>

<span class="kn">section</span> <span class="n">definite</span>
<span class="n">open_locale</span> <span class="n">complex_order</span> <span class="n">complex_conjugate</span>

<span class="kd">def</span> <span class="n">is_pos_def</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">):=</span> <span class="n">M.is_Hermitian</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">,</span> <span class="n">v</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">has_eigenpair</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">mul_vec</span> <span class="n">M</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">•</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvector</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvalue</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">x</span> <span class="n">i</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">vector_magnitude</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∥</span><span class="o">(</span><span class="n">pi_Lp.equiv</span> <span class="n">_</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="n">v</span><span class="bp">∥</span>

<span class="kd">theorem</span> <span class="n">pos_def_pos_eigenvalues</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">M.is_pos_def</span><span class="o">)</span> <span class="o">(</span><span class="n">ev</span> <span class="o">:</span> <span class="n">has_eigenvalue</span> <span class="n">M</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span> <span class="n">e</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">is_pos_def</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenvalue</span> <span class="n">at</span> <span class="n">ev</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ev</span> <span class="k">with</span> <span class="n">v</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenpair</span> <span class="n">at</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">herm</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">is_Hermitian</span> <span class="n">at</span> <span class="n">herm</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ep</span> <span class="k">with</span> <span class="n">vnz</span> <span class="n">vmul</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)):=</span>
  <span class="kd">begin</span>
    <span class="n">apply</span> <span class="n">mul</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">vnz</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vmul</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">dot_product_smul</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">mul</span> <span class="n">v</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">mul</span> <span class="n">vnz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vmul</span> <span class="n">at</span> <span class="n">mul</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">star</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="bp">•</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">*</span> <span class="o">(</span><span class="n">dot_product</span> <span class="o">(</span><span class="n">star</span> <span class="n">v</span><span class="o">)</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">simp</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h_1</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">star</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="bp">•</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">*</span>
  <span class="c1">--vmul: v M.mul_vec v = e • v</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">definite</span>

<span class="kd">end</span> <span class="n">matrix</span>
</code></pre></div>



<a name="280238493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280238493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280238493">(Apr 26 2022 at 16:55)</a>:</h4>
<p>Whoops, I got the <code>_ 2</code> arguments backwards</p>



<a name="280238502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280238502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280238502">(Apr 26 2022 at 16:55)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">vector_magnitude</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∥</span><span class="o">(</span><span class="n">pi_Lp.equiv</span> <span class="mi">2</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="n">v</span><span class="bp">∥</span>
</code></pre></div>



<a name="280274280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280274280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280274280">(Apr 26 2022 at 21:24)</a>:</h4>
<p>Thank you, it works now!</p>



<a name="280353158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280353158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280353158">(Apr 27 2022 at 13:56)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.big_operators.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.linear_map</span>
<span class="kn">import</span> <span class="n">algebra.big_operators.ring</span>
<span class="kn">import</span> <span class="n">algebra.star.basic</span>
<span class="c1">--import data.equiv.ring</span>
<span class="kn">import</span> <span class="n">data.fintype.card</span>
<span class="kn">import</span> <span class="n">data.matrix.dmatrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.symmetric</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.trace</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.to_lin</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.eigenspace</span>
<span class="kn">import</span> <span class="n">tactic.find</span>
<span class="kn">import</span> <span class="n">analysis.normed.group.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.pi_L2</span>

<span class="kd">run_cmd</span> <span class="n">tactic.skip</span>
<span class="c1">--#find conj,</span>
<span class="kd">set_option</span> <span class="n">trace.simplify</span> <span class="n">true</span>
<span class="kd">set_option</span> <span class="n">trace.simplify.rewrite_failure</span> <span class="n">false</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">n</span> <span class="n">m</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">m</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">matrix</span>

<span class="n">open_locale</span> <span class="n">matrix</span>

<span class="kd">def</span> <span class="n">is_Hermitian</span> <span class="o">[</span><span class="n">has_star</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">A</span><span class="bp">ᴴ</span> <span class="bp">=</span> <span class="n">A</span>

<span class="kn">section</span> <span class="n">definite</span>
<span class="n">open_locale</span> <span class="n">complex_order</span> <span class="n">complex_conjugate</span>

<span class="kd">def</span> <span class="n">is_pos_def</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">):=</span> <span class="n">M.is_Hermitian</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">,</span> <span class="n">v</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">has_eigenpair</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">mul_vec</span> <span class="n">M</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">•</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvector</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvalue</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">x</span> <span class="n">i</span><span class="o">)</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">vector_magnitude</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="c1">--has_norm.norm((pi_Lp.equiv 2 _).symm v)</span>
<span class="n">dot_product</span> <span class="o">(</span><span class="n">star</span> <span class="n">v</span><span class="o">)</span> <span class="n">v</span>

<span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
   <span class="n">rw</span> <span class="n">vector_magnitude</span><span class="o">,</span>
   <span class="n">simp</span><span class="o">,</span>
   <span class="n">rw</span> <span class="n">dot_product</span><span class="o">,</span>
   <span class="n">simp</span><span class="o">,</span>
   <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
   <span class="kd">begin</span>
     <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
     <span class="k">have</span> <span class="n">h_im</span> <span class="o">:</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">))</span><span class="bp">.</span><span class="n">im</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
     <span class="kd">begin</span>
       <span class="n">rw</span> <span class="n">complex.mul_im</span><span class="o">,</span>
       <span class="n">simp</span><span class="o">,</span>
       <span class="n">nlinarith</span><span class="o">,</span>
     <span class="kd">end</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h_re</span> <span class="o">:</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">))</span><span class="bp">.</span><span class="n">re</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
    <span class="kd">begin</span>
      <span class="n">rw</span> <span class="n">complex.mul_re</span><span class="o">,</span>
      <span class="n">simp</span><span class="o">,</span>
      <span class="n">nlinarith</span><span class="o">,</span>
    <span class="kd">end</span><span class="o">,</span>
    <span class="gr">sorry</span><span class="o">,</span>
   <span class="kd">end</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.sum_nonneg</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">h</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">definite</span>
<span class="kd">end</span> <span class="n">matrix</span>
</code></pre></div>
<p>I am currently trying to prove that the magnitude of a complex vector is greater than or equal to 0. I have proven that its real part is geq 0, and that its imaginary part is 0, but I am unsure how to proceed.</p>



<a name="280357447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280357447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280357447">(Apr 27 2022 at 14:25)</a>:</h4>
<p>Note that's probably not the definition of <code>vector_magnitude</code> you want (aside from really being the squared magnitude), since it has values in C not R</p>



<a name="280357502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280357502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280357502">(Apr 27 2022 at 14:25)</a>:</h4>
<p>I would imagine <code>(dot_product (star v) v).re</code> would be a better choice</p>



<a name="280357569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280357569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280357569">(Apr 27 2022 at 14:26)</a>:</h4>
<p>(avoiding pi_Lp is fine for simplicity / pedagogy)</p>



<a name="280357712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280357712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280357712">(Apr 27 2022 at 14:27)</a>:</h4>
<p>But to answer your <code>sorry</code>, <code>rw [ge, complex.le_def]</code> makes good progress</p>



<a name="280357830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280357830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280357830">(Apr 27 2022 at 14:28)</a>:</h4>
<p>Not that mathlib has almost no lemmas about <code>≥</code> (<a href="https://leanprover-community.github.io/mathlib_docs/find/ge">docs#ge</a>), because it expects you to use <code>≤</code> instead and flip your statements around</p>



<a name="280360485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280360485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280360485">(Apr 27 2022 at 14:48)</a>:</h4>
<p>Thank you! I've now proven that the magnitude of a vector is geq 0. (I've left it as a complex number fornow, as turning it into a real caused issues elsewhere in the code. I might be able to do something with coercions eventually). I know it's not much, but it's a start :)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.big_operators.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.linear_map</span>
<span class="kn">import</span> <span class="n">algebra.big_operators.ring</span>
<span class="kn">import</span> <span class="n">algebra.star.basic</span>
<span class="c1">--import data.equiv.ring</span>
<span class="kn">import</span> <span class="n">data.fintype.card</span>
<span class="kn">import</span> <span class="n">data.matrix.dmatrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.symmetric</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.trace</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.to_lin</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.eigenspace</span>
<span class="kn">import</span> <span class="n">tactic.find</span>
<span class="kn">import</span> <span class="n">analysis.normed.group.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.pi_L2</span>

<span class="kd">run_cmd</span> <span class="n">tactic.skip</span>
<span class="c1">--#find conj,</span>
<span class="kd">set_option</span> <span class="n">trace.simplify</span> <span class="n">true</span>
<span class="kd">set_option</span> <span class="n">trace.simplify.rewrite_failure</span> <span class="n">false</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">n</span> <span class="n">m</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">m</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">matrix</span>

<span class="n">open_locale</span> <span class="n">matrix</span>

<span class="kd">def</span> <span class="n">is_Hermitian</span> <span class="o">[</span><span class="n">has_star</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">A</span><span class="bp">ᴴ</span> <span class="bp">=</span> <span class="n">A</span>

<span class="kn">section</span> <span class="n">definite</span>
<span class="n">open_locale</span> <span class="n">complex_order</span> <span class="n">complex_conjugate</span>

<span class="kd">def</span> <span class="n">is_pos_def</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">):=</span> <span class="n">M.is_Hermitian</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">,</span> <span class="n">v</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">has_eigenpair</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">mul_vec</span> <span class="n">M</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">•</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvector</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvalue</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">x</span> <span class="n">i</span><span class="o">)</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">vector_magnitude</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="c1">--has_norm.norm((pi_Lp.equiv 2 _).symm v)</span>
<span class="o">(</span><span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
   <span class="n">rw</span> <span class="n">vector_magnitude</span><span class="o">,</span>
   <span class="n">simp</span><span class="o">,</span>
   <span class="n">rw</span> <span class="n">dot_product</span><span class="o">,</span>
   <span class="c1">--simp,</span>
   <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
   <span class="kd">begin</span>
     <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
     <span class="k">have</span> <span class="n">h_im</span> <span class="o">:</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">))</span><span class="bp">.</span><span class="n">im</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
     <span class="kd">begin</span>
       <span class="n">rw</span> <span class="n">complex.mul_im</span><span class="o">,</span>
       <span class="n">simp</span><span class="o">,</span>
       <span class="n">nlinarith</span><span class="o">,</span>
     <span class="kd">end</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h_re</span> <span class="o">:</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">))</span><span class="bp">.</span><span class="n">re</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
    <span class="kd">begin</span>
      <span class="n">rw</span> <span class="n">complex.mul_re</span><span class="o">,</span>
      <span class="n">simp</span><span class="o">,</span>
      <span class="n">nlinarith</span><span class="o">,</span>
    <span class="kd">end</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">ge</span><span class="o">,</span><span class="n">complex.le_def</span><span class="o">],</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">nlinarith</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">nlinarith</span><span class="o">,</span>
   <span class="kd">end</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.sum_nonneg</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">h</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">definite</span>
<span class="kd">end</span> <span class="n">matrix</span>
</code></pre></div>



<a name="280380083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280380083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280380083">(Apr 27 2022 at 17:03)</a>:</h4>
<p>Nice! Experimenting with simple-looking questions like this is a great way to learn Lean.</p>



<a name="280380256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280380256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280380256">(Apr 27 2022 at 17:04)</a>:</h4>
<p>If you're interested in what the "black box" <code>simp</code> tactic is doing, your can change it to <code>squeeze_simp</code> and see the lemmas it's actually applying. Sometimes you can shorten your proof this way.</p>



<a name="280629560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280629560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280629560">(Apr 29 2022 at 13:07)</a>:</h4>
<p>Thank you for this advice! I was looking for a way to get rid of some simp's, I'm sure this will help!<br>
I've been trying to find some equivalence of the form </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="n">f</span>
</code></pre></div>
<p>So that I can use it in a goal of the form</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">...</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="n">i</span> <span class="bp">...</span> <span class="bp">=</span> <span class="bp">...</span>
</code></pre></div>
<p>So far, something that sometims works is change, but that requires me to copy the whole goal, which sometimes leads to errors.  Is there something more applicable that could be used?</p>



<a name="280630251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280630251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280630251">(Apr 29 2022 at 13:12)</a>:</h4>
<p><code>dsimp only</code> should do it.</p>



<a name="280645835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280645835" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280645835">(Apr 29 2022 at 15:11)</a>:</h4>
<p>Greetings! Is there any theorem that says I can take the real part in and out of a finset sum? I've assumed that (and the same thing for the imaginary part) to show that one can take the conjugate of a sum or the conjugate of the element of a sum ,but I'm not sure how to start here. I plan to use that result to show some equalities related to the conjugate of products of matrices and vectors. Thank you in advance!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.big_operators.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.linear_map</span>
<span class="kn">import</span> <span class="n">algebra.big_operators.ring</span>
<span class="kn">import</span> <span class="n">algebra.star.basic</span>
<span class="c1">--import data.equiv.ring</span>
<span class="kn">import</span> <span class="n">data.fintype.card</span>
<span class="kn">import</span> <span class="n">data.matrix.dmatrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.symmetric</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.trace</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.to_lin</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.eigenspace</span>
<span class="kn">import</span> <span class="n">tactic.find</span>
<span class="kn">import</span> <span class="n">analysis.normed.group.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.pi_L2</span>

<span class="kd">run_cmd</span> <span class="n">tactic.skip</span>
<span class="c1">--#find conj,</span>
<span class="kd">set_option</span> <span class="n">trace.simplify</span> <span class="n">true</span>
<span class="kd">set_option</span> <span class="n">trace.simplify.rewrite_failure</span> <span class="n">false</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">n</span> <span class="n">m</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">m</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">matrix</span>

<span class="n">open_locale</span> <span class="n">matrix</span>

<span class="kn">section</span> <span class="n">definite</span>
<span class="n">open_locale</span> <span class="n">complex_order</span> <span class="n">complex_conjugate</span>

<span class="kd">lemma</span> <span class="n">sum_re</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}:</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">))</span><span class="bp">.</span><span class="n">re</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span><span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span><span class="bp">.</span><span class="n">re</span><span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sum_im</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}:</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">))</span><span class="bp">.</span><span class="n">im</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span><span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span><span class="bp">.</span><span class="n">im</span><span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sum_conj</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}:</span> <span class="n">conj</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span> <span class="bp">=</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">complex.conj_re</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">sum_re</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span><span class="bp">.</span><span class="n">re</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">conj</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">))))</span><span class="bp">.</span><span class="n">re</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">sum_re</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">sum_im</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">complex.conj_im</span><span class="o">,</span> <span class="n">finset.sum_neg_distrib</span><span class="o">,</span> <span class="n">neg_inj</span><span class="o">],</span>
  <span class="n">rw</span> <span class="n">sum_im</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">definite</span>

<span class="kd">end</span> <span class="n">matrix</span>
</code></pre></div>



<a name="280646215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280646215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280646215">(Apr 29 2022 at 15:14)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">sum_re</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}:</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">))</span><span class="bp">.</span><span class="n">re</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span><span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span><span class="bp">.</span><span class="n">re</span><span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span><span class="n">complex.re_lm_coe</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">linear_map.map_sum</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="280646960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280646960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280646960">(Apr 29 2022 at 15:19)</a>:</h4>
<p>Thank you very much!</p>



<a name="280647017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280647017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280647017">(Apr 29 2022 at 15:19)</a>:</h4>
<p>I feel like that should probably be added as a lemma in mathlib, although probably as <code>complex.re_sum</code> stated in reverse</p>



<a name="280647237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280647237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280647237">(Apr 29 2022 at 15:21)</a>:</h4>
<p>It came up before <a href="#narrow/stream/252551-graph-theory/topic/Spectrum.20of.20a.20graph/near/237243611">in this thread</a></p>



<a name="280746102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280746102" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280746102">(Apr 30 2022 at 17:15)</a>:</h4>
<p>I've finally proven a "real" theorem! Namely, I've proven that the eigenvalues of a Hermitian matrix are all real. The next thing on my list would be to prove that a positive definite matrix has positive eigenvalues. Thank you for helping me out, I fell like I'm starting to understand Lean.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.big_operators.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.pi</span>
<span class="kn">import</span> <span class="n">algebra.module.linear_map</span>
<span class="kn">import</span> <span class="n">algebra.big_operators.ring</span>
<span class="kn">import</span> <span class="n">algebra.star.basic</span>
<span class="c1">--import data.equiv.ring</span>
<span class="kn">import</span> <span class="n">data.fintype.card</span>
<span class="kn">import</span> <span class="n">data.matrix.dmatrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.symmetric</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.trace</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.to_lin</span>
<span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>
<span class="kn">import</span> <span class="n">data.complex.basic</span>
<span class="kn">import</span> <span class="n">linear_algebra.eigenspace</span>
<span class="kn">import</span> <span class="n">tactic.find</span>
<span class="kn">import</span> <span class="n">analysis.normed.group.basic</span>
<span class="kn">import</span> <span class="n">analysis.inner_product_space.pi_L2</span>

<span class="kd">run_cmd</span> <span class="n">tactic.skip</span>
<span class="c1">--#find conj,</span>
<span class="kd">set_option</span> <span class="n">trace.simplify</span> <span class="n">true</span>
<span class="kd">set_option</span> <span class="n">trace.simplify.rewrite_failure</span> <span class="n">false</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">n</span> <span class="n">m</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">m</span><span class="o">]</span>

<span class="kn">namespace</span> <span class="n">matrix</span>

<span class="n">open_locale</span> <span class="n">matrix</span>

<span class="kn">section</span> <span class="n">definite</span>
<span class="n">open_locale</span> <span class="n">complex_order</span> <span class="n">complex_conjugate</span>

<span class="kd">def</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">matrix_conj</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">M</span> <span class="n">i</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">is_Hermitian</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>  <span class="n">matrix_conj</span> <span class="n">M</span><span class="bp">ᵀ</span>  <span class="bp">=</span> <span class="n">M</span>

<span class="kd">def</span> <span class="n">is_pos_def</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">):=</span> <span class="n">M.is_Hermitian</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">,</span> <span class="n">v</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">has_eigenpair</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">mul_vec</span> <span class="n">M</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">•</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvector</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">def</span> <span class="n">has_eigenvalue</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">,</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">x</span>

<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">vector_magnitude</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="c1">--has_norm.norm((pi_Lp.equiv 2 _).symm v)</span>
<span class="o">(</span><span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="n">v</span><span class="o">)</span>

<span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
   <span class="n">rw</span> <span class="n">vector_magnitude</span><span class="o">,</span>
   <span class="n">rw</span> <span class="n">dot_product</span><span class="o">,</span>
   <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
   <span class="kd">begin</span>
     <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
     <span class="k">have</span> <span class="n">h_im</span> <span class="o">:</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">))</span><span class="bp">.</span><span class="n">im</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℂ</span><span class="o">)</span><span class="bp">.</span><span class="n">im</span> <span class="o">:=</span>
     <span class="kd">begin</span>
       <span class="n">rw</span> <span class="n">complex.mul_im</span><span class="o">,</span>
       <span class="n">rw</span> <span class="n">complex.conj_re</span><span class="o">,</span>
       <span class="n">rw</span> <span class="n">complex.conj_im</span><span class="o">,</span>
       <span class="n">rw</span> <span class="n">complex.zero_im</span><span class="o">,</span>
       <span class="n">nlinarith</span><span class="o">,</span>
     <span class="kd">end</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h_re</span> <span class="o">:</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">))</span><span class="bp">.</span><span class="n">re</span> <span class="bp">≥</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℂ</span><span class="o">)</span><span class="bp">.</span><span class="n">re</span> <span class="o">:=</span>
    <span class="kd">begin</span>
      <span class="n">rwa</span> <span class="n">complex.mul_re</span><span class="o">,</span>
      <span class="n">rwa</span> <span class="n">complex.conj_re</span><span class="o">,</span>
      <span class="n">rwa</span> <span class="n">complex.conj_im</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">neg_mul</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">sub_neg_eq_add</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">complex.zero_re</span><span class="o">,</span>
      <span class="n">nlinarith</span><span class="o">,</span>
    <span class="kd">end</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">ge</span><span class="o">,</span><span class="n">complex.le_def</span><span class="o">],</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">assumption</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">eq_comm</span><span class="o">,</span>
    <span class="n">assumption</span><span class="o">,</span>
   <span class="kd">end</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.sum_nonneg</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">h</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">ge</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">vector_conj_element</span> <span class="o">(</span><span class="n">v</span><span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sum_re</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}:</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">))</span><span class="bp">.</span><span class="n">re</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span><span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span><span class="bp">.</span><span class="n">re</span><span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">complex.re_lm_coe</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">linear_map.map_sum</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sum_im</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}:</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">))</span><span class="bp">.</span><span class="n">im</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span><span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span><span class="bp">.</span><span class="n">im</span><span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">complex.im_lm_coe</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">linear_map.map_sum</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sum_conj</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">}:</span> <span class="n">conj</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span> <span class="bp">=</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">complex.conj_re</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">sum_re</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span><span class="bp">.</span><span class="n">re</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">conj</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">))))</span><span class="bp">.</span><span class="n">re</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">sum_re</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">sum_im</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">complex.conj_im</span><span class="o">,</span> <span class="n">finset.sum_neg_distrib</span><span class="o">,</span> <span class="n">neg_inj</span><span class="o">],</span>
  <span class="n">rw</span> <span class="n">sum_im</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">conj_sum</span> <span class="o">{</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">}</span> <span class="o">:</span> <span class="n">conj</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span> <span class="bp">=</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">conj</span> <span class="o">((</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="n">conj</span> <span class="o">(</span><span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">id</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)))</span> <span class="bp">=</span> <span class="n">finset.univ.sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">id</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">))),</span>
  <span class="n">exact</span> <span class="n">sum_conj</span><span class="o">,</span>
  <span class="n">dsimp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">mul_conj</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:</span> <span class="n">conj</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">conj</span> <span class="n">a</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">conj</span> <span class="n">b</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span><span class="bp">;</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">complex.mul_re</span><span class="o">,</span> <span class="n">complex.conj_re</span><span class="o">,</span> <span class="n">complex.conj_im</span><span class="o">,</span> <span class="n">mul_neg</span><span class="o">,</span> <span class="n">neg_mul</span><span class="o">,</span> <span class="n">neg_neg</span><span class="o">],</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">complex.mul_im</span><span class="o">,</span> <span class="n">neg_add_rev</span><span class="o">,</span> <span class="n">complex.conj_re</span><span class="o">,</span> <span class="n">complex.conj_im</span><span class="o">,</span> <span class="n">mul_neg</span><span class="o">,</span> <span class="n">neg_mul</span><span class="o">],</span>
  <span class="n">rw</span> <span class="n">add_comm</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">dot_product_conj</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">conj</span> <span class="o">(</span><span class="n">dot_product</span> <span class="n">v</span> <span class="n">w</span><span class="o">)</span> <span class="bp">=</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">w</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">dot_product</span><span class="o">},</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">vector_conj</span><span class="o">},</span>
  <span class="n">dsimp</span> <span class="n">only</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">conj_sum</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.sum_congr</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul_conj</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">vec_mul_conj</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">vec_mul</span> <span class="n">v</span> <span class="n">M</span><span class="o">)</span> <span class="bp">=</span> <span class="n">vec_mul</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">matrix_conj</span> <span class="n">M</span><span class="o">):=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">vm</span> <span class="o">:</span> <span class="n">vec_mul</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="n">M.matrix_conj</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="o">,</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">M</span> <span class="n">j</span> <span class="n">i</span><span class="o">)),</span>
  <span class="n">ext</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vec_mul</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">dot_product</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">dot_product</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">matrix_conj</span><span class="bp">;</span>
  <span class="n">simp</span> <span class="n">only</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="bp">;</span>
  <span class="n">simp</span> <span class="n">only</span><span class="bp">;</span>
  <span class="n">simp_rw</span> <span class="n">vector_conj</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vm</span><span class="o">,</span>
  <span class="n">ext</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="bp">;</span>
  <span class="n">dsimp</span> <span class="n">only</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vec_mul</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">dot_product_conj</span><span class="bp">;</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">vector_conj</span><span class="o">},</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">mul_vec_conj</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">mul_vec</span> <span class="n">M</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">mul_vec</span> <span class="o">(</span><span class="n">matrix_conj</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">mv</span> <span class="o">:</span> <span class="n">mul_vec</span> <span class="o">(</span><span class="n">matrix_conj</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="o">,</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="n">conj</span> <span class="o">(</span><span class="n">M</span> <span class="n">i</span> <span class="n">j</span><span class="o">)),</span>
  <span class="n">ext</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">mul_vec</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">dot_product</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">dot_product</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">matrix_conj</span><span class="bp">;</span>
  <span class="n">simp</span> <span class="n">only</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="bp">;</span>
  <span class="n">simp</span> <span class="n">only</span><span class="bp">;</span>
  <span class="n">simp_rw</span> <span class="n">mul_comm</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mv</span><span class="o">,</span>
  <span class="n">ext</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="bp">;</span>
  <span class="n">dsimp</span> <span class="n">only</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">mul_vec</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">dot_product_conj</span><span class="bp">;</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">vector_conj</span><span class="o">}</span><span class="bp">;</span>
  <span class="n">simp_rw</span> <span class="n">dot_product</span><span class="bp">;</span>
  <span class="n">simp_rw</span> <span class="n">mul_comm</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">vector_conj_conj</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">v</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">funext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vector_conj</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">conj</span> <span class="o">(</span><span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">))</span> <span class="bp">=</span> <span class="n">v</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">complex.conj_conj</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">matrix_conj_conj</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">matrix_conj</span> <span class="o">(</span><span class="n">matrix_conj</span> <span class="n">M</span><span class="o">)</span> <span class="bp">=</span> <span class="n">M</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">funext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">matrix_conj</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">matrix_conj</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="o">(</span><span class="n">M</span> <span class="n">x</span><span class="o">))</span> <span class="bp">=</span> <span class="n">M</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vector_conj_conj</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">vec_smul_conj</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_conj</span> <span class="o">(</span><span class="n">x</span> <span class="bp">•</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">conj</span> <span class="n">x</span><span class="o">)</span> <span class="bp">•</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">vector_conj</span><span class="o">},</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">pi.smul_apply</span><span class="o">,</span> <span class="n">algebra.id.smul_eq_mul</span><span class="o">,</span> <span class="n">map_mul</span><span class="o">],</span>
  <span class="n">simp_rw</span> <span class="n">mul_conj</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">mul_vec_trans</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">mul_vec</span> <span class="n">M</span><span class="bp">ᵀ</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">vec_mul</span> <span class="n">v</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">mul_vec</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vec_mul</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">dot_product</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">dot_product</span><span class="bp">;</span>
  <span class="n">simp_rw</span> <span class="n">matrix.transpose</span><span class="bp">;</span>
  <span class="n">rw</span> <span class="n">finset.sum_congr</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul_comm</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul_comm</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">vec_mul_trans</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span> <span class="o">)</span> <span class="o">:</span>  <span class="o">(</span><span class="n">vec_mul</span> <span class="n">v</span> <span class="n">M</span><span class="bp">ᵀ</span> <span class="o">)</span> <span class="bp">=</span> <span class="n">mul_vec</span> <span class="n">M</span> <span class="n">v</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="n">M.mul_vec</span> <span class="n">v</span> <span class="bp">=</span> <span class="n">M</span><span class="bp">ᵀᵀ.</span><span class="n">mul_vec</span> <span class="n">v</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">transpose_transpose</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul_vec_trans</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">dot_product_mul_vec_vec_mul</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">v</span> <span class="n">w</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">mul_vec</span> <span class="n">M</span> <span class="n">w</span><span class="o">)</span> <span class="bp">=</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">vec_mul</span> <span class="n">v</span> <span class="n">M</span><span class="o">)</span> <span class="n">w</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">mv</span> <span class="o">:</span> <span class="n">M.mul_vec</span> <span class="n">w</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="n">dot_product</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">M</span> <span class="n">j</span> <span class="n">i</span><span class="o">)</span> <span class="n">w</span><span class="o">,</span>
  <span class="n">ext</span> <span class="bp">;</span>
  <span class="n">rw</span> <span class="n">mul_vec</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">vm</span> <span class="o">:</span> <span class="n">vec_mul</span> <span class="n">v</span> <span class="n">M</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">M</span> <span class="n">i</span> <span class="n">j</span><span class="o">),</span>
  <span class="n">ext</span> <span class="bp">;</span>
  <span class="n">rw</span> <span class="n">vec_mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mv</span><span class="o">,</span>
  <span class="n">change</span> <span class="o">(</span><span class="n">v</span> <span class="bp">⬝ᵥ</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">M</span> <span class="n">j</span> <span class="bp">⬝ᵥ</span> <span class="n">w</span><span class="o">)</span> <span class="bp">=</span> <span class="n">vec_mul</span> <span class="n">v</span> <span class="n">M</span> <span class="bp">⬝ᵥ</span> <span class="n">w</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">dot_product_assoc</span><span class="o">,</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="o">[</span><span class="n">dot_product</span><span class="o">]},</span>
  <span class="n">apply</span> <span class="n">finset.sum_congr</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vec_mul</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">vector_zero_iff_magnitude_zero</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">↔</span> <span class="n">v</span><span class="bp">=</span><span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">prod</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">dot_product</span> <span class="n">at</span> <span class="n">prod</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">gez</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">v</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">vector_conj</span> <span class="n">v</span> <span class="n">i</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">i</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">vector_conj</span><span class="o">,</span>
    <span class="n">dsimp</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">ge_iff_le</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">complex.le_def</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">complex.mul_re</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">complex.zero_re</span><span class="o">,</span> <span class="n">complex.conj_re</span><span class="o">,</span> <span class="n">complex.conj_im</span><span class="o">,</span> <span class="n">mul_neg</span><span class="o">,</span> <span class="n">sub_neg_eq_add</span><span class="o">],</span>
    <span class="n">nlinarith</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">complex.mul_im</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">complex.conj_im</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">complex.conj_re</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">complex.zero_im</span><span class="o">,</span> <span class="n">mul_neg</span><span class="o">],</span>
    <span class="n">rw</span> <span class="n">mul_comm</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">add_left_neg</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">important</span> <span class="o">:</span> <span class="n">finset.univ.sum</span><span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="o">,</span> <span class="n">v</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">vector_conj</span> <span class="n">v</span> <span class="n">i</span> <span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">↔</span> <span class="bp">∀</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">finset.univ</span><span class="o">,</span> <span class="n">v</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">vector_conj</span> <span class="n">v</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.sum_eq_zero_iff_of_nonneg</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">i</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">gez</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">ge_iff_le</span> <span class="n">at</span> <span class="n">gez</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">gez</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">prod</span> <span class="n">at</span> <span class="n">important</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">eq_self_iff_true</span><span class="o">,</span> <span class="n">finset.mem_univ</span><span class="o">,</span> <span class="n">mul_eq_zero</span><span class="o">,</span> <span class="n">forall_true_left</span><span class="o">,</span> <span class="n">true_iff</span><span class="o">]</span> <span class="n">at</span> <span class="n">important</span><span class="o">,</span>
  <span class="n">funext</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">important</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">important</span> <span class="k">with</span> <span class="n">vz</span> <span class="n">vcz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vz</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vector_conj</span> <span class="n">at</span> <span class="n">vcz</span><span class="o">,</span>
  <span class="n">dsimp</span> <span class="n">at</span> <span class="n">vcz</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">vczc</span> <span class="o">:=</span> <span class="n">congr_arg</span> <span class="n">conj</span> <span class="n">vcz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">complex.conj_conj</span><span class="o">]</span> <span class="n">at</span> <span class="n">vczc</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">map_zero</span><span class="o">]</span> <span class="n">at</span> <span class="n">vczc</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">vczc</span><span class="o">,</span>
  <span class="n">refl</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">ez</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">ez</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">zero_dot_product</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">theorem</span> <span class="n">hermitian_real_eigenvalues</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">is_Hermitian</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">ev</span> <span class="o">:</span> <span class="n">has_eigenvalue</span> <span class="n">M</span> <span class="n">e</span><span class="o">)</span> <span class="o">:</span> <span class="n">e.im</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">has_eigenvalue</span> <span class="n">at</span> <span class="n">ev</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ev</span> <span class="k">with</span> <span class="n">v</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenpair</span> <span class="n">at</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ep</span> <span class="k">with</span> <span class="n">nz</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">is_Hermitian</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">mul_0</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">M.mul_vec</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="bp">•</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">mul</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">mul_1</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="bp">•</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">*</span> <span class="o">(</span><span class="n">vector_magnitude</span> <span class="n">v</span><span class="o">)</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">vector_magnitude</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">dot_product_smul</span><span class="o">,</span> <span class="n">algebra.id.smul_eq_mul</span><span class="o">],</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">mul_2</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="n">v</span> <span class="o">(</span><span class="n">e</span> <span class="bp">•</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">))</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">*</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">dot_product_comm</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">vector_magnitude</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">dot_product</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">dot_product</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">finset.mul_sum</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">finset.sum_congr</span><span class="o">,</span>
    <span class="n">refl</span><span class="o">,</span>
    <span class="n">intros</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">pi.smul_apply</span><span class="o">,</span> <span class="n">algebra.id.smul_eq_mul</span><span class="o">,</span><span class="n">mul_assoc</span><span class="o">],</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">mul_3</span> <span class="o">:</span> <span class="n">dot_product</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="o">(</span><span class="n">mul_vec</span> <span class="o">(</span><span class="n">M</span><span class="bp">ᵀ.</span><span class="n">matrix_conj</span><span class="o">)</span> <span class="n">v</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">conj</span> <span class="n">e</span><span class="o">)</span> <span class="bp">*</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">dot_product_mul_vec_vec_mul</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">matrix_trans_conj</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">vec_mul_trans</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">mul_vec_conj</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">mul</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">vec_smul_conj</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">vector_magnitude</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">smul_dot_product</span><span class="o">,</span> <span class="n">algebra.id.smul_eq_mul</span><span class="o">],</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h</span> <span class="n">at</span> <span class="n">mul_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul</span> <span class="n">at</span> <span class="n">mul_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul_1</span> <span class="n">at</span> <span class="n">mul_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">ne</span> <span class="n">at</span> <span class="n">nz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">vector_zero_iff_magnitude_zero</span> <span class="n">at</span> <span class="n">nz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">dot_product_comm</span> <span class="n">at</span> <span class="n">nz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">vector_magnitude</span> <span class="n">at</span> <span class="n">nz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul_eq_mul_right_iff</span> <span class="n">at</span> <span class="n">mul_3</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">nz</span><span class="o">]</span> <span class="n">at</span> <span class="n">mul_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">or_false</span> <span class="n">at</span> <span class="n">mul_3</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">e_im</span> <span class="o">:=</span> <span class="n">congr_arg</span> <span class="n">complex.im</span> <span class="n">mul_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">complex.conj_im</span> <span class="n">at</span> <span class="n">e_im</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">eq_neg_iff_add_eq_zero</span> <span class="n">at</span> <span class="n">e_im</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">add_self_eq_zero</span> <span class="n">at</span> <span class="n">e_im</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">e_im</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">definite</span>

<span class="kd">end</span> <span class="n">matrix</span>
</code></pre></div>



<a name="280746154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280746154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280746154">(Apr 30 2022 at 17:16)</a>:</h4>
<p>Apologies that my message is so long, but there are a lot of lemmas that this theorem depends on, so a mrw would still be quite large</p>



<a name="280747789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280747789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280747789">(Apr 30 2022 at 17:48)</a>:</h4>
<p>(I just created <a href="https://github.com/leanprover-community/mathlib/pull/13837">#13837</a> to get rid of that <code>noncomputable</code>)</p>



<a name="280747999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280747999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280747999">(Apr 30 2022 at 17:52)</a>:</h4>
<p>You ought to be able to replace all your <code>vec_conj</code>s with <code>star</code> (and replace <code>rw star</code> with <code>rw pi.star_apply</code>); then for instance lemmas like <code>dot_prod_conj</code> are already in the library, as <a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.star_dot_product_star">docs#matrix.star_dot_product_star</a></p>



<a name="280748074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280748074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280748074">(Apr 30 2022 at 17:54)</a>:</h4>
<p>Of course, it's already a great learning experience to build everything up from scratch - the next thing to learn is how to find the lemmas and definitions that already exist!</p>



<a name="280793120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280793120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280793120">(May 01 2022 at 12:56)</a>:</h4>
<p>Thank you for your advice! I will try to do that eventually, but right now I am trying to first prove some theorems, as I've sadly not done as much as I wish I had yet. </p>
<p>I have a problem that might sound a bit silly. I have (complex) numbers a and b, and I have that a &gt; 0 and a * b &gt; 0. I am struggling to prove that b &gt; 0 without writing an unreasonably large amount of code, and would like to know if there is some theorem I could use. Something like this sounds like it would already be in th library, but I can't find it. Thank you very much!</p>



<a name="280793824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280793824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280793824">(May 01 2022 at 13:10)</a>:</h4>
<p>Is it true? &lt; is somewhat of a strange operation on C, if I recall correctly</p>



<a name="280794001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280794001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280794001">(May 01 2022 at 13:14)</a>:</h4>
<p>Yes it is, because being comparable to <code>0</code> implies being real. One way to prove it is <code>0 &lt; (a * b) * a⁻¹ = b</code>.</p>



<a name="280794018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280794018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280794018">(May 01 2022 at 13:15)</a>:</h4>
<p>I believe it is. Since we have a &gt; 0, we have that a is real. Then since a*b&gt;0, b is also real. Then we have b &gt; 0. I'll try to convert them to real numbers and go from there</p>



<a name="280794075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280794075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280794075">(May 01 2022 at 13:16)</a>:</h4>
<p>The way <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> showed that b is real is more elegant</p>



<a name="280794170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280794170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280794170">(May 01 2022 at 13:18)</a>:</h4>
<p>I would recommend avoiding <a href="https://leanprover-community.github.io/mathlib_docs/find/complex.partial_order">docs#complex.partial_order</a> for what you're doing, and learning how to make <code>vector_magnitude</code> real instead</p>



<a name="280794179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280794179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280794179">(May 01 2022 at 13:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="307953">Ruben Van de Velde</span> <a href="#narrow/stream/113489-new-members/topic/Linear.20algebra.20problem/near/280793824">said</a>:</p>
<blockquote>
<p>&lt; is somewhat of a strange operation on C, if I recall correctly</p>
</blockquote>
<p>The order on <code>ℂ</code> is unusual, but it is plenty behaved.</p>



<a name="280794363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280794363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280794363">(May 01 2022 at 13:22)</a>:</h4>
<p>That's good - I have zero intuition for it :)</p>



<a name="280795771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280795771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280795771">(May 01 2022 at 13:57)</a>:</h4>
<p>I've shown that positive definite matrices have positive eigenvalues. I will now write some related results.</p>



<a name="280950156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280950156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280950156">(May 02 2022 at 23:56)</a>:</h4>
<p>Hello! I am having some trouble understanding the definition of <a href="https://leanprover-community.github.io/mathlib_docs/linear_algebra/matrix/nondegenerate.html#matrix.nondegenerate">matrix.nondegenerate</a>. The definition says <code>w ⬝ M ⬝ v ≠ 0</code>, but the code says <code>v ⬝ᵥ M.mul_vec w</code>. I was looking to use this definition to prove that e is an eigenvalue of M iff det(M-eI)=0, but I'm not sure if this form can be used. I apologise if this sounds like a silly question, but I would like some assistance, if possible. Thank you very much!</p>



<a name="280951128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280951128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280951128">(May 03 2022 at 00:10)</a>:</h4>
<p>The "definition" in the docstring is using math notation not lean notation</p>



<a name="280951182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280951182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280951182">(May 03 2022 at 00:11)</a>:</h4>
<p><del>It does look like the v and w got swapped though...</del> ah, the binders are just stated confusingly</p>



<a name="280951394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280951394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280951394">(May 03 2022 at 00:14)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.nondegenerate.exists_not_ortho_of_ne_zero">docs#matrix.nondegenerate.exists_not_ortho_of_ne_zero</a> is the statement from the docstring</p>



<a name="280953106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/280953106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#280953106">(May 03 2022 at 00:43)</a>:</h4>
<p>Apologies, but I'm not sure I understand. The math notation does not seem to correspond to the actual code, unless I'm understanding it incorrectly.</p>
<p>I was hoping there would be a version mathing the math notation, as having the <code>M.mul_vec v</code> (where <code>v</code> is in the first forall, allowing me to pick it) would let me pick an eigenvector, and replace <code>M.mul_vec v</code> with <code>e • v</code>. Do you know if there is anything that I could do about this? Thank you for helping me.</p>



<a name="281007837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281007837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281007837">(May 03 2022 at 12:51)</a>:</h4>
<p>In documentation my impression is that we allow people to make claims in docstrings such as "P is defined to be X" when the truth is that P is actually defined to be Y, and it's a theorem that X=Y. <span class="user-mention" data-user-id="450995">@Radu Zevri</span> the best way to ask questions in this forum is not to try and explain your question mathematically but to post a short <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> containing a <code>sorry</code> and ask for help filling it in. I think that you have a very precise question here so you may as well post it as a Lean "puzzle"; that way, somebody passing who knows the matrix part of the library can easily post exactly the proof you want.</p>



<a name="281018197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281018197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281018197">(May 03 2022 at 14:08)</a>:</h4>
<p>Thank you for letting me know! I've managed to work my way around this, and have managed to prove that e is an eigenvalue of M iff det(M-eI)=0. I believe this  would be an important first step in estabishing the relation between eigenvalues and the characteristic polynomial of a matrix. I have also proven some other useful properties about eigenvalues. Please have a look, and let me know what you think: <a href="https://github.com/oxford-1032451/4th-year-project/blob/main/mwe.lean">https://github.com/oxford-1032451/4th-year-project/blob/main/mwe.lean</a>. Thank you!</p>



<a name="281022977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281022977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281022977">(May 03 2022 at 14:39)</a>:</h4>
<p>Here's some thoughts about the first lemma:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- two indents not 3</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">vector_magnitude</span><span class="o">,</span> <span class="n">dot_product</span><span class="o">],</span> <span class="c1">-- can do multiple rewrites in one line</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span> <span class="c1">-- don't ever use ≥, only ≤</span>
  <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="c1">-- we have the result already</span>
    <span class="n">rw</span> <span class="n">star_ordered_ring.nonneg_iff</span><span class="o">,</span>
    <span class="c1">-- Remember: if the result looks natural, it will be in the library already.</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">v</span> <span class="n">x</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.sum_nonneg</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">_</span><span class="o">,</span> <span class="c1">-- can do more than one intro at once</span>
  <span class="n">specialize</span> <span class="n">h</span> <span class="n">x</span><span class="o">,</span>
  <span class="c1">-- rw ← ge, -- no longer needed because we used ≤</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="c1">-- now do it without the `have`:</span>
<span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero'</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">vector_magnitude</span><span class="o">,</span> <span class="n">dot_product</span><span class="o">],</span>
  <span class="n">refine</span> <span class="n">finset.sum_nonneg</span> <span class="n">_</span><span class="o">,</span> <span class="c1">-- `apply` is a special case of `refine`</span>
  <span class="n">intros</span> <span class="n">i</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">star_ordered_ring.nonneg_iff</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">v</span> <span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
<span class="kd">end</span>

<span class="c1">-- The rewrites are definitional (do you know about definitional equality?) so</span>
<span class="c1">-- we can skip them:</span>

<span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero''</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">finset.sum_nonneg</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">),</span> <span class="c1">-- do the intros on this line</span>
  <span class="n">rw</span> <span class="n">star_ordered_ring.nonneg_iff</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">v</span> <span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="281023307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281023307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281023307">(May 03 2022 at 14:41)</a>:</h4>
<p>What do you think about this proof?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">vector_conj_element</span> <span class="o">(</span><span class="n">v</span><span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refl</span><span class="o">,</span> <span class="c1">-- true by definition</span>
<span class="kd">end</span>
</code></pre></div>



<a name="281070502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281070502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281070502">(May 03 2022 at 20:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/Linear.20algebra.20problem/near/281022977">said</a>:</p>
<blockquote>
<p>Here's some thoughts about the first lemma:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- two indents not 3</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">vector_magnitude</span><span class="o">,</span> <span class="n">dot_product</span><span class="o">],</span> <span class="c1">-- can do multiple rewrites in one line</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">v</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span> <span class="c1">-- don't ever use ≥, only ≤</span>
  <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="c1">-- we have the result already</span>
    <span class="n">rw</span> <span class="n">star_ordered_ring.nonneg_iff</span><span class="o">,</span>
    <span class="c1">-- Remember: if the result looks natural, it will be in the library already.</span>
    <span class="n">exact</span> <span class="o">⟨</span><span class="n">v</span> <span class="n">x</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">finset.sum_nonneg</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">_</span><span class="o">,</span> <span class="c1">-- can do more than one intro at once</span>
  <span class="n">specialize</span> <span class="n">h</span> <span class="n">x</span><span class="o">,</span>
  <span class="c1">-- rw ← ge, -- no longer needed because we used ≤</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="c1">-- now do it without the `have`:</span>
<span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero'</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">vector_magnitude</span><span class="o">,</span> <span class="n">dot_product</span><span class="o">],</span>
  <span class="n">refine</span> <span class="n">finset.sum_nonneg</span> <span class="n">_</span><span class="o">,</span> <span class="c1">-- `apply` is a special case of `refine`</span>
  <span class="n">intros</span> <span class="n">i</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">star_ordered_ring.nonneg_iff</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">v</span> <span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
<span class="kd">end</span>

<span class="c1">-- The rewrites are definitional (do you know about definitional equality?) so</span>
<span class="c1">-- we can skip them:</span>

<span class="kd">theorem</span> <span class="n">vector_magnitude_geq_zero''</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span> <span class="n">vector_magnitude</span> <span class="n">v</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">finset.sum_nonneg</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">),</span> <span class="c1">-- do the intros on this line</span>
  <span class="n">rw</span> <span class="n">star_ordered_ring.nonneg_iff</span><span class="o">,</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="n">v</span> <span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Thank you for your input! I will use your advice in the future.</p>



<a name="281070711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281070711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281070711">(May 03 2022 at 20:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/Linear.20algebra.20problem/near/281023307">said</a>:</p>
<blockquote>
<p>What do you think about this proof?</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">vector_conj_element</span> <span class="o">(</span><span class="n">v</span><span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">vector_conj</span> <span class="n">v</span><span class="o">)</span> <span class="n">i</span> <span class="bp">=</span> <span class="n">conj</span> <span class="o">(</span><span class="n">v</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refl</span><span class="o">,</span> <span class="c1">-- true by definition</span>
<span class="kd">end</span>
</code></pre></div><br>
</p>
</blockquote>
<p>I've removed it.</p>



<a name="281071517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281071517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281071517">(May 03 2022 at 20:23)</a>:</h4>
<p>Apologies for not answering sooner, I was writing some other proof and some odd error popped up: "result contains metavariables". I've tried using recover and suggest to fix the issue, as I've seen you've solved similar issues by that method in the past, but that leads to other type errors which I cannot even begin to comprehend. The theorem which has this error begins at line 1532 <a href="https://github.com/oxford-1032451/4th-year-project/blob/main/mwe.lean">(link)</a>. Would it be possible to receive some assistance? Thank you very much!</p>



<a name="281074687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281074687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281074687">(May 03 2022 at 20:45)</a>:</h4>
<p>The problem is the tactic <code>nth_rewrite</code>  which can leave side goals as metavariables, the solution in this case is to replace it with explicit <code>rw smul_comm t a</code> type calls, which don't suffer from this bug</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">independent_eigenvectors_linear_combination_not_eigenvector</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">u</span> <span class="n">v</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">e</span> <span class="n">r</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">(</span><span class="n">neq</span> <span class="o">:</span> <span class="n">e</span> <span class="bp">≠</span> <span class="n">r</span><span class="o">)</span>
<span class="o">(</span><span class="n">ep_1</span> <span class="o">:</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">e</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">ep_2</span> <span class="o">:</span> <span class="n">has_eigenpair</span> <span class="n">M</span> <span class="n">r</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">),</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">b</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">¬</span><span class="o">(</span><span class="n">has_eigenvector</span> <span class="n">M</span> <span class="o">(</span><span class="n">a</span><span class="bp">•</span><span class="n">u</span><span class="bp">+</span><span class="n">b</span><span class="bp">•</span><span class="n">v</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">epeu</span> <span class="o">:=</span> <span class="n">ep_1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">eprv</span> <span class="o">:=</span> <span class="n">ep_2</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">anz</span> <span class="n">bnz</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">ne</span> <span class="n">at</span> <span class="n">anz</span> <span class="n">bnz</span> <span class="n">neq</span><span class="o">,</span>
  <span class="n">by_contra</span> <span class="n">ev</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenvector</span> <span class="n">at</span> <span class="n">ev</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ev</span> <span class="k">with</span> <span class="n">t</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">has_eigenpair</span> <span class="n">at</span> <span class="n">ep</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ep</span> <span class="k">with</span> <span class="n">lc</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mul_vec_add</span> <span class="n">at</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">smul_add</span> <span class="n">at</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">mul_vec_smul</span> <span class="n">at</span> <span class="n">mul</span><span class="o">},</span>

  <span class="n">rw</span> <span class="n">has_eigenpair</span> <span class="n">at</span> <span class="n">ep_1</span> <span class="n">ep_2</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ep_1</span> <span class="k">with</span> <span class="n">unz</span> <span class="n">mul_1</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">ep_2</span> <span class="k">with</span> <span class="n">vnz</span> <span class="n">mul_2</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">ne</span> <span class="n">at</span> <span class="n">unz</span> <span class="n">vnz</span><span class="o">,</span>

  <span class="n">rw</span> <span class="o">[</span><span class="n">mul_1</span><span class="o">,</span><span class="n">mul_2</span><span class="o">]</span> <span class="n">at</span> <span class="n">mul</span><span class="o">,</span>

  <span class="k">have</span> <span class="n">helper_lemma</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">•</span> <span class="o">(</span><span class="n">e</span> <span class="bp">-</span> <span class="n">t</span><span class="o">)</span> <span class="bp">•</span> <span class="n">u</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">•</span> <span class="o">(</span><span class="n">r</span> <span class="bp">-</span> <span class="n">t</span><span class="o">)</span> <span class="bp">•</span> <span class="n">v</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">sub_smul</span><span class="o">},</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">smul_sub</span><span class="o">},</span>
  <span class="n">rw</span> <span class="n">sub_add_sub_comm</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">sub_eq_zero</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">smul_comm</span> <span class="n">a</span> <span class="n">t</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">smul_comm</span> <span class="n">b</span> <span class="n">t</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">mul</span><span class="o">,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">lin_ind</span> <span class="o">:=</span> <span class="n">eigenvectors_linearly_independent</span> <span class="n">M</span> <span class="n">u</span> <span class="n">v</span> <span class="n">e</span> <span class="n">r</span> <span class="n">epeu</span> <span class="n">eprv</span> <span class="n">neq</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">lin_ind</span> <span class="o">(</span><span class="n">a</span> <span class="bp">•</span> <span class="o">(</span><span class="n">e</span> <span class="bp">-</span> <span class="n">t</span><span class="o">))</span> <span class="o">(</span><span class="n">b</span> <span class="bp">•</span> <span class="o">(</span><span class="n">r</span> <span class="bp">-</span> <span class="n">t</span><span class="o">)),</span>

  <span class="k">have</span> <span class="n">ent</span> <span class="o">:</span> <span class="bp">¬</span><span class="o">(</span><span class="n">e</span> <span class="bp">-</span> <span class="n">t</span><span class="o">)</span><span class="bp">=</span><span class="mi">0</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">by_contra</span> <span class="n">eeqt</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">eeqt</span> <span class="n">at</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">zero_smul</span><span class="o">,</span> <span class="n">smul_zero</span><span class="o">,</span> <span class="n">zero_add</span><span class="o">]</span> <span class="n">at</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">smul_eq_zero</span> <span class="n">at</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">bnz</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">smul_eq_zero</span> <span class="n">at</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">sub_eq_zero</span> <span class="n">at</span> <span class="n">eeqt</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">neq</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">helper_lemma</span><span class="o">,</span><span class="n">eeqt</span><span class="o">],</span>
    <span class="n">apply</span> <span class="n">vnz</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">helper_lemma</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>

  <span class="k">have</span> <span class="n">rnt</span> <span class="o">:</span> <span class="bp">¬</span><span class="o">(</span><span class="n">r</span> <span class="bp">-</span> <span class="n">t</span><span class="o">)</span><span class="bp">=</span><span class="mi">0</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">by_contra</span> <span class="n">reqt</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">reqt</span> <span class="n">at</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">zero_smul</span><span class="o">,</span> <span class="n">smul_zero</span><span class="o">,</span> <span class="n">add_zero</span><span class="o">]</span> <span class="n">at</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">smul_eq_zero</span> <span class="n">at</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">anz</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">smul_eq_zero</span> <span class="n">at</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">ent</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">helper_lemma</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">unz</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">helper_lemma</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>

  <span class="k">have</span> <span class="n">aemtnz</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">•</span> <span class="o">(</span><span class="n">e</span> <span class="bp">-</span> <span class="n">t</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">smul_ne_zero</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">rwa</span> <span class="n">ne</span><span class="o">,</span>
  <span class="n">rwa</span> <span class="n">ne</span><span class="o">,</span>

  <span class="k">have</span> <span class="n">brmtnz</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">•</span> <span class="o">(</span><span class="n">r</span> <span class="bp">-</span> <span class="n">t</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">smul_ne_zero</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">rwa</span> <span class="n">ne</span><span class="o">,</span>
  <span class="n">rwa</span> <span class="n">ne</span><span class="o">,</span>

  <span class="k">have</span> <span class="n">lin_ind_2</span> <span class="o">:=</span> <span class="n">lin_ind</span> <span class="n">aemtnz</span> <span class="n">brmtnz</span><span class="o">,</span>
  <span class="n">repeat</span> <span class="o">{</span><span class="n">rw</span> <span class="n">smul_assoc</span> <span class="n">at</span> <span class="n">lin_ind_2</span><span class="o">},</span>
  <span class="n">rw</span> <span class="n">ne</span> <span class="n">at</span> <span class="n">lin_ind_2</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">lin_ind_2</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">helper_lemma</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="281077110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281077110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Radu Zevri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281077110">(May 03 2022 at 21:03)</a>:</h4>
<p>Thank you very much! I would have never guessed that. Everything works now.</p>



<a name="281078119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Linear%20algebra%20problem/near/281078119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Linear.20algebra.20problem.html#281078119">(May 03 2022 at 21:12)</a>:</h4>
<p>In this case I happened to know that <code>nth_rewrite</code> has this problem, but in future maybe moving the <code>recover</code> call around would help you find which tactic was causing the issue, the first place <code>recover</code> adds something would be the problem. If everything is working as intended <code>recover</code> should never be needed.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>