---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html">integer subtraction / rational division</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="192899133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192899133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192899133">(Apr 04 2020 at 09:33)</a>:</h4>
<p>Can I allocate some special symbols for the "non-standard" subtraction in natural numbers, or integer division, and interpret the symbols <code>/</code> and  <code>-</code> in  "the standard way", even though it may cause requiring a richer structure? A similar behavioral change  was done from Python 2 to Python 3. Now, I am trying to prove something like <code>a / b = 2^(c-d)</code> where <code>a</code>, <code>b</code>, <code>c</code>, <code>d</code> originate from natural numbers (cardinalities of finite sets), and it is challenging to even understand how Lean understands it.<br>
For broader context, the relevant lemma I wanted to prove is:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">M</span> <span class="n">N</span> <span class="n">D</span> <span class="n">n</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">*</span> <span class="mi">2</span><span class="err">^</span><span class="n">k</span> <span class="bp">=</span> <span class="n">D</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">*</span> <span class="mi">2</span><span class="err">^</span><span class="n">k</span> <span class="bp">=</span> <span class="n">D</span><span class="o">)</span>
  <span class="o">(</span><span class="n">non_triv</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">nk_le</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">k</span><span class="o">)</span>
  <span class="o">:</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">/</span> <span class="n">M</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="o">(</span><span class="n">k</span><span class="bp">-</span><span class="n">n</span><span class="o">)</span>
<span class="o">:=</span>
</pre></div>


<p>It is related to problem C4 from <a href="http://imo-official.org/problems/IMO2008SL.pdf" title="http://imo-official.org/problems/IMO2008SL.pdf">http://imo-official.org/problems/IMO2008SL.pdf</a></p>



<a name="192899212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192899212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192899212">(Apr 04 2020 at 09:35)</a>:</h4>
<p>write <code>a * 2^d = b * 2^c</code></p>



<a name="192899268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192899268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192899268">(Apr 04 2020 at 09:36)</a>:</h4>
<p>well, yes, but that is not the statement of the original problem</p>



<a name="192899271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192899271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192899271">(Apr 04 2020 at 09:36)</a>:</h4>
<p>the original IMO problem is about determining the ratio <code>a / b</code></p>



<a name="192899343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192899343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192899343">(Apr 04 2020 at 09:39)</a>:</h4>
<p>So I am basically asking, how to translate the solution <code>a * 2^d = b * 2^c</code>, to the "required" form.</p>



<a name="192899405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192899405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192899405">(Apr 04 2020 at 09:40)</a>:</h4>
<p>And I believe that standard behavior of <code>-</code> and <code>/</code> would help.</p>



<a name="192899596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192899596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192899596">(Apr 04 2020 at 09:47)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">norm_cast</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">M</span> <span class="n">N</span> <span class="n">D</span> <span class="n">n</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">*</span> <span class="mi">2</span><span class="err">^</span><span class="n">n</span> <span class="bp">=</span> <span class="n">D</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">*</span> <span class="mi">2</span><span class="err">^</span><span class="n">k</span> <span class="bp">=</span> <span class="n">D</span><span class="o">)</span>
  <span class="o">(</span><span class="n">non_triv</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">nk_le</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">k</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">N</span> <span class="bp">/</span> <span class="n">M</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="err">^</span><span class="o">(</span><span class="n">k</span><span class="bp">-</span><span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="n">div_eq_iff_mul_eq</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">domain</span><span class="bp">.</span><span class="n">mul_left_inj</span> <span class="o">(</span><span class="n">ne_of_gt</span> <span class="err">$</span> <span class="n">pow_pos</span> <span class="n">two_pos</span> <span class="n">n</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span><span class="err">^</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">mul_assoc</span><span class="o">,</span> <span class="err">←</span> <span class="n">pow_add</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_sub_cancel&#39;</span> <span class="n">nk_le</span><span class="o">],</span>
  <span class="n">rw</span> <span class="n">mul_comm</span> <span class="n">at</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">exact_mod_cast</span> <span class="n">h2</span><span class="bp">.</span><span class="n">trans</span> <span class="n">h1</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
  <span class="n">exact_mod_cast</span> <span class="n">ne_of_gt</span> <span class="n">non_triv</span>
<span class="kn">end</span>
</pre></div>



<a name="192900150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900150">(Apr 04 2020 at 10:03)</a>:</h4>
<p>Thank you for the proof.</p>



<a name="192900229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900229">(Apr 04 2020 at 10:04)</a>:</h4>
<p>You can't change the horrible uses of these symbols because they're already standard. We just have to live with them as mathematicians</p>



<a name="192900246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900246">(Apr 04 2020 at 10:05)</a>:</h4>
<p>Hm... Python did it.</p>



<a name="192900247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900247">(Apr 04 2020 at 10:05)</a>:</h4>
<p>Remember you can always cast. If you really want to work with subtraction you can use integers and if you really want to worth with division you can use rationale</p>



<a name="192900290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900290">(Apr 04 2020 at 10:06)</a>:</h4>
<p>Maybe some future version of Lean will manage it as well.</p>



<a name="192900301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900301">(Apr 04 2020 at 10:06)</a>:</h4>
<p>Python is just one programming language. This subtraction nonsense has permeated loads of the theorem prover languages</p>



<a name="192900326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900326">(Apr 04 2020 at 10:07)</a>:</h4>
<p>I have meant the division.</p>



<a name="192900331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900331">(Apr 04 2020 at 10:07)</a>:</h4>
<p>I would happily vote for a change but the CS people like trolling us. Why not have this conversation in #general? I will be right behind you</p>



<a name="192900372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900372">(Apr 04 2020 at 10:08)</a>:</h4>
<p>OK :-)</p>



<a name="192900442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192900442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192900442">(Apr 04 2020 at 10:10)</a>:</h4>
<p>By the way, another question: Why</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">basic</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="mi">2</span><span class="bp">/</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span>
</pre></div>


<p>fails, and </p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="mi">2</span><span class="bp">/</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span>
</pre></div>


<p>succeeds?</p>



<a name="192901051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901051">(Apr 04 2020 at 10:26)</a>:</h4>
<p>One of them probably imports algebra.group_power</p>



<a name="192901057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901057">(Apr 04 2020 at 10:26)</a>:</h4>
<p>And the other doesn't</p>



<a name="192901062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901062">(Apr 04 2020 at 10:26)</a>:</h4>
<p>Powers are only defined for naturals in core</p>



<a name="192901375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901375">(Apr 04 2020 at 10:35)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">group_power</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="mi">2</span><span class="bp">/</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span>
</pre></div>


<p>still does not work.</p>



<a name="192901643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901643">(Apr 04 2020 at 10:42)</a>:</h4>
<p>Well I'm not at a computer but I can tell you how to debug this yourself</p>



<a name="192901700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901700">(Apr 04 2020 at 10:44)</a>:</h4>
<p><code>def X := </code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mn>2</mn><mi mathvariant="normal">/</mi><mn>3</mn><msup><mo stretchy="false">)</mo><mo stretchy="false">(</mo></msup><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(2/3)^(-1)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord">/</span><span class="mord">3</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mopen mtight">(</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span> in a situation where it works</p>



<a name="192901728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901728">(Apr 04 2020 at 10:45)</a>:</h4>
<p>And then <code>#print X</code> and we can try and figure out what function lean is using to do the power</p>



<a name="192901738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901738">(Apr 04 2020 at 10:45)</a>:</h4>
<p>It says</p>
<div class="codehilite"><pre><span></span><span class="mi">4</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span> <span class="n">def</span> <span class="n">X</span> <span class="o">:</span> <span class="n">ℚ</span> <span class="o">:=</span>
<span class="o">(</span><span class="mi">2</span> <span class="bp">/</span> <span class="mi">3</span><span class="o">)</span> <span class="err">^</span> <span class="bp">-</span><span class="mi">1</span>
</pre></div>



<a name="192901779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901779">(Apr 04 2020 at 10:46)</a>:</h4>
<p>Not much helpful...</p>



<a name="192901891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901891">(Apr 04 2020 at 10:50)</a>:</h4>
<p>I have got it, <code>import algebra.field_power</code>, by following the source code.</p>



<a name="192901906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901906">(Apr 04 2020 at 10:51)</a>:</h4>
<p>OK great. Here's how to solve it my way: <code>set_option pp.all true</code> and then <code>#print X</code> again</p>



<a name="192901912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901912">(Apr 04 2020 at 10:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="133339">Miroslav Olšák</span> <a href="#narrow/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division/near/192900246" title="#narrow/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division/near/192900246">said</a>:</p>
<blockquote>
<p>Hm... Python did it.</p>
</blockquote>
<p>Python is also a dynamically typed language</p>



<a name="192901987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901987">(Apr 04 2020 at 10:53)</a>:</h4>
<p>and then we see that the exact term for <code>^</code> is <code>@has_pow.pow.{0 0} rat int (@int.has_pow.{0} rat rat.division_ring)</code></p>



<a name="192901988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901988">(Apr 04 2020 at 10:53)</a>:</h4>
<p>I know. On the other hand, Lean has a strong inference system that also often disquise the types from the user.</p>



<a name="192901989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192901989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192901989">(Apr 04 2020 at 10:53)</a>:</h4>
<p>If you want to have subtraction in a "richer structure", then write <code>(x - y : int)</code> where <code>x,y : nat</code></p>



<a name="192902042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902042">(Apr 04 2020 at 10:54)</a>:</h4>
<p>Yes, as a mathematician, you simply shouldn't be using these functions, not complaining that their notation is confusing.</p>



<a name="192902045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902045">(Apr 04 2020 at 10:54)</a>:</h4>
<p>I figure I'll just let the CS people do what they like</p>



<a name="192902054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902054">(Apr 04 2020 at 10:54)</a>:</h4>
<p>But if you have to pass a subtraction to a function, as a nat, then nat subtraction is much better than any other option</p>



<a name="192902056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902056">(Apr 04 2020 at 10:54)</a>:</h4>
<p>and now <code>#check int.has_pow</code> which is the underlying function it's using</p>



<a name="192902070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902070">(Apr 04 2020 at 10:55)</a>:</h4>
<p>and peeking the definition does indeed indicate that it's defined in algebra.field_power</p>



<a name="192902115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902115">(Apr 04 2020 at 10:56)</a>:</h4>
<p>If subtraction had type <code>nat -&gt; nat -&gt; int</code> then this wouldn't solve the problem of when the subtraction is actually a nat in the case of interest, and for typing reasons you need it to have type <code>nat</code>, so you have to cast it back with some ugly thing like <code>to_nat</code>... and now you've reinvented nat subtraction</p>



<a name="192902132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902132">(Apr 04 2020 at 10:56)</a>:</h4>
<p>The other part of <code>@has_pow.pow.{0 0} rat int (@int.has_pow.{0} rat rat.division_ring)</code> is the proof that the rationals are a division ring.</p>



<a name="192902149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902149">(Apr 04 2020 at 10:57)</a>:</h4>
<p>Miroslav, Mario's <code>(x-y : int)</code> trick is very important to understand because it relies on a very counter-intuitive Lean behavior which sometimes throws me off, even after more than two years of Lean. When you write <code>(x - y : int)</code> Lean does <strong>not</strong> "compute" <code>x - y</code> and then convert to <code>int</code> (which wouldn't solve your problem). It sees int and then infers that <code>-</code> should be an operation returning an <code>int</code>, which forces <code>x</code> and <code>y</code> to have type int, hence Lean inserts the coercion.</p>



<a name="192902194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902194">(Apr 04 2020 at 10:58)</a>:</h4>
<p>I write C code sometimes and the coercion behavior is the other way around, it throws me off going back and forth</p>



<a name="192902202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902202">(Apr 04 2020 at 10:58)</a>:</h4>
<p>You can play with <code>#eval (2 - 3 : int)</code> (inserting coercions in various places).</p>



<a name="192902207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902207">(Apr 04 2020 at 10:58)</a>:</h4>
<p>If in doubt, write <code>(\u x - \u y : int)</code></p>



<a name="192902215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902215">(Apr 04 2020 at 10:59)</a>:</h4>
<p>or <code>(\u(x-y) : int)</code></p>



<a name="192902291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902291">(Apr 04 2020 at 11:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division/near/192902042" title="#narrow/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division/near/192902042">said</a>:</p>
<blockquote>
<p>Yes, as a mathematician, you simply shouldn't be using these functions, not complaining that their notation is confusing.</p>
</blockquote>
<p>I don't understand. What do you mean by it? What functions should I not use?</p>



<a name="192902367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902367">(Apr 04 2020 at 11:03)</a>:</h4>
<p>nat subtraction, that is, <code>x - y : nat</code> where <code>x,y:nat</code></p>



<a name="192902417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902417">(Apr 04 2020 at 11:04)</a>:</h4>
<p>when you write <code>(x - y : int)</code>, the subtraction there has type <code>int -&gt; int -&gt; int</code>. It's a completely different function and a much more well behaved one</p>



<a name="192902498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902498">(Apr 04 2020 at 11:07)</a>:</h4>
<p>However I disagree that you should avoid it completely. nat subtraction should be understood as a "totalized partial function", like division on reals or the sum of an infinite series or any number of other things. It returns garbage sometimes so you need to always be able to prove that you are not in the bad case when using it. This is somewhat of a pain, so if there are alternative formulations that avoid it they are probably preferable, but it's not the end of the world either</p>



<a name="192902642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902642">(Apr 04 2020 at 11:10)</a>:</h4>
<p>That is all nice, but how am I supposed to see what function is used in <code>2^(k-n)</code>, or even <code>2^(k-n) : ℚ</code> -- that it is probably the wrong subtraction function?</p>



<a name="192902769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902769">(Apr 04 2020 at 11:13)</a>:</h4>
<p>And Mario, how do you perceive <code>a / b : int</code>? As rounded division, or as totalized partial function that returns garbage if the two integers are not divisible?</p>



<a name="192902830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902830">(Apr 04 2020 at 11:15)</a>:</h4>
<p>The subtraction function always has the same output type as input type, <code>A -&gt; A -&gt; A</code>. Lean will never insert coercions unless it has to to avoid a type mismatch. In this case, <code>k</code> and <code>n</code> are <code>nat</code> and <code>^</code> is generic so it provides no hint about the type it is expecting in the input, so lean lets it be <code>k - n : nat</code>, finds the instance <code>^ : A -&gt; nat -&gt; A</code>, and goes with that</p>



<a name="192902989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902989">(Apr 04 2020 at 11:19)</a>:</h4>
<p>Actually the "totalized partial function" is not an all or nothing business. We have tried to make the "garbage" values as useful as possible given the constraints, so they may be less garbage-like depending on the application. Nat subtraction, for instance, returns 0 when the subtraction is out of bounds. One nice consequence of this is that it puts nat subtraction in an adjunction with addition, <code>a - b &lt;= c &lt;-&gt; a &lt;= b + c</code>, while some other garbage value like 37 wouldn't satisfy that.</p>



<a name="192902991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192902991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192902991">(Apr 04 2020 at 11:19)</a>:</h4>
<p>Miroslav there is an algorithm for working out the type of everything and if you use set_option pp.all true you can figure it out</p>



<a name="192903046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192903046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192903046">(Apr 04 2020 at 11:20)</a>:</h4>
<p>So the justification of natural subtraction is that it is an adjoint functor</p>



<a name="192903056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192903056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192903056">(Apr 04 2020 at 11:21)</a>:</h4>
<p>Or you can just look at where the coercions are happening</p>



<a name="192903064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192903064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192903064">(Apr 04 2020 at 11:21)</a>:</h4>
<p>There is a similar adjunction for int division</p>



<a name="192903475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192903475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192903475">(Apr 04 2020 at 11:34)</a>:</h4>
<p>All this is very nice, but it doesn't hide the fact that we currently don't have a good solution to handle numbers in a proof assistant. Things are simply broken, and the only thing we can explain is why it's difficult to fix them while keeping other things that we do like.</p>



<a name="192903516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192903516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192903516">(Apr 04 2020 at 11:34)</a>:</h4>
<p>I know Mario knows this, I'm being explicit for Miroslav.</p>



<a name="192903917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192903917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192903917">(Apr 04 2020 at 11:46)</a>:</h4>
<p>And couldn't just the rational division / integer subtraction be chosen as the default, with possible forcing of the rounded functions by the external typing? So that <code>1/2 = 2/3</code> would be false, whereas <code>(1/2 : ℤ) = (2/3 : ℤ)</code>would be true?</p>



<a name="192904220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904220">(Apr 04 2020 at 11:54)</a>:</h4>
<p>But of course, I don't see into the coersion / overloading rules. As far as I know, it is a mess even in C++.</p>



<a name="192904373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904373">(Apr 04 2020 at 11:59)</a>:</h4>
<p>Having integer subtraction as the default on naturals is literally impossible</p>



<a name="192904376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904376">(Apr 04 2020 at 11:59)</a>:</h4>
<p>Look at the type of has_sub.sub</p>



<a name="192904386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904386">(Apr 04 2020 at 11:59)</a>:</h4>
<p>It has to return an element of the same type as those it eats</p>



<a name="192904428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904428">(Apr 04 2020 at 12:00)</a>:</h4>
<p>This is a design decision that can't really be changed</p>



<a name="192904434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904434">(Apr 04 2020 at 12:00)</a>:</h4>
<p>It's also the right design for int, rat, real, complex, and any ring</p>



<a name="192904444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904444">(Apr 04 2020 at 12:01)</a>:</h4>
<p>If you don't like subtraction on semirings, don't use it</p>



<a name="192904448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904448">(Apr 04 2020 at 12:01)</a>:</h4>
<p>We very rarely need it</p>



<a name="192904510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192904510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192904510">(Apr 04 2020 at 12:02)</a>:</h4>
<p>The only convincing example I've ever seen in mathematics is when we differentiate X^n and even in this case you can split into zero and successor cases if you want</p>



<a name="192905670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192905670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192905670">(Apr 04 2020 at 12:34)</a>:</h4>
<p>Do you know how many ways you have to decompose an integer <code>n</code> as a sum <code>i_1 + ... + i_k</code> of positive integers (where <code>k</code> is not fixed)? The answer is <code>2^(n-1)</code>. This is proved by thinking of a decomposition of <code>{0, ..., n-1}</code> into blocks, and taking the leftmost point of each of your blocks but the first one. This gives you a bijection between the set of decompositions and finite subsets of <code>{1, ..., n-1}</code>, which have cardinality <code>2^(n-1)</code>. Fun fact: all this also works for <code>n = 0</code>(where subtraction is nat subtraction).</p>



<a name="192905761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192905761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192905761">(Apr 04 2020 at 12:36)</a>:</h4>
<p>And the proof of this (which I needed to prove that the composition of analytic functions is analytic, upcoming PR once <a href="https://github.com/leanprover-community/mathlib/issues/2197" title="https://github.com/leanprover-community/mathlib/issues/2197">#2197</a> is merged) never distinguishes between <code>n = 0</code> and <code>n &gt; 0</code>!</p>



<a name="192905827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192905827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192905827">(Apr 04 2020 at 12:38)</a>:</h4>
<p>I never got my answer about <a href="https://github.com/leanprover-community/mathlib/issues/2197" title="https://github.com/leanprover-community/mathlib/issues/2197">#2197</a>, but I can merge anyway if it's blocking you.</p>



<a name="192906132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192906132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192906132">(Apr 04 2020 at 12:47)</a>:</h4>
<p>Your question was not about <a href="https://github.com/leanprover-community/mathlib/issues/2197" title="https://github.com/leanprover-community/mathlib/issues/2197">#2197</a> but about preexisting files, right? I don't have a good answer, I can only say it follows the same design as in the file for the operator norm.</p>



<a name="192906175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192906175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192906175">(Apr 04 2020 at 12:48)</a>:</h4>
<p>You don't know whether those norms lemmas are used directly in later files? Even in the operator norm case?</p>



<a name="192906383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192906383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192906383">(Apr 04 2020 at 12:55)</a>:</h4>
<p>I don't think they are (and a quick grep agrees with me). In the operator norm case, we are talking about the four lemmas <code>op_norm_zero_iff</code>, <code>op_norm_add_le</code>, <code>op_norm_neg</code> and <code>op_norm_smul</code>, which prove that the operator norm satisfies the usual properties of a norm. Then, the normed space instance is derived from these lemmas, and they become unnecessary as they are covered by general normed space properties. Still, the proofs of these lemmas depend on the previous lemmas, so it would not be obvious to give a direct proof of the instance (and in any case we say that in general it is good practice to split a big proof in smaller lemmas). The question is whether we should mark them as private. I don't really have an opinion on this.</p>



<a name="192906436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192906436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192906436">(Apr 04 2020 at 12:56)</a>:</h4>
<p>Yes, the question was about making them private. This is a very general question that I think should have a least a general guiding principle. But that's not a good reason to postpone merging.</p>



<a name="192906807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192906807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192906807">(Apr 04 2020 at 13:07)</a>:</h4>
<p>And if let's say, naturals didn't have <code>has_sub</code> and <code>has_div</code>, Lean still could not realize that <code>a - b</code> should be an integer and <code>a / b</code> should be a rational?</p>



<a name="192906861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192906861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192906861">(Apr 04 2020 at 13:08)</a>:</h4>
<p><code>-</code> <strong>is</strong> <code>has_sub.sub</code></p>



<a name="192906883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192906883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192906883">(Apr 04 2020 at 13:09)</a>:</h4>
<p>I understand, and if I deleted it?</p>



<a name="192906886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192906886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192906886">(Apr 04 2020 at 13:10)</a>:</h4>
<p>from naturals</p>



<a name="192907086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907086">(Apr 04 2020 at 13:15)</a>:</h4>
<p>Then everything would break because this is a design decision</p>



<a name="192907091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907091">(Apr 04 2020 at 13:15)</a>:</h4>
<p>Core would break</p>



<a name="192907155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907155">(Apr 04 2020 at 13:16)</a>:</h4>
<p><code>-</code> notation is tied to has_sub.sub</p>



<a name="192907180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907180">(Apr 04 2020 at 13:17)</a>:</h4>
<p>And natural subtraction is used all over the place in parts of core that a mathematician has no interest in looking at but which make all the tactics work</p>



<a name="192907193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907193">(Apr 04 2020 at 13:17)</a>:</h4>
<p>I should say that this is just a conjecture</p>



<a name="192907251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907251">(Apr 04 2020 at 13:18)</a>:</h4>
<p>But if they didn't need natural subtraction it probably wouldn't be in core</p>



<a name="192907263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907263">(Apr 04 2020 at 13:19)</a>:</h4>
<p>I guess here is how to refactor</p>



<a name="192907308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907308">(Apr 04 2020 at 13:20)</a>:</h4>
<p>First change core so that the notation for has_sub.sub is some weird minus sign with a warning symbol above it</p>



<a name="192907335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907335">(Apr 04 2020 at 13:21)</a>:</h4>
<p>Then define a new notational typeclass for - and let it go from A x A to B. We can think of this as mathematician's subtraction</p>



<a name="192907376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907376">(Apr 04 2020 at 13:22)</a>:</h4>
<p>And now for rings you use this notation instead with B=A</p>



<a name="192907384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907384">(Apr 04 2020 at 13:22)</a>:</h4>
<p>And for nat you let it take values in int</p>



<a name="192907387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907387">(Apr 04 2020 at 13:23)</a>:</h4>
<p>But it wouldn't be long before you started regretting it</p>



<a name="192907396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907396">(Apr 04 2020 at 13:23)</a>:</h4>
<p>Because then you'll end up with goals where you think you've proved naturals a and b are equal but you've only proved that integers a and b are equal</p>



<a name="192907456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907456">(Apr 04 2020 at 13:24)</a>:</h4>
<p>And you'll have to apply the norm_cast tactic to fix things up which is a pain if you're writing a term mode proof</p>



<a name="192907478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907478">(Apr 04 2020 at 13:24)</a>:</h4>
<p>And will slow down your code immensely</p>



<a name="192907535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907535">(Apr 04 2020 at 13:26)</a>:</h4>
<p>I am sticking with my original assertion. If you do want to use negative numbers when why are you using nats in the first place? I have a student working on a dots and boxes project and she's using ints even though everything at the end is nonnegative and it hasn't caused any problems at all</p>



<a name="192907552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192907552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192907552">(Apr 04 2020 at 13:26)</a>:</h4>
<p>And if you don't want to use them then just avoid subtraction by rephrasing in terms of addition</p>



<a name="192911197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192911197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192911197">(Apr 04 2020 at 14:52)</a>:</h4>
<p>I understand that everything would break now :-). I was just curious whether the refactor would be hypotetically possible. I would imagine using other symbol for natural subtraction, and integer division (for example <code>a \ b</code> and <code>a ÷ b</code>). But I would need Lean to trigger the integer subtraction, whenever I write <code>a - b</code> for <code>a</code>, <code>b</code> naturals. The question is whether the typing system would allow such behavior.<br>
I am not doing it, I am just asking, it could help me with understanding insides of Lean. We can discuss on whether it would be a good idea later, now I just want to understand whether it is a possibility.</p>



<a name="192911325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192911325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192911325">(Apr 04 2020 at 14:55)</a>:</h4>
<p>What Lean does when it sees a-b depends simply on the definition of the notation -</p>



<a name="192911517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192911517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192911517">(Apr 04 2020 at 14:59)</a>:</h4>
<p>Currently that notation is used in 1000 places in mathlib and is hard wired to mean something of type X to X to X</p>



<a name="192911528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192911528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192911528">(Apr 04 2020 at 14:59)</a>:</h4>
<p>You can redefine it to go from X to X to Y and then fix 1000 errors</p>



<a name="192911536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192911536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192911536">(Apr 04 2020 at 14:59)</a>:</h4>
<p>And then it'll work fine except that you'll find that it's really annoying</p>



<a name="192911608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192911608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192911608">(Apr 04 2020 at 15:01)</a>:</h4>
<p>Because you don't want the types of your objects changing when you apply fundamental operations to them</p>



<a name="192911667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192911667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192911667">(Apr 04 2020 at 15:02)</a>:</h4>
<p>I think that your idea of a subtraction operation from nat x nat to int is just as unnatural as leans design decision</p>



<a name="192911674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192911674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192911674">(Apr 04 2020 at 15:02)</a>:</h4>
<p>If you want to subtract naturals you should be using integers from the beginning</p>



<a name="192912039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912039">(Apr 04 2020 at 15:11)</a>:</h4>
<p>Whether some idea is "natural" / "unnatural" is a subjective opinion, we apparently cannot resolve it here :-).<br>
But my question was somewhat different, let's phrase it without naturals.<br>
Let's say, I have a type <code>α</code>, and I would like to have a subtraction such that <code>(x-y : β)</code> for any <code>x y : α</code>. Would it be possible?</p>



<a name="192912107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912107">(Apr 04 2020 at 15:12)</a>:</h4>
<p>If you edit core lean, yes</p>



<a name="192912114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912114">(Apr 04 2020 at 15:12)</a>:</h4>
<p>Do you understand typeclass notation?</p>



<a name="192912115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912115">(Apr 04 2020 at 15:12)</a>:</h4>
<p>It's not possible with the current definition of <code>has_sub.sub</code> and with <code>-</code> being notation for <code>has_sub.sub</code>. If you want to change everything, then anything is possible.</p>



<a name="192912190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912190">(Apr 04 2020 at 15:14)</a>:</h4>
<p>Look at the definition of - and then look at the definition of has_sub and then there you are at one of the first lean files lean ever reads when starting up and that's the line you have to change and it will break everything that comes later</p>



<a name="192912314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912314">(Apr 04 2020 at 15:16)</a>:</h4>
<p>I understand typeclasses just roughly. If I wrote  (sub : α → α → β) in the core instead, and kept all the instances of <code>has_sub</code> as they are now, what would break?</p>



<a name="192912332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912332">(Apr 04 2020 at 15:17)</a>:</h4>
<p>nothing. except all of core and mathlib</p>



<a name="192912336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912336">(Apr 04 2020 at 15:17)</a>:</h4>
<p>:D</p>



<a name="192912438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912438">(Apr 04 2020 at 15:18)</a>:</h4>
<p>One issue with a subtraction function like that is that the type is not determined by the input</p>



<a name="192912455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912455">(Apr 04 2020 at 15:18)</a>:</h4>
<p>if you write <code>let z := x - y</code>, lean has no idea what type <code>z</code> has, so it can't even find out if the subtraction typeclass exists</p>



<a name="192912480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912480">(Apr 04 2020 at 15:19)</a>:</h4>
<p>so you would probably want beta to be an <code>out_param</code>, essentially saying that subtraction maps each type with a subtraction operation to a unique other type</p>



<a name="192912618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912618">(Apr 04 2020 at 15:22)</a>:</h4>
<p>I see, <code>out_param</code> like in <code>is_mem</code>.</p>



<a name="192912641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912641">(Apr 04 2020 at 15:23)</a>:</h4>
<p>But this causes problems elsewhere. For example, assuming that this isn't just a hack to support <code>nat</code> specifically, we might want a generalized version of the construction, for example mapping any semiring <code>R</code> to a new type <code>integral_closure R</code> formed by taking formal subtractions of elements of <code>R</code>. But then we have a conflict because a ring is a semiring, so the subtraction on <code>R</code> would land in both <code>R</code> and <code>integral_closure R</code> (which is isomorphic to <code>R</code>)</p>



<a name="192912687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912687">(Apr 04 2020 at 15:24)</a>:</h4>
<p>Mario we have monoid localisation thanks to <span class="user-mention" data-user-id="118107">@Amelia Livingston</span>  :-)</p>



<a name="192912762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912762">(Apr 04 2020 at 15:26)</a>:</h4>
<p>Ring is a semiring? I thought there is just coercion to semiring.</p>



<a name="192912808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912808">(Apr 04 2020 at 15:26)</a>:</h4>
<p>The type is the same, there is no coercion, but the typeclasses are in a parent relationship</p>



<a name="192912833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192912833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miroslav Olšák <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192912833">(Apr 04 2020 at 15:27)</a>:</h4>
<p>OK, I think I understand why it is so problematic.</p>



<a name="192913074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192913074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192913074">(Apr 04 2020 at 15:32)</a>:</h4>
<p>In 99% of use cases, if a and b have type R then you really want a-b to have type R. So you can see why they went for this design decision.</p>



<a name="192913230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/integer%20subtraction%20/%20rational%20division/near/192913230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/integer.20subtraction.20.2F.20rational.20division.html#192913230">(Apr 04 2020 at 15:36)</a>:</h4>
<p>However there is clearly a dichotomy because there are loads of lemmas called things like <code>sub_add_cancel</code> or whatever, that have versions <code>nat.sub_add_cancel</code>, so the contentious design decision of using this notation for natural subtraction has caused problems down the line. However without editing any Lean you could define a new kind of subtraction sub' with a different notation which mapped nat x nat to int. But then you'd realise that it didn't really fix any of the problems because now you'll need nat.sub'_add_cancel as well, which will say that some integer equals a coercion to integer of some natural.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>