---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Fully.20applied.20lemmas.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html">Fully applied lemmas</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="217828890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217828890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217828890">(Nov 24 2020 at 23:45)</a>:</h4>
<p>Why are lemmas like <code>list.map_id</code> stated in fully applied form, as opposed to using <code>funext</code>?</p>



<a name="217828954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217828954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217828954">(Nov 24 2020 at 23:46)</a>:</h4>
<p>If I have <code>list.map (list.map id) l</code> for some <code>l : list (list a)</code>, that doesn't simplify currently.</p>



<a name="217830118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217830118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217830118">(Nov 25 2020 at 00:01)</a>:</h4>
<p>Because the normal thing to do with a function is apply it to something, and often the right hand side should be simplified more after being applied to something.</p>



<a name="217830193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217830193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217830193">(Nov 25 2020 at 00:02)</a>:</h4>
<p>Sometimes we do have both versions, as in <a href="https://github.com/leanprover-community/mathlib/blob/7e66984cb1cd5b4262d8dd0ee775cd212e56c9e7/src/data/equiv/basic.lean#L180">https://github.com/leanprover-community/mathlib/blob/7e66984cb1cd5b4262d8dd0ee775cd212e56c9e7/src/data/equiv/basic.lean#L180</a> and following.</p>



<a name="217830906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217830906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217830906">(Nov 25 2020 at 00:11)</a>:</h4>
<p>I understand -- but what would be the downside of providing a <code>@[simp] lemma list.map_id'' : list.map (@id a) = id</code> also/instead? The current <code>list.map_id</code> does two simplifcation steps, <code>[list.map_id'', id.def]</code></p>



<a name="217830993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217830993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217830993">(Nov 25 2020 at 00:12)</a>:</h4>
<p>In other words, should a "lawful" <code>map</code> lemma be stated in applied or not-applied form? Should <code>list.map_id''</code> be added to mathlib?</p>



<a name="217831390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831390">(Nov 25 2020 at 00:18)</a>:</h4>
<p>Seems like a reasonable addition, though it would be nonconfluent if marked <code>simp</code> (and I'm not sure why it needs two <code>'</code>s)</p>



<a name="217831420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831420">(Nov 25 2020 at 00:19)</a>:</h4>
<p>oh, <code>id</code> does have a simp lemma</p>



<a name="217831436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831436">(Nov 25 2020 at 00:19)</a>:</h4>
<p>Because there is a <code>list.map_id'</code>.</p>



<a name="217831479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831479">(Nov 25 2020 at 00:20)</a>:</h4>
<p>I don't see it</p>



<a name="217831501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831501">(Nov 25 2020 at 00:20)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">map_id'</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">map</span> <span class="n">f</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">induction</span> <span class="n">l</span><span class="bp">;</span> <span class="o">[</span><span class="n">refl</span><span class="o">,</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">*</span><span class="o">,</span> <span class="n">map</span><span class="o">]]</span><span class="bp">;</span> <span class="n">split</span><span class="bp">;</span> <span class="n">refl</span>
</code></pre></div>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/list.map_id'">docs#list.map_id'</a></p>



<a name="217831503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831503">(Nov 25 2020 at 00:20)</a>:</h4>
<p>oh, it's somewhere else. In fact, doesn't it solve your problem?</p>



<a name="217831694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831694">(Nov 25 2020 at 00:23)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.list</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">list</span> <span class="n">α</span><span class="o">)}</span> <span class="o">:</span> <span class="n">list.map</span> <span class="o">(</span><span class="n">list.map</span> <span class="n">id</span><span class="o">)</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">simp</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">simplify tactic failed to simplify</span>
<span class="cm">state:</span>
<span class="cm">α : Type ?,</span>
<span class="cm">l : list (list α)</span>
<span class="cm">⊢ list.map (list.map id) l = l</span>
<span class="cm">-/</span>

<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">list.map_id''</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">:</span> <span class="n">list.map</span> <span class="o">(</span><span class="bp">@</span><span class="n">id</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="n">id</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">funext</span><span class="o">,</span> <span class="n">exact</span> <span class="n">list.map_id</span> <span class="n">_</span> <span class="o">}</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">list</span> <span class="n">α</span><span class="o">)}</span> <span class="o">:</span> <span class="n">list.map</span> <span class="o">(</span><span class="n">list.map</span> <span class="n">id</span><span class="o">)</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">simp</span>
<span class="c1">-- that is now fine</span>
</code></pre></div>



<a name="217831713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831713">(Nov 25 2020 at 00:23)</a>:</h4>
<p>Ah, you meant <code>simp [list.map_id']</code></p>



<a name="217831803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831803">(Nov 25 2020 at 00:24)</a>:</h4>
<p>I see. Well, I guess then I'm just surprised <code>list.map_id'</code> isn't tagged with <code>@[simp]</code></p>



<a name="217831854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831854">(Nov 25 2020 at 00:25)</a>:</h4>
<p>If there's no reason not to tag it, that's a simple change. If there is a reason not to tag it, just trying to understand what the reason would be.</p>



<a name="217831958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217831958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217831958">(Nov 25 2020 at 00:26)</a>:</h4>
<p>Your <code>map_id''</code> seems like a better candidate for a simp lemma</p>



<a name="217832108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Fully%20applied%20lemmas/near/217832108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Fully.20applied.20lemmas.html#217832108">(Nov 25 2020 at 00:28)</a>:</h4>
<p><span aria-label="frown" class="emoji emoji-1f641" role="img" title="frown">:frown:</span> <code>is_lawful_functor.id_map</code> is also in fully applied form</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>