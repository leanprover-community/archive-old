---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/simple.20equations.20in.20pnat.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html">simple equations in pnat</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="222312331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222312331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222312331">(Jan 11 2021 at 15:33)</a>:</h4>
<p>Hi! I'm playing around with some simple equations and inequalities in <code>pnat</code> and it seems to be much more cumbersome than doing the same in <code>nat</code>.  Especially since many tactics like <code>simp</code> and <code>linarithm</code> don't work. <br>
Here's an example of a really simple lemma:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">simple_ineq</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span><span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">):</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="k">let</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">coerce</span><span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">c</span> <span class="bp">↔</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">&lt;</span> <span class="bp">↑</span><span class="n">c</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">refl</span><span class="o">,</span>
    <span class="k">let</span> <span class="n">nb</span> <span class="o">:=</span> <span class="bp">↑</span><span class="n">b</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">bneq</span><span class="o">:</span> <span class="n">nb</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply</span> <span class="n">pnat.ne_zero</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">bpoa</span><span class="o">:</span> <span class="n">nb</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">aplusb</span><span class="o">:</span> <span class="bp">↑</span><span class="n">a</span>  <span class="bp">&lt;</span>  <span class="bp">↑</span><span class="n">a</span> <span class="bp">+</span> <span class="n">nb</span>  <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">aplusb</span><span class="o">,</span>
  <span class="kd">end</span>
</code></pre></div>
<p>What are better ways of doing that?</p>



<a name="222314889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222314889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222314889">(Jan 11 2021 at 15:50)</a>:</h4>
<p>Here's an example with a slightly more involved inequality:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">larger_ineq</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">z</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="o">):</span>
 <span class="bp">¬</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">z</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">z</span> <span class="o">:=</span> <span class="kd">by</span> <span class="gr">sorry</span><span class="o">,</span>
</code></pre></div>



<a name="222315923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222315923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222315923">(Jan 11 2021 at 15:57)</a>:</h4>
<p>Taking the pnats apart seems to be more effective: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.pnat.basic</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">lemma</span> <span class="n">simple_ineq</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">,</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rintro</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">hb</span><span class="o">⟩,</span>
  <span class="k">show</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222316011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222316011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222316011">(Jan 11 2021 at 15:58)</a>:</h4>
<p>I was surprised that <code>norm_cast</code> couldn't handle that show line for me</p>



<a name="222316107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222316107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222316107">(Jan 11 2021 at 15:58)</a>:</h4>
<p>thanks, that's perfect!</p>



<a name="222316538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222316538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222316538">(Jan 11 2021 at 16:01)</a>:</h4>
<p>This looks like it makes progress on the second case:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">larger_ineq</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">z</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">¬</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">z</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">z</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">hy</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">y</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hz</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">z</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span><span class="n">pnat.coe_lt_coe</span><span class="o">]</span> <span class="n">at</span> <span class="bp">⊢</span> <span class="n">h</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222316666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222316666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222316666">(Jan 11 2021 at 16:02)</a>:</h4>
<p>Indeed, <code>linarith</code> closes the goal</p>



<a name="222316670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222316670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222316670">(Jan 11 2021 at 16:02)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.pnat.basic</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">lemma</span> <span class="n">larger_ineq</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">z</span> <span class="bp">&lt;</span> <span class="n">y</span><span class="o">):</span>
  <span class="bp">¬</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">z</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">z</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">x</span> <span class="k">with</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">y</span> <span class="k">with</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">z</span> <span class="k">with</span> <span class="n">z</span> <span class="n">hz</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span><span class="n">pnat.coe_lt_coe</span><span class="o">]</span> <span class="n">at</span> <span class="bp">⊢</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222316680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222316680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222316680">(Jan 11 2021 at 16:02)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/pnat.coe_lt_coe">docs#pnat.coe_lt_coe</a></p>



<a name="222316726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222316726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222316726">(Jan 11 2021 at 16:02)</a>:</h4>
<p>nice</p>



<a name="222355928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222355928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222355928">(Jan 11 2021 at 20:46)</a>:</h4>
<p>Here's another one I'm struggling with, this time an equation for a change:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">eq_with_2</span> <span class="o">(</span><span class="n">x</span> <span class="n">z</span><span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">h_2</span><span class="o">:</span> <span class="bp">¬</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">&lt;</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span><span class="o">):</span>
 <span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="o">:=</span>
 <span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">z</span><span class="o">,</span> <span class="n">hz</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">z</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span><span class="n">pnat.coe_inj</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">pnat.sub_coe</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">pnat.mul_coe</span><span class="o">,</span> <span class="n">pnat.add_coe</span><span class="o">],</span>
  <span class="gr">sorry</span><span class="o">,</span>
 <span class="kd">end</span>
</code></pre></div>
<p>Can this start be finished? Is there a better way to do that?</p>



<a name="222357213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222357213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222357213">(Jan 11 2021 at 20:59)</a>:</h4>
<p>Oh lol pnat subtraction is even crazier than nat subtraction! 1-1=1 :D</p>



<a name="222357418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222357418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222357418">(Jan 11 2021 at 21:01)</a>:</h4>
<p><code>generalize : y = 2*z</code> at the start of the proof would help clean up the goal slightly</p>



<a name="222357594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222357594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222357594">(Jan 11 2021 at 21:02)</a>:</h4>
<p>I am getting lazy and I don't want to do this one. Instead I am going to challenge the very idea that you ever want to be using <code>-</code> at all when working with pnats. Are you absolutely sure that you can't do what you want to do with addition instead? There seems to be a missing lemma <code>pnat.add_sub_cancel : a + b - b = a</code>and using this it's easy. Feel free to prove it yourself and PR it if you really feel you need it! But why all this pnat subtraction? If I ever do a subtraction in nat I know I'm doing it wrong.</p>



<a name="222358536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222358536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222358536">(Jan 11 2021 at 21:11)</a>:</h4>
<p>As a fun exercise I'm trying to proof sum_two_squares in a different way, using Zagier's <a href="https://people.mpim-bonn.mpg.de/zagier/files/doi/10.2307/2323918/fulltext.pdf">"one sentence proof"</a>. To this end I defined an involution</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">zagier_involution</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span>  <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span> <span class="bp">×</span> <span class="n">ℕ</span><span class="bp">+</span> <span class="bp">×</span> <span class="n">ℕ</span><span class="bp">+</span> <span class="o">:=</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">z</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="n">y</span> <span class="k">then</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span><span class="bp">*</span><span class="n">z</span><span class="o">,</span> <span class="n">z</span><span class="o">,</span> <span class="n">y</span> <span class="bp">-</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">z</span><span class="o">)</span> <span class="k">else</span>
      <span class="o">(</span><span class="k">if</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="mi">2</span><span class="bp">*</span><span class="n">y</span>  <span class="k">then</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">z</span><span class="o">)</span> <span class="k">else</span>
                        <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="mi">2</span><span class="bp">*</span><span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">z</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="o">)</span>
</code></pre></div>
<p>and when trying to proof that it really is an involution, I started </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">zinvolu</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">}:</span> <span class="n">zagier_involution</span>
<span class="o">(</span><span class="n">zagier_involution</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span>
<span class="o">(</span><span class="n">zagier_involution</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="bp">.</span><span class="mi">1</span>
<span class="o">(</span><span class="n">zagier_involution</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">=</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="o">):=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">zagier_involution</span><span class="o">],</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">zagier_involution</span><span class="o">],</span>
  <span class="n">split_ifs</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>Then there is 9 subcases, each of which can either be done by showing the case can never happen by showing some contradiction between inequalities or showing that the case is true by showing some equalities. <br>
I didn't know that pnat is more cumbersome than nat...</p>



<a name="222358893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222358893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222358893">(Jan 11 2021 at 21:14)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data.pnat.basic</span>

<span class="c1">-- this could be in mathlib</span>
<span class="kd">lemma</span> <span class="n">pnat.add_sub_cancel</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">-</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">pnat.eq</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">pnat.sub_coe</span><span class="o">,</span> <span class="n">if_pos</span><span class="o">],</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">nat.add_sub_cancel</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">lt_add_of_pos_left</span> <span class="n">b.1</span> <span class="n">a.pos</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">eq_with_2</span> <span class="o">(</span><span class="n">x</span> <span class="n">z</span><span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">(</span><span class="n">h_2</span><span class="o">:</span> <span class="bp">¬</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">&lt;</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span><span class="o">):</span>
 <span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">pnat.add_sub_cancel</span> <span class="n">_</span> <span class="n">_</span>
</code></pre></div>



<a name="222359115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222359115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222359115">(Jan 11 2021 at 21:16)</a>:</h4>
<p><code>pnat</code> is just less used. An alternative is to develop a robust library for <code>pnat</code>! I think your reponse is perfectly adequate, and a good justification for pnat subtraction.</p>



<a name="222359363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222359363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222359363">(Jan 11 2021 at 21:18)</a>:</h4>
<p>I also did this as a "fun exercise" when I first started, it might not be as fun as you think <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span> (mine ended up at 650 lines, but mathlib has moved on a lot since then so I imagine its possible to do it in way less). I highly recommend using Z when dealing with subtraction, it will save you a lot of pain if you only have to show in one point of the proof that some statement about integers implies some statement about naturals, rather than worrying about an inequality every time you use a - sign.</p>



<a name="222359488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222359488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222359488">(Jan 11 2021 at 21:20)</a>:</h4>
<p>A cleaned up and nicely documented version of this would be a good proof to include in mathlib's <code>/archive</code>.</p>



<a name="222359642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222359642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222359642">(Jan 11 2021 at 21:22)</a>:</h4>
<p>Yes, it might be easier to define this involution on the finite set Zagier isolates, and let x, y, z be positive integers rather than pnats. You'll have to insert proofs that various things are positive in your definition of the involution, but <code>linarith</code> should be able to deal with them relatively easily. This would probably be a less painful way of doing what you're doing. You're in some sense skipping the work that various things are positive, and then all of a sudden it all hits you at once when you're trying to use your definition.</p>



<a name="222359733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222359733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222359733">(Jan 11 2021 at 21:23)</a>:</h4>
<p>Cool, thanks <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>.  After reading <span class="user-mention" data-user-id="127136">@Alex J. Best</span> 's comment, it seems like I will go with <code>\N</code> instead of <code>\N+</code> for now.</p>



<a name="222359777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222359777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222359777">(Jan 11 2021 at 21:23)</a>:</h4>
<p>Alex is suggesting Z not N! N is almost as horrible as pnat!</p>



<a name="222359852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222359852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222359852">(Jan 11 2021 at 21:24)</a>:</h4>
<p>ok, I see, makes sense</p>



<a name="222359967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222359967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222359967">(Jan 11 2021 at 21:25)</a>:</h4>
<p>Ask yourself what function Zagier is using when he's talking about subtraction. Is he using some weird function which thinks 2-3=0 (nat) or 1 (pnat)? No, he's using a function which has much nicer properties -- integer subtraction, a.k.a. "subtraction" (to mathematicians -- these pathological functions on nat and pnat do not deserve the name subtraction). So you should use subtraction too and use int, for minimal pain.</p>



<a name="222361170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222361170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222361170">(Jan 11 2021 at 21:36)</a>:</h4>
<p>I'd be tempted to start like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">data.nat.prime</span>

<span class="kd">def</span> <span class="n">S</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">{</span><span class="n">c</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">×</span> <span class="n">ℤ</span> <span class="bp">×</span> <span class="n">ℤ</span> <span class="bp">|</span> <span class="k">let</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span> <span class="n">c</span> <span class="k">in</span>
    <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="bp">∧</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">y</span> <span class="bp">∧</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">z</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">4</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">p</span><span class="o">}</span>

<span class="kd">lemma</span> <span class="n">mem_S_iff</span> <span class="o">(</span><span class="n">p</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">S</span> <span class="n">p</span> <span class="bp">↔</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="bp">∧</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">y</span> <span class="bp">∧</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">z</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">4</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">p</span> <span class="o">:=</span> <span class="n">iff.rfl</span>

<span class="kd">def</span> <span class="n">aux_lemma_1</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">S</span> <span class="n">p</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">≠</span> <span class="n">y</span> <span class="bp">-</span> <span class="n">z</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">def</span> <span class="n">aux_lemma_2</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">S</span> <span class="n">p</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">y</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">def</span> <span class="n">zagier_involution</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">:</span> <span class="n">S</span> <span class="n">p</span> <span class="bp">→</span> <span class="n">S</span> <span class="n">p</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">c</span><span class="o">,</span> <span class="k">let</span> <span class="o">⟨(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">z</span><span class="o">),</span> <span class="n">h1</span><span class="o">,</span> <span class="n">h2</span><span class="o">,</span> <span class="n">h3</span><span class="o">,</span> <span class="n">h4</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">c</span> <span class="k">in</span>
<span class="k">if</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="n">y</span> <span class="bp">-</span> <span class="n">z</span> <span class="k">then</span> <span class="o">⟨(</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">z</span><span class="o">,</span> <span class="n">z</span><span class="o">,</span> <span class="n">y</span> <span class="bp">-</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">z</span><span class="o">),</span> <span class="gr">sorry</span><span class="o">⟩</span> <span class="k">else</span>
<span class="k">if</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="k">then</span> <span class="o">⟨(</span><span class="n">x</span> <span class="bp">-</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">z</span><span class="o">,</span> <span class="n">y</span><span class="o">),</span> <span class="gr">sorry</span><span class="o">⟩</span> <span class="k">else</span>
<span class="o">⟨(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">-</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">y</span> <span class="bp">+</span> <span class="n">z</span><span class="o">),</span> <span class="gr">sorry</span><span class="o">⟩</span>
</code></pre></div>
<p>Those sorries should be far less painful to fill in.</p>



<a name="222361379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222361379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222361379">(Jan 11 2021 at 21:38)</a>:</h4>
<p>Don is prone to exaggeration -- the implicit assumptions here show that really it is not a one-line proof, although the details he omits are not difficult. All these sorries are now statements about integers, so you have access to <code>linarith</code> and <code>ring</code> etc.</p>



<a name="222362607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simple%20equations%20in%20pnat/near/222362607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simple.20equations.20in.20pnat.html#222362607">(Jan 11 2021 at 21:48)</a>:</h4>
<p>Thanks that looks like a good start.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>