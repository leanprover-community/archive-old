---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html">proving things about functions defined by cases</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="197866250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197866250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197866250">(May 17 2020 at 19:58)</a>:</h4>
<p>How do I complete the following?</p>
<div class="codehilite"><pre><span></span><code><span class="n">noncomputable</span> <span class="n">def</span> <span class="n">f</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">decidable</span> <span class="o">(</span><span class="n">x</span> <span class="bp">=</span> <span class="mi">5</span><span class="o">),</span>
        <span class="n">apply</span> <span class="n">classical</span><span class="bp">.</span><span class="n">prop_decidable</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">this</span><span class="o">,</span>
        <span class="n">exact</span> <span class="mi">1</span><span class="o">,</span>
        <span class="n">exact</span> <span class="mi">2</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">f</span> <span class="mi">5</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>I don't know what tactic to use to try to split into the cases by which <code>f</code> was defined.</p>
<p>Also,  is there a way to clean up my definition to get rid of the <code>have : decidable (x=5)</code>?</p>
<p>Note: I know that I don't need classical reasoning for decidability of = in <code>nat</code>, but this is just an example.</p>



<a name="197866428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197866428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197866428">(May 17 2020 at 20:03)</a>:</h4>
<p>Here's how I'd write your example:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">f</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span>
<span class="k">if</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">5</span>
  <span class="k">then</span> <span class="mi">1</span>
  <span class="k">else</span> <span class="mi">2</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">f</span> <span class="mi">5</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="n">rfl</span>
</code></pre></div>



<a name="197866437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197866437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197866437">(May 17 2020 at 20:03)</a>:</h4>
<p>You can use the <code>split_ifs</code> tactic in more complex examples to break up an if in general</p>



<a name="197866479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197866479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197866479">(May 17 2020 at 20:04)</a>:</h4>
<p>You could alternatively do:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">f</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span>
<span class="bp">|</span> <span class="mi">5</span> <span class="o">:=</span> <span class="mi">1</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span> <span class="mi">2</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">f</span> <span class="mi">5</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="n">rfl</span>
</code></pre></div>



<a name="197866506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197866506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197866506">(May 17 2020 at 20:05)</a>:</h4>
<p>Alternatively,</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">f</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">by_cases</span> <span class="o">(</span><span class="n">n</span> <span class="bp">=</span> <span class="mi">5</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="mi">1</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="mi">2</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">f</span> <span class="mi">5</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="n">rfl</span>
</code></pre></div>



<a name="197867044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197867044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197867044">(May 17 2020 at 20:18)</a>:</h4>
<p><span class="user-mention" data-user-id="246273">@Bhavik Mehta</span>  Thanks for the info on cleaning up the definitions. </p>
<p>Lean isn't recognizing <code>split_ifs</code>; what should I import to make it work?</p>



<a name="197867053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197867053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197867053">(May 17 2020 at 20:19)</a>:</h4>
<p><code>import tactic</code> gets you a bunch of things</p>



<a name="197867057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197867057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197867057">(May 17 2020 at 20:19)</a>:</h4>
<p>the precise import is <code>import tactic.split_ifs</code></p>



<a name="197867066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197867066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197867066">(May 17 2020 at 20:19)</a>:</h4>
<p>I'm getting <code>file 'tactic' not found in the LEAN_PATH</code></p>



<a name="197867128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197867128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197867128">(May 17 2020 at 20:20)</a>:</h4>
<p>I'm not using anything from mathlib right now, likely has something to do with that. Do I need to read about the mathlib projects thing to get this to work?</p>



<a name="197867137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197867137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197867137">(May 17 2020 at 20:20)</a>:</h4>
<p>Yes, see the instructions <a href="https://leanprover-community.github.io/install/project.html">here</a>.</p>



<a name="197867157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197867157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197867157">(May 17 2020 at 20:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="300684">Keefer Rowan</span> <a href="#narrow/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases/near/197867128">said</a>:</p>
<blockquote>
<p>I'm not using anything from mathlib right now, likely has something to do with that. Do I need to read about the mathlib projects thing to get this to work?</p>
</blockquote>
<p>It may sound scary but actually should be pretty easy, if you follow instructions precisely you should be able to start using mathlib in just a few minutes without entering more than 10 terminal commands</p>



<a name="197867199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197867199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197867199">(May 17 2020 at 20:22)</a>:</h4>
<p>Ok, I'll start working on it</p>



<a name="197868133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868133">(May 17 2020 at 20:47)</a>:</h4>
<p><code>split_ifs</code> isn't working.</p>
<p>Here's where I am; I can't come up with a shorter example (and this is reasonably short and self-contained) so here it is:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">open</span> <span class="n">classical</span> <span class="n">function</span>

<span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">classical</span><span class="bp">.</span><span class="n">prop_decidable</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span>

<span class="n">def</span> <span class="n">injection</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
    <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span>

<span class="n">def</span> <span class="n">left_inv</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
    <span class="n">g</span> <span class="err">∘</span> <span class="n">f</span>  <span class="bp">=</span> <span class="n">id</span>

<span class="n">def</span> <span class="n">has_left_inv</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
    <span class="bp">∃</span> <span class="n">g</span><span class="o">,</span> <span class="n">left_inv</span> <span class="n">f</span> <span class="n">g</span>


<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">left_inv_func</span> <span class="o">[</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">α</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">by_cases</span> <span class="o">(</span><span class="n">b</span> <span class="err">∈</span> <span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">f</span> <span class="n">set</span><span class="bp">.</span><span class="n">univ</span><span class="o">),</span>
        <span class="o">{</span><span class="n">unfold</span> <span class="n">set</span><span class="bp">.</span><span class="n">image</span> <span class="n">has_mem</span><span class="bp">.</span><span class="n">mem</span> <span class="n">set</span><span class="bp">.</span><span class="n">mem</span> <span class="n">set_of</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
        <span class="n">exact</span> <span class="n">some</span> <span class="n">h</span><span class="o">},</span>
        <span class="o">{</span><span class="n">exact</span> <span class="n">h₁</span><span class="bp">.</span><span class="n">default</span><span class="o">}</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">injection_left_inv_iff</span> <span class="o">[</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">:</span> <span class="n">injection</span> <span class="n">f</span> <span class="bp">↔</span> <span class="n">has_left_inv</span> <span class="n">f</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">split</span><span class="bp">;</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
        <span class="o">{</span><span class="k">let</span> <span class="n">g</span><span class="o">:=</span> <span class="n">left_inv_func</span> <span class="n">f</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">exists</span><span class="bp">.</span><span class="n">intro</span> <span class="n">g</span><span class="o">,</span>
        <span class="n">unfold</span> <span class="n">left_inv</span><span class="o">,</span>
        <span class="n">unfold</span> <span class="n">comp</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">funext</span><span class="o">,</span>
        <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
        <span class="n">simp</span><span class="o">,</span>
        <span class="n">split_ifs</span><span class="o">,}</span>
<span class="kn">end</span>
</code></pre></div>


<p>I'm getting the error: <code>no if-then-else expressions to split</code>. How should I finish this proof?</p>



<a name="197868309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868309">(May 17 2020 at 20:50)</a>:</h4>
<p>You should not use tactics to define data (the function <code>left_inv_func</code>)</p>



<a name="197868322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868322">(May 17 2020 at 20:51)</a>:</h4>
<p>instead, use <code>\lam b, if h : b ∈ set.image f set.univ then some h else h₁.default</code></p>



<a name="197868324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868324">(May 17 2020 at 20:51)</a>:</h4>
<p>and then the theorem can use <code>split_ifs</code> profitably</p>



<a name="197868432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868432">(May 17 2020 at 20:54)</a>:</h4>
<p>I assumed that this tactic will generate the same definition.</p>



<a name="197868453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868453">(May 17 2020 at 20:55)</a>:</h4>
<p><span class="user-mention" data-user-id="300684">@Keefer Rowan</span> You can always look at the actual definition using <code>#print left_inv_func</code></p>



<a name="197868526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868526">(May 17 2020 at 20:56)</a>:</h4>
<p>Non-tactic definition:</p>
<div class="codehilite"><pre><span></span><code><span class="n">noncomputable</span> <span class="n">def</span> <span class="n">function</span><span class="bp">.</span><span class="n">left_inv_func</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">inhabited</span> <span class="n">α</span><span class="o">],</span> <span class="o">(</span><span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">α</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">),</span>
  <span class="n">dite</span> <span class="o">(</span><span class="n">b</span> <span class="err">∈</span> <span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">set</span><span class="bp">.</span><span class="n">univ</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">b</span> <span class="err">∈</span> <span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">set</span><span class="bp">.</span><span class="n">univ</span><span class="o">),</span> <span class="n">some</span> <span class="n">h</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">b</span> <span class="err">∉</span> <span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">set</span><span class="bp">.</span><span class="n">univ</span><span class="o">),</span> <span class="n">default</span> <span class="n">α</span><span class="o">)</span>
</code></pre></div>


<p>Tactic definition :</p>
<div class="codehilite"><pre><span></span><code><span class="n">noncomputable</span> <span class="n">def</span> <span class="n">function</span><span class="bp">.</span><span class="n">left_inv_func</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">inhabited</span> <span class="n">α</span><span class="o">],</span> <span class="o">(</span><span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">α</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">),</span>
  <span class="n">dite</span> <span class="o">(</span><span class="n">b</span> <span class="err">∈</span> <span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">set</span><span class="bp">.</span><span class="n">univ</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">b</span> <span class="err">∈</span> <span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">set</span><span class="bp">.</span><span class="n">univ</span><span class="o">),</span> <span class="n">some</span> <span class="bp">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">b</span> <span class="err">∉</span> <span class="n">f</span> <span class="err">&#39;&#39;</span> <span class="n">set</span><span class="bp">.</span><span class="n">univ</span><span class="o">),</span> <span class="n">default</span> <span class="n">α</span><span class="o">)</span>
</code></pre></div>


<p>They are indeed the same, and so I'm still stuck. Even with the non-tactic definition, <code>split_ifs</code> doesn't work.</p>



<a name="197868547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868547">(May 17 2020 at 20:57)</a>:</h4>
<p>When you call <code>split_ifs</code>, <code>dite</code> should be visible in the goal</p>



<a name="197868548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868548" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868548">(May 17 2020 at 20:57)</a>:</h4>
<p>It looks like you are not unfolding <code>left_inv_func</code>, so there is no <code>if</code> visible.</p>



<a name="197868609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868609">(May 17 2020 at 20:59)</a>:</h4>
<p>BTW, we already have this as <code>inv_fun_on</code>/<code>inv_fun</code> in <code>logic/function/basic</code></p>



<a name="197868695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868695">(May 17 2020 at 21:00)</a>:</h4>
<p>Ok, I assumed it would do the unfolding, but it is (mostly) working after unfolding, however, I can only get the unfold to work if if I have:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">injection_left_inv_iff</span> <span class="o">[</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">:</span> <span class="n">injection</span> <span class="n">f</span> <span class="bp">↔</span> <span class="n">has_left_inv</span> <span class="n">f</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">split</span><span class="bp">;</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
        <span class="o">{</span><span class="k">let</span> <span class="n">g</span> <span class="o">:=</span> <span class="n">left_inv_func</span> <span class="n">f</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">exists</span><span class="bp">.</span><span class="n">intro</span> <span class="n">g</span><span class="o">,</span>
        <span class="n">unfold</span> <span class="n">left_inv</span><span class="o">,</span>
        <span class="n">unfold</span> <span class="n">comp</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">funext</span><span class="o">,</span>
        <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
        <span class="n">simp</span><span class="o">,</span>
        <span class="n">unfold</span> <span class="n">left_inv_func</span><span class="o">,}</span>
<span class="kn">end</span>
</code></pre></div>


<p>If I introduce to the notation <code>let g := left_inv_func f</code> e.g. in</p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">injection_left_inv_iff</span> <span class="o">[</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">:</span> <span class="n">injection</span> <span class="n">f</span> <span class="bp">↔</span> <span class="n">has_left_inv</span> <span class="n">f</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">split</span><span class="bp">;</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
        <span class="o">{</span>
<span class="n">apply</span> <span class="n">exists</span><span class="bp">.</span><span class="n">intro</span> <span class="o">(</span><span class="n">left_inv_func</span> <span class="n">f</span><span class="o">),</span>
        <span class="n">unfold</span> <span class="n">left_inv</span><span class="o">,</span>
        <span class="n">unfold</span> <span class="n">comp</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">funext</span><span class="o">,</span>
        <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
        <span class="n">simp</span><span class="o">,</span>
        <span class="n">unfold</span> <span class="n">left_inv_func</span><span class="o">,}</span>
<span class="kn">end</span>
</code></pre></div>



<a name="197868709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868709">(May 17 2020 at 21:00)</a>:</h4>
<p>you have to unfold <code>g</code> as well if you make a <code>let</code></p>



<a name="197868722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868722">(May 17 2020 at 21:01)</a>:</h4>
<p>unfortunately <code>unfold</code> doesn't work on <code>let</code> but <code>dsimp only [g]</code> should</p>



<a name="197868774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868774">(May 17 2020 at 21:02)</a>:</h4>
<p>Sorry a bit confused by those two messages together. How do I unfold <code>g</code>? By <code>dsimp only [g]</code>?</p>



<a name="197868775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868775">(May 17 2020 at 21:02)</a>:</h4>
<p>yes</p>



<a name="197868788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197868788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Keefer Rowan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197868788">(May 17 2020 at 21:02)</a>:</h4>
<p>Ok thanks! It's all coming together now!</p>



<a name="197895784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197895784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197895784">(May 18 2020 at 06:57)</a>:</h4>
<p>Arguably <code>split_ifs</code> should be more aggressive, so that if it fails to find an <code>if</code> statement  it does some amount of unfolding. Where and how much to unfold, of course, is unclear.</p>



<a name="197896453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/proving%20things%20about%20functions%20defined%20by%20cases/near/197896453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/proving.20things.20about.20functions.20defined.20by.20cases.html#197896453">(May 18 2020 at 07:04)</a>:</h4>
<p>Maybe it could take some arguments? So that</p>
<div class="codehilite"><pre><span></span><code><span class="n">dsimp</span> <span class="o">[</span><span class="n">foo</span><span class="o">,</span> <span class="n">bar</span><span class="o">,</span> <span class="n">quux</span><span class="o">],</span> <span class="n">split_ifs</span>
</code></pre></div>


<p>can be written as</p>
<div class="codehilite"><pre><span></span><code><span class="n">split_ifs</span> <span class="o">[</span><span class="n">foo</span><span class="o">,</span> <span class="n">bar</span><span class="o">,</span> <span class="n">quux</span><span class="o">]</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>