---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Pasting.20lemma.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html">Pasting lemma</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="207639291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207639291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207639291">(Aug 21 2020 at 14:19)</a>:</h4>
<p>I tried proving the pasting lemma from general topology and I succeeded, but I can't help but think that there should be a shorter way to prove this. This is my attempt at proving it. I also phrased the theorem myself, so it might also be that some of the difficulties can be resolved by phrasing the theorem better.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">A_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">B_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span><span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">f_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">f</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">g_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">g</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="bp">∃</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">),</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="n">h</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">),</span> <span class="n">h</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">continuous</span> <span class="n">h</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">use</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">),</span> <span class="k">if</span> <span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span>
        <span class="n">intros</span> <span class="n">x</span> <span class="n">xA</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">dif_pos</span><span class="o">,</span>
        <span class="n">assumption</span>
    <span class="o">},</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span>
        <span class="n">intros</span> <span class="n">x</span> <span class="n">xB</span><span class="o">,</span>
        <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
        <span class="o">{</span>
            <span class="n">rw</span> <span class="n">dif_pos</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">feqg</span> <span class="n">x</span> <span class="o">(</span><span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">xB</span><span class="o">),</span>
            <span class="n">assumption</span>
        <span class="o">},</span>
        <span class="o">{</span>   <span class="n">rw</span> <span class="n">dif_neg</span><span class="o">,</span> <span class="n">assumption</span>  <span class="o">}</span>
    <span class="o">},</span>
    <span class="o">{</span>
        <span class="n">rw</span> <span class="n">continuous_iff_continuous_on_univ</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="n">XeqAB</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">continuous_on_iff_is_closed</span><span class="bp">.</span><span class="n">mpr</span><span class="o">,</span>
        <span class="n">intros</span> <span class="n">t</span> <span class="n">t_closed</span><span class="o">,</span>
        <span class="n">use</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="err">∪</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">),</span>
        <span class="n">split</span><span class="o">,</span>
        <span class="o">{</span>
            <span class="n">apply</span> <span class="n">is_closed_union</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">preimage_closed_of_closed</span> <span class="n">f_cont</span> <span class="n">A_closed</span> <span class="n">t_closed</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">preimage_closed_of_closed</span> <span class="n">g_cont</span> <span class="n">B_closed</span> <span class="n">t_closed</span>
        <span class="o">},</span>
        <span class="o">{</span>
            <span class="n">rw</span> <span class="n">XeqAB</span><span class="o">,</span>
            <span class="n">rw</span> <span class="o">[</span><span class="n">inter_univ</span><span class="o">,</span> <span class="n">inter_univ</span><span class="o">],</span>
            <span class="n">ext</span><span class="o">,</span>
            <span class="n">split</span><span class="o">,</span>
            <span class="o">{</span>
                <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">rw</span> <span class="n">mem_union</span> <span class="n">x</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">),</span>
                <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">dif_pos</span> <span class="n">xA</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">left</span><span class="o">,</span>
                    <span class="n">apply</span> <span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">h</span>
                <span class="o">},</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">dif_neg</span> <span class="n">xnA</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">right</span><span class="o">,</span>
                    <span class="n">apply</span> <span class="n">mem_inter</span> <span class="o">(</span><span class="n">exclusionAB</span> <span class="n">XeqAB</span> <span class="n">x</span> <span class="n">xnA</span><span class="o">)</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">assumption</span>
                <span class="o">}</span>
            <span class="o">},</span>
            <span class="o">{</span>
                <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">simp</span><span class="o">,</span>
                <span class="n">rw</span> <span class="n">mem_union</span> <span class="n">x</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">dif_pos</span> <span class="n">xA</span><span class="o">,</span>
                    <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">xAft</span> <span class="bp">|</span> <span class="n">xBgt</span><span class="o">,</span>
                    <span class="o">{</span>   <span class="n">exact</span> <span class="n">xAft</span><span class="bp">.</span><span class="mi">2</span>    <span class="o">},</span>
                    <span class="o">{</span>
                        <span class="n">rw</span> <span class="n">feqg</span> <span class="n">x</span> <span class="o">(</span><span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">1</span><span class="o">),</span>
                        <span class="n">exact</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">2</span>
                    <span class="o">}</span>
                <span class="o">},</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">dif_neg</span> <span class="n">xnA</span><span class="o">,</span>
                    <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">xAft</span> <span class="bp">|</span> <span class="n">xBgt</span><span class="o">,</span>
                    <span class="o">{</span>   <span class="n">exfalso</span><span class="o">,</span> <span class="n">exact</span> <span class="n">xnA</span> <span class="n">xAft</span><span class="bp">.</span><span class="mi">1</span>   <span class="o">},</span>
                    <span class="o">{</span>   <span class="n">exact</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">2</span>    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">},</span>
<span class="kn">end</span>
</code></pre></div>


<p>ExclusionAB is used somewhere and has this code:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">exclusionBA</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">),</span> <span class="n">x</span> <span class="err">∉</span> <span class="n">B</span> <span class="bp">→</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">xuniv</span> <span class="o">:=</span> <span class="n">mem_univ</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">rw</span> <span class="err">←</span> <span class="n">XeqAB</span> <span class="n">at</span> <span class="n">xuniv</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">xuniv</span><span class="o">,</span>
    <span class="o">{</span>   <span class="n">intro</span> <span class="bp">_</span><span class="o">,</span> <span class="n">assumption</span> <span class="o">},</span>
    <span class="o">{</span>   <span class="n">intro</span> <span class="n">xnB</span><span class="o">,</span> <span class="n">exfalso</span><span class="o">,</span> <span class="n">exact</span> <span class="n">xnB</span> <span class="n">xuniv</span> <span class="o">},</span>
<span class="kn">end</span>
</code></pre></div>


<p>I know this is big chunk of code, but I have no idea how to structure this question better. Suggestions are welcome.</p>



<a name="207639436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207639436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207639436">(Aug 21 2020 at 14:20)</a>:</h4>
<p>You should make a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> -- one piece of code which contains all imports, opens, universes, definitions, and which someone can cut and paste and it will work on their machine without any extra stuff or thought. You're nearly there.</p>



<a name="207639470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207639470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207639470">(Aug 21 2020 at 14:20)</a>:</h4>
<p>You still need to put your two pieces of code into one and include all imports</p>



<a name="207639623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207639623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207639623">(Aug 21 2020 at 14:21)</a>:</h4>
<p>I didn't run your code, but the tactic <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#split_ifs">tactic#split_ifs</a> is really useful for doing the sort of thing you are doing in the second set of braces.</p>



<a name="207640193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207640193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207640193">(Aug 21 2020 at 14:26)</a>:</h4>
<p>I believe this is an <a href="https://leanprover-community.github.io/mwe.html">#mwe</a></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">basic</span> <span class="n">topology</span><span class="bp">.</span><span class="n">bases</span> <span class="n">topology</span><span class="bp">.</span><span class="n">metric_space</span><span class="bp">.</span><span class="n">basic</span> <span class="n">topology</span><span class="bp">.</span><span class="n">order</span> <span class="n">topology</span><span class="bp">.</span><span class="n">constructions</span>
<span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">continuous_on</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">function</span> <span class="n">tactic</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">filter</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span> <span class="n">topological_space</span> <span class="n">function</span>

<span class="kn">lemma</span> <span class="n">exclusionAB</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">),</span> <span class="n">x</span> <span class="err">∉</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">B</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">xuniv</span> <span class="o">:=</span> <span class="n">mem_univ</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">rw</span> <span class="err">←</span> <span class="n">XeqAB</span> <span class="n">at</span> <span class="n">xuniv</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">xuniv</span><span class="o">,</span>
    <span class="o">{</span>   <span class="n">intro</span> <span class="n">xnA</span><span class="o">,</span> <span class="n">exfalso</span><span class="o">,</span> <span class="n">exact</span> <span class="n">xnA</span> <span class="n">xuniv</span> <span class="o">},</span>
    <span class="o">{</span>   <span class="n">intro</span> <span class="bp">_</span><span class="o">,</span> <span class="n">assumption</span> <span class="o">},</span>
<span class="kn">end</span>


<span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">A_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">B_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span><span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">f_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">f</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">g_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">g</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="bp">∃</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">),</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="n">h</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">),</span> <span class="n">h</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">continuous</span> <span class="n">h</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">use</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">),</span> <span class="k">if</span> <span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span>
        <span class="n">intros</span> <span class="n">x</span> <span class="n">xA</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">dif_pos</span><span class="o">,</span>
        <span class="n">assumption</span>
    <span class="o">},</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span>
        <span class="n">intros</span> <span class="n">x</span> <span class="n">xB</span><span class="o">,</span>
        <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
        <span class="o">{</span>
            <span class="n">rw</span> <span class="n">dif_pos</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">feqg</span> <span class="n">x</span> <span class="o">(</span><span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">xB</span><span class="o">),</span>
            <span class="n">assumption</span>
        <span class="o">},</span>
        <span class="o">{</span>   <span class="n">rw</span> <span class="n">dif_neg</span><span class="o">,</span> <span class="n">assumption</span>  <span class="o">}</span>
    <span class="o">},</span>
    <span class="o">{</span>
        <span class="n">rw</span> <span class="n">continuous_iff_continuous_on_univ</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="n">XeqAB</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">continuous_on_iff_is_closed</span><span class="bp">.</span><span class="n">mpr</span><span class="o">,</span>
        <span class="n">intros</span> <span class="n">t</span> <span class="n">t_closed</span><span class="o">,</span>
        <span class="n">use</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="err">∪</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">),</span>
        <span class="n">split</span><span class="o">,</span>
        <span class="o">{</span>
            <span class="n">apply</span> <span class="n">is_closed_union</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">preimage_closed_of_closed</span> <span class="n">f_cont</span> <span class="n">A_closed</span> <span class="n">t_closed</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">preimage_closed_of_closed</span> <span class="n">g_cont</span> <span class="n">B_closed</span> <span class="n">t_closed</span>
        <span class="o">},</span>
        <span class="o">{</span>
            <span class="n">rw</span> <span class="n">XeqAB</span><span class="o">,</span>
            <span class="n">rw</span> <span class="o">[</span><span class="n">inter_univ</span><span class="o">,</span> <span class="n">inter_univ</span><span class="o">],</span>
            <span class="n">ext</span><span class="o">,</span>
            <span class="n">split</span><span class="o">,</span>
            <span class="o">{</span>
                <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">rw</span> <span class="n">mem_union</span> <span class="n">x</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">),</span>
                <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">dif_pos</span> <span class="n">xA</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">left</span><span class="o">,</span>
                    <span class="n">apply</span> <span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">h</span>
                <span class="o">},</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">dif_neg</span> <span class="n">xnA</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">right</span><span class="o">,</span>
                    <span class="n">apply</span> <span class="n">mem_inter</span> <span class="o">(</span><span class="n">exclusionAB</span> <span class="n">XeqAB</span> <span class="n">x</span> <span class="n">xnA</span><span class="o">)</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">assumption</span>
                <span class="o">}</span>
            <span class="o">},</span>
            <span class="o">{</span>
                <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">simp</span><span class="o">,</span>
                <span class="n">rw</span> <span class="n">mem_union</span> <span class="n">x</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">dif_pos</span> <span class="n">xA</span><span class="o">,</span>
                    <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">xAft</span> <span class="bp">|</span> <span class="n">xBgt</span><span class="o">,</span>
                    <span class="o">{</span>   <span class="n">exact</span> <span class="n">xAft</span><span class="bp">.</span><span class="mi">2</span>    <span class="o">},</span>
                    <span class="o">{</span>
                        <span class="n">rw</span> <span class="n">feqg</span> <span class="n">x</span> <span class="o">(</span><span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">1</span><span class="o">),</span>
                        <span class="n">exact</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">2</span>
                    <span class="o">}</span>
                <span class="o">},</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">dif_neg</span> <span class="n">xnA</span><span class="o">,</span>
                    <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">xAft</span> <span class="bp">|</span> <span class="n">xBgt</span><span class="o">,</span>
                    <span class="o">{</span>   <span class="n">exfalso</span><span class="o">,</span> <span class="n">exact</span> <span class="n">xnA</span> <span class="n">xAft</span><span class="bp">.</span><span class="mi">1</span>   <span class="o">},</span>
                    <span class="o">{</span>   <span class="n">exact</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">2</span>    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">},</span>
<span class="kn">end</span>
</code></pre></div>



<a name="207640401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207640401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207640401">(Aug 21 2020 at 14:28)</a>:</h4>
<p>So I think the main issue with this code is that you skipped a step--you wanted to talk about gluing continuous functions before developing a way to talk about gluing ordinary functions.</p>



<a name="207640552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207640552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207640552">(Aug 21 2020 at 14:29)</a>:</h4>
<p>I proved something basically equivalent (but with a whole lot of extra language) <a href="https://github.com/rwbarton/lean-homotopy-theory/blob/lean-3.4.2/src/homotopy_theory/topological_spaces/inter_union.lean">here</a>; the file is split in two parts: first gluing in Set and then gluing in Top.</p>



<a name="207640637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207640637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207640637">(Aug 21 2020 at 14:30)</a>:</h4>
<p>So, take pieces of the code and put it in another theorem that tells us there a glued function?</p>



<a name="207640918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207640918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207640918">(Aug 21 2020 at 14:32)</a>:</h4>
<p>So, prove this first?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span>
    <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span><span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span>
    <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="bp">∃</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">),</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="n">h</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">),</span> <span class="n">h</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">sorry</span>
<span class="kn">end</span>
</code></pre></div>



<a name="207641071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207641071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207641071">(Aug 21 2020 at 14:34)</a>:</h4>
<p>First you could construct the glued function. Since it is unique you might as well make it a definition, and not have this <code>∃</code> statement. Then write lemmas saying that it restricts to the original functions.<br>
Then, you can prove that if the inputs are continuous and the sets are closed, the output is continuous.</p>



<a name="207641271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207641271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207641271">(Aug 21 2020 at 14:35)</a>:</h4>
<p>The last part really only needs that the output restricts to the input functions on the two sets (after all, there's only one such function anyways). So you could first prove it in the form: a function whose restrictions to <code>A</code> and <code>B</code> are continuous is itself continuous. Then apply the lemmas from the Set part.</p>



<a name="207642370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207642370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207642370">(Aug 21 2020 at 14:44)</a>:</h4>
<p>I am having some trouble defining the definition for the glued function, I have this</p>
<div class="codehilite"><pre><span></span><code><span class="kn">variables</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
<span class="n">def</span> <span class="n">glued</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span> <span class="bp">→</span> <span class="o">(</span><span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">),</span> <span class="k">if</span> <span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span>
</code></pre></div>


<p>but I don't know how to include <code> ∀ x ∈ A ∩ B, f x = g x</code>.</p>



<a name="207642878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207642878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207642878">(Aug 21 2020 at 14:48)</a>:</h4>
<p>The general principle is that you don't include that in the definition (though you could), as it makes the definition more verbose (for one).<br>
Instead it should be an assumption for any lemmas you prove about this definition, as really the definition only makes sense when it holds.</p>



<a name="207642986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207642986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207642986">(Aug 21 2020 at 14:49)</a>:</h4>
<p>Btw its fine to define a function with named arguments like:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">glued</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">Y</span> <span class="o">:=</span> <span class="k">if</span> <span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span>
</code></pre></div>


<p>instead</p>



<a name="207647039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207647039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207647039">(Aug 21 2020 at 15:21)</a>:</h4>
<p>I tried this, but it is not really shorter, it's just cut into pieces.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">basic</span> <span class="n">topology</span><span class="bp">.</span><span class="n">bases</span> <span class="n">topology</span><span class="bp">.</span><span class="n">metric_space</span><span class="bp">.</span><span class="n">basic</span> <span class="n">topology</span><span class="bp">.</span><span class="n">order</span> <span class="n">topology</span><span class="bp">.</span><span class="n">constructions</span>
<span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">continuous_on</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">function</span> <span class="n">tactic</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">filter</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span> <span class="n">topological_space</span> <span class="n">function</span>

<span class="kn">lemma</span> <span class="n">exclusionAB</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">),</span> <span class="n">x</span> <span class="err">∉</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">B</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">xuniv</span> <span class="o">:=</span> <span class="n">mem_univ</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">rw</span> <span class="err">←</span> <span class="n">XeqAB</span> <span class="n">at</span> <span class="n">xuniv</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">xuniv</span><span class="o">,</span>
    <span class="o">{</span>   <span class="n">intro</span> <span class="n">xnA</span><span class="o">,</span> <span class="n">exfalso</span><span class="o">,</span> <span class="n">exact</span> <span class="n">xnA</span> <span class="n">xuniv</span> <span class="o">},</span>
    <span class="o">{</span>   <span class="n">intro</span> <span class="bp">_</span><span class="o">,</span> <span class="n">assumption</span> <span class="o">},</span>
<span class="kn">end</span>

<span class="n">def</span> <span class="n">glued</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">),</span> <span class="k">if</span> <span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span>

<span class="kn">lemma</span> <span class="n">gluedAf</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span> <span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="o">{</span><span class="n">unfold</span> <span class="n">glued</span><span class="o">,</span> <span class="n">rw</span> <span class="n">dif_pos</span><span class="o">,</span> <span class="n">assumption</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">gluednAf</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∉</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span> <span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="o">{</span><span class="n">unfold</span> <span class="n">glued</span><span class="o">,</span> <span class="n">rw</span> <span class="n">dif_neg</span><span class="o">,</span> <span class="n">assumption</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">gluedABg</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">xB</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="o">{</span> <span class="n">unfold</span> <span class="n">glued</span><span class="o">,</span> <span class="n">rw</span> <span class="n">dif_pos</span><span class="o">,</span> <span class="n">exact</span> <span class="n">feqg</span> <span class="n">x</span> <span class="o">(</span><span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">xB</span><span class="o">),</span> <span class="n">assumption</span> <span class="o">}</span>

<span class="kn">lemma</span> <span class="n">gluedBg</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">xB</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="o">{</span>
        <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
        <span class="o">{</span>   <span class="n">exact</span> <span class="n">gluedABg</span> <span class="n">xA</span> <span class="n">xB</span> <span class="n">f</span> <span class="n">g</span> <span class="n">feqg</span><span class="o">},</span>
        <span class="o">{</span>   <span class="n">exact</span> <span class="n">gluednAf</span> <span class="n">xnA</span> <span class="n">f</span> <span class="n">g</span>  <span class="o">}</span>
    <span class="o">}</span>

<span class="kn">lemma</span> <span class="n">gluing</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span>
    <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">),</span> <span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span>   <span class="n">exact</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">xA</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="n">gluedAf</span> <span class="n">xA</span> <span class="n">f</span> <span class="n">g</span>    <span class="o">},</span>
    <span class="o">{</span>   <span class="n">exact</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">xB</span><span class="o">,</span> <span class="n">gluedBg</span> <span class="n">xB</span> <span class="n">f</span> <span class="n">g</span> <span class="n">feqg</span>   <span class="o">},</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">A_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">B_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span><span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">f_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">f</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">g_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">g</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">((</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">),</span> <span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">))</span> <span class="bp">∧</span> <span class="n">continuous</span> <span class="o">(</span><span class="n">glued</span> <span class="n">A</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">gluing</span> <span class="n">feqg</span><span class="o">,</span>
    <span class="o">{</span>
        <span class="n">rw</span> <span class="n">continuous_iff_continuous_on_univ</span><span class="o">,</span>
        <span class="n">rw</span> <span class="err">←</span> <span class="n">XeqAB</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">continuous_on_iff_is_closed</span><span class="bp">.</span><span class="n">mpr</span><span class="o">,</span>
        <span class="n">intros</span> <span class="n">t</span> <span class="n">t_closed</span><span class="o">,</span>
        <span class="n">use</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="err">∪</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">),</span>
        <span class="n">split</span><span class="o">,</span>
        <span class="o">{</span>
            <span class="n">apply</span> <span class="n">is_closed_union</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">preimage_closed_of_closed</span> <span class="n">f_cont</span> <span class="n">A_closed</span> <span class="n">t_closed</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">preimage_closed_of_closed</span> <span class="n">g_cont</span> <span class="n">B_closed</span> <span class="n">t_closed</span>
        <span class="o">},</span>
        <span class="o">{</span>
            <span class="n">rw</span> <span class="n">XeqAB</span><span class="o">,</span>
            <span class="n">rw</span> <span class="o">[</span><span class="n">inter_univ</span><span class="o">,</span> <span class="n">inter_univ</span><span class="o">],</span>
            <span class="n">ext</span><span class="o">,</span>
            <span class="n">split</span><span class="o">,</span>
            <span class="o">{</span>
                <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">rw</span> <span class="n">mem_union</span> <span class="n">x</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">),</span>
                <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">gluedAf</span> <span class="n">xA</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">left</span><span class="o">,</span>
                    <span class="n">apply</span> <span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">h</span>
                <span class="o">},</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">gluednAf</span> <span class="n">xnA</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">right</span><span class="o">,</span>
                    <span class="n">apply</span> <span class="n">mem_inter</span> <span class="o">(</span><span class="n">exclusionAB</span> <span class="n">XeqAB</span> <span class="n">x</span> <span class="n">xnA</span><span class="o">)</span> <span class="n">h</span><span class="o">,</span>
                    <span class="n">assumption</span>
                <span class="o">}</span>
            <span class="o">},</span>
            <span class="o">{</span>
                <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">simp</span><span class="o">,</span>
                <span class="n">rw</span> <span class="n">mem_union</span> <span class="n">x</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">gluedAf</span> <span class="n">xA</span><span class="o">,</span>
                    <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">xAft</span> <span class="bp">|</span> <span class="n">xBgt</span><span class="o">,</span>
                    <span class="o">{</span>   <span class="n">exact</span> <span class="n">xAft</span><span class="bp">.</span><span class="mi">2</span>    <span class="o">},</span>
                    <span class="o">{</span>
                        <span class="n">rw</span> <span class="n">feqg</span> <span class="n">x</span> <span class="o">(</span><span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">1</span><span class="o">),</span>
                        <span class="n">exact</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">2</span>
                    <span class="o">}</span>
                <span class="o">},</span>
                <span class="o">{</span>
                    <span class="n">rw</span> <span class="n">gluednAf</span> <span class="n">xnA</span><span class="o">,</span>
                    <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">xAft</span> <span class="bp">|</span> <span class="n">xBgt</span><span class="o">,</span>
                    <span class="o">{</span>   <span class="n">exfalso</span><span class="o">,</span> <span class="n">exact</span> <span class="n">xnA</span> <span class="n">xAft</span><span class="bp">.</span><span class="mi">1</span>   <span class="o">},</span>
                    <span class="o">{</span>   <span class="n">exact</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">2</span>    <span class="o">}</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">},</span>
<span class="kn">end</span>
</code></pre></div>



<a name="207648267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207648267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207648267">(Aug 21 2020 at 15:32)</a>:</h4>
<p>Cutting things into smaller pieces is definite progress. Take a look at data.finset.basic .</p>



<a name="207650539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207650539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207650539">(Aug 21 2020 at 15:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="127136">Alex J. Best</span> <a href="#narrow/stream/113489-new-members/topic/Pasting.20lemma/near/207639623">said</a>:</p>
<blockquote>
<p>I didn't run your code, but the tactic <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#split_ifs">tactic#split_ifs</a> is really useful for doing the sort of thing you are doing in the second set of braces.</p>
</blockquote>
<p><span class="user-mention" data-user-id="294534">@Emiel Lanckriet</span> in case you missed it, this tactic will definitely make some of your proofs shorter</p>



<a name="207651134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207651134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207651134">(Aug 21 2020 at 15:57)</a>:</h4>
<p>I tried the split_ifs, but all the goals are of the form if then else = something, so not of the pure form if then else. Or am I missing something?</p>



<a name="207652903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207652903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207652903">(Aug 21 2020 at 16:11)</a>:</h4>
<p>Oh I see, thats what I get for not running the code!</p>



<a name="207655815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207655815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207655815">(Aug 21 2020 at 16:38)</a>:</h4>
<p>This is your statement (without the preliminary lemma that I inlined). Please try to use mathlib indentation and line breaks, it makes everything much easier to read, especially on Zulip.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span>
  <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">A_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">B_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">B</span><span class="o">)</span>
  <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span><span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">f_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">f</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">g_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">g</span> <span class="n">B</span><span class="o">)</span>
  <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">),</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="n">h</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">),</span> <span class="n">h</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">continuous</span> <span class="n">h</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">refine</span> <span class="bp">⟨λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">,</span> <span class="bp">λ</span> <span class="bp">_</span> <span class="n">h</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">],</span> <span class="bp">_</span><span class="o">,</span> <span class="bp">_⟩</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">x_in</span><span class="o">,</span>
    <span class="n">split_ifs</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="n">feqg</span> <span class="bp">_</span> <span class="bp">⟨</span><span class="n">h</span><span class="o">,</span> <span class="n">x_in</span><span class="bp">⟩</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">refl</span> <span class="o">}</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="n">continuous_iff_continuous_on_univ</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">key</span> <span class="o">:</span> <span class="n">closure</span> <span class="n">A</span><span class="err">ᶜ</span> <span class="err">⊆</span> <span class="n">B</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="err">←</span> <span class="n">B_closed</span><span class="bp">.</span><span class="n">closure_eq</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">closure_mono</span><span class="o">,</span>
    <span class="n">rintros</span> <span class="n">x</span> <span class="o">(</span><span class="n">x_not_in</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∉</span> <span class="n">A</span><span class="o">),</span>
    <span class="n">cases</span> <span class="o">(</span><span class="k">show</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">XeqAB</span><span class="o">])</span> <span class="bp">;</span> <span class="n">tauto</span> <span class="o">},</span>
  <span class="n">apply</span> <span class="n">continuous_on_if</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="n">x</span> <span class="bp">⟨-</span><span class="o">,</span> <span class="n">x_in</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">feqg</span><span class="o">,</span>
    <span class="n">erw</span> <span class="o">[</span><span class="n">frontier_eq_closure_inter_closure</span><span class="o">,</span> <span class="n">A_closed</span><span class="bp">.</span><span class="n">closure_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">x_in</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">x_in</span><span class="o">,</span>
    <span class="n">split</span> <span class="bp">;</span> <span class="n">tauto</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">A_closed</span><span class="bp">.</span><span class="n">closure_eq</span><span class="o">,</span> <span class="n">f_cont</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">g_cont</span><span class="bp">.</span><span class="n">mono</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="n">only</span> <span class="o">[</span><span class="n">univ_inter</span><span class="o">]</span> <span class="kn">using</span> <span class="n">key</span> <span class="o">},</span>
<span class="kn">end</span>
</code></pre></div>



<a name="207655908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207655908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207655908">(Aug 21 2020 at 16:39)</a>:</h4>
<p>Of course the key trick is to use <a href="https://leanprover-community.github.io/mathlib_docs/find/continuous_on_if">docs#continuous_on_if</a></p>



<a name="207689557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207689557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207689557">(Aug 21 2020 at 22:01)</a>:</h4>
<p>Thanks a lot, I will take look at it and hopefully learn something about writing more elegant code in the future.</p>



<a name="207689825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207689825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207689825">(Aug 21 2020 at 22:04)</a>:</h4>
<p>Again, the main point is I used a stronger theorem.</p>



<a name="207689925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207689925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207689925">(Aug 21 2020 at 22:05)</a>:</h4>
<p>We could still have this version in mathlib, so feel free to PR this (but without the existential), with three lemmas stating the three properties of the explicit function.</p>



<a name="207722141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722141">(Aug 22 2020 at 12:25)</a>:</h4>
<p>I tried to run the code, but it doesn't recognise continuous_on_if. I have imported topology.continuous_on and opened topology. How do I fix this? I ran <code>leanproject upgrade-mathlib</code>, but that was not the problem.</p>



<a name="207722447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722447">(Aug 22 2020 at 12:34)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mwe.html">#mwe</a>?</p>



<a name="207722760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722760">(Aug 22 2020 at 12:41)</a>:</h4>
<p>I just copied your code, so the <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> is there already with these imports:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">basic</span> <span class="n">topology</span><span class="bp">.</span><span class="n">bases</span> <span class="n">topology</span><span class="bp">.</span><span class="n">metric_space</span><span class="bp">.</span><span class="n">basic</span> <span class="n">topology</span><span class="bp">.</span><span class="n">order</span> <span class="n">topology</span><span class="bp">.</span><span class="n">constructions</span>
<span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">continuous_on</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">function</span> <span class="n">tactic</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">filter</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span> <span class="n">topological_space</span> <span class="n">function</span>
</code></pre></div>



<a name="207722837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722837">(Aug 22 2020 at 12:43)</a>:</h4>
<p>I'm sorry, I can't reproduce your issue.</p>



<a name="207722847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722847">(Aug 22 2020 at 12:43)</a>:</h4>
<p>Are you using current mathlib master branch?</p>



<a name="207722897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722897">(Aug 22 2020 at 12:44)</a>:</h4>
<p>That means commit 011a2622a83ba086a7c</p>



<a name="207722902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722902">(Aug 22 2020 at 12:44)</a>:</h4>
<p>(but I'm not using anything brand new here).</p>



<a name="207722906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722906">(Aug 22 2020 at 12:44)</a>:</h4>
<p>I don't know, I tried running <code>leanproject upgrade-mathlib</code> is that sufficient, or do I need something else.</p>



<a name="207722982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207722982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207722982">(Aug 22 2020 at 12:46)</a>:</h4>
<p>Maybe it helps to note that the <code>rintros x (x_not_in : x ∉ A),</code> line also fails with <code>'«)»' expected</code> as error.</p>



<a name="207723159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207723159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207723159">(Aug 22 2020 at 12:51)</a>:</h4>
<p>Upgrading mathlib like this should be enough indeed.</p>



<a name="207723171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207723171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207723171">(Aug 22 2020 at 12:51)</a>:</h4>
<p>Can you gou inside <code>_target/deps/mathlib</code> and run <code>git log</code> there to see what the latest commit?</p>



<a name="207723223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207723223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207723223">(Aug 22 2020 at 12:52)</a>:</h4>
<p>I forgot that I used this type ascription in <code>rintros</code>, that's a somewhat new feature.</p>



<a name="207723244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207723244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207723244">(Aug 22 2020 at 12:53)</a>:</h4>
<p>Somewhat new as in: was merged yesterday.</p>



<a name="207723678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207723678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207723678">(Aug 22 2020 at 13:04)</a>:</h4>
<p>The type ascriptions are already a couple of days old right? Yesterday was the <code>-</code> arguments for <code>rintros</code></p>



<a name="207723805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207723805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207723805">(Aug 22 2020 at 13:08)</a>:</h4>
<p>Oh yes, you're right. So I was right in the beginning, I used nothing new.</p>



<a name="207769690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207769690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207769690">(Aug 23 2020 at 12:01)</a>:</h4>
<p>I restarted everything and it worked.</p>



<a name="207770621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207770621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207770621">(Aug 23 2020 at 12:26)</a>:</h4>
<p>So, I got your example working and changed some stuff in my proof to the more elegant solutions in yours. You said something about PR'ing the solution I had, so two how do you PR  and is this fit to be PR'ed?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">basic</span> <span class="n">topology</span><span class="bp">.</span><span class="n">bases</span> <span class="n">topology</span><span class="bp">.</span><span class="n">metric_space</span><span class="bp">.</span><span class="n">basic</span> <span class="n">topology</span><span class="bp">.</span><span class="n">order</span> <span class="n">topology</span><span class="bp">.</span><span class="n">constructions</span>
<span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">continuous_on</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">function</span> <span class="n">tactic</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">filter</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span> <span class="n">topological_space</span> <span class="n">function</span>

<span class="kn">lemma</span> <span class="n">glued_is_f_in_A</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span>
    <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span>
    <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="bp">_</span> <span class="n">h</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">]</span>

<span class="kn">lemma</span> <span class="n">glued_is_g_in_B</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span>
    <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">),</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">x</span> <span class="n">x_in</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">split_ifs</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">feqg</span> <span class="bp">_</span> <span class="bp">⟨</span><span class="n">h</span><span class="o">,</span> <span class="n">x_in</span><span class="bp">⟩</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">refl</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">pastingLemma</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">A_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">B_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">}</span> <span class="o">(</span><span class="n">f_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">f</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">g_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">g</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">continuous</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="n">continuous_iff_continuous_on_univ</span><span class="o">,</span>
      <span class="n">rw</span> <span class="err">←</span> <span class="n">XeqAB</span><span class="o">,</span>
      <span class="n">apply</span> <span class="n">continuous_on_iff_is_closed</span><span class="bp">.</span><span class="n">mpr</span><span class="o">,</span>
      <span class="n">intros</span> <span class="n">t</span> <span class="n">t_closed</span><span class="o">,</span>
      <span class="n">use</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="err">∪</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">),</span>
      <span class="n">split</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">apply</span> <span class="n">is_closed_union</span><span class="o">,</span>
        <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">preimage_closed_of_closed</span> <span class="n">f_cont</span> <span class="n">A_closed</span> <span class="n">t_closed</span><span class="o">,</span>
        <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">preimage_closed_of_closed</span> <span class="n">g_cont</span> <span class="n">B_closed</span> <span class="n">t_closed</span> <span class="o">},</span>
        <span class="o">{</span> <span class="n">rw</span> <span class="n">XeqAB</span><span class="o">,</span>
          <span class="n">rw</span> <span class="o">[</span><span class="n">inter_univ</span><span class="o">,</span> <span class="n">inter_univ</span><span class="o">],</span>
          <span class="n">ext</span><span class="o">,</span>
          <span class="n">split</span><span class="o">,</span>
          <span class="o">{</span> <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
            <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
            <span class="n">rw</span> <span class="n">mem_union</span> <span class="n">x</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">),</span>
            <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
            <span class="o">{</span> <span class="n">left</span><span class="o">,</span>
              <span class="n">simp</span> <span class="o">[</span><span class="n">xA</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
              <span class="n">split</span><span class="bp">;</span> <span class="n">assumption</span> <span class="o">},</span>
              <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">xnA</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
                <span class="n">right</span><span class="o">,</span>
                <span class="n">rcases</span> <span class="o">(</span><span class="k">show</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">XeqAB</span><span class="o">])</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xB</span><span class="o">,</span>
                <span class="o">{</span> <span class="n">tauto</span> <span class="o">},</span>
                <span class="o">{</span> <span class="n">exact</span> <span class="bp">⟨</span><span class="n">xB</span><span class="o">,</span> <span class="n">h</span><span class="bp">⟩</span> <span class="o">}</span> <span class="o">}</span>
          <span class="o">},</span>
          <span class="o">{</span> <span class="n">intros</span> <span class="n">h</span><span class="o">,</span>
            <span class="n">simp</span><span class="o">,</span>
            <span class="n">rw</span> <span class="n">mem_union</span> <span class="n">x</span> <span class="o">(</span><span class="n">A</span> <span class="err">∩</span> <span class="n">f</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="o">(</span><span class="n">B</span> <span class="err">∩</span> <span class="n">g</span><span class="bp">⁻¹</span><span class="err">&#39;</span> <span class="n">t</span><span class="o">)</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
            <span class="n">rcases</span> <span class="n">dec_em</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">)</span> <span class="k">with</span> <span class="n">xA</span> <span class="bp">|</span> <span class="n">xnA</span><span class="o">,</span>
            <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">xA</span><span class="o">],</span>
              <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">xAft</span> <span class="bp">|</span> <span class="n">xBgt</span><span class="o">,</span>
              <span class="o">{</span> <span class="n">exact</span> <span class="n">xAft</span><span class="bp">.</span><span class="mi">2</span> <span class="o">},</span>
              <span class="o">{</span> <span class="n">rw</span> <span class="n">feqg</span> <span class="n">x</span> <span class="o">(</span><span class="n">mem_inter</span> <span class="n">xA</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">1</span><span class="o">),</span>
                <span class="n">exact</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">2</span> <span class="o">}</span>
              <span class="o">},</span>
              <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">xnA</span><span class="o">],</span>
                <span class="n">rcases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">xAft</span> <span class="bp">|</span> <span class="n">xBgt</span><span class="o">,</span>
                <span class="o">{</span> <span class="n">exfalso</span><span class="o">,</span> <span class="n">exact</span> <span class="n">xnA</span> <span class="n">xAft</span><span class="bp">.</span><span class="mi">1</span> <span class="o">},</span>
                <span class="o">{</span> <span class="n">exact</span> <span class="n">xBgt</span><span class="bp">.</span><span class="mi">2</span> <span class="o">}</span>
              <span class="o">}</span>
          <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">},</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">X</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">Y</span><span class="o">]</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">X</span><span class="o">}</span> <span class="o">(</span><span class="n">A_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">B_closed</span> <span class="o">:</span> <span class="n">is_closed</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">XeqAB</span> <span class="o">:</span> <span class="n">A</span> <span class="err">∪</span> <span class="n">B</span> <span class="bp">=</span> <span class="n">univ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span><span class="o">:</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">Y</span><span class="o">)</span> <span class="o">(</span><span class="n">f_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">f</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">g_cont</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">g</span> <span class="n">B</span><span class="o">)</span>
    <span class="o">(</span><span class="n">feqg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="err">∩</span> <span class="n">B</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">((</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">A</span><span class="o">),</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">∧</span>
     <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">x</span> <span class="err">∈</span> <span class="n">B</span><span class="o">),</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">))</span> <span class="bp">∧</span>
     <span class="n">continuous</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">if</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">A</span> <span class="k">then</span> <span class="n">f</span> <span class="n">x</span> <span class="k">else</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">refine</span> <span class="bp">⟨λ</span> <span class="bp">_</span> <span class="n">h</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">],</span> <span class="bp">_⟩</span><span class="o">,</span>
      <span class="n">intros</span> <span class="n">x</span> <span class="n">x_in</span><span class="o">,</span>
      <span class="n">simp</span><span class="o">,</span>
      <span class="n">split_ifs</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">exact</span> <span class="n">feqg</span> <span class="bp">_</span> <span class="bp">⟨</span><span class="n">h</span><span class="o">,</span> <span class="n">x_in</span><span class="bp">⟩</span> <span class="o">},</span>
      <span class="o">{</span> <span class="n">refl</span> <span class="o">}</span> <span class="o">},</span>
    <span class="n">apply</span> <span class="n">pastingLemma</span> <span class="n">A_closed</span> <span class="n">B_closed</span> <span class="n">XeqAB</span> <span class="n">f_cont</span> <span class="n">g_cont</span> <span class="n">feqg</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="207771237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207771237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207771237">(Aug 23 2020 at 12:42)</a>:</h4>
<p>I don't understand why the proof became more complicated than what I wrote.</p>



<a name="207771295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207771295" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207771295">(Aug 23 2020 at 12:44)</a>:</h4>
<p><code>glued_is_f_in_A</code>'s proof is so simple it doesn't really need to be stated.  And the last lemma is uselessly repeating stuff, especially since you are not using the first two lemmas.</p>



<a name="207771314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207771314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207771314">(Aug 23 2020 at 12:45)</a>:</h4>
<p>In the second lemma, you don't need that lambda, you can state <code>∀ x ∈ B, (if x ∈ A then f x else g x) = g x</code></p>



<a name="207771365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207771365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207771365">(Aug 23 2020 at 12:46)</a>:</h4>
<p>And you shouldn't be using non-terminating <code>simp</code>, those make proofs harder to maintain.</p>



<a name="207771379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207771379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207771379">(Aug 23 2020 at 12:47)</a>:</h4>
<p>As for the main lemma, you should first do a version where you don't assume <code>A ∪ B = univ</code> but conclude only <code>continuous_on _ (A ∪ B)</code>.</p>



<a name="207771383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207771383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207771383">(Aug 23 2020 at 12:47)</a>:</h4>
<p>See also <a href="https://leanprover-community.github.io/contribute/index.html">https://leanprover-community.github.io/contribute/index.html</a></p>



<a name="207775414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Pasting%20lemma/near/207775414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Emiel Lanckriet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Pasting.20lemma.html#207775414">(Aug 23 2020 at 14:14)</a>:</h4>
<p>Ah, ok, you meant PR'ing your version, I thought PR'ing my my attempt which did not use continuous_on_if, but thanks for the tips. I'll keep them in mind.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>