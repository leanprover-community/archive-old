---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Code.20review.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html">Code review?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="207021315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207021315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andre Knispel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207021315">(Aug 15 2020 at 13:08)</a>:</h4>
<p>I'm more or less done constructing the irrelevant ideal of N graded rings, but I've come across a bunch of problems or things that I didn't like in the proof, where I didn't think I could construct a small example of the problem. So I've made a gist that should be self contained and put questions and other comments in the proof (the long one, at the end of the file). I'd be grateful for any comments! <a href="https://gist.github.com/WhatisRT/98b512bd534d70e430f9aafa350dc581">https://gist.github.com/WhatisRT/98b512bd534d70e430f9aafa350dc581</a></p>



<a name="207022107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022107">(Aug 15 2020 at 13:30)</a>:</h4>
<p>Hi <span class="user-mention" data-user-id="282095">@Andre Knispel</span> that's a nice topic (-;</p>



<a name="207022197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andre Knispel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022197">(Aug 15 2020 at 13:33)</a>:</h4>
<p>Thanks! My plan is to construct the <code>Proj</code> functor and if I it doesn't take too long, state and prove the moduli problem for projective space</p>



<a name="207022429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022429">(Aug 15 2020 at 13:39)</a>:</h4>
<p>Sounds great.</p>



<a name="207022477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022477">(Aug 15 2020 at 13:40)</a>:</h4>
<p>I think the general problem with your code might be that it's an extremely long proof</p>



<a name="207022480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022480">(Aug 15 2020 at 13:40)</a>:</h4>
<p>Breaking things into sublemmas usually helps a lot.</p>



<a name="207022490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022490">(Aug 15 2020 at 13:40)</a>:</h4>
<p>But let me load your code into Lean and take a quick look</p>



<a name="207022567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022567">(Aug 15 2020 at 13:42)</a>:</h4>
<p><span class="user-mention" data-user-id="282095">@Andre Knispel</span> What is in <code>leanpkg.toml</code> in the base of your mathlib clone?</p>



<a name="207022570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022570">(Aug 15 2020 at 13:42)</a>:</h4>
<p>Because I get a <em>lot</em> of errors when I use a recent mathlib.</p>



<a name="207022573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022573">(Aug 15 2020 at 13:43)</a>:</h4>
<p>(Like, imports that are wrong.)</p>



<a name="207022648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207022648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207022648">(Aug 15 2020 at 13:45)</a>:</h4>
<p>Note that in some sense we don't have the Spec functor yet, because we don't have the target category. The reason schemes are not yet in mathlib is that there still seems to be no acceptable way to say "I am a sheaf of rings" in mathlib. In the schemes repo we just made an ad hoc definition of a sheaf of rings, however the definition of a presheaf in mathlib takes values in a category so is incompatible with ours (which just took values in Type). In particular if you want to develop code which will be in mathlib it is extremely difficult to proceed right now.</p>



<a name="207023851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207023851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andre Knispel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207023851">(Aug 15 2020 at 14:18)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> I'm using the mathlib I got from lean-scheme, it says version 0.1</p>



<a name="207023917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207023917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207023917">(Aug 15 2020 at 14:20)</a>:</h4>
<p>Oof, I see. That version is ancient (-;</p>



<a name="207023933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207023933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207023933">(Aug 15 2020 at 14:21)</a>:</h4>
<p>The big downside is that we don't have precompiled versions of that mathlib, I think.</p>



<a name="207024032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207024032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207024032">(Aug 15 2020 at 14:24)</a>:</h4>
<p>This is not the right answer. Version 0.1 is the version of lean-scheme</p>



<a name="207024112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207024112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207024112">(Aug 15 2020 at 14:26)</a>:</h4>
<p>But if you're building on lean-scheme then the answer is that it's the version of mathlib used there. In some sense there is little point building on this because it will have to be rewritten when it all moves to mathlib, but a different way of looking at it is that if you're learning how to use lean then perhaps getting stuff into mathlib is not really your main concern</p>



<a name="207024197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207024197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207024197">(Aug 15 2020 at 14:29)</a>:</h4>
<p>There's a whole bunch of ideas in that repo, there is Gamma Spec duality, glueing sheaves and various other things, but none of it can go into mathlib because we just have to wait until they give us a definition of a ringed space</p>



<a name="207024362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207024362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207024362">(Aug 15 2020 at 14:33)</a>:</h4>
<p>Oh hot news: <a href="https://github.com/leanprover-community/mathlib/commit/099f070f41867bb6bd0f6494307873a126e3c4ad">https://github.com/leanprover-community/mathlib/commit/099f070f41867bb6bd0f6494307873a126e3c4ad</a> is merged! So we have sheaves as of basically just now!</p>



<a name="207024562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207024562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207024562">(Aug 15 2020 at 14:38)</a>:</h4>
<p>Ok this changes everything. <span class="user-mention" data-user-id="282095">@Andre Knispel</span> if you want to do something which could go in mathlib we are now in a position to define ringed spaces and schemes. However without a sheafification functor we're still not able to get too far. But at least we can now start. Basically this enables us to make new definitions but we're still limited in what theorems we can prove</p>



<a name="207024838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207024838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andre Knispel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207024838">(Aug 15 2020 at 14:46)</a>:</h4>
<p>Oh, that's great! As you've guessed, getting this into mathlib isn't my main concern, but it would be nice. What I've done so far doesn't use any schemes of course, so I could just as well use master for that. Maybe getting <code>Proj</code> as a ringed space would also be nice, if that has the advantage of being able to be merged</p>



<a name="207024900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207024900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207024900">(Aug 15 2020 at 14:49)</a>:</h4>
<p>Sounds good to me</p>



<a name="207024908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207024908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207024908">(Aug 15 2020 at 14:49)</a>:</h4>
<p>I hope that by the time you have Proj as ringed space, we'll have a category of schemes (-;</p>



<a name="207025343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207025343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207025343">(Aug 15 2020 at 15:01)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> actually there's still a problem with defining schemes. A scheme is something locally isomorphic as a presheafed space to Spec(R) but we can't make Spec(R) a presheafed space because we only know the values of the presheaf on a basis. In the schemes repo is the proof that this presheaf is a sheaf on a basis but then we'll need to extend to the entire top space and my guess is that one is supposed to do this using formal machinery</p>



<a name="207025695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207025695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207025695">(Aug 15 2020 at 15:10)</a>:</h4>
<p>Yup... I know. But Bhavik seems to have this</p>



<a name="207025699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207025699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207025699">(Aug 15 2020 at 15:10)</a>:</h4>
<p>So we need to wait for his PR (-;</p>



<a name="207025711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207025711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207025711">(Aug 15 2020 at 15:11)</a>:</h4>
<p>But I don't think that Andre will have Proj next week (-; so we still have a couple of days to get our act together <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="207075890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Code%20review%3F/near/207075890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andre Knispel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Code.20review.3F.html#207075890">(Aug 16 2020 at 15:28)</a>:</h4>
<p>I've taken some time to make my code compatible with the mathlib on master and updated the gist. A bunch of problems I've had went away, which made the proof much shorter, but I still have some questions that are in the comments. <a href="https://gist.github.com/WhatisRT/98b512bd534d70e430f9aafa350dc581">https://gist.github.com/WhatisRT/98b512bd534d70e430f9aafa350dc581</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>