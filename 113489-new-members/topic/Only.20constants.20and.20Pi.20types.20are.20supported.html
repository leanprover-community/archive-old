---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Only.20constants.20and.20Pi.20types.20are.20supported.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Only.20constants.20and.20Pi.20types.20are.20supported.html">Only constants and Pi types are supported</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="205507616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Only%20constants%20and%20Pi%20types%20are%20supported/near/205507616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Only.20constants.20and.20Pi.20types.20are.20supported.html#205507616">(Jul 30 2020 at 17:32)</a>:</h4>
<p>If I change the following instance in mathlib</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="n">continuous_map_semimodule</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span>
<span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">R</span><span class="o">]</span>
<span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_add_group</span> <span class="n">M</span><span class="o">]</span>
<span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">semimodule</span> <span class="n">R</span> <span class="n">C</span><span class="o">(</span><span class="n">α</span><span class="o">,</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span>
  <span class="n">semimodule</span><span class="bp">.</span><span class="n">of_core</span> <span class="err">$</span>
<span class="o">{</span> <span class="n">smul</span>     <span class="o">:=</span> <span class="o">(</span><span class="err">•</span><span class="o">),</span>
  <span class="n">smul_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">c</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="k">by</span> <span class="n">ext</span> <span class="n">x</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">smul_add</span> <span class="n">c</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span><span class="o">),</span>
  <span class="n">add_smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">c₁</span> <span class="n">c₂</span> <span class="n">f</span><span class="o">,</span> <span class="k">by</span> <span class="n">ext</span> <span class="n">x</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">add_smul</span> <span class="n">c₁</span> <span class="n">c₂</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">),</span>
  <span class="n">mul_smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">c₁</span> <span class="n">c₂</span> <span class="n">f</span><span class="o">,</span> <span class="k">by</span> <span class="n">ext</span> <span class="n">x</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">mul_smul</span> <span class="n">c₁</span> <span class="n">c₂</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">),</span>
  <span class="n">one_smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span><span class="o">,</span> <span class="k">by</span> <span class="n">ext</span> <span class="n">x</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">one_smul</span> <span class="n">R</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>


<p>to</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="n">continuous_map_semimodule</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span>
<span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">R</span><span class="o">]</span>
<span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">has_continuous_add</span> <span class="n">M</span><span class="o">]</span>
<span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">semimodule</span> <span class="n">R</span> <span class="n">C</span><span class="o">(</span><span class="n">α</span><span class="o">,</span> <span class="n">M</span><span class="o">)</span> <span class="o">:=</span>
  <span class="n">semimodule</span><span class="bp">.</span><span class="n">of_core</span> <span class="err">$</span>
<span class="o">{</span> <span class="n">smul</span>     <span class="o">:=</span> <span class="o">(</span><span class="err">•</span><span class="o">),</span>
  <span class="n">smul_add</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">c</span> <span class="n">f</span> <span class="n">g</span><span class="o">,</span> <span class="k">by</span> <span class="n">ext</span> <span class="n">x</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">smul_add</span> <span class="n">c</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span><span class="o">),</span>
  <span class="n">add_smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">c₁</span> <span class="n">c₂</span> <span class="n">f</span><span class="o">,</span> <span class="k">by</span> <span class="n">ext</span> <span class="n">x</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">add_smul</span> <span class="n">c₁</span> <span class="n">c₂</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">),</span>
  <span class="n">mul_smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">c₁</span> <span class="n">c₂</span> <span class="n">f</span><span class="o">,</span> <span class="k">by</span> <span class="n">ext</span> <span class="n">x</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">mul_smul</span> <span class="n">c₁</span> <span class="n">c₂</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">),</span>
  <span class="n">one_smul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span><span class="o">,</span> <span class="k">by</span> <span class="n">ext</span> <span class="n">x</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">one_smul</span> <span class="n">R</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>


<p>(which I was planning to do before the PR but I forgot) I get</p>
<div class="codehilite"><pre><span></span><code><span class="c">/-</span><span class="cm"></span>
<span class="cm">only constants and Pi types are supported: ?m_1</span>
<span class="cm">state:</span>
<span class="cm">α : Type ?,</span>
<span class="cm">_inst_1 : topological_space α,</span>
<span class="cm">R : Type ?,</span>
<span class="cm">_inst_2 : semiring R,</span>
<span class="cm">_inst_3 : topological_space R,</span>
<span class="cm">M : Type ?,</span>
<span class="cm">_inst_4 : topological_space M,</span>
<span class="cm">_inst_5 : add_comm_monoid M,</span>
<span class="cm">_inst_6 : has_continuous_add M,</span>
<span class="cm">_inst_7 : semimodule R M,</span>
<span class="cm">_inst_8 : topological_semimodule R M,</span>
<span class="cm">c : ?m_1,</span>
<span class="cm">f g : ?m_2</span>
<span class="cm">⊢ c • (f + g) = c • f + c • g</span>
<span class="cm">-/</span>
</code></pre></div>


<p>What is going wrong?</p>



<a name="205508439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Only%20constants%20and%20Pi%20types%20are%20supported/near/205508439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Only.20constants.20and.20Pi.20types.20are.20supported.html#205508439">(Jul 30 2020 at 17:39)</a>:</h4>
<p><code>semimodule.of_core</code> requires an <code>add_comm_group M</code>, but you have an <code>add_comm_monoid</code>. It means you should not use <code>semimodule.of_core</code> here, but give a direct proof for all the fields.</p>



<a name="205509577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Only%20constants%20and%20Pi%20types%20are%20supported/near/205509577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Only.20constants.20and.20Pi.20types.20are.20supported.html#205509577">(Jul 30 2020 at 17:48)</a>:</h4>
<p>Oh again weird error message</p>



<a name="205509619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Only%20constants%20and%20Pi%20types%20are%20supported/near/205509619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nicolò Cavalleri <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Only.20constants.20and.20Pi.20types.20are.20supported.html#205509619">(Jul 30 2020 at 17:49)</a>:</h4>
<p>Moreover when I did PR that I copied the proof of the subtype. Weird that it was not already in greatest generality</p>



<a name="205509832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Only%20constants%20and%20Pi%20types%20are%20supported/near/205509832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Only.20constants.20and.20Pi.20types.20are.20supported.html#205509832">(Jul 30 2020 at 17:50)</a>:</h4>
<p>Yes, we are improving things slowly by pushing things to the right generality when someone notices that things are not as general as they could be, just like you just did!</p>



<a name="205509864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Only%20constants%20and%20Pi%20types%20are%20supported/near/205509864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Only.20constants.20and.20Pi.20types.20are.20supported.html#205509864">(Jul 30 2020 at 17:51)</a>:</h4>
<p>And yes, the error messages are often pretty bad!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>