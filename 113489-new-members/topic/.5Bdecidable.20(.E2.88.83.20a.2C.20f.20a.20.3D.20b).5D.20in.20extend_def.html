---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html">[decidable (∃ a, f a = b)] in extend_def</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="247256269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247256269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247256269">(Jul 26 2021 at 20:19)</a>:</h4>
<p>I'm struggling to understand this pull request from a few months ago: <a href="https://github.com/leanprover-community/mathlib/pull/6488">https://github.com/leanprover-community/mathlib/pull/6488</a>, which adds a <code>[decidable (∃ a, f a = b)]</code> parameter to the <code>extend_def</code> lemma.</p>
<p>Why is that desirable? Doesn't that make the lemma more difficult to use, because now you might need to additionally come up with the typeclass instance?</p>



<a name="247256537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247256537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247256537">(Jul 26 2021 at 20:21)</a>:</h4>
<p>No, because type class inference will find the instance for you</p>



<a name="247256977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247256977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247256977">(Jul 26 2021 at 20:25)</a>:</h4>
<p>what do we gain by adding the parameter?</p>



<a name="247257161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247257161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247257161">(Jul 26 2021 at 20:26)</a>:</h4>
<p>You can rw backwards, regardless of what instance allowed you to even state the if then else</p>



<a name="247257193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247257193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247257193">(Jul 26 2021 at 20:27)</a>:</h4>
<p>(I'm asking because I'm trying to translate this lemma in to Lean 4, and without that parameter it's a lot easier to prove.)</p>



<a name="247257335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247257335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247257335">(Jul 26 2021 at 20:28)</a>:</h4>
<p>How does inclusion of an additional hypothesis make it harder to prove?</p>



<a name="247257415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247257415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247257415">(Jul 26 2021 at 20:29)</a>:</h4>
<p>It's <code>rfl</code> without that hypothesis.</p>



<a name="247257434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247257434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247257434">(Jul 26 2021 at 20:29)</a>:</h4>
<p>And I have been unable to find a proof yet with that hypothesis.</p>



<a name="247257940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247257940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247257940">(Jul 26 2021 at 20:34)</a>:</h4>
<p>hm... maybe I should try to control which <code>Decidable</code> instance <code>ite</code> is using...</p>



<a name="247258505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247258505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247258505">(Jul 26 2021 at 20:38)</a>:</h4>
<p>What's the error you get when your proof term is "by exact rfl"?</p>



<a name="247258758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247258758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247258758">(Jul 26 2021 at 20:40)</a>:</h4>
<p>does <code>convert</code> exist for lean4?</p>



<a name="247258762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247258762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247258762">(Jul 26 2021 at 20:40)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span>
  <span class="n">rfl</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">extend</span> <span class="n">f</span> <span class="n">g</span> <span class="n">e'</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">extend</span> <span class="n">f</span> <span class="n">g</span> <span class="n">e'</span> <span class="n">b</span> <span class="o">:</span> <span class="kt">Prop</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">extend</span> <span class="n">f</span> <span class="n">g</span> <span class="n">e'</span> <span class="n">b</span> <span class="bp">=</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span> <span class="k">then</span> <span class="n">g</span> <span class="o">(</span><span class="n">Classical.choose</span> <span class="n">h</span><span class="o">)</span> <span class="k">else</span> <span class="n">e'</span> <span class="n">b</span> <span class="o">:</span> <span class="kt">Prop</span>
<span class="bp">`</span>
</code></pre></div>



<a name="247258949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247258949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247258949">(Jul 26 2021 at 20:42)</a>:</h4>
<p>The point is that before that change, that was a lemma about <code>@ite (classical.decidable _)</code>, but with it it's now a lemma about all <code>@ite</code>s</p>



<a name="247258951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247258951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247258951">(Jul 26 2021 at 20:42)</a>:</h4>
<p>I don't think there's a <code>convert</code> yet.</p>



<a name="247258966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247258966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247258966">(Jul 26 2021 at 20:42)</a>:</h4>
<p>Is there a congr?</p>



<a name="247259023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259023">(Jul 26 2021 at 20:43)</a>:</h4>
<p>The core of the lean 3 proof is the <code>subsingleton (decidable p)</code> instance, which congr know how to apply</p>



<a name="247259024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259024">(Jul 26 2021 at 20:43)</a>:</h4>
<p>I don't think there is a <code>congr</code> tactic yet either.</p>



<a name="247259147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259147">(Jul 26 2021 at 20:44)</a>:</h4>
<p>Does lean 4 know that all <code>decidable p</code> instances are equal, which is maybe <a href="https://leanprover-community.github.io/mathlib_docs/find/decidable.subsingleton">docs#decidable.subsingleton</a> in lean 3</p>



<a name="247259262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259262">(Jul 26 2021 at 20:44)</a>:</h4>
<blockquote>
<p>The point is that before that change, that was a lemma about <code>@ite (classical.decidable _)</code>, but with it it's now a lemma about all <code>@ite</code>s </p>
</blockquote>
<p>Should I expect this distinction to show up in the type signature when I do <code>#print extend_def</code>?</p>



<a name="247259302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259302">(Jul 26 2021 at 20:45)</a>:</h4>
<p>Only with <code>set_option pp.implicit true</code> or whatever the lean4 spelling is</p>



<a name="247259349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259349">(Jul 26 2021 at 20:45)</a>:</h4>
<p>classical.decidable shouldn't ever appear in a lemma statement (unless it's an intermediate step to stating the better version of the lemma)</p>



<a name="247259368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259368">(Jul 26 2021 at 20:45)</a>:</h4>
<p>I'm trying to understand it in in Lean 3 too, so right now I'm doing <code>#print</code> there.</p>



<a name="247259520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259520">(Jul 26 2021 at 20:46)</a>:</h4>
<p>Updated with the full lean3 command</p>



<a name="247259705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259705">(Jul 26 2021 at 20:48)</a>:</h4>
<p>ah, indeed I do see the difference (other than just the <code>[decidable (∃ a, f a = b)]</code> hypothesis) when I set <code>pp.all</code> (or <code>pp.implicit</code>) to true.</p>



<a name="247259712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259712">(Jul 26 2021 at 20:48)</a>:</h4>
<p>that's sneaky :)</p>



<a name="247259850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247259850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247259850">(Jul 26 2021 at 20:49)</a>:</h4>
<p>So apparently <code>classical.prop_decidable</code> does some kind of implicit coercion.</p>



<a name="247260313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247260313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247260313">(Jul 26 2021 at 20:53)</a>:</h4>
<p>or I suppose this is exactly what the </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">local</span> <span class="kn">attribute</span> <span class="o">[</span><span class="kd">instance</span><span class="o">,</span> <span class="n">priority</span> <span class="mi">10</span><span class="o">]</span> <span class="n">classical.prop_decidable</span>
</code></pre></div>
<p>line does?</p>



<a name="247260347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247260347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247260347">(Jul 26 2021 at 20:53)</a>:</h4>
<p>implicitly wraps all propositions in <code>classical.prop_decidable</code>?</p>



<a name="247263704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247263704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247263704">(Jul 26 2021 at 21:10)</a>:</h4>
<p>i'm confused what you mean by implicit coercion; <code>ite</code> requires decidability of the prop (as an instance), <code>classical.prop_decidable</code> gives that instance. the change was done so you could reverse-rw the <code>ite</code> if your ∃ is decidable, because that isn't the definition</p>



<a name="247265514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247265514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247265514">(Jul 26 2021 at 21:23)</a>:</h4>
<p>By "implicit coercion" I mean that without the new hypothesis, the return type looks like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">extend</span> <span class="n">f</span> <span class="n">g</span> <span class="n">e'</span> <span class="n">b</span> <span class="bp">=</span>
    <span class="n">dite</span> <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="n">classical.some</span> <span class="n">h</span><span class="o">))</span>
      <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">¬∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">),</span> <span class="n">e'</span> <span class="n">b</span><span class="o">)</span>
</code></pre></div>
<p>but is secretly actually</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">@</span><span class="n">extend</span> <span class="n">α</span> <span class="n">β</span> <span class="n">γ</span> <span class="n">f</span> <span class="n">g</span> <span class="n">e'</span> <span class="n">b</span> <span class="bp">=</span>
    <span class="bp">@</span><span class="n">dite</span> <span class="n">γ</span> <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">classical.prop_decidable</span> <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">))</span>
      <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="bp">@</span><span class="n">classical.some</span> <span class="n">α</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">)</span> <span class="n">h</span><span class="o">))</span>
      <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">¬∃</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">),</span> <span class="n">e'</span> <span class="n">b</span><span class="o">)</span>
</code></pre></div>



<a name="247265622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247265622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247265622">(Jul 26 2021 at 21:24)</a>:</h4>
<p>ah, I see it's just adding <code>@</code> everywhere</p>



<a name="247265651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247265651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247265651">(Jul 26 2021 at 21:24)</a>:</h4>
<p>ok, I think understand better now</p>



<a name="247265720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247265720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247265720">(Jul 26 2021 at 21:25)</a>:</h4>
<p>there's no new concept I need to learn here. This is just about choosing which typeclass instance gets used.</p>



<a name="247265870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247265870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247265870">(Jul 26 2021 at 21:26)</a>:</h4>
<p>I was worried about some kind of extra implicit magic inserting constuctors/function calls, but I see now that it all fits within typeclass resolution.</p>



<a name="247281433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%5Bdecidable%20%28%E2%88%83%20a%2C%20f%20a%20%3D%20b%29%5D%20in%20extend_def/near/247281433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.5Bdecidable.20(.E2.88.83.20a.2C.20f.20a.20.3D.20b).5D.20in.20extend_def.html#247281433">(Jul 27 2021 at 00:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/.5Bdecidable.20.28.E2.88.83.20a.2C.20f.20a.20.3D.20b.29.5D.20in.20extend_def/near/247259147">said</a>:</p>
<blockquote>
<p>Does lean 4 know that all <code>decidable p</code> instances are equal, which is maybe <a href="https://leanprover-community.github.io/mathlib_docs/find/decidable.subsingleton">docs#decidable.subsingleton</a> in lean 3</p>
</blockquote>
<p>aha! This works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">extend_def</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">e'</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">hd</span> <span class="o">:</span> <span class="n">Decidable</span> <span class="o">(</span><span class="bp">∃</span> <span class="n">a</span><span class="o">,</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">)]</span> <span class="o">:</span>
  <span class="n">extend</span> <span class="n">f</span> <span class="n">g</span> <span class="n">e'</span> <span class="n">b</span> <span class="bp">=</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">a</span><span class="o">,</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span> <span class="k">then</span> <span class="n">g</span> <span class="o">(</span><span class="n">Classical.choose</span> <span class="n">h</span><span class="o">)</span> <span class="k">else</span> <span class="n">e'</span> <span class="n">b</span> <span class="o">:=</span>
  <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">Subsingleton.elim</span> <span class="n">hd</span><span class="o">]</span>
     <span class="n">exact</span> <span class="n">rfl</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>