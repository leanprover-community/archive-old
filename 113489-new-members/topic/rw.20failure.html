---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/rw.20failure.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html">rw failure</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="133836913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133836913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133836913">(Sep 12 2018 at 19:01)</a>:</h4>
<p>div and mod just don't interact in Lean</p>



<a name="133837079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837079" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Etienne Laurin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837079">(Sep 12 2018 at 19:03)</a>:</h4>
<p>In this example there is no need for cases, <code>have : p % 4 = 3, rw [nat_eq_sub_of_add_eq (nat.mod_add_div p 4), nat_eq_sub_of_add_eq thing11]</code></p>



<a name="133837367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837367">(Sep 12 2018 at 19:07)</a>:</h4>
<p>I'm talking about the 2|p/2 not giving us useful information regarding p%4</p>



<a name="133837491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837491">(Sep 12 2018 at 19:09)</a>:</h4>
<p>right.</p>



<a name="133837492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837492">(Sep 12 2018 at 19:09)</a>:</h4>
<p><code>  have H : 3 = p % 4 := add_right_cancel (eq.trans thing11 (nat.mod_add_div p 4).symm),</code></p>



<a name="133837582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837582">(Sep 12 2018 at 19:10)</a>:</h4>
<blockquote>
<p>I'm talking about the 2|p/2 not giving us useful information regarding p%4</p>
</blockquote>
<p>my quadratic reciprocity PR contains this lemma, which can be used to deduce <code>(p % 4) / 2 = 0</code> from <code>nine</code> which is also a way to get a contradiction</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">mod_mul_right_div_self</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="err">%</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span> <span class="bp">/</span> <span class="n">b</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">/</span> <span class="n">b</span><span class="o">)</span> <span class="err">%</span> <span class="n">c</span>
</pre></div>



<a name="133837684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837684">(Sep 12 2018 at 19:12)</a>:</h4>
<p>my Lean doesn't have your QR PR</p>



<a name="133837720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Etienne Laurin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837720">(Sep 12 2018 at 19:13)</a>:</h4>
<p>This looks like it <br>
<a href="https://github.com/leanprover/mathlib/blob/e005c3983be832dba68972519873df3ce0a2a6bb/data/nat/basic.lean#L240-L244" target="_blank" title="https://github.com/leanprover/mathlib/blob/e005c3983be832dba68972519873df3ce0a2a6bb/data/nat/basic.lean#L240-L244">https://github.com/leanprover/mathlib/blob/e005c3983be832dba68972519873df3ce0a2a6bb/data/nat/basic.lean#L240-L244</a></p>



<a name="133837738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837738">(Sep 12 2018 at 19:13)</a>:</h4>
<p>How about <code>a | (b / c) -&gt; b % (a * c) &lt; a</code> modulo edge cases.</p>



<a name="133837885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837885">(Sep 12 2018 at 19:15)</a>:</h4>
<blockquote>
<p>How about <code>a | (b / c) -&gt; b % (a * c) &lt; a</code> modulo edge cases.</p>
</blockquote>
<p>The trouble with these lemmas is it's still hard to find the proof, because things like this aren't in the list of standard things in my head which I expect to be in the library.</p>



<a name="133837931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837931">(Sep 12 2018 at 19:16)</a>:</h4>
<p><code>(b / c) % a = n -&gt; a * n &lt;= b % (a * c)</code></p>



<a name="133837944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837944">(Sep 12 2018 at 19:16)</a>:</h4>
<p><code>(b / c) % a = n -&gt; b % (a * c) &lt; a * (n + 1)</code></p>



<a name="133837984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133837984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133837984">(Sep 12 2018 at 19:17)</a>:</h4>
<p>or something</p>



<a name="133838073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838073">(Sep 12 2018 at 19:19)</a>:</h4>
<p>A linear arithmetic solver should also be able to solve the original problem with suitable preprocessing</p>



<a name="133838130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838130">(Sep 12 2018 at 19:20)</a>:</h4>
<p><code>b % (a * c) = b % c + c * ((b / c) % a)</code>or something</p>



<a name="133838139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838139">(Sep 12 2018 at 19:20)</a>:</h4>
<p>that well-known fact</p>



<a name="133838173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838173">(Sep 12 2018 at 19:21)</a>:</h4>
<p>Is there some standard name like <code>omega</code> or <code>sledgehammer</code> or something, for a linear arithmetic solver?</p>



<a name="133838233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838233">(Sep 12 2018 at 19:22)</a>:</h4>
<p>oh wow that well-known fact might even be true in the edge cases</p>



<a name="133838265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838265">(Sep 12 2018 at 19:23)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> Do you know if there are "standard" algorithms powerful enough to do that sort of thing?</p>



<a name="133838274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838274">(Sep 12 2018 at 19:23)</a>:</h4>
<p>We have Rob's linear arithmetic tactic</p>



<a name="133838294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838294">(Sep 12 2018 at 19:23)</a>:</h4>
<p>And maybe Seul will come back at some point</p>



<a name="133838345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133838345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133838345">(Sep 12 2018 at 19:24)</a>:</h4>
<p>I don't think that handles mod and integer division</p>



<a name="133841102"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133841102" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133841102">(Sep 12 2018 at 20:17)</a>:</h4>
<p>My attempt to write some div mod stuff is <code>div_mod_stuff.lean</code> in the cocalc repo</p>



<a name="133841106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133841106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133841106">(Sep 12 2018 at 20:17)</a>:</h4>
<p>I have to clean the kitchen. I proved the well-known lemma</p>



<a name="133841111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133841111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133841111">(Sep 12 2018 at 20:17)</a>:</h4>
<p><code>lemma well_known (a b c : ℕ) : b % (a * c) = b % c + c * ((b / c) % a) := [done]</code></p>



<a name="133841112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133841112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133841112">(Sep 12 2018 at 20:17)</a>:</h4>
<p>I'm wondering if it makes the proof any easier</p>



<a name="133841180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133841180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133841180">(Sep 12 2018 at 20:18)</a>:</h4>
<div class="codehilite"><pre><span></span>nine : 2 ∣ p / 2,
thing11 : 3 + 4 * (p / 4) = p,  [used]
H : 3 = p % 2 + 2 * (p / 2 % 2)
⊢ false
</pre></div>



<a name="133841194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133841194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133841194">(Sep 12 2018 at 20:18)</a>:</h4>
<p>that's after applying the lemma</p>



<a name="133843673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133843673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133843673">(Sep 12 2018 at 21:02)</a>:</h4>
<p>Chris the original statement can be expressed in Presburger arithmetic (natural numbers with only addition), which has a decidable theory -- that's what Seul Baek implemented in <code>cooper</code>, I believe.</p>



<a name="133860394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133860394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133860394">(Sep 13 2018 at 03:52)</a>:</h4>
<p><span class="user-mention" data-user-id="122318">@Tobias Grosser</span> Is also working on Presburger arithmetic in Lean. He told me he would like to match up with someone who knows Lean/maths to get implement a version for mathlib.</p>



<a name="133877436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133877436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Xita Meyers <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133877436">(Sep 13 2018 at 11:26)</a>:</h4>
<p>An additional question-- something that I have no idea how to fix. I currently have </p>
<div class="codehilite"><pre><span></span>an9 : 1 + x ^ 2 ≡ 0 [MOD p]
⊢ 1 + x ^ 2 ≡ 0 [MOD p]
</pre></div>


<p>and <code> exact an9, </code> gives the error message:</p>
<div class="codehilite"><pre><span></span>invalid type ascription, term has type
  nat.modeq p (@has_add.add nat nat.has_add 1 (@has_pow.pow nat nat (@monoid.has_pow nat nat.monoid) x 2)) 0
but is expected to have type
  nat.modeq p (@has_add.add nat nat.has_add 1 (@has_pow.pow nat nat nat.has_pow x 2)) 0
</pre></div>


<p>In the middle of a complicated code, so I haven't made an MWE yet. Would this be easily fixable? (Before I try a different approach)</p>



<a name="133877609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133877609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133877609">(Sep 13 2018 at 11:30)</a>:</h4>
<p>Does <code>simpa</code> or <code>simpa using an9</code> work? I think there's a simp lemma for rewriting pow on <code>nat</code>.</p>



<a name="133877681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133877681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Xita Meyers <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133877681">(Sep 13 2018 at 11:31)</a>:</h4>
<p><code>simpa using an9,</code> works! Thanks!</p>



<a name="133877764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133877764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133877764">(Sep 13 2018 at 11:32)</a>:</h4>
<p>(deleted)</p>



<a name="133880162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/133880162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tobias Grosser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#133880162">(Sep 13 2018 at 12:20)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> , yes I am interested in Presburger arithmetic.Still learning more about lean, but I am certainly interested to chat about this. In case sb is interested in collaborating, I am open to collaborative visits or internships @ETH.</p>



<a name="135937724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/135937724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> JIANXIONG SUN <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#135937724">(Oct 16 2018 at 23:35)</a>:</h4>
<p>How can I represent square or cube in Lean such as x^2?</p>



<a name="135937808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/135937808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Ashworth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#135937808">(Oct 16 2018 at 23:36)</a>:</h4>
<p>what error does lean give you when you write <code>x^2</code>?</p>



<a name="135938425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/135938425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#135938425">(Oct 16 2018 at 23:47)</a>:</h4>
<p><code>import algebra.group_power</code></p>



<a name="158582769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/158582769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paula Neeley <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#158582769">(Feb 15 2019 at 02:00)</a>:</h4>
<p>Hey guys,<br>
First timer, so please be nice :)<br>
I'm aiming to prove the example at the bottom of the long code snippet. I made the lemmas "foo" and "bar" to help. My theorem "bar" worked to prove the inductive step, but I don't understand the output that Lean gives me when I try to prove this lemma "bar" itself. The base case gives me the output:</p>
<div class="codehilite"><pre><span></span>2 goals
case list.nil
α : Type u_1,
s : list α,
a : α
⊢ length (s ++ [a]) = length (s ++ nil) + 1
</pre></div>


<p>Specifically, I am unsure what the [a] here means and how to work with it. Any insights would be appreciated.</p>
<div class="codehilite"><pre><span></span>section
open list

variable {α : Type*}
variables s t : list α
variable a : α

theorem length_nil : length (@nil α) = 0 := rfl

theorem foo (t : list α) : t ++ nil = t :=
begin
induction t with a t ih,
{refl},
rw [cons_append, ih],
end

theorem bar : length (s ++ a :: t) = length (s ++ t) + 1 :=
begin
induction t with a t ih,
sorry
end

#check foo
#check nil_append
#check cons_append
#check length_cons
#check length_nil

#eval [1, 2, 3] ++ [4, 5]
#eval length [1, 2, 3, 4, 5]

end

/-
Prove the following.
-/

section
open list

variable {α : Type*}
variables s t : list α
variable a : α

example : length (s ++ t) = length s + length t :=
begin
induction t with a t ih,
{rw [length_nil, foo], refl},
rw [length_cons, bar, ih], refl,
end

end
</pre></div>



<a name="158583275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/158583275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#158583275">(Feb 15 2019 at 02:12)</a>:</h4>
<p><code>[a]</code> is the same as <code>a :: nil</code> (it's a special notation)</p>



<a name="158583362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/158583362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#158583362">(Feb 15 2019 at 02:14)</a>:</h4>
<p>You should consider doing your induction on <code>s</code> instead of <code>t</code>. The reason is that <code>++</code> is defined by recursion on <code>s</code> : <code>x :: xs ++ ys = x :: (xs ++ ys)</code></p>



<a name="158583389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/158583389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#158583389">(Feb 15 2019 at 02:15)</a>:</h4>
<p>Also: welcome to Zulip Paula!</p>



<a name="158583402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/158583402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paula Neeley <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#158583402">(Feb 15 2019 at 02:15)</a>:</h4>
<blockquote>
<p>You should consider doing your induction on <code>s</code> instead of <code>t</code>. The reason is that <code>++</code> is defined by recursion on <code>s</code> : <code>x :: xs ++ ys = x :: (xs ++ ys)</code></p>
</blockquote>
<p>Oh ok, I will try that! Thank you for your help!</p>



<a name="158598928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/158598928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#158598928">(Feb 15 2019 at 08:32)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">namespace</span> <span class="n">list</span>

<span class="kn">variable</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>
<span class="kn">variables</span> <span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span>
<span class="kn">variable</span> <span class="n">a</span> <span class="o">:</span> <span class="n">α</span>

<span class="kn">theorem</span> <span class="n">length_nil</span> <span class="o">:</span> <span class="n">length</span> <span class="o">(</span><span class="bp">@</span><span class="n">nil</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">theorem</span> <span class="n">append_nil&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">t</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">,</span> <span class="n">t</span> <span class="bp">++</span> <span class="n">nil</span> <span class="bp">=</span> <span class="n">t</span>
<span class="bp">|</span> <span class="o">[]</span>       <span class="o">:=</span> <span class="n">rfl</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">hd</span><span class="bp">::</span><span class="n">tl</span><span class="o">)</span> <span class="o">:=</span> <span class="n">congr_arg</span> <span class="o">((</span><span class="bp">::</span><span class="o">)</span><span class="n">hd</span><span class="o">)</span> <span class="o">(</span><span class="n">append_nil</span> <span class="n">tl</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">length_append&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">,</span> <span class="n">length</span> <span class="o">(</span><span class="n">s</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">length</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">length</span> <span class="n">t</span>
<span class="bp">|</span> <span class="o">[]</span>       <span class="n">t</span> <span class="o">:=</span> <span class="o">(</span><span class="n">zero_add</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">hd</span><span class="bp">::</span><span class="n">tl</span><span class="o">)</span> <span class="n">t</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">length_cons</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_add</span><span class="o">,</span> <span class="err">←</span> <span class="n">length_append&#39;</span> <span class="n">tl</span> <span class="n">t</span><span class="o">]</span><span class="bp">;</span> <span class="n">refl</span>

<span class="kn">theorem</span> <span class="n">length_append_cons</span> <span class="o">:</span> <span class="n">length</span> <span class="o">(</span><span class="n">s</span> <span class="bp">++</span> <span class="n">a</span> <span class="bp">::</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">length</span> <span class="o">(</span><span class="n">s</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">length_append&#39;</span><span class="o">,</span> <span class="n">length_append&#39;</span><span class="o">]</span><span class="bp">;</span> <span class="n">refl</span>

<span class="bp">#</span><span class="kn">check</span> <span class="n">append_nil&#39;</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">nil_append</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">cons_append</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">length_cons</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">length_nil</span>

<span class="bp">#</span><span class="kn">eval</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">]</span> <span class="bp">++</span> <span class="o">[</span><span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">length</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">]</span>

<span class="kn">end</span> <span class="n">list</span>
</pre></div>



<a name="160868091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160868091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Robert Spencer <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160868091">(Mar 15 2019 at 12:00)</a>:</h4>
<p>(deleted)</p>



<a name="160868727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160868727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tony Wang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160868727">(Mar 15 2019 at 12:11)</a>:</h4>
<p>(deleted)</p>



<a name="160869044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160869044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tony Wang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160869044">(Mar 15 2019 at 12:17)</a>:</h4>
<p>Hello - I was just wondering for the bit where I have <code>rw succ_a_plus_b_equals_a_plus_succ_b</code> below, surely there's a better way to use the definition of <code>add</code>?</p>
<div class="codehilite"><pre><span></span><span class="kn">inductive</span> <span class="n">xnat</span>
<span class="bp">|</span> <span class="n">zero</span> <span class="o">:</span> <span class="n">xnat</span>
<span class="bp">|</span> <span class="n">succ</span> <span class="o">:</span> <span class="n">xnat</span> <span class="bp">→</span> <span class="n">xnat</span>

<span class="kn">open</span> <span class="n">xnat</span>

<span class="n">def</span> <span class="n">add</span> <span class="o">:</span> <span class="n">xnat</span> <span class="bp">→</span> <span class="n">xnat</span> <span class="bp">→</span> <span class="n">xnat</span>
<span class="bp">|</span> <span class="n">n</span> <span class="n">zero</span> <span class="o">:=</span> <span class="n">n</span>
<span class="bp">|</span> <span class="n">a</span> <span class="o">(</span><span class="n">succ</span> <span class="n">b</span><span class="o">)</span> <span class="o">:=</span> <span class="n">succ</span> <span class="o">(</span><span class="n">add</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span>

<span class="kn">notation</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">add</span> <span class="n">a</span> <span class="n">b</span>

<span class="kn">theorem</span> <span class="n">succ_a_plus_b_equals_a_plus_succ_b</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">xnat</span><span class="o">)</span> <span class="o">:</span> <span class="n">succ</span><span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">succ</span><span class="o">(</span><span class="n">b</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">unfold</span> <span class="n">add</span>

<span class="kn">theorem</span> <span class="n">succ_is_succ_zero_add</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">xnat</span><span class="o">)</span> <span class="o">:</span> <span class="n">succ</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">succ</span> <span class="n">zero</span> <span class="bp">+</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">induction</span> <span class="n">a</span> <span class="k">with</span> <span class="n">k</span> <span class="n">Hk</span><span class="o">,</span>
    <span class="o">{</span>
        <span class="n">unfold</span> <span class="n">add</span>
    <span class="o">},</span>
    <span class="o">{</span>
        <span class="n">rw</span> <span class="n">Hk</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">succ_a_plus_b_equals_a_plus_succ_b</span><span class="o">,</span>
        <span class="n">rw</span> <span class="n">Hk</span>
    <span class="o">}</span>
<span class="kn">end</span>
</pre></div>



<a name="160869148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160869148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tony Wang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160869148">(Mar 15 2019 at 12:18)</a>:</h4>
<p>Nvm I found it: <code>rw ←add</code> seems to work!</p>



<a name="160869187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160869187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calle Sönne <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160869187">(Mar 15 2019 at 12:19)</a>:</h4>
<p>I have the following code:</p>
<div class="codehilite"><pre><span></span><span class="kn">definition</span> <span class="n">digit</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="n">floor</span><span class="o">(</span><span class="n">r</span> <span class="bp">*</span> <span class="n">b</span> <span class="err">^</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="bp">-</span> <span class="n">floor</span><span class="o">(</span><span class="n">r</span> <span class="bp">*</span> <span class="n">b</span> <span class="err">^</span> <span class="n">n</span><span class="o">)</span><span class="bp">*</span><span class="n">b</span>

<span class="kn">lemma</span> <span class="n">digit_mul_base</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">digit</span> <span class="n">b</span> <span class="n">r</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">digit</span> <span class="n">b</span> <span class="o">(</span><span class="n">r</span><span class="bp">*</span><span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">rwa</span> <span class="o">[</span><span class="n">digit</span><span class="o">,</span> <span class="n">digit</span><span class="o">,</span> <span class="n">mul_assoc</span><span class="o">],</span> <span class="n">conv</span>
  <span class="k">begin</span> <span class="n">congr</span><span class="o">,</span> <span class="n">skip</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="err">←</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_pow</span><span class="o">,</span> <span class="err">←</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_mul</span><span class="o">,</span> <span class="err">←</span><span class="n">pow_succ</span> <span class="n">b</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)],</span>
  <span class="kn">end</span><span class="o">,</span>
<span class="kn">end</span>
</pre></div>


<p>This gives me an error with following tactic state:</p>
<div class="codehilite"><pre><span></span><span class="n">rewrite</span> <span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">did</span> <span class="n">not</span> <span class="n">find</span> <span class="kn">instance</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pattern</span> <span class="k">in</span> <span class="n">the</span> <span class="n">target</span> <span class="n">expression</span>
  <span class="n">b</span> <span class="bp">*</span> <span class="n">b</span> <span class="err">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">linear_ordered_ring</span> <span class="n">α</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_2</span> <span class="o">:</span> <span class="n">floor_ring</span> <span class="n">α</span><span class="o">,</span>
<span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span>
<span class="n">r</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span>
<span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span>
<span class="err">⊢</span> <span class="err">⌊</span><span class="n">r</span> <span class="bp">*</span> <span class="err">↑</span><span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">b</span> <span class="err">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span><span class="err">⌋</span> <span class="bp">-</span> <span class="err">⌊</span><span class="n">r</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">b</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">b</span> <span class="err">^</span> <span class="n">n</span><span class="err">⌋</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">b</span> <span class="bp">=</span> <span class="err">?</span><span class="n">m_1</span>
</pre></div>


<p>I cant seem to find the error, any help would be appreciated</p>



<a name="160869679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160869679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Tony Wang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160869679">(Mar 15 2019 at 12:27)</a>:</h4>
<p>If I unfold a definition with more than one part, is it possible to specify which part I want to unfold?</p>



<a name="160869914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160869914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160869914">(Mar 15 2019 at 12:30)</a>:</h4>
<p>you can use <code>conv</code> to focus on a subterm</p>



<a name="160904675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160904675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160904675">(Mar 15 2019 at 19:14)</a>:</h4>
<p>[changed thread title]. <span class="user-mention" data-user-id="132603">@Calle Sönne</span> </p>
<p>One <code>b * b ^ (n + 1)</code> is</p>
<div class="codehilite"><pre><span></span>    @has_mul.mul.{0} nat (@semigroup.to_has_mul.{0} nat (@monoid.to_semigroup.{0} nat nat.monoid)) b
    (@has_pow.pow.{0 0} nat nat (@monoid.has_pow.{0} nat nat.monoid) b
       (@has_add.add.{0} nat nat.has_add n (@has_one.one.{0} nat nat.has_one)))
</pre></div>


<p>and the other is</p>
<div class="codehilite"><pre><span></span>     (@has_mul.mul.{0} nat nat.has_mul b
                   (@has_pow.pow.{0 0} nat nat nat.has_pow b
                      (@has_add.add.{0} nat nat.has_add n (@has_one.one.{0} nat nat.has_one)))))))
</pre></div>


<p>and these are apparently not defeq.</p>



<a name="160904926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160904926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160904926">(Mar 15 2019 at 19:17)</a>:</h4>
<p><code>example : @monoid.has_pow.{0} nat nat.monoid = nat.has_pow := rfl -- fails</code></p>
<p>There's the problem. You have two different powers.</p>



<a name="160905588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160905588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160905588">(Mar 15 2019 at 19:24)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">test</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">has_pow</span><span class="bp">.</span><span class="n">pow</span> <span class="bp">ℕ</span> <span class="bp">ℕ</span> <span class="o">(</span><span class="bp">@</span><span class="n">monoid</span><span class="bp">.</span><span class="n">has_pow</span><span class="bp">.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">nat</span> <span class="n">nat</span><span class="bp">.</span><span class="n">monoid</span><span class="o">)</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a</span> <span class="err">^</span> <span class="n">b</span> <span class="o">:=</span> <span class="k">begin</span>
  <span class="n">induction</span> <span class="n">b</span> <span class="k">with</span> <span class="n">c</span> <span class="n">Hc</span><span class="o">,</span>
    <span class="n">refl</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">has_pow</span><span class="bp">.</span><span class="n">pow</span> <span class="n">monoid</span><span class="bp">.</span><span class="n">pow</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">Hc</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">mul_comm</span><span class="o">,</span> <span class="c1">-- *boggle*</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">digit_mul_base</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">digit</span> <span class="n">b</span> <span class="n">r</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">digit</span> <span class="n">b</span> <span class="o">(</span><span class="n">r</span><span class="bp">*</span><span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">rwa</span> <span class="o">[</span><span class="n">digit</span><span class="o">,</span> <span class="n">digit</span><span class="o">,</span> <span class="n">mul_assoc</span><span class="o">],</span> <span class="n">conv</span>
  <span class="k">begin</span> <span class="n">congr</span><span class="o">,</span> <span class="n">skip</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="err">←</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_pow</span><span class="o">,</span> <span class="err">←</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_mul</span><span class="o">],</span>
  <span class="n">rw</span> <span class="err">←</span><span class="n">test</span><span class="o">,</span> <span class="c1">-- no visible effect ;-)</span>
  <span class="n">rw</span> <span class="err">←</span><span class="n">pow_succ</span> <span class="n">b</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">),</span> <span class="c1">-- works now ;-)</span>
  <span class="kn">end</span><span class="o">,</span>
</pre></div>



<a name="160905621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160905621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160905621">(Mar 15 2019 at 19:24)</a>:</h4>
<p>So there's a crappy fix, but actually someone with some sense should hopefully come along at some point and tell us what we should be doing. <span class="user-mention" data-user-id="110044">@Chris Hughes</span> ?</p>



<a name="160905675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160905675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160905675">(Mar 15 2019 at 19:25)</a>:</h4>
<p>There's a lemma <code>nat.pow_eq_pow</code> I think.</p>



<a name="160905709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160905709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160905709">(Mar 15 2019 at 19:26)</a>:</h4>
<p>Thanks. <span class="user-mention" data-user-id="132603">@Calle Sönne</span> rewrite that instead of <code>test</code>.</p>



<a name="160905766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160905766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160905766">(Mar 15 2019 at 19:26)</a>:</h4>
<p>It's also a crappy fix</p>



<a name="160905793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160905793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160905793">(Mar 15 2019 at 19:26)</a>:</h4>
<p>yes but at least we're going in the right direction. Why did it happen? Something to do with the casts no doubt.</p>



<a name="160905809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160905809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160905809">(Mar 15 2019 at 19:26)</a>:</h4>
<p>We can add this one to Rob Lewis' list of cast issues ;-)</p>



<a name="160906309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160906309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160906309">(Mar 15 2019 at 19:32)</a>:</h4>
<p>The better solution is actually to use <code>nat.pow_succ</code> on closer inspection.</p>



<a name="160944954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160944954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calle Sönne <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160944954">(Mar 16 2019 at 10:01)</a>:</h4>
<p>thanks, that worked</p>



<a name="160945015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160945015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160945015">(Mar 16 2019 at 10:02)</a>:</h4>
<p>Aah bingo</p>



<a name="160945040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rw%20failure/near/160945040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rw.20failure.html#160945040">(Mar 16 2019 at 10:03)</a>:</h4>
<p>Nat has its own suite of pow lemmas because nat.pow is in core so we can't redefine it to be monoid.pow</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>