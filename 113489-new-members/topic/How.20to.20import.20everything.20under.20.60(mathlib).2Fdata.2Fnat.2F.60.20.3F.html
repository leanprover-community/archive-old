---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html">How to import everything under `(mathlib)/data/nat/` ?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="275910277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910277">(Mar 19 2022 at 13:18)</a>:</h4>
<p>Since I never know beforehand which precise files I need to import (who would have guessed that <code>nat.odd_of_mod_four_eq_three</code> lives in <code>data.nat.modeq</code>?), I would like to imprt everything related to <code>nat</code>s (say) in one go. But <code>import data.nat</code> gives the error <code>file 'data/nat' not found in the search path</code> (whereas <code>import tactic</code> does work, even though <code>tactic</code> is a folder and not a file). So how can I get around this?</p>



<a name="275910347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910347">(Mar 19 2022 at 13:20)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> <em>If</em> there is a file <code>some/directory/default.lean</code>, then that will get imported if you write <code>import some.directory</code>.</p>



<a name="275910356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910356">(Mar 19 2022 at 13:20)</a>:</h4>
<p>But not all directories have such a file. And <code>default.lean</code> doesn't always import all other files in the directory either.</p>



<a name="275910438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910438">(Mar 19 2022 at 13:23)</a>:</h4>
<p>OK; this tells me why my attempt did not work. But is there a reasonable way to do it other than importing all the individual files? I guess I could write some sort of <code>all_nat.lean</code> file for this and import that. Is this the way to go?</p>



<a name="275910453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910453">(Mar 19 2022 at 13:23)</a>:</h4>
<p>YOu would end up importing most of the library I suspect. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">N</span></span></span></span> has <em>a lot</em> of properties.</p>



<a name="275910500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910500">(Mar 19 2022 at 13:24)</a>:</h4>
<p>I feel like out of all the folders, data/nat could definbitely have a <code>default</code>; I thought the same as Yael but I had a hunt and there's no really egregiously large file there</p>



<a name="275910504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910504">(Mar 19 2022 at 13:24)</a>:</h4>
<p>In a separate thread, Kevin said this:</p>
<p>You can always run <code>./scripts/mk_all.sh</code> on the command line and then <code>import all</code> if you want to search all of mathlib.</p>



<a name="275910508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910508">(Mar 19 2022 at 13:24)</a>:</h4>
<p>BTW, generating <code>all.lean</code> and doing <code>import all</code> tends to produce <code>excessive memory errors</code> on things like <code>suggest</code>or <code>hint</code>...</p>



<a name="275910514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910514">(Mar 19 2022 at 13:24)</a>:</h4>
<p>(I was just typing this before Damiano replied...)</p>



<a name="275910538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910538">(Mar 19 2022 at 13:25)</a>:</h4>
<p>I feel like the most efficient way to search theorems in mathlib is using the regex search</p>



<a name="275910580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910580" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910580">(Mar 19 2022 at 13:26)</a>:</h4>
<p>The concrete motivation for my question is the following. I want to prove</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">p</span> <span class="bp">=</span> <span class="mi">4</span><span class="bp">*</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">3</span> <span class="o">:=</span> <span class="bp">?</span>
</code></pre></div>
<p>believing that this should certainly be (in a suitably more general form) in mathlib, but I was unable to find it...</p>



<a name="275910581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910581">(Mar 19 2022 at 13:26)</a>:</h4>
<p>indeed, just typing <code>% 4</code> finds this theorem pretty instantly</p>



<a name="275910596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910596">(Mar 19 2022 at 13:27)</a>:</h4>
<p>Where do I type <code>% 4</code>?</p>



<a name="275910652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910652">(Mar 19 2022 at 13:28)</a>:</h4>
<p>if you're using <code>vscode</code>, you can press the search thing on the left or press (ctrl/command)+shift+f</p>



<a name="275910678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910678">(Mar 19 2022 at 13:29)</a>:</h4>
<p>If I do that, I find lots of places where <code>% 4</code> occurs in my project files, but it doesn't appear to search the library.</p>



<a name="275910730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910730">(Mar 19 2022 at 13:30)</a>:</h4>
<p>oh! you'll need to turn off the cog of doom</p>



<a name="275910741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910741">(Mar 19 2022 at 13:30)</a>:</h4>
<p><a href="/user_uploads/3121/oTBwmO4eeXOBdOX91P4qJMQD/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/oTBwmO4eeXOBdOX91P4qJMQD/image.png" title="image.png"><img src="/user_uploads/3121/oTBwmO4eeXOBdOX91P4qJMQD/image.png"></a></div><p>unpress that weird cog at the bottom right</p>



<a name="275910764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910764">(Mar 19 2022 at 13:31)</a>:</h4>
<p>(in this case though, you may enjoy <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.div_add_mod">docs#nat.div_add_mod</a>, too)</p>



<a name="275910810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275910810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275910810">(Mar 19 2022 at 13:32)</a>:</h4>
<p>Yeah, the proof is <code>use p/4</code> then <code>rw &lt;- hp</code> followed by <code>library_search</code></p>



<a name="275911034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275911034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275911034">(Mar 19 2022 at 13:38)</a>:</h4>
<p>I knew that I had seen this at some point, but wasn't able to find it again...</p>



<a name="275911071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275911071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275911071">(Mar 19 2022 at 13:39)</a>:</h4>
<p>Which is an experience I'm having more and more frequently.</p>



<a name="275911133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275911133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275911133">(Mar 19 2022 at 13:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="284160">Eric Rodriguez</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60.28mathlib.29.2Fdata.2Fnat.2F.60.20.3F/near/275910500">said</a>:</p>
<blockquote>
<p>I thought the same as Yael but I had a hunt and there's no really egregiously large file there</p>
</blockquote>
<p>My point is that not all the properties of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">N</span></span></span></span> are under <code>data.nat.</code>.</p>



<a name="275911527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275911527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275911527">(Mar 19 2022 at 13:50)</a>:</h4>
<p>And how do I do</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="n">odd</span> <span class="o">((</span><span class="n">p</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">?</span>
</code></pre></div>
<p>Somehow I think that all these trivial elementary number theory lemmas should be much easier to obtain...</p>



<a name="275912071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275912071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275912071">(Mar 19 2022 at 14:03)</a>:</h4>
<p>... than in the way I'm trying to do it.</p>



<a name="275912147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275912147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275912147">(Mar 19 2022 at 14:05)</a>:</h4>
<p>Maybe giving <code>(p - 3)/4</code> as a witness of oddness is somewhat easy?</p>



<a name="275912442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275912442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275912442">(Mar 19 2022 at 14:13)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">:</span> <span class="n">odd</span> <span class="o">((</span><span class="n">p</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">p</span> <span class="bp">=</span> <span class="mi">4</span><span class="bp">*</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">use</span> <span class="n">p</span><span class="bp">/</span><span class="mi">4</span><span class="o">,</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">hp</span><span class="o">,</span> <span class="n">exact</span> <span class="o">(</span><span class="n">nat.div_add_mod</span> <span class="n">p</span> <span class="mi">4</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">use</span> <span class="o">(</span><span class="n">p</span><span class="bp">-</span><span class="mi">3</span><span class="o">)</span><span class="bp">/</span><span class="mi">4</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">h</span><span class="o">],</span>
  <span class="n">nth_rewrite</span> <span class="mi">0</span> <span class="o">(</span><span class="kd">by</span> <span class="n">norm_num</span> <span class="o">:</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="mi">2</span><span class="o">),</span>
  <span class="n">rw</span> <span class="n">mul_assoc</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>I'm sure this can be simplified...</p>



<a name="275915037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275915037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275915037">(Mar 19 2022 at 15:16)</a>:</h4>
<p>You are using subtraction and division of naturals so you can expect pain. Neither of these operations are mathematically well-behaved in Lean</p>



<a name="275915893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275915893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275915893">(Mar 19 2022 at 15:39)</a>:</h4>
<p>I'm going to use things as exponents, so I do want naturals... Also, prime numbers are naturals in mathlib.</p>



<a name="275918357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275918357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275918357">(Mar 19 2022 at 16:42)</a>:</h4>
<p>Here is finally what I wanted to achieve. I had expected this to be part of the API in <code>number_theory.sum_two_squares</code>, but there is really no API there. (One has to add the necessary imports.)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- A lemma from elementary number theory that should be in the library -/</span>
<span class="kd">lemma</span> <span class="n">prime_eq_three_mod_four_not_dvd_sum_of_two_squares</span>
  <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">[</span><span class="n">fact</span> <span class="n">p.prime</span><span class="o">]</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hab</span> <span class="o">:</span> <span class="n">is_coprime</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="bp">¬</span> <span class="bp">↑</span><span class="n">p</span> <span class="bp">∣</span> <span class="n">a</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">b</span><span class="bp">^</span><span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="c1">-- rewrite divisibility assumption as an equality in ℤ/pℤ</span>
  <span class="k">have</span> <span class="n">h₁</span> <span class="o">:</span> <span class="o">((</span><span class="n">a</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">b</span><span class="bp">^</span><span class="mi">2</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="o">(</span><span class="n">zmod.int_coe_zmod_eq_zero_iff_dvd</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">push_cast</span> <span class="n">at</span> <span class="n">h₁</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h₂</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">=</span> <span class="bp">-↑</span><span class="n">b</span><span class="bp">^</span><span class="mi">2</span> <span class="o">:=</span> <span class="n">eq_neg_of_add_eq_zero</span> <span class="n">h₁</span><span class="o">,</span>
  <span class="c1">-- The idea is now to deduce from a² = -b² in ℤ/pℤ that 1 = -1</span>
  <span class="c1">-- using Fermat's little theorem</span>
  <span class="k">have</span> <span class="n">h₃</span> <span class="o">:=</span> <span class="n">nat.mul_div_cancel'</span> <span class="o">(</span><span class="n">div_sub_one_of_mod_two_eq_one</span> <span class="n">p</span> <span class="o">(</span><span class="n">nat.odd_of_mod_four_eq_three</span> <span class="n">hp</span><span class="o">)),</span>
  <span class="c1">-- h₃ : 2*((p-1)/2) = p-1</span>
  <span class="k">have</span> <span class="n">h₄</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">p</span> <span class="bp">=</span> <span class="mi">4</span><span class="bp">*</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">use</span> <span class="n">p</span><span class="bp">/</span><span class="mi">4</span><span class="o">,</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">hp</span><span class="o">,</span> <span class="n">exact</span> <span class="o">(</span><span class="n">nat.div_add_mod</span> <span class="n">p</span> <span class="mi">4</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">cases</span> <span class="n">h₄</span> <span class="k">with</span> <span class="n">n</span> <span class="n">h₄</span><span class="o">,</span>
  <span class="c1">-- we need to know that `(p-1)/2` is odd</span>
  <span class="k">have</span> <span class="n">hodd</span> <span class="o">:</span> <span class="n">odd</span> <span class="o">((</span><span class="n">p</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">:=</span>
  <span class="kd">by</span> <span class="o">{</span> <span class="n">use</span> <span class="o">(</span><span class="n">p</span><span class="bp">-</span><span class="mi">3</span><span class="o">)</span><span class="bp">/</span><span class="mi">4</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">h₄</span><span class="o">],</span>
       <span class="n">nth_rewrite</span> <span class="mi">0</span> <span class="o">(</span><span class="kd">by</span> <span class="n">norm_num</span> <span class="o">:</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="mi">2</span><span class="o">),</span>
       <span class="n">rw</span> <span class="n">mul_assoc</span><span class="o">,</span>
       <span class="n">simp</span><span class="o">,</span> <span class="o">},</span>
  <span class="c1">-- raise our equality to the `(p-1)/2`th power</span>
  <span class="k">have</span> <span class="n">h₅</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span><span class="bp">^</span><span class="o">(</span><span class="n">p</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">-↑</span><span class="n">b</span><span class="bp">^</span><span class="o">(</span><span class="n">p</span><span class="bp">-</span><span class="mi">1</span><span class="o">),</span>
  <span class="o">{</span> <span class="k">have</span> <span class="n">h₂'</span> <span class="o">:</span> <span class="o">((</span><span class="n">a</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span><span class="bp">^</span><span class="mi">2</span><span class="o">)</span><span class="bp">^</span><span class="o">((</span><span class="n">p</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-↑</span><span class="n">b</span><span class="bp">^</span><span class="mi">2</span><span class="o">)</span><span class="bp">^</span><span class="o">((</span><span class="n">p</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">:=</span>
    <span class="n">congr_fun</span> <span class="o">(</span><span class="n">congr_arg</span> <span class="n">pow</span> <span class="n">h₂</span><span class="o">)</span> <span class="o">((</span><span class="n">p</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">),</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">pow_mul</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a</span><span class="o">),</span> <span class="n">neg_pow</span><span class="o">,</span> <span class="bp">←</span> <span class="n">pow_mul</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b</span><span class="o">),</span> <span class="n">h₃</span><span class="o">,</span> <span class="n">nat.neg_one_pow_of_odd</span> <span class="n">hodd</span><span class="o">,</span> <span class="n">neg_one_mul</span><span class="o">]</span> <span class="n">at</span> <span class="n">h₂'</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">h₂'</span><span class="o">,</span> <span class="o">},</span>
  <span class="c1">-- another bit of trivial knowledge that is needed</span>
  <span class="k">have</span> <span class="n">h₆</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">p</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h₄</span><span class="o">],</span> <span class="o">},</span>
  <span class="c1">-- we can apply Fermat's little theorem when `a` and `b` are nonzero in ℤ/pℤ,</span>
  <span class="c1">-- so we have to distinguish cases here</span>
  <span class="n">by_cases</span> <span class="n">ha</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">ha</span><span class="o">,</span> <span class="n">zero_pow</span> <span class="n">h₆</span><span class="o">]</span> <span class="n">at</span> <span class="n">h₅</span><span class="o">,</span>
    <span class="c1">-- if `a = 0` mod `p`, then `b = 0` mod `p`, so `p` divides `a` and `b`,</span>
    <span class="c1">-- which contradicts the coprimality assumption</span>
    <span class="k">have</span> <span class="n">hpa</span> <span class="o">:=</span> <span class="o">(</span><span class="n">zmod.int_coe_zmod_eq_zero_iff_dvd</span> <span class="n">a</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">ha</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">hpb</span> <span class="o">:=</span> <span class="o">(</span><span class="n">zmod.int_coe_zmod_eq_zero_iff_dvd</span> <span class="n">b</span> <span class="n">p</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="o">(</span><span class="n">pow_eq_zero</span> <span class="n">h₅</span><span class="o">),</span>
    <span class="n">rcases</span> <span class="n">hab</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">u</span><span class="o">,</span> <span class="n">v</span><span class="o">,</span> <span class="n">hab</span><span class="o">⟩,</span>
    <span class="k">have</span> <span class="n">hf</span> <span class="o">:</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">∣</span> <span class="mi">1</span> <span class="o">:=</span>
    <span class="kd">by</span> <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">hab</span><span class="o">],</span>
         <span class="n">apply</span> <span class="n">dvd_add</span><span class="o">,</span>
         <span class="n">apply</span> <span class="n">dvd_mul_of_dvd_right</span> <span class="n">hpa</span><span class="o">,</span>
         <span class="n">apply</span> <span class="n">dvd_mul_of_dvd_right</span> <span class="n">hpb</span><span class="o">,</span> <span class="o">},</span>
    <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">hf</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">nat.prime.not_dvd_one</span> <span class="n">_inst_1.1</span> <span class="n">hf</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="c1">-- now the case that `a ≠ 0` mod `p`</span>
    <span class="n">rw</span> <span class="n">zmod.pow_card_sub_one_eq_one</span> <span class="n">ha</span> <span class="n">at</span> <span class="n">h₅</span><span class="o">,</span>
    <span class="c1">-- we have to get rid of the possibility that `b = 0` mod `p`</span>
    <span class="n">by_cases</span> <span class="n">hb</span> <span class="o">:</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hb</span><span class="o">,</span> <span class="n">zero_pow</span> <span class="n">h₆</span><span class="o">]</span> <span class="n">at</span> <span class="n">h₅</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">h₅</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">{</span> <span class="c1">-- now both are nonzero mod `p` and we get that `1 = -1` mod `p`</span>
      <span class="n">rw</span> <span class="n">zmod.pow_card_sub_one_eq_one</span> <span class="n">hb</span> <span class="n">at</span> <span class="n">h₅</span><span class="o">,</span>
      <span class="c1">-- it is surprisingly hard to get from this to a contradiction...</span>
      <span class="k">have</span> <span class="n">h₇</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">p</span> <span class="bp">∣</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:=</span>
      <span class="kd">by</span> <span class="o">{</span> <span class="n">rw</span> <span class="o">[(</span><span class="kd">by</span> <span class="n">norm_cast</span> <span class="o">:</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)),</span> <span class="o">(</span><span class="kd">by</span> <span class="n">norm_cast</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">))]</span> <span class="n">at</span> <span class="n">h₅</span><span class="o">,</span>
           <span class="n">rw</span> <span class="o">[</span><span class="n">zmod.int_coe_eq_int_coe_iff</span><span class="o">,</span> <span class="n">int.modeq_iff_dvd</span><span class="o">]</span> <span class="n">at</span> <span class="n">h₅</span><span class="o">,</span>
           <span class="n">norm_num</span> <span class="n">at</span> <span class="n">h₅</span><span class="o">,</span>
           <span class="n">exact</span> <span class="n">h₅</span><span class="o">,</span> <span class="o">},</span>
      <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">h₇</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">hp2</span> <span class="o">:</span> <span class="mi">2</span> <span class="bp">&lt;</span> <span class="n">p</span> <span class="o">:=</span>
      <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h₄</span><span class="o">],</span> <span class="n">apply</span> <span class="n">nat.succ_lt_succ</span><span class="o">,</span> <span class="n">apply</span> <span class="n">nat.succ_lt_succ</span><span class="o">,</span> <span class="n">exact</span> <span class="n">nat.zero_lt_succ</span> <span class="n">_</span><span class="o">,</span> <span class="o">},</span>
      <span class="k">have</span> <span class="n">h₈</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≤</span> <span class="mi">2</span> <span class="o">:=</span> <span class="n">nat.le_of_dvd</span> <span class="o">(</span><span class="n">nat.zero_lt_succ</span> <span class="mi">1</span><span class="o">)</span> <span class="n">h₇</span><span class="o">,</span>
      <span class="n">revert</span> <span class="n">hp2</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">not_lt_of_le</span> <span class="n">h₈</span><span class="o">,</span> <span class="o">},</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>
<p>This has cost me a full day! <span aria-label="frown" class="emoji emoji-1f641" role="img" title="frown">:frown:</span>  It shouldn't be that hard...</p>



<a name="275920576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275920576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275920576">(Mar 19 2022 at 17:35)</a>:</h4>
<p>I know but wasn't it <em>satisfying</em>!</p>



<a name="275920666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275920666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275920666">(Mar 19 2022 at 17:37)</a>:</h4>
<p>It might have been cheaper to deduce that -1 is a square and then use the fact (in the library) that this is false if p=3 mod 4</p>



<a name="275921327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275921327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275921327">(Mar 19 2022 at 17:53)</a>:</h4>
<p>Not sure that it would be much cheaper to get to <code>-1</code> being a square mod <code>p</code>. But feel free to suggest a more efficient proof <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="275922156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275922156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275922156">(Mar 19 2022 at 18:12)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">number_theory.sum_two_squares</span>

<span class="sd">/-- A lemma from elementary number theory that should be in the library -/</span>
<span class="kd">lemma</span> <span class="n">prime_eq_three_mod_four_not_dvd_sum_of_two_squares</span>
  <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">[</span><span class="n">fact</span> <span class="n">p.prime</span><span class="o">]</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">%</span> <span class="mi">4</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hab</span> <span class="o">:</span> <span class="n">is_coprime</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="bp">¬</span> <span class="bp">↑</span><span class="n">p</span> <span class="bp">∣</span> <span class="n">a</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">b</span><span class="bp">^</span><span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">contrapose</span><span class="bp">!</span> <span class="n">hp</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">zmod.exists_sq_eq_neg_one_iff_mod_four_ne_three</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">←</span> <span class="n">zmod.int_coe_zmod_eq_zero_iff_dvd</span><span class="o">,</span> <span class="n">int.cast_add</span><span class="o">,</span> <span class="n">int.cast_pow</span><span class="o">]</span> <span class="n">at</span> <span class="n">hp</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="n">hb</span><span class="bp">|</span><span class="n">hb</span> <span class="o">:=</span> <span class="n">eq_or_ne</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">)</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">hb</span><span class="o">,</span> <span class="n">zero_pow'</span><span class="o">,</span> <span class="n">ne.def</span><span class="o">,</span> <span class="n">bit0_eq_zero</span><span class="o">,</span> <span class="n">nat.one_ne_zero</span><span class="o">,</span> <span class="n">not_false_iff</span><span class="o">,</span> <span class="n">add_zero</span><span class="o">,</span>
      <span class="n">pow_eq_zero_iff</span><span class="o">,</span> <span class="n">nat.succ_pos'</span><span class="o">]</span> <span class="n">at</span> <span class="n">hp</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">zmod.int_coe_zmod_eq_zero_iff_dvd</span><span class="o">,</span> <span class="bp">←</span> <span class="n">int.dvd_nat_abs</span><span class="o">,</span> <span class="n">int.coe_nat_dvd</span><span class="o">]</span> <span class="n">at</span> <span class="n">hb</span> <span class="n">hp</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">int.coprime_iff_nat_coprime</span> <span class="n">at</span> <span class="n">hab</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h1p</span> <span class="o">:</span> <span class="mi">1</span> <span class="bp">&lt;</span> <span class="n">p</span> <span class="o">:=</span> <span class="n">fact.out</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">nat.not_coprime_of_dvd_of_dvd</span> <span class="n">h1p</span> <span class="n">hp</span> <span class="n">hb</span> <span class="n">hab</span><span class="o">)</span><span class="bp">.</span><span class="n">elim</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">a</span> <span class="bp">/</span> <span class="n">b</span> <span class="o">:</span> <span class="n">zmod</span> <span class="n">p</span><span class="o">),</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">field_simp</span> <span class="o">[</span><span class="n">hb</span><span class="o">,</span> <span class="n">eq_neg_iff_add_eq_zero</span><span class="o">,</span> <span class="n">hp</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>



<a name="275922495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275922495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275922495">(Mar 19 2022 at 18:20)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Thanks! I did not realize that <code>nat.not_coprime_of_dvd_of_dvd</code> was there; this saves a few extra lines...</p>



<a name="275922589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275922589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275922589">(Mar 19 2022 at 18:22)</a>:</h4>
<p>Also, it suffices to case on whether <code>(b : zmod p)</code> is <code>0</code>.</p>



<a name="275923152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275923152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275923152">(Mar 19 2022 at 18:35)</a>:</h4>
<p>Yes, I saw that in your code.</p>



<a name="275925679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275925679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275925679">(Mar 19 2022 at 19:35)</a>:</h4>
<p>Is there an integers version of <code>nat.not_coprime_of_dvd_of_dvd</code>?</p>



<a name="275927450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927450">(Mar 19 2022 at 20:14)</a>:</h4>
<p>Nope, but there should be. My proof is a bit hacky at that point.</p>



<a name="275927459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927459">(Mar 19 2022 at 20:14)</a>:</h4>
<p>Otoh, that would probably use <code>p : ℤ</code>. So we'd still need some glue at some point.</p>



<a name="275927466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927466" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927466">(Mar 19 2022 at 20:14)</a>:</h4>
<p>Presumably a more general version for any commutative ring would make sense.</p>



<a name="275927485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927485">(Mar 19 2022 at 20:15)</a>:</h4>
<p>Agreed. I guess it makes sense in any UFD? Or <code>gcd_domain</code>? I don't know precisely what's needed.</p>



<a name="275927525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927525">(Mar 19 2022 at 20:16)</a>:</h4>
<p>When dealing with primes, one has to convert between ℕ and ℤ anyway.</p>



<a name="275927560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927560">(Mar 19 2022 at 20:17)</a>:</h4>
<p>Commutative ring should be OK. The proof is the same: <code>a | b</code> and <code>a | c</code> implies <code>a | u*b + v*c = 1</code> if <code>b</code> and <code>c</code> are coprime, as witnessed by <code>u</code> and <code>v</code>. The condition for <code>a</code> is then that <code>a</code> is not a unit (which is clearly a bit less nice to work with than <code>a ≠ 1</code>).</p>



<a name="275927711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927711">(Mar 19 2022 at 20:21)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">field_theory.abel_ruffini</span>

<span class="kd">lemma</span> <span class="n">coprime_of_dvd_of_dvd</span> <span class="o">{</span><span class="n">R</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">d</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">is_unit</span> <span class="n">d</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">d</span> <span class="bp">∣</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">hy</span> <span class="o">:</span> <span class="n">d</span> <span class="bp">∣</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">is_coprime</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rintro</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">hab</span><span class="o">⟩,</span>
  <span class="n">apply</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">is_unit_of_dvd_unit</span> <span class="o">(</span><span class="k">show</span> <span class="n">d</span> <span class="bp">∣</span> <span class="mi">1</span><span class="o">,</span> <span class="k">from</span> <span class="n">hab</span> <span class="bp">▸</span> <span class="n">hx.linear_comb</span> <span class="n">hy</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="n">is_unit_one</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="275927746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927746">(Mar 19 2022 at 20:22)</a>:</h4>
<p>I'll leave it to you to figure out the right imports :b</p>



<a name="275927766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20import%20everything%20under%20%60%28mathlib%29/data/nat/%60%20%3F/near/275927766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20import.20everything.20under.20.60(mathlib).2Fdata.2Fnat.2F.60.20.3F.html#275927766">(Mar 19 2022 at 20:22)</a>:</h4>
<p>It should better be called <code>not_coprime_...</code> <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>