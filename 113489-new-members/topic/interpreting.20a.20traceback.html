---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/interpreting.20a.20traceback.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html">interpreting a traceback</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="212226223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226223">(Oct 04 2020 at 14:47)</a>:</h4>
<p>How do I read:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">lean</span><span class="o">]</span> <span class="o">[</span><span class="n">I</span><span class="o">]</span> <span class="o">[</span><span class="n">eqn_compiler.elim_match</span><span class="o">]</span> <span class="n">depth</span> <span class="o">[</span><span class="mi">1</span><span class="o">]</span>
<span class="k">match</span> <span class="n">_match</span> <span class="o">:</span> <span class="n">board</span> <span class="n">m</span> <span class="n">n</span> <span class="n">ι</span> <span class="n">K</span><span class="o">[</span><span class="n">_a</span><span class="o">]</span>
  <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">:=</span> <span class="n">s.start_board</span>
  <span class="o">(</span><span class="bp">⁇</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">⁇</span>
  <span class="o">(</span><span class="n">_x</span><span class="o">)</span> <span class="o">:=</span> <span class="n">s.boards</span> <span class="o">(</span><span class="bp">⁇</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span>
<span class="kd">example</span><span class="o">:</span> <span class="o">(</span><span class="n">_a</span><span class="o">)</span>
<span class="o">[</span><span class="n">eqn_compiler.elim_match</span><span class="o">]</span> <span class="n">compilation</span> <span class="n">failed</span> <span class="n">at</span>
<span class="k">match</span> <span class="n">_match</span> <span class="o">:</span> <span class="n">board</span> <span class="n">m</span> <span class="n">n</span> <span class="n">ι</span> <span class="n">K</span><span class="o">[</span><span class="n">_a</span><span class="o">]</span>
  <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="o">:=</span> <span class="n">s.start_board</span>
  <span class="o">(</span><span class="bp">⁇</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">⁇</span>
  <span class="o">(</span><span class="n">_x</span><span class="o">)</span> <span class="o">:=</span> <span class="n">s.boards</span> <span class="o">(</span><span class="bp">⁇</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span>
<span class="kd">example</span><span class="o">:</span> <span class="o">(</span><span class="n">_a</span><span class="o">)</span>
</code></pre></div>

<p>which is coming out of</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">end_board</span> <span class="o">:</span> <span class="n">board</span> <span class="n">m</span> <span class="n">n</span> <span class="n">ι</span> <span class="n">K</span> <span class="o">:=</span>
<span class="k">match</span> <span class="n">o</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">s.start_board</span><span class="o">,</span>
<span class="bp">|</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">s.boards</span> <span class="o">(</span><span class="n">o</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">o</span><span class="o">)</span>
<span class="kd">end</span>
</code></pre></div>

<p>for <code>o</code> a natural number. I'm sure I'm doing multiple things wrong there but yeah can't interpret that error message. <code>_a</code> is some element of the type it's trying to ensure I've covered in the match expression?</p>



<a name="212226274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226274">(Oct 04 2020 at 14:48)</a>:</h4>
<p>(One of the basic things I'm doing wrong I'm sure is I can't figure out how to get <code>n - 1</code> as an element of <code>fin n</code>, so if that's related yeah let me know.)</p>



<a name="212226344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226344">(Oct 04 2020 at 14:50)</a>:</h4>
<p>I think you will want <a href="https://leanprover-community.github.io/mathlib_docs/find/fin.last">docs#fin.last</a></p>



<a name="212226365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226365">(Oct 04 2020 at 14:51)</a>:</h4>
<p>ugh I looked all over <a href="https://leanprover-community.github.io/mathlib_docs/core/init/data/fin/basic.html#fin">https://leanprover-community.github.io/mathlib_docs/core/init/data/fin/basic.html#fin</a> and <a href="https://leanprover-community.github.io/mathlib_docs/core/init/data/fin/ops.html">https://leanprover-community.github.io/mathlib_docs/core/init/data/fin/ops.html</a> and was wondering why there was so little there :/ -- thanks <span class="user-mention" data-user-id="110032">@Reid Barton</span></p>



<a name="212226430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226430">(Oct 04 2020 at 14:53)</a>:</h4>
<p>Hrm that gives</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">lean</span><span class="o">]</span> <span class="o">[</span><span class="n">E</span><span class="o">]</span> <span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">fin</span> <span class="o">(</span><span class="n">o</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">fin</span> <span class="n">o</span>
</code></pre></div>

<p>though -- there's something that shows those are equivalent I assume?</p>



<a name="212226492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226492">(Oct 04 2020 at 14:55)</a>:</h4>
<p>OK <code>fin.cast</code> maybe...</p>



<a name="212226562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226562">(Oct 04 2020 at 14:57)</a>:</h4>
<p>I don't understand what <code>o</code> is but you should use the <code>n</code> you get out in the <code>n+1</code> case, never <code>o-1</code>.</p>



<a name="212226618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226618">(Oct 04 2020 at 14:58)</a>:</h4>
<p><code>o</code> is <code>variables (o : ℕ)</code> and I want the largest element of <code>fin o</code> (as an element of <code>fin o</code>)</p>



<a name="212226700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226700">(Oct 04 2020 at 15:00)</a>:</h4>
<p>In your <code>_</code> case, you throw away the information you need to do this</p>



<a name="212226706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212226706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212226706">(Oct 04 2020 at 15:00)</a>:</h4>
<p>So use <code>(o' + 1)</code> or something instead</p>



<a name="212227156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212227156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212227156">(Oct 04 2020 at 15:13)</a>:</h4>
<p>Sorry, I thought I understood what you were saying, but still getting errors from things not having the right type.</p>
<p>I changed it to:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">end_board</span> <span class="o">:</span> <span class="n">board</span> <span class="n">m</span> <span class="n">n</span> <span class="n">ι</span> <span class="n">K</span> <span class="o">:=</span>
<span class="k">match</span> <span class="n">o</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">s.start_board</span>
<span class="bp">|</span> <span class="n">o'</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">s.boards</span> <span class="n">o'</span>
<span class="kd">end</span>
</code></pre></div>

<p>but I still get</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">lean</span><span class="o">]</span> <span class="o">[</span><span class="n">E</span><span class="o">]</span> <span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">s.boards</span> <span class="n">o'</span>
<span class="n">term</span>
  <span class="n">o'</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">ℕ</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">fin</span> <span class="n">o</span>
</code></pre></div>

<p>and neither adding <code>: fin o</code> to the left or right side of <code>o'</code> seems to satisfy the type checker</p>



<a name="212227570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212227570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212227570">(Oct 04 2020 at 15:25)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.matrix.notation</span>

<span class="kd">variable</span> <span class="o">{</span><span class="n">o</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>

<span class="kd">structure</span> <span class="n">foo</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">default</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>
<span class="o">(</span><span class="n">elements</span><span class="o">:</span> <span class="o">(</span><span class="n">fin</span> <span class="n">o</span><span class="o">)</span> <span class="bp">→</span> <span class="n">string</span><span class="o">)</span>

<span class="k">#check</span> <span class="o">{</span><span class="n">foo</span> <span class="bp">.</span> <span class="n">default</span> <span class="o">:=</span> <span class="mi">12</span><span class="o">,</span> <span class="n">elements</span> <span class="o">:=</span> <span class="bp">!</span><span class="o">[</span><span class="s2">"bla"</span><span class="o">,</span> <span class="s2">"bla"</span><span class="o">]}</span>

<span class="kn">namespace</span> <span class="n">foo</span>
<span class="kd">variable</span> <span class="o">(</span><span class="n">f</span><span class="o">:</span> <span class="n">foo</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">last</span> <span class="o">:=</span>
<span class="k">match</span> <span class="n">o</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">f.default</span>
<span class="bp">|</span> <span class="n">o'</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">f.elements</span> <span class="n">o'</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">foo</span>
</code></pre></div>

<p>I think that's a self-contained example of my confuzzledness.</p>



<a name="212227693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212227693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212227693">(Oct 04 2020 at 15:28)</a>:</h4>
<p>(no, sorry, that's giving me a different error about actually declaring <code>f</code>... never mind I guess, will keep trying to figure it out.).</p>



<a name="212227697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212227697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212227697">(Oct 04 2020 at 15:28)</a>:</h4>
<p>You should still use <code>fin.last</code> as well.</p>



<a name="212240010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212240010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212240010">(Oct 04 2020 at 20:25)</a>:</h4>
<p>I'm still not understanding how you're telling me I should use them together, apologies. I updated the self-contained example, which now does produce a similar error for me -- namely:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">lean</span><span class="o">]</span> <span class="o">[</span><span class="n">E</span><span class="o">]</span> <span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">fin</span> <span class="o">(</span><span class="n">o'</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">fin</span> <span class="n">o</span>
</code></pre></div>

<p>Am I now basically supposed to tell Lean <code>fin o' + 1</code> and <code>fin o</code> are equivalent or have I completely misunderstood the suggestions?</p>



<a name="212246899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212246899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212246899">(Oct 04 2020 at 23:35)</a>:</h4>
<p>I guess I figured out how to cheat... I used <code>fin (o + 1)</code> everywhere instead of <code>fin o</code>, and now I don't need <code>fin.last</code>, I can just index with <code>o</code>.</p>



<a name="212247430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212247430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212247430">(Oct 04 2020 at 23:51)</a>:</h4>
<p>You should probably use <code>fin.last</code> anyway. <code>(\u o).val</code> is not defeq to <code>o</code>, but <code>(fin.last o).val = o</code> is</p>



<a name="212247799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212247799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212247799">(Oct 05 2020 at 00:01)</a>:</h4>
<p>I can't figure out how to use <code>fin.last</code> for this -- I get the error above. Is there something clearly wrong I'm doing there?</p>



<a name="212248193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212248193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212248193">(Oct 05 2020 at 00:12)</a>:</h4>
<p>Ah, yes:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">last</span> <span class="o">:=</span>
<span class="k">match</span> <span class="n">o</span><span class="o">,</span> <span class="n">f</span> <span class="k">with</span>
<span class="bp">|</span> <span class="mi">0</span><span class="o">,</span> <span class="n">f</span> <span class="o">:=</span> <span class="n">f.default</span>
<span class="bp">|</span> <span class="n">o'</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span> <span class="n">f</span> <span class="o">:=</span> <span class="n">f.elements</span> <span class="o">(</span><span class="n">fin.last</span> <span class="n">o'</span><span class="o">)</span>
<span class="kd">end</span>
</code></pre></div>

<p><code>f</code> depends on <code>o</code>, so you have to match on them together</p>



<a name="212248355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212248355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212248355">(Oct 05 2020 at 00:17)</a>:</h4>
<p><em>aha</em> Thanks! My lack of functional programming knowledge bites me again I'm sure :/ -- very much appreciated.</p>



<a name="212248549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212248549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212248549">(Oct 05 2020 at 00:22)</a>:</h4>
<p>heh, haskell wouldn't save you here, you really need dependent functional programming experience and that's hard to come by unless you're into agda or idris (or lean)</p>



<a name="212248663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/interpreting%20a%20traceback/near/212248663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/interpreting.20a.20traceback.html#212248663">(Oct 05 2020 at 00:27)</a>:</h4>
<p>Ah, hm -- well, either way when Lean errors at me I'm having a heck of a time deciphering what it means to tell me, so hopefully I can get some sort of intuition soon. This is like the 4th or 5th thing already that even when I see the solution I wouldn't have guessed was anything to do with the error message if you gave me all week.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>