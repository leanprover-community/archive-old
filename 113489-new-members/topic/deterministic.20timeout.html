---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/deterministic.20timeout.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html">deterministic timeout</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="201069297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201069297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201069297">(Jun 16 2020 at 20:24)</a>:</h4>
<p>I sometimes but not always get errors like<br>
inf.lean:153:0: error<br>
(deterministic) timeout</p>
<p>The line is always the start of a new lemma.   #check commands<br>
show that the previous lemmas were indeed proved and the <br>
next lemma was indeed proved.   Should I worry about this error?<br>
What causes it?</p>



<a name="201070523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201070523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201070523">(Jun 16 2020 at 20:34)</a>:</h4>
<p>Something tried to run for too long and Lean gave up on that particular lemma.</p>



<a name="201070714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201070714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201070714">(Jun 16 2020 at 20:36)</a>:</h4>
<p>Well, but it didn't give up because all the lemmas are actually proved.</p>



<a name="201070766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201070766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201070766">(Jun 16 2020 at 20:37)</a>:</h4>
<p>You said the previous and next lemmas were proved, not the current lemma.</p>



<a name="201070876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201070876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201070876">(Jun 16 2020 at 20:38)</a>:</h4>
<p>But also <code>#check</code> won't complain if the lemma wasn't actually proved. Basically it's as though you wrote <code>lemma ... := sorry</code>, I think.</p>



<a name="201070880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201070880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201070880">(Jun 16 2020 at 20:38)</a>:</h4>
<p>All the lemmas in the whole file are correctly proved.   The error mentions a line number that is the <br>
first line of one lemma.  By previous and next I meant,  the one preceding that line, and the one starting  on that line.</p>



<a name="201070915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201070915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201070915">(Jun 16 2020 at 20:38)</a>:</h4>
<p>Oh!  That is very important thing to know!</p>



<a name="201070953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201070953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201070953">(Jun 16 2020 at 20:39)</a>:</h4>
<p>If you see any error, like this one, it means your file was not accepted.</p>



<a name="201070975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201070975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201070975">(Jun 16 2020 at 20:39)</a>:</h4>
<p>You can also use <code>#print axioms lemma_name</code> to test this.</p>



<a name="201073486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/201073486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#201073486">(Jun 16 2020 at 21:01)</a>:</h4>
<p>As a technical note, Lean checks proofs of lemmas in parallel, with the lemma statement added to the environment immediately on the main task--so when Lean gets to <code>#check</code>, it doesn't necessarily even know yet whether or not the lemma contained an error. But mainly, it would be quite annoying if an error in one lemma prevented any future use of that lemma (imagine you update mathlib and it changes the name of something you use in one place--you want to get one error and not have that cause zillions of downstream errors).</p>



<a name="216049920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216049920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216049920">(Nov 09 2020 at 07:21)</a>:</h4>
<p>In the tactic state shown below,  if I do  exact h201.right  I get (after a wait)  "deterministic time out".   The file does compile OK.<br>
Also the whole project has slowed to a crawl even after compiling and restarting VScode.   (On my laptop--I think it's still running OK on my desktop).  </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">h201</span><span class="o">:</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">FINITE</span> <span class="n">M</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">M</span><span class="o">),</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">FINITE</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">similar</span> <span class="n">M</span> <span class="o">(</span><span class="n">USC</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">b</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">M</span><span class="o">),</span> <span class="n">similar</span> <span class="n">M</span> <span class="n">a</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">similar</span> <span class="n">M</span> <span class="n">b</span> <span class="o">(</span><span class="n">USC</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">z</span> <span class="bp">⊆</span> <span class="n">union</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">b</span><span class="o">))</span>
<span class="bp">⊢</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">M</span><span class="o">),</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">FINITE</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">similar</span> <span class="n">M</span> <span class="o">(</span><span class="n">USC</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">b</span><span class="o">)</span> <span class="bp">→</span> <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">M</span><span class="o">),</span> <span class="n">similar</span> <span class="n">M</span> <span class="n">a</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">similar</span> <span class="n">M</span> <span class="n">b</span> <span class="o">(</span><span class="n">USC</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">z</span> <span class="bp">⊆</span> <span class="n">union</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">b</span><span class="o">))</span>
</code></pre></div>
<p>And it also times out after </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>   <span class="n">cases</span> <span class="n">h201</span> <span class="k">with</span> <span class="n">h202</span> <span class="n">h203</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">h203</span><span class="o">,</span>
</code></pre></div>
<p>although just before the exact,  you see that h203 is exactly the goal.</p>



<a name="216050833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216050833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216050833">(Nov 09 2020 at 07:39)</a>:</h4>
<p>Can you try and extract a #MWE ? The following doesn't time out, so there must be something going on in code that you haven't shared:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">has_subset</span> <span class="n">M</span><span class="o">]</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">FINITE</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">→</span> <span class="n">set</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">similar</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">→</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">M</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
  <span class="o">(</span><span class="n">USC</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">SSC</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span> <span class="o">(</span><span class="n">union</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h201</span><span class="o">:</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">FINITE</span> <span class="n">M</span> <span class="bp">∧</span>
    <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">M</span><span class="o">),</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">FINITE</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">similar</span> <span class="n">M</span> <span class="o">(</span><span class="n">USC</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">b</span><span class="o">)</span> <span class="bp">→</span>
    <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">M</span><span class="o">),</span> <span class="n">similar</span> <span class="n">M</span> <span class="n">a</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">similar</span> <span class="n">M</span> <span class="n">b</span> <span class="o">(</span><span class="n">USC</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">z</span> <span class="bp">⊆</span> <span class="n">union</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">b</span><span class="o">)))</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">M</span><span class="o">),</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">FINITE</span> <span class="n">M</span> <span class="bp">→</span> <span class="n">similar</span> <span class="n">M</span> <span class="o">(</span><span class="n">USC</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">b</span><span class="o">)</span> <span class="bp">→</span>
    <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="n">M</span><span class="o">),</span> <span class="n">similar</span> <span class="n">M</span> <span class="n">a</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">similar</span> <span class="n">M</span> <span class="n">b</span> <span class="o">(</span><span class="n">USC</span> <span class="n">z</span><span class="o">)</span> <span class="bp">∧</span> <span class="n">z</span> <span class="bp">⊆</span> <span class="n">union</span> <span class="o">(</span><span class="n">SSC</span> <span class="n">b</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">exact</span> <span class="n">h201.right</span>
</code></pre></div>



<a name="216050858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216050858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216050858">(Nov 09 2020 at 07:40)</a>:</h4>
<p>What happens if you try <code>convert h203</code> instead of <code>exact h203</code>?</p>



<a name="216052365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052365">(Nov 09 2020 at 08:05)</a>:</h4>
<p>convert also produces a timeout.    I thought perhaps this proof is "too long"  so I extracted two long parts as separate lemmas.<br>
One of those lemmas now times out.  (In a different place than the original proof).   The project does build,  but it takes a long time compiling<br>
that proof.    Can I just ignore that timeout in interactive mode and rely on the compiled file?   But even if I can I don't like it.  <br>
Perhaps I made too many calls to "ifinish"  in that proof?    This does happen both on laptop and desktop by the way.</p>
<p>I can't think how to make a MWE  as this project has ten files each with a couple thousand lines of proofs,  and this one <br>
is in the ninth file and God knows what all it depends on.</p>



<a name="216052524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052524">(Nov 09 2020 at 08:07)</a>:</h4>
<p>it sounds like you might benefit from some code review</p>



<a name="216052641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052641">(Nov 09 2020 at 08:08)</a>:</h4>
<p>If anyone would like to look at my code they certainly may,  in principle.   But I'm happy with it,  or at least, I was until an hour ago.   Since the code does build,  and since the proof is accepted up until the very last step,  I don't think the problem is in my code.</p>



<a name="216052695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052695">(Nov 09 2020 at 08:09)</a>:</h4>
<p>it's quite possible that you are doing something that is not so efficient, and the number of times you use it is catching up to you</p>



<a name="216052798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052798">(Nov 09 2020 at 08:10)</a>:</h4>
<p>Yes,  it's not only possible,  it must be so.   And,  the only likely candidate is "ifinish".</p>



<a name="216052810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052810">(Nov 09 2020 at 08:10)</a>:</h4>
<p>in particular, long proofs are bad style in addition to not being handled well by lean. The mere fact that you have a hypothesis <code>h201</code> means that your proof is 10 times longer than it should be</p>



<a name="216052848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052848">(Nov 09 2020 at 08:11)</a>:</h4>
<p>That doesn't mean there are 200 hypothesis.  They're not numbered consecutively.</p>



<a name="216052861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052861">(Nov 09 2020 at 08:11)</a>:</h4>
<p>oh that's good</p>



<a name="216052889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052889">(Nov 09 2020 at 08:12)</a>:</h4>
<p>Why are long proofs "bad style"?</p>



<a name="216052952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052952">(Nov 09 2020 at 08:12)</a>:</h4>
<p>because they are difficult to follow, cause long interactive delays, and make lean consume a lot of memory</p>



<a name="216052977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052977">(Nov 09 2020 at 08:13)</a>:</h4>
<p>plus, the longer a proof is the more likely there will be some factorable subparts of independent interest</p>



<a name="216052978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216052978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216052978">(Nov 09 2020 at 08:13)</a>:</h4>
<p>Well,  you said,  "in addition to not being handled well by Lean",  but your last two reasons are "not handled well by lean".</p>



<a name="216053001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053001">(Nov 09 2020 at 08:13)</a>:</h4>
<p>well mathlib style is in part driven by the current reality of lean</p>



<a name="216053051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053051">(Nov 09 2020 at 08:14)</a>:</h4>
<p>it's not just indentation</p>



<a name="216053114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053114">(Nov 09 2020 at 08:15)</a>:</h4>
<p>I'm not quite sure what "difficult to follow" means.    In my proofs,  I start with a written proof with numbered or labeled lines.   Then in Lean I construct a proof  with a line  "have formula76"   for example  and after that a tactic block proving that line.   If you fold up those tactic blocks you <br>
see in Lean a proof that exactly corresponds to the written proof.    That's my idea of "good style".  But I'm willing to learn from people with more experience at this.</p>



<a name="216053139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053139">(Nov 09 2020 at 08:15)</a>:</h4>
<p>Just to be clear -- if there is a time-out in your code then lean is not verifying it -- verification is failing. You can't ignore it.</p>



<a name="216053213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053213">(Nov 09 2020 at 08:16)</a>:</h4>
<p>I think numbering things is a bad way to name anything</p>



<a name="216053221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053221">(Nov 09 2020 at 08:16)</a>:</h4>
<p>it should be a last resort only</p>



<a name="216053230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053230">(Nov 09 2020 at 08:16)</a>:</h4>
<p>When I do leanproject build  I do not get a timeout message.   So then it is verifying it, right? or not?</p>



<a name="216053311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053311">(Nov 09 2020 at 08:17)</a>:</h4>
<p>Where are you seeing the timeouts? In an editor? Which one? Why not increase the time before it times out?</p>



<a name="216053328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053328">(Nov 09 2020 at 08:17)</a>:</h4>
<p>Now I am naming my lemmas the same names as they get in the LaTeX source files (not by numbers)  but I am still numbering the formulas that are numbered in latex.</p>



<a name="216053394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053394">(Nov 09 2020 at 08:18)</a>:</h4>
<p>I am using VSCode.   How can I increase the time?</p>



<a name="216053409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053409">(Nov 09 2020 at 08:18)</a>:</h4>
<p><code>set_option timeout 1000000000000</code></p>



<a name="216053425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053425">(Nov 09 2020 at 08:19)</a>:</h4>
<p>I put that command right in my Lean file?</p>



<a name="216053445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053445">(Nov 09 2020 at 08:19)</a>:</h4>
<p>between declarations</p>



<a name="216053450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053450">(Nov 09 2020 at 08:19)</a>:</h4>
<p>There is also a way to change the default timeout time in the VS Code settings</p>



<a name="216053479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053479">(Nov 09 2020 at 08:19)</a>:</h4>
<p>I can't remember details but just go to settings and search for lean</p>



<a name="216053596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053596">(Nov 09 2020 at 08:20)</a>:</h4>
<p>I put it in the file.  Had to knock a couple of zeroes off before it would "fit in a machine integer".  Still got a timeout message.</p>



<a name="216053628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053628">(Nov 09 2020 at 08:21)</a>:</h4>
<p>Now I'll look for it in the settings.</p>



<a name="216053718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053718">(Nov 09 2020 at 08:22)</a>:</h4>
<p>If it's a legitimate timeout,  it must be just barely timing out,  because it gets to the last line and the last line should be trivial.  <br>
But I think there is something fishy about that.</p>



<a name="216053739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053739">(Nov 09 2020 at 08:22)</a>:</h4>
<p>is it actually the last line?</p>



<a name="216053768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053768">(Nov 09 2020 at 08:22)</a>:</h4>
<p>because if so it could be the result of kernel typechecking</p>



<a name="216053781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053781">(Nov 09 2020 at 08:22)</a>:</h4>
<p>in particular if <code>ifinish</code> or some other tactic is producing a bad proof</p>



<a name="216053793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053793">(Nov 09 2020 at 08:23)</a>:</h4>
<p>The last line of the proof.   Not the last line of the file.  <br>
And when I extracted two parts of the proof as lemmas,  the timeout is at the last line of one of the lemmas.</p>



<a name="216053840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053840">(Nov 09 2020 at 08:23)</a>:</h4>
<p>you won't notice that anything is wrong until all the metavariables are closed and the finished proof is pushed to the kernel for verification</p>



<a name="216053875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053875">(Nov 09 2020 at 08:23)</a>:</h4>
<p>Ah,  so it could be that ifinish is not just taking too long,  but is producing a bogus proof!</p>



<a name="216053972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216053972" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216053972">(Nov 09 2020 at 08:24)</a>:</h4>
<p>Here is a hypothesis. You are getting a timeout because you have inadvertently written some code that stinks, and if you're not going to post a minimal working example which exhibits the problem then nothing anyone says here is going to help you.</p>



<a name="216054149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054149">(Nov 09 2020 at 08:26)</a>:</h4>
<p>There are all sorts of tricks you can use to minimise your example, for example using axioms or constants instead of including previous proofs or definitions</p>



<a name="216054190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054190">(Nov 09 2020 at 08:27)</a>:</h4>
<p>OK,   thanks for trying to help me.</p>



<a name="216054239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054239">(Nov 09 2020 at 08:27)</a>:</h4>
<p>One tiny typo can throw lean into a loop</p>



<a name="216054468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054468">(Nov 09 2020 at 08:30)</a>:</h4>
<p>Yes,  but Lean isn't in a loop.   If I don't type the last "exact" command,  it processes the proof up to that point just fine.   Then,  <br>
you can see that the goal and the last hypothesis are identical.   So I don't see how I've written stinky code.   But it does seem possible,<br>
as Mario suggested, that my code "stinks"  because 'ifinish' has produced a bogus proof.    So,  I think I'll try to eliminate the uses of <br>
ifinish and see if I still have my problem.  And if I do,  then I'll try replacing all the referenced lemmas by axioms so I can create a MWE. <br>
But I think that will take hours.</p>



<a name="216054510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054510">(Nov 09 2020 at 08:30)</a>:</h4>
<p>"stinky code" doesn't mean logically incorrect</p>



<a name="216054592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054592">(Nov 09 2020 at 08:31)</a>:</h4>
<p>It could just mean one definition which doesn't quite do what you think it does</p>



<a name="216054667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054667">(Nov 09 2020 at 08:32)</a>:</h4>
<p>Well,  I thought Kevin meant code that caused a timeout.    But since I don't get a timeout right up until the last step...</p>



<a name="216054733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054733">(Nov 09 2020 at 08:33)</a>:</h4>
<p>by the way, one way to minimize the proof is to replace subparts with <code>sorry</code></p>



<a name="216054768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054768">(Nov 09 2020 at 08:33)</a>:</h4>
<p>this will keep the proof compiling, and in particular going to the kernel, so you might be able to suss out a bad proof that way</p>



<a name="216054812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054812">(Nov 09 2020 at 08:34)</a>:</h4>
<p>Well,   I may be slow here,  but it seems to me that whatever I might have written,  if I arrive at a point where the goal and one of my hypotheses are identical ( and there are no duplicate names of hypotheses)   then it shouldn't matter what came before that.</p>



<a name="216054869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054869">(Nov 09 2020 at 08:34)</a>:</h4>
<p>Thanks Mario,  I will try that as well as putting in axioms for lemmas.</p>



<a name="216054898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054898">(Nov 09 2020 at 08:35)</a>:</h4>
<p>There are a number of reasons why that can cause a timeout, but it's hard to say for sure which reason is applicable unless you share some code with the bug</p>



<a name="216054945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216054945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216054945">(Nov 09 2020 at 08:35)</a>:</h4>
<p>OK  you guys have given me enough hints to follow up.   Thank you very much.   I'll let you know tomorrow what happened.  It's bedtime now.</p>



<a name="216055533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216055533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216055533">(Nov 09 2020 at 08:42)</a>:</h4>
<p>If your goal is <code>X = X</code> and you can't close it, try <code>set_option pp.all true</code> before your theorem. You might find that (a) they're not the same after all or (b) you have inadvertently made some gigantic terms</p>



<a name="216057755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216057755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216057755">(Nov 09 2020 at 09:04)</a>:</h4>
<p>OK,  so I went through and replaced all calls to ifinish  with direct proofs.   After that the timeout message is gone and everything is working fine.   So,  I guess Mario's theory that ifinish produced a bogus proof is the correct explanation.     My code "stank" because ifinish stank.</p>



<a name="216057823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216057823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216057823">(Nov 09 2020 at 09:05)</a>:</h4>
<p>I'm pretty sure you're the only user of this tactic, so not surprised at all that bug live there.</p>



<a name="216057958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216057958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216057958">(Nov 09 2020 at 09:06)</a>:</h4>
<p>OK.    But I humbly suggest that  instead of "deterministic timeout" ,  a message like,  "kernel failed to check proof"  would have been helpful.   Anyway,  thanks to Mario and Kevin  all is well.</p>



<a name="216058048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216058048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216058048">(Nov 09 2020 at 09:07)</a>:</h4>
<p><span class="user-mention" data-user-id="284844">@Michael Beeson</span> but the kernel thought that if you gave it 5 more years, maybe it would have been able to check the proof after all...</p>



<a name="216058109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216058109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216058109">(Nov 09 2020 at 09:08)</a>:</h4>
<p>Haha,  that's wonderful!</p>



<a name="216058856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216058856" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216058856">(Nov 09 2020 at 09:17)</a>:</h4>
<p>Lean will tell you that the proof is wrong, if it is convinced that it's wrong. You hit an unlucky spot where Lean couldn't decide in a reasonable amount of time whether the proof was good or bad. Hence a timeout.</p>



<a name="216123458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216123458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216123458">(Nov 09 2020 at 18:16)</a>:</h4>
<p>i agree that "deterministic timeout" is an inaccurate name, mostly because it is not deterministic. it would be better to simply call it a "timeout"</p>



<a name="216123837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216123837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216123837">(Nov 09 2020 at 18:19)</a>:</h4>
<p>I thought it was deterministic</p>



<a name="216124376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216124376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216124376">(Nov 09 2020 at 18:23)</a>:</h4>
<p>if you forget to run <code>get-cache</code> you can get timeouts on things that normally would be fine, for example. it is not a deterministic function of your code</p>



<a name="216124415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216124415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216124415">(Nov 09 2020 at 18:23)</a>:</h4>
<p>it is a deterministic function of the inputs to lean</p>



<a name="216124524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216124524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216124524">(Nov 09 2020 at 18:24)</a>:</h4>
<p>I think if you do a zero-edit on a failing proof in vscode it will not make it pass</p>



<a name="216124636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216124636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216124636">(Nov 09 2020 at 18:25)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> made a list of possible sources of nondeterminism before. I guess the unique names will be different, which could lead to a difference in some edge cases</p>



<a name="216124712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216124712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216124712">(Nov 09 2020 at 18:26)</a>:</h4>
<p>caching is the big one right? at least from what I can tell</p>



<a name="216124753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216124753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216124753">(Nov 09 2020 at 18:26)</a>:</h4>
<p>yes but that's easy to control and is a function of data on your HDD</p>



<a name="216124918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216124918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216124918">(Nov 09 2020 at 18:28)</a>:</h4>
<p>it's not a deterministic function of <em>your code</em>, but then again even the result of your code can depend on things like IO and unique names</p>



<a name="216131298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216131298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216131298">(Nov 09 2020 at 19:20)</a>:</h4>
<p>I am trying to prove the Noetherianess of a Dedekind domain (using the fractional ideals are invertible definition).</p>
<p><a href="https://github.com/leanprover-community/mathlib/blob/de0bf7e02d1c4912e08982eeba8cb717a873da65/src/ring_theory/dedekind_domain.lean#L338">https://github.com/leanprover-community/mathlib/blob/de0bf7e02d1c4912e08982eeba8cb717a873da65/src/ring_theory/dedekind_domain.lean#L338</a></p>
<p>Whenever I try to put a sorry at the end of this proof, or anything that would solve the goal, I end up getting a deterministic timeout.</p>
<p>Any help is appreciated, thank you!</p>



<a name="216131408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216131408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216131408">(Nov 09 2020 at 19:21)</a>:</h4>
<p>Can you split it into lemmas of &lt;20 lines each?</p>



<a name="216131435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216131435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216131435">(Nov 09 2020 at 19:21)</a>:</h4>
<p>That might make it more manageable</p>



<a name="216131564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216131564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216131564">(Nov 09 2020 at 19:22)</a>:</h4>
<p>Ok, I will try, thank you.</p>



<a name="216131891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216131891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216131891">(Nov 09 2020 at 19:25)</a>:</h4>
<p><span class="user-mention" data-user-id="250372">@Ashvni Narayanan</span> Do you know about <code>extract_goal</code>?</p>



<a name="216131920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216131920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216131920">(Nov 09 2020 at 19:25)</a>:</h4>
<p>It's a very useful tactic for things like this</p>



<a name="216132208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216132208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216132208">(Nov 09 2020 at 19:27)</a>:</h4>
<p>Yes, I see. I will try to use it, thank you.</p>



<a name="216132298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216132298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216132298">(Nov 09 2020 at 19:28)</a>:</h4>
<p>By the way, does it help to <code>clear</code> statements?</p>



<a name="216132459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216132459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216132459">(Nov 09 2020 at 19:28)</a>:</h4>
<p>Probably not</p>



<a name="216133694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216133694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216133694">(Nov 09 2020 at 19:39)</a>:</h4>
<p>i would try replacing some of those <code>simp</code> statements in the middle of the proofs with <code>simp only</code>, it's easy to do and sometimes simp is slow</p>



<a name="216133992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216133992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216133992">(Nov 09 2020 at 19:41)</a>:</h4>
<p>i'm not sure how vscode displays it, but in emacs you can kind of see there are orange bars on the left while lean is compiling, and you can often figure out which parts of the proof are slow by watching those, and then you can optimize those parts</p>



<a name="216134097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216134097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216134097">(Nov 09 2020 at 19:42)</a>:</h4>
<p>vscode has them too</p>



<a name="216134788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216134788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216134788">(Nov 09 2020 at 19:48)</a>:</h4>
<p>Yeah, I guess it might be the 4 line long <code>suffices</code> statement that might be causing the issue.</p>



<a name="216134976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216134976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216134976">(Nov 09 2020 at 19:49)</a>:</h4>
<p>"lemmas of 20 lines" might be more extreme than is absolutely necessary, i would be lazier about it and just break this up into 2 separate lemmas and see if that fixed it. and then if it still continued to not work, hopefully just 1 of the 2 is too slow, and then you can recurse</p>



<a name="216135095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216135095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216135095">(Nov 09 2020 at 19:50)</a>:</h4>
<p>I will try, thank you!</p>



<a name="216144297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216144297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216144297">(Nov 09 2020 at 21:20)</a>:</h4>
<p>Ok so I broke it up into two lemmas, it works perfectly fine till a certain goal, and then suddenly gives a deterministic timeout error only if I input a <code>sorry</code> or the statement that closes the goal. If I input something inaccurate, I see an error immediately. The lemma is about 25 lines long.</p>



<a name="216147607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216147607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216147607">(Nov 09 2020 at 21:52)</a>:</h4>
<p>can you paste just the lemma that's failing</p>



<a name="216147647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216147647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216147647">(Nov 09 2020 at 21:52)</a>:</h4>
<p>my guess is that some statement isn't compiling without the "sorry" because it needs some backward type inference or something weird like that before it'll start compiling</p>



<a name="216147865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216147865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216147865">(Nov 09 2020 at 21:54)</a>:</h4>
<p>what i would do here is, delete lines from the end of the slow proof and replace them with <code>sorry</code>, until i get something that works with sorry. then, probably the last bit you removed is the slow bit. when you say "it works perfectly fine until I write sorry", it isn't really working perfectly fine then, right? it's just not compiling at all because the code is ungrammatical.</p>



<a name="216147957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216147957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216147957">(Nov 09 2020 at 21:55)</a>:</h4>
<p>basically it would help to post both the "minimum not-working example" that doesn't compile, along with the "maximum working example", the point where your code <em>does</em> compile, you've just replaced a bunch of it with a sorry. the problem probably lies in the diff between those two states</p>



<a name="216159159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/deterministic%20timeout/near/216159159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashvni Narayanan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/deterministic.20timeout.html#216159159">(Nov 10 2020 at 00:11)</a>:</h4>
<p>Thank you very much for your help. Turns out the lemma I was trying to use had the incorrect form. As soon as I fixed that, everything worked smoothly!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>