---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html">It's just add and sub?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="266611117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/It%27s%20just%20add%20and%20sub%3F/near/266611117" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anders Larsson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html#266611117">(Jan 02 2022 at 12:04)</a>:</h4>
<p>Hi,<br>
I'm a software guy trying to learn Lean. </p>
<p>I think I have missed something obvious here. I would expect simp or some similar command do be able to <br>
fix the example below or fail and prove that the equality is incorrect. What is a reasonable path forward?<br>
(What tutorial to read?  How to reason with big but seemingly obvious reshuffle of add/sub?).</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.complex.basic</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span>  <span class="n">a.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">-</span> <span class="n">c.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="o">(</span><span class="n">c.im</span> <span class="bp">*</span> <span class="n">b.re</span> <span class="bp">-</span> <span class="n">a.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">)</span> <span class="bp">=</span>
                       <span class="n">a.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="n">c.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">c.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
   <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="266611223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/It%27s%20just%20add%20and%20sub%3F/near/266611223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Johnson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html#266611223">(Jan 02 2022 at 12:07)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/tactic.linarith">docs#tactic.linarith</a></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">a.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">-</span> <span class="n">c.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="o">(</span><span class="n">c.im</span> <span class="bp">*</span> <span class="n">b.re</span> <span class="bp">-</span> <span class="n">a.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">)</span> <span class="bp">=</span>
  <span class="n">a.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="n">c.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">c.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="266611331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/It%27s%20just%20add%20and%20sub%3F/near/266611331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anders Larsson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html#266611331">(Jan 02 2022 at 12:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="456794">Patrick Johnson</span> <a href="#narrow/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F/near/266611223">said</a>:</p>
<p>Awesome! I had only seen linarith in the context of inequalities so far.</p>



<a name="266613056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/It%27s%20just%20add%20and%20sub%3F/near/266613056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html#266613056">(Jan 02 2022 at 12:56)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#ring">tactic#ring</a> and <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#abel">tactic#abel</a> can also both prove this. Fun fact: linarith indeed does "only" do inequalities and proves this goal by showing both the the left hand side is <code>\le</code> the right hand side, and vice-versa.</p>



<a name="266613323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/It%27s%20just%20add%20and%20sub%3F/near/266613323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html#266613323">(Jan 02 2022 at 13:02)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#abel">tactic#abel</a> is probably the right answer to the question of  how to deal with a seemingly obvious reshuffle of add and sub, indeed <code>abel</code> can prove this when we set up a similar goal over an arbitrary ring, not just the reals/complexes:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">C</span><span class="o">]</span> <span class="o">(</span><span class="n">a_re</span> <span class="n">b_re</span> <span class="n">c_re</span> <span class="n">a_im</span> <span class="n">b_im</span> <span class="n">c_im</span> <span class="o">:</span> <span class="n">C</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">a_re</span> <span class="bp">*</span> <span class="n">b_im</span> <span class="bp">-</span> <span class="n">c_re</span> <span class="bp">*</span> <span class="n">b_im</span> <span class="bp">+</span> <span class="o">(</span><span class="n">c_im</span> <span class="bp">*</span> <span class="n">b_re</span> <span class="bp">-</span> <span class="n">a_im</span> <span class="bp">*</span> <span class="n">b_re</span><span class="o">)</span> <span class="bp">=</span>
  <span class="n">a_re</span> <span class="bp">*</span> <span class="n">b_im</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">a_im</span> <span class="bp">*</span> <span class="n">b_re</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="n">c_re</span> <span class="bp">*</span> <span class="n">b_im</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">c_im</span> <span class="bp">*</span> <span class="n">b_re</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">abel</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>The other two mentioned tactics don't manage this one, as <code>linarith</code> wants an ordering on the ring, and <code>ring</code> likes rings to be commutative.</p>



<a name="266613558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/It%27s%20just%20add%20and%20sub%3F/near/266613558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html#266613558">(Jan 02 2022 at 13:08)</a>:</h4>
<p>I don't know what you're interested in but maybe this <a href="https://github.com/ImperialCollegeLondon/complex-number-game">https://github.com/ImperialCollegeLondon/complex-number-game</a> might show you some techniques?</p>



<a name="266617626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/It%27s%20just%20add%20and%20sub%3F/near/266617626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anders Larsson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html#266617626">(Jan 02 2022 at 14:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F/near/266613558">said</a>:</p>
<blockquote>
<p>I don't know what you're interested in but maybe this <a href="https://github.com/ImperialCollegeLondon/complex-number-game">https://github.com/ImperialCollegeLondon/complex-number-game</a> might show you some techniques?</p>
</blockquote>
<p>Sure, i found it some days ago. I'm working on level 03 now.</p>



<a name="266618226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/It%27s%20just%20add%20and%20sub%3F/near/266618226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/It's.20just.20add.20and.20sub.3F.html#266618226">(Jan 02 2022 at 15:13)</a>:</h4>
<p><span class="user-mention" data-user-id="430763">@Anders Larsson</span> <code>simp</code> can do this if you give it enough lemmas:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:</span>  <span class="n">a.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">-</span> <span class="n">c.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="o">(</span><span class="n">c.im</span> <span class="bp">*</span> <span class="n">b.re</span> <span class="bp">-</span> <span class="n">a.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">)</span> <span class="bp">=</span>
                       <span class="n">a.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">)</span> <span class="bp">-</span> <span class="o">(</span><span class="n">c.re</span> <span class="bp">*</span> <span class="n">b.im</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">c.im</span> <span class="bp">*</span> <span class="n">b.re</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">,</span> <span class="n">sub_eq_add_neg</span><span class="o">,</span> <span class="n">add_assoc</span><span class="o">,</span> <span class="n">add_comm</span><span class="o">,</span> <span class="n">add_left_comm</span><span class="o">]</span>
</code></pre></div>
<p>Even though <code>repeat { rw mul_comm }</code> would run forever, <code>simp</code> is smarter and chooses some sort of normal form.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>