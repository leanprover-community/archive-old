---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Can't.20get.20olean.20cache.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html">Can't get olean cache</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="252063653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252063653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252063653">(Sep 05 2021 at 09:25)</a>:</h4>
<p>I seem to be having some trouble creating a new project using the current version of mathlib. I used <code>leanproject new xxx</code>, which gave me a new directory <code>xxx</code> with all the source .lean files in <code>_target/deps/mathlib/</code>, but the <code>src/</code> directory, where .olean files are supposed to be, is entirely empty. When I ran <code>leanproject get-cache</code> or <code>get-mathlib-cache</code>, the <code>src/</code> directory doesn't get populated. In fact, it downloads <code>fd48ac55697cadbf777009e95b963aa142310a84.tar.xz</code> into <code>~/.mathlib/</code>. When I unpack it, it actually has all the .olean files of an older version of mathlib (it doesn't have <code>algebra/monoid_algebra/basic.olean</code>).</p>
<p>What's going on, and how can I continue?</p>



<a name="252063833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252063833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252063833">(Sep 05 2021 at 09:28)</a>:</h4>
<p>(deleted)</p>



<a name="252063939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252063939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252063939">(Sep 05 2021 at 09:31)</a>:</h4>
<p>I could just run <code>leanproject build</code> under <code>_target/deps/mathlib/</code> but I'm trying to avoid needlessly torturing my computer</p>



<a name="252064063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252064063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252064063">(Sep 05 2021 at 09:33)</a>:</h4>
<p>if you want to work on mathlib itself, you shouldn't make a new project, but instead clone mathlib using <code>leanproject get mathlib</code></p>



<a name="252064121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252064121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252064121">(Sep 05 2021 at 09:34)</a>:</h4>
<p>if you're working on a new project this is as intended, mathlib is only in the deps (and it should unpack the oleans there after getting them) and then you can just import + use in your project</p>



<a name="252065099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252065099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252065099">(Sep 05 2021 at 09:55)</a>:</h4>
<p>I just did <code>leanproject get mathlib</code>, which gave me all the <code>.lean</code> and <code>.olean</code> files under <code>src/</code>. Will Lean know to prioritise the use of <code>.olean</code> files when parsing new files under <code>src/</code>? I created a <code>test.lean</code>, but even the import line is taking forever to parse.</p>



<a name="252065199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252065199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252065199">(Sep 05 2021 at 09:57)</a>:</h4>
<p>And it eventually fails with <code>excessive memory consumption</code></p>



<a name="252065813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252065813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252065813">(Sep 05 2021 at 10:08)</a>:</h4>
<p>oh, did you restart the lean server after getting the cache?</p>



<a name="252065820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252065820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252065820">(Sep 05 2021 at 10:08)</a>:</h4>
<p>No. How do I do that</p>



<a name="252065854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252065854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252065854">(Sep 05 2021 at 10:09)</a>:</h4>
<p>Exit VS code and restart it</p>



<a name="252065898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252065898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252065898">(Sep 05 2021 at 10:10)</a>:</h4>
<p>Hmm I've done that multiple times</p>



<a name="252066014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252066014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252066014">(Sep 05 2021 at 10:12)</a>:</h4>
<p>All I wanted to do is to update my version of mathlib but the process I went through the first time doesn't seem to yield the same results this time</p>



<a name="252066032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252066032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252066032">(Sep 05 2021 at 10:12)</a>:</h4>
<p>Namely, using <code>leanproject new</code> to get mathlib, etc</p>



<a name="252066065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252066065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252066065">(Sep 05 2021 at 10:13)</a>:</h4>
<p>I've also upgraded Lean from 3.30 to 3.32. Does that somehow change things?</p>



<a name="252066914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252066914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252066914">(Sep 05 2021 at 10:29)</a>:</h4>
<p>I'm confused; are you trying to <em>work on</em> mathlib, or <em>use</em> mathlib in a different project?</p>



<a name="252067430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252067430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252067430">(Sep 05 2021 at 10:39)</a>:</h4>
<p>I'm trying to work on mathlib</p>



<a name="252067671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252067671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252067671">(Sep 05 2021 at 10:43)</a>:</h4>
<p>I now have all the lean and olean files all under <code>src/</code>, but the difficulty seems to be <code>excessive memory consumption</code> when I try to <code>import topology.basic</code>, for example</p>



<a name="252067769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252067769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252067769">(Sep 05 2021 at 10:45)</a>:</h4>
<p>so for me, typing this into the terminal works out of the box:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>$ leanproject get mathlib
<span class="o">(</span>git stuff<span class="o">)</span>
<span class="o">(</span>leanproject progressbar<span class="o">)</span>
$ code mathlib
</code></pre></div>
<p>trust the project, and then make a new file with the Lean extension, and <code>import topology.basic</code>. What happens if you try exactly those steps?</p>



<a name="252067786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252067786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252067786">(Sep 05 2021 at 10:45)</a>:</h4>
<p>If you want to get your mathlib project working, change into the root directory of your local clone and type <code>leanproject get-cache</code>. Then restart VS Code.</p>



<a name="252067845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252067845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252067845">(Sep 05 2021 at 10:46)</a>:</h4>
<p>Or, if you've not made any local changes yet, nuke your clone and do what Eric suggests</p>



<a name="252068285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068285">(Sep 05 2021 at 10:54)</a>:</h4>
<p>I did exactly what Eric suggested, which gives this output in the terminal:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Cloning</span> <span class="k">from</span> <span class="n">git</span><span class="bp">@</span><span class="n">github.com</span><span class="o">:</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">mathlib.git</span>
<span class="n">configuring</span> <span class="n">mathlib</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">1</span>
<span class="n">Looking</span> <span class="n">for</span> <span class="kn">local</span> <span class="n">mathlib</span> <span class="n">oleans</span>
<span class="n">Found</span> <span class="kn">local</span> <span class="n">mathlib</span> <span class="n">oleans</span>
</code></pre></div>



<a name="252068341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068341">(Sep 05 2021 at 10:55)</a>:</h4>
<p>Then, I opened VSCode anew, created a new file under <code>src/</code> called <code>test.lean</code>, typed <code>import topology.basic</code>. The result is my laptop fan taking off and an eventual <code>excessive memory consumption</code> after several mins</p>



<a name="252068400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068400">(Sep 05 2021 at 10:56)</a>:</h4>
<p>the <code>code</code> command should've opened vscode itself; did that not work? also, you used "open folder" right?</p>



<a name="252068409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068409">(Sep 05 2021 at 10:56)</a>:</h4>
<p>I'm on mac, so I don't have <code>code</code> in terminal</p>



<a name="252068422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068422">(Sep 05 2021 at 10:56)</a>:</h4>
<p>But I opened VSCode and opened the mathlib folder</p>



<a name="252068436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068436">(Sep 05 2021 at 10:57)</a>:</h4>
<p>(After quitting it entirely)</p>



<a name="252068437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068437">(Sep 05 2021 at 10:57)</a>:</h4>
<p>m1 mac or normal mac? iirc there's some special instructions fir m1s somewhere</p>



<a name="252068444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068444">(Sep 05 2021 at 10:57)</a>:</h4>
<p>Intel mac</p>



<a name="252068545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068545">(Sep 05 2021 at 10:59)</a>:</h4>
<p>My other folder named <code>mathlib_old</code> created a couple months ago is still working fine</p>



<a name="252068708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068708">(Sep 05 2021 at 11:01)</a>:</h4>
<p>hmm, I don't want you to break your only working mathlib but I'm otherwise out of ideas. two things; does <code>elan</code> as a command work? and also, could you maybe try copying that folder somewhere and running <code>leanproject up</code> on the clone, and see if that works?</p>



<a name="252068713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068713">(Sep 05 2021 at 11:01)</a>:</h4>
<p>Yes, elan works</p>



<a name="252068793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068793">(Sep 05 2021 at 11:02)</a>:</h4>
<p>because you said you upgradede lean but that usually happens transparently for us through elan</p>



<a name="252068808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068808">(Sep 05 2021 at 11:03)</a>:</h4>
<p>Couldn't pull from a relevant git remote. You may try to git pull manually and then run <code>leanproject get-cache</code></p>



<a name="252068819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068819">(Sep 05 2021 at 11:03)</a>:</h4>
<p><code>git remote -v</code>?</p>



<a name="252068883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068883">(Sep 05 2021 at 11:04)</a>:</h4>
<p>Nothing comes out of git remote -v</p>



<a name="252068925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252068925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252068925">(Sep 05 2021 at 11:05)</a>:</h4>
<p>My working <code>mathlib_old</code> was created by <code>leanproject new</code></p>



<a name="252069010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252069010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252069010">(Sep 05 2021 at 11:06)</a>:</h4>
<p>And it gives me a <code>src/</code> directory containing only the <code>.olean</code> files, while <code>_target/deps/mathlib/</code> contains only the <code>.lean</code> files</p>



<a name="252069032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252069032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252069032">(Sep 05 2021 at 11:07)</a>:</h4>
<p>This time, however, <code>leanproject new</code> gave me a <code>_target/deps/mathlib/</code> containing <code>.olean</code> AND <code>.lean</code> files, while the <code>src/</code> directory is empty</p>



<a name="252069045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252069045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252069045">(Sep 05 2021 at 11:07)</a>:</h4>
<p>the second is the standard setup, the fact that the first works at all is weird to me</p>



<a name="252069356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252069356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252069356">(Sep 05 2021 at 11:13)</a>:</h4>
<p>Hmm. All I did was use the recommended commands both times.</p>



<a name="252069415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252069415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252069415">(Sep 05 2021 at 11:14)</a>:</h4>
<p>Another difference I found was that the old one's <code>leanpkg.path</code> is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">builtin_path</span>
<span class="n">path</span> <span class="bp">./</span><span class="n">src</span>
</code></pre></div>
<p>while the new one's is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">builtin_path</span>
<span class="n">path</span> <span class="n">_target</span><span class="bp">/</span><span class="n">deps</span><span class="bp">/</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">src</span>
<span class="n">path</span> <span class="bp">./</span><span class="n">src</span>
</code></pre></div>



<a name="252069457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252069457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252069457">(Sep 05 2021 at 11:15)</a>:</h4>
<p>The old one was <code>lean 3.30.0</code> while new one is <code>lean 3.32.1</code>, if that's relevant at all</p>



<a name="252069516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252069516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252069516">(Sep 05 2021 at 11:16)</a>:</h4>
<p>And I used elan to upgrade lean from 3.30 to 3.32</p>



<a name="252069533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252069533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252069533">(Sep 05 2021 at 11:16)</a>:</h4>
<p>I've got to go now, but I'll come back to finish debugging this. Thanks for your help!</p>



<a name="252072805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252072805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252072805">(Sep 05 2021 at 12:18)</a>:</h4>
<p>If you're working on mathlib itself there should be no <code>.target/deps/mathlib</code> folder</p>



<a name="252111101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252111101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252111101">(Sep 06 2021 at 00:04)</a>:</h4>
<p>You're right. My <code>leanproject get mathlib</code> result only has everything within the <code>src/</code> directory, but the problem is, <code>import whatever</code> takes forever and ends in <code>excessive memory consumption</code>. I saw <span class="user-mention" data-user-id="214520">@Christopher Upshaw</span>'s thread above titled "mathlib hanging". Maybe that's relevant?</p>



<a name="252111473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252111473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252111473">(Sep 06 2021 at 00:12)</a>:</h4>
<p>You should never be using <code>elan</code> directly at all. It doesn't really make sense to say "I used elan to upgrade lean" -- the version of lean used is determined by the nearest leanpkg.toml file, one does not have a specific version of lean installed on one's system, one typically has many versions of lean installed, and the system, not the user  chooses which one to use.</p>
<p>Let's start again. Go to a place with no mathlib subdirectory. Type <code>leanproject get mathlib</code>. Now change into the new mathlib subdirectory which just appeared and type <code>lean --make src</code>. Does this command terminate after a few seconds with no output? If so, it's working. If not, your installation is broken in an interesting way (you have managed to corrupt your lean set-up somehow) and it will be quite a bore to debug it via chat.</p>



<a name="252112477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20get%20olean%20cache/near/252112477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Winston Yin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20get.20olean.20cache.html#252112477">(Sep 06 2021 at 00:33)</a>:</h4>
<p>Thanks for explaining. <code>lean --make src</code> seems to be compiling through everything with no end in sight, so I guess my install is broken :(</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>