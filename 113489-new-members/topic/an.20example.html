---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/an.20example.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html">an example</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="241346495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/241346495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#241346495">(Jun 03 2021 at 04:06)</a>:</h4>
<p>I am tring to prove the first direction in the following example</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.set.function</span> <span class="n">tactic</span>
<span class="kn">open</span> <span class="n">set</span> <span class="n">function</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">inhabited</span> <span class="n">α</span><span class="o">]</span>
<span class="kd">noncomputable theory</span>
<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kd">def</span> <span class="n">inverse</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">α</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">y</span> <span class="o">:</span> <span class="n">β</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span> <span class="k">then</span> <span class="n">classical.some</span> <span class="n">h</span> <span class="k">else</span> <span class="n">default</span> <span class="n">α</span>

<span class="kd">theorem</span> <span class="n">inverse_spec</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">f</span> <span class="o">(</span><span class="n">inverse</span> <span class="n">f</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">inverse</span><span class="o">,</span> <span class="n">dsimp</span><span class="o">,</span> <span class="n">rw</span> <span class="n">dif_pos</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">classical.some_spec</span> <span class="n">h</span>
<span class="kd">end</span>

<span class="kd">variable</span>  <span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">injective</span> <span class="n">f</span> <span class="bp">↔</span> <span class="n">left_inverse</span> <span class="o">(</span><span class="n">inverse</span> <span class="n">f</span><span class="o">)</span> <span class="n">f</span>  <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span>
    <span class="n">intros</span> <span class="n">inj_f</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">inverse</span><span class="o">],</span>
  <span class="o">},</span>
  <span class="o">{</span>
    <span class="gr">sorry</span>
  <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>
<p>I currently have the goal <code>classical.some _ = x</code>. How can I give the underscore a name/identifier or do I need to prove this direction in another way without using <code>simp</code> at all?</p>



<a name="241346681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/241346681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#241346681">(Jun 03 2021 at 04:10)</a>:</h4>
<p>don't <code>simp [inverse]</code>, never unfold <code>inverse</code> and instead use <code>inverse_spec</code></p>



<a name="241346740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/241346740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#241346740">(Jun 03 2021 at 04:12)</a>:</h4>
<p>try <code>apply inj_f</code></p>



<a name="241346910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/241346910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#241346910">(Jun 03 2021 at 04:17)</a>:</h4>
<p>Thanks! I have solved it.</p>



<a name="241346977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/241346977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#241346977">(Jun 03 2021 at 04:19)</a>:</h4>
<p>By the way, I am still curious about that once I have the goal <code>classical.some _ = x</code>, is it possible to give the underscore an identifier then or by modifying anything before?</p>



<a name="241347177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/241347177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#241347177">(Jun 03 2021 at 04:25)</a>:</h4>
<p>The underscore is a proof, which is hidden by lean by default, you can turn on printing of these with <code>set_option pp.proofs true</code> to see what it is.</p>



<a name="241357039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/241357039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#241357039">(Jun 03 2021 at 07:35)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#generalize_proofs">tactic#generalize_proofs</a></p>



<a name="242075203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242075203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242075203">(Jun 09 2021 at 14:34)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.matrix.basic</span>
<span class="kn">import</span> <span class="n">algebra.field</span>
<span class="kn">import</span> <span class="n">tactic.suggest</span>

<span class="kd">universes</span> <span class="n">v</span> <span class="n">w</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">}</span>
<span class="kd">variables</span> <span class="n">m</span> <span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span>

<span class="kd">def</span> <span class="n">silly</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">m</span><span class="o">))</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="n">α</span>
<span class="bp">|</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">M</span> <span class="mi">0</span> <span class="mi">0</span>
</code></pre></div>
<p>Why does this definition fail?<br>
error: failed to synthesize type class instance</p>



<a name="242075497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242075497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242075497">(Jun 09 2021 at 14:35)</a>:</h4>
<p><code>⊢ has_zero (fin ↑n)</code></p>



<a name="242075609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242075609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242075609">(Jun 09 2021 at 14:36)</a>:</h4>
<p>This means that the type class system cannot figure out a proof that this type has a zero</p>



<a name="242075763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242075763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242075763">(Jun 09 2021 at 14:36)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">foo</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="o">:=</span> <span class="n">infer_instance</span> <span class="c1">-- works</span>
<span class="kd">instance</span> <span class="n">bar</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="n">infer_instance</span> <span class="c1">-- fails</span>
</code></pre></div>



<a name="242075809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242075809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242075809">(Jun 09 2021 at 14:37)</a>:</h4>
<p>Which is probably because I don't think <code>fin (n : ℕ+)</code> is used by mathlib anywhere</p>



<a name="242075870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242075870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242075870">(Jun 09 2021 at 14:37)</a>:</h4>
<p>We normally use <code>fin n.succ</code> instead</p>



<a name="242075876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242075876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242075876">(Jun 09 2021 at 14:37)</a>:</h4>
<p>You could add this instance manually, or if you want to keep things simple you could have <code>n : nat</code> and use n+1 everywhere</p>



<a name="242076077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242076077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242076077">(Jun 09 2021 at 14:38)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">pnat.fin_has_zero</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">pnat.pos</span> <span class="n">n</span><span class="o">⟩⟩</span>

<span class="kd">def</span> <span class="n">silly</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">m</span><span class="o">))</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="n">α</span>
<span class="bp">|</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">M</span> <span class="mi">0</span> <span class="mi">0</span> <span class="c1">-- works</span>
</code></pre></div>



<a name="242076340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242076340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242076340">(Jun 09 2021 at 14:40)</a>:</h4>
<p>Cool! I am trying to understand the syntax of the first line. If I get any further question, I will post here.</p>



<a name="242076439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242076439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242076439">(Jun 09 2021 at 14:41)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">add</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span>
<span class="bp">|</span> <span class="n">x</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">x</span>
<span class="bp">|</span> <span class="n">x</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">add</span> <span class="n">x</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">1</span>
</code></pre></div>



<a name="242155234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242155234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242155234">(Jun 10 2021 at 03:12)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.matrix.basic</span>
<span class="kn">import</span> <span class="n">algebra.field</span>
<span class="kn">import</span> <span class="n">tactic.suggest</span>

<span class="kd">universes</span> <span class="n">v</span> <span class="n">w</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">w</span><span class="o">}</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">}</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span>

<span class="kd">instance</span> <span class="n">pnat.fin_has_zero</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">)</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">pnat.pos</span> <span class="n">n</span><span class="o">⟩⟩</span>

<span class="kd">def</span> <span class="n">silly</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">m</span><span class="o">))</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">n</span><span class="o">))</span> <span class="n">α</span>
<span class="bp">|</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">M</span> <span class="o">(</span><span class="n">m</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">silly'</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">a.succ</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">b.succ</span><span class="o">)</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">a.succ</span><span class="o">))</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="n">b.succ</span><span class="o">))</span> <span class="n">α</span>
<span class="bp">|</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">M</span> <span class="o">(</span><span class="n">a.succ</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">y</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span>
</code></pre></div>
<p>How can I fix the errors in the first definition besides changing the use of N+ to N?</p>



<a name="242156914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242156914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242156914">(Jun 10 2021 at 03:52)</a>:</h4>
<p><code>fin.elim</code></p>



<a name="242171148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242171148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242171148">(Jun 10 2021 at 07:56)</a>:</h4>
<p>You can also <code>import data.matrix.notation</code> and write <code>![]</code>, if you want something more readable :)</p>



<a name="242177503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242177503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242177503">(Jun 10 2021 at 09:02)</a>:</h4>
<p>Any solution to the mismatch errors? <span aria-label="sweat" class="emoji emoji-1f613" role="img" title="sweat">:sweat:</span></p>



<a name="242178251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242178251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242178251">(Jun 10 2021 at 09:10)</a>:</h4>
<p>Sorry for missing the question! The missing ingredient is a way to write <code>1</code> as an element of <code>fin (n : pnat)</code>.</p>



<a name="242178398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242178398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242178398">(Jun 10 2021 at 09:12)</a>:</h4>
<p>The reason <code>silly'</code> works is that Lean inserts the coercion <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.cast_coe">docs#nat.cast_coe</a>, which maps <code>0 + 1 + 1 + ... + 1 : ℕ</code> to any type with <code>0</code>, <code>1</code> and <code>+</code>.</p>



<a name="242178621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/242178621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#242178621">(Jun 10 2021 at 09:14)</a>:</h4>
<p>Something like this should make <code>silly</code> work as well:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">pnat.fin_has_one</span> <span class="o">:</span> <span class="bp">Π</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span><span class="o">,</span> <span class="n">has_one</span>  <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">absurd</span> <span class="n">h</span> <span class="o">(</span><span class="n">lt_irrefl</span> <span class="mi">0</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">⟨</span><span class="n">nat.succ</span> <span class="n">n'</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩</span> <span class="o">:=</span> <span class="o">(</span><span class="n">infer_instance</span> <span class="o">:</span> <span class="n">has_one</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n'.succ</span><span class="o">))</span>
</code></pre></div>



<a name="244058585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244058585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244058585">(Jun 27 2021 at 09:31)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">silly''</span>
<span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">m</span> <span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">α</span><span class="o">)</span>
<span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="n">m</span> <span class="bp">*</span> <span class="n">p</span><span class="o">))</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="n">n</span> <span class="bp">*</span> <span class="n">q</span><span class="o">))</span> <span class="n">α</span> <span class="o">:=</span>
 <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span>
  <span class="n">A</span> <span class="o">(</span><span class="n">i</span> <span class="bp">/</span> <span class="n">p</span><span class="o">)</span> <span class="o">(</span><span class="n">j</span> <span class="bp">/</span> <span class="n">q</span><span class="o">)</span>
</code></pre></div>
<p>How can I fix the error here?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">has_div.div</span> <span class="n">j</span>
<span class="n">term</span>
  <span class="n">j</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">fin</span> <span class="o">(</span><span class="n">n</span> <span class="bp">*</span> <span class="n">q</span><span class="o">)</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">fin</span> <span class="n">n</span>
</code></pre></div>



<a name="244059304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244059304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244059304">(Jun 27 2021 at 09:51)</a>:</h4>
<p>Instead of <code>/</code> you might want <a href="https://leanprover-community.github.io/mathlib_docs/find/fin_prod_fin_equiv">docs#fin_prod_fin_equiv</a></p>



<a name="244059358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244059358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244059358">(Jun 27 2021 at 09:52)</a>:</h4>
<p><code>(fin_prod_fin_equiv.symm j).fst</code> looks like what you want</p>



<a name="244059668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244059668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244059668">(Jun 27 2021 at 10:03)</a>:</h4>
<p>I don't quite understand however :( Could you show the corrected code?</p>



<a name="244060000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244060000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244060000">(Jun 27 2021 at 10:13)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">silly''</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="n">m</span> <span class="bp">*</span> <span class="n">p</span><span class="o">))</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="n">n</span> <span class="bp">*</span> <span class="n">q</span><span class="o">))</span> <span class="n">α</span> <span class="o">:=</span>
 <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">A</span> <span class="o">((</span><span class="n">fin_prod_fin_equiv.symm</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span><span class="o">)</span> <span class="o">((</span><span class="n">fin_prod_fin_equiv.symm</span> <span class="n">j</span><span class="o">)</span><span class="bp">.</span><span class="n">fst</span><span class="o">)</span>
</code></pre></div>



<a name="244060054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244060054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244060054">(Jun 27 2021 at 10:14)</a>:</h4>
<p>The problem is that you can't divide a <code>fin (m * p)</code> by a <code>nat</code>: all lean knows how to do is promote the <code>fin (m * p)</code> to a <code>nat</code>, then divide that <code>nat</code> by a <code>nat</code>. But that doesn't work here, because lean wants you to provide a <code>fin m</code></p>



<a name="244060125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244060125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244060125">(Jun 27 2021 at 10:17)</a>:</h4>
<p>You can fix this with</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">silly''</span> <span class="o">{</span><span class="n">p</span> <span class="n">q</span> <span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="n">m</span> <span class="bp">*</span> <span class="n">p</span><span class="o">))</span> <span class="o">(</span><span class="n">fin</span> <span class="o">(</span><span class="n">n</span> <span class="bp">*</span> <span class="n">q</span><span class="o">))</span> <span class="n">α</span> <span class="o">:=</span>
 <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">A</span> <span class="o">⟨</span><span class="n">i</span> <span class="bp">/</span> <span class="n">p</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">j</span> <span class="bp">/</span> <span class="n">q</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">⟩</span>
</code></pre></div>
<p>My observation is that rather than filling out the <code>sorry</code> by hand, you can use <code>fin_prod_fin_equiv</code> which already give you the proof</p>



<a name="244063032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244063032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244063032">(Jun 27 2021 at 11:39)</a>:</h4>
<p>A term of type <code>fin n</code> is not a natural number, it is a <em>pair</em> consisting of a natural number and a proof it's less than n. You can't divide a pair by a natural (or at least you can't until you explain to lean exactly what you mean by this).</p>



<a name="244126736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244126736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244126736">(Jun 28 2021 at 10:43)</a>:</h4>
<p><code>instance mine [ring α] : has_scalar α α := sorry</code><br>
How can I close the goal by using the mul as smul?</p>



<a name="244127391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244127391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244127391">(Jun 28 2021 at 10:51)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="n">mine</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_scalar</span> <span class="n">α</span> <span class="n">α</span> <span class="o">:=</span>
<span class="n">infer_instance</span>
</code></pre></div>
<p>works for me, which means that Lean is already assuming that rings have smuls and they're (no doubt) equal to muls</p>



<a name="244127496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244127496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244127496">(Jun 28 2021 at 10:52)</a>:</h4>
<p>If the instance can already be found (in term mode by <code>infer_instance</code> and in tactic mode by <code>apply_instance</code>) then you don't need to start putting other instances in yourself (indeed, this is in general a bad idea)</p>



<a name="244150924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244150924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244150924">(Jun 28 2021 at 14:17)</a>:</h4>
<p>Right, Kevin. This has already been defined. I got an error if using<br>
<code>instance silly [ring α] : has_scalar α α := ring.mul </code>. I am not sure how to fix it if not using <code>infer_instance</code>.</p>



<a name="244154015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244154015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244154015">(Jun 28 2021 at 14:35)</a>:</h4>
<p>Is it possible to know what <code>infer_instance</code> is using or to find the already defined instance?<br>
I am not sure why <code>ring.mul</code> won't work.</p>



<a name="244154787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244154787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244154787">(Jun 28 2021 at 14:40)</a>:</h4>
<p>If you use <code>by apply_instance</code> instead, then you can add <code>by show_term{apply_instance}</code> and you should see the proof that Lean finds.</p>



<a name="244159027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244159027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244159027">(Jun 28 2021 at 15:08)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/has_scalar">docs#has_scalar</a> is a structure (with only one field), so you can provide <code>ring.mul</code> as that field but you have to use the right syntax:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.ring.basic</span>
<span class="kn">import</span> <span class="n">group_theory.group_action.defs</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_scalar</span> <span class="n">α</span> <span class="n">α</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">ring.mul</span><span class="o">⟩</span>
</code></pre></div>



<a name="244159356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244159356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244159356">(Jun 28 2021 at 15:11)</a>:</h4>
<p>Right! I misread the defn for <code>has_scalar</code></p>



<a name="244188805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/an%20example/near/244188805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/an.20example.html#244188805">(Jun 28 2021 at 18:47)</a>:</h4>
<p>In this case it's finding <a href="https://leanprover-community.github.io/mathlib_docs/find/has_mul.to_has_scalar">docs#has_mul.to_has_scalar</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>