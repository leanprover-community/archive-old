---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Feedback.20on.20code.20style.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html">Feedback on code style</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="193748888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193748888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193748888">(Apr 13 2020 at 06:41)</a>:</h4>
<p>I just wrote my first proof in Lean for an example not from the official tutorial. I'm hoping I can get some advice on Lean code style, because <strong>my proof looks is pretty messy to me</strong>. I think it would suffice if I just got <strong>some pointers on best practices that would make this proof more readable</strong>.</p>
<p><strong>I don't want to use tactics just yet</strong>, as I want to first learn how to write good non-tactic Lean code before I start learning how to use tactics. </p>
<p>So it would be really great if someone is willing to give me some pointers to best practices that would make this proof more readable.</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">X</span><span class="o">,</span>  <span class="n">inductiveset</span> <span class="n">X</span> <span class="bp">→</span> <span class="n">inductiveset</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span> <span class="o">:=</span>
    <span class="bp">λ</span><span class="n">X</span><span class="o">,</span> <span class="k">assume</span> <span class="n">hinductivesetX</span><span class="o">:</span> <span class="n">inductiveset</span> <span class="n">X</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">hQdef</span><span class="o">:</span> <span class="o">(</span><span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">u</span><span class="o">),</span> <span class="k">from</span> <span class="o">(</span><span class="n">specdef</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span>
    <span class="n">and</span><span class="bp">.</span><span class="n">intro</span>
        <span class="o">(</span><span class="k">show</span> <span class="n">null</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span> <span class="k">from</span>
            <span class="k">have</span> <span class="n">h2</span><span class="o">:</span> <span class="n">null</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="n">hinductivesetX</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
            <span class="k">have</span> <span class="n">h3</span><span class="o">:</span> <span class="n">null</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span><span class="bp">λ</span><span class="n">u</span><span class="o">,</span> <span class="k">assume</span> <span class="n">hu</span><span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">null</span><span class="o">,</span> <span class="n">absurd</span> <span class="n">hu</span> <span class="o">(</span><span class="n">nulldef</span> <span class="n">u</span><span class="o">)),</span>
            <span class="n">suffices</span> <span class="n">h4</span><span class="o">:</span> <span class="n">null</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">null</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">((</span><span class="n">specdef</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span> <span class="n">null</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h4</span><span class="o">,</span>
            <span class="n">and</span><span class="bp">.</span><span class="n">intro</span> <span class="n">h2</span> <span class="n">h3</span>
        <span class="o">)</span>
        <span class="o">(</span><span class="k">show</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span> <span class="bp">→</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span> <span class="k">from</span>
            <span class="bp">λ</span><span class="n">u</span><span class="o">,</span> <span class="k">assume</span> <span class="n">h2</span><span class="o">:</span><span class="n">u</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span>
            <span class="n">suffices</span> <span class="n">h3</span><span class="o">:</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span><span class="n">hQdef</span> <span class="o">(</span><span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]))</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h3</span><span class="o">,</span>
            <span class="k">have</span> <span class="n">h4</span><span class="o">:</span><span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span><span class="n">hinductivesetX</span><span class="bp">.</span><span class="mi">2</span> <span class="n">u</span><span class="o">)</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
            <span class="k">have</span> <span class="n">h5</span><span class="o">:</span><span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span>
                <span class="k">have</span> <span class="n">h6</span><span class="o">:</span><span class="n">u</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
                <span class="k">have</span> <span class="n">h7</span><span class="o">:</span><span class="n">u</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
                <span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="k">assume</span> <span class="n">h8</span><span class="o">:</span><span class="n">x</span> <span class="n">ε</span> <span class="o">(</span><span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]),</span>
                    <span class="k">show</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span>
                    <span class="k">have</span> <span class="n">h9</span><span class="o">:</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">u</span> <span class="bp">∨</span> <span class="n">x</span> <span class="n">ε</span> <span class="o">[</span><span class="n">u</span><span class="o">],</span> <span class="k">from</span> <span class="o">(</span><span class="n">uniondef</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h8</span><span class="o">,</span>
                    <span class="n">or</span><span class="bp">.</span><span class="n">elim</span> <span class="n">h9</span>
                        <span class="o">(</span><span class="k">assume</span> <span class="n">h10</span><span class="o">:</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">u</span><span class="o">,</span> <span class="o">(</span><span class="n">h7</span> <span class="n">x</span><span class="o">)</span> <span class="n">h10</span><span class="o">)</span>
                        <span class="o">(</span><span class="k">assume</span> <span class="n">h11</span><span class="o">:</span> <span class="n">x</span> <span class="n">ε</span> <span class="o">[</span><span class="n">u</span><span class="o">],</span>
                            <span class="k">have</span> <span class="n">h12</span><span class="o">:</span><span class="n">x</span> <span class="bp">=</span> <span class="n">u</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span> <span class="n">or</span><span class="bp">.</span><span class="n">elim</span> <span class="o">((</span><span class="n">pairdef</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h11</span><span class="o">)</span> <span class="o">(</span><span class="k">assume</span> <span class="n">h3</span><span class="o">:</span><span class="n">x</span><span class="bp">=</span><span class="n">u</span><span class="o">,</span> <span class="n">h3</span><span class="o">)(</span><span class="k">assume</span> <span class="n">h3</span><span class="o">:</span><span class="n">x</span><span class="bp">=</span><span class="n">u</span><span class="o">,</span> <span class="n">h3</span><span class="o">)</span> <span class="o">),</span>
                            <span class="k">show</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span>
                            <span class="n">eq</span><span class="bp">.</span><span class="n">substr</span> <span class="n">h12</span> <span class="n">h6</span>
                        <span class="o">),</span>
            <span class="n">and</span><span class="bp">.</span><span class="n">intro</span> <span class="n">h4</span> <span class="n">h5</span>
        <span class="o">)</span>
</pre></div>


<p>Here are the background definitions and theorems:</p>
<div class="codehilite"><pre><span></span><span class="kn">constant</span> <span class="n">Set</span> <span class="o">:</span> <span class="kt">Type</span>
<span class="kn">constant</span> <span class="n">In</span> <span class="o">:</span> <span class="n">Set</span> <span class="bp">→</span> <span class="n">Set</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="kn">infix</span> <span class="bp">`</span><span class="n">ε</span><span class="bp">`</span><span class="o">:</span><span class="mi">50</span>  <span class="o">:=</span> <span class="n">In</span>

<span class="kn">definition</span> <span class="n">subsett</span> <span class="o">(</span><span class="n">S</span> <span class="n">X</span><span class="o">:</span> <span class="n">Set</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span>
<span class="kn">infix</span> <span class="bp">`</span><span class="n">sub</span><span class="bp">`</span><span class="o">:</span><span class="mi">50</span> <span class="o">:=</span> <span class="n">subsett</span>



<span class="kn">axiom</span> <span class="n">axextentionality</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">X</span><span class="o">,</span> <span class="bp">∀</span><span class="n">Y</span><span class="o">,</span> <span class="o">(</span><span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">→</span> <span class="n">X</span> <span class="bp">=</span> <span class="n">Y</span>
<span class="kn">axiom</span> <span class="n">axpairing</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">X</span><span class="o">:</span><span class="n">Set</span><span class="o">,</span> <span class="bp">∀</span><span class="n">Y</span><span class="o">:</span><span class="n">Set</span><span class="o">,</span> <span class="bp">∃</span><span class="n">S</span><span class="o">:</span><span class="n">Set</span><span class="o">,</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">X</span> <span class="bp">∨</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">Y</span>
<span class="kn">axiom</span> <span class="n">axspecification</span> <span class="o">(</span><span class="n">φ</span> <span class="o">:</span> <span class="n">Set</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">X</span><span class="o">,</span> <span class="bp">∃</span><span class="n">S</span><span class="o">,</span> <span class="o">(</span><span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">φ</span> <span class="n">u</span><span class="o">)</span>
<span class="kn">axiom</span> <span class="n">axunion</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">X</span><span class="o">,</span> <span class="bp">∀</span><span class="n">Y</span><span class="o">,</span> <span class="bp">∃</span><span class="n">S</span><span class="o">,</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∨</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">Y</span>
<span class="kn">axiom</span> <span class="n">existsset</span> <span class="o">:</span> <span class="bp">∃</span><span class="n">S</span><span class="o">:</span><span class="n">Set</span><span class="o">,</span> <span class="n">S</span><span class="bp">=</span><span class="n">S</span>

<span class="n">noncomputable</span> <span class="kn">definition</span> <span class="n">pair</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="o">:=</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="o">(</span><span class="n">axpairing</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span>
<span class="n">noncomputable</span> <span class="kn">definition</span> <span class="n">union</span> <span class="o">(</span><span class="n">X</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:=</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="o">(</span><span class="n">axunion</span> <span class="n">X</span> <span class="n">Y</span><span class="o">)</span>
<span class="n">noncomputable</span> <span class="kn">definition</span> <span class="n">null</span><span class="o">:</span><span class="n">Set</span> <span class="o">:=</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="o">(</span><span class="n">axspecification</span> <span class="o">(</span><span class="bp">λ</span><span class="n">u</span><span class="o">,</span> <span class="bp">¬</span><span class="n">u</span><span class="bp">=</span><span class="n">u</span><span class="o">)</span>
    <span class="o">(</span><span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="n">existsset</span><span class="o">)</span>  <span class="o">)</span>
<span class="n">noncomputable</span> <span class="kn">definition</span> <span class="n">spec</span> <span class="o">(</span><span class="n">φ</span> <span class="o">:</span> <span class="n">Set</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">Set</span><span class="o">)</span> <span class="o">:=</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="o">(</span><span class="n">axspecification</span> <span class="n">φ</span> <span class="n">X</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">pairdef</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span><span class="o">:</span><span class="n">Set</span><span class="o">}</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="o">(</span><span class="n">pair</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">∨</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some_spec</span> <span class="o">(</span><span class="n">axpairing</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span>
<span class="kn">theorem</span> <span class="n">uniondef</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span><span class="o">:</span><span class="n">Set</span><span class="o">}</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="o">(</span><span class="n">union</span> <span class="n">X</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∨</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">Y</span> <span class="o">:=</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some_spec</span> <span class="o">(</span><span class="n">axunion</span> <span class="n">X</span> <span class="n">Y</span><span class="o">)</span>
<span class="kn">theorem</span> <span class="n">nulldef</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="bp">¬</span><span class="o">(</span><span class="n">u</span> <span class="n">ε</span> <span class="n">null</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="kn">theorem</span> <span class="n">specdef</span> <span class="o">(</span><span class="n">φ</span> <span class="o">:</span> <span class="n">Set</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span><span class="o">:</span><span class="n">Set</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">spec</span> <span class="n">φ</span> <span class="n">X</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">φ</span> <span class="n">u</span><span class="o">)</span> <span class="o">:=</span> <span class="n">classical</span><span class="bp">.</span><span class="n">some_spec</span> <span class="o">(</span><span class="n">axspecification</span> <span class="n">φ</span> <span class="n">X</span><span class="o">)</span>

<span class="kn">infix</span> <span class="bp">`</span><span class="n">U</span><span class="bp">`</span><span class="o">:</span><span class="mi">50</span> <span class="o">:=</span> <span class="n">union</span>
<span class="kn">notation</span> <span class="bp">`</span><span class="o">[</span><span class="bp">`</span> <span class="n">x</span> <span class="bp">`</span><span class="o">,</span><span class="bp">`</span> <span class="n">y</span> <span class="bp">`</span><span class="o">]</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">pair</span> <span class="n">x</span> <span class="n">y</span>
<span class="kn">notation</span> <span class="bp">`</span><span class="o">[</span><span class="bp">`</span> <span class="n">x</span> <span class="bp">`</span><span class="o">]</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">pair</span> <span class="n">x</span> <span class="n">x</span>

<span class="kn">definition</span> <span class="n">inductiveset</span> <span class="o">(</span><span class="n">S</span><span class="o">:</span><span class="n">Set</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">null</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">∧</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="n">S</span>
</pre></div>



<a name="193748949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193748949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193748949">(Apr 13 2020 at 06:43)</a>:</h4>
<p>what is ε? make sure your file can compile on its own</p>



<a name="193748963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193748963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193748963">(Apr 13 2020 at 06:44)</a>:</h4>
<p>whoops sorry for that, for got to copy it.</p>



<a name="193750027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193750027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193750027">(Apr 13 2020 at 07:11)</a>:</h4>
<p>Here's my best attempt at applying lean style guide stuff to your proof</p>
<div class="codehilite"><pre><span></span><span class="kn">constant</span> <span class="n">Set</span> <span class="o">:</span> <span class="kt">Type</span>
<span class="kn">constant</span> <span class="n">In</span> <span class="o">:</span> <span class="n">Set</span> <span class="bp">→</span> <span class="n">Set</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="kn">infix</span> <span class="bp">`</span><span class="n">ε</span><span class="bp">`</span><span class="o">:</span><span class="mi">50</span> <span class="o">:=</span> <span class="n">In</span>

<span class="n">def</span> <span class="n">subsett</span> <span class="o">(</span><span class="n">S</span> <span class="n">X</span> <span class="o">:</span> <span class="n">Set</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span>
<span class="kn">infix</span> <span class="bp">`</span><span class="n">sub</span><span class="bp">`</span><span class="o">:</span><span class="mi">50</span> <span class="o">:=</span> <span class="n">subsett</span>

<span class="kn">axiom</span> <span class="n">ax_ext</span> <span class="o">(</span><span class="n">X</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">→</span> <span class="n">X</span> <span class="bp">=</span> <span class="n">Y</span>
<span class="kn">axiom</span> <span class="n">ax_pair</span> <span class="o">(</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">Set</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">S</span> <span class="o">:</span> <span class="n">Set</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">X</span> <span class="bp">∨</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">Y</span>
<span class="kn">axiom</span> <span class="n">ax_spec</span> <span class="o">(</span><span class="n">φ</span> <span class="o">:</span> <span class="n">Set</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">S</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">φ</span> <span class="n">u</span>
<span class="kn">axiom</span> <span class="n">ax_union</span> <span class="o">(</span><span class="n">X</span> <span class="n">Y</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">S</span><span class="o">,</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∨</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">Y</span>
<span class="kn">axiom</span> <span class="n">ax_exists_set</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">S</span> <span class="o">:</span> <span class="n">Set</span><span class="o">,</span> <span class="n">S</span> <span class="bp">=</span> <span class="n">S</span>

<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">pair</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">Set</span><span class="o">)</span> <span class="o">:</span> <span class="n">Set</span> <span class="o">:=</span>
<span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="o">(</span><span class="n">ax_pair</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span>
<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">union</span> <span class="o">(</span><span class="n">X</span> <span class="n">Y</span> <span class="o">:</span> <span class="n">Set</span><span class="o">)</span> <span class="o">:</span> <span class="n">Set</span> <span class="o">:=</span>
<span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="o">(</span><span class="n">ax_union</span> <span class="n">X</span> <span class="n">Y</span><span class="o">)</span>
<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">spec</span> <span class="o">(</span><span class="n">φ</span> <span class="o">:</span> <span class="n">Set</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">Set</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="o">(</span><span class="n">ax_spec</span> <span class="n">φ</span> <span class="n">X</span><span class="o">)</span>
<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">null</span> <span class="o">:</span> <span class="n">Set</span> <span class="o">:=</span>
<span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">u</span><span class="o">,</span> <span class="n">false</span><span class="o">)</span> <span class="o">(</span><span class="n">classical</span><span class="bp">.</span><span class="n">some</span> <span class="n">ax_exists_set</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">mem_pair</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">u</span> <span class="o">:</span> <span class="n">Set</span><span class="o">}</span> <span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="o">(</span><span class="n">pair</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">∨</span> <span class="n">u</span> <span class="bp">=</span> <span class="n">y</span> <span class="o">:=</span>
<span class="n">classical</span><span class="bp">.</span><span class="n">some_spec</span> <span class="o">(</span><span class="n">ax_pair</span> <span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="bp">_</span>
<span class="kn">theorem</span> <span class="n">mem_union</span> <span class="o">{</span><span class="n">X</span> <span class="n">Y</span> <span class="n">u</span> <span class="o">:</span> <span class="n">Set</span><span class="o">}</span> <span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="o">(</span><span class="n">union</span> <span class="n">X</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∨</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">Y</span> <span class="o">:=</span>
<span class="n">classical</span><span class="bp">.</span><span class="n">some_spec</span> <span class="o">(</span><span class="n">ax_union</span> <span class="n">X</span> <span class="n">Y</span><span class="o">)</span> <span class="bp">_</span>
<span class="kn">theorem</span> <span class="n">mem_spec</span> <span class="o">{</span><span class="n">φ</span> <span class="o">:</span> <span class="n">Set</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span> <span class="o">{</span><span class="n">X</span> <span class="n">u</span> <span class="o">:</span> <span class="n">Set</span><span class="o">}</span> <span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">spec</span> <span class="n">φ</span> <span class="n">X</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">φ</span> <span class="n">u</span> <span class="o">:=</span>
<span class="n">classical</span><span class="bp">.</span><span class="n">some_spec</span> <span class="o">(</span><span class="n">ax_spec</span> <span class="n">φ</span> <span class="n">X</span><span class="o">)</span> <span class="bp">_</span>
<span class="kn">theorem</span> <span class="n">mem_null</span> <span class="o">(</span><span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">null</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="o">(</span><span class="n">mem_spec</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span>

<span class="kn">infix</span> <span class="bp">`</span><span class="n">U</span><span class="bp">`</span><span class="o">:</span><span class="mi">50</span> <span class="o">:=</span> <span class="n">union</span>
<span class="kn">notation</span> <span class="bp">`</span><span class="o">[</span><span class="bp">`</span> <span class="n">x</span> <span class="bp">`</span><span class="o">,</span><span class="bp">`</span> <span class="n">y</span> <span class="bp">`</span><span class="o">]</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">pair</span> <span class="n">x</span> <span class="n">y</span>
<span class="kn">notation</span> <span class="bp">`</span><span class="o">[</span><span class="bp">`</span> <span class="n">x</span> <span class="bp">`</span><span class="o">]</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">pair</span> <span class="n">x</span> <span class="n">x</span>

<span class="n">def</span> <span class="n">inductive_set</span> <span class="o">(</span><span class="n">S</span><span class="o">:</span><span class="n">Set</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">null</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">∧</span> <span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">S</span> <span class="bp">→</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="n">S</span>

<span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="n">Set</span><span class="o">}</span> <span class="o">(</span><span class="n">hX</span> <span class="o">:</span> <span class="n">inductive_set</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">inductive_set</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">have</span> <span class="n">hQdef</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">u</span><span class="o">),</span>
<span class="k">from</span> <span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">mem_spec</span><span class="o">,</span>
<span class="bp">⟨</span> <span class="k">show</span> <span class="n">null</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span> <span class="k">from</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">null</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="n">hX</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:</span> <span class="n">null</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="bp">λ</span><span class="n">u</span><span class="o">,</span> <span class="k">assume</span> <span class="n">hu</span><span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">null</span><span class="o">,</span> <span class="o">(</span><span class="n">mem_null</span> <span class="bp">_</span> <span class="n">hu</span><span class="o">)</span><span class="bp">.</span><span class="n">elim</span><span class="o">,</span>
  <span class="n">suffices</span> <span class="n">h4</span><span class="o">:</span> <span class="n">null</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">null</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="n">mem_spec</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h4</span><span class="o">,</span>
  <span class="bp">⟨</span><span class="n">h2</span><span class="o">,</span> <span class="n">h3</span><span class="bp">⟩</span><span class="o">,</span>
<span class="bp">λ</span> <span class="n">u</span><span class="o">,</span> <span class="k">assume</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span>
  <span class="k">show</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span> <span class="k">from</span>
  <span class="n">suffices</span> <span class="n">h3</span> <span class="o">:</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span><span class="n">hQdef</span> <span class="o">(</span><span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]))</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h3</span><span class="o">,</span>
  <span class="bp">⟨</span> <span class="k">show</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span><span class="n">hX</span><span class="bp">.</span><span class="mi">2</span> <span class="n">u</span><span class="o">)</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
    <span class="k">show</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h7</span> <span class="o">:</span> <span class="n">u</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
    <span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="k">assume</span> <span class="n">h8</span><span class="o">:</span><span class="n">x</span> <span class="n">ε</span> <span class="o">(</span><span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]),</span>
      <span class="k">show</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span>
      <span class="k">have</span> <span class="n">h9</span> <span class="o">:</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">u</span> <span class="bp">∨</span> <span class="n">x</span> <span class="n">ε</span> <span class="o">[</span><span class="n">u</span><span class="o">],</span> <span class="k">from</span> <span class="n">mem_union</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h8</span><span class="o">,</span>
      <span class="n">or</span><span class="bp">.</span><span class="n">elim</span> <span class="n">h9</span>
        <span class="o">(</span><span class="k">assume</span> <span class="n">h10</span><span class="o">:</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">u</span><span class="o">,</span> <span class="o">(</span><span class="n">h7</span> <span class="n">x</span><span class="o">)</span> <span class="n">h10</span><span class="o">)</span>
        <span class="o">(</span><span class="k">assume</span> <span class="n">h11</span><span class="o">:</span> <span class="n">x</span> <span class="n">ε</span> <span class="o">[</span><span class="n">u</span><span class="o">],</span>
          <span class="k">have</span> <span class="n">h12</span><span class="o">:</span><span class="n">x</span> <span class="bp">=</span> <span class="n">u</span><span class="o">,</span> <span class="k">from</span>
            <span class="n">or</span><span class="bp">.</span><span class="n">elim</span> <span class="o">(</span><span class="n">mem_pair</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h11</span><span class="o">)</span>
              <span class="o">(</span><span class="k">assume</span> <span class="n">h3</span><span class="o">:</span><span class="n">x</span><span class="bp">=</span><span class="n">u</span><span class="o">,</span> <span class="n">h3</span><span class="o">)</span>
              <span class="o">(</span><span class="k">assume</span> <span class="n">h3</span><span class="o">:</span><span class="n">x</span><span class="bp">=</span><span class="n">u</span><span class="o">,</span> <span class="n">h3</span><span class="o">),</span>
          <span class="k">show</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span>
          <span class="n">eq</span><span class="bp">.</span><span class="n">substr</span> <span class="n">h12</span> <span class="n">h6</span><span class="o">)</span><span class="bp">⟩⟩</span>
</pre></div>



<a name="193750078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193750078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193750078">(Apr 13 2020 at 07:12)</a>:</h4>
<p>For the proof itself, I have difficulty using term mode for presentation purposes. I find that tactic mode is much easier to provide a overview of the proof structure</p>



<a name="193750289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193750289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193750289">(Apr 13 2020 at 07:18)</a>:</h4>
<p>If I am using term mode, I generally don't waste space on <code>have</code> and <code>show</code> style presentation, which is usually available via hovers anyway. As such, the proof packs way down:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="n">Set</span><span class="o">}</span> <span class="o">(</span><span class="n">hX</span> <span class="o">:</span> <span class="n">inductive_set</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">inductive_set</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">mem_spec</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="n">hX</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span> <span class="bp">λ</span><span class="n">u</span> <span class="n">hu</span><span class="o">,</span> <span class="o">(</span><span class="n">mem_null</span> <span class="bp">_</span> <span class="n">hu</span><span class="o">)</span><span class="bp">.</span><span class="n">elim</span><span class="bp">⟩</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">u</span> <span class="n">h2</span><span class="o">,</span>
 <span class="n">mem_spec</span><span class="bp">.</span><span class="mi">2</span> <span class="bp">⟨</span><span class="o">(</span><span class="n">hX</span><span class="bp">.</span><span class="mi">2</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">mem_spec</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
  <span class="bp">λ</span> <span class="n">x</span> <span class="n">h8</span><span class="o">,</span> <span class="n">or</span><span class="bp">.</span><span class="n">elim</span> <span class="o">(</span><span class="n">mem_union</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h8</span><span class="o">)</span> <span class="o">((</span><span class="n">mem_spec</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span> <span class="n">x</span><span class="o">)</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">h11</span><span class="o">,</span>
  <span class="n">eq</span><span class="bp">.</span><span class="n">substr</span> <span class="o">((</span><span class="n">or_self</span> <span class="bp">_</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="o">(</span><span class="n">mem_pair</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h11</span><span class="o">))</span> <span class="o">(</span><span class="n">mem_spec</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="bp">⟩⟩</span>
</pre></div>



<a name="193750844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193750844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193750844">(Apr 13 2020 at 07:32)</a>:</h4>
<p>In tactic mode, it's a lot easier to have nice formatting and keep the have and show</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="n">Set</span><span class="o">}</span> <span class="o">(</span><span class="n">hX</span> <span class="o">:</span> <span class="n">inductive_set</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">inductive_set</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">hQdef</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span><span class="n">u</span><span class="o">,</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span> <span class="bp">↔</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">u</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">mem_spec</span> <span class="o">},</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="k">show</span> <span class="n">null</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">null</span> <span class="n">ε</span> <span class="n">X</span> <span class="o">:=</span> <span class="n">hX</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:</span> <span class="n">null</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span>
    <span class="o">{</span> <span class="k">assume</span> <span class="n">u</span> <span class="o">(</span><span class="n">hu</span> <span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">null</span><span class="o">),</span>
      <span class="n">exact</span> <span class="o">(</span><span class="n">mem_null</span> <span class="bp">_</span> <span class="n">hu</span><span class="o">)</span><span class="bp">.</span><span class="n">elim</span> <span class="o">},</span>
    <span class="n">suffices</span> <span class="n">h4</span> <span class="o">:</span> <span class="n">null</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">null</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span> <span class="k">from</span> <span class="n">mem_spec</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h4</span><span class="o">,</span>
    <span class="n">exact</span> <span class="bp">⟨</span><span class="n">h2</span><span class="o">,</span> <span class="n">h3</span><span class="bp">⟩</span> <span class="o">},</span>
  <span class="o">{</span> <span class="k">assume</span> <span class="n">u</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">)),</span>
    <span class="k">show</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="o">(</span><span class="n">spec</span> <span class="o">(</span><span class="bp">λ</span><span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="n">sub</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span><span class="o">),</span>
    <span class="n">suffices</span> <span class="n">h3</span> <span class="o">:</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="n">X</span> <span class="bp">∧</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">hQdef</span> <span class="o">(</span><span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]))</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h3</span> <span class="o">},</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span> <span class="k">show</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span>
      <span class="k">from</span> <span class="o">(</span><span class="n">hX</span><span class="bp">.</span><span class="mi">2</span> <span class="n">u</span><span class="o">)</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="o">},</span>
    <span class="o">{</span> <span class="k">show</span> <span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="n">sub</span> <span class="n">X</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">h6</span> <span class="o">:</span> <span class="n">u</span> <span class="n">ε</span> <span class="n">X</span> <span class="o">:=</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">h7</span> <span class="o">:</span> <span class="n">u</span> <span class="n">sub</span> <span class="n">X</span> <span class="o">:=</span> <span class="o">((</span><span class="n">hQdef</span> <span class="n">u</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h2</span><span class="o">)</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
      <span class="k">assume</span> <span class="n">x</span> <span class="o">(</span><span class="n">h8</span> <span class="o">:</span> <span class="n">x</span> <span class="n">ε</span> <span class="o">(</span><span class="n">u</span> <span class="n">U</span> <span class="o">[</span><span class="n">u</span><span class="o">])),</span>
      <span class="k">show</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">h9</span> <span class="o">:</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">u</span> <span class="bp">∨</span> <span class="n">x</span> <span class="n">ε</span> <span class="o">[</span><span class="n">u</span><span class="o">]</span> <span class="o">:=</span> <span class="n">mem_union</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h8</span><span class="o">,</span>
      <span class="n">cases</span> <span class="n">h9</span> <span class="k">with</span> <span class="n">h10</span> <span class="n">h11</span><span class="o">,</span>
      <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">h7</span> <span class="n">x</span><span class="o">)</span> <span class="n">h10</span> <span class="o">},</span>
      <span class="o">{</span> <span class="k">have</span> <span class="n">h12</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">u</span><span class="o">,</span>
        <span class="o">{</span> <span class="n">cases</span> <span class="n">mem_pair</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h11</span> <span class="k">with</span> <span class="n">h3</span> <span class="n">h3</span><span class="o">,</span>
          <span class="o">{</span> <span class="n">exact</span> <span class="n">h3</span> <span class="o">},</span>
          <span class="o">{</span> <span class="n">exact</span> <span class="n">h3</span> <span class="o">}</span> <span class="o">},</span>
        <span class="k">show</span> <span class="n">x</span> <span class="n">ε</span> <span class="n">X</span><span class="o">,</span>
        <span class="n">exact</span> <span class="n">eq</span><span class="bp">.</span><span class="n">substr</span> <span class="n">h12</span> <span class="n">h6</span> <span class="o">}</span> <span class="o">}</span> <span class="o">}</span>
<span class="kn">end</span>
</pre></div>



<a name="193750870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193750870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193750870">(Apr 13 2020 at 07:33)</a>:</h4>
<p>how about don't use <code>axiom</code></p>



<a name="193750919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/193750919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#193750919">(Apr 13 2020 at 07:34)</a>:</h4>
<p>sure, but the replacement is harder to understand for a newbie</p>



<a name="200060733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Feedback%20on%20code%20style/near/200060733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Feedback.20on.20code.20style.html#200060733">(Jun 08 2020 at 05:55)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  Thanks for this, and apologies for the super late reply. Corona disrupted my routine and I didn't come around to reading this until now. Will be studying this.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>