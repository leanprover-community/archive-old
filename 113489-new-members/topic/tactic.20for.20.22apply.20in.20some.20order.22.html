---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html">tactic for "apply in some order"</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="202952257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952257">(Jul 06 2020 at 04:15)</a>:</h4>
<p>Is there a tactic that allows me to just say: "apply these 3 terms/lemmas in whichever order is needed to prove the result"?</p>



<a name="202952447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952447">(Jul 06 2020 at 04:20)</a>:</h4>
<p><code>solve_by_elim</code> might work:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">variables</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="n">C</span> <span class="o">:</span><span class="kt">Prop</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">f</span> <span class="o">:</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">C</span> <span class="o">:=</span> <span class="n">sorry</span>
<span class="kn">lemma</span> <span class="n">g</span> <span class="o">:</span> <span class="n">C</span> <span class="bp">→</span> <span class="n">B</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">C</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">solve_by_elim</span> <span class="o">[</span><span class="n">f</span><span class="o">,</span> <span class="n">g</span><span class="o">],</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202952463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952463">(Jul 06 2020 at 04:21)</a>:</h4>
<p>This is motivated by this massively long proof:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">order</span><span class="bp">.</span><span class="n">lattice</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">lattice</span> <span class="n">α</span><span class="o">]</span>
<span class="kn">variables</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">α</span>

<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">apply</span> <span class="n">le_antisymm</span><span class="o">,</span>
    <span class="o">{</span>
        <span class="n">apply</span> <span class="n">le_inf</span><span class="o">,</span>
        <span class="k">calc</span>
            <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span>  <span class="bp">≤</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span>     <span class="o">:</span> <span class="n">inf_le_left</span>
                        <span class="bp">...</span> <span class="bp">≤</span>  <span class="n">x</span>        <span class="o">:</span> <span class="n">inf_le_left</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">le_inf</span><span class="o">,</span>
        <span class="k">calc</span>
            <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span>  <span class="bp">≤</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span>     <span class="o">:</span> <span class="n">inf_le_left</span>
                        <span class="bp">...</span> <span class="bp">≤</span>  <span class="n">y</span>        <span class="o">:</span> <span class="n">inf_le_right</span><span class="o">,</span>
        <span class="k">calc</span>
            <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span>  <span class="bp">≤</span> <span class="n">z</span>             <span class="o">:</span> <span class="n">inf_le_right</span>
    <span class="o">},</span>
    <span class="o">{</span>
        <span class="n">apply</span> <span class="n">le_inf</span><span class="o">,</span>
        <span class="n">apply</span> <span class="n">le_inf</span><span class="o">,</span>
        <span class="k">calc</span>
            <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span>  <span class="bp">≤</span> <span class="n">x</span>     <span class="o">:</span> <span class="n">inf_le_left</span><span class="o">,</span>
        <span class="k">calc</span>
            <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span>  <span class="bp">≤</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span>     <span class="o">:</span> <span class="n">inf_le_right</span>
                        <span class="bp">...</span> <span class="bp">≤</span>  <span class="n">y</span>        <span class="o">:</span> <span class="n">inf_le_left</span><span class="o">,</span>
        <span class="k">calc</span>
            <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span>  <span class="bp">≤</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span>     <span class="o">:</span> <span class="n">inf_le_right</span>
                        <span class="bp">...</span> <span class="bp">≤</span>  <span class="n">z</span>        <span class="o">:</span> <span class="n">inf_le_right</span>
    <span class="o">}</span>
<span class="kn">end</span>
</code></pre></div>


<p>Where I want to just say something like: </p>
<div class="codehilite"><pre><span></span><code><span class="n">apply</span> <span class="n">le_antisymm</span><span class="o">,</span>
<span class="n">repeat</span> <span class="o">{</span><span class="n">use</span> <span class="o">[</span><span class="n">inf_le_right</span><span class="o">,</span> <span class="n">inf_le_left</span><span class="o">,</span> <span class="n">le_inf</span><span class="o">]}</span>
</code></pre></div>



<a name="202952758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952758">(Jul 06 2020 at 04:30)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span>  The following doesn't work:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">apply</span> <span class="n">le_antisymm</span><span class="o">,</span>
    <span class="n">repeat</span>
    <span class="o">{</span>
        <span class="n">solve_by_elim</span> <span class="o">[</span><span class="n">inf_le_right</span><span class="o">,</span> <span class="n">inf_le_left</span><span class="o">,</span> <span class="n">le_inf</span><span class="o">]</span>
    <span class="o">}</span>
<span class="kn">end</span>
</code></pre></div>


<p>It doesn't improve the goal state.</p>



<a name="202952987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952987">(Jul 06 2020 at 04:37)</a>:</h4>
<p>(deleted)</p>



<a name="202952988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952988">(Jul 06 2020 at 04:37)</a>:</h4>
<p>this is like Coq Ltac</p>



<a name="202952994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952994">(Jul 06 2020 at 04:37)</a>:</h4>
<p>if you rewrite inf_assoc then you have already cleared the goal lol</p>



<a name="202952997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952997">(Jul 06 2020 at 04:37)</a>:</h4>
<p>oh lol!</p>



<a name="202952998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952998">(Jul 06 2020 at 04:37)</a>:</h4>
<p>the point is to prove inf_assoc</p>



<a name="202952999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202952999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202952999">(Jul 06 2020 at 04:37)</a>:</h4>
<p>using inf_le_left etc</p>



<a name="202953108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953108">(Jul 06 2020 at 04:40)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> do you know Coq Ltac?</p>



<a name="202953110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953110">(Jul 06 2020 at 04:40)</a>:</h4>
<p>they can say things like, "if the goal looks like foo, then apply bar"</p>



<a name="202953113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953113">(Jul 06 2020 at 04:41)</a>:</h4>
<p>I've been wanting to ask about this</p>



<a name="202953119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953119">(Jul 06 2020 at 04:41)</a>:</h4>
<p>you can do that in non-interactive tactics</p>



<a name="202953125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953125">(Jul 06 2020 at 04:41)</a>:</h4>
<p>you can also write non-interactive tactics inside a begin-end block if it's not reusable</p>



<a name="202953167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953167">(Jul 06 2020 at 04:42)</a>:</h4>
<p>but do we have that functionality currently?</p>



<a name="202953221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953221">(Jul 06 2020 at 04:44)</a>:</h4>
<p>what are non-interactive tactics?</p>



<a name="202953241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953241">(Jul 06 2020 at 04:45)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">Ltac</span> <span class="n">perm_aux</span> <span class="n">n</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="n">goal</span> <span class="k">with</span>
  <span class="o">|</span> <span class="o">|-</span> <span class="o">(</span><span class="n">perm</span> <span class="o">_</span> <span class="o">?</span><span class="n">l</span> <span class="o">?</span><span class="n">l</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="k">apply</span> <span class="n">perm_refl</span>
  <span class="o">|</span> <span class="o">|-</span> <span class="o">(</span><span class="n">perm</span> <span class="o">_</span> <span class="o">(?</span><span class="n">a</span> <span class="o">::</span> <span class="o">?</span><span class="n">l1</span><span class="o">)</span> <span class="o">(?</span><span class="n">a</span> <span class="o">::</span> <span class="o">?</span><span class="n">l2</span><span class="o">))</span> <span class="o">=&gt;</span>
     <span class="k">let</span> <span class="n">newn</span> <span class="o">:=</span> <span class="n">eval</span> <span class="k">compute</span> <span class="k">in</span> <span class="o">(</span><span class="n">length</span> <span class="n">l1</span><span class="o">)</span> <span class="k">in</span>
         <span class="o">(</span><span class="k">apply</span> <span class="n">perm_cons</span><span class="o">;</span> <span class="n">perm_aux</span> <span class="n">newn</span><span class="o">)</span>
  <span class="o">|</span> <span class="o">|-</span> <span class="o">(</span><span class="n">perm</span> <span class="o">?</span><span class="n">A</span> <span class="o">(?</span><span class="n">a</span> <span class="o">::</span> <span class="o">?</span><span class="n">l1</span><span class="o">)</span> <span class="o">?</span><span class="n">l2</span><span class="o">)</span> <span class="o">=&gt;</span>
     <span class="k">match</span> <span class="n">eval</span> <span class="k">compute</span> <span class="k">in</span> <span class="n">n</span> <span class="k">with</span>
     <span class="o">|</span> <span class="mi">1</span> <span class="o">=&gt;</span> <span class="n">fail</span>
     <span class="o">|</span> <span class="o">_</span> <span class="o">=&gt;</span>
         <span class="k">let</span> <span class="n">l1&#39;</span> <span class="o">:=</span> <span class="n">constr</span><span class="o">:(</span><span class="n">l1</span> <span class="o">++</span> <span class="n">a</span> <span class="o">::</span> <span class="n">nil</span><span class="o">)</span> <span class="k">in</span>
         <span class="o">(</span><span class="k">apply</span> <span class="o">(</span><span class="n">perm_trans</span> <span class="n">A</span> <span class="o">(</span><span class="n">a</span> <span class="o">::</span> <span class="n">l1</span><span class="o">)</span> <span class="n">l1&#39;</span> <span class="n">l2</span><span class="o">);</span>
         <span class="o">[</span> <span class="k">apply</span> <span class="n">perm_append</span> <span class="o">|</span> <span class="k">compute</span><span class="o">;</span> <span class="n">perm_aux</span> <span class="o">(</span><span class="n">pred</span> <span class="n">n</span><span class="o">)</span> <span class="o">])</span>
     <span class="k">end</span>
  <span class="k">end</span><span class="o">.</span>
</code></pre></div>



<a name="202953243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953243">(Jul 06 2020 at 04:45)</a>:</h4>
<p>^ an example of Ltac <code>match goal with</code></p>



<a name="202953250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953250">(Jul 06 2020 at 04:45)</a>:</h4>
<p>so we can build tactics that apply inf_le_left and le_inf</p>



<a name="202953253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953253">(Jul 06 2020 at 04:46)</a>:</h4>
<p>like a custom solver for lattice equations</p>



<a name="202953310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953310">(Jul 06 2020 at 04:47)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">private</span> <span class="n">meta</span> <span class="n">def</span> <span class="n">infs</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">refl</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_left_of_le</span><span class="o">,</span> <span class="n">infs</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_right_of_le</span><span class="o">,</span> <span class="n">infs</span><span class="o">}]</span>
<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply</span> <span class="n">le_antisymm</span><span class="bp">;</span> <span class="n">repeat</span> <span class="o">{</span><span class="n">apply</span> <span class="n">le_inf</span><span class="o">}</span><span class="bp">;</span> <span class="o">{</span><span class="n">infs</span><span class="o">}</span>
</code></pre></div>



<a name="202953470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953470">(Jul 06 2020 at 04:53)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  Did you define <code>infs</code> specifically for this purpose?</p>



<a name="202953516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953516">(Jul 06 2020 at 04:54)</a>:</h4>
<p>yes</p>



<a name="202953528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953528">(Jul 06 2020 at 04:55)</a>:</h4>
<p>does <code>&lt;|&gt;</code> mean "try either the left or right hand side, whichever works"?</p>



<a name="202953530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953530">(Jul 06 2020 at 04:55)</a>:</h4>
<p>the left hand side first</p>



<a name="202953531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953531">(Jul 06 2020 at 04:55)</a>:</h4>
<p>The only reason it is not literally in the begin-end block of the theorem is because it's recursive and that's annoying to write without a global definition</p>



<a name="202953590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953590">(Jul 06 2020 at 04:57)</a>:</h4>
<p>I think that these kind of "light weight custom tactics" are underrated in proof scripts</p>



<a name="202953794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202953794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202953794">(Jul 06 2020 at 05:03)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">order</span><span class="bp">.</span><span class="n">lattice</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">infs</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">refl</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_left_of_le</span><span class="o">,</span> <span class="n">infs</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_right_of_le</span><span class="o">,</span> <span class="n">infs</span><span class="o">}]</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">lattice</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">apply</span> <span class="n">le_antisymm</span><span class="bp">;</span> <span class="n">repeat</span> <span class="o">{</span> <span class="n">apply</span> <span class="n">le_inf</span> <span class="o">}</span><span class="bp">;</span> <span class="n">infs</span><span class="o">]</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">lattice</span> <span class="n">L</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">L</span><span class="o">}</span>

<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">y</span> <span class="err">⊓</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>
</code></pre></div>



<a name="202954063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954063">(Jul 06 2020 at 05:11)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">order</span><span class="bp">.</span><span class="n">lattice</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">infs_and_sups</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">refl</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_left_of_le</span><span class="o">,</span> <span class="n">infs_and_sups</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_right_of_le</span><span class="o">,</span> <span class="n">infs_and_sups</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span>
  <span class="o">{</span><span class="n">apply</span> <span class="n">le_sup_left_of_le</span><span class="o">,</span> <span class="n">infs_and_sups</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">le_sup_right_of_le</span><span class="o">,</span> <span class="n">infs_and_sups</span><span class="o">}]</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">lattice</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">try</span> <span class="o">{</span> <span class="n">apply</span> <span class="n">le_antisymm</span> <span class="o">}</span><span class="bp">;</span> <span class="n">repeat</span> <span class="o">{</span> <span class="n">apply</span> <span class="n">le_inf</span> <span class="bp">&lt;|&gt;</span> <span class="n">apply</span> <span class="n">sup_le</span> <span class="o">}</span><span class="bp">;</span> <span class="n">infs_and_sups</span><span class="o">]</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">lattice</span> <span class="n">L</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">L</span><span class="o">}</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">⊔</span> <span class="o">(</span><span class="n">b</span> <span class="err">⊓</span> <span class="n">c</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">a</span> <span class="err">⊔</span> <span class="n">b</span><span class="o">)</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">a</span> <span class="err">⊔</span> <span class="n">c</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">⊔</span> <span class="o">(</span><span class="n">a</span> <span class="err">⊓</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>

<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">y</span> <span class="err">⊓</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>
</code></pre></div>



<a name="202954099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954099">(Jul 06 2020 at 05:12)</a>:</h4>
<p>I think you just wrote a prover for intuitionistic logic</p>



<a name="202954128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954128">(Jul 06 2020 at 05:12)</a>:</h4>
<p>oh right they're the same as lattices</p>



<a name="202954130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954130">(Jul 06 2020 at 05:12)</a>:</h4>
<p>where's my complement</p>



<a name="202954136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954136">(Jul 06 2020 at 05:12)</a>:</h4>
<p>heyting lattices to be precise</p>



<a name="202954142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954142">(Jul 06 2020 at 05:13)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span> , did you just write the <code>lattice</code> tactic for the first time, or is it already part of the library?</p>



<a name="202954145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954145">(Jul 06 2020 at 05:13)</a>:</h4>
<p>for the first time</p>



<a name="202954150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954150">(Jul 06 2020 at 05:13)</a>:</h4>
<p>nice</p>



<a name="202954151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954151">(Jul 06 2020 at 05:13)</a>:</h4>
<p>generally speaking if it appears in a code block on zulip it was just written</p>



<a name="202954213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202954213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202954213">(Jul 06 2020 at 05:15)</a>:</h4>
<p>the procedure is pretty simple: split on everything and apply all assumptions</p>



<a name="202956033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202956033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202956033">(Jul 06 2020 at 06:04)</a>:</h4>
<p><code>solve_by_elim</code> is good at this, although note that its default <code>max_depth</code> is very low (3!)</p>



<a name="202956034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202956034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202956034">(Jul 06 2020 at 06:04)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">order</span><span class="bp">.</span><span class="n">lattice</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">interactive</span><span class="bp">.</span><span class="n">lattice</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">solve_by_elim</span>
  <span class="o">[</span><span class="n">le_antisymm</span><span class="o">,</span> <span class="n">le_inf</span><span class="o">,</span> <span class="n">sup_le</span><span class="o">,</span> <span class="n">le_refl</span><span class="o">,</span> <span class="n">inf_le_left_of_le</span><span class="o">,</span> <span class="n">inf_le_right_of_le</span><span class="o">,</span>
    <span class="n">le_sup_left_of_le</span><span class="o">,</span> <span class="n">le_sup_right_of_le</span><span class="o">]</span>
  <span class="o">{</span><span class="n">max_depth</span> <span class="o">:=</span> <span class="mi">30</span><span class="o">}]</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">lattice</span> <span class="n">L</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">L</span><span class="o">}</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">⊔</span> <span class="o">(</span><span class="n">b</span> <span class="err">⊓</span> <span class="n">c</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="n">a</span> <span class="err">⊔</span> <span class="n">b</span><span class="o">)</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">a</span> <span class="err">⊔</span> <span class="n">c</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">a</span> <span class="err">⊔</span> <span class="o">(</span><span class="n">a</span> <span class="err">⊓</span> <span class="n">b</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>

<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">y</span> <span class="err">⊓</span> <span class="n">x</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">lattice</span>
</code></pre></div>



<a name="202956111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202956111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202956111">(Jul 06 2020 at 06:06)</a>:</h4>
<p>(In this case, because of the shape of the lemmas, there's no danger setting a high <code>max_depth</code>; it would be fine probably to set it to 1000.)</p>



<a name="202956124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/202956124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#202956124">(Jul 06 2020 at 06:06)</a>:</h4>
<p>I'm not claiming that this is superior to Kenny's hand-rolled tactic; just that this sort of machinery is available "out of the box" as well.</p>



<a name="203230897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/203230897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#203230897">(Jul 08 2020 at 04:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22/near/202953310">said</a>:</p>
<blockquote>
<div class="codehilite"><pre><span></span><code><span class="kn">private</span> <span class="n">meta</span> <span class="n">def</span> <span class="n">infs</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">refl</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_left_of_le</span><span class="o">,</span> <span class="n">infs</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_right_of_le</span><span class="o">,</span> <span class="n">infs</span><span class="o">}]</span>
<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply</span> <span class="n">le_antisymm</span><span class="bp">;</span> <span class="n">repeat</span> <span class="o">{</span><span class="n">apply</span> <span class="n">le_inf</span><span class="o">}</span><span class="bp">;</span> <span class="o">{</span><span class="n">infs</span><span class="o">}</span>
</code></pre></div>


</blockquote>
<p>I am confused as to why the following doesn't work:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">apply</span> <span class="n">le_antisymm</span><span class="bp">;</span>
    <span class="o">{</span><span class="n">repeat</span> <span class="o">{</span><span class="n">apply</span> <span class="n">le_inf</span><span class="o">}</span><span class="bp">;</span>
    <span class="n">repeat</span> <span class="o">{</span><span class="n">refl</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_left_of_le</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_right_of_le</span><span class="o">}}}</span>
<span class="kn">end</span>
</code></pre></div>


<p>I would have guessed that this is equivalent to your solution using <code>infs</code>.</p>



<a name="203232869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/203232869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#203232869">(Jul 08 2020 at 05:32)</a>:</h4>
<p>because <code>infs</code> allows for tree-like search while your translation can only apply one tactic at a time</p>



<a name="203352248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/203352248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#203352248">(Jul 09 2020 at 05:37)</a>:</h4>
<p>Ah I see it now, thanks :)</p>



<a name="203353447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/203353447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#203353447">(Jul 09 2020 at 06:08)</a>:</h4>
<p>So a followup question:<br>
In this code by <span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, we use <code>inf_le_left_of_le</code> instead of <code>inf_le_left</code> as I do in the original <code>calc</code> proof:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">private</span> <span class="n">meta</span> <span class="n">def</span> <span class="n">infs</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">refl</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_left_of_le</span><span class="o">,</span> <span class="n">infs</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_right_of_le</span><span class="o">,</span> <span class="n">infs</span><span class="o">}]</span>
<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply</span> <span class="n">le_antisymm</span><span class="bp">;</span> <span class="n">repeat</span> <span class="o">{</span><span class="n">apply</span> <span class="n">le_inf</span><span class="o">}</span><span class="bp">;</span> <span class="o">{</span><span class="n">infs</span><span class="o">}</span>
</code></pre></div>


<p>I understand this is because <code>calc</code> has its own implicit use of <code>le_trans</code> and similar terms, and hence we can't just write</p>
<div class="codehilite"><pre><span></span><code><span class="kn">private</span> <span class="n">meta</span> <span class="n">def</span> <span class="n">infs</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">refl</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_left</span><span class="o">,</span> <span class="n">infs</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">apply</span> <span class="n">inf_le_right</span><span class="o">,</span> <span class="n">infs</span><span class="o">}]</span>
</code></pre></div>


<p>However, it would be nice if we can somehow define <code>infs</code> instead to say something like "use <code>inf_le_left</code> and <code>inf_le_right</code> and make a <code>calc</code> proof from them using the appropriate transitivity terms", without either  having to know the names of those transitivity terms or the name <code>inf_le_left_of_le</code>. Is this possible?</p>



<a name="203353512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/203353512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#203353512">(Jul 09 2020 at 06:10)</a>:</h4>
<p>It is possible to change the tactic to use <code>le_trans</code> and <code>inf_le_left</code> instead of <code>inf_le_left_of_le</code>, but general proof search using <code>le_trans</code> is messy because it has an undetermined middle variable</p>



<a name="203353566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/tactic%20for%20%22apply%20in%20some%20order%22/near/203353566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/tactic.20for.20.22apply.20in.20some.20order.22.html#203353566">(Jul 09 2020 at 06:11)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">private</span> <span class="n">meta</span> <span class="n">def</span> <span class="n">infs</span> <span class="o">:=</span>
<span class="bp">`</span><span class="o">[</span><span class="n">refl</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">transitivity</span><span class="o">,</span> <span class="n">apply</span> <span class="n">inf_le_left</span><span class="o">,</span> <span class="n">infs</span><span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="o">{</span><span class="n">transitivity</span><span class="o">,</span> <span class="n">apply</span> <span class="n">inf_le_right</span><span class="o">,</span> <span class="n">infs</span><span class="o">}]</span>
<span class="kn">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="err">⊓</span> <span class="n">y</span><span class="o">)</span> <span class="err">⊓</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="err">⊓</span> <span class="o">(</span><span class="n">y</span> <span class="err">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply</span> <span class="n">le_antisymm</span><span class="bp">;</span> <span class="n">repeat</span> <span class="o">{</span><span class="n">apply</span> <span class="n">le_inf</span><span class="o">}</span><span class="bp">;</span> <span class="o">{</span><span class="n">infs</span><span class="o">}</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>