---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html">✔ Odd residues mod 8</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="272725567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272725567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272725567">(Feb 21 2022 at 19:10)</a>:</h4>
<p>This is probably still not optimal ... e.g. there might be a quicker way to prove that there are finitely many cases.</p>



<a name="272725787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272725787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272725787">(Feb 21 2022 at 19:12)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#interval_cases">tactic#interval_cases</a> works, but it's somewhat slow:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.int.parity</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">lemma</span> <span class="n">mod8_odd</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hlo</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hhi</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">(</span><span class="n">hodd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">5</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">7</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">int.odd_iff</span> <span class="n">at</span> <span class="n">hodd</span><span class="o">,</span>
  <span class="n">interval_cases</span> <span class="n">using</span> <span class="n">hlo</span> <span class="n">hhi</span><span class="bp">;</span> <span class="n">norm_num</span> <span class="n">at</span> <span class="n">hodd</span><span class="bp">;</span> <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="272725872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272725872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272725872">(Feb 21 2022 at 19:13)</a>:</h4>
<p>I guess <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#norm_num">tactic#norm_num</a> doesn't know how to evaluate <code>odd</code> expressions, but it's fine with modulo, so that's what <code>rw int.odd_iff</code> is for.</p>



<a name="272726445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272726445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272726445">(Feb 21 2022 at 19:19)</a>:</h4>
<p>Thanks to both of you! It looks like Heather's proof is slightly faster, so I'll stick with it.</p>



<a name="272726454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272726454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272726454">(Feb 21 2022 at 19:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> has marked this topic as resolved.</p>



<a name="272727293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272727293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272727293">(Feb 21 2022 at 19:29)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> I tried a proof using <code>interval_cases</code> with 50 cases over the weekend and couldn't get it to compile: it timed out. Is this expected?</p>



<a name="272727672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272727672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272727672">(Feb 21 2022 at 19:33)</a>:</h4>
<p>I think <code>interval_cases</code> is much slower than needed. If some tactician could speed it up, that would be awesome. I think Mario might have had some ideas.</p>



<a name="272727795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272727795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272727795">(Feb 21 2022 at 19:35)</a>:</h4>
<p>I wonder what the slow part is, since there's not that much to it. It looks for lower and upper bounds to create an interval, gets a <code>fintype</code> instance for it, then does <code>fin_cases</code>.</p>



<a name="272729062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272729062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272729062">(Feb 21 2022 at 19:50)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="bp">-</span><span class="mi">24</span> <span class="bp">≤</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≤</span> <span class="mi">24</span><span class="o">)</span> <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">interval_cases</span> <span class="n">x</span><span class="o">,</span> <span class="c1">-- (deterministic) timeout</span>
<span class="kd">end</span>
</code></pre></div>



<a name="272730045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272730045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272730045">(Feb 21 2022 at 20:01)</a>:</h4>
<p>ooh we don't have <code>finset.comap</code> for injections (but we have <code>finset.map</code>)</p>



<a name="272730909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272730909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272730909">(Feb 21 2022 at 20:11)</a>:</h4>
<p>Generating the fintype on the fly is slow because afaiu it has to first enumerate the whole univ, then prove that it is enumerative, and then prove that it is all nodup, and I think the default way to decide that is at least N^3</p>



<a name="272731163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272731163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272731163">(Feb 21 2022 at 20:14)</a>:</h4>
<p>yeah this is where I got stuck when doing it manually. Presumably it needs to be done constructively :-/</p>



<a name="272731837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272731837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272731837">(Feb 21 2022 at 20:23)</a>:</h4>
<p>Whatever the exponent is, you can probably decrease your proof runtime by 2^2 or 2^3 by using that odd n, for n natural, means that there is a k such that n = bit1 k = 2 * k + 1. Use that through an obtain rfl step, and you only have to now check between 0 and 3 inclusive, and k is one of 0 to 3.</p>



<a name="272733571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272733571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272733571">(Feb 21 2022 at 20:46)</a>:</h4>
<p>Is there a way of increasing the time before a timeout?<br>
Say, I have a proof that amounts to treating a lot of separate cases and I know the proof is correct, but it just takes too long to be processed.</p>



<a name="272735319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272735319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272735319">(Feb 21 2022 at 21:09)</a>:</h4>
<p><a href="https://leanprover-community.github.io/tips_and_tricks.html#memory-and-deterministic-timeout">https://leanprover-community.github.io/tips_and_tricks.html#memory-and-deterministic-timeout</a></p>



<a name="272735411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272735411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272735411">(Feb 21 2022 at 21:11)</a>:</h4>
<p>In general it should be possible to speed 99.9% of proofs up so that they fit within the default timeout though</p>



<a name="272736298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272736298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272736298">(Feb 21 2022 at 21:22)</a>:</h4>
<p>Doing more-or-less what I understand <code>interval_cases</code> to be doing by hand runs in about 1/3 to 1/2 the time:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.int.parity</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">set_option</span> <span class="n">profiler</span> <span class="n">true</span>

<span class="c1">-- 9.5s</span>
<span class="kd">lemma</span> <span class="n">mod8_odd</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hlo</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hhi</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">(</span><span class="n">hodd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">5</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">7</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">int.odd_iff</span> <span class="n">at</span> <span class="n">hodd</span><span class="o">,</span>
  <span class="n">interval_cases</span> <span class="n">using</span> <span class="n">hlo</span> <span class="n">hhi</span><span class="bp">;</span> <span class="n">norm_num</span> <span class="n">at</span> <span class="n">hodd</span><span class="bp">;</span> <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>

<span class="c1">-- 3.81s</span>
<span class="kd">lemma</span> <span class="n">mod8_odd'</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hlo</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hhi</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">(</span><span class="n">hodd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">5</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">7</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">int.odd_iff</span> <span class="n">at</span> <span class="n">hodd</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h'</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">set.Ico</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="mi">8</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="bp">*</span><span class="o">],</span>
  <span class="n">set</span> <span class="n">b'</span> <span class="o">:=</span> <span class="o">(⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">h'</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">set.Ico</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="mi">8</span><span class="o">)</span> <span class="k">with</span> <span class="n">hb'</span><span class="o">,</span>
  <span class="n">fin_cases</span> <span class="n">b'</span><span class="bp">;</span> <span class="n">rw</span> <span class="o">[</span><span class="n">this</span><span class="o">]</span> <span class="n">at</span> <span class="n">hb'</span><span class="bp">;</span> <span class="n">simp</span> <span class="n">only</span> <span class="n">at</span> <span class="n">hb'</span><span class="bp">;</span> <span class="n">subst</span> <span class="n">b</span><span class="bp">;</span> <span class="n">norm_num</span> <span class="n">at</span> <span class="n">hodd</span><span class="bp">;</span> <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="272736341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272736341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272736341">(Feb 21 2022 at 21:23)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span>  Yes, I guess a timeout is a sign that there is a better proof...</p>



<a name="272736585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272736585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272736585">(Feb 21 2022 at 21:26)</a>:</h4>
<p>eh, not really, Lean3 just isn't designed for this. lean4 should be, though</p>



<a name="272736894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272736894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272736894">(Feb 21 2022 at 21:30)</a>:</h4>
<p>BTW isn't there a <code>dec_trivial</code> approach to this as well? Or did I miss it or is it the same as using <code>interval_cases</code>?</p>



<a name="272737289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272737289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272737289">(Feb 21 2022 at 21:36)</a>:</h4>
<p>maybe if you want to wait till the heat death of the universe ;b</p>



<a name="272737299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272737299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272737299">(Feb 21 2022 at 21:36)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span> Yeah, I guess there is one (for nats, but not Z), and it's significantly faster.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">mod8_odd'</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hhi</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">(</span><span class="n">hodd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">5</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">7</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">dec_trivial</span><span class="bp">!</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="272737492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272737492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272737492">(Feb 21 2022 at 21:39)</a>:</h4>
<p><span class="user-mention" data-user-id="284160">@Eric Rodriguez</span> Hmm, I guess heat death came sooner than anyone had ever anticipated. No one tells you that these are the sorts of insights you might get by working with proof assistants.</p>



<a name="272737583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272737583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272737583">(Feb 21 2022 at 21:40)</a>:</h4>
<p>Yeah I thought I'd seen it used for bigger problems than this--though the "size" is dependent on definitions and can be hard to predict</p>



<a name="272737612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272737612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272737612">(Feb 21 2022 at 21:40)</a>:</h4>
<p>I assume there is no reason we couldn't add an instance for <code>int</code> that handles the original problem too</p>



<a name="272740296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272740296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272740296">(Feb 21 2022 at 22:20)</a>:</h4>
<p>Note that <code>fin_cases</code> and <code>interval_cases</code> are really unnecessarily slow right now. I started working on a speedup reimplementation but got distracted</p>



<a name="272740448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272740448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272740448">(Feb 21 2022 at 22:23)</a>:</h4>
<p>in other slow tactics like <code>ac_refl</code> and <code>wlog</code>, is the problem less avoidable?</p>



<a name="272740639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272740639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272740639">(Feb 21 2022 at 22:26)</a>:</h4>
<p>for <code>wlog</code>, probably, for <code>ac_refl</code> I don't know much about how it is implemented but the answer is usually yes it can be improved</p>



<a name="272740760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272740760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272740760">(Feb 21 2022 at 22:28)</a>:</h4>
<p>I think it's a problem that <code>wlog</code> is apparently slow enough that it is no longer usable for the original purpose it was designed for before it got generalized beyond all recognition</p>



<a name="272740905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272740905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272740905">(Feb 21 2022 at 22:30)</a>:</h4>
<p>it's barely useable for <code>wlog : a ≤ b</code> :(</p>



<a name="272741141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741141">(Feb 21 2022 at 22:34)</a>:</h4>
<p>I haven't tried it yet, but a fresh new lightweight tactic that can be used for some applications of wlog is <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#swap_var">tactic#swap_var</a></p>



<a name="272741183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741183">(Feb 21 2022 at 22:35)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#swap_var">tactic#swap_var</a></p>



<a name="272741243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741243">(Feb 21 2022 at 22:36)</a>:</h4>
<p>that's interesting!</p>



<a name="272741690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741690">(Feb 21 2022 at 22:42)</a>:</h4>
<p>Yeah, that tactic was what got me thinking that people are avoiding <code>wlog</code> at its main job</p>



<a name="272741754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741754">(Feb 21 2022 at 22:43)</a>:</h4>
<p>from a tactic language perspective I want people to just use <code>wlog</code> but if it's too slow then I don't blame them</p>



<a name="272741758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741758">(Feb 21 2022 at 22:43)</a>:</h4>
<p>I wrote <code>swap_var</code> for this use case:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[to_additive]</span>
<span class="kn">protected</span> <span class="kd">def</span> <span class="n">mul_le</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→</span> <span class="n">G</span> <span class="bp">→</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">quotient.lift₂</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">S</span> <span class="bp">×</span> <span class="n">S</span><span class="o">),</span> <span class="n">p.1</span> <span class="bp">*</span> <span class="n">q.2</span> <span class="bp">≤</span> <span class="n">q.1</span> <span class="bp">*</span> <span class="n">p.2</span><span class="o">)</span> <span class="kd">begin</span>
  <span class="n">rintro</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">a'</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">b'</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">c</span><span class="o">,</span> <span class="n">c'</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">d</span><span class="o">,</span> <span class="n">d'</span><span class="o">⟩</span> <span class="n">hac</span> <span class="n">hbd</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">mul_pair_equiv_iff</span><span class="o">,</span> <span class="n">eq_iff_iff</span><span class="o">]</span> <span class="n">at</span> <span class="n">hac</span> <span class="n">hbd</span> <span class="bp">⊢</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">work_on_goal</span> <span class="mi">1</span> <span class="o">{</span> <span class="n">rename</span> <span class="o">[</span><span class="n">a</span> <span class="n">x</span><span class="o">,</span> <span class="n">a'</span> <span class="n">x'</span><span class="o">,</span> <span class="n">b</span> <span class="n">y</span><span class="o">,</span> <span class="n">b'</span> <span class="n">y'</span><span class="o">,</span> <span class="n">c</span> <span class="n">a</span><span class="o">,</span> <span class="n">c'</span> <span class="n">a'</span><span class="o">,</span> <span class="n">d</span> <span class="n">b</span><span class="o">,</span> <span class="n">d'</span> <span class="n">b'</span><span class="o">],</span>
                   <span class="n">rename</span> <span class="o">[</span><span class="n">x</span> <span class="n">c</span><span class="o">,</span> <span class="n">x'</span> <span class="n">c'</span><span class="o">,</span> <span class="n">y</span> <span class="n">d</span><span class="o">,</span> <span class="n">y'</span> <span class="n">d'</span><span class="o">],</span>
                   <span class="n">rw</span> <span class="n">eq_comm</span> <span class="n">at</span> <span class="n">hac</span> <span class="n">hbd</span> <span class="o">},</span>
  <span class="n">all_goals</span> <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">replace</span> <span class="n">h</span> <span class="o">:</span> <span class="n">c'</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b'</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">c'</span> <span class="bp">*</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">a'</span><span class="o">)</span> <span class="o">:=</span> <span class="n">homogeneity</span> <span class="n">h</span> <span class="n">c'</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">mul_assoc</span><span class="o">,</span> <span class="n">mul_comm</span> <span class="n">c'</span><span class="o">,</span> <span class="n">hac</span><span class="o">,</span> <span class="n">mul_comm</span> <span class="n">b</span><span class="o">,</span> <span class="n">mul_left_comm</span><span class="o">,</span> <span class="n">mul_assoc</span><span class="o">,</span> <span class="n">mul_left_comm</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">replace</span> <span class="n">h</span> <span class="o">:</span> <span class="n">d</span> <span class="bp">*</span> <span class="o">(</span><span class="n">c</span> <span class="bp">*</span> <span class="n">b'</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">d</span> <span class="bp">*</span> <span class="o">(</span><span class="n">c'</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="o">:=</span> <span class="n">homogeneity</span> <span class="o">(</span><span class="n">strong</span> <span class="n">h</span><span class="o">)</span> <span class="n">d</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mul_left_comm</span><span class="o">,</span> <span class="bp">←</span><span class="n">hbd</span><span class="o">,</span> <span class="n">mul_left_comm</span><span class="o">,</span> <span class="n">mul_comm</span> <span class="n">_</span> <span class="n">b</span><span class="o">,</span> <span class="n">mul_left_comm</span> <span class="n">_</span> <span class="n">b</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">strong</span> <span class="n">h</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="272741844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741844">(Feb 21 2022 at 22:44)</a>:</h4>
<p>All those <code>rename</code> use dummy <code>name</code>s, instead I should be able to just say <code>swap_var [a c, a' c', b d, b' d']</code></p>



<a name="272741852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741852">(Feb 21 2022 at 22:45)</a>:</h4>
<p>One thing I don't like about <code>swap_var</code> is that the following tactic is run twice</p>



<a name="272741883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741883">(Feb 21 2022 at 22:45)</a>:</h4>
<p>I think the docstring for <code>wlog</code> is also very daunting, it's hard to understand how to properly invoke it.</p>



<a name="272741934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741934">(Feb 21 2022 at 22:46)</a>:</h4>
<p>I think that's also a consequence of the over-generality</p>



<a name="272741937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741937">(Feb 21 2022 at 22:46)</a>:</h4>
<p>to be fair, I love <code>wlog</code> but I don't see how <code>wlog</code> could do this as concisely regardless of the slowdown:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">set_theory.cardinal_ordinal</span>
<span class="kn">import</span> <span class="n">tactic.swap_var</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">cardinal.</span><span class="o">{</span><span class="mi">0</span><span class="o">}}</span>
<span class="n">open_locale</span> <span class="n">cardinal</span>

<span class="kd">lemma</span> <span class="n">omega_le_mul_iff</span> <span class="o">:</span> <span class="n">ω</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">↔</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">b</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">ω</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">∨</span> <span class="n">ω</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">lemma</span> <span class="n">mul_eq_max'</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">ω</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">max</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rcases</span> <span class="n">omega_le_mul_iff.mp</span> <span class="n">h</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">,</span> <span class="n">h</span> <span class="bp">|</span> <span class="n">h</span><span class="o">⟩,</span>
  <span class="n">work_on_goal</span> <span class="mi">1</span> <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mul_comm</span><span class="o">,</span> <span class="n">max_comm</span><span class="o">],</span> <span class="n">swap_var</span> <span class="o">[</span><span class="n">ha</span> <span class="n">hb</span><span class="o">]</span> <span class="o">},</span>
  <span class="n">all_goals</span> <span class="o">{</span> <span class="n">exact</span> <span class="n">cardinal.mul_eq_max_of_omega_le_left</span> <span class="n">h</span> <span class="n">hb</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="272741941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741941">(Feb 21 2022 at 22:46)</a>:</h4>
<p>we should find out how people use it and trim it down if possible</p>



<a name="272741942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741942">(Feb 21 2022 at 22:46)</a>:</h4>
<p>(this came up naturally!)</p>



<a name="272741978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741978">(Feb 21 2022 at 22:47)</a>:</h4>
<p>I think we also need some version of <span class="user-mention" data-user-id="127136">@Alex J. Best</span> 's <code>may_assume</code> from flt-regular, I really like it and also is how mathematicians would write (we may assume a, b, and c are coprime, else divide through blah blah)</p>



<a name="272741979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741979">(Feb 21 2022 at 22:47)</a>:</h4>
<p>(my code is in <a href="https://github.com/leanprover-community/mathlib/tree/pechersky/nakada">branch#pechersky/nakada</a> if people want to try <code>wlog</code> with it)</p>



<a name="272741994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272741994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272741994">(Feb 21 2022 at 22:47)</a>:</h4>
<p>what are the types there? Is that in mathlib somewhere?</p>



<a name="272742098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742098">(Feb 21 2022 at 22:49)</a>:</h4>
<p>still not working <span class="user-mention" data-user-id="284160">@Eric Rodriguez</span> , you need some open locales</p>



<a name="272742190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742190">(Feb 21 2022 at 22:50)</a>:</h4>
<p>there we are, sorry, I'm getting this stuff ready for pr</p>



<a name="272742329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742329">(Feb 21 2022 at 22:52)</a>:</h4>
<p>looks like it worked "out of the box":</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">mul_eq_max'</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">ω</span> <span class="bp">≤</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">max</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rcases</span> <span class="n">omega_le_mul_iff.mp</span> <span class="n">h</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">,</span> <span class="n">h</span><span class="o">⟩,</span>
  <span class="n">wlog</span> <span class="n">h</span> <span class="o">:</span> <span class="n">ω</span> <span class="bp">≤</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">h</span> <span class="n">using</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">cardinal.mul_eq_max_of_omega_le_left</span> <span class="n">h</span> <span class="n">hb</span>
<span class="kd">end</span>
</code></pre></div>
<p>It's stupidly slow for this goal though</p>



<a name="272742433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742433">(Feb 21 2022 at 22:54)</a>:</h4>
<p>oh, I did not know you could pass it the disjunction explicitly. that would be amazing if it wasn't so incredibly slow</p>



<a name="272742464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742464">(Feb 21 2022 at 22:55)</a>:</h4>
<p>I can only surmise that it's spending that time proving the symmetry lemma</p>



<a name="272742576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742576">(Feb 21 2022 at 22:56)</a>:</h4>
<p>ahh, and it uses the smt solver for that</p>



<a name="272742583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742583">(Feb 21 2022 at 22:56)</a>:</h4>
<p>it uses <em>what</em>?</p>



<a name="272742598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742598">(Feb 21 2022 at 22:57)</a>:</h4>
<p><a href="/user_uploads/3121/wCfE8PbJEi7usGxHc06XrAsx/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/wCfE8PbJEi7usGxHc06XrAsx/image.png" title="image.png"><img src="/user_uploads/3121/wCfE8PbJEi7usGxHc06XrAsx/image.png"></a></div>



<a name="272742613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742613">(Feb 21 2022 at 22:57)</a>:</h4>
<p>well... that explains things</p>



<a name="272742628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742628">(Feb 21 2022 at 22:57)</a>:</h4>
<p>it should just be <code>simp [foo_comm]</code></p>



<a name="272742699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272742699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272742699">(Feb 21 2022 at 22:58)</a>:</h4>
<p>we have commutativity typeclasses that we could use</p>



<a name="272745663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272745663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272745663">(Feb 21 2022 at 23:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208/near/272737299">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> Yeah, I guess there is one (for nats, but not Z), and it's significantly faster.</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">mod8_odd'</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">hhi</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">(</span><span class="n">hodd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">5</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">7</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">dec_trivial</span><span class="bp">!</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div><br>
</p>
</blockquote>
<p>There is an int version (which I just found after writing my own lol), so this works fairly fast</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.parity</span>
<span class="kn">import</span> <span class="n">data.int.parity</span>
<span class="kn">import</span> <span class="n">data.int.range</span>

<span class="c1">-- set_option trace.class_instances true</span>
<span class="kd">set_option</span> <span class="n">profiler</span> <span class="n">true</span>
<span class="kd">lemma</span> <span class="n">mod8_odd</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hlo</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hhi</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">&lt;</span> <span class="mi">8</span><span class="o">)</span> <span class="o">(</span><span class="n">hodd</span> <span class="o">:</span> <span class="n">odd</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">5</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">7</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">dec_trivial</span><span class="bp">!</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="272745918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272745918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272745918">(Feb 21 2022 at 23:52)</a>:</h4>
<p>Sorry, I didn't spend really any time playing guess-the-import!</p>



<a name="272812588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Odd%20residues%20mod%208/near/272812588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Odd.20residues.20mod.208.html#272812588">(Feb 22 2022 at 14:48)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span> Great!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>