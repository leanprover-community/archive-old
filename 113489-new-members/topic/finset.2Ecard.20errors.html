---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/finset.2Ecard.20errors.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html">finset.card errors</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="201436703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201436703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201436703">(Jun 19 2020 at 20:29)</a>:</h4>
<p>I'm confused by the error messages I get from the following examples. Namely <code>invalid field notation, type is not of the form (C ...)</code> on the <code>.card</code>.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">geometry</span><span class="bp">.</span><span class="n">euclidean</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">finset</span>

<span class="n">def</span> <span class="n">x</span> <span class="o">:</span> <span class="n">finset</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}</span>
<span class="kn">example</span> <span class="o">:</span> <span class="n">x</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">exact</span> <span class="n">le_refl</span> <span class="mi">3</span><span class="o">,</span>
<span class="kn">end</span>


<span class="kn">example</span> <span class="o">:</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">metric_space</span> <span class="n">M</span><span class="o">]</span> <span class="o">(</span><span class="n">y1</span> <span class="n">y2</span> <span class="n">y3</span> <span class="o">:</span> <span class="n">M</span><span class="o">)</span>

<span class="kn">example</span> <span class="o">:</span> <span class="o">{</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="n">def</span> <span class="n">y</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">M</span> <span class="o">:=</span> <span class="o">{</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">y</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="201436965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201436965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201436965">(Jun 19 2020 at 20:32)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">:</span> <span class="o">({</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="bp">ℕ</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="201436995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201436995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201436995">(Jun 19 2020 at 20:32)</a>:</h4>
<p>Lean can not guess that you are working with a finset.</p>



<a name="201437473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201437473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201437473">(Jun 19 2020 at 20:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110050">Sebastien Gouezel</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201436995">said</a>:</p>
<blockquote>
<p>Lean can not guess that you are working with a finset.</p>
</blockquote>
<p>Oh that makes sense. Thanks!</p>



<a name="201438046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201438046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201438046">(Jun 19 2020 at 20:44)</a>:</h4>
<p>Ok with that modification I'm able to resolve the second example but the last two still aren't working for me. I'm confused why <code>card</code> seems to like the size of a nat finset is obvious but not for a finset using elements of  a metric space. </p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">geometry</span><span class="bp">.</span><span class="n">euclidean</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">finset</span>

<span class="n">def</span> <span class="n">x</span> <span class="o">:</span> <span class="n">finset</span> <span class="bp">ℕ</span> <span class="o">:=</span> <span class="o">{</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}</span>
<span class="kn">example</span> <span class="o">:</span> <span class="n">x</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">exact</span> <span class="n">le_refl</span> <span class="mi">3</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">:</span> <span class="o">({</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="bp">ℕ</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">exact</span> <span class="n">le_refl</span> <span class="mi">3</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">metric_space</span> <span class="n">M</span><span class="o">]</span> <span class="o">(</span><span class="n">y1</span> <span class="n">y2</span> <span class="n">y3</span> <span class="o">:</span> <span class="n">M</span><span class="o">)</span>

<span class="kn">example</span> <span class="o">:</span> <span class="o">({</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">M</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span> <span class="k">begin</span>
  <span class="n">exact</span> <span class="n">le_refl</span> <span class="mi">3</span><span class="o">,</span>
<span class="kn">end</span>

<span class="n">def</span> <span class="n">y</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">M</span> <span class="o">:=</span> <span class="o">{</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">y</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≥</span> <span class="mi">3</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="201438166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201438166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201438166">(Jun 19 2020 at 20:45)</a>:</h4>
<p>You need decidable equality on M to work with finsets</p>



<a name="201438228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201438228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201438228">(Jun 19 2020 at 20:46)</a>:</h4>
<p>you can't insert constructively unless you have an algorithm for working out whether the new element is already in</p>



<a name="201439333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201439333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201439333">(Jun 19 2020 at 20:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201438228">said</a>:</p>
<blockquote>
<p>you can't insert constructively unless you have an algorithm for working out whether the new element is already in</p>
</blockquote>
<p>How would I assert decidable equality on M and build an algorithm for appending new elements to a finset? This is in the context of euclidean geoemtry, so I don't think either of those would be an issue.</p>



<a name="201439379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201439379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201439379">(Jun 19 2020 at 20:59)</a>:</h4>
<p>Either <code>[decidable_eq M]</code> everywhere, or <code>open_locale classical</code> at the top.</p>



<a name="201439492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201439492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201439492">(Jun 19 2020 at 21:00)</a>:</h4>
<p>It's completely daft that this fails; the set is obviously finite, you won't be able to work out its size but that shouldn't stop you making it.</p>



<a name="201440170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201440170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201440170">(Jun 19 2020 at 21:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201439492">said</a>:</p>
<blockquote>
<p>It's completely daft that this fails; the set is obviously finite, you won't be able to work out its size but that shouldn't stop you making it.</p>
</blockquote>
<p>I'm getting the same errors with <code>open_locale classical</code> and with <code>[decidable_eq M]</code>. </p>
<p>I was trying to prove some geometry theorems and wanted a way to pass a certain number of points without having to specify an order.  Finsets seemed like a good choice because they provided an easy way to enforce the condition of the points being distinct. Maybe this isn't worth it though if finsets don't have this kind of machinery built in yet.</p>



<a name="201440388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201440388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201440388">(Jun 19 2020 at 21:10)</a>:</h4>
<p>you don't have hypotheses that that the <code>y</code> are distinct anywhere, so your last examples just aren't true</p>



<a name="201441032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201441032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201441032">(Jun 19 2020 at 21:16)</a>:</h4>
<p>This works</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">finset</span>

<span class="n">noncomputable</span> <span class="n">theory</span>
<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kn">example</span>
<span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">y1</span> <span class="n">y2</span> <span class="n">y3</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span>
<span class="o">(</span><span class="n">h12</span> <span class="o">:</span> <span class="n">y1</span> <span class="bp">≠</span> <span class="n">y2</span><span class="o">)</span> <span class="o">(</span><span class="n">h13</span> <span class="o">:</span> <span class="n">y1</span> <span class="bp">≠</span> <span class="n">y3</span><span class="o">)</span> <span class="o">(</span><span class="n">h23</span> <span class="o">:</span> <span class="n">y2</span> <span class="bp">≠</span> <span class="n">y3</span><span class="o">)</span> <span class="o">:</span>
<span class="o">({</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="n">finset</span><span class="bp">.</span><span class="n">card_insert_of_not_mem</span><span class="o">,</span>
  <span class="n">swap</span><span class="o">,</span> <span class="o">{</span> <span class="n">simp</span><span class="bp">;</span> <span class="n">cc</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="n">finset</span><span class="bp">.</span><span class="n">card_insert_of_not_mem</span><span class="o">,</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="n">simpa</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="201441096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201441096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201441096">(Jun 19 2020 at 21:17)</a>:</h4>
<p><code>finish</code> can do it, though it's a touch slow</p>



<a name="201442229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201442229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201442229">(Jun 19 2020 at 21:30)</a>:</h4>
<p>here's "the right proof" for the case where you don't know they're equal</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">finset</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="n">noncomputable</span> <span class="n">theory</span>
<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">y1</span> <span class="n">y2</span> <span class="n">y3</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">:</span>
<span class="o">({</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">≤</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">list</span><span class="bp">.</span><span class="n">to_finset</span> <span class="o">[</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">]</span> <span class="bp">=</span> <span class="o">({</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">list</span><span class="bp">.</span><span class="n">to_finset_card_le</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="201442385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201442385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201442385">(Jun 19 2020 at 21:32)</a>:</h4>
<p>here it is for the case where you know they're distinct</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">y1</span> <span class="n">y2</span> <span class="n">y3</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span>
<span class="o">(</span><span class="n">h12</span> <span class="o">:</span> <span class="n">y1</span> <span class="bp">≠</span> <span class="n">y2</span><span class="o">)</span> <span class="o">(</span><span class="n">h13</span> <span class="o">:</span> <span class="n">y1</span> <span class="bp">≠</span> <span class="n">y3</span><span class="o">)</span> <span class="o">(</span><span class="n">h23</span> <span class="o">:</span> <span class="n">y2</span> <span class="bp">≠</span> <span class="n">y3</span><span class="o">)</span> <span class="o">:</span>
<span class="o">({</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">list</span><span class="bp">.</span><span class="n">to_finset</span> <span class="o">[</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">]</span> <span class="bp">=</span> <span class="o">({</span><span class="n">y1</span><span class="o">,</span> <span class="n">y2</span><span class="o">,</span> <span class="n">y3</span><span class="o">}</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">list</span><span class="bp">.</span><span class="n">to_finset_card_of_nodup</span><span class="o">,</span>
  <span class="n">simp</span><span class="bp">;</span> <span class="n">cc</span>
<span class="kn">end</span>
</code></pre></div>



<a name="201513548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201513548" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201513548">(Jun 21 2020 at 03:18)</a>:</h4>
<p>That makes sense. The way finset is implemented is pretty unintuitive to me but this has helped a lot.</p>



<a name="201616084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201616084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201616084">(Jun 22 2020 at 14:56)</a>:</h4>
<p>Ok what if I have a finset <code>{y1, y2, y3}</code> and a proof <code>h : y1 = y3</code>. How could I use that to show <code>{y1, y2, y3}.card = 2</code>? It seems like there's no <code>finset.card_insert_of_mem</code> along with <code>finset.card_insert_of_not_mem</code></p>



<a name="201616176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201616176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201616176">(Jun 22 2020 at 14:57)</a>:</h4>
<p><code>finset.card_insert</code> should exist</p>



<a name="201617412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201617412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201617412">(Jun 22 2020 at 15:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="261068">ROCKY KAMEN-RUBIO</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201616084">said</a>:</p>
<blockquote>
<p>Ok what if I have a finset <code>{y1, y2, y3}</code> and a proof <code>h : y1 = y3</code>. How could I use that to show <code>{y1, y2, y3}.card = 2</code>? It seems like there's no <code>finset.card_insert_of_mem</code> along with <code>finset.card_insert_of_not_mem</code></p>
</blockquote>
<p>Your statement is very close to a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>. If you wrap your question in an <code>example</code> and add the appropriate imports, you'll get more useful answers more quickly.</p>



<a name="201617539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201617539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201617539">(Jun 22 2020 at 15:07)</a>:</h4>
<p>The cardinality could be 1</p>



<a name="201617894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201617894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201617894">(Jun 22 2020 at 15:10)</a>:</h4>
<p>it's easier to notice your theorem is false after you formalize the statement. (probably the theorem you want is to replace <code>=</code> with <code>\le</code>)</p>



<a name="201619017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201619017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201619017">(Jun 22 2020 at 15:19)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">finset</span>

<span class="kn">namespace</span> <span class="n">finset</span>

<span class="kn">lemma</span> <span class="n">finset</span><span class="bp">.</span><span class="n">card_insert_of_mem</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="err">∈</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">insert</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span> <span class="n">s</span><span class="bp">.</span><span class="n">card</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">insert_eq_of_mem</span> <span class="n">h</span>

<span class="kn">end</span> <span class="n">finset</span>
</code></pre></div>



<a name="201619278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201619278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201619278">(Jun 22 2020 at 15:21)</a>:</h4>
<p>we have been so familiarized with indeterminates (like x y z in polynomials) that we automatically assume y1 y2 y3 are distinct</p>



<a name="201619598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201619598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201619598">(Jun 22 2020 at 15:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201617539">said</a>:</p>
<blockquote>
<p>The cardinality could be 1</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="252300">Jalex Stark</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201617894">said</a>:</p>
<blockquote>
<p>it's easier to notice your theorem is false after you formalize the statement. (probably the theorem you want is to replace <code>=</code> with <code>\le</code>)</p>
</blockquote>
<p>Yes! Thanks for catching that. Either that the finset is <code>\le</code> 2, or that it is 2 and we're given a proof that <code>y1 \ne y2</code>.</p>



<a name="201619812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201619812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201619812">(Jun 22 2020 at 15:24)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/3137">#3137</a></p>



<a name="201620086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201620086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201620086">(Jun 22 2020 at 15:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201619812">said</a>:</p>
<blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/issues/3137">#3137</a></p>
</blockquote>
<p>Cool!</p>



<a name="201620666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201620666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201620666">(Jun 22 2020 at 15:30)</a>:</h4>
<p>Note that it follows trivially from the stronger statement that if a \in s then <code>insert a s = s</code>, which is <code>insert_eq_of_mem</code>.</p>



<a name="201630635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201630635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201630635">(Jun 22 2020 at 16:44)</a>:</h4>
<p>How often do these get built? I'll just use <code>insert_eq_of_mem</code> for now and get back periodically.</p>



<a name="201636013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201636013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201636013">(Jun 22 2020 at 17:27)</a>:</h4>
<p>You can watch the PR. Assuming it's uncontroversial, it might well be merged today, and then if you do <code>leanproject up</code> you'll have access to it. Just wait for the green "open" thing to change to a purple "merged"</p>



<a name="201636385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201636385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201636385">(Jun 22 2020 at 17:31)</a>:</h4>
<p>some PR's can take weeks or months, if they're complicated, or half-ready and then the person working on them has to stop to work on other things. For a PR like this, there are two possibilities -- either it gets shooed through, or I'm told that the lemma shouldn't be in the library because it's a trivial consequence of a stronger lemma which is already there, namely <code>insert_eq_of_mem</code>. </p>
<p>If you want to be a pro, then you can just use it now. I pushed to the <code>card-insert-of-mem</code> branch of mathlib, so you can just checkout that branch, use <code>leanproject up</code> to get the olean files (they have been made, because it says "all checks have passed" on the PR page) and then you have it. But then you have to be careful to sort things out again properly when it gets merged into master (and of course if it doesn't get merged then you will have to unravel everything).</p>



<a name="201642903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201642903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201642903">(Jun 22 2020 at 18:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201636385">said</a>:</p>
<blockquote>
<p>some PR's can take weeks or months, if they're complicated, or half-ready and then the person working on them has to stop to work on other things. For a PR like this, there are two possibilities -- either it gets shooed through, or I'm told that the lemma shouldn't be in the library because it's a trivial consequence of a stronger lemma which is already there, namely <code>insert_eq_of_mem</code>. </p>
<p>If you want to be a pro, then you can just use it now. I pushed to the <code>card-insert-of-mem</code> branch of mathlib, so you can just checkout that branch, use <code>leanproject up</code> to get the olean files (they have been made, because it says "all checks have passed" on the PR page) and then you have it. But then you have to be careful to sort things out again properly when it gets merged into master (and of course if it doesn't get merged then you will have to unravel everything).</p>
</blockquote>
<p>Cool! This is insightful. I think I'll just wait and update mathlib; I think changing my mathlib dependencies is ultimately going to be more difficult than refactoring my code with the update.</p>



<a name="201644641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201644641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201644641">(Jun 22 2020 at 18:41)</a>:</h4>
<p>The magic command that Kevin wanted to mention is <code>leanproject get mathlib:card-insert-of-mem</code></p>



<a name="201644806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201644806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201644806">(Jun 22 2020 at 18:42)</a>:</h4>
<p>As usual, there is a problem with my two-line PR ;-)</p>



<a name="201672524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201672524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201672524">(Jun 22 2020 at 23:16)</a>:</h4>
<p>Ok <span class="user-mention" data-user-id="261068">@ROCKY KAMEN-RUBIO</span> if you type <code>leanproject up</code> you can use the lemma now without switching branches or doing any other git weirdness</p>



<a name="201773136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/finset.card%20errors/near/201773136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> ROCKY KAMEN-RUBIO <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/finset.2Ecard.20errors.html#201773136">(Jun 23 2020 at 19:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/finset.2Ecard.20errors/near/201672524">said</a>:</p>
<blockquote>
<p>Ok <span class="user-mention silent" data-user-id="261068">ROCKY KAMEN-RUBIO</span> if you type <code>leanproject up</code> you can use the lemma now without switching branches or doing any other git weirdness</p>
</blockquote>
<p>Amazing, thank you!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>