---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html">rewrite in one location only</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="213380201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rewrite%20in%20one%20location%20only/near/213380201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Beeson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html#213380201">(Oct 15 2020 at 04:50)</a>:</h4>
<p>If  an equation could be applied in two different locations and I want to rewrite at only one of them how do I accomplish that?</p>



<a name="213380385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rewrite%20in%20one%20location%20only/near/213380385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html#213380385">(Oct 15 2020 at 04:54)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rw</span> <span class="o">[</span><span class="n">foo</span><span class="o">,</span> <span class="n">bar</span><span class="o">]</span> <span class="o">{</span> <span class="n">occs</span> <span class="o">:=</span> <span class="n">occurence.pos</span> <span class="o">[</span><span class="mi">42</span><span class="o">]</span> <span class="o">}</span>
</code></pre></div>

<p>will only rewrite <code>foo</code> and <code>bar</code> at the 42nd occurence. (<span class="user-mention" data-user-id="284844">@Michael Beeson</span>)</p>



<a name="213380391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rewrite%20in%20one%20location%20only/near/213380391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html#213380391">(Oct 15 2020 at 04:54)</a>:</h4>
<p>There are a few ways:</p>
<ul>
<li>There's a mathlib tactic <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#nth_rewrite%20/%20nth_rewrite_lhs%20/%20nth_rewrite_rhs">nth_rewrite</a></li>
<li>You can go into <a href="https://leanprover-community.github.io/extras/conv.html"><code>conv</code> mode</a></li>
<li>You can pass an <code>occs</code> option to <code>rw</code> (I don't fully understand the syntax, but see <a href="#narrow/stream/113489-new-members/topic/Sam.20Estep/near/201095954">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/Sam.20Estep/near/201095954</a>)</li>
</ul>



<a name="213382923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rewrite%20in%20one%20location%20only/near/213382923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html#213382923">(Oct 15 2020 at 06:00)</a>:</h4>
<p>I can never remember the syntax for occs either, maybe it should be in the conv docs or maybe there should be a brief rewrite doc? Oh how about an occs example in the docstring for rw? Maybe that's the place for these hints?</p>



<a name="213383059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rewrite%20in%20one%20location%20only/near/213383059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html#213383059">(Oct 15 2020 at 06:03)</a>:</h4>
<p>I think <a href="https://github.com/leanprover-community/mathlib/blob/265c587e0d416bf9d6dc7bf50f5d5da5351f485e/src/tactic/lean_core_docs.lean#L532">the tactic doc entry for <code>rw / rewrite</code></a> would be a good spot. It would also be convenient to put in the docstrings for <code>rw</code> and <code>rewrite</code>, too.</p>



<a name="213383235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rewrite%20in%20one%20location%20only/near/213383235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html#213383235">(Oct 15 2020 at 06:07)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> just a small typo in your code: I liked it so much that I wanted to try it out!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rw</span> <span class="o">[</span><span class="n">foo</span><span class="o">,</span> <span class="n">bar</span><span class="o">]</span> <span class="o">{</span> <span class="n">occs</span> <span class="o">:=</span> <span class="n">occurrences.pos</span> <span class="o">[</span><span class="mi">42</span><span class="o">]</span> <span class="o">}</span>
</code></pre></div>



<a name="213383338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rewrite%20in%20one%20location%20only/near/213383338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html#213383338">(Oct 15 2020 at 06:09)</a>:</h4>
<p>Thanks, I'll fix it.</p>



<a name="213405900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rewrite%20in%20one%20location%20only/near/213405900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rewrite.20in.20one.20location.20only.html#213405900">(Oct 15 2020 at 10:33)</a>:</h4>
<p>Be careful --- <code>occs</code> will not work/count correctly if there are multiple places where an <em>identical</em> rewrite can occur. For this you need <code>nth_rewrite</code>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>