---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html">Splitting `[fintype n] (v: n → R)` into a sum of basis elems</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="217382192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217382192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217382192">(Nov 20 2020 at 10:12)</a>:</h4>
<p>I'm trying to prove</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">is_sym_to_matrix</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">n</span><span class="o">]</span>
  <span class="o">(</span><span class="n">B</span> <span class="o">:</span> <span class="n">bilin_form</span> <span class="n">R</span> <span class="o">(</span><span class="n">n</span> <span class="bp">→</span> <span class="n">R</span><span class="o">))</span> <span class="o">:</span> <span class="n">is_sym</span> <span class="n">B</span> <span class="bp">↔</span> <span class="n">B.to_matrix</span> <span class="bp">=</span> <span class="n">B.to_matrix.transpose</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">dunfold</span> <span class="n">is_sym</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">ext</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">bilin_form.to_matrix_apply</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">h</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">h</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
    <span class="n">dunfold</span> <span class="n">bilin_form.to_matrix</span> <span class="n">bilin_form.to_matrixₗ</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span><span class="n">matrix.ext_iff</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">sorry</span><span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">h</span><span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span>
  <span class="bp">⇑</span><span class="n">B</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">n_1</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">ite</span> <span class="o">(</span><span class="n">n_1</span> <span class="bp">=</span> <span class="n">i</span><span class="o">)</span> <span class="mi">1</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">n_1</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">ite</span> <span class="o">(</span><span class="n">n_1</span> <span class="bp">=</span> <span class="n">j</span><span class="o">)</span> <span class="mi">1</span> <span class="mi">0</span><span class="o">)</span> <span class="bp">=</span>
  <span class="bp">⇑</span><span class="n">B</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">n_1</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">ite</span> <span class="o">(</span><span class="n">n_1</span> <span class="bp">=</span> <span class="n">j</span><span class="o">)</span> <span class="mi">1</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">n_1</span> <span class="o">:</span> <span class="n">n</span><span class="o">),</span> <span class="n">ite</span> <span class="o">(</span><span class="n">n_1</span> <span class="bp">=</span> <span class="n">i</span><span class="o">)</span> <span class="mi">1</span> <span class="mi">0</span><span class="o">)</span>
<span class="bp">⊢</span> <span class="bp">⇑</span><span class="n">B</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">=</span> <span class="bp">⇑</span><span class="n">B</span> <span class="n">y</span> <span class="n">x</span>
</code></pre></div>
<p>I'm aware that I may have unfolded too much here - but it looks like I should be able to proceed by expressing <code>x</code> and <code>y</code> as a sum of scaled basis elements, applying linearity of B in both arguments, and then applying <code>h</code> to each of my n^2 terms&gt;</p>
<p>What I don't know how to do is the re-expressing of <code>x</code> and <code>y</code></p>



<a name="217382344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217382344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217382344">(Nov 20 2020 at 10:13)</a>:</h4>
<p>Something like <code>rw ← is_basis.total_repr</code> IIRC?</p>



<a name="217382874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217382874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217382874">(Nov 20 2020 at 10:18)</a>:</h4>
<p>That looks like the lemma, and I guess now I need to find the lemma saying that <code>is_basis R $ λ (i n_1 : n), ite (n_1 = i) (1 : R) 0</code>- since surely that exists</p>



<a name="217405306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217405306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217405306">(Nov 20 2020 at 14:12)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mwe.html">#mwe</a></p>



<a name="217405337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217405337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217405337">(Nov 20 2020 at 14:12)</a>:</h4>
<p>(missing imports)</p>



<a name="217489614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217489614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217489614">(Nov 21 2020 at 07:27)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.bilinear_form</span>

<span class="kd">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">namespace</span> <span class="n">bilin_form</span>

<span class="kd">@[simps]</span> <span class="kd">def</span> <span class="n">flip</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span>
  <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">bilin_form</span> <span class="n">R</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span> <span class="n">bilin_form</span> <span class="n">R</span> <span class="n">M</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">bilin</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">b</span> <span class="n">y</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">bilin_add_left</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">,</span> <span class="n">add_right</span> <span class="n">z</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
  <span class="n">bilin_smul_left</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">smul_right</span> <span class="n">a</span> <span class="n">y</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">bilin_add_right</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">,</span> <span class="n">add_left</span> <span class="n">y</span> <span class="n">z</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">bilin_smul_right</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">smul_left</span> <span class="n">a</span> <span class="n">y</span> <span class="n">x</span> <span class="o">}</span>

<span class="kd">lemma</span> <span class="n">to_matrix_flip</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">n</span><span class="o">]</span>
  <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">bilin_form</span> <span class="n">R</span> <span class="o">(</span><span class="n">n</span> <span class="bp">→</span> <span class="n">R</span><span class="o">))</span> <span class="o">:</span> <span class="n">b.flip.to_matrix</span> <span class="bp">=</span> <span class="n">b.to_matrix.transpose</span> <span class="o">:=</span>
<span class="n">rfl</span>

<span class="kd">end</span> <span class="n">bilin_form</span>

<span class="kn">open</span> <span class="n">bilin_form</span> <span class="n">sym_bilin_form</span>

<span class="kd">lemma</span> <span class="n">is_sym_to_matrix</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">n</span><span class="o">]</span>
  <span class="o">(</span><span class="n">B</span> <span class="o">:</span> <span class="n">bilin_form</span> <span class="n">R</span> <span class="o">(</span><span class="n">n</span> <span class="bp">→</span> <span class="n">R</span><span class="o">))</span> <span class="o">:</span> <span class="n">is_sym</span> <span class="n">B</span> <span class="bp">↔</span> <span class="n">B.to_matrix</span> <span class="bp">=</span> <span class="n">B.to_matrix.transpose</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">dunfold</span> <span class="n">is_sym</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">ext</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">bilin_form.to_matrix_apply</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">h</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">h</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
    <span class="n">replace</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">congr_arg</span> <span class="n">matrix.to_bilin_form</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">to_matrix_flip</span><span class="o">,</span> <span class="n">to_matrix_to_bilin_form</span><span class="o">,</span> <span class="n">to_matrix_to_bilin_form</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">flip_bilin</span><span class="o">,</span> <span class="bp">←</span> <span class="n">h</span><span class="o">]</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="217490182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217490182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217490182">(Nov 21 2020 at 07:49)</a>:</h4>
<p>I think we should also have <code>def matrix.is_sym</code></p>



<a name="217490183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217490183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217490183">(Nov 21 2020 at 07:49)</a>:</h4>
<p>And don't we already have a <code>linear_map.flip</code>?</p>



<a name="217491259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217491259" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217491259">(Nov 21 2020 at 08:24)</a>:</h4>
<p><code>bilin_form</code> isn't defined to be a <code>linear_map</code></p>



<a name="217491700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217491700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217491700">(Nov 21 2020 at 08:39)</a>:</h4>
<p>Ooh, me needs to learn what <a href="https://leanprover-community.github.io/mathlib_docs/find/bilin_form">docs#bilin_form</a> is</p>



<a name="217493551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Splitting%20%60%5Bfintype%20n%5D%20%28v%3A%20n%20%E2%86%92%20R%29%60%20into%20a%20sum%20of%20basis%20elems/near/217493551" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Splitting.20.60.5Bfintype.20n.5D.20(v.3A.20n.20.E2.86.92.20R).60.20into.20a.20sum.20of.20basis.20elems.html#217493551">(Nov 21 2020 at 09:33)</a>:</h4>
<p>The <code>rfl</code> in <code>to_matrix_flip</code> surprises me slightly, as rfls often do. Thanks <span class="user-mention" data-user-id="110064">@Kenny Lau</span>!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>