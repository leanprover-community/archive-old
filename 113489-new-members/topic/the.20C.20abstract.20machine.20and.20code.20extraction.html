---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html">the C abstract machine and code extraction</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="241409214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241409214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241409214">(Jun 03 2021 at 15:40)</a>:</h4>
<p>Is it possible to implement the C abstract machine with inductive types? Where can I get started? I want to be able to reason about C programs and I'm willing to put in some work to formalize C semantics.</p>



<a name="241409499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241409499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241409499">(Jun 03 2021 at 15:42)</a>:</h4>
<p>As a side note: I'm really infatuated with inductive types since they can be used to formalize many models. They are just so powerful.</p>



<a name="241409916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241409916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241409916">(Jun 03 2021 at 15:45)</a>:</h4>
<p>You might be interested in Mario's mm0 and mm1</p>



<a name="241409963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241409963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241409963">(Jun 03 2021 at 15:45)</a>:</h4>
<p>Then you don't have to implement everything yourself. But you don't get 100% pure C</p>



<a name="241410197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241410197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241410197">(Jun 03 2021 at 15:47)</a>:</h4>
<p>Thanks. But how does that relate to my question though? I thought mm0 was just an insanely fast verifier that is incredibly, incredibly low level and had nothing to do with formalizing C semantics.</p>



<a name="241410441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241410441" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241410441">(Jun 03 2021 at 15:49)</a>:</h4>
<p>It might help to think about the type of statement you want to formalize</p>



<a name="241412788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241412788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241412788">(Jun 03 2021 at 16:06)</a>:</h4>
<p>Actually I've been building a verified compiler for a <a href="https://github.com/digama0/mm0/blob/master/mm0-rs/mmc.md">C-like language</a> in mm0. But probably a closer match to your question is <a href="https://github.com/AbsInt/CompCert">CompCert</a>, which formalized (most of) the semantics of C inside Coq and built a verified compiler for it. I got some ways through <a href="https://github.com/digama0/kremlin">porting it to lean</a> many years ago</p>



<a name="241413126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241413126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241413126">(Jun 03 2021 at 16:08)</a>:</h4>
<p>I also object to "incredibly, incredibly low level". It's somewhat low level but quite a bit higher level than metamath</p>



<a name="241413262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241413262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241413262">(Jun 03 2021 at 16:09)</a>:</h4>
<p>and in principle the only thing stopping it from being even more usable is more UX work that I don't have the time to work on since it's basically a one man project right now</p>



<a name="241433645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241433645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241433645">(Jun 03 2021 at 18:35)</a>:</h4>
<p>Maybe the IMP chapter from software foundations would be a lighter introduction to this? It walks you through representing a basic imperative language in Coq and proving stuff about the behaviour of programs in it.</p>



<a name="241442071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241442071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241442071">(Jun 03 2021 at 19:40)</a>:</h4>
<p>There's also the new-ish SF volume "Verifiable C": <a href="https://softwarefoundations.cis.upenn.edu/vc-current/index.html">https://softwarefoundations.cis.upenn.edu/vc-current/index.html</a>. It uses coq, but it's probably a pretty good on-ramp for reasoning about C in a CiC-flavored ITP. Volume 6  was just released, and is about seapration logic, which might be of interest as well.</p>



<a name="241468693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241468693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241468693">(Jun 03 2021 at 23:19)</a>:</h4>
<p>I learnt a lot about lean by doing all the exercises from the first volume of that series in Lean.</p>



<a name="241482054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241482054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241482054">(Jun 04 2021 at 01:42)</a>:</h4>
<p>(removed)</p>



<a name="241484076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241484076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241484076">(Jun 04 2021 at 02:24)</a>:</h4>
<p>(removed)</p>



<a name="241488939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241488939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241488939">(Jun 04 2021 at 04:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction/near/241412788">said</a>:</p>
<blockquote>
<p>Actually I've been building a verified compiler for a <a href="https://github.com/digama0/mm0/blob/master/mm0-rs/mmc.md">C-like language</a> in mm0. But probably a closer match to your question is <a href="https://github.com/AbsInt/CompCert">CompCert</a>, which formalized (most of) the semantics of C inside Coq and built a verified compiler for it. I got some ways through <a href="https://github.com/digama0/kremlin">porting it to lean</a> many years ago</p>
</blockquote>
<p>Is the code for an older version of Lean? I just cloned the Lean port and the code doesn't seem to work...</p>



<a name="241488950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241488950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241488950">(Jun 04 2021 at 04:04)</a>:</h4>
<p>And by "work" I mean the code verifies cleanly</p>



<a name="241488996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241488996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241488996">(Jun 04 2021 at 04:05)</a>:</h4>
<p>This is what I am seeing: <a href="/user_uploads/3121/EihWNTbyD8VlWi3T1oEPM6YE/Screenshot-from-2021-06-04-11-05-21.png">Screenshot-from-2021-06-04-11-05-21.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/EihWNTbyD8VlWi3T1oEPM6YE/Screenshot-from-2021-06-04-11-05-21.png" title="Screenshot-from-2021-06-04-11-05-21.png"><img src="/user_uploads/3121/EihWNTbyD8VlWi3T1oEPM6YE/Screenshot-from-2021-06-04-11-05-21.png"></a></div>



<a name="241489207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241489207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241489207">(Jun 04 2021 at 04:09)</a>:</h4>
<p>Since the latest timestamp in Mario's repo is from early Jun 2017, I suspect that the code only works with Lean 3.1.0: <a href="https://github.com/leanprover/lean/releases">https://github.com/leanprover/lean/releases</a></p>



<a name="241489291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241489291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241489291">(Jun 04 2021 at 04:11)</a>:</h4>
<p>The data.nat.bquant looks like the code is written for Lean 2 though. Let me rollback to Lean 2 and see if the code works or not.</p>



<a name="241489449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241489449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huỳnh Trần Khanh <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241489449">(Jun 04 2021 at 04:14)</a>:</h4>
<p>Oh, and I have to install Emacs. The horror!</p>



<a name="241489588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241489588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241489588">(Jun 04 2021 at 04:17)</a>:</h4>
<p>I think you're right,<code>data.nat.bquant</code> was already moved to <code>old_library</code> in even in Lean 3.0.0: <a href="https://github.com/leanprover/lean/blob/dae1c9dac28d1db1865ae2b1b3a39408b8ee5504/old_library/data/nat/bquant.lean">https://github.com/leanprover/lean/blob/dae1c9dac28d1db1865ae2b1b3a39408b8ee5504/old_library/data/nat/bquant.lean</a></p>



<a name="241507076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241507076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241507076">(Jun 04 2021 at 08:50)</a>:</h4>
<p>I'm pretty sure it is lean 3 code, not lean 2, although like Bryan says it's quite old</p>



<a name="241507249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241507249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241507249">(Jun 04 2021 at 08:53)</a>:</h4>
<p>But there are very few proofs outside a few files, it's mostly defining inductive types and I think the syntax for that is still basically the same, so updating the project shouldn't be too bad</p>



<a name="241507284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/the%20C%20abstract%20machine%20and%20code%20extraction/near/241507284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/the.20C.20abstract.20machine.20and.20code.20extraction.html#241507284">(Jun 04 2021 at 08:53)</a>:</h4>
<p>just remove the imports of nonexisting files</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>