---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html">Modules with no 6-torsion</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="221370332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221370332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221370332">(Jan 01 2021 at 21:40)</a>:</h4>
<p>Hello,</p>
<p>I'm trying to define a class of objects with a number of properties, one of which is that they are modules with no  6-torsion (i.e 6•a=0 implies a=0). This is the definition I'm using:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module</span>

<span class="kd">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>  <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>

<span class="kd">class</span> <span class="n">nosixtorsion</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">A</span><span class="o">]</span> <span class="kd">extends</span> <span class="n">semimodule</span> <span class="n">R</span> <span class="n">A</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">no_6_torsion</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span><span class="o">),</span> <span class="mi">6</span><span class="bp">•</span><span class="n">a</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="n">a</span><span class="bp">=</span><span class="mi">0</span><span class="o">)</span>
</code></pre></div>
<p>(I've removed the other properties for clarity)</p>
<p>I'd like to be able to show that subobjects of this class also have the no 6-torsion property. Using the mathlib code for Lie sub-algebras as a guide, I've tried this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">namespace</span> <span class="n">nosixtorsion</span>

<span class="kd">set_option</span> <span class="n">old_structure_cmd</span> <span class="n">true</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">nosixtorsion</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>

<span class="kd">structure</span> <span class="n">subnosixtorsion</span> <span class="kd">extends</span> <span class="n">submodule</span> <span class="n">R</span> <span class="n">A</span>

<span class="kn">attribute</span> <span class="o">[</span><span class="n">nolint</span> <span class="n">doc_blame</span><span class="o">]</span> <span class="n">subnosixtorsion.to_submodule</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">has_coe</span> <span class="o">(</span><span class="n">subnosixtorsion</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">set</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">subnosixtorsion.carrier</span><span class="o">⟩</span>
<span class="kd">instance</span> <span class="o">:</span> <span class="n">has_mem</span> <span class="n">A</span> <span class="o">(</span><span class="n">subnosixtorsion</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">a</span> <span class="n">A'</span><span class="o">,</span> <span class="n">a</span> <span class="bp">∈</span> <span class="o">(</span><span class="n">A'</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">)⟩</span>

<span class="kd">instance</span> <span class="n">subnosixtorsion_coe_submodule</span> <span class="o">:</span> <span class="n">has_coe</span> <span class="o">(</span><span class="n">subnosixtorsion</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">(</span><span class="n">submodule</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">subnosixtorsion.to_submodule</span><span class="o">⟩</span>

<span class="kd">instance</span> <span class="n">submodule_nosixtorsion</span> <span class="o">(</span><span class="n">A'</span> <span class="o">:</span> <span class="n">subnosixtorsion</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">nosixtorsion</span> <span class="n">R</span> <span class="n">A'</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">no_6_torsion</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">introv</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">set_coe.ext</span><span class="o">,</span>
    <span class="n">no_6_torsion</span> <span class="n">a</span> <span class="n">h</span>
  <span class="kd">end</span>
<span class="o">}</span>

<span class="kd">end</span> <span class="n">nosixtorsion</span>
</code></pre></div>
<p>(again, the other properties have been removed for clarity). However, Lean describes <code>a</code> and <code>h</code> as unknown identifiers.</p>
<p>Despite staring at this all evening, I can't see how to complete the proof. Perhaps there is a better way of implementing the property of not having torsion?</p>
<p>Thanks,</p>
<p>Christopher</p>



<a name="221370629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221370629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221370629">(Jan 01 2021 at 21:49)</a>:</h4>
<p>You are calling <code>no_6_torsion</code> as a tactic, which will give bad error messages. You need something like <code>exact no_6_torsion ...</code> or <code>have := no_6_torsion ...</code></p>



<a name="221370678"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221370678" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221370678">(Jan 01 2021 at 21:50)</a>:</h4>
<p>This gets closer, although there is an issue with your coercions that makes <code>h</code> not directly suitable for the final <code>_</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="kd">begin</span>
    <span class="n">introv</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">set_coe.ext</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="n">using</span> <span class="bp">@</span><span class="n">no_6_torsion</span> <span class="n">R</span> <span class="n">_</span> <span class="n">A</span> <span class="n">_</span> <span class="n">_</span> <span class="n">a</span> <span class="n">_</span><span class="o">,</span>
    <span class="gr">sorry</span>
  <span class="kd">end</span>
</code></pre></div>



<a name="221371085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371085">(Jan 01 2021 at 22:00)</a>:</h4>
<p>Is there a reason you need <code>subnosixtorsion</code>, even though it has no members that are different from submodule?</p>



<a name="221371254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371254">(Jan 01 2021 at 22:05)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span>  - It's not needed for the purposes of this example. The following would illustrate my problem just as well:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">submodule_nosixtorsion</span> <span class="o">(</span><span class="n">A'</span> <span class="o">:</span> <span class="n">submodule</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">nosixtorsion</span> <span class="n">R</span> <span class="n">A'</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">no_6_torsion</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">introv</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">set_coe.ext</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="n">using</span> <span class="bp">@</span><span class="n">no_6_torsion</span> <span class="n">R</span> <span class="n">_</span> <span class="n">A</span> <span class="n">_</span> <span class="n">_</span> <span class="n">a</span> <span class="n">h</span><span class="o">,</span>
  <span class="kd">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="221371352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371352">(Jan 01 2021 at 22:07)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  Thanks for your help - it seems that the elements of the carrier are subtypes - a structure with a value and a proposition.</p>



<a name="221371415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371415">(Jan 01 2021 at 22:09)</a>:</h4>
<p>I noticed that. Perhaps you meant to use <code>\forall a \in A</code> in <code>no_6_torsion</code> instead of <code>\forall a : A</code>?</p>



<a name="221371630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371630">(Jan 01 2021 at 22:15)</a>:</h4>
<p>Lean seems to assume <code>a</code> is a natural number if I do that.</p>



<a name="221371703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371703">(Jan 01 2021 at 22:16)</a>:</h4>
<p>you need a type ascription on <code>6</code></p>



<a name="221371711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371711">(Jan 01 2021 at 22:17)</a>:</h4>
<p><code>(6 : R)</code> I assume?</p>



<a name="221371767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371767">(Jan 01 2021 at 22:18)</a>:</h4>
<p>Trying</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">nosixtorsion</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">A</span><span class="o">]</span> <span class="kd">extends</span> <span class="n">semimodule</span> <span class="n">R</span> <span class="n">A</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">no_6_torsion</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">A</span><span class="o">,</span> <span class="o">(</span><span class="mi">6</span> <span class="o">:</span><span class="n">R</span><span class="o">)</span><span class="bp">•</span><span class="n">a</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="n">a</span><span class="bp">=</span><span class="mi">0</span><span class="o">)</span>
</code></pre></div>
<p><code>a</code> is red underlined as <code>?m_1</code></p>



<a name="221371776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371776">(Jan 01 2021 at 22:19)</a>:</h4>
<p>Oh I see, this proof is about showing that a submodule is a nosixtorsion, so the coe is unavoidable. You should do something like what's done to prove that a submodule is a semimodule:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">semimodule</span> <span class="n">R</span> <span class="n">p</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">refine</span> <span class="o">{</span><span class="n">smul</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">•</span><span class="o">),</span> <span class="bp">..</span><span class="n">p.to_sub_mul_action.mul_action</span><span class="o">,</span> <span class="bp">..</span><span class="o">}</span><span class="bp">;</span>
   <span class="o">{</span> <span class="n">intros</span><span class="o">,</span> <span class="n">apply</span> <span class="n">set_coe.ext</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">smul_add</span><span class="o">,</span> <span class="n">add_smul</span><span class="o">,</span> <span class="n">mul_smul</span><span class="o">]</span> <span class="o">}</span>
</code></pre></div>
<p>The key step being <code>set_coe.ext</code></p>



<a name="221371926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371926">(Jan 01 2021 at 22:23)</a>:</h4>
<p>Oh, there is a missing simp lemma here</p>



<a name="221371938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371938">(Jan 01 2021 at 22:23)</a>:</h4>
<p>I'm wondering if I need to apply <code>set_coe.ext</code> to <code>h</code> somehow?</p>



<a name="221371981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371981">(Jan 01 2021 at 22:24)</a>:</h4>
<p>yes, like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="kd">begin</span>
    <span class="n">introv</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">set_coe.ext_iff</span> <span class="n">at</span> <span class="n">h</span> <span class="bp">⊢</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">submodule.smul_coe</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="kd">end</span>
</code></pre></div>



<a name="221371986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221371986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221371986">(Jan 01 2021 at 22:24)</a>:</h4>
<p>the problem is that the latter theorem doesn't exist</p>



<a name="221372006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221372006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221372006">(Jan 01 2021 at 22:25)</a>:</h4>
<p>actually I take it back, <code>submodule.coe_smul</code> does exist but doesn't apply here because you have your own coe</p>



<a name="221372017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221372017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221372017">(Jan 01 2021 at 22:26)</a>:</h4>
<p>you need <code>subnosixtorsion.coe_smul</code></p>



<a name="221372053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221372053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221372053">(Jan 01 2021 at 22:26)</a>:</h4>
<p>This gets me a <code>goal accomplished!</code></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">submodule_nosixtorsion</span> <span class="o">(</span><span class="n">A'</span> <span class="o">:</span> <span class="n">submodule</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">nosixtorsion</span> <span class="n">R</span> <span class="n">A'</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">no_6_torsion</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">introv</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">set_coe.ext_iff</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="n">using</span> <span class="bp">@</span><span class="n">no_6_torsion</span> <span class="n">R</span> <span class="n">_</span> <span class="n">A</span> <span class="n">_</span> <span class="n">_</span> <span class="n">a</span> <span class="n">h</span><span class="o">,</span>
  <span class="kd">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="221372064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221372064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221372064">(Jan 01 2021 at 22:26)</a>:</h4>
<p>you have three new definitions just before this and no lemmas about it</p>



<a name="221372128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221372128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221372128">(Jan 01 2021 at 22:28)</a>:</h4>
<p>Solved for your reduced version without the new <code>subsixmodule</code> type:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module</span>

<span class="kd">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>  <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>

<span class="kd">class</span> <span class="n">nosixtorsion</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">A</span><span class="o">]</span> <span class="kd">extends</span> <span class="n">semimodule</span> <span class="n">R</span> <span class="n">A</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">no_6_torsion</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span><span class="o">),</span> <span class="o">(</span><span class="mi">6</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span><span class="bp">•</span><span class="n">a</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="n">a</span><span class="bp">=</span><span class="mi">0</span><span class="o">)</span>

<span class="kd">instance</span> <span class="n">submodule_nosixtorsion</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">A</span><span class="o">]</span>
  <span class="o">[</span><span class="n">nosixtorsion</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span> <span class="o">(</span><span class="n">A'</span> <span class="o">:</span> <span class="n">submodule</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">nosixtorsion</span> <span class="n">R</span> <span class="n">A'</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">no_6_torsion</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">h</span><span class="o">,</span> <span class="n">set_coe.ext</span> <span class="bp">$</span> <span class="n">nosixtorsion.no_6_torsion</span> <span class="bp">↑</span><span class="n">a</span> <span class="o">(</span><span class="n">set_coe.ext_iff.mpr</span> <span class="n">h</span><span class="o">)</span>
</code></pre></div>



<a name="221372306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221372306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221372306">(Jan 01 2021 at 22:33)</a>:</h4>
<p>Thank you very much both for your help. This also seems to work for me:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module</span>

<span class="kd">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span>  <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span>

<span class="kd">class</span> <span class="n">nosixtorsion</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">A</span><span class="o">]</span> <span class="kd">extends</span> <span class="n">semimodule</span> <span class="n">R</span> <span class="n">A</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">no_6_torsion</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span><span class="o">),</span> <span class="mi">6</span><span class="bp">•</span><span class="n">a</span><span class="bp">=</span><span class="mi">0</span> <span class="bp">→</span> <span class="n">a</span><span class="bp">=</span><span class="mi">0</span><span class="o">)</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">nosixtorsion</span> <span class="n">R</span> <span class="n">A</span><span class="o">]</span>

<span class="kd">instance</span> <span class="n">submodule_nosixtorsion</span> <span class="o">(</span><span class="n">A'</span> <span class="o">:</span> <span class="n">submodule</span> <span class="n">R</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">nosixtorsion</span> <span class="n">R</span> <span class="n">A'</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">no_6_torsion</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">introv</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">set_coe.ext_iff</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="n">using</span> <span class="bp">@</span><span class="n">nosixtorsion.no_6_torsion</span> <span class="n">R</span> <span class="n">_</span> <span class="n">A</span> <span class="n">_</span> <span class="n">_</span> <span class="n">a</span> <span class="n">h</span><span class="o">,</span>
  <span class="kd">end</span>
<span class="o">}</span>
</code></pre></div>



<a name="221372394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221372394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221372394">(Jan 01 2021 at 22:35)</a>:</h4>
<p>The one line proof in my message above appears to work for your <code>subnosixtorsion</code> structure too</p>



<a name="221372671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221372671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221372671">(Jan 01 2021 at 22:43)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span>  - yes - the one line proof seems to require <code>(6 : R)</code> instead of <code>6</code> in the <code>nosixtorsion.no_6_torsion</code> definition (which is fine).</p>
<p>Thank you again for your help.</p>



<a name="221373246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221373246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221373246">(Jan 01 2021 at 22:57)</a>:</h4>
<p>I wonder if <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.semimodule">docs#submodule.semimodule</a> is not general enough to work when 6 is nat...</p>



<a name="221373296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221373296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221373296">(Jan 01 2021 at 22:58)</a>:</h4>
<p>I think there ought to be a statement about <code>is_scalar_tower</code> there</p>



<a name="221373303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221373303" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221373303">(Jan 01 2021 at 22:59)</a>:</h4>
<p>Why wouldn't it be general enough?</p>



<a name="221373347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221373347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221373347">(Jan 01 2021 at 23:00)</a>:</h4>
<p>you can coerce nat to R and use <code>\u 6</code> in any case</p>



<a name="221373354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221373354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221373354">(Jan 01 2021 at 23:00)</a>:</h4>
<p>although you might also want to use <code>gsmul</code> for a concrete multiple like 6</p>



<a name="221373358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221373358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221373358">(Jan 01 2021 at 23:00)</a>:</h4>
<p>so that it works on additive groups</p>



<a name="221373669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221373669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221373669">(Jan 01 2021 at 23:09)</a>:</h4>
<p>Couldn't there be an instance <code>(A' : submodule R A) [is_scalar_tower S R A'] : semimodule S A'</code>?</p>



<a name="221373671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221373671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221373671">(Jan 01 2021 at 23:09)</a>:</h4>
<p>Or does that already exist?</p>



<a name="221374419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221374419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221374419">(Jan 01 2021 at 23:29)</a>:</h4>
<p>that kind of thing looks scary to me, I wouldn't want to do it without a pressing need</p>



<a name="221374711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221374711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221374711">(Jan 01 2021 at 23:37)</a>:</h4>
<p>We have that type of thing for tensor_product and linear_map already</p>



<a name="221374797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221374797" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221374797">(Jan 01 2021 at 23:39)</a>:</h4>
<p>Where we avoid nasty typeclass problems in the former by providing a fast path for the 99% case (<a href="https://leanprover-community.github.io/mathlib_docs/find/tensor_product.semimodule/src">src#tensor_product.semimodule</a> vs <a href="https://leanprover-community.github.io/mathlib_docs/find/tensor_product.semimodule'/src">src#tensor_product.semimodule'</a>)</p>



<a name="221396003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221396003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221396003">(Jan 02 2021 at 11:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113489-new-members/topic/Modules.20with.20no.206-torsion/near/221374419">said</a>:</p>
<blockquote>
<p>that kind of thing looks scary to me, I wouldn't want to do it without a pressing need</p>
</blockquote>
<p>I've made a PR at <a href="https://github.com/leanprover-community/mathlib/issues/5569">#5569</a> to find out exactly how scary this is</p>



<a name="221396131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Modules%20with%20no%206-torsion/near/221396131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Modules.20with.20no.206-torsion.html#221396131">(Jan 02 2021 at 11:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="373192">Christopher Hoskin</span> <a href="#narrow/stream/113489-new-members/topic/Modules.20with.20no.206-torsion/near/221372671">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span>  - yes - the one line proof seems to require <code>(6 : R)</code> instead of <code>6</code> in the <code>nosixtorsion.no_6_torsion</code> definition (which is fine).</p>
</blockquote>
<p>The one-line proof appears to work fine if you replace <code>nosixtorsion.no_6_torsion</code> with <code>nosixtorsion.no_6_torsion R</code> (since the lemma can no longer deduce<code>R</code> from the theorem statement if it's not the type of <code>6</code>)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>