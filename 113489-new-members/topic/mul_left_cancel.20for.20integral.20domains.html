---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html">mul_left_cancel for integral domains</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="210729727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210729727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210729727">(Sep 21 2020 at 11:46)</a>:</h4>
<p>Dear All,</p>
<p>I would like to use the fact that in an integral domain, every non-zero element is left-cancellable (see the <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> below).  Is this lemma already in mathlib and I have simply been unable to find it?</p>
<p>Thank you!</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">lemma</span> <span class="n">xxv</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_integral_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">}</span> <span class="o">:</span> <span class="n">x</span><span class="bp">*</span><span class="n">y</span><span class="bp">=</span><span class="n">x</span><span class="bp">*</span><span class="n">z</span> <span class="bp">→</span> <span class="n">y</span><span class="bp">=</span><span class="n">z</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">sorry</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210729813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210729813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210729813">(Sep 21 2020 at 11:47)</a>:</h4>
<p><code>mul_left_cancel</code> hopefully?</p>



<a name="210729880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210729880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210729880">(Sep 21 2020 at 11:48)</a>:</h4>
<p>Maybe with a <code>'</code>, if the other version is for groups</p>



<a name="210729974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210729974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210729974">(Sep 21 2020 at 11:50)</a>:</h4>
<p>I tried, but I was unable to make it work...</p>



<a name="210730133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730133">(Sep 21 2020 at 11:51)</a>:</h4>
<p>I'll give it a go</p>



<a name="210730186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shing Tak Lam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730186">(Sep 21 2020 at 11:52)</a>:</h4>
<p>If you change <code>is_integral_domain</code> to <code>integral_domain</code>, then <code>mul_left_cancel'</code> works btw</p>



<a name="210730217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730217">(Sep 21 2020 at 11:52)</a>:</h4>
<p>Aah, that's the issue: <code>is_integral_domain</code> isn't the way to say an integral domain.</p>



<a name="210730241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730241">(Sep 21 2020 at 11:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="266440">Shing Tak Lam</span> <a href="#narrow/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains/near/210730186">said</a>:</p>
<blockquote>
<p>If you change <code>is_integral_domain</code> to <code>integral_domain, then </code>mul_left_cancel'` works btw</p>
</blockquote>
<p>Ah, this might fix it for me, then!</p>



<a name="210730244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730244">(Sep 21 2020 at 11:52)</a>:</h4>
<p>You should delete <code>comm_ring R</code> and use <code>integral_domain R</code></p>



<a name="210730248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730248">(Sep 21 2020 at 11:52)</a>:</h4>
<p>Let me try!</p>



<a name="210730497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730497">(Sep 21 2020 at 11:56)</a>:</h4>
<p>I am trying</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">xxv</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">}</span> <span class="o">:</span> <span class="n">x</span><span class="bp">*</span><span class="n">y</span><span class="bp">=</span><span class="n">x</span><span class="bp">*</span><span class="n">z</span> <span class="bp">→</span> <span class="n">y</span><span class="bp">=</span><span class="n">z</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">mul_left_cancel&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>but I get this error:</p>
<div class="codehilite"><pre><span></span><code><span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">semiring</span> <span class="n">R</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_2</span> <span class="o">:</span> <span class="n">integral_domain</span> <span class="n">R</span><span class="o">,</span>
<span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">R</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span>
<span class="err">⊢</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span>
</code></pre></div>



<a name="210730806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730806">(Sep 21 2020 at 11:58)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">lemma</span> <span class="n">xxv</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">}</span> <span class="o">:</span> <span class="n">x</span><span class="bp">*</span><span class="n">y</span><span class="bp">=</span><span class="n">x</span><span class="bp">*</span><span class="n">z</span> <span class="bp">→</span> <span class="n">y</span><span class="bp">=</span><span class="n">z</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">mul_left_cancel&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>works for me.</p>



<a name="210730813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shing Tak Lam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730813">(Sep 21 2020 at 11:59)</a>:</h4>
<p>I'm not sure why, but I think the <code>semiring R</code> instance is affecting things</p>



<a name="210730885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shing Tak Lam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730885">(Sep 21 2020 at 11:59)</a>:</h4>
<p>you probably have <code>variable [semiring R]</code> somewhere? I can reproduce the error if I add a <code>semiring R</code> typeclass</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">lemma</span> <span class="n">xxv</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">R</span><span class="o">}</span> <span class="o">{</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">}</span> <span class="o">:</span> <span class="n">x</span><span class="bp">*</span><span class="n">y</span><span class="bp">=</span><span class="n">x</span><span class="bp">*</span><span class="n">z</span> <span class="bp">→</span> <span class="n">y</span><span class="bp">=</span><span class="n">z</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">mul_left_cancel&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span> <span class="c1">-- Same error</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210730971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210730971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210730971">(Sep 21 2020 at 12:00)</a>:</h4>
<p>Yes, my standing assumption is that <code>R</code> is a semiring</p>



<a name="210731020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731020">(Sep 21 2020 at 12:00)</a>:</h4>
<p>Interesting</p>



<a name="210731052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731052">(Sep 21 2020 at 12:01)</a>:</h4>
<p>I wonder if it's worth trying to improve these error messages, or we should just wait for <span aria-label="four leaf clover" class="emoji emoji-1f340" role="img" title="four leaf clover">:four_leaf_clover:</span></p>



<a name="210731059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731059">(Sep 21 2020 at 12:01)</a>:</h4>
<p>But an integral domain is a semiring so you should maybe just start afresh with some new variable which is an integral domain</p>



<a name="210731070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731070">(Sep 21 2020 at 12:01)</a>:</h4>
<p>I will remove this assumption now.  In case someone is further interested, here is what happens if I try to <code>convert h</code>.  Lean wants me to prove:</p>
<div class="codehilite"><pre><span></span><code><span class="err">⊢</span> <span class="n">cancel_monoid_with_zero</span><span class="bp">.</span><span class="n">to_monoid_with_zero</span> <span class="n">R</span> <span class="bp">=</span> <span class="n">semiring</span><span class="bp">.</span><span class="n">to_monoid_with_zero</span> <span class="n">R</span>
</code></pre></div>



<a name="210731116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731116">(Sep 21 2020 at 12:01)</a>:</h4>
<p>Yup, but those are two completely different <code>0</code>s (-;</p>



<a name="210731197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731197">(Sep 21 2020 at 12:02)</a>:</h4>
<p>You can't prove this, because one has come from <code>[semiring R]</code> and one has come from <code>[integral_domain R]</code>. That's exactly the difference between <code>integral_domain</code> and <code>is_integral_domain</code></p>



<a name="210731208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731208">(Sep 21 2020 at 12:02)</a>:</h4>
<p>You assumed two semiring instances (one coming from the integral domain) but Lean doesn't know any compatibility between them.</p>



<a name="210731225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731225">(Sep 21 2020 at 12:02)</a>:</h4>
<p>Ok, I will remove the semiring assumption</p>



<a name="210731227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731227">(Sep 21 2020 at 12:02)</a>:</h4>
<p>You should remove the <code>[semiring R]</code> assumption because type class inference knows that an integral domain is a semiring</p>



<a name="210731268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731268">(Sep 21 2020 at 12:03)</a>:</h4>
<p>so all the stuff you just proved about semirings will all work fine when you're rewriting it in some lemmas about integral domains</p>



<a name="210731350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731350">(Sep 21 2020 at 12:04)</a>:</h4>
<p>Thank you all for the help!  For the record, this now is a working lemma:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">xxv</span> <span class="o">{</span><span class="n">RR</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">RR</span><span class="o">]</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">RR</span><span class="o">}</span> <span class="o">{</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">}</span> <span class="o">:</span> <span class="n">x</span><span class="bp">*</span><span class="n">y</span><span class="bp">=</span><span class="n">x</span><span class="bp">*</span><span class="n">z</span> <span class="bp">→</span> <span class="n">y</span><span class="bp">=</span><span class="n">z</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">mul_left_cancel&#39;</span> <span class="n">h</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210731394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731394">(Sep 21 2020 at 12:04)</a>:</h4>
<p>now see if you can do it in term mode :-)</p>



<a name="210731554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731554">(Sep 21 2020 at 12:06)</a>:</h4>
<p>I would love to, but I would need to learn how to communicate to Lean in term mode... Ahahaha</p>



<a name="210731640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731640">(Sep 21 2020 at 12:07)</a>:</h4>
<p>hint: the term-mode proof is a substring of the tactic proof</p>



<a name="210731875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731875">(Sep 21 2020 at 12:10)</a>:</h4>
<p>Ok, I am making the guess that I should remove characters from <code>apply </code>, since I imagine that the name of the lemmas in mathlib appear identically in term mode!</p>



<a name="210731895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731895">(Sep 21 2020 at 12:10)</a>:</h4>
<p><code>begin</code> means entering tactic mode</p>



<a name="210731901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731901">(Sep 21 2020 at 12:10)</a>:</h4>
<p>and <code>end</code> stops it.</p>



<a name="210731928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731928">(Sep 21 2020 at 12:11)</a>:</h4>
<p>Indeed, <code>apply</code> takes a little bit of term mode as argument, and does something useful with it.</p>



<a name="210731942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731942">(Sep 21 2020 at 12:11)</a>:</h4>
<p>ah, so i should remove from <code>begin apply [] end</code></p>
<p>I will keep <code>by</code>!  Ahahaha</p>



<a name="210731964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210731964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210731964">(Sep 21 2020 at 12:11)</a>:</h4>
<p>No <code>by</code> also enters tactic mode</p>



<a name="210732017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210732017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210732017">(Sep 21 2020 at 12:12)</a>:</h4>
<p>To be more specific, a consecutive substring <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="210732065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210732065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210732065">(Sep 21 2020 at 12:12)</a>:</h4>
<p><code>by {...}</code> and <code>begin ... end</code> are the two ways to enter tactic mode from term mode. <code>exact ...</code> is the way to enter term mode from tactic mode.</p>



<a name="210732097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210732097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210732097">(Sep 21 2020 at 12:13)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> Did you know that <code>mul_left_cancel'</code> is a function?</p>



<a name="210732112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210732112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210732112">(Sep 21 2020 at 12:13)</a>:</h4>
<p>Your lemma <code>xxv</code> is also a function</p>



<a name="210732818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210732818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210732818">(Sep 21 2020 at 12:21)</a>:</h4>
<p>Regarding the error, if you <code>set_option pp.numerals false</code>, then you get an error which shows the issue:</p>
<div class="codehilite"><pre><span></span><code><span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">x</span> <span class="bp">≠</span>
    <span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="n">R</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">mul_zero_class</span><span class="bp">.</span><span class="n">to_has_zero</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">monoid_with_zero</span><span class="bp">.</span><span class="n">to_mul_zero_class</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">semiring</span><span class="bp">.</span><span class="n">to_monoid_with_zero</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">x</span> <span class="bp">≠</span>
    <span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="n">R</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">mul_zero_class</span><span class="bp">.</span><span class="n">to_has_zero</span> <span class="n">R</span>
         <span class="o">(</span><span class="bp">@</span><span class="n">monoid_with_zero</span><span class="bp">.</span><span class="n">to_mul_zero_class</span> <span class="n">R</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">cancel_monoid_with_zero</span><span class="bp">.</span><span class="n">to_monoid_with_zero</span> <span class="n">R</span>
               <span class="o">(</span><span class="bp">@</span><span class="n">domain</span><span class="bp">.</span><span class="n">to_cancel_monoid_with_zero</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">integral_domain</span><span class="bp">.</span><span class="n">to_domain</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">)))))</span>
</code></pre></div>



<a name="210732932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210732932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210732932">(Sep 21 2020 at 12:22)</a>:</h4>
<p>showing that Lean already has some logic to help identify the issue,<br>
but to make it work you have to (1) guess it's an issue with <code>0</code>, (2) know (or guess) that <code>pp.numerals</code> exists, (3) turn it on and understand the resulting message</p>



<a name="210733033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210733033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210733033">(Sep 21 2020 at 12:23)</a>:</h4>
<p>I managed the term mode proof!</p>
<div class="codehilite"><pre><span></span><code><span class="n">mul_left_cancel&#39;</span> <span class="n">h</span>
</code></pre></div>


<p>I got stuck this whole time with the comma at the end...</p>



<a name="210733251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210733251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210733251">(Sep 21 2020 at 12:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains/near/210732818">said</a>:</p>
<blockquote>
<p>Regarding the error, if you <code>set_option pp.numerals false</code>, then you get an error which shows the issue:</p>
<div class="codehilite"><pre><span></span><code><span class="n">error</span><span class="o">:</span> <span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">x</span> <span class="bp">≠</span>
    <span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="n">R</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">mul_zero_class</span><span class="bp">.</span><span class="n">to_has_zero</span> <span class="n">R</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">monoid_with_zero</span><span class="bp">.</span><span class="n">to_mul_zero_class</span> <span class="n">R</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">semiring</span><span class="bp">.</span><span class="n">to_monoid_with_zero</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">x</span> <span class="bp">≠</span>
    <span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="n">R</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">mul_zero_class</span><span class="bp">.</span><span class="n">to_has_zero</span> <span class="n">R</span>
         <span class="o">(</span><span class="bp">@</span><span class="n">monoid_with_zero</span><span class="bp">.</span><span class="n">to_mul_zero_class</span> <span class="n">R</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">cancel_monoid_with_zero</span><span class="bp">.</span><span class="n">to_monoid_with_zero</span> <span class="n">R</span>
               <span class="o">(</span><span class="bp">@</span><span class="n">domain</span><span class="bp">.</span><span class="n">to_cancel_monoid_with_zero</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">integral_domain</span><span class="bp">.</span><span class="n">to_domain</span> <span class="n">R</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">)))))</span>
</code></pre></div>


</blockquote>
<p>I see: one appears to go by <code>semiring</code>, the other by <code>cancel_monoid</code>.</p>
<p>Thanks for the explanation!</p>



<a name="210733323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210733323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210733323">(Sep 21 2020 at 12:26)</a>:</h4>
<p>Nasty commas are nasty</p>



<a name="210733349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210733349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210733349">(Sep 21 2020 at 12:26)</a>:</h4>
<p>The main point is buried though: one is ultimately built from <code>_inst_1</code> and the other from <code>_inst_2</code>. So the error message could still use some work.</p>



<a name="210734180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/mul_left_cancel%20for%20integral%20domains/near/210734180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/mul_left_cancel.20for.20integral.20domains.html#210734180">(Sep 21 2020 at 12:35)</a>:</h4>
<p>"Don't forget the comma!"</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>