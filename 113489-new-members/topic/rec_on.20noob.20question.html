---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/rec_on.20noob.20question.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html">rec_on noob question</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="202927067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202927067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202927067">(Jul 05 2020 at 16:03)</a>:</h4>
<p><code>bool.rec_on tt 1 2</code> - Shouldn't this be equal to 1? But It doesn't work, I get the error</p>
<div class="codehilite"><pre><span></span><code><span class="n">invalid</span> <span class="err">&#39;</span><span class="n">bool</span><span class="bp">.</span><span class="n">rec_on&#39;</span> <span class="n">application</span><span class="o">,</span> <span class="n">elaborator</span> <span class="n">has</span> <span class="n">special</span> <span class="n">support</span> <span class="n">for</span> <span class="n">this</span> <span class="n">kind</span> <span class="n">of</span> <span class="n">application</span> <span class="o">(</span><span class="n">it</span> <span class="n">is</span> <span class="n">handled</span> <span class="n">as</span> <span class="n">an</span> <span class="s2">&quot;eliminator&quot;</span><span class="o">),</span> <span class="n">but</span> <span class="n">the</span> <span class="n">expected</span> <span class="n">type</span> <span class="n">must</span> <span class="n">be</span> <span class="n">known</span>
</code></pre></div>


<p>The <code>expected type</code> - it means <code>nat</code>?  Where to put it?</p>



<a name="202927738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202927738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202927738">(Jul 05 2020 at 16:19)</a>:</h4>
<p><code>(bool.rec_on tt 1 2 : nat)</code></p>



<a name="202928926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202928926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202928926">(Jul 05 2020 at 16:51)</a>:</h4>
<p>I would've never put it there lol</p>



<a name="202928984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202928984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202928984">(Jul 05 2020 at 16:53)</a>:</h4>
<p>Could you explain <em>how</em> this helps?</p>



<a name="202929276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929276">(Jul 05 2020 at 17:00)</a>:</h4>
<p>I find it bizzare that the compiler (interpreter?) doesn't know how to compute it, but if I tell what's is the type of the output then it suddenly knows</p>



<a name="202929320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929320" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929320">(Jul 05 2020 at 17:01)</a>:</h4>
<p>The error message tells the reason. If you just wrote something like <code>#eval bool.rec_on tt 1 2</code> then there is no expected type.</p>



<a name="202929371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929371">(Jul 05 2020 at 17:02)</a>:</h4>
<p>Consider the type of <code>bool.rec_on</code>: <code>Π {C : bool → Sort l} (n : bool), C ff → C tt → C n</code>. The type checker has to infer <code>C</code> from limited evidence.</p>



<a name="202929402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929402">(Jul 05 2020 at 17:03)</a>:</h4>
<p>Note that <code>C</code> is a function that takes a <code>bool</code> and produces a type and we do not give <code>C</code> explicitly. Thus, Lean has to solve a higher-order unification problem.</p>



<a name="202929472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929472">(Jul 05 2020 at 17:04)</a>:</h4>
<p>The reason the compiler can't compute it is because it's not a complete term. It's actually <code>@bool.rec_on &lt;guess me&gt; tt 1 2</code> and lean was unable to do the guessing part. The interpreter will not even consider evaluating terms with unresolved metavariables</p>



<a name="202929477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929477">(Jul 05 2020 at 17:04)</a>:</h4>
<p>In general there is no unique answer to such unification problems. Lean has a heuristic to solve them but it depends on knowing the expected type.</p>



<a name="202929499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929499">(Jul 05 2020 at 17:05)</a>:</h4>
<p>Notice that <code>(bool.rec_on tt 1 2 : int)</code> also works and gives a different answer</p>



<a name="202929540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929540">(Jul 05 2020 at 17:06)</a>:</h4>
<p>If you had a nondependent recursor like <code>bool.foo : \Pi (T : Type), bool -&gt; T -&gt; T -&gt; T</code> then Lean would be able to fall back to inferring <code>T</code> from the arguments instead.</p>



<a name="202929575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929575">(Jul 05 2020 at 17:07)</a>:</h4>
<p>By the way <code>cond tt 2 1</code> works fine, because it is nondependent like Reid says</p>



<a name="202929864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929864">(Jul 05 2020 at 17:14)</a>:</h4>
<p>Okay, I see that we do not give <code>C</code> explicitly. If I want to give it explicitly, what would I need to write?</p>



<a name="202929882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929882">(Jul 05 2020 at 17:15)</a>:</h4>
<p><code> λ b : bool, nat</code> ?</p>



<a name="202929941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202929941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202929941">(Jul 05 2020 at 17:16)</a>:</h4>
<p>It works, but I'm not sure whether I understand the role of <code>C</code>.</p>



<a name="202930336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202930336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202930336">(Jul 05 2020 at 17:27)</a>:</h4>
<p>C tells you the type of the object you're making, and the output of the recursor is the term of that type</p>



<a name="202931576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202931576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202931576">(Jul 05 2020 at 18:05)</a>:</h4>
<p>But <code>cond</code> seems to handle just fine without it</p>



<a name="202931698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202931698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202931698">(Jul 05 2020 at 18:08)</a>:</h4>
<p>Here's the type of <code>cond</code>: <code>cond : Π {a : Type u_1}, bool → a → a → a</code>. This is a non-dependent function. See Reid's most recent message in this thread.</p>



<a name="202932493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202932493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202932493">(Jul 05 2020 at 18:30)</a>:</h4>
<p>Note that <code>bool.rec_on</code> can be used where the types of the two sides are not the same (i.e. <code>1 : nat</code> and <code>2 : int</code>)</p>



<a name="202932534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202932534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202932534">(Jul 05 2020 at 18:30)</a>:</h4>
<p>in which case the result will have a funny dependent type</p>



<a name="202936177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936177">(Jul 05 2020 at 20:10)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>  Wow, that's a great answer, thank you!</p>



<a name="202936222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936222">(Jul 05 2020 at 20:10)</a>:</h4>
<p>But know I'm stuck in a circle, because in order to define this dependent type, I would need to use <code>bool.rec_on</code> itself</p>



<a name="202936255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936255">(Jul 05 2020 at 20:11)</a>:</h4>
<p>Like <code>(λ b : bool, bool.rec_on b nat int)</code></p>



<a name="202936394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936394">(Jul 05 2020 at 20:14)</a>:</h4>
<p>When you declare <code>bool</code> as an inductive type you get <code>bool.rec_on</code> for free. There's a nice explanation by <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> here: <a href="https://xenaproject.wordpress.com/2018/03/24/no-confusion-over-no_confusion/">https://xenaproject.wordpress.com/2018/03/24/no-confusion-over-no_confusion/</a></p>



<a name="202936487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936487">(Jul 05 2020 at 20:17)</a>:</h4>
<p>Yeah, I know this at least.</p>



<a name="202936526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936526">(Jul 05 2020 at 20:18)</a>:</h4>
<p>But I think this is not the easiest way to use it:<br>
<code>@bool.rec_on (λ b : bool,  @bool.rec_on (λ b1 : bool, Type) b nat bool ) tt 2 ff </code></p>



<a name="202936561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936561">(Jul 05 2020 at 20:19)</a>:</h4>
<p>you can use <code>cond</code> for that, because <code>nat</code> and <code>int</code> have the same type, namely <code>Type</code> :)</p>



<a name="202936611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936611" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936611">(Jul 05 2020 at 20:20)</a>:</h4>
<p>oh right</p>



<a name="202936626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936626">(Jul 05 2020 at 20:20)</a>:</h4>
<p>But in the general case, like for the type <code>weekday</code> from the tutorial (inductive type with 7 elements) it wouldn't work</p>



<a name="202936640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936640">(Jul 05 2020 at 20:21)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="n">bool</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">tt</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">nat</span><span class="o">)</span> <span class="n">ff</span> <span class="o">:</span> <span class="n">cond</span> <span class="n">tt</span> <span class="n">bool</span> <span class="n">nat</span><span class="o">)</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="n">bool</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">ff</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">nat</span><span class="o">)</span> <span class="n">ff</span> <span class="o">:</span> <span class="n">cond</span> <span class="n">ff</span> <span class="n">bool</span> <span class="n">nat</span><span class="o">)</span>
</code></pre></div>



<a name="202936690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936690">(Jul 05 2020 at 20:22)</a>:</h4>
<p>the display isn't great because lean doesn't know how to infer a to_string function for this type</p>



<a name="202936709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936709">(Jul 05 2020 at 20:23)</a>:</h4>
<p>I will note that it is pretty weird to be writing types or programs like this</p>



<a name="202936776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936776">(Jul 05 2020 at 20:24)</a>:</h4>
<p>At least I now understand fully what's going on</p>



<a name="202936779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936779">(Jul 05 2020 at 20:24)</a>:</h4>
<p>Thank you really much!</p>



<a name="202936883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936883">(Jul 05 2020 at 20:27)</a>:</h4>
<p><code>#reduce</code> works better than <code>#eval</code> there</p>



<a name="202936886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202936886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202936886">(Jul 05 2020 at 20:27)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">inductive</span> <span class="n">weekday</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">|</span> <span class="n">mon</span> <span class="bp">|</span> <span class="n">tue</span> <span class="bp">|</span> <span class="n">wed</span> <span class="bp">|</span> <span class="n">thu</span> <span class="bp">|</span> <span class="n">fri</span> <span class="bp">|</span> <span class="n">sat</span> <span class="bp">|</span> <span class="n">sun</span>

<span class="n">def</span> <span class="n">tgif_type</span> <span class="o">:</span> <span class="n">weekday</span> <span class="bp">→</span> <span class="kt">Type</span>
<span class="bp">|</span> <span class="n">weekday</span><span class="bp">.</span><span class="n">fri</span> <span class="o">:=</span> <span class="n">string</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span> <span class="n">unit</span>

<span class="n">def</span> <span class="n">tgif</span> <span class="o">(</span><span class="n">w</span><span class="o">)</span> <span class="o">:</span> <span class="n">tgif_type</span> <span class="n">w</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">cases</span> <span class="n">w</span><span class="o">,</span>
  <span class="n">case</span> <span class="n">weekday</span><span class="bp">.</span><span class="n">fri</span> <span class="o">{</span> <span class="n">exact</span> <span class="s2">&quot;thank god it&#39;s friday&quot;</span> <span class="o">},</span>
  <span class="n">all_goals</span> <span class="o">{</span> <span class="n">exact</span> <span class="o">()</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">instance</span> <span class="o">{</span><span class="n">w</span><span class="o">}</span> <span class="o">:</span> <span class="n">has_repr</span> <span class="o">(</span><span class="n">tgif_type</span> <span class="n">w</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">cases</span> <span class="n">w</span><span class="o">,</span>
  <span class="n">case</span> <span class="n">weekday</span><span class="bp">.</span><span class="n">fri</span> <span class="o">{</span> <span class="n">exact</span> <span class="n">string</span><span class="bp">.</span><span class="n">has_repr</span> <span class="o">},</span>
  <span class="n">all_goals</span> <span class="o">{</span> <span class="n">exact</span> <span class="bp">⟨λ</span> <span class="bp">_</span><span class="o">,</span> <span class="s2">&quot;()&quot;</span><span class="bp">⟩</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="bp">#</span><span class="kn">eval</span> <span class="n">tgif</span> <span class="n">weekday</span><span class="bp">.</span><span class="n">fri</span> <span class="c1">-- &quot;thank god it&#39;s friday&quot;</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">tgif</span> <span class="n">weekday</span><span class="bp">.</span><span class="n">sun</span> <span class="c1">-- ()</span>
</code></pre></div>



<a name="202937197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202937197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mateusz Zugaj <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202937197">(Jul 05 2020 at 20:35)</a>:</h4>
<p>When I did <code>#reduce</code> at the last line my server crashed lol</p>



<a name="202943498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/rec_on%20noob%20question/near/202943498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/rec_on.20noob.20question.html#202943498">(Jul 05 2020 at 23:51)</a>:</h4>
<p>From the perspective of the kernel (that <code>#reduce</code> uses) strings are a list characters, which are natural numbers in a certain range. From the perspective of the kernel, natural numbers are written unary, as <code>S (S ( ... 0 ... ))</code>, so it chokes on even medium-sized natural numbers.<br>
In short: don't use <code>#reduce</code> on natural numbers <code>&gt;1000</code> or <code>char</code> or <code>string</code> (or things that are build on a tower of definitions, like any real number)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>