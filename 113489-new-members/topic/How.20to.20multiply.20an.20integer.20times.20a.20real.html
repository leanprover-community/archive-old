---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html">How to multiply an integer times a real</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="221717240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221717240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221717240">(Jan 05 2021 at 23:42)</a>:</h4>
<p>The first check works and the second throws an error:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">variable</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ℤ</span>

<span class="k">#check</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)))</span> <span class="c1">-- OK</span>

<span class="k">#check</span> <span class="n">a</span><span class="bp">*</span><span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)))</span> <span class="c1">-- error</span>
</code></pre></div>
<p>The error is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">foo1.lean</span><span class="o">:</span><span class="mi">8</span><span class="o">:</span><span class="mi">16</span>
<span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">pow</span> <span class="mi">9</span>
<span class="n">term</span>
  <span class="mi">9</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">ℝ</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">ℤ</span>
<span class="n">foo1.lean</span><span class="o">:</span><span class="mi">8</span><span class="o">:</span><span class="mi">16</span>
<span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="n">a</span> <span class="o">:</span> <span class="n">ℤ</span>
<span class="bp">⊢</span> <span class="n">has_pow</span> <span class="n">ℤ</span> <span class="n">ℝ</span>
</code></pre></div>
<p>I'm trying to figure out how to state this theorem:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">theorem</span> <span class="n">ex6e_mul_closed</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">):</span>
  <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))))</span> <span class="bp">*</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="n">d</span> <span class="bp">*</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))))</span><span class="bp">=</span>
  <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">d</span> <span class="bp">*</span> <span class="mi">3</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="n">d</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span> <span class="bp">*</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)))</span> <span class="o">:=</span>
  <span class="gr">sorry</span>
</code></pre></div>



<a name="221717869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221717869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221717869">(Jan 05 2021 at 23:50)</a>:</h4>
<p>Lean reads from left to right. Read <code>a*((9:ℝ) ^ ((1:ℝ)/(4:ℝ)))</code> from left to right. First we see <code>a</code>. This is an integer. Then we see <code>*</code>. That is multiplication, which takes two elements of type X and returns an element of type X. Then we solve for X, and it's easy to solve -- a is an integer, so X must be the integers. Then we read on and see real numbers instead of integers. Then we get confused and produce an error.</p>



<a name="221717970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221717970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221717970">(Jan 05 2021 at 23:51)</a>:</h4>
<p>The fix is to not let Lean solve for X incorrectly, by not letting it see the integer a, e.g. by writing <code>(a : ℝ)</code> instead of <code>a</code>. Then it will set X = reals and then you should hopefully be fine.</p>



<a name="221722383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221722383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221722383">(Jan 06 2021 at 00:51)</a>:</h4>
<p>The problem is that I have to have <code>a</code> be an integer for this particular theorem.  That's why I said <code>variable a : ℤ</code>. I am trying to prove that expressions of form a + b * 9^(1/4) are closed under multiplication, where a and b are integers and 9^(1/4) is a particular irrational number.   Writing <code>a : ℝ</code> won't get me there.</p>



<a name="221722588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221722588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221722588">(Jan 06 2021 at 00:54)</a>:</h4>
<p>I think Kevin's suggestion is not to replace the <code>variable</code> statement, but to add the type coercion to the expression you're interested in:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">variable</span> <span class="n">a</span> <span class="o">:</span> <span class="n">ℤ</span>

<span class="k">#check</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)))</span> <span class="c1">-- OK</span>

<span class="k">#check</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span><span class="bp">*</span><span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)))</span> <span class="c1">-- also OK</span>
</code></pre></div>



<a name="221723168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221723168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221723168">(Jan 06 2021 at 01:05)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> and <span class="user-mention" data-user-id="123965">@Bryan Gin-ge Chen</span>.  The following is a bit more awkward but it better represents what I am trying to prove, and doesn't raise an error, I guess because the <code>subring</code> tells Lean something that makes it  find a <code>has_pow</code> for this case:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">theorem</span> <span class="n">ex6e_mul_closed</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">,</span>
      <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">ℝ</span><span class="o">,</span>
      <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span>
      <span class="n">y</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span>
      <span class="n">z</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span>
      <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span><span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span>
      <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="bp">→</span>
      <span class="n">y</span> <span class="bp">=</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">d</span> <span class="bp">*</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="bp">→</span>
      <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">→</span>
      <span class="n">z</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">d</span> <span class="bp">*</span> <span class="mi">3</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">d</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>
      <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>



<a name="221723401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221723401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221723401">(Jan 06 2021 at 01:09)</a>:</h4>
<p>That's a strange way to state that. Shouldn't the last two lines just be <code>x * y \in s</code>?</p>



<a name="221723449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221723449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221723449">(Jan 06 2021 at 01:10)</a>:</h4>
<p>You seem to be mixing the proof with the theorem statement</p>



<a name="221723476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221723476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221723476">(Jan 06 2021 at 01:11)</a>:</h4>
<p>As Kevin said, Lean reads each expression from left to right, so it has no problem realizing that <code>a</code> in <code>x = a + b * ((9:ℝ) ^ (1/4:ℝ))</code> needs to be coerced to <code>ℝ</code>, since it's already seen <code>x</code> which is of type <code>ℝ</code>.</p>



<a name="221723584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221723584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221723584">(Jan 06 2021 at 01:13)</a>:</h4>
<p>I think your statement can be proved with <code>use [\top], ...</code> which shows your statement is wrong</p>



<a name="221724395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221724395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221724395">(Jan 06 2021 at 01:28)</a>:</h4>
<p>I'm trying to build up pieces of a proof that I have a subring by showing that the form <code>a+b*I</code> is closed under addition and multiplication where <code>I=(9:ℝ) ^ (1/4:ℝ)</code> and <code>a b: ℤ</code>.  So this is a lemma about closed under multiplication.  Here is an even more awkward statement of it:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">theorem</span> <span class="n">ex6e_mul_closed</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">,</span>
      <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">ℝ</span><span class="o">,</span>
      <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span>
      <span class="n">y</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span>
      <span class="n">z</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span>
      <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span><span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span>
      <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="bp">→</span>
      <span class="n">y</span> <span class="bp">=</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">d</span> <span class="bp">*</span> <span class="o">((</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="bp">→</span>
      <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">y</span> <span class="bp">→</span>
      <span class="bp">∃</span> <span class="n">e</span> <span class="n">f</span><span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span>
      <span class="n">e</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">d</span> <span class="bp">*</span> <span class="mi">3</span> <span class="bp">∧</span>
      <span class="n">f</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">d</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">c</span> <span class="bp">∧</span>
      <span class="n">z</span> <span class="bp">=</span> <span class="n">e</span> <span class="bp">+</span> <span class="n">f</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>
      <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>I am borrowing the <code>∃ s : subring ℝ</code> from the theorem I want to prove which is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>I'm just putting it up there to get the <code>has_pow</code> problem to go away.  It's chicken and egg though because I need to prove closed under multiplication before I have a <code>subring</code>, because it's part of the proof of <code>subring</code>.</p>
<p>I guess I have to rethink this and use <code>instance</code> or look at the structure for <code>subring</code> directly and prove the structure all at one time without lemmas.</p>
<p>Basically I need a framework where I can have a space where I prove the closed under multiplication and a space where I prove the closed under addition.  I guess that's an <code>instance</code>.</p>



<a name="221725120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221725120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221725120">(Jan 06 2021 at 01:43)</a>:</h4>
<p>The proof of closure is <code>s.mul_mem</code> for your subring lemma</p>



<a name="221725679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221725679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221725679">(Jan 06 2021 at 01:54)</a>:</h4>
<p>That's the right idea going in the wrong direction.  <code>s.mul_mem</code> says that if I have a subring already, then it is closed under multiplication. </p>
<p>I have to go the other way: I am closed under multiplication and addition, and hence I am a subring.  </p>
<p>So net net I need to do <code>instance: subring</code> of some sort  where what I am focusing on now is the <code>mul_mem'</code> and <code>add_mem'</code> fields of the structure, but I also have to do the other fields.  It looks like I can't do these facets as separate lemmas, I have to do everything all at once.  They have to be inside the proof of the <code>instance</code> so I can get Lean to give me <code>has_pow</code> between integers and reals while I am in the process of proving my subring, and not after I have proven the subring, which I can't assume because I haven't proven it yet.</p>
<p>Or I guess what you are saying is that Lean is coercing my integers to reals before applying <code>has_pow</code>. Which is OK but it is essential to the nature of what I am proving that my integers are integers "where it counts".  I guess "where it counts" is when I establish that the result of addition or multiplication is of form A+B*I where A and B are definitely integers and I is definitely the real 9^(1/4).</p>



<a name="221726133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221726133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221726133">(Jan 06 2021 at 02:04)</a>:</h4>
<p>You don't need an <code>instance</code>, you just need a structure. Your proof is the existence of such a structure. You can start your proof of an existence of such a subring (with whatever properties it has) with some statement about <code>subring.mk'</code> if you want.</p>



<a name="221726138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221726138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221726138">(Jan 06 2021 at 02:04)</a>:</h4>
<p>Can you post an image or a latex of the actual problem statement you are formalizing?</p>



<a name="221727027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221727027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221727027">(Jan 06 2021 at 02:23)</a>:</h4>
<p>6E:<br>
<a href="/user_uploads/3121/ToS9DynKtS7wTY3wHcwmSKLD/Screenshot-from-2021-01-05-21-23-27.png">Screenshot-from-2021-01-05-21-23-27.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/ToS9DynKtS7wTY3wHcwmSKLD/Screenshot-from-2021-01-05-21-23-27.png" title="Screenshot-from-2021-01-05-21-23-27.png"><img src="/user_uploads/3121/ToS9DynKtS7wTY3wHcwmSKLD/Screenshot-from-2021-01-05-21-23-27.png"></a></div>



<a name="221727163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221727163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221727163">(Jan 06 2021 at 02:26)</a>:</h4>
<p><code>a</code> and <code>b</code> have to start life as integers.  I can coerce them to real to do the multiplication with the <code>pow</code>, but I have to un-coerce the results of times and plus afterwards back to integer to prove the subring.</p>



<a name="221727394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221727394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221727394">(Jan 06 2021 at 02:31)</a>:</h4>
<p>Try this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≠</span> <span class="bp">⊤</span><span class="o">),</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">subring.mk'</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221728194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221728194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221728194">(Jan 06 2021 at 02:48)</a>:</h4>
<p>or use <code>subring.closure _</code></p>



<a name="221731015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731015">(Jan 06 2021 at 03:48)</a>:</h4>
<p>But I can't make it work:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">set_option</span> <span class="n">pp.all</span> <span class="n">true</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≠</span> <span class="bp">⊤</span><span class="o">),</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">set</span> <span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">set.insert</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">))</span> <span class="k">with</span> <span class="n">hs</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">subring.mk'</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">s</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="o">{</span><span class="n">carrier</span> <span class="o">:=</span> <span class="n">s</span><span class="o">,</span> <span class="n">one_mem'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span> <span class="n">mul_mem'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hs</span><span class="o">],</span>
      <span class="k">have</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">set.mem_insert_iff</span> <span class="n">ℝ</span> <span class="mi">1</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)),</span>
      <span class="n">rw</span> <span class="n">this</span><span class="o">,</span> <span class="c1">-- failure, they look the same to me though</span>
      <span class="gr">sorry</span>
    <span class="o">},</span>
  <span class="o">},</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221731024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731024">(Jan 06 2021 at 03:49)</a>:</h4>
<p>Is there some weird typo I made, or some typeclass issue?</p>



<a name="221731257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731257">(Jan 06 2021 at 03:54)</a>:</h4>
<p>If <code>rw</code> fails me I try <code>erw</code> instead</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="c1">--set_option pp.all true</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≠</span> <span class="bp">⊤</span><span class="o">),</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">set</span> <span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">set.insert</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">))</span> <span class="k">with</span> <span class="n">hs</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">subring.mk'</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">s</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="o">{</span><span class="n">carrier</span> <span class="o">:=</span> <span class="n">s</span><span class="o">,</span> <span class="n">one_mem'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span> <span class="n">mul_mem'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hs</span><span class="o">],</span>
      <span class="n">erw</span> <span class="n">set.mem_insert_iff</span><span class="o">,</span>
    <span class="o">},</span>
  <span class="o">},</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221731270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731270">(Jan 06 2021 at 03:54)</a>:</h4>
<p>In this case it does what you want, <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#erewrite%20/%20erw">https://leanprover-community.github.io/mathlib_docs/tactics.html#erewrite%20/%20erw</a></p>



<a name="221731507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731507">(Jan 06 2021 at 04:00)</a>:</h4>
<p>The root cause of the issue however is that you used <code>set.insert</code> to define <code>s</code> instead of <code>insert</code>, quite confusing indeed.</p>



<a name="221731520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731520">(Jan 06 2021 at 04:00)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="c1">--set_option pp.all true</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≠</span> <span class="bp">⊤</span><span class="o">),</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">set</span> <span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">insert</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">))</span> <span class="k">with</span> <span class="n">hs</span><span class="o">,</span> <span class="c1">-- CHANGED set.insert to insert here</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">subring.mk'</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">s</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="o">{</span><span class="n">carrier</span> <span class="o">:=</span> <span class="n">s</span><span class="o">,</span> <span class="n">one_mem'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span> <span class="n">mul_mem'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hs</span><span class="o">],</span>
      <span class="n">rw</span> <span class="n">set.mem_insert_iff</span><span class="o">,</span>
    <span class="o">},</span>
  <span class="o">},</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>also works then</p>



<a name="221731602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731602">(Jan 06 2021 at 04:02)</a>:</h4>
<p>To see this look at the last line of the error message you get from trying <code>rw set.mem_insert_iff</code></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">rewrite</span> <span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">did</span> <span class="n">not</span> <span class="n">find</span> <span class="kd">instance</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pattern</span> <span class="k">in</span> <span class="n">the</span> <span class="n">target</span> <span class="n">expression</span>
  <span class="bp">@</span><span class="n">has_mem.mem.</span><span class="o">{</span><span class="bp">?</span><span class="n">l_1</span> <span class="bp">?</span><span class="n">l_1</span><span class="o">}</span> <span class="bp">?</span><span class="n">m_2</span> <span class="o">(</span><span class="n">set.</span><span class="o">{</span><span class="bp">?</span><span class="n">l_1</span><span class="o">}</span> <span class="bp">?</span><span class="n">m_2</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">set.has_mem.</span><span class="o">{</span><span class="bp">?</span><span class="n">l_1</span><span class="o">}</span> <span class="bp">?</span><span class="n">m_2</span><span class="o">)</span> <span class="bp">?</span><span class="n">m_3</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">has_insert.insert.</span><span class="o">{</span><span class="bp">?</span><span class="n">l_1</span> <span class="bp">?</span><span class="n">l_1</span><span class="o">}</span> <span class="bp">?</span><span class="n">m_2</span> <span class="o">(</span><span class="n">set.</span><span class="o">{</span><span class="bp">?</span><span class="n">l_1</span><span class="o">}</span> <span class="bp">?</span><span class="n">m_2</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">set.has_insert.</span><span class="o">{</span><span class="bp">?</span><span class="n">l_1</span><span class="o">}</span> <span class="bp">?</span><span class="n">m_2</span><span class="o">)</span> <span class="bp">?</span><span class="n">m_4</span> <span class="bp">?</span><span class="n">m_5</span><span class="o">)</span>
</code></pre></div>
<p>its about <code>has_insert.insert</code>, but the goal is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code> <span class="bp">@</span><span class="n">has_mem.mem.</span><span class="o">{</span><span class="mi">0</span> <span class="mi">0</span><span class="o">}</span> <span class="n">real</span> <span class="o">(</span><span class="n">set.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">real</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">set.has_mem.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">real</span><span class="o">)</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">has_one.one.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">real</span> <span class="o">(</span><span class="bp">@</span><span class="n">monoid.to_has_one.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">real</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_monoid.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">real</span> <span class="n">real.ring</span><span class="o">)))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">set.insert.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">real</span> <span class="bp">......</span><span class="o">)</span>
</code></pre></div>
<p>which refers to <code>set.insert</code> instead.</p>



<a name="221731632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731632">(Jan 06 2021 at 04:03)</a>:</h4>
<p>These things are equal under the hood which is why <code>erw</code> works, but syntactically they don't look the same so <code>rw</code> fails.</p>



<a name="221731725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221731725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221731725">(Jan 06 2021 at 04:05)</a>:</h4>
<p>If you look at <a href="https://leanprover-community.github.io/mathlib_docs/find/set.insert/src">src#set.insert</a> you'll see it is a <code>protected def</code> which is maybe a bit of a hint you aren't meant to be calling it directly</p>



<a name="221734319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221734319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221734319">(Jan 06 2021 at 05:03)</a>:</h4>
<p>Thanks for the lift.  I guess as long as we know that <code>a</code> and <code>b</code> are integers in <code>∀ (a b : ℤ)</code> it is fine for <code>a</code> to be lifted to ℝ inside the ∀.  I would have thought that it was <code>b</code> that needed to be lifted since that is what is multiplied by the power.</p>
<p>I don't understand why technically you need to say <code>s ≠ ⊤</code>.  What is  <code>⊤</code>, all of the reals?  Because all of the reals will not be expressible as a + b * 9^(1/4) for  <code>a b : ℤ</code>, so I don't know why the exclusion is necessary.</p>



<a name="221734487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221734487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221734487">(Jan 06 2021 at 05:06)</a>:</h4>
<p>I think the formalization might be something like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≠</span> <span class="bp">⊤</span><span class="o">),</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">subring.closure</span> <span class="o">{</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">),</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">},</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>
  <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221734493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221734493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221734493">(Jan 06 2021 at 05:06)</a>:</h4>
<p>but I think there might be some lemmas missing about <code>subring.closure</code> to show this</p>



<a name="221734540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221734540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221734540">(Jan 06 2021 at 05:07)</a>:</h4>
<p>The <code>hs : s ≠ ⊤</code> is necessary because like Eric said above, the full <code>ℝ</code> does have the property that <code>(a : ℝ) + b * (9 ^ ((1 : ℝ) / 4)) ∈</code> "all of the reals".</p>



<a name="221734596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221734596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221734596">(Jan 06 2021 at 05:08)</a>:</h4>
<p>And I think the exercise is to show that a strict subset of the reals is still an integral domain, or in the language here, a subring.</p>



<a name="221735042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735042">(Jan 06 2021 at 05:18)</a>:</h4>
<p>But 'a : ℤ', which should be enough information to exclude 's ≠ ⊤'.  We know that under 'a : ℤ', the expression '(a : ℝ) + b * (9 ^ ((1 : ℝ) / 4))' is equivalent to '(a : ℤ) + b * (9 ^ ((1 : ℝ) / 4))'.  The only thing stopping us from saying the latter is some technicality in Lean about no <code>has_pow</code> for <br>
ℤ and ℝ together.  Once you have '(a : ℤ) + b * (9 ^ ((1 : ℝ) / 4))', <code>⊤</code> is not a contender.  So it shouldn't be necessary to put it in the theorem statement, because the <code>a : ℤ</code> in the quantifier is enough information already to exclude top.</p>



<a name="221735351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735351" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735351">(Jan 06 2021 at 05:26)</a>:</h4>
<p>When I wrote <code> ∀ (a b : ℤ), (a : ℝ)...</code> that just indicates that I require <code>a</code> and <code>b</code> to be integers. They're then cast to reals.</p>



<a name="221735368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735368">(Jan 06 2021 at 05:27)</a>:</h4>
<p>I've moved it along a little.  I should be able to apply <code>subring.mul_mem</code> but it is not matching although it looks exactly like it should:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">lemma</span> <span class="n">one_in_Z</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">set.range</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≠</span> <span class="bp">⊤</span><span class="o">),</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">set</span> <span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">insert</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">))</span> <span class="k">with</span> <span class="n">hs</span><span class="o">,</span> <span class="c1">-- CHANGED set.insert to insert here</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">subring.mk'</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">s</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="o">{</span><span class="n">carrier</span> <span class="o">:=</span> <span class="n">s</span><span class="o">,</span> <span class="n">one_mem'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">,</span> <span class="n">mul_mem'</span> <span class="o">:=</span> <span class="n">_</span><span class="o">},</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hs</span><span class="o">],</span>
      <span class="n">rw</span> <span class="n">set.mem_insert_iff</span><span class="o">,</span>
      <span class="n">right</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">one_in_Z</span><span class="o">,</span>
    <span class="o">},</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">h2</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">subring.mul_mem</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>where the goal state is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Tactic</span> <span class="n">state</span>
<span class="n">widget</span>
<span class="n">filter</span><span class="o">:</span>
<span class="n">no</span> <span class="n">filter</span>
<span class="mi">1</span> <span class="n">goal</span>
<span class="n">s</span><span class="o">:</span> <span class="n">set</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">insert</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="n">coe</span><span class="o">)</span>
<span class="n">hs</span><span class="o">:</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">insert</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="n">coe</span><span class="o">)</span>
<span class="n">ab</span><span class="o">:</span> <span class="n">ℝ</span>
<span class="n">h1</span><span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span>
<span class="n">h2</span><span class="o">:</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span>
<span class="bp">⊢</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span>
</code></pre></div>
<p>and the error is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">subring.mul_mem</span> <span class="n">h1</span>
<span class="n">term</span>
  <span class="n">h1</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:</span> <span class="kt">Prop</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">subring</span> <span class="bp">?</span><span class="n">m_1</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="n">insert</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="n">coe</span><span class="o">),</span>
<span class="n">hs</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">insert</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="o">(</span><span class="n">set.range</span> <span class="n">coe</span><span class="o">),</span>
<span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">,</span>
<span class="n">h1</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">,</span>
<span class="n">h2</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span>
<span class="bp">⊢</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span>
</code></pre></div>



<a name="221735380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735380">(Jan 06 2021 at 05:27)</a>:</h4>
<p>For sure, for any <code>(a b : ℤ)</code>, <code>a + b * (9 ^ 1 / 4)  ∈ ℝ</code> (to use set theory notation.</p>



<a name="221735445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735445">(Jan 06 2021 at 05:29)</a>:</h4>
<p>I don't think my original approach works because just inserting this 9^x value isn't enough to make that set closed. You won't be able to prove <code>mul_mem'</code>.</p>



<a name="221735510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735510">(Jan 06 2021 at 05:30)</a>:</h4>
<p><span class="user-mention" data-user-id="308899">@Yakov Pechersky</span> they are cast to reals for a technical reason, but the information in the environment, provided by the quantifier, should still include the fact that <code>a</code> and <code>b</code> are integers.  You can't, to my mind, prove the subring without using that information.   Completely forgetting that <code>a</code> is an integer forces you to say <code>s ≠ ⊤</code> but that is not an insightful statement.  All that is saying is "I forget that I just said that <code>a</code> is an integer".  There should be a way of retaining that type information about <code>a</code> in the tactic state and then doing the coercion to make <code>has_pow</code> happy.  It is  not insightful to lose information and than replace it with another tangentially equivalent restriction.</p>



<a name="221735514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735514">(Jan 06 2021 at 05:30)</a>:</h4>
<p>The error message is telling you what isn't matching</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">subring.mul_mem</span> <span class="n">h1</span>
<span class="n">term</span>
  <span class="n">h1</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:</span> <span class="kt">Prop</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">subring</span> <span class="bp">?</span><span class="n">m_1</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span>
</code></pre></div>
<p>the complaint is exactly that the first argument of <a href="https://leanprover-community.github.io/mathlib_docs/find/subring.mul_mem">docs#subring.mul_mem</a> should be a <code>subring R</code> of some ring <code>R</code>, then the second and third arguments are two proofs of membership of that subring</p>



<a name="221735526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735526">(Jan 06 2021 at 05:31)</a>:</h4>
<p>Yes subring of R is what we are trying to prove, it is not an assumption.</p>



<a name="221735571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735571">(Jan 06 2021 at 05:32)</a>:</h4>
<p>It does remember! It'll show <code>↑1</code> for my <code>(1 : ℤ)</code> which is in an expression that expects an ℝ.</p>



<a name="221735647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735647">(Jan 06 2021 at 05:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="364351">Lars Ericson</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real/near/221735526">said</a>:</p>
<blockquote>
<p>Yes subring of R is what we are trying to prove, it is not an assumption.</p>
</blockquote>
<p>Right so you can't apply that lemma!</p>



<a name="221735670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735670">(Jan 06 2021 at 05:35)</a>:</h4>
<p>I think of <code>a + b X </code>where<code> X = 9^(1/4)</code> as a pair or a vector <code>&lt;a,b&gt;</code> where X is a kind of basis vector.  The insight is that it is a ring of 2-element vectors with a slightly funny multiplication operation.  The proof has to start with definition of addition and multiplication on such pairs and that such pairs multiplied or added are also pairs.  The <code>has_pow</code> takes away from that insight, it is a kind of detour.</p>



<a name="221735736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735736">(Jan 06 2021 at 05:37)</a>:</h4>
<p>In other words we are spending a lot of time on coercions and <code>has_pow</code>s and so on because we are losing sight of the idea that we have encoded integer pairs with a trick involving a single irrational real.</p>



<a name="221735878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221735878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221735878">(Jan 06 2021 at 05:40)</a>:</h4>
<p>So <code>0 = &lt;0, 0&gt;</code>,  <code>1 = &lt;1,0&gt;</code>, otherwise you have <code>&lt;a,b&gt;</code> where <code>a,b</code> are integers, and <code>&lt;a,b&gt;+&lt;c,d&gt; = &lt;a+c,b+d&gt;</code> and <code>&lt;a,b&gt;*&lt;c,d&gt; = &lt;a*c+*d*3, a*d+b*c&gt;</code>.  It's really proving that pairs with that definition of + and * form a ring.  The pairs are isomorphic to <code>a + b *9^(1/4)</code>.  It seems like it would be easier to prove</p>
<ul>
<li>The isomorphism of pairs to that expression</li>
<li>That the pairs under that * and + are a ring</li>
</ul>
<p>than to get lost in coercions between integers and reals and complicated libraries of definitions on <code>pow</code>.</p>



<a name="221736083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221736083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221736083">(Jan 06 2021 at 05:46)</a>:</h4>
<p>This is what I mean currently:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">hs</span> <span class="o">:</span> <span class="n">s</span> <span class="bp">≠</span> <span class="bp">⊤</span><span class="o">),</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">((</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">∈</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">use</span> <span class="bp">⊤</span><span class="o">,</span> <span class="c1">-- use the whole ring of reals, the top of the subring lattice</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span> <span class="c1">-- here I am ignoring the fact I have to prove the hs hypothesis</span>
  <span class="n">simp</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221736084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221736084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221736084">(Jan 06 2021 at 05:46)</a>:</h4>
<p>It's what Eric remarked on earlier.</p>



<a name="221736542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221736542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221736542">(Jan 06 2021 at 05:57)</a>:</h4>
<p>Here's how I'd structure this exercise (and some of the proofs) if asked to formalise it:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">lemma</span> <span class="n">important</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">:=</span> <span class="kd">begin</span> <span class="gr">sorry</span> <span class="kd">end</span>
<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">s</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span><span class="o">,</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">↔</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="bp">∧</span> <span class="n">is_integral_domain</span> <span class="n">s</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">important</span><span class="o">,</span> <span class="c1">-- 9^1/4 is ugly, use sqrt 3 instead (likely more lemmas in library about sqrt so this will make our life easier)</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">subring.mk</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">,</span> <span class="o">⟨</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩⟩,</span> <span class="c1">-- separate out all the goals</span>
  <span class="n">rotate</span> <span class="mi">6</span><span class="o">,</span> <span class="c1">-- we want our subring to be defined to be the a + b * (9:ℝ) ^ (1/4:ℝ)  so switch to that goal first</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">refl</span><span class="o">,</span> <span class="o">},</span> <span class="c1">-- saying to lean this is true by definition forces the subring to have the elements we want, without having to do a set s := ..</span>
  <span class="n">rotate</span> <span class="mi">1</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">use</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">0</span><span class="o">],</span> <span class="n">norm_num</span><span class="o">,</span> <span class="o">},</span> <span class="c1">-- 1 and 0 are easy thanks to norm num</span>
  <span class="o">{</span> <span class="gr">sorry</span><span class="o">,</span> <span class="o">},</span> <span class="c1">-- this can hopefully done like the negation below, maybe using the ring, norm_num and linarith tactics.</span>
  <span class="o">{</span> <span class="n">use</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">],</span> <span class="n">norm_num</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="n">x</span> <span class="o">⟨</span><span class="n">haa</span><span class="o">,</span> <span class="n">hab</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="n">use</span> <span class="o">[</span><span class="bp">-</span><span class="n">haa</span><span class="o">,</span> <span class="bp">-</span><span class="n">hab</span><span class="o">],</span> <span class="n">rw</span> <span class="n">neg_add</span><span class="o">,</span> <span class="n">simp</span><span class="o">,</span> <span class="o">},</span> <span class="c1">-- this is doing the "basis vector" thing lars is referring to using rintro splits our subring element x into components haa hab the rfl part clears all mention of x now we have decomposed it into its components</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">use</span> <span class="o">[</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">],</span> <span class="n">simp</span><span class="o">,</span> <span class="o">},</span> <span class="c1">-- maybe library_search does this too...</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">mul_comm</span><span class="o">,</span> <span class="o">},</span> <span class="c1">-- library_search</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">exact</span> <span class="n">mul_eq_zero.mp</span><span class="o">,</span> <span class="o">},</span> <span class="c1">-- library_search</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221743542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221743542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221743542">(Jan 06 2021 at 08:25)</a>:</h4>
<p>Now can you do it using <code>subring.closure { real.sqrt 3 }</code>?</p>



<a name="221743669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221743669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221743669">(Jan 06 2021 at 08:27)</a>:</h4>
<p>Do what, show that above criterion for membership, or show it is an integral domain?</p>



<a name="221743943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221743943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221743943">(Jan 06 2021 at 08:31)</a>:</h4>
<p>Ideally, the lemmas about <code>subring.closure</code> should allow you to say:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">refine</span> <span class="o">⟨</span><span class="n">subring.closure</span> <span class="o">{</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">}</span> <span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
</code></pre></div>
<p>instead</p>



<a name="221744210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221744210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221744210">(Jan 06 2021 at 08:35)</a>:</h4>
<p>Oh for sure, if the goal is to formalise that same object in a easy to work with way I'd set everything up totally differently, I was just trying to match the exercise as closely as possible.</p>



<a name="221744710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221744710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221744710">(Jan 06 2021 at 08:43)</a>:</h4>
<p>btw the last line can be expressed as:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="o">{</span> <span class="n">exact</span> <span class="bp">@</span><span class="n">integral_domain.to_is_integral_domain</span> <span class="n">_</span> <span class="o">(</span><span class="n">subring.subring.domain</span> <span class="n">_</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>



<a name="221744735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221744735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221744735">(Jan 06 2021 at 08:43)</a>:</h4>
<p>because the parent ring on <code>ℝ</code> is also an integral domain</p>



<a name="221744789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221744789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221744789">(Jan 06 2021 at 08:44)</a>:</h4>
<p>But I guess proving that is part of the exercise</p>



<a name="221745324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221745324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221745324">(Jan 06 2021 at 08:52)</a>:</h4>
<p>Yeah my solution is probably cheating via the typeclass mechanism really, at least in a pen and paper proof you would mention subrings of domains being domains explicitly.</p>



<a name="221746762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221746762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221746762">(Jan 06 2021 at 09:12)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span>' statement is the only correct one so far</p>



<a name="221746804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221746804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221746804">(Jan 06 2021 at 09:13)</a>:</h4>
<p>The <code>iff</code> is crucial, otherwise it allows larger subrings than the question permits</p>



<a name="221748549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221748549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221748549">(Jan 06 2021 at 09:39)</a>:</h4>
<p>By the way this ring already exists in mathlib, it's called <code>zsqrtd 3</code></p>



<a name="221748903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221748903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221748903">(Jan 06 2021 at 09:45)</a>:</h4>
<p>Presumably there's some way to interpret <a href="https://leanprover-community.github.io/mathlib_docs/find/zsqrtd">docs#zsqrtd</a> as asubring?</p>



<a name="221748998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221748998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221748998">(Jan 06 2021 at 09:46)</a>:</h4>
<p>Sending it through a coercion ring hom would do the trick I assume, although I don't know where the def is for that</p>



<a name="221749059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221749059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221749059">(Jan 06 2021 at 09:47)</a>:</h4>
<p>I'm a little surprised that zqrtd has no coercion to real...</p>



<a name="221749283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221749283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221749283">(Jan 06 2021 at 09:50)</a>:</h4>
<p>Well according to the copyright headers its older than real <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="221749838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221749838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221749838">(Jan 06 2021 at 09:59)</a>:</h4>
<p>I'll make a pr</p>



<a name="221755534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221755534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221755534">(Jan 06 2021 at 11:08)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">to_real</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>
</code></pre></div>
<p>seems like the def needed, which proves the subring as <code>to_real.range</code></p>



<a name="221755705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221755705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221755705">(Jan 06 2021 at 11:10)</a>:</h4>
<p>I was hoping to be able to also prove</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">to_real_injective</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">(</span><span class="n">h_not_square</span> <span class="o">:</span> <span class="bp">¬∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span><span class="bp">*</span><span class="n">x</span> <span class="bp">=</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">function.injective</span> <span class="o">(</span><span class="n">to_real</span> <span class="n">h</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">to_real</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">injective_iff.mpr</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">to_real_apply</span><span class="o">]</span> <span class="n">at</span> <span class="n">ha</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">-</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
          <span class="n">a.re</span> <span class="bp">*</span> <span class="n">a.re</span> <span class="bp">-</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">a.im</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
  <span class="n">replace</span> <span class="n">ha</span> <span class="o">:=</span> <span class="n">congr_arg</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="o">(</span><span class="n">a.re</span><span class="o">)</span> <span class="bp">-</span> <span class="bp">↑</span><span class="o">(</span><span class="n">a.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span><span class="o">))</span> <span class="n">ha</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)]</span> <span class="n">at</span> <span class="n">ha</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">sub_eq_zero</span> <span class="n">at</span> <span class="n">ha</span><span class="o">,</span>
  <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">ha</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">h_not_square</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>but I think I'm missing some knowledge of the lemmas to apply</p>



<a name="221758766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221758766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221758766">(Jan 06 2021 at 11:51)</a>:</h4>
<p>A number-theoretic ring like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><msqrt><mi>d</mi></msqrt><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[\sqrt{d}]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.18222em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">Z</span></span><span class="mopen">[</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.93222em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">d</span></span></span><span style="top:-2.89222em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg height="1.08em" preserveAspectRatio="xMinYMin slice" viewBox="0 0 400000 1080" width="400em"><path d="M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.10777999999999999em;"><span></span></span></span></span></span><span class="mclose">]</span></span></span></span> has two maps to the reals and it's not clear to me that the one you're thinking of is any better than the other one. <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><msqrt><mi>d</mi></msqrt><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[\sqrt{d}]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.18222em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">Z</span></span><span class="mopen">[</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.93222em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">d</span></span></span><span style="top:-2.89222em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg height="1.08em" preserveAspectRatio="xMinYMin slice" viewBox="0 0 400000 1080" width="400em"><path d="M95,702 c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14 c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54 c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10 s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429 c69,-144,104.5,-217.7,106.5,-221 l0 -0 c5.3,-9.3,12,-14,20,-14 H400000v40H845.2724 s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7 c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.10777999999999999em;"><span></span></span></span></span></span><span class="mclose">]</span></span></span></span> should not be thought of as a subring of the reals, it is notation for the abstract ring <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mo stretchy="false">[</mo><mi>X</mi><mo stretchy="false">]</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><msup><mi>X</mi><mn>2</mn></msup><mo>−</mo><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbb{Z}[X]/(X^2-d)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">Z</span></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">]</span><span class="mord">/</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> is no more positive than it is negative.</p>



<a name="221759996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221759996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221759996">(Jan 06 2021 at 12:06)</a>:</h4>
<p>That's perhaps an argument against it being a coe, but I think the mapping should probably still exist</p>



<a name="221760011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760011">(Jan 06 2021 at 12:06)</a>:</h4>
<p>Both should ;-)</p>



<a name="221760093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760093">(Jan 06 2021 at 12:07)</a>:</h4>
<p>This is a great example of an object with a canonical non-trivial automorphism, so everything either is invariant under the automorphism or comes in pairs.</p>



<a name="221760256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760256">(Jan 06 2021 at 12:09)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/5640">#5640</a></p>



<a name="221760269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760269">(Jan 06 2021 at 12:09)</a>:</h4>
<p>I only added <code>to_real</code> because we only have <code>real.sqrt</code></p>



<a name="221760316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760316">(Jan 06 2021 at 12:10)</a>:</h4>
<p>If you want the other one you can use <code>conj.to_real</code></p>



<a name="221760342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760342">(Jan 06 2021 at 12:10)</a>:</h4>
<p>That's generally the rule when you only have one of the pair ;-)</p>



<a name="221760429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760429">(Jan 06 2021 at 12:12)</a>:</h4>
<p>alternative approach:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">to_real_injective</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">(</span><span class="n">h_not_square</span> <span class="o">:</span> <span class="bp">¬∃</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span><span class="bp">*</span><span class="n">x</span> <span class="bp">=</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">function.injective</span> <span class="o">(</span><span class="n">to_real</span> <span class="n">h</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">to_real</span> <span class="n">h</span><span class="o">)</span><span class="bp">.</span><span class="n">injective_iff.mpr</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">to_real_apply</span><span class="o">]</span> <span class="n">at</span> <span class="n">ha</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">irrational_nrt_of_notint_nrt</span> <span class="mi">2</span> <span class="n">d</span> <span class="o">(</span><span class="kd">by</span> <span class="gr">sorry</span> <span class="o">:</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">=</span><span class="n">d</span><span class="o">),</span>
  <span class="n">specialize</span> <span class="n">this</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">haim</span> <span class="o">:</span> <span class="n">a.im</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">rat_add</span> <span class="n">a.re</span> <span class="o">(</span><span class="n">rat_mul</span> <span class="n">this</span> <span class="o">(</span><span class="kd">by</span> <span class="n">exact_mod_cast</span> <span class="n">haim</span> <span class="o">:</span> <span class="o">(</span><span class="n">a.im</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)),</span>
  <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">ha</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">exfalso</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">rat.not_irrational</span> <span class="mi">0</span> <span class="o">(</span><span class="kd">by</span> <span class="n">exact_mod_cast</span> <span class="n">this</span><span class="o">),</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221760825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760825">(Jan 06 2021 at 12:18)</a>:</h4>
<p>I've solved the lemma in the PR</p>



<a name="221760872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221760872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221760872">(Jan 06 2021 at 12:18)</a>:</h4>
<p>So alternative approaches fine, but the bar is now sorry-free :)</p>



<a name="221761004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221761004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221761004">(Jan 06 2021 at 12:20)</a>:</h4>
<p><span class="user-mention" data-user-id="364351">@Lars Ericson</span>, with that PR, your problem can now be solved as:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- This definition is what each question in exercise 6 is asking. No need to restate it each time</span>
<span class="kd">abbreviation</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>where the final goals ought to be fairly easy to close without any knowledge of the reals</p>



<a name="221771490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221771490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221771490">(Jan 06 2021 at 14:18)</a>:</h4>
<p>Thank you all very much.  I just did a <code>leanproject upgrade-mathlib</code> which I guess gets me the PR.  I will try to fill out the <code>sorry</code> in Eric's final version.</p>



<a name="221771515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221771515" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221771515">(Jan 06 2021 at 14:18)</a>:</h4>
<p>It does not get you the PR, because the PR is not merged yet!</p>



<a name="221771612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221771612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221771612">(Jan 06 2021 at 14:19)</a>:</h4>
<p>However, you can still use the <code>abbreviation ex6</code>definition without the PR</p>



<a name="221771759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221771759" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221771759">(Jan 06 2021 at 14:21)</a>:</h4>
<p>It still wants <code>has_pow</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>

<span class="c1">-- This definition is what each question in exercise 6 is asking. No need to restate it each time</span>
<span class="kd">abbreviation</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>gives error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">,</span>
<span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span>
<span class="bp">⊢</span> <span class="n">has_pow</span> <span class="n">ℝ</span> <span class="n">ℝ</span>
</code></pre></div>



<a name="221771807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221771807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221771807">(Jan 06 2021 at 14:21)</a>:</h4>
<p>Yes, you need <code>import analysis.special_functions.pow</code></p>



<a name="221771945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221771945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221771945">(Jan 06 2021 at 14:22)</a>:</h4>
<p>It wants one more definition, should I add that lemma <code>to_real_injective</code> above?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">unknown</span> <span class="n">identifier</span> <span class="bp">'</span><span class="n">zsqrtd.to_real'</span>
<span class="n">state</span><span class="o">:</span>
<span class="bp">⊢</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b</span> <span class="bp">*</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)}</span>
</code></pre></div>



<a name="221771988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221771988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221771988">(Jan 06 2021 at 14:23)</a>:</h4>
<p>You need this one: <a href="#narrow/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real/near/221755534">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real/near/221755534</a></p>



<a name="221772044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221772044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221772044">(Jan 06 2021 at 14:23)</a>:</h4>
<p>You don't need the injectivity one, I added that because I thought it might be useful to someone</p>



<a name="221772149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221772149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221772149">(Jan 06 2021 at 14:24)</a>:</h4>
<p>It wants a <code>d</code>.</p>



<a name="221772204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221772204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221772204">(Jan 06 2021 at 14:25)</a>:</h4>
<p>Should I add <code>variable d: ℕ </code> in context?</p>



<a name="221772333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221772333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221772333">(Jan 06 2021 at 14:26)</a>:</h4>
<p>Just add <code>{d : ℕ}</code> after the word <code>to_real</code></p>



<a name="221772343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221772343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221772343">(Jan 06 2021 at 14:26)</a>:</h4>
<p>I can't make it happy.  This is my starting point:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kn">namespace</span> <span class="n">zsqrtd</span>

<span class="kd">variable</span> <span class="n">d</span><span class="o">:</span> <span class="n">ℕ</span>

<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">to_real</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="kd">end</span> <span class="n">zsqrtd</span>

<span class="c1">-- This definition is what each question in exercise 6 is asking. No need to restate it each time</span>
<span class="kd">abbreviation</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>it's giving me</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span>
<span class="n">term</span>
  <span class="n">h</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="mi">0</span> <span class="bp">≤</span> <span class="bp">?</span><span class="n">m_1</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">d</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">,</span>
<span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√↑</span><span class="n">d</span><span class="o">,</span>
<span class="n">this</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">↑</span><span class="o">(</span><span class="n">a.re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">a.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="o">(</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">b.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
    <span class="bp">↑</span><span class="o">(</span><span class="n">a.re</span><span class="o">)</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="o">(</span><span class="n">a.re</span><span class="o">)</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="n">b.im</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">a.im</span><span class="o">)</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="n">b.re</span><span class="o">))</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">+</span>
      <span class="bp">↑</span><span class="o">(</span><span class="n">a.im</span><span class="o">)</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="n">b.im</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span><span class="o">)</span>
<span class="bp">⊢</span> <span class="bp">↑</span><span class="o">((</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">((</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span> <span class="bp">=</span>
    <span class="o">(</span><span class="bp">↑</span><span class="o">(</span><span class="n">a.re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">a.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="o">(</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">b.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="bp">↑</span><span class="n">d</span><span class="o">)</span>
</code></pre></div>



<a name="221772394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221772394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221772394">(Jan 06 2021 at 14:27)</a>:</h4>
<p>d should be a <code>\Z</code></p>



<a name="221772450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221772450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221772450">(Jan 06 2021 at 14:27)</a>:</h4>
<p>Thank you.  This is my starting point, it checks:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">zsqrtd.to_real</span> <span class="o">{</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="c1">-- This definition is what each question in exercise 6 is asking. No need to restate it each time</span>
<span class="kd">abbreviation</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221772628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221772628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221772628">(Jan 06 2021 at 14:28)</a>:</h4>
<p>Great! You'll want to start by proving <code>lemma important : (9:ℝ) ^ (1/4:ℝ) = real.sqrt 3 := begin sorry end</code>.</p>



<a name="221773493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221773493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221773493">(Jan 06 2021 at 14:36)</a>:</h4>
<p>Should be easy.  I've done similar ones while golfing over last few days:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">nine_equals_3_times_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">a_squared_equals_a_times_a</span> <span class="o">(</span><span class="n">a</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span><span class="bp">*</span><span class="n">a</span> <span class="bp">=</span> <span class="n">a</span><span class="bp">^</span><span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">nine_equals_3_squared</span> <span class="o">:</span>  <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">((</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">nine_equals_3_times_3</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">a_squared_equals_a_times_a</span> <span class="mi">3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h2</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">assumption</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221773731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221773731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221773731">(Jan 06 2021 at 14:38)</a>:</h4>
<p><code>a_squared_equals_a_times_a </code>is <a href="https://leanprover-community.github.io/mathlib_docs/find/pow_two">docs#pow_two</a> (or rather, its reverse)</p>



<a name="221773754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221773754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221773754">(Jan 06 2021 at 14:38)</a>:</h4>
<p>Always try <code>library_search</code> for trivial lemmas like that first :)</p>



<a name="221845088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221845088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221845088">(Jan 07 2021 at 01:02)</a>:</h4>
<p>How do I prove that 2 = 2?  I need it for the 2nd lemma <code>x_mul_x_pow_y_equals_x_pow_y_plus_y</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">two_equals_two</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="gr">sorry</span>

<span class="kd">lemma</span> <span class="n">x_mul_x_pow_y_equals_x_pow_y_plus_y</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">x</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span><span class="bp">^</span><span class="n">y</span> <span class="bp">=</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="n">y</span><span class="bp">+</span><span class="n">y</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">ring</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">real.rpow_mul</span> <span class="n">h</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="n">y</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>The first lemma won't typecheck in the <code>=</code>, giving:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="mi">2</span> <span class="bp">=</span> <span class="mi">2</span>
<span class="n">term</span>
  <span class="mi">2</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">ℝ</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">ℕ</span>
</code></pre></div>
<p>The 2nd lemma won't go through because I have a mismatch of <code>2:ℕ</code> versus <code>2:ℝ</code> that I can't get rid of because the <code>2:ℕ</code>  is coming in under the hood without my control.  Here is the goal state on the 2nd lemma:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">1</span> <span class="n">goal</span>
<span class="n">xy</span><span class="o">:</span> <span class="n">ℝ</span>
<span class="n">h</span><span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">x</span>
<span class="n">h1</span><span class="o">:</span> <span class="n">x</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">x</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">^</span> <span class="n">y</span>
<span class="bp">⊢</span> <span class="o">(</span><span class="n">x</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">^</span> <span class="n">y</span> <span class="bp">=</span> <span class="o">(</span><span class="n">x</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">^</span> <span class="n">y</span>
<span class="n">All</span> <span class="n">Messages</span> <span class="o">(</span><span class="mi">8</span><span class="o">)</span>
</code></pre></div>
<p>I should be done but the above-mentioned widget is telling me that not all 2s are alike and I don't know how to coerce my 2:N to a 2:R.</p>
<p>This is all in service of getting closer to the goal of proving the <code>important</code> lemma above.   This is where I'm stuck now.</p>



<a name="221845360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221845360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221845360">(Jan 07 2021 at 01:06)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">two_equals_two</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>
</code></pre></div>



<a name="221845375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221845375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221845375">(Jan 07 2021 at 01:06)</a>:</h4>
<p>Not that the real has to be on the LHS for the casting to work properly.</p>



<a name="221845497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221845497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221845497">(Jan 07 2021 at 01:08)</a>:</h4>
<p>You might like <a href="https://leanprover-community.github.io/mathlib_docs/find/mul_rpow">docs#mul_rpow</a></p>



<a name="221846264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221846264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221846264">(Jan 07 2021 at 01:21)</a>:</h4>
<p>I'll try going that way.  I'm using the other direction <code>rpow_mul</code>. The <code>two_equals_two</code> lemma doesn't work as a rewrite rule.  I can't get this lemma to close, the goal definitely has a <code>2:ℕ</code> in it but <code>rw ← two_equals_two</code> won't bind:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">lemma</span> <span class="n">two_equals_two</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">x_mul_x_pow_y_equals_x_pow_y_plus_y</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">x</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span><span class="bp">^</span><span class="n">y</span> <span class="bp">=</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="n">y</span><span class="bp">+</span><span class="n">y</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">ring</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">real.rpow_mul</span> <span class="n">h</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="n">y</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">eq.symm</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">conv</span>
  <span class="kd">begin</span>
    <span class="n">to_lhs</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">two_equals_two</span><span class="o">,</span> <span class="c1">-- FAIL</span>
  <span class="kd">end</span><span class="o">,</span>

<span class="kd">end</span>
</code></pre></div>



<a name="221846502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221846502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221846502">(Jan 07 2021 at 01:25)</a>:</h4>
<p>Your lemma isn't true is <code>x = 0</code> and <code>y = 0</code></p>



<a name="221846760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221846760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221846760">(Jan 07 2021 at 01:28)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">lemma</span> <span class="n">two_equals_two</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>

<span class="kd">lemma</span> <span class="n">x_mul_x_pow_y_equals_x_pow_y_plus_y</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">x</span> <span class="bp">→</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">y</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span><span class="bp">^</span><span class="n">y</span> <span class="bp">=</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="n">y</span><span class="bp">+</span><span class="n">y</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intros</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">real.mul_rpow</span> <span class="n">hx</span> <span class="n">hx</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">eq_or_lt_of_le</span> <span class="n">hx</span> <span class="k">with</span> <span class="n">rfl</span><span class="bp">|</span><span class="n">hx</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">real.zero_rpow</span> <span class="o">(</span><span class="n">ne_of_gt</span> <span class="n">hy</span><span class="o">),</span>
    <span class="n">rw</span> <span class="n">real.zero_rpow</span> <span class="o">(</span><span class="n">ne_of_gt</span> <span class="o">(</span><span class="n">add_pos</span> <span class="n">hy</span> <span class="n">hy</span><span class="o">)),</span>
    <span class="n">rw</span> <span class="n">zero_mul</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="n">real.rpow_add</span> <span class="n">hx</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221847140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221847140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221847140">(Jan 07 2021 at 01:35)</a>:</h4>
<p>As you can see, no knowledge of some equality of cast nats needed.</p>



<a name="221847498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221847498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221847498">(Jan 07 2021 at 01:41)</a>:</h4>
<p>Thanks I got there the other way but with <code>x &lt; 0</code>, and no 2's using your <code>rpow_add</code> suggestion:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">lemma</span> <span class="n">le_if_leq</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="bp">→</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_mul_x_pow_y_equals_x_pow_y_plus_y</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span><span class="bp">^</span><span class="n">y</span> <span class="bp">=</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="n">y</span><span class="bp">+</span><span class="n">y</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">le_if_leq</span> <span class="n">x</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">real.mul_rpow</span> <span class="n">x</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h1</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h2</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">real.rpow_add</span> <span class="n">h</span> <span class="n">y</span> <span class="n">y</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h3</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221847700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221847700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221847700">(Jan 07 2021 at 01:44)</a>:</h4>
<p>The first one is <code>le_of_lt</code></p>



<a name="221848885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221848885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221848885">(Jan 07 2021 at 02:05)</a>:</h4>
<p><span class="user-mention" data-user-id="308899">@Yakov Pechersky</span> thanks for the help.  <span class="user-mention" data-user-id="310045">@Eric Wieser</span> I have now proved <code>lemma important : (9:ℝ) ^ (1/4:ℝ) = real.sqrt 3</code> as you suggested, in only 160 lines:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="c1">-- Eric Wieser</span>
<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">zsqrtd.to_real</span> <span class="o">{</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="c1">-- This definition is what each question in exercise 6 is asking. No need to restate it each time</span>
<span class="kd">abbreviation</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">lemma</span> <span class="n">nine_equals_3_times_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">=</span><span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">three_is_gt_0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">three_is_gte_0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sqrt_of_9_is_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">nine_equals_3_times_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">three_is_gte_0</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">real.sqrt_mul_self</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">h1</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h3</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">half_plus_half_equals_1</span><span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">=</span><span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_equals_sqrtx_times_sqrtx</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">ℝ</span><span class="o">):</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">*</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">real.rpow_add</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">h2</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">half_plus_half_equals_1</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h4</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">real.rpow_one</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h5</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h3</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_is_0</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">¬</span><span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">half_ne_0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>  <span class="bp">≠</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">zero_le_0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sqrt_0_equals_0</span> <span class="o">:</span> <span class="n">real.sqrt</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">zero_le_0</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">real.sqrt_eq_zero_of_nonpos</span> <span class="n">h1</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_gt_0_implies_sqrt_x_gt_0</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">ℝ</span><span class="o">):</span> <span class="n">x</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">real.rpow_nonneg_of_nonneg</span> <span class="n">h1</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">),</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sqrt_x_equals_sqrt_x</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">x_equals_sqrtx_times_sqrtx</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span><span class="o">,</span>
  <span class="o">{</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">conv</span>
    <span class="kd">begin</span>
      <span class="n">to_rhs</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">h3</span><span class="o">,</span>
    <span class="kd">end</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">x_gt_0_implies_sqrt_x_gt_0</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="n">h5</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">real.sqrt_mul_self</span> <span class="n">h6</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h4</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="o">{</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">x_is_0</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">h3</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">h4</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h5</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">real.zero_rpow</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">h7</span> <span class="o">:=</span> <span class="n">half_ne_0</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h8</span> <span class="o">:=</span> <span class="n">h6</span> <span class="n">h7</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h8</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h9</span> <span class="o">:=</span> <span class="n">sqrt_0_equals_0</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h9</span><span class="o">,</span>
  <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_mul_x_pow_y_equals_x_pow_y_plus_y</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span><span class="bp">^</span><span class="n">y</span> <span class="bp">=</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="n">y</span><span class="bp">+</span><span class="n">y</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">le_of_lt</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">real.mul_rpow</span> <span class="n">x</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h1</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h2</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">real.rpow_add</span> <span class="n">h</span> <span class="n">y</span> <span class="n">y</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h3</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">fourth_root_of_9_equals_sqrt_sqrt</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">nine_equals_3_times_3</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">three_is_gt_0</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h7</span> <span class="o">:=</span> <span class="n">three_is_gte_0</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">sqrt_of_9_is_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">sqrt_x_equals_sqrt_x</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">h4</span> <span class="n">h7</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">h5</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="n">x_mul_x_pow_y_equals_x_pow_y_plus_y</span> <span class="mi">3</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">h8</span> <span class="o">:=</span> <span class="n">h6</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h8</span><span class="o">,</span>
  <span class="n">ring</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">important</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">fourth_root_of_9_equals_sqrt_sqrt</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">sqrt_of_9_is_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h2</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221851134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221851134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221851134">(Jan 07 2021 at 02:47)</a>:</h4>
<p>I am back to the main question, which now is how do I prove equality of two sets?  Here is the context:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="c1">-- Eric Wieser</span>
<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">zsqrtd.to_real</span> <span class="o">{</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="kd">abbreviation</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">refine</span> <span class="n">omega.pred_mono_2</span> <span class="n">rfl</span> <span class="n">_</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>Just before the <code>sorry</code> the goal state is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">⊢</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b</span> <span class="bp">*</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)}</span> <span class="bp">=</span> <span class="bp">↑</span><span class="o">((</span><span class="n">zsqrtd.to_real</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">range</span><span class="o">)</span>
</code></pre></div>
<p>I don't know where to begin on how to unroll that.  <code>library_search</code> times out and <code>suggest</code> gives a long list of possibilities.  I haven't done any set equivalence proofs so I don't know what will reduce this to more underlying material:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">funext</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">eq.symm</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">set.ext</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">eq_comm.mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">eq_comm.mpr</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">eq_of_heq</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">congr_arg</span> <span class="n">set_of</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">mem_id_rel.mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">heq_iff_eq.mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">set.ext_iff.mpr</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">plift.up.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">ulift.up.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">let_value_eq</span> <span class="n">set_of</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">compl_inj_iff.mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="o">(</span><span class="n">list.mem_pure</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b</span> <span class="bp">*</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)}</span>
   <span class="bp">↑</span><span class="o">((</span><span class="n">zsqrtd.to_real</span>
         <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="mi">3</span><span class="o">,</span> <span class="k">from</span>
            <span class="o">(</span><span class="n">id</span> <span class="o">(</span><span class="n">eq_true_intro</span> <span class="o">(</span><span class="n">norm_num.nonneg_pos</span> <span class="mi">3</span> <span class="o">(</span><span class="n">bit1_pos'</span> <span class="n">zero_lt_one'</span><span class="o">))))</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">trivial</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">))</span><span class="bp">.</span><span class="n">mp</span>
  <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">setoid.ker_def.mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">has_top.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">has_one.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">has_bot.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">has_coe.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">option.some_inj.mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">sum.inl.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">sum.inr.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">le_antisymm</span> <span class="n">_</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">psum.inr.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">le_antisymm'</span> <span class="n">_</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">psum.inl.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="o">(</span><span class="n">divp_left_inj</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">except.ok.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">eq.trans</span> <span class="n">_</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">inv_unique</span> <span class="n">_</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">neg_unique</span> <span class="n">_</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="o">(</span><span class="n">eq.congr_left</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="o">(</span><span class="n">eq.congr_left</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">is_glb.unique</span> <span class="n">_</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">is_lub.unique</span> <span class="n">_</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="o">(</span><span class="n">eq.congr_right</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="o">(</span><span class="n">eq.congr_right</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">subtype.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="o">(</span><span class="n">eq.congr</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="o">(</span><span class="n">eq.congr</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">pequiv.inj</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">add_hom.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">one_hom.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">rel_hom.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">mul_hom.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">zero_hom.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">subgroup.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">subring.mk.inj</span> <span class="n">_</span>
<span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">refine</span> <span class="n">alg_hom.mk.inj</span> <span class="n">_</span>
</code></pre></div>



<a name="221861406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221861406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221861406">(Jan 07 2021 at 06:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="308899">Yakov Pechersky</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real/near/221845360">said</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">two_equals_two</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>
</code></pre></div><br>
</p>
</blockquote>
<p>I think <code>simp</code> is doing all the work there</p>



<a name="221864797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221864797" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221864797">(Jan 07 2021 at 07:45)</a>:</h4>
<p>I have no idea what <a href="https://leanprover-community.github.io/mathlib_docs/find/omega.pred_mono_2">docs#omega.pred_mono_2</a> is, but I'm pretty sure you don't want to use it - it's undoing the progress made by <code>ext</code></p>



<a name="221975407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221975407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221975407">(Jan 07 2021 at 17:46)</a>:</h4>
<p>Thanks, per <span class="user-mention" data-user-id="111080">@Floris van Doorn</span> I backed out the omega and applied <a href="https://leanprover-community.github.io/mathlib_docs/find/set.mem_set_of_eq">docs#set.mem_set_of_eq</a> and that gets me here which gets me back into predicate calculus and out of sets:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">⊢</span> <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b</span> <span class="bp">*</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">∈</span> <span class="bp">↑</span><span class="o">((</span><span class="n">zsqrtd.to_real</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">range</span><span class="o">)</span>
</code></pre></div>
<p>I don't see that in the <code>suggest</code> list,  so that's a possible improvement for <code>suggest</code>.</p>



<a name="221977532"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/221977532" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#221977532">(Jan 07 2021 at 18:01)</a>:</h4>
<p>You can always do <code>suggest 100</code> to get more suggestions, perhaps it shows up with a higher number than the default?</p>



<a name="222153450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222153450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222153450">(Jan 09 2021 at 04:38)</a>:</h4>
<p>I got it this far but I'm out of ideas again:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>


<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>  <span class="c1">-- Eric Wieser</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">zsqrtd.to_real</span> <span class="o">{</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="kd">abbreviation</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">lemma</span> <span class="n">fourth_root_of_nine_equals_sqrt_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">exists.intro</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="o">{</span>
      <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span>
      <span class="n">cases</span> <span class="n">ha</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">trivial</span><span class="o">,</span>
    <span class="o">},</span>
    <span class="o">{</span>
      <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span>
      <span class="n">cases</span> <span class="n">ha</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
      <span class="n">norm_num</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">fourth_root_of_nine_equals_sqrt_3</span><span class="o">,</span>
      <span class="n">rw</span> <span class="bp">←</span> <span class="n">h2</span><span class="o">,</span>
      <span class="gr">sorry</span><span class="o">,</span>
    <span class="o">},</span>
    <span class="n">exact</span> <span class="n">zsqrtd.one</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">exists.intro</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">exists.intro</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">unfold_coes</span><span class="o">,</span>
    <span class="gr">sorry</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">int.one</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">int.one</span><span class="o">,</span>
  <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>
<p>At the first <code>sorry</code>, my tactic state is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">1</span> <span class="n">goal</span>
<span class="n">x</span><span class="o">:</span> <span class="n">ℝ</span>
<span class="n">ab</span><span class="o">:</span> <span class="n">ℤ</span>
<span class="n">hb</span><span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b</span> <span class="bp">*</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span>
<span class="n">h2</span><span class="o">:</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span>
<span class="bp">⊢</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">?</span><span class="n">m_1</span><span class="o">[</span><span class="n">_</span><span class="o">]</span><span class="bp">.</span><span class="n">re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">?</span><span class="n">m_1</span><span class="o">[</span><span class="n">_</span><span class="o">]</span><span class="bp">.</span><span class="n">im</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span> <span class="bp">=</span> <span class="n">x</span>
</code></pre></div>
<p>It's asking for real and imaginary parts of an unmatched thing.  I haven't been reasoning about complex numbers, that just popped up.</p>
<p>The second <code>sorry</code> also seems to want me to fill in some random number.  The goal state is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">3</span> <span class="n">goals</span>
<span class="n">x</span><span class="o">:</span> <span class="n">ℝ</span>
<span class="n">h_w</span><span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="mi">3</span>
<span class="n">h_h</span><span class="o">:</span> <span class="n">h_w</span> <span class="bp">∈</span> <span class="bp">⊤.</span><span class="n">carrier</span> <span class="bp">∧</span> <span class="bp">⇑</span><span class="o">(</span><span class="n">zsqrtd.to_real</span> <span class="n">_</span><span class="o">)</span> <span class="n">h_w</span> <span class="bp">=</span> <span class="n">x</span>
<span class="bp">⊢</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">int.cast</span> <span class="bp">?</span><span class="n">m_1</span><span class="o">[</span><span class="n">_</span><span class="o">]</span> <span class="bp">+</span> <span class="n">int.cast</span> <span class="bp">?</span><span class="n">m_2</span><span class="o">[</span><span class="n">_</span><span class="o">]</span> <span class="bp">*</span> <span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">4</span><span class="o">)</span>
</code></pre></div>
<p>I don't understand how to work with these metavariables and what the tactics or theorems are that would apply.</p>



<a name="222153646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222153646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222153646">(Jan 09 2021 at 04:44)</a>:</h4>
<p>things seem to start to go wrong at <code>apply exists.intro</code></p>



<a name="222153711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222153711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222153711">(Jan 09 2021 at 04:46)</a>:</h4>
<p>This seems like a good starting point</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fourth_root_of_nine_equals_sqrt_3</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">zsqrtd.to_real</span><span class="o">],</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222153726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222153726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222153726">(Jan 09 2021 at 04:46)</a>:</h4>
<p>the proof of the sorry should be very short, just unpacking and repacking the real and imaginary parts</p>



<a name="222153733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222153733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222153733">(Jan 09 2021 at 04:47)</a>:</h4>
<p>By the way, the <code>re</code> and <code>im</code> aren't actually referring to complex numbers here</p>



<a name="222153748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222153748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222153748">(Jan 09 2021 at 04:47)</a>:</h4>
<p>If you look at zsqrtd/basic.lean, you see this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- The ring of integers adjoined with a square root of `d`.</span>
<span class="sd">  These have the form `a + b √d` where `a b : ℤ`. The components</span>
<span class="sd">  are called `re` and `im` by analogy to the negative `d` case,</span>
<span class="sd">  but of course both parts are real here since `d` is nonnegative. -/</span>
<span class="kd">structure</span> <span class="n">zsqrtd</span> <span class="o">(</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">re</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span>
<span class="o">(</span><span class="n">im</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span>
</code></pre></div>



<a name="222153793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222153793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222153793">(Jan 09 2021 at 04:48)</a>:</h4>
<p>so the <code>re</code> and <code>im</code> are referring to the <code>a</code> and the <code>b</code> in <code>a + b √d</code></p>



<a name="222173585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222173585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222173585">(Jan 09 2021 at 14:38)</a>:</h4>
<p>I have reached an absurdity.  It is asking me to prove <code>⊢ a = b ∨ real.sqrt 3 = 0</code> after the <code>simp *</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>


<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>  <span class="c1">-- Eric Wieser</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">zsqrtd.to_real</span> <span class="o">{</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="kd">abbreviation</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">lemma</span> <span class="n">fourth_root_of_nine_equals_sqrt_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fourth_root_of_nine_equals_sqrt_3</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">zsqrtd.to_real</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">ha</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">exists.intro</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">rotate</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">{</span><span class="n">re</span> <span class="o">:=</span> <span class="n">a</span><span class="o">,</span> <span class="n">im</span> <span class="o">:=</span> <span class="n">a</span><span class="o">},</span>
    <span class="n">simp</span> <span class="bp">*</span><span class="o">,</span>
    <span class="c1">-- ⊢ a = b ∨ real.sqrt 3 = 0</span>
  <span class="o">},</span>
  <span class="o">{</span>
    <span class="gr">sorry</span><span class="o">,</span>
  <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222173656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222173656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222173656">(Jan 09 2021 at 14:40)</a>:</h4>
<p>Do you know the maths proof of what you're trying to prove? Lean won't figure out the ideas, it will just check them.</p>



<a name="222173776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222173776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222173776">(Jan 09 2021 at 14:44)</a>:</h4>
<p>I think the maths proof by the time you reach the <code>split</code> is "both sides are obviously the same"</p>



<a name="222173787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222173787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222173787">(Jan 09 2021 at 14:45)</a>:</h4>
<p>But in this case, your mistake is the <code>exact</code> line</p>



<a name="222173791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222173791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222173791">(Jan 09 2021 at 14:46)</a>:</h4>
<p>It should read <code>im := b</code></p>



<a name="222173971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222173971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222173971">(Jan 09 2021 at 14:50)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>  what I actually wanted to prove is that the ring is closed under addition and multiplication as defined by <code>&lt;a,b&gt;+&lt;c,d&gt;=&lt;a+b,c+d&gt;</code> and <code>&lt;a,b&gt;*&lt;c,d&gt; = &lt;a*c+3*b*d, a*d+b*c&gt;</code>.  In the recent above I am following expert suggestions which do not map directly to my original intuition.</p>



<a name="222174005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222174005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222174005">(Jan 09 2021 at 14:51)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> I don't know the syntax to assign directly to the components of the goal.  This doesn't work:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">exact</span> <span class="o">{</span> <span class="n">im</span> <span class="o">:=</span> <span class="n">b</span> <span class="o">},</span>
</code></pre></div>
<p>where the goal is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">⊢</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">?</span><span class="n">m_1.re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">?</span><span class="n">m_1.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="mi">3</span>
</code></pre></div>



<a name="222174214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222174214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222174214">(Jan 09 2021 at 14:57)</a>:</h4>
<p>You already have <code>im := a</code> in your example code</p>



<a name="222174216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222174216" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222174216">(Jan 09 2021 at 14:57)</a>:</h4>
<p>Just change the a for a b</p>



<a name="222174223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222174223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222174223">(Jan 09 2021 at 14:57)</a>:</h4>
<p><code>congr</code> would probably also solve that goal</p>



<a name="222174410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222174410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222174410">(Jan 09 2021 at 15:02)</a>:</h4>
<p>I think <code>apply exists.intro</code> is a recurring wrong choice you seen to be taking. When you're faced with an existential, your strategy should be to think of the maths proof and work out which object to provide; then use <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#use">tactic#use</a></p>



<a name="222176989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222176989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222176989">(Jan 09 2021 at 16:16)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="310045">@Eric Wieser</span> I will follow the advice on <code>exists.intro</code>.</p>



<a name="222183138"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222183138" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222183138">(Jan 09 2021 at 18:37)</a>:</h4>
<p>I got farther on the first half of the split.  </p>
<p>On the second half, I'm trying to make  <code>y=0 + 0 * sqrt(3)</code> and apply it on the <code>exist</code> which is in the assumptions.  It's not going through, I don't know the syntax:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>


<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>  <span class="c1">-- Eric Wieser</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">zsqrtd.to_real</span> <span class="o">{</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="kd">abbreviation</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">lemma</span> <span class="n">fourth_root_of_nine_equals_sqrt_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fourth_root_of_nine_equals_sqrt_3</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">zsqrtd.to_real</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">ha</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">{</span><span class="n">re</span> <span class="o">:=</span> <span class="n">a</span><span class="o">,</span> <span class="n">im</span> <span class="o">:=</span> <span class="n">b</span><span class="o">},</span>
    <span class="n">rw</span> <span class="n">hb</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">use</span> <span class="mi">0</span><span class="o">,</span>
    <span class="n">use</span> <span class="mi">0</span><span class="o">,</span>
    <span class="n">simp</span> <span class="bp">*</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="mi">3</span> <span class="o">:=</span> <span class="o">{</span><span class="n">re</span> <span class="o">:=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">im</span> <span class="o">:=</span> <span class="mi">0</span><span class="o">},</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">h</span> <span class="n">y</span><span class="o">,</span> <span class="c1">-- ERROR</span>
  <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>
<p>The goal state is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">x</span><span class="o">:</span> <span class="n">ℝ</span>
<span class="n">h</span><span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="mi">3</span><span class="o">),</span> <span class="bp">↑</span><span class="o">(</span><span class="n">y.re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">y.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="bp">=</span> <span class="n">x</span>
<span class="n">y</span><span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="mi">3</span>
<span class="bp">⊢</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span>
</code></pre></div>



<a name="222183579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222183579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222183579">(Jan 09 2021 at 18:46)</a>:</h4>
<p>Why did you <code>use 0</code>?</p>



<a name="222183704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222183704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222183704">(Jan 09 2021 at 18:49)</a>:</h4>
<p>Your goal state is unprovable because you used the wrong value</p>



<a name="222183752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222183752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222183752">(Jan 09 2021 at 18:50)</a>:</h4>
<p>What was the goal state before the first <code>use 0</code>?</p>



<a name="222188357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222188357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222188357">(Jan 09 2021 at 20:36)</a>:</h4>
<p>I'm at this tactic state:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">1</span> <span class="n">goal</span>
<span class="n">x</span><span class="o">:</span> <span class="n">ℝ</span>
<span class="n">y</span><span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="mi">3</span>
<span class="n">hy</span><span class="o">:</span> <span class="bp">↑</span><span class="o">(</span><span class="n">y.re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">y.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="bp">=</span> <span class="n">x</span>
<span class="bp">⊢</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="bp">↑</span><span class="o">(</span><span class="n">y.re</span><span class="o">)</span> <span class="bp">+</span> <span class="bp">↑</span><span class="o">(</span><span class="n">y.im</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="bp">=</span> <span class="bp">↑</span><span class="n">a</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="mi">3</span>
</code></pre></div>
<p>I want to set <code>y.re</code> to <code>a</code> and <code>y.im</code> to <code>b</code>.  using something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">have</span> <span class="n">y</span><span class="o">:</span><span class="n">ℤ</span><span class="bp">√</span><span class="mi">3</span> <span class="o">:=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="mi">3</span><span class="o">,</span>
</code></pre></div>
<p>and have that get applied  to the goal to replace <code>y.re</code> with <code>a</code> and <code>y.im</code> with <code>b</code>.  I don't know how to do it.  This is just before the <code>sorry</code> in</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>


<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>  <span class="c1">-- Eric Wieser</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">zsqrtd.to_real</span> <span class="o">{</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="kd">abbreviation</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">lemma</span> <span class="n">fourth_root_of_nine_equals_sqrt_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fourth_root_of_nine_equals_sqrt_3</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">zsqrtd.to_real</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">ha</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">{</span><span class="n">re</span> <span class="o">:=</span> <span class="n">a</span><span class="o">,</span> <span class="n">im</span> <span class="o">:=</span> <span class="n">b</span><span class="o">},</span>
    <span class="n">rw</span> <span class="n">hb</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">hy</span><span class="o">,</span>
    <span class="gr">sorry</span>
  <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222190357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222190357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222190357">(Jan 09 2021 at 21:18)</a>:</h4>
<p><code>use [y.re, y.im]</code></p>



<a name="222193673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222193673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222193673">(Jan 09 2021 at 22:51)</a>:</h4>
<p>Exercise 6E, we hardly knew ye:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.zsqrtd.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="c1">-- Eric Wieser</span>
<span class="sd">/-- The image of `zsqrtd` in `ℝ`.  -/</span>
<span class="kd">@[simps]</span>
<span class="kd">noncomputable</span> <span class="kd">def</span> <span class="n">zsqrtd.to_real</span> <span class="o">{</span><span class="n">d</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℤ</span><span class="bp">√</span><span class="n">d</span> <span class="bp">→+*</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">to_fun</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">a.1</span> <span class="bp">+</span> <span class="n">a.2</span><span class="bp">*</span><span class="n">real.sqrt</span> <span class="n">d</span><span class="o">,</span>
  <span class="n">map_zero'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_add'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span><span class="o">,</span> <span class="o">},</span>
  <span class="n">map_one'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
  <span class="n">map_mul'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="bp">=</span>
             <span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">↑</span><span class="n">a.re</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.re</span><span class="o">)</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span>
                           <span class="bp">+</span> <span class="bp">↑</span><span class="n">a.im</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">b.im</span> <span class="bp">*</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="n">d</span> <span class="bp">*</span> <span class="n">real.sqrt</span> <span class="n">d</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ring</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">this</span><span class="o">,</span> <span class="n">real.mul_self_sqrt</span> <span class="o">(</span><span class="n">int.cast_nonneg.mpr</span> <span class="n">h</span><span class="o">)],</span>
    <span class="n">ring</span><span class="o">,</span> <span class="o">}</span> <span class="o">}</span>

<span class="c1">-- This definition is what each question in exercise 6 is asking. No need to restate it each time</span>
<span class="kd">abbreviation</span> <span class="n">ex6</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">lemma</span> <span class="n">nine_equals_3_times_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">=</span><span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">*</span><span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">three_is_gt_0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">three_is_gte_0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sqrt_of_9_is_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">nine_equals_3_times_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">three_is_gte_0</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">real.sqrt_mul_self</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">h1</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h3</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">half_plus_half_equals_1</span><span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">+</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">=</span><span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_equals_sqrtx_times_sqrtx</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">ℝ</span><span class="o">):</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">*</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">real.rpow_add</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">h2</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">half_plus_half_equals_1</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h4</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">real.rpow_one</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h5</span> <span class="n">at</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h3</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_is_0</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">¬</span><span class="o">(</span><span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">half_ne_0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span>  <span class="bp">≠</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">zero_le_0</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">linarith</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sqrt_0_equals_0</span> <span class="o">:</span> <span class="n">real.sqrt</span> <span class="mi">0</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">zero_le_0</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">real.sqrt_eq_zero_of_nonpos</span> <span class="n">h1</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_gt_0_implies_sqrt_x_gt_0</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">ℝ</span><span class="o">):</span> <span class="n">x</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">real.rpow_nonneg_of_nonneg</span> <span class="n">h1</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">),</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sqrt_x_equals_sqrt_x</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≥</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">x_equals_sqrtx_times_sqrtx</span> <span class="n">x</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">h2</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span><span class="o">,</span>
  <span class="o">{</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">conv</span>
    <span class="kd">begin</span>
      <span class="n">to_rhs</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">h3</span><span class="o">,</span>
    <span class="kd">end</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">x_gt_0_implies_sqrt_x_gt_0</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="n">h5</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">real.sqrt_mul_self</span> <span class="n">h6</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h4</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="o">{</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">x_is_0</span> <span class="n">x</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">h3</span> <span class="n">h</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">h4</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h5</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">real.zero_rpow</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">h7</span> <span class="o">:=</span> <span class="n">half_ne_0</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h8</span> <span class="o">:=</span> <span class="n">h6</span> <span class="n">h7</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h8</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h9</span> <span class="o">:=</span> <span class="n">sqrt_0_equals_0</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h9</span><span class="o">,</span>
  <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">x_mul_x_pow_y_equals_x_pow_y_plus_y</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">x</span> <span class="bp">→</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">x</span><span class="o">)</span><span class="bp">^</span><span class="n">y</span> <span class="bp">=</span> <span class="n">x</span><span class="bp">^</span><span class="o">(</span><span class="n">y</span><span class="bp">+</span><span class="n">y</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">le_of_lt</span> <span class="n">h</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">real.mul_rpow</span> <span class="n">x</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h1</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h2</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">real.rpow_add</span> <span class="n">h</span> <span class="n">y</span> <span class="n">y</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">eq.symm</span> <span class="n">h3</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">fourth_root_of_9_equals_sqrt_sqrt</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="o">(</span><span class="n">real.sqrt</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">nine_equals_3_times_3</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">three_is_gt_0</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h7</span> <span class="o">:=</span> <span class="n">three_is_gte_0</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">sqrt_of_9_is_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">h3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">sqrt_x_equals_sqrt_x</span> <span class="o">(</span><span class="mi">3</span><span class="o">:</span><span class="n">ℝ</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">h4</span> <span class="n">h7</span><span class="o">,</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">h5</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="n">x_mul_x_pow_y_equals_x_pow_y_plus_y</span> <span class="mi">3</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">h8</span> <span class="o">:=</span> <span class="n">h6</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h8</span><span class="o">,</span>
  <span class="n">ring</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">fourth_root_of_nine_equals_sqrt_3</span> <span class="o">:</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">fourth_root_of_9_equals_sqrt_sqrt</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">sqrt_of_9_is_3</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">h2</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">abbreviation</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">fourth_root_of_nine_equals_sqrt_3</span><span class="o">],</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">zsqrtd.to_real</span><span class="o">],</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">ha</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">{</span><span class="n">re</span> <span class="o">:=</span> <span class="n">a</span><span class="o">,</span> <span class="n">im</span> <span class="o">:=</span> <span class="n">b</span><span class="o">},</span>
    <span class="n">rw</span> <span class="n">hb</span><span class="o">,</span>
  <span class="o">},</span>
  <span class="o">{</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">[</span><span class="n">y.re</span><span class="o">,</span> <span class="n">y.im</span><span class="o">],</span>
  <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222194633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222194633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222194633">(Jan 09 2021 at 23:20)</a>:</h4>
<p>I think it's easier if you just do it directly without using this zsqrtd stuff:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">analysis.special_functions.pow</span>

<span class="kd">abbreviation</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kn">open</span> <span class="n">real</span>

<span class="kd">lemma</span> <span class="n">useful</span> <span class="o">:</span> <span class="o">((</span><span class="mi">9</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">4</span><span class="bp">⁻¹</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">))</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">4</span><span class="bp">⁻¹</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">))</span> <span class="bp">=</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="bp">←</span> <span class="n">mul_rpow</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">pow_nat_rpow_nat_inv</span> <span class="o">(</span><span class="k">show</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">≤</span> <span class="mi">3</span><span class="o">,</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">)</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="mi">4</span><span class="o">,</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">)</span> <span class="n">using</span> <span class="mi">2</span><span class="o">,</span>
  <span class="n">all_goals</span> <span class="o">{</span><span class="n">norm_num</span><span class="o">}</span>
<span class="kd">end</span>

<span class="kd">def</span> <span class="n">A</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">carrier</span> <span class="o">:=</span> <span class="o">{</span><span class="n">x</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)},</span>
  <span class="n">one_mem'</span> <span class="o">:=</span> <span class="o">⟨</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">⟩,</span>
  <span class="n">mul_mem'</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rintro</span> <span class="n">_</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">a1</span><span class="o">,</span> <span class="n">b1</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">a2</span><span class="o">,</span> <span class="n">b2</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
    <span class="n">use</span> <span class="o">[</span><span class="n">a1</span> <span class="bp">*</span> <span class="n">a2</span> <span class="bp">+</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">b1</span> <span class="bp">*</span> <span class="n">b2</span><span class="o">,</span> <span class="n">a1</span> <span class="bp">*</span> <span class="n">b2</span> <span class="bp">+</span> <span class="n">a2</span> <span class="bp">*</span> <span class="n">b1</span><span class="o">],</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">mul_add</span><span class="o">,</span> <span class="n">add_mul</span><span class="o">,</span> <span class="n">mul_assoc</span><span class="o">,</span> <span class="n">mul_left_comm</span><span class="o">,</span> <span class="n">useful</span><span class="o">],</span>
    <span class="n">ring</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">zero_mem'</span> <span class="o">:=</span> <span class="o">⟨</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">⟩,</span>
  <span class="n">add_mem'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">rintro</span> <span class="n">_</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">a1</span><span class="o">,</span> <span class="n">b1</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">a2</span><span class="o">,</span> <span class="n">b2</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
                   <span class="n">use</span> <span class="o">[</span><span class="n">a1</span> <span class="bp">+</span> <span class="n">a2</span><span class="o">,</span> <span class="n">b1</span> <span class="bp">+</span> <span class="n">b2</span><span class="o">],</span>
                   <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span> <span class="o">},</span>
  <span class="n">neg_mem'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
                   <span class="n">use</span> <span class="o">[</span><span class="bp">-</span><span class="n">a</span><span class="o">,</span> <span class="bp">-</span><span class="n">b</span><span class="o">],</span>
                   <span class="n">simp</span><span class="o">,</span> <span class="n">ring</span> <span class="o">},</span>
   <span class="o">}</span>

<span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">:</span> <span class="n">integral_domain</span> <span class="n">A</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply_instance</span>

<span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="o">⟨</span><span class="n">A</span><span class="o">,</span> <span class="n">infer_instance</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span>
</code></pre></div>



<a name="222194989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222194989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222194989">(Jan 09 2021 at 23:30)</a>:</h4>
<p>This way you just isolate the useful lemma and you don't ever need to engage with square roots at all.</p>



<a name="222195005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195005">(Jan 09 2021 at 23:31)</a>:</h4>
<p>I disagree. The first lemma by Eric is supposed to be in mathlib (I think it's PR'd), and the rest is a few lines</p>



<a name="222195210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195210">(Jan 09 2021 at 23:36)</a>:</h4>
<p>Fair enough. My construction of the subring shouldn't be in mathlib and that's most of the work. I guess your way you still need to prove 9^{1/4}=sqrt(3), that just looked unappealing to me for some reason, but now I see we already have <code>sqrt_eq_rpow</code></p>



<a name="222195280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195280">(Jan 09 2021 at 23:39)</a>:</h4>
<p>BTW we're missing <code>pow_inj : a^x=b^x -&gt; a=b</code> (modulo edge cases) (at least as far as I can see)</p>



<a name="222195638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195638">(Jan 09 2021 at 23:50)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">ex6e</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="o">⟨(</span><span class="n">zsqrtd.to_real</span> <span class="o">(</span><span class="k">show</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="kd">by</span> <span class="n">norm_num</span><span class="o">))</span><span class="bp">.</span><span class="n">range</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="n">apply_instance</span><span class="o">,</span>
  <span class="n">ext</span><span class="o">,</span>
  <span class="n">rw</span> <span class="k">calc</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">4</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">9</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">^</span><span class="o">((</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">norm_num</span>
    <span class="bp">...</span> <span class="bp">=</span> <span class="o">((</span><span class="mi">3</span><span class="bp">^</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span><span class="bp">^</span><span class="o">((</span><span class="mi">2</span><span class="o">:</span><span class="n">ℕ</span><span class="o">)</span><span class="bp">⁻¹</span><span class="o">:</span><span class="n">ℝ</span><span class="o">))</span> <span class="bp">^</span> <span class="o">(</span><span class="mi">1</span><span class="bp">/</span><span class="mi">2</span><span class="o">:</span><span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">real.rpow_mul</span><span class="bp">;</span> <span class="n">norm_num</span>
    <span class="bp">...</span> <span class="bp">=</span> <span class="n">real.sqrt</span> <span class="mi">3</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">real.pow_nat_rpow_nat_inv</span><span class="o">,</span> <span class="n">real.sqrt_eq_rpow</span><span class="o">]</span><span class="bp">;</span> <span class="n">norm_num</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">zsqrtd.to_real</span><span class="o">],</span>
  <span class="n">exact</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">,</span><span class="n">h</span><span class="o">⟩,</span> <span class="o">⟨⟨</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">⟩,</span> <span class="n">h.symm</span><span class="o">⟩,</span> <span class="bp">λ</span> <span class="o">⟨⟨</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">⟩,</span><span class="n">h</span><span class="o">⟩,</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">,</span> <span class="n">h.symm</span><span class="o">⟩⟩,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222195663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195663">(Jan 09 2021 at 23:51)</a>:</h4>
<p>Kevin's proof is easier for me to follow  because it directly constructs the subring.</p>



<a name="222195674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195674">(Jan 09 2021 at 23:51)</a>:</h4>
<p>Mario's proof is the same as yours, he just gets to the point more directly.</p>



<a name="222195748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195748">(Jan 09 2021 at 23:53)</a>:</h4>
<p>There certainly seems to be some friction around <code>real.rpow</code> that could use some automation</p>



<a name="222195749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195749">(Jan 09 2021 at 23:53)</a>:</h4>
<p>I don't think I've ever seen <code>rw calc</code> before, and it doesn't seem to ever occur in mathlib.</p>



<a name="222195758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195758">(Jan 09 2021 at 23:53)</a>:</h4>
<p>It would be <code>rw show</code> but <code>calc</code> kind of has <code>show</code> built in</p>



<a name="222195797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222195797" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222195797">(Jan 09 2021 at 23:54)</a>:</h4>
<p>Nice!</p>



<a name="222197571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222197571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222197571">(Jan 10 2021 at 00:40)</a>:</h4>
<p><span class="user-mention" data-user-id="364351">@Lars Ericson</span>, the point of my approach to the proof is that mathlib already has the ring construction so there is no need to build it yourself</p>



<a name="222197580"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222197580" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222197580">(Jan 10 2021 at 00:40)</a>:</h4>
<p>Pedagogically of course, you can still do so</p>



<a name="222198499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/222198499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#222198499">(Jan 10 2021 at 01:09)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> , I'm grateful for your help.   In this example, the relevant subring was already mostly in <code>mathlib</code>, except for the multiplication which you define in  <code>zsqrtd.to_real</code>.  For a beginner like myself, to transfer the techniques to a subring which is not already in <code>mathlib</code>, the pattern of <code>def A</code> seems easier to replicate.</p>



<a name="224259798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20multiply%20an%20integer%20times%20a%20real/near/224259798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20multiply.20an.20integer.20times.20a.20real.html#224259798">(Jan 27 2021 at 22:47)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/zsqrtd.to_real">docs#zsqrtd.to_real</a> is now merged</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>