---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/bors.20and.20pr_status.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html">bors and pr_status</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="268977363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268977363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268977363">(Jan 22 2022 at 20:34)</a>:</h4>
<p>In previous projects that used bors (or mergify) I was used to be able to tell bors to merge, and it would wait for the PR CI to turn green. It seems that this is not the case here, and contributors are expected to manually wait and check for CI to turn green before entering <code>bors r+</code>, which seems like an odd use of our attention…<br>
Bors does support waiting for a PR to turn green, using the <a href="https://bors.tech/documentation/"><code>pr_status</code></a> configuration option, so I wonder if this is intentionally not used here (and why? maybe to merge fast when it’s a trivial change?), or whether it’s maybe simply a newer feature that wasn’t considered yet?</p>



<a name="268977517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268977517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268977517">(Jan 22 2022 at 20:38)</a>:</h4>
<p>(I found <a href="https://github.com/leanprover-community/mathlib/blob/master/docs/contribute/bors.md">https://github.com/leanprover-community/mathlib/blob/master/docs/contribute/bors.md</a> which explains why bors was chosen, but it doesn’t answer this question. And as a NB, mergify has improved a lot since then, including the ability for merge trains with speculative tests, taking commit messages from PR descriptions, tracking PR dependencies – not suggesting to switch back, but pointing out that it may have become a viable option again, in case bors falls out of favor)</p>



<a name="268977675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268977675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268977675">(Jan 22 2022 at 20:42)</a>:</h4>
<p>Oh, I didn't realize that option meant that we could configure bors to wait for certain checks to pass on the final commit! If you're familiar with this setting, do you mind submitting a PR to help us make use of it?</p>



<a name="268977698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268977698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268977698">(Jan 22 2022 at 20:43)</a>:</h4>
<p>Not familiar, but it seems straight forward enough. Will prepare a PR.</p>



<a name="268977757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268977757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268977757">(Jan 22 2022 at 20:44)</a>:</h4>
<p>(Hmm, it may be that with mergify you even get “properly merged PRs” despite using squash merge + merge trains… that might actually be worth evaluating at some point if this “Closed by bors” business becomes too annoying.)</p>



<a name="268977837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268977837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268977837">(Jan 22 2022 at 20:46)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/11609">https://github.com/leanprover-community/mathlib/pull/11609</a>. But probably Bryan should double-check that this is what you want :-)</p>



<a name="268977857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268977857" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268977857">(Jan 22 2022 at 20:47)</a>:</h4>
<p>Wait, I am talking to Bryan. I should pay attention to Zulip the same way I do to <code>git log</code> :-D</p>



<a name="268978109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268978109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268978109">(Jan 22 2022 at 20:53)</a>:</h4>
<p>Wow, bors even posts a message telling us that it's waiting for the checks to pass! This is great! </p>
<p>As a follow up we might want to see if we want to change the way the "awaiting-CI" label works (as right now, the label blocks <code>bors r+</code> and is removed automatically at the end of CI), but I think this is good for now.</p>
<p>cc: <span class="user-mention" data-user-id="112680">@Johan Commelin</span></p>



<a name="268978238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268978238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268978238">(Jan 22 2022 at 20:57)</a>:</h4>
<p><span class="user-mention" data-user-id="470149">@Joachim Breitner</span> Wow! This is great. Last time I checked, bors didn't seem to have this feature.</p>



<a name="268978508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/268978508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#268978508">(Jan 22 2022 at 21:02)</a>:</h4>
<p>I think the setting has been there since before we started using bors, but I for one didn't understand the description in their docs until now.</p>



<a name="287434218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/287434218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#287434218">(Jun 25 2022 at 13:04)</a>:</h4>
<p><code>awaiting-CI</code> seems to have a bug:</p>
<p><a href="/user_uploads/3121/LRhql2ApQ3q5jcOEGIoLL-x4/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/LRhql2ApQ3q5jcOEGIoLL-x4/image.png" title="image.png"><img src="/user_uploads/3121/LRhql2ApQ3q5jcOEGIoLL-x4/image.png"></a></div><p>The first commit is a PR too, so I think it's related</p>



<a name="287435386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/bors%20and%20pr_status/near/287435386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/bors.20and.20pr_status.html#287435386">(Jun 25 2022 at 13:35)</a>:</h4>
<p>I'm out of time to investigate further, but here are some notes for my future self, or anyone who wants to take a look. </p>
<p>The issue is the following: </p>
<ul>
<li>the first commit of <a href="https://github.com/leanprover-community/mathlib/pull/14947">#14947</a> is the same as the only commit of <a href="https://github.com/leanprover-community/mathlib/pull/14946">#14946</a></li>
<li><code>awaiting-CI</code> was added to both</li>
<li>the build of <a href="https://github.com/leanprover-community/mathlib/pull/14946">#14946</a> finished (but not <a href="https://github.com/leanprover-community/mathlib/pull/14947">#14947</a>)</li>
<li><code>awaiting-CI</code> was removed from <a href="https://github.com/leanprover-community/mathlib/pull/14947">#14947</a> instead of <a href="https://github.com/leanprover-community/mathlib/pull/14946">#14946</a></li>
</ul>
<p>Looking at the CI script, it looks like <a href="https://github.com/leanprover-community/mathlib/blob/07c83c81c0016c1ac08e8c9c3f1260c2f4c6ac7f/.github/workflows/build.yml#L248">this is a known issue with the way we're getting the PR number</a>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>