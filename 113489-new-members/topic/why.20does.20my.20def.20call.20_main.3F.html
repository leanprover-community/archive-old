---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html">why does my def call _main?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="206329584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/why%20does%20my%20def%20call%20_main%3F/near/206329584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html#206329584">(Aug 08 2020 at 03:40)</a>:</h4>
<p>The following code:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">append</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span>
<span class="bp">|</span> <span class="o">[]</span>     <span class="n">l</span> <span class="o">:=</span> <span class="n">l</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">h</span><span class="bp">::</span><span class="n">t</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span> <span class="n">h</span> <span class="bp">::</span> <span class="n">append</span> <span class="n">t</span> <span class="n">l</span>

<span class="bp">#</span><span class="kn">print</span> <span class="n">append</span>
</code></pre></div>


<p>Generates the following printed message: </p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">append</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">},</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">},</span> <span class="n">append</span><span class="bp">._</span><span class="n">main</span>
</code></pre></div>


<p>In order to get the full definition, I apparently need to write <code>#print append._main</code> instead, which gives:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">append</span><span class="bp">._</span><span class="n">main</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">_</span><span class="n">aux_param_0</span><span class="o">},</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">_</span><span class="n">aux_param_0</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="n">a_1</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">),</span>
  <span class="n">a</span><span class="bp">.</span><span class="n">brec_on</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">_</span><span class="n">F</span> <span class="o">:</span> <span class="n">list</span><span class="bp">.</span><span class="n">below</span> <span class="n">α</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">a_1</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">),</span>
       <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="n">a_1</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">_</span><span class="n">F</span> <span class="o">:</span> <span class="n">list</span><span class="bp">.</span><span class="n">below</span> <span class="n">α</span> <span class="n">a</span><span class="o">),</span>
          <span class="n">a</span><span class="bp">.</span><span class="n">cases_on</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="bp">_</span><span class="n">F</span> <span class="o">:</span> <span class="n">list</span><span class="bp">.</span><span class="n">below</span> <span class="n">α</span> <span class="n">list</span><span class="bp">.</span><span class="n">nil</span><span class="o">),</span> <span class="n">id_rhs</span> <span class="o">(</span><span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="n">a_1</span><span class="o">)</span>
            <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a_hd</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">a_tl</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">_</span><span class="n">F</span> <span class="o">:</span> <span class="n">list</span><span class="bp">.</span><span class="n">below</span> <span class="n">α</span> <span class="o">(</span><span class="n">a_hd</span> <span class="bp">::</span> <span class="n">a_tl</span><span class="o">)),</span>
               <span class="n">id_rhs</span> <span class="o">(</span><span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">a_hd</span> <span class="bp">::</span> <span class="bp">_</span><span class="n">F</span><span class="bp">.</span><span class="n">fst</span><span class="bp">.</span><span class="n">fst</span> <span class="n">a_1</span><span class="o">))</span>
            <span class="bp">_</span><span class="n">F</span><span class="o">)</span>
         <span class="n">a</span>
         <span class="n">a_1</span>
         <span class="bp">_</span><span class="n">F</span><span class="o">)</span>
    <span class="n">a_1</span>
</code></pre></div>


<p>What is this <code>_main</code> object? Why is it used, and do I need to think about it?</p>



<a name="206329699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/why%20does%20my%20def%20call%20_main%3F/near/206329699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html#206329699">(Aug 08 2020 at 03:45)</a>:</h4>
<p>don't unfold definitions; the only things you need is the API</p>



<a name="206329707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/why%20does%20my%20def%20call%20_main%3F/near/206329707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris M <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html#206329707">(Aug 08 2020 at 03:46)</a>:</h4>
<p>What API do you mean?</p>



<a name="206329809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/why%20does%20my%20def%20call%20_main%3F/near/206329809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris B <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html#206329809">(Aug 08 2020 at 03:48)</a>:</h4>
<p>It's because you defined it using the equation compiler (by using pattern matching syntax). You actually get a couple of definitions that you can see with <code>#print prefix append</code> :</p>
<div class="codehilite"><pre><span></span><code><span class="n">append</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">},</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span>
<span class="n">append</span><span class="bp">._</span><span class="n">main</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">_</span><span class="n">aux_param_0</span><span class="o">},</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span>
<span class="n">append</span><span class="bp">._</span><span class="n">main</span><span class="bp">._</span><span class="n">meta_aux</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">_</span><span class="n">aux_param_0</span><span class="o">},</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span>
<span class="n">append</span><span class="bp">._</span><span class="n">main</span><span class="bp">.</span><span class="n">equations</span><span class="bp">._</span><span class="n">eqn_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">_</span><span class="n">aux_param_0</span><span class="o">}</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">),</span> <span class="n">append</span><span class="bp">._</span><span class="n">main</span> <span class="n">list</span><span class="bp">.</span><span class="n">nil</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l</span>
<span class="n">append</span><span class="bp">._</span><span class="n">main</span><span class="bp">.</span><span class="n">equations</span><span class="bp">._</span><span class="n">eqn_2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">_</span><span class="n">aux_param_0</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">),</span> <span class="n">append</span><span class="bp">._</span><span class="n">main</span> <span class="o">(</span><span class="n">h</span> <span class="bp">::</span> <span class="n">t</span><span class="o">)</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">h</span> <span class="bp">::</span> <span class="n">append</span><span class="bp">._</span><span class="n">main</span> <span class="n">t</span> <span class="n">l</span>
<span class="n">append</span><span class="bp">._</span><span class="n">sunfold</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">},</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">list</span> <span class="n">α</span>
<span class="n">append</span><span class="bp">.</span><span class="n">equations</span><span class="bp">._</span><span class="n">eqn_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">),</span> <span class="n">append</span> <span class="n">list</span><span class="bp">.</span><span class="n">nil</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">l</span>
<span class="n">append</span><span class="bp">.</span><span class="n">equations</span><span class="bp">._</span><span class="n">eqn_2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">),</span> <span class="n">append</span> <span class="o">(</span><span class="n">h</span> <span class="bp">::</span> <span class="n">t</span><span class="o">)</span> <span class="n">l</span> <span class="bp">=</span> <span class="n">h</span> <span class="bp">::</span> <span class="n">append</span> <span class="n">t</span> <span class="n">l</span>
</code></pre></div>


<p>The ones with _eqn_ are useful sometimes if you want to explicitly do a rewrite using the definition of a particular branch of your function after like <code>cases l</code> or something.</p>



<a name="206329810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/why%20does%20my%20def%20call%20_main%3F/near/206329810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html#206329810">(Aug 08 2020 at 03:48)</a>:</h4>
<p><code>nil_append</code> and <code>cons_append</code></p>



<a name="206453697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/why%20does%20my%20def%20call%20_main%3F/near/206453697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html#206453697">(Aug 10 2020 at 12:15)</a>:</h4>
<p>The first two things you should prove about <code>append</code>  are <code>nil_append</code> and <code>cons_append</code>, that is, that <code>append</code> satisfies the two things which define it. If you are lucky the proofs are <code>rfl</code>, and in this case you don't ever need to think about <code>append._main</code> because you just proved the two theorems which completely characterise <code>append</code>.</p>



<a name="206453834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/why%20does%20my%20def%20call%20_main%3F/near/206453834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html#206453834">(Aug 10 2020 at 12:17)</a>:</h4>
<p>Sometimes with a more complex inductive type where pattern matching is done in a more obscure way under the hood, these proofs might not be <code>rfl</code> and then you'll have to dig a bit deeper to find that actually the proof is called <code>foo.equations._eqn_37</code> or whatever</p>



<a name="206453934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/why%20does%20my%20def%20call%20_main%3F/near/206453934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/why.20does.20my.20def.20call.20_main.3F.html#206453934">(Aug 10 2020 at 12:18)</a>:</h4>
<p>but I bet nil_append and cons_append (which are <code>_eqn_1</code> and <code>_eqn_2</code>) are provable with <code>rfl</code></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>