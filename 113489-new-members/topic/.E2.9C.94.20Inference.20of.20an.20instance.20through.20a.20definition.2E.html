---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html">✔ Inference of an instance through a definition.</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="256015402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256015402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256015402">(Oct 04 2021 at 07:11)</a>:</h4>
<p>However, even with my <em>ancient</em> Lean I can do this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[reducible]</span> <span class="kd">def</span> <span class="n">Binary_Relation</span> <span class="o">(</span><span class="n">α</span> <span class="n">β</span><span class="o">:</span> <span class="kt">Type</span><span class="o">):</span> <span class="kt">Type</span> <span class="o">:=</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">ℙ</span>
</code></pre></div>
<p>— And it tells the elaborator to unfold the definition, as desired.</p>



<a name="256016131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256016131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256016131">(Oct 04 2021 at 07:19)</a>:</h4>
<p>There is little point using 3.4.2: essentially, you will not get useful help here for it, because no one has been using it for a few years.</p>



<a name="256016300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256016300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256016300">(Oct 04 2021 at 07:21)</a>:</h4>
<p><code>@[reducible]</code> is often a code smell; use it sparingly, and until you're an expert perhaps consider it a sign you're not doing things "the lean way".</p>



<a name="256016361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256016361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256016361">(Oct 04 2021 at 07:21)</a>:</h4>
<p>Why is it a code smell?</p>



<a name="256016919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256016919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256016919">(Oct 04 2021 at 07:27)</a>:</h4>
<p>I upgraded to <code>version 3.33.0, commit a0fb1e8c7ac8, Release</code>. It complained to my notations, so I added back ticks as suggested above. Everything else is the same — type class inference fails without <code>reducible</code> and gets through with it.</p>



<a name="256017264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256017264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256017264">(Oct 04 2021 at 07:30)</a>:</h4>
<p><code>derive</code> doesn't work in your case because your instances are of the form "if X has a <code>Same</code> instance, then F(X) does too", and derive only handles unconditional instances. In this case, <code>reducible</code> is a reasonable approach, or using <code>abbreviation</code> instead of <code>def</code> which amounts to the same thing</p>



<a name="256018381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256018381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256018381">(Oct 04 2021 at 07:43)</a>:</h4>
<p><code>abbreviation</code> is the right solution. I do not think it is mentioned in the book.</p>



<a name="256018673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256018673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256018673">(Oct 04 2021 at 07:46)</a>:</h4>
<p><code>abbreviation</code> is the same as <code>@[reducible, inline] def</code></p>



<a name="256018868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256018868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256018868">(Oct 04 2021 at 07:48)</a>:</h4>
<p>The reason <code>@[reducible]</code> is a code smell is that you are making more work for the compiler - it needs to unfold this definition any time it's looking for typeclasses, or in many tactics. In that case, the value added by the definition is dubious, and maybe you should just be using a <code>notation</code></p>



<a name="256018949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256018949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256018949">(Oct 04 2021 at 07:50)</a>:</h4>
<p>(or not using it at all - certainly mathlib style is to write <code>α → β → Prop</code> instead of <code>Binary_Relation α β</code>.)</p>



<a name="256019017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019017">(Oct 04 2021 at 07:50)</a>:</h4>
<p>Where is <code>abbreviation</code> documented? I cannot find the right reference.</p>



<a name="256019033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019033">(Oct 04 2021 at 07:50)</a>:</h4>
<p>It may not be, it's a new addition</p>



<a name="256019089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019089">(Oct 04 2021 at 07:51)</a>:</h4>
<p>unfortunately most of the core lean documentation was written years ago and is not under the purview of the leanprover-community org</p>



<a name="256019091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019091">(Oct 04 2021 at 07:51)</a>:</h4>
<p>It's listed in <a href="https://github.com/leanprover/lean/releases">https://github.com/leanprover/lean/releases</a></p>



<a name="256019143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019143">(Oct 04 2021 at 07:51)</a>:</h4>
<p>"new addition" he says</p>



<a name="256019257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019257">(Oct 04 2021 at 07:52)</a>:</h4>
<p>For me, it was here forever.</p>



<a name="256019264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019264">(Oct 04 2021 at 07:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113489-new-members/topic/Ignat/near/256018868">said</a>:</p>
<blockquote>
<p>… In that case, the value added by the definition is dubious, and maybe you should just be using a <code>notation</code> …</p>
</blockquote>
<p>Yes, I think I should leave it out since it is so simple. But having abbreviations is still a good thing.</p>



<a name="256019328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019328">(Oct 04 2021 at 07:53)</a>:</h4>
<p>I think the name <code>abbreviation</code> carries some baggage that might not be a good thing here. Abbreviations are certainly a good thing but <code>abbreviation</code> may not be the way to accomplish it</p>



<a name="256019396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019396">(Oct 04 2021 at 07:54)</a>:</h4>
<p>What do you mean?</p>



<a name="256019596"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256019596" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256019596">(Oct 04 2021 at 07:56)</a>:</h4>
<p>There are lots of ways to make definitions, depending on to what extent you want to establish an API barrier or a leaky abstraction, or just save a few characters in writing. In rough order of transparency:</p>
<ul>
<li><code>notation</code></li>
<li><code>abbreviation</code></li>
<li><code>@[reducible] def</code></li>
<li><code>instance</code></li>
<li><code>def</code></li>
<li><code>theorem</code>, <code>lemma</code></li>
<li><code>@[irreducible] def</code></li>
<li><code>constant</code> (lean 4)</li>
<li><code>axiom</code>, <code>constant</code> (lean 3)</li>
</ul>



<a name="256020193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256020193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256020193">(Oct 04 2021 at 08:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="448347">Ignat Insarov</span> has marked this topic as resolved.</p>



<a name="256020289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256020289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256020289">(Oct 04 2021 at 08:02)</a>:</h4>
<p>I am glad I made it.</p>



<a name="256020336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256020336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256020336">(Oct 04 2021 at 08:02)</a>:</h4>
<p>To think that yesterday I was about to give up.</p>



<a name="256020366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/%E2%9C%94%20Inference%20of%20an%20instance%20through%20a%20definition./near/256020366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ignat Insarov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/.E2.9C.94.20Inference.20of.20an.20instance.20through.20a.20definition.2E.html#256020366">(Oct 04 2021 at 08:03)</a>:</h4>
<p>Thanks everyone!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>