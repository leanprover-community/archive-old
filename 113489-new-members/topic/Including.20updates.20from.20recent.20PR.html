---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html">Including updates from recent PR</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="230987936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230987936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob Scholbach <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230987936">(Mar 19 2021 at 08:08)</a>:</h4>
<p>I'm in the middle of working on a PR (<a href="https://github.com/leanprover-community/mathlib/issues/6671">#6671</a>). I want to use / refer to recent changes that were made in another PR <a href="https://github.com/leanprover-community/mathlib/issues/6753">#6753</a>. </p>
<ol>
<li>How do I conveniently update my copy of mathlib in my own PR? (In this particular case I could just manually copy the file changed in the other PR <a href="https://github.com/leanprover-community/mathlib/issues/6753">#6753</a>, but I'm sure this is not how one is supposed to do it).</li>
<li>How do I make sure updating my local mathlib copy in the PR is not eventually regarded as part of the submission of my own PR? (There is no overlap in the files touched by the two PRs.)?</li>
</ol>



<a name="230987979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230987979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230987979">(Mar 19 2021 at 08:09)</a>:</h4>
<p><span class="user-mention" data-user-id="247154">@Jakob Scholbach</span> do you have <code>leanproject</code> installed?</p>



<a name="230987989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230987989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob Scholbach <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230987989">(Mar 19 2021 at 08:09)</a>:</h4>
<p>yes</p>



<a name="230987992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230987992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230987992">(Mar 19 2021 at 08:09)</a>:</h4>
<p>great</p>



<a name="230988074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230988074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230988074">(Mar 19 2021 at 08:10)</a>:</h4>
<p>So you can do</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">git</span> <span class="n">checkout</span> <span class="n">master</span>
<span class="n">leanproject</span> <span class="n">up</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="n">branch_jakob</span>
<span class="n">git</span> <span class="n">merge</span> <span class="n">master</span>
</code></pre></div>



<a name="230988132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230988132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230988132">(Mar 19 2021 at 08:11)</a>:</h4>
<p>That will merge the newest version of <code>master</code> into your branch, and on the branch you will then have <code>olean</code>s from <code>master</code>. So you need to <code>leanproject build</code> to get oleans for you branch</p>



<a name="230988139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230988139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230988139">(Mar 19 2021 at 08:11)</a>:</h4>
<p>But if you change just 1 or 2 files, that is usually quite fast</p>



<a name="230988204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230988204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230988204">(Mar 19 2021 at 08:12)</a>:</h4>
<p>Git will take care of doing something sensible (when there is no overlap) so you don't have to worry about Q2</p>



<a name="230988226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230988226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230988226">(Mar 19 2021 at 08:12)</a>:</h4>
<p>If there is overlap, git will tell you during the <code>git merge master</code>, and ask you to resolve the conflicts.</p>



<a name="230988270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230988270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230988270">(Mar 19 2021 at 08:13)</a>:</h4>
<p>Now, if you have two branches, say <code>exp_char</code> and <code>sep_degree</code>, then you first do this process for <code>exp_char</code>, and then afterwards you do</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">git</span> <span class="n">checkout</span> <span class="n">sep_degree</span>
<span class="n">git</span> <span class="n">merge</span> <span class="n">exp_char</span>
<span class="n">git</span> <span class="n">push</span>
</code></pre></div>



<a name="230988286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230988286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230988286">(Mar 19 2021 at 08:13)</a>:</h4>
<p>And that will make the 2nd PR incorporate all the changes made to PR 1</p>



<a name="230989247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/230989247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jakob Scholbach <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#230989247">(Mar 19 2021 at 08:25)</a>:</h4>
<p>Works great, thanks! (Might be part of that tiny tutorial...)</p>



<a name="231016991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231016991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231016991">(Mar 19 2021 at 12:49)</a>:</h4>
<p>If you make a pull request for the 2nd branch before the 1st branch's pull request has been merged, you'll also need to remember to note this in the pull request summary. (Read the template, it shows the format for describing dependent PRs.) (And then be patient... :-)</p>



<a name="231187781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231187781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Benjamin Davidson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231187781">(Mar 21 2021 at 02:51)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> What does "<code>leanproject up</code>" do? Is that essentially the same as <code>git pull</code> (which is what I have been using at that point when merging)?</p>



<a name="231201602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231201602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231201602">(Mar 21 2021 at 08:13)</a>:</h4>
<p>Might depend on whether you're working in mathlib or in your own repo with mathlib as a dependency. If in your own repo it might well update the mathlib dependency to the latest mathlib and possibly download oleans too. What does <code>leanproject --help</code> say?</p>



<a name="231201935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231201935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Benjamin Davidson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231201935">(Mar 21 2021 at 08:21)</a>:</h4>
<p>I generally work in mathlib. <code>leanproject --help</code> says "Upgrade mathlib (as a dependency or as the main..." for the command <code>upgrade-mathlib</code>.</p>



<a name="231202000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231202000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231202000">(Mar 21 2021 at 08:23)</a>:</h4>
<p>I never use the command when I'm working on mathlib, for me this is a command to bump mathlib when it's a dependency</p>



<a name="231202067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231202067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231202067">(Mar 21 2021 at 08:24)</a>:</h4>
<p>If you have master checked out then I could imagine it would be the same as git pull followed by leanproject get-cache but you can easily find out by experimenting</p>



<a name="231206309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231206309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Benjamin Davidson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231206309">(Mar 21 2021 at 10:02)</a>:</h4>
<p>Okay thanks! Was just curious to learn a new/potentially better way of doing things.</p>



<a name="231223018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231223018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231223018">(Mar 21 2021 at 15:32)</a>:</h4>
<p>That's somewhat annoying <code>--help</code> behavior (which obviously isn't leanproject's fault, I think it's a bad <code>click</code> default IIRC)</p>



<a name="231223042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231223042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231223042">(Mar 21 2021 at 15:33)</a>:</h4>
<p>But here's the code (and full docstring): <a href="https://github.com/leanprover-community/mathlib-tools/blob/master/mathlibtools/leanproject.py#L103">https://github.com/leanprover-community/mathlib-tools/blob/master/mathlibtools/leanproject.py#L103</a> which calls <a href="https://github.com/leanprover-community/mathlib-tools/blob/master/mathlibtools/lib.py#L537-L540">https://github.com/leanprover-community/mathlib-tools/blob/master/mathlibtools/lib.py#L537-L540</a></p>



<a name="231223059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231223059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231223059">(Mar 21 2021 at 15:33)</a>:</h4>
<p>so it does appear it does slightly different things depending on if you're working on mathlib or not -- for mathlib it looks like it should just run <code>git pull</code> for the current branch and then fetch oleans. For not-mathlib it looks like it should discard local changes to mathlib as a dependency, then run <code>leanpkg upgrade</code> (which will update all dependencies, including mathlib), then fetch oleans for mathlib. And then thirdly if you run this outside a project repo it looks like it will upgrade a user-wide (i.e. non-project specific) mathlib install.</p>



<a name="231241155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231241155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231241155">(Mar 21 2021 at 21:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321696">Julian Berman</span> <a href="#narrow/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR/near/231223018">said</a>:</p>
<blockquote>
<p>That's somewhat annoying <code>--help</code> behavior (which obviously isn't leanproject's fault, I think it's a bad <code>click</code> default IIRC)</p>
</blockquote>
<p>What is the annoying <code>--help</code> behavior? Truncating the help message? You can get the full version using <code>leanproject upgrade-mathlib --help</code>. About general remarks concerning <code>click</code>, note that I've very careful to separate the leanproject library from the client. One goal was to allow building more tools on top of the library, but the other was making sure we could change the client part in case we can find something better than <code>click</code> (or someone has courage to write custom code).</p>



<a name="231241772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231241772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231241772">(Mar 21 2021 at 21:18)</a>:</h4>
<p>Yeah, truncating <code>--help</code> without running it on the subcommand (I think it should just wrap and cut off at some much longer length even when you run it on the top level command) -- and FWIW I wasn't questioning the click choice, it's the best of the options, I just don't like this behavior. (And if I haven't said so before I find leanproject in general quite reasonably written!)</p>



<a name="231242036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231242036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231242036">(Mar 21 2021 at 21:23)</a>:</h4>
<p>Perhaps the help text could be changed so that it cuts off at a more reasonable point?</p>



<a name="231242235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231242235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231242235">(Mar 21 2021 at 21:27)</a>:</h4>
<p>Feel free to PR changes to any help message.</p>



<a name="231242304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231242304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231242304">(Mar 21 2021 at 21:28)</a>:</h4>
<p>does the cutoff point depend on the terminal width?</p>



<a name="231242391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231242391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231242391">(Mar 21 2021 at 21:30)</a>:</h4>
<p><a href="https://github.com/ansible-community/molecule/pull/2768/files#diff-2517335dce22ba8b2a7f7afd8ea59cad2997aa523b1c981031c22965b86b3856R221">https://github.com/ansible-community/molecule/pull/2768/files#diff-2517335dce22ba8b2a7f7afd8ea59cad2997aa523b1c981031c22965b86b3856R221</a></p>



<a name="231242395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231242395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231242395">(Mar 21 2021 at 21:30)</a>:</h4>
<p>this is how you disable that behavior IIRC</p>



<a name="231242467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231242467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231242467">(Mar 21 2021 at 21:31)</a>:</h4>
<p>(if I get some cycles and someone else doesn't get to it first I can get to that at some point)</p>



<a name="231242521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Including%20updates%20from%20recent%20PR/near/231242521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Including.20updates.20from.20recent.20PR.html#231242521">(Mar 21 2021 at 21:32)</a>:</h4>
<p>It looks like the existing text is just barely over the limit (78-ish characters?). You could drop a word and bring it under that</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>  upgrade-mathlib    Upgrade mathlib (as a dependency or the main project).
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>