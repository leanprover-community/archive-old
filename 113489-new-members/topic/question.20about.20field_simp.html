---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/question.20about.20field_simp.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html">question about field_simp</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="220782830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220782830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jz Pan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220782830">(Dec 23 2020 at 12:03)</a>:</h4>
<p>I'd like to prove the following result (this is the discriminant of an elliptic curve with j-invariant equal to j):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h1728</span> <span class="o">:</span> <span class="n">j</span><span class="bp">-</span><span class="mi">1728</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
<span class="o">((</span><span class="bp">-</span><span class="mi">36</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">))</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)</span> <span class="bp">-</span> <span class="mi">8</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">-</span><span class="mi">36</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)))</span> <span class="bp">^</span> <span class="mi">3</span> <span class="bp">-</span> <span class="mi">27</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">4</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)))</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="mi">9</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">-</span><span class="mi">36</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)))</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">4</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)))</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">calc</span> <span class="o">((</span><span class="bp">-</span><span class="mi">36</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">))</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)</span> <span class="bp">-</span> <span class="mi">8</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">-</span><span class="mi">36</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)))</span> <span class="bp">^</span> <span class="mi">3</span> <span class="bp">-</span> <span class="mi">27</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">4</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)))</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="mi">9</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">-</span><span class="mi">36</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)))</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">4</span> <span class="bp">*</span> <span class="o">((</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1728</span><span class="o">)))</span>
  <span class="bp">=</span> <span class="n">j</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span><span class="bp">-</span><span class="mi">1728</span><span class="o">)</span><span class="bp">^</span><span class="mi">3</span> <span class="o">:</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="n">field_simp</span> <span class="o">[</span><span class="n">h1728</span><span class="o">],</span>
    <span class="gr">sorry</span><span class="o">,</span>
  <span class="o">}</span>
  <span class="bp">...</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="n">field_simp</span> <span class="o">[</span><span class="n">h1728</span><span class="o">,</span> <span class="n">h0</span><span class="o">],</span>
  <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>
<p>but the first field_simp seems not work. Any suggestions?</p>



<a name="220784073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784073">(Dec 23 2020 at 12:23)</a>:</h4>
<p>the goal is changing before and after the first <code>field_simp</code>, right?</p>



<a name="220784192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784192">(Dec 23 2020 at 12:25)</a>:</h4>
<p>Yes, <code>field_simp</code> seems to be doing it's job</p>



<a name="220784206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784206">(Dec 23 2020 at 12:25)</a>:</h4>
<p>You can close that sorry with <code>ring_exp, ring</code></p>



<a name="220784226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784226">(Dec 23 2020 at 12:25)</a>:</h4>
<p><code>ring</code> is enough.</p>



<a name="220784327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784327">(Dec 23 2020 at 12:26)</a>:</h4>
<p>Is that a <code>ring_exp</code> bug that it doesn't close this goal, by the way?</p>



<a name="220784330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784330" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784330">(Dec 23 2020 at 12:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/question.20about.20field_simp/near/220784192">said</a>:</p>
<blockquote>
<p>Yes, <code>field_simp</code> seems to be doing it's job</p>
</blockquote>
<p>Well, it didn't clear all denominators.</p>



<a name="220784354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784354">(Dec 23 2020 at 12:26)</a>:</h4>
<p><code>field_simp [pow_succ, h1728]</code> does clear all denoms.</p>



<a name="220784392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784392">(Dec 23 2020 at 12:27)</a>:</h4>
<p>Here, it does close all denominators.</p>



<a name="220784474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784474">(Dec 23 2020 at 12:28)</a>:</h4>
<p>You were fiddling with attributes the other day though</p>



<a name="220784517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220784517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220784517">(Dec 23 2020 at 12:29)</a>:</h4>
<p>ooh, maybe I'm on a mathlib that's too old</p>



<a name="220785141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220785141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jz Pan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220785141">(Dec 23 2020 at 12:39)</a>:</h4>
<p>Thanks, I confirm that</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="bp">=</span> <span class="n">j</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">/</span> <span class="o">(</span><span class="n">j</span><span class="bp">-</span><span class="mi">1728</span><span class="o">)</span><span class="bp">^</span><span class="mi">3</span> <span class="o">:</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="n">field_simp</span> <span class="o">[</span><span class="n">pow_succ</span><span class="o">,</span> <span class="n">h1728</span><span class="o">],</span>
    <span class="n">ring</span><span class="o">,</span>
  <span class="o">}</span>
</code></pre></div>
<p>works. Maybe I'm using an old version of mathlib, who knows. Anyway I already fixed it by using another elliptic curve whose a1 a2 a3 a4 a6 have no denominators (using a linear change of variable to eliminate all its denominators) <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="220788415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220788415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220788415">(Dec 23 2020 at 13:29)</a>:</h4>
<p>I tried to prove the group law was associative for the general a1 a2...a6 form and lean got bogged down in the algebra. I am running a student project on elliptic curves next term and I was tempted to just stick to x^3+Ax+B.</p>



<a name="220851025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220851025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jz Pan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220851025">(Dec 24 2020 at 05:58)</a>:</h4>
<p>Interesting. I heard that somebody already implemented the group law for general Weierstrass form.</p>



<a name="220851090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220851090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220851090">(Dec 24 2020 at 06:00)</a>:</h4>
<p>I think that was Kevin, together with John Cremona. But I'm not sure if they finished it in the end. Kevin's comment above sounds like they didn't...</p>



<a name="220860193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220860193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220860193">(Dec 24 2020 at 09:58)</a>:</h4>
<p>Oh I'm sure this has been done in other provers. Cremona and I have some work we were doing for fun at LFTCM</p>



<a name="220910978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220910978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jz Pan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220910978">(Dec 25 2020 at 08:19)</a>:</h4>
<p>Oops, when I upgrade the mathlib my old file breaks, which complains with 'unknown identifier field_simp'. The last version I used is around 12-02.</p>



<a name="220911951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220911951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220911951">(Dec 25 2020 at 08:45)</a>:</h4>
<p>Try adding <code>import tactic.field_simp</code>?</p>



<a name="220912854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220912854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jz Pan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220912854">(Dec 25 2020 at 09:12)</a>:</h4>
<p>And then it doesn't solve the goal anymore <span aria-label="neutral" class="emoji emoji-1f610" role="img" title="neutral">:neutral:</span></p>



<a name="220912858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220912858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220912858">(Dec 25 2020 at 09:12)</a>:</h4>
<p>How close does it get?</p>



<a name="220912995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220912995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jz Pan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220912995">(Dec 25 2020 at 09:17)</a>:</h4>
<blockquote>
<p>How close does it get?</p>
</blockquote>
<p>I forgot; I have already revert the mathlib version :|</p>



<a name="220913940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220913940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220913940">(Dec 25 2020 at 09:45)</a>:</h4>
<p><code>field_simp</code> became more powerful... so if it stopped closing a goal, we would be interested to know what it looks like...</p>



<a name="220953756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/question%20about%20field_simp/near/220953756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jz Pan <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/question.20about.20field_simp.html#220953756">(Dec 26 2020 at 07:21)</a>:</h4>
<p>You can go to <a href="https://gitee.com/acmepjz/my-lean-test/tree/master/tests/gtm106">https://gitee.com/acmepjz/my-lean-test/tree/master/tests/gtm106</a> for my test codes.  Current I'm using mathlib version 1f1ba587f272d203a40801c6b21af453f7de6ee3 2020-11-29 and all of my code works.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>