---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html">Contribution to mathlib with the Ostrowski theorem</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="187391951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187391951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187391951">(Feb 04 2020 at 19:35)</a>:</h4>
<p>Hello, I'm a beginner in Lean and I want to create my first contribution to mathlib with the Ostrowski theorem: <a href="https://en.wikipedia.org/wiki/Ostrowski%27s_theorem" target="_blank" title="https://en.wikipedia.org/wiki/Ostrowski%27s_theorem">https://en.wikipedia.org/wiki/Ostrowski%27s_theorem</a> — I read that I should try to inform the community first and discuss regarding new contributions, so here I am. I also use this post to ask about the topological equivalence between metrics, I looked through the API doc for some "equiv", "metric equivalence" but didn't found anything.</p>
<p>So my guess is either it does not exist yet, it exists under a name that I do not know, it can be trivially created from the data.equiv module (?).</p>
<p>Thank you in advance and thank you for this awesome thing!</p>



<a name="187392277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187392277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187392277">(Feb 04 2020 at 19:38)</a>:</h4>
<p>Which equivalence relation are you talking about? The Wiki page doesn't state it in the header, and I don't want to read the proof.</p>



<a name="187393181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187393181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187393181">(Feb 04 2020 at 19:46)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> Topological equivalence (metrics induces the same topology), I can see topological_space_eq and uniform_space_eq but what about metric_space_eq ?</p>



<a name="187393255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187393255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187393255">(Feb 04 2020 at 19:47)</a>:</h4>
<p>So you want to say that the identity is a homeomorphism.</p>



<a name="187393399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187393399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187393399">(Feb 04 2020 at 19:48)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> Right.</p>



<a name="187393474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187393474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187393474">(Feb 04 2020 at 19:49)</a>:</h4>
<p>Then define a <code>homeomorph</code> between two metric spaces with <code>to_fun = id</code> and <code>inv_fun = id</code>.</p>



<a name="187393591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187393591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187393591">(Feb 04 2020 at 19:50)</a>:</h4>
<p>Note that we use typeclasses for norms so you'll need something like <code>def rat_with_norm (norm : has_norm rat) := rat</code>, or maybe a more general version.</p>



<a name="187393999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187393999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187393999">(Feb 04 2020 at 19:54)</a>:</h4>
<p>Alright, understood @ topological equivalence in metric spaces! That's super clear.</p>
<p>But, I'm not sure why I would need to define <code>rat_with_norm</code> for now?</p>



<a name="187394664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187394664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187394664">(Feb 04 2020 at 20:00)</a>:</h4>
<p>When you write <code>rat</code>, Lean tries to find the norm associated with this type. If you want to deal with two norms on the same space, you need to fool Lean into treating them as to different types.</p>



<a name="187394980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187394980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187394980">(Feb 04 2020 at 20:03)</a>:</h4>
<p>I don't think you need such wrapper.</p>



<a name="187395036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395036">(Feb 04 2020 at 20:04)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> Oh, makes sense.</p>
<p>Also, I'm trying to make general definitions of <code>metric_space_eq</code> like this:</p>
<div class="codehilite"><pre><span></span>definition metric_space_eq {α : Type u} {β : Type u} [metric_space α] [metric_space β] :=
    ({continuous_to_fun := id _, continuous_inv_fun := id _} : homeomorph α β)
</pre></div>


<p>And I have a lot of errors, but I guess I'm doing something super wrong, I defined some universe <code>u</code> before and imported everything I needed:</p>
<div class="codehilite"><pre><span></span>ostrowski.lean:19:5: error
invalid structure value { ... }, field &#39;to_fun&#39; was not provided
ostrowski.lean:19:5: error
invalid structure value { ... }, field &#39;inv_fun&#39; was not provided
ostrowski.lean:19:5: error
invalid structure value { ... }, field &#39;left_inv&#39; was not provided
ostrowski.lean:19:5: error
invalid structure value { ... }, field &#39;right_inv&#39; was not provided
</pre></div>


<p>When I use <code>to_fun</code> and <code>inv_fun</code>, it says that continuous ones are missing.</p>



<a name="187395038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395038">(Feb 04 2020 at 20:04)</a>:</h4>
<p>Also, Ryan, you should have a look at the <code>data/padics</code> in mathlib</p>



<a name="187395049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395049">(Feb 04 2020 at 20:04)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Yes I'm reusing most of the stuff that I can that is in there.</p>



<a name="187395195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395195">(Feb 04 2020 at 20:06)</a>:</h4>
<p>In particular I don't think it uses doesn't  <code>analysis/normed_space</code></p>



<a name="187395307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395307">(Feb 04 2020 at 20:07)</a>:</h4>
<p>You should reuse <code>equiv.refl</code> for many fields. Sorry, I have to go.</p>



<a name="187395395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395395">(Feb 04 2020 at 20:08)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> It's alright, thank you, I'll try to figure it out!</p>



<a name="187395414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395414">(Feb 04 2020 at 20:09)</a>:</h4>
<p>Anyway the main lemma should state that <code>id</code> is continuous. Once you prove this, packing into <code>homeomorph</code> will be easy.</p>



<a name="187395443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395443">(Feb 04 2020 at 20:09)</a>:</h4>
<p>I mean, <code>id</code> from <code>rat</code> with one norm to <code>rat</code> with standard norm.</p>



<a name="187395446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395446">(Feb 04 2020 at 20:09)</a>:</h4>
<p>And the same for reversed <code>id</code>.</p>



<a name="187395788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395788">(Feb 04 2020 at 20:13)</a>:</h4>
<p>Ryan, could you clarify what you want about "equivalent metrics"? I mean the math meaning, not Lean code.</p>



<a name="187395814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395814">(Feb 04 2020 at 20:13)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Topological equivalence</p>



<a name="187395862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395862" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395862">(Feb 04 2020 at 20:14)</a>:</h4>
<p>Of what?</p>



<a name="187395868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395868">(Feb 04 2020 at 20:14)</a>:</h4>
<p>Two metric structure on the same type?</p>



<a name="187395876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395876">(Feb 04 2020 at 20:14)</a>:</h4>
<p>Or different types?</p>



<a name="187395904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395904">(Feb 04 2020 at 20:14)</a>:</h4>
<p>Do you want to define a predicate or something containing data?</p>



<a name="187395957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187395957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187395957">(Feb 04 2020 at 20:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Mathematically, what I want is something that <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> said: I want that id : (E, d_1) → (E, d_2) is an homemorphism, implying that (E, d_1) and (E, d_2) have the same opens (so topological equivalence of topological spaces?)</p>



<a name="187396014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396014">(Feb 04 2020 at 20:16)</a>:</h4>
<p>So you want a predicate with input E, d_1 and d_2, right?</p>



<a name="187396037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396037">(Feb 04 2020 at 20:16)</a>:</h4>
<p>Indeed, what I defined earlier takes two metric spaces which is not what I want in fact</p>



<a name="187396053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396053">(Feb 04 2020 at 20:16)</a>:</h4>
<p>Ostrowski can be formalised without any mention of topology. The guts of it is a purely algebraic statement. There is an independent fact that two norms on a field are equivalent (|.|_1=|.|_2^d) if and only if they induce the same topology, but this is somehow an independent thing.</p>



<a name="187396057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396057">(Feb 04 2020 at 20:16)</a>:</h4>
<p>Yes, this is what I fond confusing.</p>



<a name="187396075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396075">(Feb 04 2020 at 20:17)</a>:</h4>
<p>What you ask for is then:</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">metric_space_eqv</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">d</span> <span class="n">d&#39;</span> <span class="o">:</span> <span class="n">metric_space</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">d</span><span class="bp">.</span><span class="n">to_uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span> <span class="bp">=</span> <span class="n">d&#39;</span><span class="bp">.</span><span class="n">to_uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span>
</pre></div>



<a name="187396099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396099">(Feb 04 2020 at 20:17)</a>:</h4>
<p>I was answering Ryan, not Kevin.</p>



<a name="187396182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396182">(Feb 04 2020 at 20:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> I agree with this, I just want to port the entire theorem, it's also a way for me to get better at Lean and understand more ; though I think I'll try to isolate the algebraic statement from the topological one.</p>



<a name="187396218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396218">(Feb 04 2020 at 20:18)</a>:</h4>
<p>What Kevin says is more specific. In general there is no nice algebraic criterion for topological equivalence between metrics (for instance asking that Id is bilipschitz is much stronger).</p>



<a name="187396277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396277">(Feb 04 2020 at 20:19)</a>:</h4>
<p>Yes, this is specific to fields, but Ostrowski is about <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi></mrow><annotation encoding="application/x-tex">\mathbb{Q}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.85556em;vertical-align:-0.16667em;"></span><span class="mord"><span class="mord mathbb">Q</span></span></span></span></span> so this topology talk is perhaps misleading.</p>



<a name="187396309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396309">(Feb 04 2020 at 20:19)</a>:</h4>
<p>The work is checking that every norm is one of the ones we know already. There's a proof in Cassels' book on local fields which might be pleasant to formalise.</p>



<a name="187396327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396327">(Feb 04 2020 at 20:19)</a>:</h4>
<p>Indeed, this is why I suggested reading <code>data/padics</code> instead of anything living under <code>topology</code> or <code>analysis</code>.</p>



<a name="187396455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396455">(Feb 04 2020 at 20:21)</a>:</h4>
<p>Cassels' proof involves taking a limit though, it might be quite an interesting project to do in Lean.</p>



<a name="187396610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396610">(Feb 04 2020 at 20:23)</a>:</h4>
<p>That sounds super interesting, I'm going to get the proof and study it, if I have any further issue, I'll try to come back ; BTW, are limits available in Lean?</p>



<a name="187396722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396722">(Feb 04 2020 at 20:24)</a>:</h4>
<p>sure, I just thought it was interesting that things like limits and logs were involved when the statement feels quite algebraic.</p>



<a name="187396767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396767">(Feb 04 2020 at 20:25)</a>:</h4>
<p>Sure, we have a lot about limits in mathlib.</p>



<a name="187396775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396775">(Feb 04 2020 at 20:25)</a>:</h4>
<p>Awesome :)</p>



<a name="187396781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396781">(Feb 04 2020 at 20:25)</a>:</h4>
<p>Search for <code>tendsto</code>.</p>



<a name="187396864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187396864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187396864">(Feb 04 2020 at 20:26)</a>:</h4>
<p>You can use the search at <a href="https://leanprover-community.github.io/mathlib_docs/" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/">https://leanprover-community.github.io/mathlib_docs/</a></p>



<a name="187397005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187397005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187397005">(Feb 04 2020 at 20:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Yes, it has been super useful so far</p>



<a name="187397142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187397142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187397142">(Feb 04 2020 at 20:30)</a>:</h4>
<p>[I just clicked on the link you posted and it looks to me like it's the same proof as in Cassels]</p>



<a name="187411659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187411659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187411659">(Feb 04 2020 at 23:33)</a>:</h4>
<p>I come back with plenty of questions:<br>
— let's say I want to prove that a finite product of M non-negative rationals such that the result is &lt; 1 contains at least a term such that it is &lt; 1, should I use the list type for this?<br>
I have a lemma like this:</p>
<div class="codehilite"><pre><span></span>lemma product_of_nonnegative_rat_le_one_contains_at_least_one_le_one_factor (L : list ℚ)  (H: ∀ a : ℚ, a ∈ L → a ≥ 0) (J: list.prod L ≤ 1)
    : ∃ a : ℚ, a ∈ L ∧ a ≤ 1 := sorry
</pre></div>


<p>bonus: should I design it so that it rather show the existence of j such that nth L j ≤ 1 (that's better I suppose).</p>
<p>— next is, I have an n0 ≥ 2, I want to apply the absolute value on its prime factor decomposition, so naively, I do <code>have afactors := list.map abv (nat.factors n0)</code> and I get a list of Q, but I have this hypothesis on n0 which is abv n0 &lt;= 1 and I want to transmit it to <code>list.prod afactors</code>, so I guess I have to use the fact that <code>list.prod (nat.factors n0) = n0</code> to get<code>list.prod (list.map abv nat.factors n0) = abv n0</code>.<br>
Maybe I don't know enough about the mathlib to perform this easily.</p>
<p>Thank you!</p>



<a name="187414117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187414117" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187414117">(Feb 05 2020 at 00:17)</a>:</h4>
<blockquote>
<p>Hello, I'm a beginner in Lean and I want to create my first contribution to mathlib with the Ostrowski theorem: <a href="https://en.wikipedia.org/wiki/Ostrowski%27s_theorem" target="_blank" title="https://en.wikipedia.org/wiki/Ostrowski%27s_theorem">https://en.wikipedia.org/wiki/Ostrowski%27s_theorem</a> — I read that I should try to inform the community first and discuss regarding new contributions, so here I am. I also use this post to ask about the topological equivalence between metrics, I looked through the API doc for some "equiv", "metric equivalence" but didn't found anything.</p>
<p>So my guess is either it does not exist yet, it exists under a name that I do not know, it can be trivially created from the data.equiv module (?).</p>
</blockquote>
<p>I took a crack at Ostrowski at one point (see the attached file). Its a complete work in progress and it needs a lot of cleanup, but some of the key steps were there. I was hindered a bit by the fact that I didn't really develop the theory of equivalences, or expressing different numbers in different bases before I began, and I didn't really have a mathematical reference in mind before I started. The most succinct math proof I have seen is due to Artin and combines a lot of the steps in quite a neat way, so I'd probably try and reformat it to follow that more if I did it again or restarted.  You are more than welcome to take bits of this or completely ignore it of course ;): <a href="/user_uploads/3121/gS3jskD-aTYwB52dE5AA874V/ostrowski.lean" target="_blank" title="ostrowski.lean">ostrowski.lean</a></p>



<a name="187430920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187430920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187430920">(Feb 05 2020 at 07:14)</a>:</h4>
<p>I think people usually use finset.prod,  which has the best interface</p>



<a name="187431001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187431001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187431001">(Feb 05 2020 at 07:16)</a>:</h4>
<p>The lemma that you need about applying a group hom to a finite product being equal to the product of the factors will surely be there for finset products</p>



<a name="187431030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187431030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187431030">(Feb 05 2020 at 07:17)</a>:</h4>
<p>Note that the finset isn't the set of factors, it is an auxiliary finite set equipped with a map to the factors</p>



<a name="187431100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187431100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187431100">(Feb 05 2020 at 07:19)</a>:</h4>
<p>In other words... one option is to use a family of elements, indexed by some index type <code>\iota</code>. This is how the <code>finset.prod</code> stuff works.</p>



<a name="187431109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187431109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187431109">(Feb 05 2020 at 07:19)</a>:</h4>
<p>Using lists is in principle a good idea. It's just not the way it's been done in mathlib. Not sure if that is silly on our side, though...</p>



<a name="187448197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448197">(Feb 05 2020 at 12:20)</a>:</h4>
<blockquote>
<blockquote>
<p>Hello, I'm a beginner in Lean and I want to create my first contribution to mathlib with the Ostrowski theorem: <a href="https://en.wikipedia.org/wiki/Ostrowski%27s_theorem" target="_blank" title="https://en.wikipedia.org/wiki/Ostrowski%27s_theorem">https://en.wikipedia.org/wiki/Ostrowski%27s_theorem</a> — I read that I should try to inform the community first and discuss regarding new contributions, so here I am. I also use this post to ask about the topological equivalence between metrics, I looked through the API doc for some "equiv", "metric equivalence" but didn't found anything.</p>
<p>So my guess is either it does not exist yet, it exists under a name that I do not know, it can be trivially created from the data.equiv module (?).</p>
</blockquote>
<p>I took a crack at Ostrowski at one point (see the attached file). Its a complete work in progress and it needs a lot of cleanup, but some of the key steps were there. I was hindered a bit by the fact that I didn't really develop the theory of equivalences, or expressing different numbers in different bases before I began, and I didn't really have a mathematical reference in mind before I started. The most succinct math proof I have seen is due to Artin and combines a lot of the steps in quite a neat way, so I'd probably try and reformat it to follow that more if I did it again or restarted.  You are more than welcome to take bits of this or completely ignore it of course ;): <a href="/user_uploads/3121/gS3jskD-aTYwB52dE5AA874V/ostrowski.lean" target="_blank" title="ostrowski.lean">ostrowski.lean</a></p>
</blockquote>
<p>That's super helpful, I want to read a lot of Lean to understand more :)</p>



<a name="187448332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448332">(Feb 05 2020 at 12:22)</a>:</h4>
<blockquote>
<p>In other words... one option is to use a family of elements, indexed by some index type <code>\iota</code>. This is how the <code>finset.prod</code> stuff works.</p>
</blockquote>
<p>I understand ; but is<code>nat.factors</code> compatible with <code>finset</code>?</p>



<a name="187448398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448398">(Feb 05 2020 at 12:23)</a>:</h4>
<p>Maybe not as compatible as we would like <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="187448453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448453">(Feb 05 2020 at 12:24)</a>:</h4>
<p>This might be an argument to go with lists</p>



<a name="187448476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448476">(Feb 05 2020 at 12:24)</a>:</h4>
<p>Here's a question: can you <em>state</em> Ostrowski in Lean? Or is that impossible with current state of the library?</p>



<a name="187448508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448508">(Feb 05 2020 at 12:25)</a>:</h4>
<p>(And then I mean a relatively clean statement. I'm sure we can get some unreadable thing that is some form of Ostrowski.)</p>



<a name="187448825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448825">(Feb 05 2020 at 12:30)</a>:</h4>
<p>State as in: says that if some absolute value over Q is not the trivial absolute value (in terms of pointwise equality), then (Q, |⋅|) is topologically equivalent as topological spaces to (Q, |⋅|_p) or (Q, |⋅|_inf) for some p prime ; right?</p>
<p>Or in terms of proof?</p>



<a name="187448870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448870">(Feb 05 2020 at 12:30)</a>:</h4>
<p>No, I mean</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">Ostrowski</span> <span class="o">:</span> <span class="bp">_</span><span class="n">fill_this_in_</span> <span class="o">:=</span>
<span class="n">sorry</span>
</pre></div>



<a name="187448891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187448891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187448891">(Feb 05 2020 at 12:31)</a>:</h4>
<p>So, you can leave the <code>sorry</code> there, for now.</p>



<a name="187449132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187449132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187449132">(Feb 05 2020 at 12:35)</a>:</h4>
<blockquote>
<p>No, I mean</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">Ostrowski</span> <span class="o">:</span> <span class="bp">_</span><span class="n">fill_this_in_</span> <span class="o">:=</span>
<span class="n">sorry</span>
</pre></div>


</blockquote>
<p>This is what I understood, don't worry ; </p>
<p><code>(abv : \Q \to \Q) [is_absolute_value abv] (H\_1: \not (abv \eq trivial_abs)) : (\exists p : nat.primes, …) \or (…))</code></p>
<p>Where <code>…</code> is something about the topological equivalence regarding <code>padic.padic_norm</code> and standard absolute value which I think is possible based on what <span class="user-mention" data-user-id="110031">@Patrick Massot</span> and <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> told me.</p>
<p>I might be wrong though and this could be wishful thinking.</p>



<a name="187449877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187449877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187449877">(Feb 05 2020 at 12:46)</a>:</h4>
<p>That's why I'm asking <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span> I think it would be good to have a version that Lean is happy with.</p>



<a name="187449927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187449927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187449927">(Feb 05 2020 at 12:47)</a>:</h4>
<p><span class="user-mention" data-user-id="262143">@Ryan Lahfa</span> Is <code>is_absolute_value</code> something that Lean know about? Or is this something that still has to be written?</p>



<a name="187450566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187450566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187450566">(Feb 05 2020 at 12:57)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/data/real/cau_seq.html#is_absolute_value" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/data/real/cau_seq.html#is_absolute_value">https://leanprover-community.github.io/mathlib_docs/data/real/cau_seq.html#is_absolute_value</a></p>



<a name="187450656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187450656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187450656">(Feb 05 2020 at 12:58)</a>:</h4>
<p>thanks</p>



<a name="187450695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187450695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187450695">(Feb 05 2020 at 12:59)</a>:</h4>
<p>It's nice to see you've been able to use padics in mathlib without knowing this file. It proves the API is good.</p>



<a name="187451264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187451264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187451264">(Feb 05 2020 at 13:07)</a>:</h4>
<p>BTW, I'd prefer to see p-adics defined as sequences of digits, maybe using some generic algebraic construction. This way Lean will be able to actually do finite precision computations in p-adics.</p>



<a name="187451823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187451823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187451823">(Feb 05 2020 at 13:15)</a>:</h4>
<p>Then we can prove that they form a <code>complete_space</code> w.r.t. the p-adic norm.</p>



<a name="187451951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187451951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187451951">(Feb 05 2020 at 13:17)</a>:</h4>
<p>All of this needs a ring (probably with some additional properties), a prime ideal, and something equivalent to the quotient (used for computations).</p>



<a name="187486378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187486378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187486378">(Feb 05 2020 at 19:30)</a>:</h4>
<p>The p-adic numbers are an example of a nonarchimedean local field and I'd prefer to see a general theory of these set up.</p>



<a name="187489464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187489464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187489464">(Feb 05 2020 at 20:03)</a>:</h4>
<p>I tried to look for equality of functions but I'm not sure I found something in mathlib, I got overwhelmed by the amount of equiv modules ; I have the feeling that <code>abv \neq trivial_abv</code> is stronger than saying that <code>\forall x \in F, abv x \neq trivial_abv x</code>, but is there a way to not write this?</p>



<a name="187490311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187490311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187490311">(Feb 05 2020 at 20:13)</a>:</h4>
<p>It's not stronger.</p>



<a name="187490805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187490805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187490805">(Feb 05 2020 at 20:19)</a>:</h4>
<p>Yeah one problem my ostrowski formulation I had was my absolute values mapped from $\Q \to \Q$ instead of $\Q \to \R$, I chose this as the usual absolute value function and p-adic valuation for rationals defaults to maps like  this iirc. But really you want the stronger statement that any $\Q \to \R$ is one of $|\cdot |$ or $|\cdot|_p$.</p>



<a name="187490884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187490884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187490884">(Feb 05 2020 at 20:20)</a>:</h4>
<p>So my notion of equivalence was a weird hack where you extend to $\R$ then ask that one be a power of the other.</p>



<a name="187491520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187491520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187491520">(Feb 05 2020 at 20:28)</a>:</h4>
<blockquote>
<p>It's not stronger.</p>
</blockquote>
<p>So <code>abv = trivial_abv</code> is exactly <code>\forall x : some domain, abv x = trivial_abv x</code> (?)</p>



<a name="187491602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187491602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187491602">(Feb 05 2020 at 20:29)</a>:</h4>
<blockquote>
<p>Yeah one problem my ostrowski formulation I had was my absolute values mapped from $\Q \to \Q$ instead of $\Q \to \R$, I chose this as the usual absolute value function and p-adic valuation for rationals defaults to maps like  this iirc. But really you want the stronger statement that any $\Q \to \R$ is one of $|\cdot |$ or $|\cdot|_p$.</p>
</blockquote>
<p>Exact, I've read and thanks to your code, I moved faster than I expected, I learnt a lot about how to do some simple stuff (product of terms, etc.)</p>



<a name="187492685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187492685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187492685">(Feb 05 2020 at 20:41)</a>:</h4>
<p>Yes the principle that functions are equal when their values are is called function extensionality. A tactic to use this is called funext. If you apply this to a goal <code>f=g</code>  you'll get a value <code> x </code> and have to prove <code> f x =g X</code></p>



<a name="187492860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187492860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187492860">(Feb 05 2020 at 20:43)</a>:</h4>
<p>A more complete answer is: for mathematicians, the equivalence is trivial. Because Lean is also used for software verification, this triviality is not an base axiom, but you have it anyway.</p>



<a name="187493667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187493667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187493667">(Feb 05 2020 at 20:51)</a>:</h4>
<p>It's just something that computer scientists make a fuss about for some reason ;-)</p>



<a name="187494358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187494358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187494358">(Feb 05 2020 at 20:59)</a>:</h4>
<p>I agree with the facts it was trivial for mathematicians, and for Lean, it requires some base axiom, my underlying question was: is this axiom there? I have my answer now :)</p>



<a name="187494483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187494483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187494483">(Feb 05 2020 at 21:00)</a>:</h4>
<p>Also forget what Alex wrote about <code>funext</code>, this is a historical accident. This tactic is subsumed by the more general <code>ext</code> tactic.</p>



<a name="187497059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187497059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187497059">(Feb 05 2020 at 21:30)</a>:</h4>
<p>The only time one needs to use funext is in a conv block right?</p>



<a name="187497088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187497088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187497088">(Feb 05 2020 at 21:30)</a>:</h4>
<p>Oh maybe yes. Maybe <code>ext</code> has no <code>conv</code> version.</p>



<a name="187503956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187503956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187503956">(Feb 05 2020 at 22:57)</a>:</h4>
<p>Here's new questions!</p>
<p>I'm trying to figure out how to instantiate some fields and stuff and I often run into "failed to synthesize type class instance for […]", for example, if I try to do <code>#check \Q_[3]</code> it'll fail, I guess I have to prove that 3 is prime but I'm unsure how to inject this information? It seems like <code>apply_instance</code> is what I want but once I'm not sure how to use it.</p>



<a name="187504196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187504196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187504196">(Feb 05 2020 at 23:00)</a>:</h4>
<p>Also, what's the difference between writing <code>\exists p : nat.primes, …</code> and <code>\exists (p), [hp: nat.prime p], …</code> ?</p>



<a name="187504406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187504406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187504406">(Feb 05 2020 at 23:03)</a>:</h4>
<p>In the first case <code>p</code> is a structure with two fields: <code>p.val</code> is a number and <code>p.property</code> says that <code>p.val</code> is prime. In the latter case <code>p</code> is a number and <code>hp</code> says that it is prime.</p>



<a name="187504647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187504647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187504647">(Feb 05 2020 at 23:06)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> Okay, makes sense, thank you!</p>



<a name="187505412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187505412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187505412">(Feb 05 2020 at 23:17)</a>:</h4>
<p>New question, so if I have some absolute value |⋅| and I want to induce some metric_space using it over \Q ; like <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> said earlier, I have to define some <code>rat_with_abv</code> to create a new type and then I can define as an instance of metric_space for example, right? I don't think I can avoid it ; but curious question, is there a technical limitation for why we could not have:</p>
<div class="codehilite"><pre><span></span>def field_with_abv {a: Type*} (abv: a \to a) [normed_field a] [is_absolute_value abv]: normed_field a := [build generally the normed_field using abv over a]
</pre></div>


<p>I'm not exactly sure that a must be a discrete_field, but whatever it has to be.</p>
<p>And this way we could swap absolute values (or norm) for all normed fields I guess (?).</p>



<a name="187505520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187505520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187505520">(Feb 05 2020 at 23:19)</a>:</h4>
<p>I suppose I could use the Cauchy completion by showing that from all absolute values, we can derive some norms?</p>



<a name="187520513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187520513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187520513">(Feb 06 2020 at 05:05)</a>:</h4>
<blockquote>
<p>It's just something that computer scientists make a fuss about for some reason ;-)</p>
</blockquote>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> How many different ways are there to sort a list?</p>



<a name="187524440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187524440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187524440">(Feb 06 2020 at 06:54)</a>:</h4>
<p>Just the one</p>



<a name="187524525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187524525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187524525">(Feb 06 2020 at 06:56)</a>:</h4>
<p>It's called "WLOG the elements are in increasing order"</p>



<a name="187524540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187524540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187524540">(Feb 06 2020 at 06:57)</a>:</h4>
<p>unless of course it's not WLOG, in which case sorting it would be non-canonical.</p>



<a name="187527888"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187527888" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187527888">(Feb 06 2020 at 08:10)</a>:</h4>
<p>Ryan, you don't have to create an instance if you don't want to use it through type class inference. This instance stuff is all about Lean figuring out what you don't write. You always keep the possibility of not asking Lean but telling it.</p>



<a name="187529292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187529292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187529292">(Feb 06 2020 at 08:39)</a>:</h4>
<p>Maybe this discussion is too abstract. Let me write some code:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">topology</span><span class="bp">.</span><span class="n">metric_space</span><span class="bp">.</span><span class="n">basic</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="kn">open</span> <span class="n">is_absolute_value</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span>

<span class="n">def</span> <span class="n">metric_space_of_real_abv</span> <span class="o">(</span><span class="n">abv</span><span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">[</span><span class="n">is_absolute_value</span> <span class="n">abv</span><span class="o">]</span> <span class="o">:</span> <span class="n">metric_space</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">dist</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">abv</span> <span class="err">$</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">,</span>
  <span class="n">dist_self</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="k">show</span> <span class="n">abv</span> <span class="o">(</span><span class="n">x</span><span class="bp">-</span><span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="n">simp</span><span class="o">[</span><span class="n">abv_zero</span> <span class="n">abv</span><span class="o">],</span>
  <span class="n">eq_of_dist_eq_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="n">eq_of_sub_eq_zero</span> <span class="err">$</span> <span class="o">(</span><span class="n">abv_eq_zero</span> <span class="n">abv</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">dist_comm</span> <span class="o">:=</span> <span class="n">abv_sub</span> <span class="n">abv</span><span class="o">,</span>
  <span class="n">dist_triangle</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">,</span> <span class="k">begin</span>
    <span class="n">change</span> <span class="n">abv</span> <span class="o">(</span><span class="n">x</span><span class="bp">-</span><span class="n">z</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">abv</span> <span class="o">(</span><span class="n">x</span><span class="bp">-</span><span class="n">y</span><span class="o">)</span> <span class="bp">+</span> <span class="n">abv</span> <span class="o">(</span><span class="n">y</span><span class="bp">-</span><span class="n">z</span><span class="o">),</span>
    <span class="n">rw</span> <span class="k">show</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">z</span> <span class="bp">=</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">y</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="bp">-</span> <span class="n">z</span><span class="o">),</span> <span class="k">by</span> <span class="n">abel</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">abv_add</span><span class="o">,</span>
  <span class="kn">end</span><span class="o">}</span>

<span class="n">def</span> <span class="n">topology_of_real_abv</span> <span class="o">(</span><span class="n">abv</span><span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">[</span><span class="n">is_absolute_value</span> <span class="n">abv</span><span class="o">]</span> <span class="o">:</span> <span class="n">topological_space</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">metric_space_of_real_abv</span> <span class="n">abv</span><span class="o">)</span><span class="bp">.</span><span class="n">to_uniform_space</span><span class="bp">.</span><span class="n">to_topological_space</span>

<span class="n">def</span> <span class="n">abv_top_eqv</span> <span class="o">(</span><span class="n">abv₁</span> <span class="n">abv₂</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">[</span><span class="n">is_absolute_value</span> <span class="n">abv₁</span><span class="o">]</span> <span class="o">[</span><span class="n">is_absolute_value</span> <span class="n">abv₂</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">topology_of_real_abv</span> <span class="n">abv₁</span> <span class="bp">=</span> <span class="n">topology_of_real_abv</span> <span class="n">abv₂</span>
</pre></div>



<a name="187529309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187529309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187529309">(Feb 06 2020 at 08:39)</a>:</h4>
<p>Is this what you want? This is still going toward a very weak version of the conclusion of Ostrowski.</p>



<a name="187546822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187546822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187546822">(Feb 06 2020 at 13:21)</a>:</h4>
<p>It makes a lot of sense now, regarding the instance. Thank you!</p>



<a name="187546921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187546921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187546921">(Feb 06 2020 at 13:22)</a>:</h4>
<blockquote>
<p>Is this what you want? This is still going toward a very weak version of the conclusion of Ostrowski.</p>
</blockquote>
<p>What's the strong version of Ostrowski? IMHO, I was under the assumption it was a statement of the form: for all absolute values over Q, either it is equivalent to the real absolute value, or there is some prime p such that the absolute value is equivalent to the padic one.</p>
<p>It appears to me that I need the <code>metric_space_of_real_abv</code> to have:</p>
<div class="codehilite"><pre><span></span>theorem rat_abs_val_p_adic_or_real (abv: ℚ → ℚ)
    [habv: is_absolute_value abv]
    (hnontriv: abv ≠ trivial_abs):
    (metric_space_eq
        (metric_rat_with_abv abv)
        (rat.metric_space))
    ∨
    (∃ (p) [hp: nat.prime p],
        (metric_space_eq
            (metric_rat_with_abv abv)
            (padic.metric_space p)))
</pre></div>


<p>Something like this.</p>



<a name="187546948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187546948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187546948">(Feb 06 2020 at 13:23)</a>:</h4>
<p>But sure, that might be better to just prove that there is directly some relation between the absolute values themselves.</p>



<a name="187549864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187549864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187549864">(Feb 06 2020 at 14:02)</a>:</h4>
<p>I think the stronger form would be saying that the two absolute values differ by a power</p>



<a name="187550067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187550067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187550067">(Feb 06 2020 at 14:04)</a>:</h4>
<blockquote>
<p>I think the stronger form would be saying that the two absolute values differ by a power</p>
</blockquote>
<p>Ah ; but I was going to derive the weak form (same topology) by the strong form (absolute values differ by a power).</p>
<p>So yes I agree that it might be better to expose the stronger form as a theorem and derive the weak form through a lemma.</p>



<a name="187550371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187550371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187550371">(Feb 06 2020 at 14:08)</a>:</h4>
<p>Also, it's good to see that you have a Lean statement now. Does it already typecheck?</p>



<a name="187550451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187550451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187550451">(Feb 06 2020 at 14:08)</a>:</h4>
<p>Could you post a self-contained piece of code that we can copy-paste (including the necessary <code>import</code> and <code>variable</code> statements etc...)</p>



<a name="187568814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187568814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187568814">(Feb 06 2020 at 17:23)</a>:</h4>
<blockquote>
<p>Could you post a self-contained piece of code that we can copy-paste (including the necessary <code>import</code> and <code>variable</code> statements etc...)</p>
</blockquote>
<p>For now, it's still somewhat a scratch file with a lot of code / sorry, but next time I post something, I'll try to give a minimal example, sure.</p>



<a name="187568873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187568873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187568873">(Feb 06 2020 at 17:24)</a>:</h4>
<blockquote>
<p>Also, it's good to see that you have a Lean statement now. Does it already typecheck?</p>
</blockquote>
<p>I did a lot of changes and it does not typecheck anymore :D</p>



<a name="187570599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187570599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187570599">(Feb 06 2020 at 17:42)</a>:</h4>
<p>New question, when I have, let's say I have:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">prime</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">cau_seq</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">apply</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">apply_fun</span>

<span class="kn">section</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">real</span>
<span class="kn">open</span> <span class="n">list</span> <span class="n">option</span>
<span class="kn">open</span> <span class="n">nat</span>

<span class="c1">-- absolute values are monoid homemorphisms.</span>
<span class="n">def</span> <span class="n">hom_of_abv</span> <span class="o">{</span><span class="n">α</span><span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">hlifield</span><span class="o">:</span> <span class="n">linear_ordered_field</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">abv</span><span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">[</span><span class="n">habv</span><span class="o">:</span> <span class="n">is_absolute_value</span> <span class="n">abv</span><span class="o">]:</span> <span class="n">monoid_hom</span> <span class="n">α</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="o">{</span>
    <span class="n">to_fun</span> <span class="o">:=</span> <span class="n">abv</span><span class="o">,</span>
    <span class="n">map_one&#39;</span> <span class="o">:=</span> <span class="n">is_absolute_value</span><span class="bp">.</span><span class="n">abv_one</span> <span class="n">abv</span><span class="o">,</span>
    <span class="n">map_mul&#39;</span> <span class="o">:=</span> <span class="n">is_absolute_value</span><span class="bp">.</span><span class="n">abv_mul</span> <span class="n">abv</span>
<span class="o">}</span>


<span class="kn">example</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span><span class="o">:</span> <span class="n">ℚ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">[</span><span class="n">is_absolute_value</span> <span class="n">f</span><span class="o">]:</span>
    <span class="n">list</span><span class="bp">.</span><span class="n">prod</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">hom_of_abv</span> <span class="n">f</span><span class="o">)</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">factors</span> <span class="n">z</span><span class="o">)))</span> <span class="bp">=</span> <span class="n">f</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">prod</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">factors</span> <span class="n">z</span><span class="o">)))</span> <span class="o">:=</span>
<span class="k">begin</span>
    <span class="n">exact</span> <span class="n">prod_hom</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">factors</span> <span class="n">z</span><span class="o">))</span> <span class="o">(</span><span class="n">hom_of_abv</span> <span class="n">f</span><span class="o">)</span>
<span class="kn">end</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">z</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span><span class="o">:</span> <span class="n">ℚ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">[</span><span class="n">is_absolute_value</span> <span class="n">f</span><span class="o">]:</span> <span class="n">prod</span> <span class="o">(</span><span class="n">map</span> <span class="o">(</span><span class="n">f</span> <span class="err">∘</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">))</span> <span class="o">(</span><span class="n">factors</span> <span class="n">z</span><span class="o">))</span> <span class="bp">=</span> <span class="n">f</span> <span class="err">↑</span><span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">prod</span> <span class="o">(</span><span class="n">factors</span> <span class="n">z</span><span class="o">))</span> <span class="o">:=</span>
    <span class="k">begin</span>
    <span class="n">exact</span> <span class="n">prod_hom</span> <span class="o">(</span><span class="n">factors</span> <span class="n">z</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="err">∘</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span><span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">))</span>
<span class="kn">end</span>

<span class="kn">end</span>
</pre></div>


<p>The second example is failing because f is not an unbundled monoid homomorphism (under the assumption that there is something which implements is_monoid_hom for f \circ g), but while reading the documentation, I see that those are deprecated and being slowed removed from mathlib.</p>
<p>Does that mean I have to use bundled monoid homomorphism?</p>
<p>In this example, I can trivially have a <code>hom_of_abv</code> which gives me a <code>monoid_hom Q Q</code> (or whatever) and then, I can use prod_hom on it and have a close result except that it has this upper arrow which I suppose says this is a bundled homomorphism.</p>
<p>But, can I lift those to rewrite the unbundled version of the homomorphism?</p>
<p>Better, I'd like to prod_hom with (f \circ (coe : N → Q)) but unsure how that's feasible w/o having something which takes (f, g), bundle the composition. How does that scale to f_1 \circ … \circ f_n ? It does not sound general enough…</p>



<a name="187572034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187572034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187572034">(Feb 06 2020 at 17:58)</a>:</h4>
<p>Tip: if you write</p>
<div class="codehilite"><pre><span></span>```lean
code here
```
</pre></div>


<p>then you even get syntax highlighting</p>



<a name="187572567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187572567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187572567">(Feb 06 2020 at 18:04)</a>:</h4>
<p>Thank you <span class="user-mention" data-user-id="112680">@Johan Commelin</span> — now I add regarding my last question that I know I could merge the map map using list.map_map,</p>
<p>but then, I'm stuck with this coe_fn in front of all my abv functions ; I'm not super strong with the coercion thing, I understand most of it, but I'm not sure how I can lift it in the context? I tried: <code>simp</code>, <code>push_cast</code>, <code>norm_cast</code> and all of them failed.</p>



<a name="187572748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187572748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187572748">(Feb 06 2020 at 18:07)</a>:</h4>
<p>If they fail, that might also be because of missing simp-lemmas in the library...</p>



<a name="187572863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187572863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187572863">(Feb 06 2020 at 18:08)</a>:</h4>
<p><span class="user-mention" data-user-id="262143">@Ryan Lahfa</span> To fix the second example, you should add an <code>instance</code> that shows that <code>is_absolute_value f</code> implies <code>is_monoid_hom f</code>.</p>



<a name="187572874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187572874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187572874">(Feb 06 2020 at 18:08)</a>:</h4>
<p>Apparently that one is missing</p>



<a name="187572906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187572906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187572906">(Feb 06 2020 at 18:09)</a>:</h4>
<blockquote>
<p>If they fail, that might also be because of missing simp-lemmas in the library...</p>
</blockquote>
<p>AFAIK, according to this, should not this be enough: <a href="https://leanprover-community.github.io/mathlib_docs/algebra/group/hom.html#monoid_hom.has_coe_to_fun" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/algebra/group/hom.html#monoid_hom.has_coe_to_fun">https://leanprover-community.github.io/mathlib_docs/algebra/group/hom.html#monoid_hom.has_coe_to_fun</a> ?</p>



<a name="187572934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187572934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187572934">(Feb 06 2020 at 18:09)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="262143">Ryan Lahfa</span> To fix the second example, you should add an <code>instance</code> that shows that <code>is_absolute_value f</code> implies <code>is_monoid_hom f</code>.</p>
</blockquote>
<p>Sure, I could do this, but the docs say it is deprecated to use <code>is_monoid_hom f</code> so I'm not sure what's the situation, I prefer to avoid introducing stuff that will have to be rewritten :P</p>



<a name="187573706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187573706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187573706">(Feb 06 2020 at 18:19)</a>:</h4>
<p>Well... that means that absolute values should be refactored, and replaced with bundled versions...</p>



<a name="187573751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187573751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187573751">(Feb 06 2020 at 18:19)</a>:</h4>
<p>That's a lot of work for a first PR, so I wouldn't advice it</p>



<a name="187574442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187574442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187574442">(Feb 06 2020 at 18:26)</a>:</h4>
<p>unbundled homs are deprecated, but that really only means that we are starting to use them in new stuff. Because bundled homs are not entirely supported yet, we can't just delete the unbundled homs, and some proofs will require both</p>



<a name="187574954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187574954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187574954">(Feb 06 2020 at 18:31)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Ryan is concerned about adding new instances of <code>is_monoid_hom</code> to mathlib in a PR on Ostrowski.</p>



<a name="187575033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187575033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187575033">(Feb 06 2020 at 18:32)</a>:</h4>
<p>I think adding such instances is indeed "discouraged". But we might also make some exceptions.</p>



<a name="187575043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187575043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187575043">(Feb 06 2020 at 18:32)</a>:</h4>
<p>That seems fine to me, especially if the bundled version is included as well</p>



<a name="187575094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187575094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187575094">(Feb 06 2020 at 18:32)</a>:</h4>
<p>How would that look like?</p>



<a name="187575139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187575139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187575139">(Feb 06 2020 at 18:33)</a>:</h4>
<p>We have unbundled absolute values. Those are monoid homs, but Lean doesn't know this.</p>



<a name="187575166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187575166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187575166">(Feb 06 2020 at 18:33)</a>:</h4>
<p>I don't expect such a PR to introduce bundled absolute values.</p>



<a name="187575298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187575298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187575298">(Feb 06 2020 at 18:34)</a>:</h4>
<p>Actually, it makes a lot of sense to have bundled absolute values for ostrowski, since it is about characterizing this space</p>



<a name="187575418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187575418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187575418">(Feb 06 2020 at 18:36)</a>:</h4>
<p>you can define an equivalence relation on the type <code>absolute_value</code> which is "differs by a power", and then define the real and p-adic and trivial absolute values, and then it is easy to state the theorem</p>



<a name="187576333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187576333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187576333">(Feb 06 2020 at 18:46)</a>:</h4>
<p>That makes sense. (And then later derive an unbundled statement? In case someone actually wants to apply Ostrowski at some point? Although by that time we'll hopefully want and have a version for number fields.)</p>



<a name="187576469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187576469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187576469">(Feb 06 2020 at 18:48)</a>:</h4>
<p>Alright, it makes sense, so I should wrap all abv into bundled hom and work with them, this I can do.</p>
<p>At some point, statement about bundled hom abv can be made into statement about unbundled abv; this I don't see how to do, but I can believe that someone will figure out, right?</p>



<a name="187576566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187576566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187576566">(Feb 06 2020 at 18:49)</a>:</h4>
<p>Sure, that last step is not so hard: no maths involved, just shuffling some data around in Lean.</p>



<a name="187576578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187576578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187576578">(Feb 06 2020 at 18:49)</a>:</h4>
<blockquote>
<p>you can define an equivalence relation on the type <code>absolute_value</code> which is "differs by a power", and then define the real and p-adic and trivial absolute values, and then it is easy to state the theorem</p>
</blockquote>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span> already done it in its version of Ostrowski and I'm reusing this. The only thing is that we have not defined this equiv relation on the <code>monoid_hom Q R</code> which implements <code>is_absolute_value</code> but rather on <code>Q → R</code> which implements <code>is_absolute_value</code>, right?</p>



<a name="187576741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187576741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187576741">(Feb 06 2020 at 18:51)</a>:</h4>
<p>For an idea of how to define <code>absolute_value</code>, see: <a href="https://github.com/leanprover-community/lean-perfectoid-spaces/blob/master/src/valuation/basic.lean#L58" target="_blank" title="https://github.com/leanprover-community/lean-perfectoid-spaces/blob/master/src/valuation/basic.lean#L58">https://github.com/leanprover-community/lean-perfectoid-spaces/blob/master/src/valuation/basic.lean#L58</a></p>



<a name="187576791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187576791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187576791">(Feb 06 2020 at 18:52)</a>:</h4>
<p>But do we agree this require a change from:</p>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">is_absolute_value</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">discrete_linear_ordered_field</span> <span class="n">α</span><span class="o">]</span>
  <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">abv_nonneg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span>
<span class="o">(</span><span class="n">abv_eq_zero</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span><span class="o">},</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">abv_add</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">f</span> <span class="n">y</span><span class="o">)</span>
<span class="o">(</span><span class="n">abv_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">y</span><span class="o">)</span>
</pre></div>


<p>to</p>
<div class="codehilite"><pre><span></span><span class="n">class</span> <span class="n">is_absolute_value</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">discrete_linear_ordered_field</span> <span class="n">α</span><span class="o">]</span>
  <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">monoid_hom</span> <span class="n">β</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">abv_nonneg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">≤</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span>
<span class="o">(</span><span class="n">abv_eq_zero</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span><span class="o">},</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
<span class="o">(</span><span class="n">abv_add</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">f</span> <span class="n">y</span><span class="o">)</span>
</pre></div>


<p>I guess <code>abv_mul</code> is now trivial due to <code>monoid_hom.map_mul'</code>, so not required to implement it. It also looks better IMHO, because it makes sense to say that an absolute value is a monoid homomorphism which implements additional stuff.<br>
Also, <code>abv_one</code> becomes trivial too.</p>



<a name="187576913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187576913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187576913">(Feb 06 2020 at 18:53)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Shouldn't we change the <code>is_absolute_value</code> definition coming from Cauchy completion?</p>



<a name="187576997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187576997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187576997">(Feb 06 2020 at 18:54)</a>:</h4>
<p>But that also requires changes in the padic.padic_norm definition and the real absolute value definition (right?)</p>



<a name="187577622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187577622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187577622">(Feb 06 2020 at 19:01)</a>:</h4>
<p>I understand your confusion. But you should ignore all the existing stuff (for now).</p>



<a name="187577650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187577650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187577650">(Feb 06 2020 at 19:01)</a>:</h4>
<p>In the end, we'll have both bundled and unbundled versions. And Mario says that's ok.</p>



<a name="187577663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187577663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187577663">(Feb 06 2020 at 19:01)</a>:</h4>
<p>Don't worry about refactoring things.</p>



<a name="187577721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187577721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187577721">(Feb 06 2020 at 19:02)</a>:</h4>
<p>Just introduce a new thing <code>absolute_value</code> that extends <code>mul_hom</code>, like in the example I linked to.</p>



<a name="187577752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187577752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187577752">(Feb 06 2020 at 19:02)</a>:</h4>
<p>After that, define some coercions and prove some trivial simp-lemmas, like we did for valuations.</p>



<a name="187577809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187577809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187577809">(Feb 06 2020 at 19:03)</a>:</h4>
<p>After that, define some examples, like <code>real.abs_val</code> and <code>padic.abs_val</code>, and here you will reuse the unbundled versions. Defining these examples is not hard.</p>



<a name="187577820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187577820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187577820">(Feb 06 2020 at 19:03)</a>:</h4>
<p>Also, define an equivalence relation.</p>



<a name="187577837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187577837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187577837">(Feb 06 2020 at 19:03)</a>:</h4>
<p>And then you are good to go to get a nice statement for Ostrowski.</p>



<a name="187578237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187578237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187578237">(Feb 06 2020 at 19:08)</a>:</h4>
<p>Alright, that works for me :)</p>



<a name="187580028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187580028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187580028">(Feb 06 2020 at 19:28)</a>:</h4>
<p>We don't need to change <code>is_absolute_value</code> itself, but <code>absolute_value := {abv // is_absolute_value abv}</code> is easy enough to define</p>



<a name="187580149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187580149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187580149">(Feb 06 2020 at 19:29)</a>:</h4>
<p>I would prefer that the monoid hom thing be proven rather than assumed (it's not immediate from the definition that <code>f 1 = 1</code>, for example, and we wouldn't want to require that to be proven too)</p>



<a name="187580308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187580308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187580308">(Feb 06 2020 at 19:30)</a>:</h4>
<p>The usage of <code>is_absolute_value</code> in the definition of <code>real</code> is somewhat foundational, so it's okay if it's not completely in line with conventions</p>



<a name="187580693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187580693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187580693">(Feb 06 2020 at 19:35)</a>:</h4>
<blockquote>
<p>I would prefer that the monoid hom thing be proven rather than assumed (it's not immediate from the definition that <code>f 1 = 1</code>, for example, and we wouldn't want to require that to be proven too)</p>
</blockquote>
<p>Do you mean to prove that absolute_value are monoid hom by proving that abv 1 = 1?</p>
<p>Under which assumptions should we define absolute_value? Like for real, discrete linear ordered fields?</p>



<a name="187581256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187581256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187581256">(Feb 06 2020 at 19:41)</a>:</h4>
<p>The reason <code>is_absolute_value</code> in <code>cau_seq</code> requires a <code>discrete_linear_ordered_field</code> is because I needed it on Q and R</p>



<a name="187581298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187581298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187581298">(Feb 06 2020 at 19:41)</a>:</h4>
<p>The statement only needs an ordered ring afaik</p>



<a name="187581423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187581423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187581423">(Feb 06 2020 at 19:43)</a>:</h4>
<p>But I think Ostrowski works in the context of a real-valued absolute value</p>



<a name="187585793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187585793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187585793">(Feb 06 2020 at 20:32)</a>:</h4>
<blockquote>
<p>But I think Ostrowski works in the context of a real-valued absolute value</p>
</blockquote>
<p>We can always specialize it afterwards, but I guess we want a general <code>is_absolute_value</code> right?</p>



<a name="187586049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187586049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187586049">(Feb 06 2020 at 20:35)</a>:</h4>
<p>New questions:<br>
I'm trying to do some real power algebra, and I have a real in my exponent, so I'm trying to find some theorems to manipulate them, I expected most of the theorems to be there or in group power:</p>
<p><a href="https://leanprover-community.github.io/mathlib_docs/algebra/field_power.html" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/algebra/field_power.html">https://leanprover-community.github.io/mathlib_docs/algebra/field_power.html</a></p>
<p>But I'm lacking something akin to <code>(a ^ n) ^ m = a ^ (n*m)</code> for <code>m n : R</code>, which would be some <code>fpow_mul</code> I guess.<br>
At the same time, I guess that real pow are more analysis than true algebra, making sense for why those theorems would not be in field power.</p>
<p>I looked in analysis, found nothing. I tried the custom search but it is not super reliable. I guess I could do some PR or something to improve the search and replacing it by some full text search using JavaScript. This is a parallel idea but it would be awesome to have a Hoogle-like search for Lean, just give it some types and it'll give you what you want, this could be a project I would be super proficient in I think.</p>



<a name="187586202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187586202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187586202">(Feb 06 2020 at 20:37)</a>:</h4>
<p><code>fpow_mul</code> would be for powers by integers</p>



<a name="187586219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187586219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187586219">(Feb 06 2020 at 20:37)</a>:</h4>
<p>There is <code>rpow.*</code> I think</p>



<a name="187586227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187586227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187586227">(Feb 06 2020 at 20:37)</a>:</h4>
<p>Or was it <code>real_pow.*</code>?</p>



<a name="187586796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187586796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187586796">(Feb 06 2020 at 20:44)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> I searched for <code>rpow</code> and <code>real_pow</code> and found nothing :/</p>



<a name="187587136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187587136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187587136">(Feb 06 2020 at 20:48)</a>:</h4>
<p>real.rpow</p>



<a name="187587180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187587180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187587180">(Feb 06 2020 at 20:48)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/analysis/complex/exponential.html#real.rpow" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/analysis/complex/exponential.html#real.rpow">https://leanprover-community.github.io/mathlib_docs/analysis/complex/exponential.html#real.rpow</a> Indeed… I was supposing that complex had nothing to do with what I wanted.</p>



<a name="187587235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187587235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187587235">(Feb 06 2020 at 20:49)</a>:</h4>
<p>I found it by running <code>mk_all.sh</code> and then inside <code>all.lean</code>:</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">rpo</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">suggest</span><span class="o">,</span>
  <span class="n">sorry</span>
<span class="kn">end</span>
</pre></div>



<a name="187587921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187587921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187587921">(Feb 06 2020 at 20:57)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> Thank you for the tip!</p>



<a name="187588085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187588085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187588085">(Feb 06 2020 at 20:59)</a>:</h4>
<p><a href="/user_uploads/3121/pcGeOZ1SrIVGBHZpoZyvaV1W/ostrowski-ext.lean" target="_blank" title="ostrowski-ext.lean">ostrowski-ext.lean</a> <br>
I have a more difficult question, if you load the file I provide here.<br>
And go line 312, for some reason, I cannot close the goal "prime p" by using a hypothesis which is "prime p", I guess it has to do with implicit contexts, but unsure how to debug, nor solve this. I guess I'm too newbie in coe stuff.</p>



<a name="187590099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187590099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187590099">(Feb 06 2020 at 21:21)</a>:</h4>
<p>Hmm, I currently don't have Lean available. what happens if you <code>convert this</code>?</p>



<a name="187591394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187591394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187591394">(Feb 06 2020 at 21:36)</a>:</h4>
<p>My guess: <code>_root_.prime</code> and <code>nat.prime</code> are fighting over this proof.</p>



<a name="187591801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187591801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187591801">(Feb 06 2020 at 21:42)</a>:</h4>
<blockquote>
<p>Hmm, I currently don't have Lean available. what happens if you <code>convert this</code>?</p>
</blockquote>
<p>it becomes <code> prime p = prime p</code> and <code>refl</code> does not end it.</p>



<a name="187591806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187591806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187591806">(Feb 06 2020 at 21:42)</a>:</h4>
<blockquote>
<p>My guess: <code>_root_.prime</code> and <code>nat.prime</code> are fighting over this proof.</p>
</blockquote>
<p>What's the difference?</p>



<a name="187591997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187591997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187591997">(Feb 06 2020 at 21:45)</a>:</h4>
<p>You're right, I think it's that. When I replaced <code>apply prime.ne_zero</code> by <code>apply nat.prime.ne_zero</code> and <code>nat.mem_factors</code> it worked!</p>



<a name="187592253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187592253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187592253">(Feb 06 2020 at 21:48)</a>:</h4>
<p>Does anyone know why we still have <code>nat.prime</code>?</p>



<a name="187592559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187592559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187592559">(Feb 06 2020 at 21:53)</a>:</h4>
<p>I'm not sure I like replacing the obvious definition with a complicated one</p>



<a name="187592621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187592621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187592621">(Feb 06 2020 at 21:54)</a>:</h4>
<blockquote>
<p>I'm not sure I like replacing the obvious definition with a complicated one</p>
</blockquote>
<p>Which definition?</p>



<a name="187592633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187592633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187592633">(Feb 06 2020 at 21:54)</a>:</h4>
<p>the abstract algebra definition</p>



<a name="187592641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187592641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187592641">(Feb 06 2020 at 21:54)</a>:</h4>
<p>that's <code>_root_.prime</code></p>



<a name="187592682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187592682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187592682">(Feb 06 2020 at 21:55)</a>:</h4>
<p>You can still keep the same API for nat.</p>



<a name="187592702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187592702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187592702">(Feb 06 2020 at 21:55)</a>:</h4>
<p>we should at least make sure that the definition of <code>_root_.prime</code> does not have high dependencies</p>



<a name="187592790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187592790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187592790">(Feb 06 2020 at 21:56)</a>:</h4>
<p>and move the proof of (the equivalent of) <code>prime n &lt;-&gt; nat.prime n</code> as early as possible</p>



<a name="187593127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187593127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187593127">(Feb 06 2020 at 22:00)</a>:</h4>
<p>Ryan, if you really need this, the lemma is <code>nat.prime_iff_prime</code> in <code>algebra.gcd_domain</code></p>



<a name="187593816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187593816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187593816">(Feb 06 2020 at 22:08)</a>:</h4>
<p>I can do just fine by being explicit and I never manipulate abstract prime concepts, so I'm fine with explicit <code>nat.prime</code> everywhere! Thank you :)</p>



<a name="187598721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187598721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187598721">(Feb 06 2020 at 23:15)</a>:</h4>
<p>I'm continuing my work on power manipulation and I am trying the abv_nonneg property of my <code>real_padic_norm</code>, so here is an example which is perfectly working:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">prime</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">cau_seq</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">complex</span><span class="bp">.</span><span class="n">exponential</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">apply</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">apply_fun</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">padics</span>

<span class="kn">section</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">real</span>
<span class="kn">open</span> <span class="n">list</span> <span class="n">option</span>
<span class="kn">open</span> <span class="n">nat</span>

<span class="n">def</span> <span class="n">real_padic_norm</span> <span class="o">(</span><span class="n">p</span><span class="o">:</span> <span class="bp">ℕ</span><span class="o">):</span> <span class="n">ℚ</span> <span class="bp">→</span> <span class="n">ℝ</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">,</span> <span class="n">real</span><span class="bp">.</span><span class="n">of_rat</span> <span class="o">(</span><span class="n">padic_norm</span> <span class="n">p</span> <span class="n">x</span><span class="o">)</span>

<span class="kn">instance</span> <span class="o">(</span><span class="n">p</span><span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">[</span><span class="n">hp</span><span class="o">:</span> <span class="n">nat</span><span class="bp">.</span><span class="n">prime</span> <span class="n">p</span><span class="o">]:</span> <span class="n">is_absolute_value</span> <span class="o">(</span><span class="n">real_padic_norm</span> <span class="n">p</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span>
    <span class="n">abv_nonneg</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>
    <span class="n">abv_eq_zero</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>
    <span class="n">abv_add</span> <span class="o">:=</span> <span class="n">sorry</span><span class="o">,</span>
    <span class="n">abv_mul</span> <span class="o">:=</span> <span class="n">sorry</span>
<span class="o">}</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">p</span><span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">[</span><span class="n">hp</span><span class="o">:</span> <span class="n">nat</span><span class="bp">.</span><span class="n">prime</span> <span class="n">p</span><span class="o">]:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">,</span> <span class="bp">∀</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">,</span> <span class="o">((</span><span class="n">real_padic_norm</span> <span class="n">p</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="o">(</span><span class="n">y</span> <span class="bp">*</span> <span class="n">z</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(((</span><span class="n">real_padic_norm</span> <span class="n">p</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span> <span class="err">^</span> <span class="n">y</span><span class="o">)</span> <span class="err">^</span> <span class="n">z</span> <span class="o">:=</span> <span class="k">begin</span>
    <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">real</span><span class="bp">.</span><span class="n">rpow_mul</span> <span class="o">(</span><span class="n">is_absolute_value</span><span class="bp">.</span><span class="n">abv_nonneg</span> <span class="o">(</span><span class="n">real_padic_norm</span> <span class="n">p</span><span class="o">)</span> <span class="bp">_</span><span class="o">),</span>
<span class="kn">end</span>

<span class="kn">end</span>
</pre></div>


<p>But when I do more or less the same in the attached file, line 394, excerpt:</p>
<div class="codehilite"><pre><span></span>      <span class="n">conv_rhs</span> <span class="n">at</span> <span class="n">this</span> <span class="o">{</span>
          <span class="n">congr</span><span class="o">,</span> <span class="n">skip</span><span class="o">,</span>
          <span class="n">rw</span> <span class="n">real</span><span class="bp">.</span><span class="n">rpow_mul</span> <span class="o">(</span><span class="n">is_absolute_value</span><span class="bp">.</span><span class="n">abv_nonneg</span> <span class="o">(</span><span class="n">real_padic_norm</span> <span class="n">p</span><span class="o">)</span> <span class="bp">_</span><span class="o">),</span>
      <span class="o">},</span>
</pre></div>


<p>It fails to synthesize type classes and fails, unsure what's the difference with the minimal case below and this one. <a href="/user_uploads/3121/s0F5mXZfwujwMfax7PXImB65/ostrowski-ext.lean" target="_blank" title="ostrowski-ext.lean">ostrowski-ext.lean</a></p>



<a name="187602214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187602214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187602214">(Feb 07 2020 at 00:10)</a>:</h4>
<p>Also, is there any way to solve this kind of problems:</p>
<div class="codehilite"><pre><span></span>type mismatch at application
  is_unit_int.mp a
term
  a
has type
  @is_unit ℤ
    (@ring.to_monoid ℤ
       (@domain.to_ring ℤ (@integral_domain.to_domain ℤ (@principal_ideal_domain.to_integral_domain ℤ _inst))))
    x_2
but is expected to have type
  @is_unit ℤ int.monoid x_2
state:
abv : ℚ → ℝ,
habv : is_absolute_value abv,
hnontriv : abv ≠ trivial_abv,
B : ℚ,
int_lt_B : ∀ (z : ℕ), abv ↑z ≤ ↑B,
all_nat_le_one : ∀ (z : ℕ), abv ↑z ≤ 1,
all_int_le_one : ∀ (z : ℤ), abv ↑z ≤ 1,
z : ℕ+,
hz : abv ↑z &lt; 1,
p : ℕ,
p_fact : p ∈ factors ↑z,
abv_p_lt_one : abv ↑p &lt; 1,
this : ∀ (q : ℕ), coprime p q → abv ↑q = 1,
hp : prime p,
α : ℝ := abv ↑p,
this : 0 &lt; -(real.log α / real.log ↑p),
x : ℚ,
x_1 : ℤ,
_inst : principal_ideal_domain ℤ,
_inst_1 : unique_factorization_domain ℤ,
x_2 : ℤ,
a : is_unit x_2
⊢ abv ↑x_2 = real_padic_norm p ↑x_2 ^ -(real.log α / real.log ↑p)
</pre></div>


<p>More difficult, I guess, I see that <code>is_unit_int</code> provides <code>int.nat_abs x_2 = 1</code>, but this notion of absolute value is incompatible with absolute values in general I suppose.</p>
<p>Knowing that <code>int.nat_abs x_2 = 1</code> do not give me <code>abv (coe x_2) = int.nat_abs</code> in general AFAIK. So I guess I have to work more to interface <code>nat_abs</code> with absolute values.</p>



<a name="187716895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187716895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187716895">(Feb 08 2020 at 13:23)</a>:</h4>
<p>For your first question, first a side comment. In the attachment you have <code>by infer_instance</code> and <code>infer_instance</code> isn't a tactic -- you would want to put <code>by apply_instance</code> or <code>infer_instance</code>. Another side comment is that this proof is gigantic and you might seriously want to consider breaking it up into smaller pieces if possible.</p>
<p>The reason that <code>rw real.rpow_mul (is_absolute_value.abv_nonneg (real_padic_norm p) _)</code> is failing is that type class inference can't find an instance of <code>is_absolute_value (real_padic_norm p)</code>. The reason it won't use the instance on line 184 is that this only applies when type class inference can find an instance of <code>nat.prime p</code> and it seems to me that typeclass inference can't find an instance of that. If I insert <code>haveI : nat.prime p := by apply_instance,</code> in line 392 of your attached file, it fails. Conversely, if I write <code>haveI : nat.prime p := sorry</code> on line 392 then things work again -- although it takes a few seconds on my machine to do anything after any line is changed, and this is I guess because the proof is so long.</p>



<a name="187717202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187717202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187717202">(Feb 08 2020 at 13:32)</a>:</h4>
<p>For your second question, I guess I need more context. It seems to me that <code>a</code> is a proof that <code>x_2</code> is a unit wrt one monoid structure on the integers, and you want it to be a proof that <code>x_2</code> is a unit wrt another one. If these two monoid structures are definitionally equal then Lean would not be complaining. I tried to reproduce what you did but I can't:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">padics</span><span class="bp">.</span><span class="n">padic_norm</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">principal_ideal_domain</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">cau_seq</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">complex</span><span class="bp">.</span><span class="n">exponential</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">apply</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">apply_fun</span>

<span class="kn">instance</span> <span class="n">I</span> <span class="o">:</span> <span class="n">principal_ideal_domain</span> <span class="bp">ℤ</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">def</span> <span class="n">M1</span> <span class="o">:</span> <span class="n">monoid</span> <span class="bp">ℤ</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">def</span> <span class="n">M2</span> <span class="o">:</span> <span class="n">monoid</span> <span class="bp">ℤ</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring</span><span class="bp">.</span><span class="n">to_monoid</span> <span class="bp">ℤ</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">domain</span><span class="bp">.</span><span class="n">to_ring</span> <span class="bp">ℤ</span> <span class="o">(</span><span class="bp">@</span><span class="n">integral_domain</span><span class="bp">.</span><span class="n">to_domain</span> <span class="bp">ℤ</span> <span class="o">(</span><span class="bp">@</span><span class="n">principal_ideal_domain</span><span class="bp">.</span><span class="n">to_integral_domain</span> <span class="bp">ℤ</span> <span class="n">I</span><span class="o">))))</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">M1</span> <span class="bp">=</span> <span class="n">M2</span> <span class="o">:=</span> <span class="n">rfl</span>
</pre></div>


<p>So I am totally confused by this one. Did you write <code>[principal_ideal_domain ℤ]</code> at some point? This would be bad because it means "let the integers have the structure of a principal ideal domain in a way which I am not going to tell you anything about, and in particular the underlying addition and multiplication might be completely random".</p>



<a name="187717208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187717208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187717208">(Feb 08 2020 at 13:32)</a>:</h4>
<p>You seem to have a diamond and there should be no diamonds in mathlib.</p>



<a name="187717772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187717772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187717772">(Feb 08 2020 at 13:52)</a>:</h4>
<blockquote>
<p>For your first question, first a side comment. In the attachment you have <code>by infer_instance</code> and <code>infer_instance</code> isn't a tactic -- you would want to put <code>by apply_instance</code> or <code>infer_instance</code>. Another side comment is that this proof is gigantic and you might seriously want to consider breaking it up into smaller pieces if possible.</p>
<p>The reason that <code>rw real.rpow_mul (is_absolute_value.abv_nonneg (real_padic_norm p) _)</code> is failing is that type class inference can't find an instance of <code>is_absolute_value (real_padic_norm p)</code>. The reason it won't use the instance on line 184 is that this only applies when type class inference can find an instance of <code>nat.prime p</code> and it seems to me that typeclass inference can't find an instance of that. If I insert <code>haveI : nat.prime p := by apply_instance,</code> in line 392 of your attached file, it fails. Conversely, if I write <code>haveI : nat.prime p := sorry</code> on line 392 then things work again -- although it takes a few seconds on my machine to do anything after any line is changed, and this is I guess because the proof is so long.</p>
</blockquote>
<p>Thank you for looking for a so long time, I totally agree on the fact that the proof is too big and I will refactor it soon.</p>
<p>It makes a lot more sense to me now.</p>



<a name="187717783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187717783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187717783">(Feb 08 2020 at 13:53)</a>:</h4>
<blockquote>
<p>For your second question, I guess I need more context. It seems to me that <code>a</code> is a proof that <code>x_2</code> is a unit wrt one monoid structure on the integers, and you want it to be a proof that <code>x_2</code> is a unit wrt another one. If these two monoid structures are definitionally equal then Lean would not be complaining. I tried to reproduce what you did but I can't:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">padics</span><span class="bp">.</span><span class="n">padic_norm</span>
<span class="kn">import</span> <span class="n">ring_theory</span><span class="bp">.</span><span class="n">principal_ideal_domain</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">cau_seq</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">complex</span><span class="bp">.</span><span class="n">exponential</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">apply</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">apply_fun</span>

<span class="kn">instance</span> <span class="n">I</span> <span class="o">:</span> <span class="n">principal_ideal_domain</span> <span class="bp">ℤ</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">def</span> <span class="n">M1</span> <span class="o">:</span> <span class="n">monoid</span> <span class="bp">ℤ</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">apply_instance</span>
<span class="n">def</span> <span class="n">M2</span> <span class="o">:</span> <span class="n">monoid</span> <span class="bp">ℤ</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring</span><span class="bp">.</span><span class="n">to_monoid</span> <span class="bp">ℤ</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">domain</span><span class="bp">.</span><span class="n">to_ring</span> <span class="bp">ℤ</span> <span class="o">(</span><span class="bp">@</span><span class="n">integral_domain</span><span class="bp">.</span><span class="n">to_domain</span> <span class="bp">ℤ</span> <span class="o">(</span><span class="bp">@</span><span class="n">principal_ideal_domain</span><span class="bp">.</span><span class="n">to_integral_domain</span> <span class="bp">ℤ</span> <span class="n">I</span><span class="o">))))</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">M1</span> <span class="bp">=</span> <span class="n">M2</span> <span class="o">:=</span> <span class="n">rfl</span>
</pre></div>


<p>So I am totally confused by this one. Did you write <code>[principal_ideal_domain ℤ]</code> at some point? This would be bad because it means "let the integers have the structure of a principal ideal domain in a way which I am not going to tell you anything about, and in particular the underlying addition and multiplication might be completely random".</p>
</blockquote>
<p>The reason must be the one you pointed, I wrote <code>principal_ideal_domain Z</code>at some point. Is there any way to add more details on the PID I'm looking at?</p>



<a name="187717833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187717833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187717833">(Feb 08 2020 at 13:54)</a>:</h4>
<p>Lean knows that the integers are a PID, you don't have to type <code>[principal_ideal_domain ℤ]</code> (which inserts a new instance of this fact into the type class inference machine) -- the instance is there already as you can see with <code>instance : principal_ideal_domain ℤ := by apply_instance</code></p>



<a name="187717882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187717882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187717882">(Feb 08 2020 at 13:56)</a>:</h4>
<p>If you type <code>[principal_ideal_domain ℤ]</code> then you just made the <em>set</em> of integers (or more precisely the type of integers) into a principal ideal domain by choosing a completely random integer and saying "this one is the 0", another completely random integer and saying "this one is the 1", choosing a random binary function and saying "this can be +" etc.</p>



<a name="187717896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187717896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187717896">(Feb 08 2020 at 13:57)</a>:</h4>
<p>Your <code>inst_1</code> is not my <code>I</code>, I suspect.</p>



<a name="187717905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187717905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187717905">(Feb 08 2020 at 13:57)</a>:</h4>
<p>so then you get problems later on because now you have two different concepts of unit on the set of integers.</p>



<a name="187718041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718041">(Feb 08 2020 at 14:01)</a>:</h4>
<p>I discussed with my math advisor who told me that it might be interesting to rework a bit the absolute value, valuations stuff to do a complete classification of all valuations over a field (according to Artin, Algebraic Numbers &amp; Algebraic Functions), Artin makes super satisfying proofs IMHO, its proof of Ostrowski is quite the same of the Cassels' one, except he's able to make it a lot more compact by doing some work beforehand on the base $b$ expansions.</p>
<p>So I think it makes sense to create a concept of valuations, derive the fact that valuations are always equivalent to one with triangular inequality, then I can have Ostrowski with kind of the same proof (shortened maybe) I have. Modulo base expansions.</p>
<p>BTW, is there any plan regarding decimal/bases expansions in mathlib?</p>



<a name="187718112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718112">(Feb 08 2020 at 14:03)</a>:</h4>
<p>I'm not sure there is any sensible classification of all valuations over a general field?</p>



<a name="187718160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718160">(Feb 08 2020 at 14:04)</a>:</h4>
<blockquote>
<p>Lean knows that the integers are a PID, you don't have to type <code>[principal_ideal_domain ℤ]</code> (which inserts a new instance of this fact into the type class inference machine) -- the instance is there already as you can see with <code>instance : principal_ideal_domain ℤ := by apply_instance</code></p>
</blockquote>
<p>It makes sense to me, but when I do this, I still have the same issue:</p>
<div class="codehilite"><pre><span></span>haveI : principal_ideal_domain ℤ := by apply_instance,
haveI : unique_factorization_domain ℤ := by apply_instance,
apply unique_factorization_domain.induction_on_prime x_1,
 {sorry,},
{intros, have abs_x2_eq_one: int.nat_abs x_2 = 1 := is_unit_int.1 a},
{ sorry },
</pre></div>


<p>where <code>x_1 : \Z</code>.</p>
<p>Am I still doing something wrong?</p>



<a name="187718165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718165">(Feb 08 2020 at 14:04)</a>:</h4>
<p>I only know of classifications over number fields (and I can believe that there will be a classification for global fields). Anything beyond that gets hairy very quickly.</p>



<a name="187718170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718170">(Feb 08 2020 at 14:05)</a>:</h4>
<p>I can't answer your question about instances unless you post complete working code.</p>



<a name="187718184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718184">(Feb 08 2020 at 14:05)</a>:</h4>
<p>I am explicitly asking you whether you have any <code>[principal_ideal_domain ℤ]</code> <em>with the rectangular brackets</em> in your code. If you don't, the problem is elsewhere.</p>



<a name="187718224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718224" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718224">(Feb 08 2020 at 14:06)</a>:</h4>
<blockquote>
<p>I'm not sure there is any sensible classification of all valuations over a general field?</p>
</blockquote>
<p>AFAIK, Artin provides some results regarding archimedean/non-archimedean.</p>



<a name="187718228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718228">(Feb 08 2020 at 14:06)</a>:</h4>
<p><a href="/user_uploads/3121/AZjjMTFRVVnaNPhiZRypzbnG/ostrowski-ext.lean" target="_blank" title="ostrowski-ext.lean">ostrowski-ext.lean</a> <br>
Here's the long file, because whenever I extract it into a minimal case, it works, so I don't understand what's the difference, sorry for the long proof. You'll see line 414 the issue.</p>



<a name="187718236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718236">(Feb 08 2020 at 14:07)</a>:</h4>
<p>I can't really comment on the Artin results because I am not sure what precisely you're talking about.</p>



<a name="187718291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718291">(Feb 08 2020 at 14:09)</a>:</h4>
<p>Not sure I can link a PDF for a book here, I suppose. But the exact reference is "Artin, Algebraic Numbers &amp; Algebraic Functions", chapter 1, section 3, "Classifications of Valuations"</p>



<a name="187718355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718355">(Feb 08 2020 at 14:11)</a>:</h4>
<p>He proves a necessary &amp; sufficient condition for a field to be non-archimedean based on the boundness of the values of the rationals integers for the valuation if I read well.</p>
<p>My advisor told me that it'd be interested to go this way in order to develop <a href="https://en.wikipedia.org/wiki/Berkovich_space" target="_blank" title="https://en.wikipedia.org/wiki/Berkovich_space">https://en.wikipedia.org/wiki/Berkovich_space</a> in Lean.</p>



<a name="187718404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718404">(Feb 08 2020 at 14:12)</a>:</h4>
<p>Commelin, Massot and me already developed adic spaces in Lean, probably what we did would be of some help if you wanted to do Berkovich spaces.</p>



<a name="187718407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718407">(Feb 08 2020 at 14:13)</a>:</h4>
<p>It's not in mathlib though.</p>



<a name="187718413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718413">(Feb 08 2020 at 14:13)</a>:</h4>
<blockquote>
<p>It's not in mathlib though.</p>
</blockquote>
<p>Is it in the perfectoid repository?</p>



<a name="187718414"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718414" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718414">(Feb 08 2020 at 14:13)</a>:</h4>
<p>Right.</p>



<a name="187718421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718421">(Feb 08 2020 at 14:13)</a>:</h4>
<p>That's something I'm interested in, thanks, I'll take a look to the repo then.</p>



<a name="187718652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718652">(Feb 08 2020 at 14:20)</a>:</h4>
<p>I am now beginning to think that the problem with your code is <code>unique_factorization_domain.induction_on_prime</code></p>



<a name="187718663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718663">(Feb 08 2020 at 14:21)</a>:</h4>
<div class="codehilite"><pre><span></span>unique_factorization_domain.induction_on_prime :
  ∀ {α : Type u_2} [_inst_1 : integral_domain α] [_inst_2 : unique_factorization_domain α] {P : α → Prop}
  (a : α),
    P 0 → (∀ (x : α), is_unit x → P x) → (∀ (a p : α), a ≠ 0 → prime p → P a → P (p * a)) → P a
</pre></div>



<a name="187718675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187718675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187718675">(Feb 08 2020 at 14:21)</a>:</h4>
<p>no I'm wrong, this looks fine; unique_factorization_domain doesn't extend integral_domain</p>



<a name="187719815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187719815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187719815">(Feb 08 2020 at 14:59)</a>:</h4>
<p>Oh! I am a twit. It shouldn't be <code>haveI</code> -- you need to change them to <code>letI</code>.</p>



<a name="187719819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187719819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187719819">(Feb 08 2020 at 14:59)</a>:</h4>
<blockquote>
<p>Oh! I am a twit. It shouldn't be <code>haveI</code> -- you need to change them to <code>letI</code>.</p>
</blockquote>
<p>Is there some docs on what's the difference between them?</p>



<a name="187719872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187719872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187719872">(Feb 08 2020 at 15:00)</a>:</h4>
<p>And it worked! :D</p>



<a name="187719965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187719965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187719965">(Feb 08 2020 at 15:03)</a>:</h4>
<p>you use <code>let</code> to define data and <code>have</code> to define proofs.</p>



<a name="187720012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187720012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187720012">(Feb 08 2020 at 15:04)</a>:</h4>
<p>Because <code>principal_ideal_domain</code> extends <code>integral_domain</code>, it's data.</p>



<a name="187720033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187720033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187720033">(Feb 08 2020 at 15:05)</a>:</h4>
<p>The term of type <code>principal_ideal_domain int</code> contains all the data of the multiplication etc.</p>



<a name="187720088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187720088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187720088">(Feb 08 2020 at 15:06)</a>:</h4>
<p>Okay I got it!</p>



<a name="187730805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187730805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187730805">(Feb 08 2020 at 20:44)</a>:</h4>
<blockquote>
<p>My advisor told me that it'd be interested to go this way in order to develop <a href="https://en.wikipedia.org/wiki/Berkovich_space" target="_blank" title="https://en.wikipedia.org/wiki/Berkovich_space">https://en.wikipedia.org/wiki/Berkovich_space</a> in Lean.</p>
</blockquote>
<p>Who is your advisor? Antoine?</p>



<a name="187731080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731080">(Feb 08 2020 at 20:53)</a>:</h4>
<blockquote>
<blockquote>
<p>My advisor told me that it'd be interested to go this way in order to develop <a href="https://en.wikipedia.org/wiki/Berkovich_space" target="_blank" title="https://en.wikipedia.org/wiki/Berkovich_space">https://en.wikipedia.org/wiki/Berkovich_space</a> in Lean.</p>
</blockquote>
<p>Who is your advisor? Antoine?</p>
</blockquote>
<p>Frédéric Paugam (I'm not in PhD)</p>



<a name="187731124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731124">(Feb 08 2020 at 20:54)</a>:</h4>
<p>I didn't know Frédéric was interested in Lean!</p>



<a name="187731137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731137">(Feb 08 2020 at 20:55)</a>:</h4>
<p>Are you a M2 student?</p>



<a name="187731140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731140">(Feb 08 2020 at 20:55)</a>:</h4>
<blockquote>
<p>Are you a M2 student?</p>
</blockquote>
<p>I'm in L3 :D…</p>



<a name="187731145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731145">(Feb 08 2020 at 20:55)</a>:</h4>
<p>Doing Berkovich spaces? Interesting...</p>



<a name="187731190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731190">(Feb 08 2020 at 20:56)</a>:</h4>
<blockquote>
<p>I didn't know Frédéric was interested in Lean!</p>
</blockquote>
<p>Frédéric Le Roux is also working on metric spaces in Lean IIRC, he wants to redo limits/etc without using uniform spaces so that it can be closer to what students know AFAIK.</p>



<a name="187731193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731193">(Feb 08 2020 at 20:56)</a>:</h4>
<blockquote>
<p>Doing Berkovich spaces? Interesting...</p>
</blockquote>
<p>Too much free time… :D</p>



<a name="187731200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731200">(Feb 08 2020 at 20:57)</a>:</h4>
<p>Yes, I know that Frédéric is interested in Lean, I didn't know about Paugam.</p>



<a name="187731265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731265">(Feb 08 2020 at 20:59)</a>:</h4>
<p>Lean is very good software for students who have too much free time.</p>



<a name="187731331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Contribution%20to%20mathlib%20with%20the%20Ostrowski%20theorem/near/187731331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Contribution.20to.20mathlib.20with.20the.20Ostrowski.20theorem.html#187731331">(Feb 08 2020 at 21:00)</a>:</h4>
<p>Definitely agreed!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>