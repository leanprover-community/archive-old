---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/use.20in.20tactic.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html">use in tactic</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="221270539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221270539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Angela Li <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221270539">(Dec 31 2020 at 05:17)</a>:</h4>
<p>Hello! I'm trying to make Fifteen. Here is hopefully a MWE <code>leanproject get SnobbyDragon/leanfifteen &amp;&amp; code leanfifteen</code> (<a href="https://github.com/SnobbyDragon/leanfifteen">https://github.com/SnobbyDragon/leanfifteen</a>)</p>
<p>In the <code>fifteentactics.lean</code> file, my <code>slide_tile</code> tactic is failing when I try to use the <code>use</code> tactic. I think it's parallel to this problem:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">solve</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="k">do</span> <span class="bp">`</span><span class="o">[</span><span class="n">use</span> <span class="n">n</span><span class="o">]</span> <span class="bp">&lt;|&gt;</span> <span class="n">tactic.fail</span> <span class="s2">":("</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">solve</span> <span class="mi">1</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>This fails but works if I do <code>`[use 1]</code>. Is there a way to fix this?<br>
Thanks!</p>



<a name="221270797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221270797" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221270797">(Dec 31 2020 at 05:24)</a>:</h4>
<p>what is Fifteen?</p>



<a name="221270808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221270808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221270808">(Dec 31 2020 at 05:25)</a>:</h4>
<p>oh this is the 4x4 sliding puzzle?</p>



<a name="221270816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221270816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Angela Li <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221270816">(Dec 31 2020 at 05:25)</a>:</h4>
<p>yeet</p>



<a name="221270817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221270817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221270817">(Dec 31 2020 at 05:25)</a>:</h4>
<p>I guess so</p>



<a name="221270883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221270883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221270883">(Dec 31 2020 at 05:26)</a>:</h4>
<p>You are passing the literal <code>n</code> to the use tactic there</p>



<a name="221270945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221270945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Angela Li <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221270945">(Dec 31 2020 at 05:28)</a>:</h4>
<p>uhhh I think I don't know what that means</p>



<a name="221270957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221270957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221270957">(Dec 31 2020 at 05:29)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">namespace</span> <span class="n">tactic</span>
<span class="kn">namespace</span> <span class="n">interactive</span>
<span class="n">setup_tactic_parser</span>
<span class="kd">meta</span> <span class="kd">def</span> <span class="n">solve</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">parse</span> <span class="n">texpr</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="k">do</span> <span class="n">use</span> <span class="o">[</span><span class="n">n</span><span class="o">]</span> <span class="bp">&lt;|&gt;</span> <span class="n">tactic.fail</span> <span class="s2">":("</span>
<span class="kd">end</span> <span class="n">interactive</span>
<span class="kd">end</span> <span class="n">tactic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">solve</span> <span class="mi">1</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221271011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221271011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221271011">(Dec 31 2020 at 05:30)</a>:</h4>
<p>the previous version was doing basically <code>solve 1 = use n</code> and it would complain that <code>n</code> doesn't exist at the point of use</p>



<a name="221271016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221271016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221271016">(Dec 31 2020 at 05:30)</a>:</h4>
<p>and the <code>n : nat</code> was unused</p>



<a name="221271018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221271018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Angela Li <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221271018">(Dec 31 2020 at 05:30)</a>:</h4>
<p>Ohhhh okay that makes sense. Ahhhh parsing I haven't done that yet. time to learn something new. thanks!</p>



<a name="221271046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221271046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221271046">(Dec 31 2020 at 05:31)</a>:</h4>
<p>alternatively, without the fancy parser, closer to your original version:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">solve</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="k">do</span> <span class="n">tactic.interactive.use</span> <span class="o">[</span><span class="n">pexpr.of_expr</span> <span class="o">(</span><span class="n">reflect</span> <span class="n">n</span><span class="o">)]</span> <span class="bp">&lt;|&gt;</span> <span class="n">tactic.fail</span> <span class="s2">":("</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">solve</span> <span class="mi">1</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="221271095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221271095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221271095">(Dec 31 2020 at 05:33)</a>:</h4>
<p>we have to turn <code>n : nat</code> back into a <code>pexpr</code> because that's what <code>use</code> takes as input</p>



<a name="221271118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221271118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Angela Li <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221271118">(Dec 31 2020 at 05:33)</a>:</h4>
<p>Okay thanks! I will try this on tiles now :)</p>



<a name="221271173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/use%20in%20tactic/near/221271173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/use.20in.20tactic.html#221271173">(Dec 31 2020 at 05:34)</a>:</h4>
<p>remember that tactics deal in <code>expr</code>s, not the actual types that you see at the user level. This allows them to do some things that would otherwise be impossible, but requires you to get your head around all the parsing and quoting and antiquoting stuff</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>