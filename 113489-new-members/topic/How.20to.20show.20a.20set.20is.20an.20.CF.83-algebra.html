---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html">How to show a set is an σ-algebra</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="290031433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290031433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Peter Hansen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290031433">(Jul 18 2022 at 22:27)</a>:</h4>
<p>How do I show that Σ = { ∅, {0, 1}, {2, 3}, {0, 1, 2, 3} } is a σ-algebra on X = {0, 1, 2, 3} in Lean?</p>
<p>I think it is done by defining a relevant object of the <code>measurable_space</code>-structure:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">measurable_space</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">measurable_set'</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
<span class="o">(</span><span class="n">measurable_set_empty</span> <span class="o">:</span> <span class="n">measurable_set'</span> <span class="bp">∅</span><span class="o">)</span>
<span class="o">(</span><span class="n">measurable_set_compl</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">s</span><span class="o">,</span> <span class="n">measurable_set'</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">measurable_set'</span> <span class="n">s</span><span class="bp">ᶜ</span><span class="o">)</span>
<span class="o">(</span><span class="n">measurable_set_Union</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">set</span> <span class="n">α</span><span class="o">,</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">measurable_set'</span> <span class="o">(</span><span class="n">f</span> <span class="n">i</span><span class="o">))</span> <span class="bp">→</span> <span class="n">measurable_set'</span> <span class="o">(</span><span class="bp">⋃</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">))</span>
</code></pre></div>
<p>First I need to choose the right <code>(α : Type*)</code>. I think the type should correspond to the set X = {0, 1, 2, 3}. I have a vague understanding of subtypes. Do I simply use <code>{n : ℕ // n &lt; 4}</code>?</p>
<p>Next I need to specify <code>measurable_set'</code>, which has type <code>set α → Prop</code>. I think I can define it as</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">measure_theory.measurable_space_def</span>

<span class="kd">def</span> <span class="n">mysig</span> <span class="o">:</span> <span class="n">measurable_space</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
<span class="n">fconstructor</span><span class="o">,</span>
<span class="n">intro</span> <span class="n">N</span><span class="o">,</span>
<span class="n">exact</span> <span class="n">N</span> <span class="bp">=</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">}</span> <span class="bp">∨</span> <span class="n">N</span> <span class="bp">=</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">}</span> <span class="bp">∨</span> <span class="n">N</span> <span class="bp">=</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">}</span> <span class="bp">∨</span> <span class="n">N</span> <span class="bp">=</span> <span class="bp">∅</span><span class="o">,</span>
<span class="n">simp</span><span class="o">,</span>
<span class="gr">sorry</span><span class="o">,</span>
<span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>With this approach, I run into problems when trying to show closure under complementation.</p>



<a name="290032974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290032974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290032974">(Jul 18 2022 at 22:45)</a>:</h4>
<p><code>fin 4</code> is defined to be <code>{n : ℕ // n &lt; 4}</code>, so I think you are using the right thing.<br>
The following includes a proof of <code>empty</code> and <code>compl</code> (<code>fin_cases</code> is sorta slow though), and <code>Union</code> seems to require some additional lemma(s):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">mysig</span> <span class="o">:</span> <span class="n">measurable_space</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">fconstructor</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">change</span> <span class="n">set</span> <span class="n">_</span><span class="o">,</span> <span class="n">exact</span> <span class="o">{{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">},</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="bp">∅</span><span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">or.inr</span> <span class="o">(</span><span class="n">or.inr</span> <span class="bp">$</span> <span class="n">or.inr</span> <span class="n">rfl</span><span class="o">)</span> <span class="c">/-</span><span class="cm"> or `right, right, right, exact rfl` -/</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="n">_</span> <span class="o">(</span><span class="n">rfl</span><span class="bp">|</span><span class="n">rfl</span><span class="bp">|</span><span class="n">rfl</span><span class="bp">|</span><span class="n">rfl</span><span class="bp">|</span><span class="o">⟨⟩),</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">},</span> <span class="o">},</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="290045059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290045059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290045059">(Jul 19 2022 at 02:00)</a>:</h4>
<p>just wanted to note that writing definitions in tactic mode is generally discouraged (or so I've heard)</p>



<a name="290045512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290045512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290045512">(Jul 19 2022 at 02:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="380294">Matt Diamond</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra/near/290045059">said</a>:</p>
<blockquote>
<p>just wanted to note that writing definitions in tactic mode is generally discouraged (or so I've heard)</p>
</blockquote>
<p>I agree; even though we're only using tactics that are safe for the data fields (e.g. <code>constructor</code>, <code>intro</code>, <code>exact</code>, <code>change</code>, <code>dsimp</code>, <code>apply</code>, <code>refine</code>), it would be nicer to write <code>{ measurable_set' := ... ,  measurable_set_empty := ..., ... }</code> so that it's evident which field you are working on.</p>



<a name="290045725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290045725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290045725">(Jul 19 2022 at 02:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="380294">Matt Diamond</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra/near/290045059">said</a>:</p>
<blockquote>
<p>just wanted to note that writing definitions in tactic mode is generally discouraged (or so I've heard)</p>
</blockquote>
<p>The idea is that most tactics are meant for propositions, and might do very complicated or unpredictable things in order to reach their results, which is bad when you're trying to define a concrete object. There are a few you can safely use - I'd like to add <code>by_cases</code> to the aforementioned list, and <code>rw</code> if you really know what you're doing.</p>



<a name="290045933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290045933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290045933">(Jul 19 2022 at 02:17)</a>:</h4>
<p>btw, I must be missing something about how Lean works because <code>def mySet : set (fin 4) := {1, 2, 500}</code> seems to typecheck just fine</p>



<a name="290046037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290046037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290046037">(Jul 19 2022 at 02:19)</a>:</h4>
<p>does Lean just take your word for it when you type a definition?</p>



<a name="290046097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290046097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290046097">(Jul 19 2022 at 02:20)</a>:</h4>
<p><code>(500 : fin 4) = 0</code> because it loops around.</p>



<a name="290046118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290046118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290046118">(Jul 19 2022 at 02:21)</a>:</h4>
<p>oh huh, it just does 500 mod 4?</p>



<a name="290046144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290046144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290046144">(Jul 19 2022 at 02:21)</a>:</h4>
<p>I guess that makes sense</p>



<a name="290046449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290046449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290046449">(Jul 19 2022 at 02:26)</a>:</h4>
<p>That's sort of a side-effect to how numerals are implemented. Under the hood, they're all expressions made from <a href="https://leanprover-community.github.io/mathlib_docs/find/bit0">docs#bit0</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/bit1">docs#bit1</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/has_zero.zero">docs#has_zero.zero</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/has_one.one">docs#has_one.one</a>, so you're forced to allow every natural number.</p>



<a name="290046473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290046473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290046473">(Jul 19 2022 at 02:26)</a>:</h4>
<p>gotcha... good to know!</p>



<a name="290046485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290046485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290046485">(Jul 19 2022 at 02:27)</a>:</h4>
<p>If you want to pull back the curtain, you can try <code>set_option pp.numerals false</code></p>



<a name="290046492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290046492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290046492">(Jul 19 2022 at 02:27)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#check</span> <span class="mi">37</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">bit1 (bit0 (bit1 (bit0 (bit0 has_one.one)))) : ℕ</span>
<span class="cm">-/</span>
</code></pre></div>



<a name="290047087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290047087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Peter Hansen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290047087">(Jul 19 2022 at 02:37)</a>:</h4>
<p>Thanks for the help and for confirming that I was somewhat on the right track :) Using <code>fin_cases</code> worked nicely for showing closure under complementation. I'm still trying to show closure under countable unions. I thought that since this was such a simple example it would be easy to formalize. Not the case for me at least.</p>



<a name="290048865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290048865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290048865">(Jul 19 2022 at 03:09)</a>:</h4>
<p>feel free to share what you have so far (if you want to)</p>



<a name="290048952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290048952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290048952">(Jul 19 2022 at 03:11)</a>:</h4>
<p>General theorems are much easier to formalise than examples in Lean 3, because Lean 3 is not a "computer"; it is not designed to compute. Lean 4 should be much better in this regard.</p>



<a name="290049679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290049679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290049679">(Jul 19 2022 at 03:24)</a>:</h4>
<p>now I'm curious if there's an easy way to prove a statement like <code>↑(finset.fin_range 4) = {0, 1, 2, 3}</code></p>



<a name="290050132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290050132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290050132">(Jul 19 2022 at 03:32)</a>:</h4>
<p>It might be nice to have a tactic (maybe a <code>norm_num</code> plugin?) that reduces basic set expressions, normalizing set literals like <code>{2, 4, 4, 1, 3} -&gt; {1, 2, 3, 4}</code> and using that to efficiently compute unions, intersections, and set differences.</p>



<a name="290050237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290050237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290050237">(Jul 19 2022 at 03:34)</a>:</h4>
<p><span class="user-mention" data-user-id="380294">@Matt Diamond</span> For this small example, at least this works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="bp">↑</span><span class="o">(</span><span class="n">finset.fin_range</span> <span class="mi">4</span><span class="o">)</span> <span class="bp">=</span> <span class="o">({</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span> <span class="n">x</span><span class="o">,</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="290050541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290050541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290050541">(Jul 19 2022 at 03:40)</a>:</h4>
<p>ah, I forgot about <code>ext</code>... very nice</p>



<a name="290051844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290051844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290051844">(Jul 19 2022 at 04:06)</a>:</h4>
<p>Actually these are almost defeq:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">finset.fin_range</span> <span class="mi">4</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">=</span> <span class="o">{</span><span class="n">i</span> <span class="bp">|</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">∨</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">3</span> <span class="bp">∨</span> <span class="n">false</span><span class="o">}</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="c">/-</span><span class="cm"> comes from `list.mem` -/</span>
<span class="kd">example</span> <span class="o">:</span> <span class="o">({</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">))</span> <span class="bp">=</span> <span class="o">{</span><span class="n">i</span> <span class="bp">|</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">∨</span> <span class="n">i</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">}</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="c">/-</span><span class="cm"> comes from `set.has_insert` and `set.has_singleton` -/</span>
</code></pre></div>
<p>Should we make them agree (for example, by redefining <a href="https://leanprover-community.github.io/mathlib_docs/find/set.has_singleton">docs#set.has_singleton</a>)?</p>



<a name="290052497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290052497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290052497">(Jul 19 2022 at 04:18)</a>:</h4>
<p>I'm curious about why there's a <code>∨ false</code> there</p>



<a name="290053263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290053263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290053263">(Jul 19 2022 at 04:34)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/list.mem">docs#list.mem</a> is an inductive definition with base case <code>list.mem a list.nil = false</code> for the empty list.</p>



<a name="290053295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290053295" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290053295">(Jul 19 2022 at 04:35)</a>:</h4>
<p>ah, that makes sense</p>



<a name="290054112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290054112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290054112">(Jul 19 2022 at 04:51)</a>:</h4>
<p>Using a lemma, I was able to reduce it to a finite problem (16 cases); then the same solution for complement works, but it takes like 1 minute on my machine:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">measure_theory.measurable_space_def</span>

<span class="kd">lemma</span> <span class="n">Sup_mem_of_sup_mem</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">multiset</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">m.powerset</span><span class="o">,</span> <span class="n">p</span> <span class="o">(</span><span class="n">multiset.sup</span> <span class="n">s</span><span class="o">))</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="n">p</span> <span class="o">(</span><span class="bp">⨆</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">classical</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hff</span> <span class="o">:</span> <span class="o">(</span><span class="n">set.range</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">finite</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">m.to_finset.finite_to_set.subset</span><span class="o">,</span>
    <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">finset.mem_coe</span><span class="o">,</span> <span class="n">multiset.mem_to_finset</span><span class="o">],</span> <span class="n">exact</span> <span class="n">hf</span> <span class="n">i</span> <span class="o">},</span>
  <span class="n">change</span> <span class="n">p</span> <span class="o">(</span><span class="n">Sup</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">hff.coe_to_finset</span><span class="o">,</span> <span class="bp">←</span> <span class="n">finset.sup_id_eq_Sup</span><span class="o">,</span> <span class="n">finset.sup_def</span><span class="o">,</span> <span class="n">multiset.map_id</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">multiset.mem_powerset</span><span class="o">,</span> <span class="n">finset.val_le_iff_val_subset</span><span class="o">],</span>
  <span class="n">intros</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hff.mem_to_finset.1</span> <span class="n">ha</span><span class="o">,</span> <span class="n">exact</span> <span class="n">hf</span> <span class="n">i</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">set_option</span> <span class="kd">class</span><span class="bp">.</span><span class="n">instance_max_depth</span> <span class="mi">100</span>

<span class="kn">open</span> <span class="n">or</span>
<span class="kd">def</span> <span class="n">mysig</span> <span class="o">:</span> <span class="n">measurable_space</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">fconstructor</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">change</span> <span class="n">set</span> <span class="n">_</span><span class="o">,</span> <span class="n">exact</span> <span class="o">{{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">},</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="bp">∅</span><span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">inr</span> <span class="o">(</span><span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="n">rfl</span><span class="o">)</span> <span class="c">/-</span><span class="cm"> or `right, right, right, exact rfl` -/</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintro</span> <span class="n">_</span> <span class="o">(</span><span class="n">rfl</span><span class="bp">|</span><span class="n">rfl</span><span class="bp">|</span><span class="n">rfl</span><span class="bp">|</span><span class="n">rfl</span><span class="bp">|</span><span class="o">⟨⟩),</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">left</span><span class="o">,</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">f</span> <span class="n">hf</span><span class="o">,</span> <span class="n">apply</span> <span class="n">Sup_mem_of_sup_mem</span><span class="o">,</span>
    <span class="n">swap</span> <span class="mi">3</span><span class="o">,</span> <span class="o">{</span> <span class="n">exact</span> <span class="o">{{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">},</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="bp">∅</span><span class="o">}</span> <span class="o">},</span>
    <span class="n">swap</span> <span class="mi">2</span><span class="o">,</span> <span class="o">{</span> <span class="n">intro</span> <span class="n">i</span><span class="o">,</span> <span class="n">obtain</span> <span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span> <span class="o">:=</span> <span class="n">hf</span> <span class="n">i</span><span class="o">,</span>
      <span class="n">exacts</span> <span class="o">[</span><span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">]</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">s</span> <span class="n">x</span><span class="o">,</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">multiset.sup</span><span class="o">],</span>
      <span class="n">work_on_goal</span> <span class="mi">1</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">2</span> <span class="o">{</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">3</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">4</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">5</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">6</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">7</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">8</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">9</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">10</span> <span class="o">{</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">11</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">12</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">13</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">14</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">15</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">work_on_goal</span> <span class="mi">16</span> <span class="o">{</span> <span class="n">right</span><span class="o">,</span> <span class="n">right</span><span class="o">,</span> <span class="n">left</span> <span class="o">},</span>
      <span class="n">all_goals</span> <span class="o">{</span> <span class="n">ext</span><span class="o">,</span> <span class="n">split</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">x</span><span class="bp">;</span> <span class="n">dec_trivial</span> <span class="o">}</span> <span class="o">}</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="290061196"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290061196" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290061196">(Jul 19 2022 at 07:02)</a>:</h4>
<p>That <code>change set _</code> is a bad idea</p>



<a name="290061245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290061245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290061245">(Jul 19 2022 at 07:03)</a>:</h4>
<p>Use <code>refine (∈ (_ : set _))</code> there instead ( or better, combine that with the next line</p>



<a name="290063559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290063559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290063559">(Jul 19 2022 at 07:36)</a>:</h4>
<p>Using finset computability/decidability, I'm able to make it faster and more automated:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">measure_theory.measurable_space_def</span>

<span class="kd">lemma</span> <span class="n">Sup_mem_of_sup_mem</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">multiset</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">m.powerset</span><span class="o">,</span> <span class="n">p</span> <span class="o">(</span><span class="n">multiset.sup</span> <span class="n">s</span><span class="o">))</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="n">p</span> <span class="o">(</span><span class="bp">⨆</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">classical</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hff</span> <span class="o">:</span> <span class="o">(</span><span class="n">set.range</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">finite</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">m.to_finset.finite_to_set.subset</span><span class="o">,</span>
    <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">finset.mem_coe</span><span class="o">,</span> <span class="n">multiset.mem_to_finset</span><span class="o">],</span> <span class="n">exact</span> <span class="n">hf</span> <span class="n">i</span> <span class="o">},</span>
  <span class="n">change</span> <span class="n">p</span> <span class="o">(</span><span class="n">Sup</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">hff.coe_to_finset</span><span class="o">,</span> <span class="bp">←</span> <span class="n">finset.sup_id_eq_Sup</span><span class="o">,</span> <span class="n">finset.sup_def</span><span class="o">,</span> <span class="n">multiset.map_id</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">multiset.mem_powerset</span><span class="o">,</span> <span class="n">finset.val_le_iff_val_subset</span><span class="o">],</span>
  <span class="n">intros</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hff.mem_to_finset.1</span> <span class="n">ha</span><span class="o">,</span> <span class="n">exact</span> <span class="n">hf</span> <span class="n">i</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kn">local</span> <span class="kd">notation</span> <span class="bp">`</span><span class="n">f4</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">finset</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">)</span>
<span class="kn">open</span> <span class="n">or</span>

<span class="kd">lemma</span> <span class="n">mysig_aux</span> <span class="o">:</span>
  <span class="o">({{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">},</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="bp">∅</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">{</span><span class="bp">↑</span><span class="o">({</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">({</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">({</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">∅</span><span class="o">:</span><span class="n">f4</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">congr</span><span class="bp">;</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">exact</span> <span class="o">(</span><span class="n">or_false</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="o">}</span>

<span class="kd">set_option</span> <span class="n">profiler</span> <span class="n">true</span>
<span class="c">/-</span><span class="cm"> elaboration of mysig took 20.8s -/</span>
<span class="kd">def</span> <span class="n">mysig</span> <span class="o">:</span> <span class="n">measurable_space</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">measurable_set'</span> <span class="o">:=</span> <span class="o">({{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">},</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="bp">∅</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">measurable_set_empty</span> <span class="o">:=</span> <span class="n">inr</span> <span class="o">(</span><span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="n">rfl</span><span class="o">),</span>
  <span class="n">measurable_set_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mysig_aux</span><span class="o">],</span>
    <span class="n">rintro</span> <span class="n">_</span> <span class="o">(</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="o">),</span>
    <span class="n">work_on_goal</span> <span class="mi">4</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">set.mem_singleton_iff</span> <span class="n">at</span> <span class="n">h</span> <span class="o">},</span>
    <span class="n">all_goals</span> <span class="o">{</span> <span class="n">subst</span> <span class="n">h</span><span class="o">,</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">finset.coe_compl</span><span class="o">,</span>
      <span class="n">dsimp</span> <span class="o">[</span><span class="n">set.has_insert</span><span class="o">,</span> <span class="bp">-</span><span class="n">finset.coe_empty</span><span class="o">],</span>
      <span class="n">change</span> <span class="n">_</span> <span class="bp">=</span> <span class="n">_</span> <span class="bp">∨</span> <span class="n">_</span><span class="o">,</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.coe_inj</span><span class="o">],</span> <span class="n">dec_trivial</span> <span class="o">},</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">measurable_set_Union</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span> <span class="n">hf</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">mysig_aux</span> <span class="n">at</span> <span class="n">hf</span> <span class="bp">⊢</span><span class="o">,</span>
    <span class="n">fapply</span> <span class="n">Sup_mem_of_sup_mem</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">{</span><span class="bp">↑</span><span class="o">({</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">({</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">({</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">∅</span><span class="o">:</span><span class="n">f4</span><span class="o">)}</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="n">s</span> <span class="o">(</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="o">⟨⟨⟩⟩),</span>
      <span class="n">all_goals</span> <span class="o">{</span> <span class="n">subst</span> <span class="n">h</span><span class="o">,</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">multiset.sup</span><span class="o">,</span> <span class="n">set.has_insert</span><span class="o">,</span> <span class="bp">←</span> <span class="n">finset.coe_empty</span><span class="o">],</span>
        <span class="n">change</span> <span class="n">_</span> <span class="bp">=</span> <span class="n">_</span> <span class="bp">∨</span> <span class="n">_</span><span class="o">,</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">←</span> <span class="n">finset.coe_union</span><span class="o">,</span> <span class="n">finset.coe_inj</span><span class="o">],</span> <span class="n">dec_trivial</span> <span class="o">}</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">i</span><span class="o">,</span> <span class="n">obtain</span> <span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span> <span class="o">:=</span> <span class="n">hf</span> <span class="n">i</span><span class="o">,</span>
      <span class="n">exacts</span> <span class="o">[</span><span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">]</span> <span class="o">},</span>
  <span class="kd">end</span> <span class="o">}</span>
</code></pre></div>



<a name="290063684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290063684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290063684">(Jul 19 2022 at 07:38)</a>:</h4>
<blockquote>
<p>That change set _ is a bad idea</p>
</blockquote>
<p>Yes, <code>change</code> seems to introduce an <code>id</code>, but it doesn't seem to matter much ...</p>



<a name="290073134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290073134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290073134">(Jul 19 2022 at 09:23)</a>:</h4>
<p><code>measurable_set' := ({{0,1}, {2,3}, {0,1,2,3}, ∅} : set _)</code> is still the wrong spelling</p>



<a name="290073155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290073155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290073155">(Jul 19 2022 at 09:23)</a>:</h4>
<p>Use <code>measurable_set' := (∈ {{0,1}, {2,3}, {0,1,2,3}, ∅}),</code></p>



<a name="290073337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290073337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290073337">(Jul 19 2022 at 09:25)</a>:</h4>
<p>The right way to convert from <code>a -&gt; Prop</code> to <code>set</code> is <code>set_of p</code> aka <code>{x | p x}</code>, and the right way to convert in the order direction is <code>(∈ s)</code>. If you do it any other way, you'll find that you have to unfold stuff because no lemmas expect you to do things that way</p>



<a name="290079245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290079245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290079245">(Jul 19 2022 at 10:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="380294">Matt Diamond</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra/near/290049679">said</a>:</p>
<blockquote>
<p>now I'm curious if there's an easy way to prove a statement like <code>↑(finset.fin_range 4) = {0, 1, 2, 3}</code></p>
</blockquote>
<p>People, please stop using <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.fin_range">docs#finset.fin_range</a>. Use <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.univ">docs#finset.univ</a> instead.</p>



<a name="290082587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290082587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290082587">(Jul 19 2022 at 11:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra/near/290050132">said</a>:</p>
<blockquote>
<p>It might be nice to have a tactic (maybe a <code>norm_num</code> plugin?) that reduces basic set expressions, normalizing set literals like <code>{2, 4, 4, 1, 3} -&gt; {1, 2, 3, 4}</code> and using that to efficiently compute unions, intersections, and set differences.</p>
</blockquote>
<p>We basically already have this as part of <a href="https://leanprover-community.github.io/mathlib_docs/find/tactic.norm_num.eval_big_operators">docs#tactic.norm_num.eval_big_operators</a>. The problem with finsets is that you need some way to decide that <code>({1, 2, 3, 4} : finset (fin 4)) = {1, 2, 3}</code>. But if you can hook up a norm_num front-end to <a href="https://leanprover-community.github.io/mathlib_docs/find/tactic.norm_num.eval_finset">docs#tactic.norm_num.eval_finset</a> it should work.</p>



<a name="290118523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290118523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290118523">(Jul 19 2022 at 15:44)</a>:</h4>
<blockquote>
<p>Use <code>measurable_set' := (∈ {{0,1}, {2,3}, {0,1,2,3}, ∅}),</code></p>
</blockquote>
<p>Using <code>(∈ )</code> allow to eliminate <code>change _ = _ ∨ _</code> , but I also have to modify the statement of <code>Sup_mem_of_sup_mem</code> to use <code>set α</code> instead of  <code>α → Prop</code>, otherwise <code>fapply Sup_mem_of_sup_mem</code> fails to unify.</p>



<a name="290118564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290118564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290118564">(Jul 19 2022 at 15:44)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">measure_theory.measurable_space_def</span>

<span class="kd">lemma</span> <span class="n">Sup_mem_of_sup_mem</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">complete_lattice</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">multiset</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">m.powerset</span><span class="o">,</span> <span class="n">multiset.sup</span> <span class="n">s</span> <span class="bp">∈</span> <span class="n">p</span><span class="o">)</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="bp">⨆</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">p</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">classical</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hff</span> <span class="o">:</span> <span class="o">(</span><span class="n">set.range</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">finite</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">m.to_finset.finite_to_set.subset</span><span class="o">,</span>
    <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">finset.mem_coe</span><span class="o">,</span> <span class="n">multiset.mem_to_finset</span><span class="o">],</span> <span class="n">exact</span> <span class="n">hf</span> <span class="n">i</span> <span class="o">},</span>
  <span class="n">change</span> <span class="n">p</span> <span class="o">(</span><span class="n">Sup</span> <span class="n">_</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">hff.coe_to_finset</span><span class="o">,</span> <span class="bp">←</span> <span class="n">finset.sup_id_eq_Sup</span><span class="o">,</span> <span class="n">finset.sup_def</span><span class="o">,</span> <span class="n">multiset.map_id</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">multiset.mem_powerset</span><span class="o">,</span> <span class="n">finset.val_le_iff_val_subset</span><span class="o">],</span>
  <span class="n">intros</span> <span class="n">a</span> <span class="n">ha</span><span class="o">,</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hff.mem_to_finset.1</span> <span class="n">ha</span><span class="o">,</span> <span class="n">exact</span> <span class="n">hf</span> <span class="n">i</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kn">local</span> <span class="kd">notation</span> <span class="bp">`</span><span class="n">f4</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">finset</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">mysig_aux</span> <span class="o">:</span>
  <span class="o">({{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">},</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="bp">∅</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">{</span><span class="bp">↑</span><span class="o">({</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">({</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">({</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">∅</span><span class="o">:</span><span class="n">f4</span><span class="o">)}</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">congr</span><span class="bp">;</span> <span class="o">{</span> <span class="n">ext</span><span class="o">,</span> <span class="n">exact</span> <span class="o">(</span><span class="n">or_false</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="o">}</span>

<span class="kn">open</span> <span class="n">or</span>
<span class="kd">set_option</span> <span class="n">profiler</span> <span class="n">true</span>
<span class="c">/-</span><span class="cm"> elaboration of mysig took 20.2s -/</span>
<span class="kd">def</span> <span class="n">mysig</span> <span class="o">:</span> <span class="n">measurable_space</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">measurable_set'</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">∈</span> <span class="o">({{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">},</span> <span class="o">{</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">},</span> <span class="bp">∅</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">set</span> <span class="bp">$</span> <span class="n">fin</span> <span class="mi">4</span><span class="o">)),</span>
  <span class="n">measurable_set_empty</span> <span class="o">:=</span> <span class="n">inr</span> <span class="o">(</span><span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="n">rfl</span><span class="o">),</span>
  <span class="n">measurable_set_compl</span> <span class="o">:=</span> <span class="kd">begin</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">mysig_aux</span><span class="o">],</span>
    <span class="n">rintro</span> <span class="n">_</span> <span class="o">(</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="o">),</span>
    <span class="n">work_on_goal</span> <span class="mi">4</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">set.mem_singleton_iff</span> <span class="n">at</span> <span class="n">h</span> <span class="o">},</span>
    <span class="n">all_goals</span> <span class="o">{</span> <span class="n">subst</span> <span class="n">h</span><span class="o">,</span> <span class="n">rw</span> <span class="bp">←</span> <span class="n">finset.coe_compl</span><span class="o">,</span>
      <span class="n">dsimp</span> <span class="o">[</span><span class="n">set.has_insert</span><span class="o">,</span> <span class="bp">-</span><span class="n">finset.coe_empty</span><span class="o">],</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">finset.coe_inj</span><span class="o">],</span> <span class="n">dec_trivial</span> <span class="o">},</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">measurable_set_Union</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">f</span> <span class="n">hf</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">mysig_aux</span> <span class="n">at</span> <span class="n">hf</span> <span class="bp">⊢</span><span class="o">,</span>
    <span class="n">fapply</span> <span class="n">Sup_mem_of_sup_mem</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">{</span><span class="bp">↑</span><span class="o">({</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">({</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">({</span><span class="mi">0</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">}:</span><span class="n">f4</span><span class="o">),</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">∅</span><span class="o">:</span><span class="n">f4</span><span class="o">)}</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="n">s</span> <span class="o">(</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="o">⟨⟨⟩⟩),</span>
      <span class="n">all_goals</span> <span class="o">{</span> <span class="n">subst</span> <span class="n">h</span><span class="o">,</span> <span class="n">dsimp</span> <span class="o">[</span><span class="n">multiset.sup</span><span class="o">,</span> <span class="n">set.has_insert</span><span class="o">,</span> <span class="bp">←</span> <span class="n">finset.coe_empty</span><span class="o">],</span>
        <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">←</span> <span class="n">finset.coe_union</span><span class="o">,</span> <span class="n">finset.coe_inj</span><span class="o">],</span> <span class="n">dec_trivial</span> <span class="o">}</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">i</span><span class="o">,</span> <span class="n">obtain</span> <span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span><span class="bp">|</span><span class="n">h</span> <span class="o">:=</span> <span class="n">hf</span> <span class="n">i</span><span class="o">,</span>
      <span class="n">exacts</span> <span class="o">[</span><span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">,</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inr</span> <span class="bp">$</span> <span class="n">inl</span> <span class="n">h</span><span class="o">]</span> <span class="o">},</span>
  <span class="kd">end</span> <span class="o">}</span>
</code></pre></div>



<a name="290171724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290171724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290171724">(Jul 19 2022 at 22:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra/near/290079245">said</a>:</p>
<blockquote>
<p>People, please stop using <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.fin_range">docs#finset.fin_range</a>. Use <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.univ">docs#finset.univ</a> instead.</p>
</blockquote>
<p>Is this something that can be easily refactored out?</p>



<a name="290174952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290174952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290174952">(Jul 19 2022 at 23:37)</a>:</h4>
<p>Looks like it: <a href="https://github.com/leanprover-community/mathlib/pull/15538">#15538</a></p>



<a name="290179006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20show%20a%20set%20is%20an%20%CF%83-algebra/near/290179006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20show.20a.20set.20is.20an.20.CF.83-algebra.html#290179006">(Jul 20 2022 at 00:41)</a>:</h4>
<p>With more lemmas (some basic ones are missing in mathlib), Lean can do the computation in less than 5 seconds: <a href="https://gist.github.com/alreadydone/ba98aa4e04b5f0067960284ef03b4442">https://gist.github.com/alreadydone/ba98aa4e04b5f0067960284ef03b4442</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>