---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html">If natural number n ≠ 0 then it is not 0 as a ℚ</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="222953791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222953791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222953791">(Jan 16 2021 at 02:47)</a>:</h4>
<p>I'm having trouble proving this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">ne_zero_lift</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">rat.of_int</span> <span class="o">(</span><span class="n">int.of_nat</span> <span class="n">n</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>



<a name="222954766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222954766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hanting Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222954766">(Jan 16 2021 at 03:05)</a>:</h4>
<p>What is the context here? Explicitly writing out <code>rat.of_int (int.of_nat n)</code> seems unnatural. If you're trying to show that natural number <code>n \neq 0</code> implies rational <code>n \neq 0</code> in a proof, that should be done with norm_cast, or exact_mod_cast, these kind of tactics.</p>



<a name="222954768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222954768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222954768">(Jan 16 2021 at 03:05)</a>:</h4>
<p>You probably shouldn't be using casts by explicitly using those functions, if your goal is more like this</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kd">lemma</span> <span class="n">ne_zero_lift</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>  <span class="o">((</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span><span class="n">norm_cast</span><span class="o">,</span> <span class="n">exact</span> <span class="n">h</span><span class="o">}</span>
</code></pre></div>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#norm_cast">tactic#norm_cast</a> will handle it</p>



<a name="222955158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222955158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222955158">(Jan 16 2021 at 03:12)</a>:</h4>
<p>Here's  a (probably not very idiomatic) proof for the original lemma:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">ne_zero_lift</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">rat.of_int</span> <span class="o">(</span><span class="n">int.of_nat</span> <span class="n">n</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="o">(</span><span class="n">rat.coe_int_eq_of_int</span> <span class="o">(</span><span class="n">int.of_nat</span> <span class="n">n</span><span class="o">)),</span> <span class="bp">←</span><span class="o">(</span><span class="n">int.coe_nat_eq</span> <span class="n">n</span><span class="o">),</span> <span class="o">(</span><span class="n">int.cast_coe_nat</span> <span class="n">n</span><span class="o">)],</span>
  <span class="n">exact</span> <span class="n">nat.cast_ne_zero.mpr</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222957907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222957907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222957907">(Jan 16 2021 at 04:04)</a>:</h4>
<p>I am trying to prove a theorem I call <code>plus_injective</code> which looks like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.rat.basic</span>
<span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">open</span> <span class="n">rat</span>

<span class="kd">lemma</span> <span class="n">pow_two_ne_zero</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">(</span><span class="n">succ_def</span> <span class="n">d</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">(</span><span class="n">pow_succ</span> <span class="mi">2</span> <span class="n">d</span><span class="o">),</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">plus_injective</span>
        <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span>
        <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
        <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span>
        <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">):</span>
        <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">by_cases</span> <span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">m</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">n20</span> <span class="o">:=</span> <span class="n">pow_two_ne_zero</span> <span class="n">n</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">m20</span> <span class="o">:=</span> <span class="n">pow_two_ne_zero</span> <span class="n">m</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">rat.add_def</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>At the point of the <code>sorry</code>, my tactic state is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">ab</span><span class="o">:</span> <span class="n">ℚ</span>
<span class="n">nm</span><span class="o">:</span> <span class="n">ℕ</span>
<span class="n">ha</span><span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span>
<span class="n">hb</span><span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span>
<span class="n">h</span><span class="o">:</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span>
<span class="n">n20</span><span class="o">:</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span>
<span class="n">m20</span><span class="o">:</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="bp">≠</span> <span class="mi">0</span>
<span class="n">h</span><span class="o">:</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">?</span><span class="n">m_2</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">mk</span> <span class="bp">?</span><span class="n">m_3</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">+</span> <span class="n">mk</span> <span class="bp">?</span><span class="n">m_4</span> <span class="bp">?</span><span class="n">m_2</span> <span class="bp">=</span> <span class="n">mk</span> <span class="o">(</span><span class="bp">?</span><span class="n">m_3</span> <span class="bp">*</span> <span class="bp">?</span><span class="n">m_2</span> <span class="bp">+</span> <span class="bp">?</span><span class="n">m_4</span> <span class="bp">*</span> <span class="bp">?</span><span class="n">m_1</span><span class="o">)</span> <span class="o">(</span><span class="bp">?</span><span class="n">m_1</span> <span class="bp">*</span> <span class="bp">?</span><span class="n">m_2</span><span class="o">)</span>
<span class="bp">⊢</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span>
</code></pre></div>
<p>The point of the <code>rat.add_def</code> is to expand the definition of rational addition so that I can pick it apart and get the value of <code>(a+b).denom</code> explicitly so that I can prove that it equals <code>2^m</code>.  Note that <code>m ≤ n</code>.   My reasoning is that</p>
<p><code>a + b = (2^n *a.num + 2^m * b.num)/(2^m*2^n) = (2^(n-m)*a + b)/2^m</code></p>
<p>However I can't get there if I can't apply <code>rat_add</code> and for that I need to make four rational numbers out of pieces of <code>a</code> and <code>b</code>, namely</p>
<ul>
<li><code>a.num</code> as rational</li>
<li><code>b.num</code> as rational</li>
<li><code>2^n</code> as rational</li>
<li><code>2^m</code> as rational</li>
</ul>
<p>I know this may look like the long way around, but I don't know the short way.</p>



<a name="222958630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222958630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222958630">(Jan 16 2021 at 04:25)</a>:</h4>
<p>I would approach this this way:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">plus_injective</span>
        <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span>
        <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
        <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span>
        <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">):</span>
        <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">revert</span> <span class="n">ha</span> <span class="n">hb</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="c1">-- prep for next line</span>
  <span class="n">wlog</span> <span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">,</span> <span class="c1">-- only want to worry about the m ≤ n case using WLOG without loss of generality</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">ha</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">m</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[(</span><span class="bp">+</span><span class="o">)],</span>
    <span class="n">rw</span> <span class="n">rat.add</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">rat.mk_pnat_denom</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">],</span>
    <span class="gr">sorry</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">specialize</span> <span class="n">this</span> <span class="n">hb</span> <span class="n">ha</span><span class="o">,</span> <span class="c1">-- getting the n ≤ m case from the other</span>
    <span class="n">rw</span> <span class="n">add_comm</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">this</span><span class="o">,</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222958691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222958691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222958691">(Jan 16 2021 at 04:27)</a>:</h4>
<p>The key point here is that that definition of addition of two rationals is defined via the numerator and denominator, by doing <code>cases a</code> we split the rat into its components, numerator, denominator and proofs that it is well formed (coprime and positive denom).</p>



<a name="222958695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222958695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222958695">(Jan 16 2021 at 04:27)</a>:</h4>
<p>Then we can rewrite the definition of rational addition directly, rather than using a <code>have</code></p>



<a name="222959410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222959410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222959410">(Jan 16 2021 at 04:48)</a>:</h4>
<p>Probably the key lemma you then need to prove is then <code>(a_num * ↑2 ^ m + b_num * ↑2 ^ n).gcd (↑2 ^ n * ↑2 ^ m) = 2 ^ n</code> given <code>m \le n</code> and <code>b_num.nat_abs.coprime (2 ^ m)</code> and <code>a_num.nat_abs.coprime (2 ^ n)</code>, buuut that might not be true !</p>



<a name="222959416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222959416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222959416">(Jan 16 2021 at 04:48)</a>:</h4>
<p>Also</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">gcd_nat_abs</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">a.nat_abs.gcd</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a.gcd</span> <span class="n">b</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>seems useful here, but doesn't seem to be in the library</p>



<a name="222961116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222961116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222961116">(Jan 16 2021 at 05:15)</a>:</h4>
<p>What I would go for is a proof that <code>(\u a / \u b).denom | b</code>, or alternatively <code>(a /. b).denom | b</code>. Then by definition of addition on rat <code>(a + b).denom = (... /. a.denom * b.denom).denom</code> so by the theorem and your equalities, <code>(a + b).denom | 2 ^ n * 2 ^ m</code>. Finally, use a theorem which says <code>a | 2 ^ i -&gt; \exists j, a = 2 ^ j</code> and you are done</p>



<a name="222961714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222961714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222961714">(Jan 16 2021 at 05:30)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">eq_two_pow_of_dvd_two_pow</span> <span class="o">{</span><span class="n">a</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∣</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="o">:=</span> <span class="gr">sorry</span>

<span class="kd">lemma</span> <span class="n">add_denom_two_pow</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">eq_two_pow_of_dvd_two_pow</span> <span class="n">_</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">rat.add_num_denom</span><span class="o">,</span> <span class="bp">←</span> <span class="n">int.coe_nat_mul</span><span class="o">,</span> <span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">,</span> <span class="bp">←</span> <span class="n">pow_add</span><span class="o">,</span> <span class="bp">←</span> <span class="n">int.coe_nat_dvd</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">rat.denom_dvd</span>
<span class="kd">end</span>
</code></pre></div>
<p>I've saved the best for last for you</p>



<a name="222970906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222970906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222970906">(Jan 16 2021 at 09:14)</a>:</h4>
<p>Denominator of a+b divides product of denominators of a and b. Is that in mathlib? That should be a clean route to this goal</p>



<a name="222972635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222972635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222972635">(Jan 16 2021 at 09:59)</a>:</h4>
<p>I don't think that exact theorem is stated, but it is about half of the proof of <code>add_denom_two_pow</code> just above, basically a combination of <code>rat.add_num_denom</code> and <code>rat.denom_dvd</code></p>



<a name="222988031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222988031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222988031">(Jan 16 2021 at 15:38)</a>:</h4>
<p>Lars, this is somewhat besides the point, however, <code>use m</code> in your partial proof of <code>plus_injective</code> does not appear right: there could be further cancelling, if <code>m=n</code>.  In fact, the case <code>a+b=0</code> shows this clearly (when <code>1&lt;n</code>).</p>



<a name="222994308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/222994308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#222994308">(Jan 16 2021 at 17:32)</a>:</h4>
<p>Thank you very much for all of these suggestions.  <span class="user-mention" data-user-id="127136">@Alex J. Best</span> , one of these is quick:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">gcd_nat_abs</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">a.nat_abs.gcd</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">a.gcd</span> <span class="n">b</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">exact</span> <span class="n">rfl</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="223005506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223005506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223005506">(Jan 16 2021 at 20:51)</a>:</h4>
<p>On this lemma by <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">eq_two_pow_of_dvd_two_pow</span> <span class="o">{</span><span class="n">a</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∣</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">unfold</span> <span class="n">has_dvd.dvd</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>with tactic state</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">an</span><span class="o">:</span> <span class="n">ℕ</span>
<span class="n">h1</span><span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">c</span>
<span class="bp">⊢</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span>
</code></pre></div>
<p>Then</p>
<ul>
<li>"by inspection", since <code>2^n</code> only contains prime factor 2, I want to </li>
<li>Suppose that there is a <code>k≤n</code> such that <code>c = 2^k</code></li>
<li>Solve <code>2^n = a * 2^k</code> as <code>a = 2^n/2^k = 2^(n-k)</code></li>
<li>Use <code>m=n-k</code> to solve the goal</li>
</ul>
<p>This seems correct but I don't know how to implement the "by inspection" step and the "suppose there is a  <code>k≤n</code>" step.</p>



<a name="223006018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223006018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hanting Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223006018">(Jan 16 2021 at 21:00)</a>:</h4>
<p>There's probably something like <code>dvd_prime_pow</code> that gives you <code>c = 2^k</code> for some <code>k \le n</code>.</p>



<a name="223006033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223006033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hanting Zhang <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223006033">(Jan 16 2021 at 21:01)</a>:</h4>
<p>Ah, here, <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.dvd_prime_pow">docs#nat.dvd_prime_pow</a>.</p>



<a name="223020122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223020122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223020122">(Jan 17 2021 at 02:50)</a>:</h4>
<p>Actually your second step is the same as the theorem you are proving! But <code>nat.dvd_prime_pow</code> implies the theorem pretty easily.</p>



<a name="223057206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223057206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223057206">(Jan 17 2021 at 18:55)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="355764">@Hanting Zhang</span>  and <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> .  I was able to finish this lemma.  Lean did most of the work at the end:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.nat.prime</span>

<span class="c1">-- Mario Carneiro, Hanting Zhang</span>
<span class="kd">lemma</span> <span class="n">eq_two_pow_of_dvd_two_pow</span> <span class="o">{</span><span class="n">a</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∣</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">@</span><span class="n">nat.dvd_prime_pow</span> <span class="mi">2</span> <span class="n">nat.prime_two</span> <span class="n">n</span> <span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hm</span> <span class="k">with</span> <span class="n">H</span> <span class="n">hH</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="223059870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223059870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223059870">(Jan 17 2021 at 19:52)</a>:</h4>
<p>That  finishes the<code>plus_injective</code> goal:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.rat.basic</span>
<span class="kn">import</span> <span class="n">data.nat.prime</span>
<span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">tactic.slim_check</span>
<span class="kn">open</span> <span class="n">rat</span>

<span class="c1">-- Mario Carneiro, Hanting Zhang</span>
<span class="kd">lemma</span> <span class="n">eq_two_pow_of_dvd_two_pow</span> <span class="o">{</span><span class="n">a</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∣</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">@</span><span class="n">nat.dvd_prime_pow</span> <span class="mi">2</span> <span class="n">nat.prime_two</span> <span class="n">n</span> <span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="mi">1</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">hm</span> <span class="k">with</span> <span class="n">H</span> <span class="n">hH</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">succ_def</span> <span class="o">(</span><span class="n">m</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">m.succ</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">lemma</span> <span class="n">pow_two_ne_zero</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">(</span><span class="n">succ_def</span> <span class="n">d</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">(</span><span class="n">pow_succ</span> <span class="mi">2</span> <span class="n">d</span><span class="o">),</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="kd">end</span>

<span class="c1">-- Mario Carneiro</span>
<span class="kd">lemma</span> <span class="n">add_denom_two_pow</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">eq_two_pow_of_dvd_two_pow</span> <span class="n">_</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">rat.add_num_denom</span><span class="o">,</span> <span class="bp">←</span> <span class="n">int.coe_nat_mul</span><span class="o">,</span> <span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">,</span> <span class="bp">←</span> <span class="n">pow_add</span><span class="o">,</span> <span class="bp">←</span> <span class="n">int.coe_nat_dvd</span><span class="o">],</span>
  <span class="n">apply</span> <span class="n">rat.denom_dvd</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">plus_injective</span>
        <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span>
        <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
        <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span>
        <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">):</span>
        <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="n">add_denom_two_pow</span> <span class="n">ha</span> <span class="n">hb</span>
</code></pre></div>



<a name="223063603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223063603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223063603">(Jan 17 2021 at 21:18)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span> I worked on your approach but I can't make it go through.  I get stuck on a lemma <code>expr_eq_pow2n</code> which only seems true with <code>a=0</code> or <code>a</code> is a multiple of <code>2^(m-n)</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.rat.basic</span>
<span class="kn">import</span> <span class="n">data.nat.gcd</span>
<span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">tactic.slim_check</span>
<span class="kn">open</span> <span class="n">rat</span>

<span class="kd">lemma</span> <span class="n">nat_gcd_gt_0</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hn</span><span class="o">:</span> <span class="n">n</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="n">m.gcd</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
  <span class="n">nat.gcd_pos_of_pos_right</span> <span class="n">m</span> <span class="n">hn</span>

<span class="kd">lemma</span> <span class="n">pow_add2</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span><span class="bp">^</span><span class="n">m</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">)</span> <span class="o">:=</span> <span class="n">tactic.ring.pow_add_rev</span> <span class="mi">2</span> <span class="n">n</span> <span class="n">m</span>

<span class="kd">lemma</span> <span class="n">succ_def</span> <span class="o">(</span><span class="n">m</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">m.succ</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">lemma</span> <span class="n">pow_two_ne_zero</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">(</span><span class="n">succ_def</span> <span class="n">d</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">(</span><span class="n">pow_succ</span> <span class="mi">2</span> <span class="n">d</span><span class="o">),</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">pow_two_gt_zero</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">pow_two_ne_zero</span> <span class="n">n</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">expr_ne_0</span> <span class="o">(</span><span class="n">a_num</span> <span class="n">b_num</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="o">(</span><span class="n">a_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">pow_add2</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">pow_two_gt_zero</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">),</span>
  <span class="n">exact</span> <span class="n">nat_gcd_gt_0</span> <span class="n">h1</span> <span class="o">(</span><span class="n">a_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">mul_inj_right</span><span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">congr_fun</span> <span class="o">(</span><span class="n">congr_arg</span> <span class="n">has_mul.mul</span> <span class="n">h</span><span class="o">)</span> <span class="n">a</span>

<span class="kd">lemma</span> <span class="n">mul_to_left_div</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">)</span> <span class="o">(</span><span class="n">c0</span><span class="o">:</span> <span class="n">c</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">):</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">/</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">b</span> <span class="o">:=</span>
  <span class="n">nat.div_eq_of_eq_mul_right</span> <span class="n">c0</span> <span class="n">h</span>

<span class="kd">lemma</span> <span class="n">expr_eq_pow2n</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span><span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">)</span>
      <span class="o">(</span><span class="n">b_cop</span><span class="o">:</span> <span class="n">b.nat_abs.coprime</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">))</span>
      <span class="o">(</span><span class="n">a_cop</span><span class="o">:</span> <span class="n">a.nat_abs.coprime</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)):</span>
      <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">a_pos</span> <span class="o">:=</span> <span class="n">pow_two_gt_zero</span> <span class="n">n</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">b_pos</span> <span class="o">:=</span> <span class="n">pow_two_gt_zero</span> <span class="n">m</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">plus_injective</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">):</span>
        <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">revert</span> <span class="n">ha</span> <span class="n">hb</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="c1">-- prep for next line</span>
  <span class="n">wlog</span> <span class="n">h</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">≤</span> <span class="n">n</span><span class="o">,</span> <span class="c1">-- only want to worry about the m ≤ n case using WLOG without loss of generality</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">ha</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">m</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[(</span><span class="bp">+</span><span class="o">)],</span>
    <span class="n">rw</span> <span class="n">rat.add</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">rat.mk_pnat_denom</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">expr_ne_0</span> <span class="n">a_num</span> <span class="n">b_num</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">mul_to_left_div</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">m</span><span class="o">)</span> <span class="o">((</span><span class="n">a_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">))</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">clear</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hb</span> <span class="n">at</span> <span class="n">b_pos</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">mul_inj_right</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="o">(((</span><span class="n">a_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">))),</span>
    <span class="n">apply</span> <span class="n">h3</span><span class="o">,</span>
    <span class="n">clear</span> <span class="n">h3</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hb</span> <span class="n">at</span> <span class="n">b_cop</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">expr_eq_pow2n</span> <span class="n">h</span> <span class="n">b_cop</span> <span class="n">a_cop</span><span class="o">),</span>
  <span class="o">},</span>
  <span class="o">{</span> <span class="n">specialize</span> <span class="n">this</span> <span class="n">hb</span> <span class="n">ha</span><span class="o">,</span> <span class="c1">-- getting the n ≤ m case from the other</span>
    <span class="n">rw</span> <span class="n">add_comm</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">this</span><span class="o">,</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="223065266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223065266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223065266">(Jan 17 2021 at 21:49)</a>:</h4>
<p>Right the correct version has $m \ge n$.</p>



<a name="223066673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223066673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223066673">(Jan 17 2021 at 22:17)</a>:</h4>
<p>If I switch it around to <code>n ≤ m</code>, the goal becomes to show</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span>
           <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="o">(</span><span class="n">m</span><span class="bp">-</span><span class="n">n</span><span class="o">))</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span>
           <span class="bp">=</span> <span class="o">((</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span> <span class="bp">*</span><span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="o">(</span><span class="n">m</span><span class="bp">-</span><span class="n">n</span><span class="o">))</span> <span class="bp">+</span> <span class="n">b</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span>
</code></pre></div>
<p>or</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">1</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="o">(</span><span class="n">m</span><span class="bp">-</span><span class="n">n</span><span class="o">))</span> <span class="bp">+</span> <span class="n">b</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span>
</code></pre></div>
<p>but for <code>a=b=1</code>, <code>n=m</code>,  this seems to become <code>1=2</code>.  This seems false.  Am I switching the <code>n ≤ m</code> in the wrong place?  Here is what I am looking at:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.rat.basic</span>
<span class="kn">import</span> <span class="n">data.nat.gcd</span>
<span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">tactic.slim_check</span>
<span class="kn">open</span> <span class="n">rat</span>

<span class="kd">lemma</span> <span class="n">nat_gcd_gt_0</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">hn</span><span class="o">:</span> <span class="n">n</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="n">m.gcd</span><span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
  <span class="n">nat.gcd_pos_of_pos_right</span> <span class="n">m</span> <span class="n">hn</span>

<span class="kd">lemma</span> <span class="n">pow_add2</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span><span class="bp">^</span><span class="n">m</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">)</span> <span class="o">:=</span> <span class="n">tactic.ring.pow_add_rev</span> <span class="mi">2</span> <span class="n">n</span> <span class="n">m</span>

<span class="kd">lemma</span> <span class="n">succ_def</span> <span class="o">(</span><span class="n">m</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">m.succ</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">lemma</span> <span class="n">pow_two_ne_zero</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">(</span><span class="n">succ_def</span> <span class="n">d</span><span class="o">),</span>
  <span class="n">rw</span> <span class="o">(</span><span class="n">pow_succ</span> <span class="mi">2</span> <span class="n">d</span><span class="o">),</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">pow_two_gt_zero</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">pow_two_ne_zero</span> <span class="n">n</span><span class="o">,</span>
  <span class="n">finish</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">expr_ne_0</span> <span class="o">(</span><span class="n">a_num</span> <span class="n">b_num</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span> <span class="o">(</span><span class="n">a_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">&gt;</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">pow_add2</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">pow_two_gt_zero</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">),</span>
  <span class="n">exact</span> <span class="n">nat_gcd_gt_0</span> <span class="n">h1</span> <span class="o">(</span><span class="n">a_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">mul_inj_right</span><span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">c</span><span class="o">)</span> <span class="o">:</span> <span class="n">b</span> <span class="bp">*</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">congr_fun</span> <span class="o">(</span><span class="n">congr_arg</span> <span class="n">has_mul.mul</span> <span class="n">h</span><span class="o">)</span> <span class="n">a</span>

<span class="kd">lemma</span> <span class="n">mul_to_left_div</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">)</span> <span class="o">(</span><span class="n">c0</span><span class="o">:</span> <span class="n">c</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">c</span> <span class="bp">*</span> <span class="n">b</span><span class="o">):</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">/</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">b</span> <span class="o">:=</span>
  <span class="n">nat.div_eq_of_eq_mul_right</span> <span class="n">c0</span> <span class="n">h</span>

<span class="kd">lemma</span> <span class="n">expr_eq_pow2n</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span><span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span><span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">m</span><span class="o">)</span>
      <span class="o">(</span><span class="n">b_cop</span><span class="o">:</span> <span class="n">b.nat_abs.coprime</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">))</span>
      <span class="o">(</span><span class="n">a_cop</span><span class="o">:</span> <span class="n">a.nat_abs.coprime</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)):</span>
      <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">by</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">a_pos</span> <span class="o">:=</span> <span class="n">pow_two_gt_zero</span> <span class="n">n</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">b_pos</span> <span class="o">:=</span> <span class="n">pow_two_gt_zero</span> <span class="n">m</span><span class="o">,</span>

<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">plus_injective</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">):</span>
        <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">revert</span> <span class="n">ha</span> <span class="n">hb</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="c1">-- prep for next line</span>
  <span class="n">wlog</span> <span class="n">h</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≤</span> <span class="n">m</span><span class="o">,</span> <span class="c1">-- only want to worry about the m ≤ n case using WLOG without loss of generality</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">ha</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">m</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[(</span><span class="bp">+</span><span class="o">)],</span>
    <span class="n">rw</span> <span class="n">rat.add</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">rat.mk_pnat_denom</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">ha</span><span class="o">,</span> <span class="n">hb</span><span class="o">]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h1</span> <span class="o">:=</span> <span class="n">expr_ne_0</span> <span class="n">a_num</span> <span class="n">b_num</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">mul_to_left_div</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">m</span><span class="o">)</span> <span class="o">((</span><span class="n">a_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">))</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">clear</span> <span class="n">h1</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hb</span> <span class="n">at</span> <span class="n">b_pos</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">mul_inj_right</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="o">(((</span><span class="n">a_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b_num</span> <span class="bp">*</span> <span class="bp">↑</span><span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">))</span><span class="bp">.</span><span class="n">nat_abs.gcd</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">))),</span>
    <span class="n">apply</span> <span class="n">h3</span><span class="o">,</span>
    <span class="n">clear</span> <span class="n">h3</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hb</span> <span class="n">at</span> <span class="n">b_cop</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">expr_eq_pow2n</span> <span class="n">h</span> <span class="n">b_cop</span> <span class="n">a_cop</span><span class="o">),</span>
  <span class="o">},</span>
  <span class="o">{</span> <span class="n">specialize</span> <span class="n">this</span> <span class="n">hb</span> <span class="n">ha</span><span class="o">,</span> <span class="c1">-- getting the n ≤ m case from the other</span>
    <span class="n">rw</span> <span class="n">add_comm</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">this</span><span class="o">,</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="223066890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223066890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223066890">(Jan 17 2021 at 22:22)</a>:</h4>
<p>Yeah that seems right, I guess you need $m &gt; n$ then</p>



<a name="223067034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223067034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223067034">(Jan 17 2021 at 22:26)</a>:</h4>
<p>Thanks, I'll try it now.</p>



<a name="223067456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223067456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223067456">(Jan 17 2021 at 22:38)</a>:</h4>
<p>Saying <code>n&lt;m</code> is very different in its effect on Lean than saying <code>n≤m</code>.   In this case:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">wlog</span> <span class="n">h</span> <span class="o">:</span> <span class="n">m</span><span class="bp">≤</span><span class="n">n</span><span class="o">,</span>
</code></pre></div>
<p>two goals are produced, one with <code>h</code> and one with it's negation.  In case</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">wlog</span> <span class="n">h</span><span class="o">:</span> <span class="n">n</span><span class="bp">&lt;</span><span class="n">m</span><span class="bp">`</span><span class="o">,</span>
</code></pre></div>
<p>3 goals are produced.  The first is </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">nm</span><span class="o">:</span> <span class="n">ℕ</span>
<span class="bp">⊢</span> <span class="n">n</span> <span class="bp">&lt;</span> <span class="n">m</span> <span class="bp">∨</span> <span class="n">m</span> <span class="bp">&lt;</span> <span class="n">n</span>
</code></pre></div>
<p>This appears to be false for <code>n=m</code>.  So the proof can't be fixed with this change.</p>



<a name="223069899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223069899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223069899">(Jan 17 2021 at 23:41)</a>:</h4>
<p>Agreed, the proof will not work in its current form, the outline isn't true, after all <code>1/2 + 1/2 = 1/4</code> so in the case of <code>n = m = 1</code> we have <code>k = 2</code> so the <code>use m</code> line must be changed in that case at the very least.</p>



<a name="223069940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/If%20natural%20number%20n%20%E2%89%A0%200%20then%20it%20is%20not%200%20as%20a%20%E2%84%9A/near/223069940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/If.20natural.20number.20n.20.E2.89.A0.200.20then.20it.20is.20not.200.20as.20a.20.E2.84.9A.html#223069940">(Jan 17 2021 at 23:42)</a>:</h4>
<p>You can do a case split inside the <code>n \le m</code> branch on <code>m = n</code> or <code> n &lt; m</code> though</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>