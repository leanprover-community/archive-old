---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/fails_quickly.20times.20out.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html">fails_quickly times out</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="251138442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251138442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251138442">(Aug 29 2021 at 15:09)</a>:</h4>
<p>I'm stuck on PR <a href="https://github.com/leanprover-community/mathlib/issues/8673">#8673</a>, failing the lint:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Run</span> <span class="bp">./</span><span class="n">scripts</span><span class="bp">/</span><span class="n">mk_all.sh</span>
<span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">deep</span> <span class="n">recursion</span> <span class="n">was</span> <span class="n">detected</span> <span class="n">at</span> <span class="bp">'</span><span class="n">replace'</span> <span class="o">(</span><span class="n">potential</span> <span class="n">solution</span><span class="o">:</span> <span class="n">increase</span> <span class="n">stack</span> <span class="n">space</span> <span class="k">in</span> <span class="n">your</span> <span class="n">system</span><span class="o">)</span>
<span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">deep</span> <span class="n">recursion</span> <span class="n">was</span> <span class="n">detected</span> <span class="n">at</span> <span class="bp">'</span><span class="n">replace'</span> <span class="o">(</span><span class="n">potential</span> <span class="n">solution</span><span class="o">:</span> <span class="n">increase</span> <span class="n">stack</span> <span class="n">space</span> <span class="k">in</span> <span class="n">your</span> <span class="n">system</span><span class="o">)</span>
<span class="n">deep</span> <span class="n">recursion</span> <span class="n">was</span> <span class="n">detected</span> <span class="n">at</span> <span class="bp">'</span><span class="n">replace'</span> <span class="o">(</span><span class="n">potential</span> <span class="n">solution</span><span class="o">:</span> <span class="n">increase</span> <span class="n">stack</span> <span class="n">space</span> <span class="k">in</span> <span class="n">your</span> <span class="n">system</span><span class="o">)</span>
<span class="o">:</span><span class="mi">0</span><span class="o">:</span><span class="mi">0</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">deep</span> <span class="n">recursion</span> <span class="n">was</span> <span class="n">detected</span> <span class="n">at</span> <span class="bp">'</span><span class="n">replace'</span> <span class="o">(</span><span class="n">potential</span> <span class="n">solution</span><span class="o">:</span> <span class="n">increase</span> <span class="n">stack</span> <span class="n">space</span> <span class="k">in</span> <span class="n">your</span> <span class="n">system</span><span class="o">)</span>
<span class="n">Error</span><span class="o">:</span> <span class="n">Process</span> <span class="n">completed</span> <span class="k">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span><span class="bp">.</span>
</code></pre></div>
<p>I think it's objecting to this instance <a href="https://github.com/leanprover-community/mathlib/pull/8673/files#diff-955f5d05cac3345a253a4f9d7d0a9d97914339b75b6a52e9a7501b4bccc7386bR420">https://github.com/leanprover-community/mathlib/pull/8673/files#diff-955f5d05cac3345a253a4f9d7d0a9d97914339b75b6a52e9a7501b4bccc7386bR420</a></p>
<p>However, I can't see what needs to be done to make it go green?</p>
<p>Thanks,</p>
<p>Christopher</p>



<a name="251145733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251145733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251145733">(Aug 29 2021 at 17:22)</a>:</h4>
<p>Does the linter fail locally? Then you can change the instance to a def and find out if you're right</p>



<a name="251148785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251148785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251148785">(Aug 29 2021 at 18:17)</a>:</h4>
<p>Yes, it fails locally. If I change it to a def (and delete any subsequent statements depending on the instance) then the linter passes.</p>



<a name="251155101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251155101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251155101">(Aug 29 2021 at 20:12)</a>:</h4>
<p>But that doesn't help me know what to do about it...</p>



<a name="251155365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251155365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251155365">(Aug 29 2021 at 20:17)</a>:</h4>
<p>That instance forms a loop with <a href="https://leanprover-community.github.io/mathlib_docs/find/distrib_lattice.to_lattice">docs#distrib_lattice.to_lattice</a></p>



<a name="251155431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251155431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251155431">(Aug 29 2021 at 20:18)</a>:</h4>
<p>So therefore cannot safely be an instance, no matter the priority</p>



<a name="251155438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251155438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251155438">(Aug 29 2021 at 20:18)</a>:</h4>
<p>(this is not the case in lean 4 I think)</p>



<a name="251195928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251195928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251195928">(Aug 30 2021 at 08:00)</a>:</h4>
<p>Thanks. So how would I prove something like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">test</span> <span class="o">[</span><span class="n">covariant_class</span> <span class="n">α</span> <span class="n">α</span> <span class="o">(</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="bp">≤</span><span class="o">)]</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">y</span> <span class="bp">⊓</span> <span class="n">z</span><span class="o">)</span> <span class="bp">⊔</span> <span class="n">x</span> <span class="bp">=</span> <span class="o">(</span><span class="n">y</span> <span class="bp">⊔</span> <span class="n">x</span><span class="o">)</span> <span class="bp">⊓</span> <span class="o">(</span><span class="n">z</span> <span class="bp">⊔</span> <span class="n">x</span><span class="o">)</span>
</code></pre></div>
<p>without using class inference? I tried</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">apply</span> <span class="n">sup_inf_right</span> <span class="o">(</span><span class="n">lattice_ordered_comm_group_to_distrib_lattice</span> <span class="n">α</span><span class="o">)</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span>
</code></pre></div>
<p>but that doesn't work.</p>



<a name="251243533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251243533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251243533">(Aug 30 2021 at 15:06)</a>:</h4>
<p>I thought perhaps</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_coe</span> <span class="o">(</span><span class="n">covariant_class</span> <span class="n">α</span> <span class="n">α</span> <span class="o">(</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="bp">≤</span><span class="o">))</span> <span class="o">(</span><span class="n">distrib_lattice</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>would help, but it doesn't. Sorry, I seem to be stabbing around in the dark here.</p>



<a name="251246583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251246583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251246583">(Aug 30 2021 at 15:27)</a>:</h4>
<p>You should just change it from <code>instance</code> to <code>def</code></p>



<a name="251247841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251247841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251247841">(Aug 30 2021 at 15:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/fails_quickly.20times.20out/near/251246583">said</a>:</p>
<blockquote>
<p>You should just change it from <code>instance</code> to <code>def</code></p>
</blockquote>
<p>Right, but then I can't see what to do <a href="https://github.com/leanprover-community/mathlib/pull/8673/files#diff-955f5d05cac3345a253a4f9d7d0a9d97914339b75b6a52e9a7501b4bccc7386bR455">here</a> where I need to make use of the fact that α is (mathematically)  a distributive lattice?</p>



<a name="251249369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251249369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251249369">(Aug 30 2021 at 15:44)</a>:</h4>
<p>What's in the context (the hypotheses in the goal window) at that point?</p>



<a name="251250509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251250509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251250509">(Aug 30 2021 at 15:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/fails_quickly.20times.20out/near/251249369">said</a>:</p>
<blockquote>
<p>What's in the context (the hypotheses in the goal window) at that point?</p>
</blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">lattice_ordered_group.lean</span><span class="o">:</span><span class="mi">455</span><span class="o">:</span><span class="mi">12</span>
<span class="n">Tactic</span> <span class="n">state</span>
<span class="n">widget</span>
<span class="n">filter</span><span class="o">:</span>
<span class="n">no</span> <span class="n">filter</span>
<span class="mi">1</span> <span class="n">goal</span>
<span class="n">α</span><span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="n">_inst_1</span><span class="o">:</span> <span class="n">lattice</span> <span class="n">α</span>
<span class="n">_inst_2</span><span class="o">:</span> <span class="n">comm_group</span> <span class="n">α</span>
<span class="n">_inst_3</span><span class="o">:</span> <span class="n">covariant_class</span> <span class="n">α</span> <span class="n">α</span> <span class="n">has_mul.mul</span> <span class="n">has_le.le</span>
<span class="n">abc</span><span class="o">:</span> <span class="n">α</span>
<span class="bp">⊢</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊔</span> <span class="n">c</span> <span class="bp">⊔</span> <span class="o">(</span><span class="n">a</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">))</span> <span class="bp">/</span> <span class="o">((</span><span class="n">b</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">)</span> <span class="bp">⊓</span> <span class="o">(</span><span class="n">a</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">))</span> <span class="bp">*</span> <span class="o">((</span><span class="n">b</span> <span class="bp">⊓</span> <span class="n">c</span> <span class="bp">⊔</span> <span class="n">a</span> <span class="bp">⊓</span> <span class="n">c</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊓</span> <span class="n">c</span> <span class="bp">⊓</span> <span class="o">(</span><span class="n">a</span> <span class="bp">⊓</span> <span class="n">c</span><span class="o">)))</span> <span class="bp">=</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊔</span> <span class="n">a</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊓</span> <span class="n">a</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">)</span> <span class="bp">*</span> <span class="o">((</span><span class="n">b</span> <span class="bp">⊔</span> <span class="n">a</span><span class="o">)</span> <span class="bp">⊓</span> <span class="n">c</span> <span class="bp">/</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊓</span> <span class="n">a</span> <span class="bp">⊓</span> <span class="n">c</span><span class="o">))</span>
<span class="n">Messages</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span>
<span class="n">lattice_ordered_group.lean</span><span class="o">:</span><span class="mi">455</span><span class="o">:</span><span class="mi">2</span>
<span class="n">rewrite</span> <span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">did</span> <span class="n">not</span> <span class="n">find</span> <span class="kd">instance</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pattern</span> <span class="k">in</span> <span class="n">the</span> <span class="n">target</span> <span class="n">expression</span>
  <span class="o">(</span><span class="bp">?</span><span class="n">m_3</span> <span class="bp">⊔</span> <span class="bp">?</span><span class="n">m_4</span><span class="o">)</span> <span class="bp">⊓</span> <span class="o">(</span><span class="bp">?</span><span class="n">m_5</span> <span class="bp">⊔</span> <span class="bp">?</span><span class="n">m_4</span><span class="o">)</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">,</span>
<span class="n">_inst_1</span> <span class="o">:</span> <span class="n">lattice</span> <span class="n">α</span><span class="o">,</span>
<span class="n">_inst_2</span> <span class="o">:</span> <span class="n">comm_group</span> <span class="n">α</span><span class="o">,</span>
<span class="n">_inst_3</span> <span class="o">:</span> <span class="n">covariant_class</span> <span class="n">α</span> <span class="n">α</span> <span class="n">has_mul.mul</span> <span class="n">has_le.le</span><span class="o">,</span>
<span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="o">:</span> <span class="n">α</span>
<span class="bp">⊢</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊔</span> <span class="n">c</span> <span class="bp">⊔</span> <span class="o">(</span><span class="n">a</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">))</span> <span class="bp">/</span> <span class="o">((</span><span class="n">b</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">)</span> <span class="bp">⊓</span> <span class="o">(</span><span class="n">a</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">))</span> <span class="bp">*</span> <span class="o">((</span><span class="n">b</span> <span class="bp">⊓</span> <span class="n">c</span> <span class="bp">⊔</span> <span class="n">a</span> <span class="bp">⊓</span> <span class="n">c</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊓</span> <span class="n">c</span> <span class="bp">⊓</span> <span class="o">(</span><span class="n">a</span> <span class="bp">⊓</span> <span class="n">c</span><span class="o">)))</span> <span class="bp">=</span>
    <span class="o">(</span><span class="n">b</span> <span class="bp">⊔</span> <span class="n">a</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊓</span> <span class="n">a</span> <span class="bp">⊔</span> <span class="n">c</span><span class="o">)</span> <span class="bp">*</span> <span class="o">((</span><span class="n">b</span> <span class="bp">⊔</span> <span class="n">a</span><span class="o">)</span> <span class="bp">⊓</span> <span class="n">c</span> <span class="bp">/</span> <span class="o">(</span><span class="n">b</span> <span class="bp">⊓</span> <span class="n">a</span> <span class="bp">⊓</span> <span class="n">c</span><span class="o">))</span>
</code></pre></div>



<a name="251251219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251251219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251251219">(Aug 30 2021 at 15:58)</a>:</h4>
<p>I think you should either:</p>
<ul>
<li>replace <code>lattice α</code> with <code>distrib_lattice α</code> in that lemma</li>
<li>add a <code>letI : distrib_lattice α := lattice_ordered_comm_group_to_distrib_lattice _</code> inside that proof</li>
</ul>



<a name="251286824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/fails_quickly%20times%20out/near/251286824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Christopher Hoskin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/fails_quickly.20times.20out.html#251286824">(Aug 30 2021 at 20:05)</a>:</h4>
<p>The PR has gone green with <code>letI</code>. Thank you very much.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>