---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/timeout.20in.20.60cases.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html">timeout in `cases`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="213120185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213120185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213120185">(Oct 13 2020 at 07:37)</a>:</h4>
<p>I'm trying to expand an existence clause in a hypothesis and Lean is timing out for some reason I can't figure out:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">in_range</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≤</span> <span class="mi">1981</span>

<span class="kd">def</span> <span class="n">problem_predicate</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="n">in_range</span> <span class="n">m</span> <span class="bp">∧</span> <span class="n">in_range</span> <span class="n">n</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span>

<span class="kd">def</span> <span class="n">specified_set</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℤ</span> <span class="o">:=</span>
<span class="o">{</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="o">(</span><span class="n">k</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">∧</span> <span class="n">problem_predicate</span> <span class="n">m</span> <span class="n">n</span><span class="o">)}</span>

<span class="kd">lemma</span> <span class="n">solution_bound</span> <span class="o">{</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">∈</span> <span class="n">specified_set</span><span class="o">)</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">≤</span> <span class="mi">3524578</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">h2</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span> <span class="o">(</span><span class="n">k</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">∧</span> <span class="n">problem_predicate</span> <span class="n">m</span> <span class="n">n</span><span class="o">),</span> <span class="k">from</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">h3</span> <span class="n">h4</span><span class="o">,</span> <span class="c1">-- this line times out</span>
<span class="kd">end</span>
</code></pre></div>

<p>I thought I wasn't doing anything fancy here - <code>h2</code> is a hypothesis starting with ∃, so I use a <code>cases</code> tactic, but this times out. What's going on here?</p>



<a name="213120884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213120884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213120884">(Oct 13 2020 at 07:46)</a>:</h4>
<p>This is really strange. Changing the bound in the goal from <code>3524578</code> to something small makes the problem go away. I don't see why a complicated goal should change something to casing on an hypothesis... Same thing with <code>rcases</code> or <code>obtain</code>.</p>



<a name="213120902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213120902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213120902">(Oct 13 2020 at 07:47)</a>:</h4>
<p>I'm going to guess it's the large number in the goal.  This times out, too:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">≤</span> <span class="mi">3524578</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">exfalso</span><span class="o">,</span> <span class="c1">-- times out</span>
  <span class="n">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="213121011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121011">(Oct 13 2020 at 07:48)</a>:</h4>
<p>hmm. well at least I was justified in finding it strange</p>



<a name="213121135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121135">(Oct 13 2020 at 07:50)</a>:</h4>
<p>(By the way, rather than your <code>have h2</code> line, you can do <code>simp only [specified_set, set.mem_set_of_eq] at h1,</code> to put it into the same form.)</p>



<a name="213121152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121152">(Oct 13 2020 at 07:51)</a>:</h4>
<p>yeah, I just stuck that in to make it clear</p>



<a name="213121160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121160">(Oct 13 2020 at 07:51)</a>:</h4>
<p>Yes, I have no clue about what is going on.</p>



<a name="213121162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121162">(Oct 13 2020 at 07:51)</a>:</h4>
<p>You don't even need the <code>h2</code> line, you can case on <code>h1</code>.</p>



<a name="213121164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121164">(Oct 13 2020 at 07:51)</a>:</h4>
<p>I was wondering if there was some problem with converting between the set-membership and the other form of the statement</p>



<a name="213121179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121179">(Oct 13 2020 at 07:51)</a>:</h4>
<p>yeah, well casing on h1 also times out</p>



<a name="213121244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121244">(Oct 13 2020 at 07:52)</a>:</h4>
<p>Yes, I was just saying that casing on <code>h1</code> or <code>h2</code> is the same. If one fails, the other one will fail similarly.</p>



<a name="213121294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213121294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213121294">(Oct 13 2020 at 07:53)</a>:</h4>
<p>I guess at some place it goes back from the binary expansion of the constant in the goal to the unary expansion, which is too large. But I really don't see why it should do something like that!</p>



<a name="213122540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213122540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213122540">(Oct 13 2020 at 08:02)</a>:</h4>
<p>Minimal example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.basic</span>

<span class="kd">lemma</span> <span class="n">solution_bound</span> <span class="o">{</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">:</span>
 <span class="k">let</span> <span class="n">p</span> <span class="o">:=</span> <span class="o">(</span><span class="mi">3524578</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="k">in</span> <span class="n">k</span> <span class="bp">≤</span> <span class="n">p</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">exfalso</span><span class="o">,</span> <span class="c1">-- times out with the simp</span>
<span class="kd">end</span>
</code></pre></div>

<p>Without the <code>simp</code> call, it doesn't time out.</p>



<a name="213122915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213122915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213122915">(Oct 13 2020 at 08:07)</a>:</h4>
<p>A workaround:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">solution_bound</span> <span class="o">{</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">∈</span> <span class="n">specified_set</span><span class="o">)</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3524578</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">specified_set</span><span class="o">,</span> <span class="n">set.mem_set_of_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">h3</span> <span class="n">h4</span><span class="o">,</span>
  <span class="n">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="213122967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213122967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213122967">(Oct 13 2020 at 08:08)</a>:</h4>
<p>It's the same issue that was remarked on in the <code>norm_num</code> thread, I think. Inequality on <code>int</code> is defined to be either <code>true</code> or <code>false</code>, so it's easy to get into a situation where <code>whnf</code> on the goal causes divergence</p>



<a name="213123069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213123069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213123069">(Oct 13 2020 at 08:09)</a>:</h4>
<p>this one -&gt; <a href="#narrow/stream/113489-new-members/topic/deep.20recursion.20was.20detected.20at.20'replace'/near/212360087">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/deep.20recursion.20was.20detected.20at.20'replace'/near/212360087</a></p>



<a name="213123304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213123304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213123304">(Oct 13 2020 at 08:12)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> Testing what you said, indeed this does not time out:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">:</span> <span class="bp">-</span><span class="mi">3524578</span> <span class="bp">≤</span> <span class="bp">-</span><span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">exfalso</span><span class="o">,</span> <span class="c1">-- does not time out</span>
<span class="kd">end</span>
</code></pre></div>

<p>(I'm assuming whnf of <code>k - 3524578</code> involves a nontrivial amount of computation, but <code>-(-3524578) - (-k)</code> does not.)</p>



<a name="213123355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213123355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213123355">(Oct 13 2020 at 08:13)</a>:</h4>
<p>aha, it's probably when the numeral is on the right</p>



<a name="213123365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213123365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213123365">(Oct 13 2020 at 08:13)</a>:</h4>
<p>And the workaround from before has a coercion to block the whnf.</p>



<a name="213123442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213123442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213123442">(Oct 13 2020 at 08:14)</a>:</h4>
<p>from the prelude:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">nonneg</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">int.cases_on</span> <span class="n">a</span> <span class="o">(</span><span class="k">assume</span> <span class="n">n</span><span class="o">,</span> <span class="n">true</span><span class="o">)</span> <span class="o">(</span><span class="k">assume</span> <span class="n">n</span><span class="o">,</span> <span class="n">false</span><span class="o">)</span>

<span class="kn">protected</span> <span class="kd">def</span> <span class="n">le</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">nonneg</span> <span class="o">(</span><span class="n">b</span> <span class="bp">-</span> <span class="n">a</span><span class="o">)</span>

<span class="kn">protected</span> <span class="kd">def</span> <span class="n">lt</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">≤</span> <span class="n">b</span>
</code></pre></div>



<a name="213123773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213123773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213123773">(Oct 13 2020 at 08:17)</a>:</h4>
<p>I wonder if it would be better to make <code>nonneg</code> a structure to prevent this unfolding</p>



<a name="213124028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213124028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213124028">(Oct 13 2020 at 08:20)</a>:</h4>
<p>I thought that <code>int.le</code> has been made irreducible in <a href="https://github.com/leanprover-community/mathlib/issues/4474">#4474</a>? Apparently this is not the case...</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.basic</span>

<span class="kn">attribute</span> <span class="o">[</span><span class="n">irreducible</span><span class="o">]</span> <span class="n">int.le</span>

<span class="kd">lemma</span> <span class="n">solution_bound</span> <span class="o">{</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">:</span>
 <span class="n">k</span> <span class="bp">≤</span> <span class="o">(</span><span class="mi">3257648</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">exfalso</span><span class="o">,</span> <span class="c1">-- times out without the irreducible attribute</span>
<span class="kd">end</span>
</code></pre></div>



<a name="213124254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213124254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213124254">(Oct 13 2020 at 08:23)</a>:</h4>
<p>It's only <code>int.lt</code> that was marked irreducible...</p>



<a name="213124660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213124660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213124660">(Oct 13 2020 at 08:27)</a>:</h4>
<p>Aha:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">meta</span> <span class="kd">def</span> <span class="n">contradiction</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="k">do</span> <span class="n">try</span> <span class="n">intro1</span><span class="o">,</span>
   <span class="n">ctx</span> <span class="bp">←</span> <span class="n">local_context</span><span class="o">,</span>
   <span class="o">(</span><span class="n">contra_false</span> <span class="n">ctx</span> <span class="bp">&lt;|&gt;</span>
    <span class="n">contra_not_a_refl_rel_a</span> <span class="n">ctx</span> <span class="bp">&lt;|&gt;</span>
    <span class="n">contra_p_not_p</span> <span class="n">ctx</span> <span class="n">ctx</span> <span class="bp">&lt;|&gt;</span>
    <span class="n">contra_constructor_eq</span> <span class="n">ctx</span> <span class="bp">&lt;|&gt;</span>
    <span class="n">fail</span> <span class="s2">"contradiction tactic failed"</span><span class="o">)</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">exfalso</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="k">do</span> <span class="n">fail_if_no_goals</span><span class="o">,</span>
   <span class="n">assert</span> <span class="bp">`</span><span class="n">Hfalse</span> <span class="o">(</span><span class="n">expr.const</span> <span class="bp">`</span><span class="n">false</span> <span class="o">[]),</span>
   <span class="n">swap</span><span class="o">,</span> <span class="n">contradiction</span>
</code></pre></div>

<p><code>exfalso</code> calls <code>contradiction</code>, which fails at the first line, <code>try intro1</code>, because the state at that point is:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">state</span><span class="o">:</span>
<span class="mi">2</span> <span class="n">goals</span>
<span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">,</span>
<span class="n">Hfalse</span> <span class="o">:</span> <span class="n">false</span>
<span class="bp">⊢</span> <span class="n">k</span> <span class="bp">≤</span> <span class="mi">3524578</span>

<span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span>
<span class="bp">⊢</span> <span class="n">false</span>
</code></pre></div>

<p>so <code>intro1</code> is going to try to check if the goal is an implication, which will involve a whnf</p>



<a name="213124806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213124806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213124806">(Oct 13 2020 at 08:28)</a>:</h4>
<p>I mean for all lean knows at the bottom of the stack of definitions <code>nonneg</code> might unfold to <code>true -&gt; true</code> instead of <code>true</code></p>



<a name="213124965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213124965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213124965">(Oct 13 2020 at 08:30)</a>:</h4>
<p>for something like <code>try intro1</code> at the beginning of a more complicated tactic, it seems pretty obvious that lean wasn't supposed to try this hard, though. Probably <code>intro1</code> should have a transparency parameter</p>



<a name="213125109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125109">(Oct 13 2020 at 08:32)</a>:</h4>
<p>well, I got around it by making one lemma just not use any tactics</p>



<a name="213125116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125116">(Oct 13 2020 at 08:32)</a>:</h4>
<p>eventual proof in <a href="https://github.com/leanprover-community/mathlib/pull/4599">https://github.com/leanprover-community/mathlib/pull/4599</a></p>



<a name="213125203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125203">(Oct 13 2020 at 08:33)</a>:</h4>
<p>It's not specific to <code>exfalso</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.basic</span>

<span class="kd">lemma</span> <span class="n">foo</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">),</span> <span class="n">true</span><span class="o">)</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">≤</span> <span class="mi">1543678</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>

<p>fails in the same way.</p>



<a name="213125234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125234">(Oct 13 2020 at 08:34)</a>:</h4>
<p>You could just generalize the number...?</p>



<a name="213125286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125286">(Oct 13 2020 at 08:34)</a>:</h4>
<p>there is no need to have big numbers in your goal, just generalize them after establishing the requisite facts with <code>norm_num</code></p>



<a name="213125324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125324">(Oct 13 2020 at 08:35)</a>:</h4>
<p>hmm, well as it happens I am proving several lemmas about 3524578</p>



<a name="213125346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125346">(Oct 13 2020 at 08:35)</a>:</h4>
<p>I don't see how that changes anything</p>



<a name="213125357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125357">(Oct 13 2020 at 08:35)</a>:</h4>
<p>I guess I'm not sure what your suggestion is, exactly</p>



<a name="213125443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125443">(Oct 13 2020 at 08:36)</a>:</h4>
<p>rather than proving things about the number 2019 because the test writers think they are being clever, prove the theorem for all numbers satisfying a property</p>



<a name="213125504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125504">(Oct 13 2020 at 08:37)</a>:</h4>
<p>The Metamath library developed for over a decade without needing any numbers bigger than 12</p>



<a name="213125526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125526">(Oct 13 2020 at 08:37)</a>:</h4>
<p>numbers bigger than 12 are useful for a lot of things</p>



<a name="213125609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125609">(Oct 13 2020 at 08:38)</a>:</h4>
<p>It's not like the library didn't talk about natural numbers bigger than 12</p>



<a name="213125620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125620">(Oct 13 2020 at 08:38)</a>:</h4>
<p>it talks about the whole infinite family</p>



<a name="213125643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125643">(Oct 13 2020 at 08:38)</a>:</h4>
<p>sometimes you just want to know whether a particular fact is true about 3524578</p>



<a name="213125673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125673">(Oct 13 2020 at 08:39)</a>:</h4>
<p>it's almost always a better idea to generalize to the relevant fact about that number</p>



<a name="213125681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125681">(Oct 13 2020 at 08:39)</a>:</h4>
<p>true, this number is special because it's the sum of the squares of the two largest fibonacci numbers smaller than 1981</p>



<a name="213125698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125698">(Oct 13 2020 at 08:39)</a>:</h4>
<p>and why is 1981 special?</p>



<a name="213125707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125707">(Oct 13 2020 at 08:39)</a>:</h4>
<p>because it's in the problem statement</p>



<a name="213125754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125754">(Oct 13 2020 at 08:40)</a>:</h4>
<p>...because the test writers were being clever</p>



<a name="213125759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125759" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125759">(Oct 13 2020 at 08:40)</a>:</h4>
<p>yes</p>



<a name="213125776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125776">(Oct 13 2020 at 08:40)</a>:</h4>
<p>so now, generalize 1981 to n and tell me whether the theorem still holds</p>



<a name="213125786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125786">(Oct 13 2020 at 08:40)</a>:</h4>
<p>that's why when you are practicing for the IMO, you make sure to note any interesting properties of the current year</p>



<a name="213125795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125795">(Oct 13 2020 at 08:40)</a>:</h4>
<p>yes I know</p>



<a name="213125926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125926">(Oct 13 2020 at 08:42)</a>:</h4>
<p>Looking at the PR, it looks like the problem has the form determine M(n) where n = 1981. How about defining M(n) instead of M(1981) then?</p>



<a name="213125955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125955">(Oct 13 2020 at 08:42)</a>:</h4>
<p>I just don't understand why I would do that</p>



<a name="213125989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125989">(Oct 13 2020 at 08:43)</a>:</h4>
<p>I mean, as a workaround to avoid mentioning large numbers, it works, but there are easier workarounds</p>



<a name="213125998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213125998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213125998">(Oct 13 2020 at 08:43)</a>:</h4>
<p>because it will make the file compile much faster, and it will also make the file actually prove something useful instead of just being a cute and useless fact</p>



<a name="213126017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126017">(Oct 13 2020 at 08:43)</a>:</h4>
<p>it's still not useful at all when you replace 1981 with n</p>



<a name="213126301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126301">(Oct 13 2020 at 08:46)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Determine</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">value</span> <span class="n">of</span> <span class="bp">`</span><span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">+</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span><span class="bp">`</span><span class="o">,</span> <span class="n">where</span> <span class="bp">`</span><span class="n">m</span><span class="bp">`</span> <span class="n">and</span> <span class="bp">`</span><span class="n">n</span><span class="bp">`</span> <span class="n">are</span> <span class="n">integers</span> <span class="k">in</span>
<span class="bp">`</span><span class="o">{</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="bp">...</span><span class="o">,</span> <span class="mi">1981</span><span class="o">}</span><span class="bp">`</span> <span class="n">and</span> <span class="bp">`</span><span class="o">(</span><span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">-</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span><span class="bp">`.</span>
<span class="n">The</span> <span class="n">trick</span> <span class="n">to</span> <span class="n">this</span> <span class="n">problem</span> <span class="n">is</span> <span class="n">that</span> <span class="bp">`</span><span class="n">m</span><span class="bp">`</span> <span class="n">and</span> <span class="bp">`</span><span class="n">n</span><span class="bp">`</span> <span class="k">have</span> <span class="n">to</span> <span class="n">be</span> <span class="n">consecutive</span> <span class="n">Fibonacci</span> <span class="n">numbers</span><span class="o">,</span>
<span class="n">because</span> <span class="n">you</span> <span class="n">can</span> <span class="n">reduce</span> <span class="n">any</span> <span class="n">solution</span> <span class="n">to</span> <span class="n">a</span> <span class="n">smaller</span> <span class="n">one</span> <span class="n">using</span> <span class="n">the</span> <span class="n">Fibonacci</span> <span class="n">recurrence.</span>
</code></pre></div>

<p>this looks like a useful observation. Why not extract it as a lemma?</p>



<a name="213126336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126336">(Oct 13 2020 at 08:47)</a>:</h4>
<p>that basically is the <code>pp_reduction</code> lemma</p>



<a name="213126361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126361">(Oct 13 2020 at 08:47)</a>:</h4>
<p>I'm not understanding why to generalize this IMO problem -- I know why as a mathematician, but it seems like this IMO folder is for formalizations of solutions to IMO problems.  You wouldn't expect a test-taker to give a full solution to the generalized problem.</p>



<a name="213126459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126459">(Oct 13 2020 at 08:48)</a>:</h4>
<p>I know that this number abstraction method is very useful in physics problems. You are given a problem statement with a bunch of numbers, and rather than doing intermediate calculations the first thing you do is replace all the numbers in the input with variables, solve the whole problem, then plug and chug at the end</p>



<a name="213126555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126555">(Oct 13 2020 at 08:49)</a>:</h4>
<p>the thing is that if you generalize this problem, you have to define a bunch of awkward functions like "the largest fibonacci number less than x". and then prove things about them. but if you just stick with 1981 then you can skip a bunch of that</p>



<a name="213126568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126568">(Oct 13 2020 at 08:49)</a>:</h4>
<p>It's not even about getting a more general result, although that often happens as a side effect. It's about localizing the calculator stuff to one small part and doing algebra with letters</p>



<a name="213126658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126658">(Oct 13 2020 at 08:50)</a>:</h4>
<p>No, you just need a number <code>m</code> (the answer) that relates to <code>n</code> (the year) in some way</p>



<a name="213126689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126689">(Oct 13 2020 at 08:50)</a>:</h4>
<p>that way <em>is</em> the largest pair of fibonacci numbers less than the current year</p>



<a name="213126699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126699">(Oct 13 2020 at 08:51)</a>:</h4>
<p>it's not a function, it's a relation, the collection of all numerical properties between the numbers that you need a calculator for</p>



<a name="213126753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213126753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213126753">(Oct 13 2020 at 08:51)</a>:</h4>
<p>If you can write it as <code>m = f(n)</code> then that's even better but it's not a necessity</p>



<a name="213127093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213127093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213127093">(Oct 13 2020 at 08:54)</a>:</h4>
<p>In fact, it looks like you are using a property of monotone functions that <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> pointed out in the question about <code>n ^ 3 != 2</code>, where the <code>fib</code> function sandwiches <code>1981</code> at <code>fib 17</code> and <code>fib 18</code></p>



<a name="213128686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213128686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213128686">(Oct 13 2020 at 09:11)</a>:</h4>
<p>That would be <code>ne_of_monotone_of_lt_of_lt</code> from <a href="https://github.com/leanprover-community/mathlib/issues/4482">#4482</a></p>



<a name="213132083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213132083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213132083">(Oct 13 2020 at 09:47)</a>:</h4>
<p><code>int.le</code> is made irreducible in <a href="https://github.com/leanprover-community/mathlib/issues/4601">#4601</a></p>



<a name="213132641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213132641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213132641">(Oct 13 2020 at 09:53)</a>:</h4>
<p>I pushed a commit to the IMO 1981-Q3 PR that implements the <code>N = 1981</code> generalization, without rewriting too much of the rest of the formalization.</p>



<a name="213234011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213234011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph Myers <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213234011">(Oct 14 2020 at 00:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113489-new-members/topic/timeout.20in.20.60cases.60/near/213126361">said</a>:</p>
<blockquote>
<p>I'm not understanding why to generalize this IMO problem -- I know why as a mathematician, but it seems like this IMO folder is for formalizations of solutions to IMO problems.  You wouldn't expect a test-taker to give a full solution to the generalized problem.</p>
</blockquote>
<p>I think the idea is that, for whatever reason, formalizing a more general result can end up being easier than formalizing a more specific result, even if no-one is going to have any use for the general result beyond proving the specific one (because the general one is still only relevant to this one problem, so isn't going in the main part of mathlib). That is, "prove the most general result that your argument gives, and then apply it to the specific case" is a formalization trick just like "use this tactic" or "write lots of small lemmas rather than one big proof"; a way in which the things that work best in formalization differ from what's convenient in informal mathematics. (Note that "the most general result that your argument gives" may well be less general than the most general version of the problem that's actually true.)</p>



<a name="213234285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213234285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213234285">(Oct 14 2020 at 00:29)</a>:</h4>
<p>The discussion reminds me of <a href="https://mathoverflow.net/questions/40005/generalizing-a-problem-to-make-it-easier">this classic MathOverflow post</a>.</p>



<a name="213234379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/timeout%20in%20%60cases%60/near/213234379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joseph Myers <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/timeout.20in.20.60cases.60.html#213234379">(Oct 14 2020 at 00:30)</a>:</h4>
<p>Yes, it's a useful trick in informal mathematics, it just seems more often useful in formalization.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>