---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/inner.20product.20on.20subspaces.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html">inner product on subspaces</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="212401459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212401459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212401459">(Oct 06 2020 at 09:05)</a>:</h4>
<p>I want to have 'inheritance' of the real inner product structure of my E , but run into a problem I cant figure out. Here is my context and the code for defining the inner product from .core:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module</span>
<span class="kn">import</span> <span class="n">linear_algebra.basic</span>
<span class="kn">import</span> <span class="n">analysis.normed_space.real_inner_product</span>
<span class="c1">-- import data.complex.is_R_or_C</span>
<span class="kn">import</span> <span class="n">tactic</span>


<span class="kd">noncomputable theory</span>

<span class="n">open_locale</span> <span class="n">big_operators</span> <span class="n">classical</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">ι</span>  <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">inner_product_space</span> <span class="n">E</span><span class="o">]</span>


<span class="kd">variable</span> <span class="o">(</span><span class="n">K</span><span class="o">:</span> <span class="n">submodule</span> <span class="n">ℝ</span> <span class="n">E</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">inner_product_space</span> <span class="n">K</span> <span class="o">:=</span>
<span class="n">inner_product_space.of_core</span>
<span class="o">{</span>
  <span class="n">inner</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">v</span> <span class="n">w</span><span class="o">,</span> <span class="bp">⟪</span><span class="o">(</span><span class="n">v</span><span class="o">:</span><span class="n">E</span><span class="o">)</span> <span class="o">,(</span><span class="n">w</span><span class="o">:</span><span class="n">E</span><span class="o">)</span> <span class="bp">⟫</span><span class="o">,</span>
  <span class="n">comm</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">inner_comm</span> <span class="n">_</span> <span class="n">_</span> <span class="o">,</span>
  <span class="n">nonneg</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">inner_self_nonneg</span><span class="o">,</span>
  <span class="n">definite</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span><span class="n">intros</span> <span class="n">x</span> <span class="n">h</span><span class="o">,</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">inner_self_eq_zero.mp</span> <span class="n">h</span><span class="o">,</span> <span class="n">simp</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span> <span class="n">exact</span> <span class="n">this</span><span class="o">,},</span>
  <span class="n">add_left</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span><span class="n">inner_add_left</span><span class="o">,</span>
  <span class="n">smul_left</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="o">,</span> <span class="n">inner_smul_left</span><span class="o">,</span>
<span class="o">}</span>
</code></pre></div>

<p>I get the following error message in vscode, with the <code>:</code> after <code>instance</code> highlilghted as the offender:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="kd">instance</span> <span class="n">name</span><span class="o">,</span> <span class="n">name</span> <span class="n">should</span> <span class="n">be</span> <span class="n">provided</span> <span class="n">explicitly</span>
</code></pre></div>

<p>Is there an alternative, more straightforward way to have submodules recognized as inner product spaces?</p>



<a name="212401833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212401833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212401833">(Oct 06 2020 at 09:09)</a>:</h4>
<p>According to that error message, all you have to do is provide an explicit name, like<br>
<code>instance submodule_inner_product_space : inner_product_space K := ...</code></p>



<a name="212401975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212401975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212401975">(Oct 06 2020 at 09:11)</a>:</h4>
<p><code>instance</code> is like a <code>def</code> that doesn't always need a name and that lets the typeclass resolution system know this definition exists.</p>



<a name="212402794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212402794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212402794">(Oct 06 2020 at 09:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212401833">said</a>:</p>
<blockquote>
<p>According to that error message, all you have to do is provide an explicit name, like<br>
<code>instance submodule_inner_product_space : inner_product_space K := ...</code></p>
</blockquote>
<p>Thanks. I also realized that if enclosed in a namespace, it goes away!</p>
<p>But is this the way to ensure that in a lemma, every submodule used  has the inherited inner product? what invocation is required?</p>



<a name="212406186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212406186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212406186">(Oct 06 2020 at 09:58)</a>:</h4>
<p>It looks to me like the code you have already does that</p>



<a name="212430041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212430041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212430041">(Oct 06 2020 at 13:50)</a>:</h4>
<p><span class="user-mention" data-user-id="310419">@Busiso Chisala</span> Yes, once you have defined this instance, it should be picked up automatically for all submodules!</p>
<p>By the way, it would be nice to have this in mathlib, maybe you could contribute it!  <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.normed_space">docs#submodule.normed_space</a> does exist, but this one is missing, right? <span class="user-mention" data-user-id="266253">@Joseph Myers</span> <span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span></p>



<a name="212432754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212432754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212432754">(Oct 06 2020 at 14:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212430041">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="310419">Busiso Chisala</span> Yes, once you have defined this instance, it should be picked up automatically for all submodules!</p>
<p>By the way, it would be nice to have this in mathlib, maybe you could contribute it!  <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.normed_space">docs#submodule.normed_space</a> does exist, but this one is missing, right? <span class="user-mention silent" data-user-id="266253">Joseph Myers</span> <span class="user-mention silent" data-user-id="214703">Yury G. Kudryashov</span></p>
</blockquote>
<p>Thanks for pointing out that @instance, which is the kind I wanted. But when I comment my code out,  Lean gets upset. Are you suggesting a way around this, using that reference?</p>
<p>And while I have your attention: how do I 'lift' a map?  I have this scenario: submodules <code>F ≤ K</code>,  map <code>w: fin (k + 1) → ↥F </code> and <code>e: ↥K</code>. All I want is to get  <code>v: fin (k+2) → K</code> by extending <code>w</code> with the value <code>e</code> (I guess best at the end).  Why does this fail?:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="k">let</span> <span class="n">v</span><span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">2</span><span class="o">)</span> <span class="bp">→</span> <span class="n">K</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span><span class="o">:(</span><span class="n">i</span> <span class="bp">≠</span> <span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="k">then</span> <span class="o">(</span><span class="n">w</span>  <span class="o">(</span><span class="n">fin.pred_above</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">i</span> <span class="n">h</span> <span class="o">)):</span><span class="n">K</span> <span class="k">else</span> <span class="n">e</span><span class="o">,</span>
</code></pre></div>

<p>the returned error is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">dite</span> <span class="o">(</span><span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">w</span> <span class="o">((</span><span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">pred_above</span> <span class="n">i</span> <span class="n">h</span><span class="o">))</span>
<span class="n">term</span>
  <span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">w</span> <span class="o">((</span><span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">pred_above</span> <span class="n">i</span> <span class="n">h</span><span class="o">)</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">→</span> <span class="bp">↥</span><span class="n">F</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">→</span> <span class="bp">↥</span><span class="n">K</span>
</code></pre></div>



<a name="212433266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212433266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212433266">(Oct 06 2020 at 14:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310419">Busiso Chisala</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212432754">said</a>:</p>
<blockquote>
<p>Thanks for pointing out that @instance, which is the kind I wanted. But when I comment my code out,  Lean gets upset. Are you suggesting a way around this, using that reference?</p>
</blockquote>
<p>No, I wasn't suggesting that the normed space instance could replace your code for the inner product space instance (since the normed space instance is strictly weaker).  I was just checking what the closest existing thing was -- if <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.normed_space">docs#submodule.normed_space</a> had not existed, I would have suggested you write that too and contribute them both!</p>



<a name="212434010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212434010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212434010">(Oct 06 2020 at 14:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310419">Busiso Chisala</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212432754">said</a>:</p>
<blockquote>
<p>And while I have your attention: how do I 'lift' a map?  I have this scenario: submodules <code>F ≤ K</code>,  map <code>w: fin (k + 1) → ↥F </code> and <code>e: ↥K</code>. All I want is to get  <code>v: fin (k+2) → K</code> by extending <code>w</code> with the value <code>e</code> (I guess best at the end).  Why does this fail?:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="k">let</span> <span class="n">v</span><span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">2</span><span class="o">)</span> <span class="bp">→</span> <span class="n">K</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span><span class="o">:(</span><span class="n">i</span> <span class="bp">≠</span> <span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="k">then</span> <span class="o">(</span><span class="n">w</span>  <span class="o">(</span><span class="n">fin.pred_above</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">i</span> <span class="n">h</span> <span class="o">)):</span><span class="n">K</span> <span class="k">else</span> <span class="n">e</span><span class="o">,</span>
</code></pre></div>

<p>the returned error is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">dite</span> <span class="o">(</span><span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">w</span> <span class="o">((</span><span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">pred_above</span> <span class="n">i</span> <span class="n">h</span><span class="o">))</span>
<span class="n">term</span>
  <span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">w</span> <span class="o">((</span><span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">pred_above</span> <span class="n">i</span> <span class="n">h</span><span class="o">)</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">→</span> <span class="bp">↥</span><span class="n">F</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">→</span> <span class="bp">↥</span><span class="n">K</span>
</code></pre></div>

</blockquote>
<p>Try this:  You have a hypothesis somewhere that tells you <code>e</code> is in K, right?  Let's call it <code>he</code>.  Can you use <code> else e, ⟨e, he⟩</code>?  (An element of K is an element of E together with a witness that that element is in K.)</p>



<a name="212435757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212435757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212435757">(Oct 06 2020 at 14:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212434010">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="310419">Busiso Chisala</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212432754">said</a>:</p>
<blockquote>
<p>And while I have your attention: how do I 'lift' a map?  I have this scenario: submodules <code>F ≤ K</code>,  map <code>w: fin (k + 1) → ↥F </code> and <code>e: ↥K</code>. All I want is to get  <code>v: fin (k+2) → K</code> by extending <code>w</code> with the value <code>e</code> (I guess best at the end).  Why does this fail?:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="k">let</span> <span class="n">v</span><span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">2</span><span class="o">)</span> <span class="bp">→</span> <span class="n">K</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span><span class="o">:(</span><span class="n">i</span> <span class="bp">≠</span> <span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="k">then</span> <span class="o">(</span><span class="n">w</span>  <span class="o">(</span><span class="n">fin.pred_above</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">i</span> <span class="n">h</span> <span class="o">)):</span><span class="n">K</span> <span class="k">else</span> <span class="n">e</span><span class="o">,</span>
</code></pre></div>

<p>the returned error is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">dite</span> <span class="o">(</span><span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">w</span> <span class="o">((</span><span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">pred_above</span> <span class="n">i</span> <span class="n">h</span><span class="o">))</span>
<span class="n">term</span>
  <span class="bp">λ</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">w</span> <span class="o">((</span><span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">pred_above</span> <span class="n">i</span> <span class="n">h</span><span class="o">)</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">→</span> <span class="bp">↥</span><span class="n">F</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">i</span> <span class="bp">≠</span> <span class="bp">↑</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">→</span> <span class="bp">↥</span><span class="n">K</span>
</code></pre></div>

</blockquote>
<p>Try this:  You have a hypothesis somewhere that tells you <code>e</code> is in K, right?  Let's call it <code>he</code>.  Can you use <code> else e, ⟨e, he⟩</code>?  (An element of K is an element of E together with a witness that that element is in K.)</p>
</blockquote>
<p>Not really, <code>e</code> came from an existential so appears as <code>e:↥K</code>. Witness enough?  I do think the trouble is my failed 'coercion'  into K, since w certainly maps into the subspace F ... no? It fails even with humble 0 (or (0:K)) . I 'checked' the rest of the syntax (I believe) by replacing K with F as target, and e with 0. That worked, but is not what I need :(</p>



<a name="212436576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212436576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212436576">(Oct 06 2020 at 14:35)</a>:</h4>
<p>For debugging at least, you can try to split <code>e</code> into its pieces.  Some experiments to try:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">let</span> <span class="n">e'</span> <span class="o">:</span> <span class="n">E</span> <span class="o">:=</span> <span class="n">e.1</span><span class="o">,</span> <span class="c1">-- or = e,</span>
<span class="k">let</span> <span class="n">he'</span> <span class="o">:</span> <span class="n">e</span> <span class="bp">\</span><span class="k">in</span> <span class="n">K</span> <span class="o">:=</span> <span class="n">e.2</span><span class="o">,</span>
<span class="c1">-- alternately,</span>
<span class="n">obtain</span> <span class="o">⟨</span><span class="n">e'</span><span class="o">,</span> <span class="n">he'</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">e</span><span class="o">,</span>
</code></pre></div>

<p>(these should be doing roughly the same thing, but I'm providing different variants in case one doesn't work)</p>



<a name="212439368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212439368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212439368">(Oct 06 2020 at 14:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212436576">said</a>:</p>
<blockquote>
<p>For debugging at least, you can try to split <code>e</code> into its pieces.  Some experiments to try:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">let</span> <span class="n">e'</span> <span class="o">:</span> <span class="n">E</span> <span class="o">:=</span> <span class="n">e.1</span><span class="o">,</span> <span class="c1">-- or = e,</span>
<span class="k">let</span> <span class="n">he'</span> <span class="o">:</span> <span class="n">e</span> <span class="bp">\</span><span class="k">in</span> <span class="n">K</span> <span class="o">:=</span> <span class="n">e.2</span><span class="o">,</span>
<span class="c1">-- alternately,</span>
<span class="n">obtain</span> <span class="o">⟨</span><span class="n">e'</span><span class="o">,</span> <span class="n">he'</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">e</span><span class="o">,</span>
</code></pre></div>

<p>(these should be doing roughly the same thing, but I'm providing different variants in case one doesn't work)</p>
</blockquote>
<p>Great. I have never seen <code>obtain</code> before. Very illuminating.  It splits <code>e</code> indeed. And I don't think the trouble is there.  <code>obtain ⟨w0', hw0'⟩  := (w 0),</code> reveals what I am failing to get over: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">w0'</span><span class="o">:</span> <span class="n">E</span>
<span class="n">hw0'</span><span class="o">:</span> <span class="n">w0'</span> <span class="bp">∈</span> <span class="n">F</span>
</code></pre></div>

<p>I thought that by simply writing <code>(w 0):K</code> [as in the code], I could coax the value of w into the containing K ... how do I do that? recombine each value of w ...?</p>



<a name="212439972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212439972" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212439972">(Oct 06 2020 at 14:58)</a>:</h4>
<p>At a low level, you need to combine <code>hw0': w0' ∈ F</code> with your hypothesis that <code>F</code> is a submodule of <code>K</code>. It won't just be a coercion.</p>



<a name="212440071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212440071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212440071">(Oct 06 2020 at 14:59)</a>:</h4>
<p>At a higher level, there's likely to be some kind of <code>submodule.incl</code> or something that provides a map <code>F -&gt; K</code> for you.</p>



<a name="212443169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212443169" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212443169">(Oct 06 2020 at 15:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212439972">said</a>:</p>
<blockquote>
<p>At a low level, you need to combine <code>hw0': w0' ∈ F</code> with your hypothesis that <code>F</code> is a submodule of <code>K</code>. It won't just be a coercion.</p>
</blockquote>
<p>So just to do it the "low level" way for now:  now that you have a hypothesis <code>hw0': w0' ∈ F</code> and a hypothesis that  <code>F</code> is a submodule of <code>K</code>, you can probably get <code>hw0'' : w0' ∈ K</code>by library_search.</p>



<a name="212444606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212444606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212444606">(Oct 06 2020 at 15:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212443169">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212439972">said</a>:</p>
<blockquote>
<p>At a low level, you need to combine <code>hw0': w0' ∈ F</code> with your hypothesis that <code>F</code> is a submodule of <code>K</code>. It won't just be a coercion.</p>
</blockquote>
<p>So just to do it the "low level" way for now:  now that you have a hypothesis <code>hw0': w0' ∈ F</code> and a hypothesis that  <code>F</code> is a submodule of <code>K</code>, you can probably get <code>hw0'' : w0' ∈ K</code>by library_search.</p>
</blockquote>
<p>Thank you so kindly ... I think I'm almost there. Surprisingly awkward, Isn't this an obvious thing ?</p>



<a name="212449857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212449857" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212449857">(Oct 06 2020 at 16:07)</a>:</h4>
<p>You learn the tricks as time goes on</p>



<a name="212450004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212450004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212450004">(Oct 06 2020 at 16:08)</a>:</h4>
<p>Just keep doing projects and writing mathematics in lean and it doesn't take long to pick up the core tricks</p>



<a name="212454210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212454210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212454210">(Oct 06 2020 at 16:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212449857">said</a>:</p>
<blockquote>
<p>You learn the tricks as time goes on</p>
</blockquote>
<p>like this? ...</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">let</span> <span class="n">incl</span><span class="o">:</span> <span class="n">F</span> <span class="bp">→</span> <span class="n">K</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">⟨</span><span class="n">x.1</span><span class="o">,</span> <span class="n">f2k</span> <span class="n">x.2</span><span class="o">⟩,</span>
<span class="k">let</span> <span class="n">v</span><span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">2</span><span class="o">)</span> <span class="bp">→</span> <span class="n">K</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="k">if</span> <span class="n">h</span><span class="o">:(</span><span class="n">i</span> <span class="bp">≠</span> <span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="k">then</span> <span class="n">incl</span> <span class="o">(</span><span class="n">w</span>  <span class="o">(</span><span class="n">fin.pred_above</span> <span class="o">(</span><span class="n">k</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="n">i</span> <span class="n">h</span> <span class="o">))</span> <span class="k">else</span> <span class="n">e</span><span class="o">,</span>
</code></pre></div>

<p>I am dreading showing this has the desired properties :(<br>
(where <code>f2k: F ≤ K</code>, of course)</p>



<a name="212475279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212475279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frédéric Dupuis <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212475279">(Oct 06 2020 at 19:41)</a>:</h4>
<p>That looks like a statement we would definitely want in mathlib! If you're planning to PR it, I would suggest doing it for <code>submodule 𝕜 E</code> where <code>𝕜</code> is an <code>[is_R_or_C 𝕜]</code>; this way we get the statement for both the real and complex case at the same time.</p>



<a name="212499157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212499157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212499157">(Oct 06 2020 at 23:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212440071">said</a>:</p>
<blockquote>
<p>At a higher level, there's likely to be some kind of <code>submodule.incl</code> or something that provides a map <code>F -&gt; K</code> for you.</p>
</blockquote>
<p>So does this exist?  In the simplest possible context, given <code>s t : set X</code>, with a hypothesis that <code>s</code> is a subset of <code>t</code>, do we have the induced map <code>s → t</code> (when both have been promoted to types)?</p>



<a name="212499211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212499211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212499211">(Oct 06 2020 at 23:38)</a>:</h4>
<p>Likewise for subgroups, submodules, ...</p>



<a name="212499715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212499715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212499715">(Oct 06 2020 at 23:46)</a>:</h4>
<p>Isn't that just the coe from subtype to parent type?</p>



<a name="212502245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212502245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212502245">(Oct 07 2020 at 00:18)</a>:</h4>
<p><span class="user-mention" data-user-id="308899">@Yakov Pechersky</span> What do you mean exactly?  Coercion will turn an <code>s</code> object to an <code>X</code> object, not to a <code>t</code> object.  See thread above.</p>



<a name="212502624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212502624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212502624">(Oct 07 2020 at 00:25)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/set.inclusion">docs#set.inclusion</a></p>



<a name="212502722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212502722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212502722">(Oct 07 2020 at 00:26)</a>:</h4>
<p>Ah good!  I also find <a href="https://leanprover-community.github.io/mathlib_docs/find/subring.inclusion">docs#subring.inclusion</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/submonoid.inclusion">docs#submonoid.inclusion</a></p>



<a name="212502763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212502763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212502763">(Oct 07 2020 at 00:27)</a>:</h4>
<p><span class="user-mention" data-user-id="310419">@Busiso Chisala</span> would need <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.inclusion">docs#submodule.inclusion</a>, which doesn't currently exist.</p>



<a name="212502877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212502877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212502877">(Oct 07 2020 at 00:28)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/subgroup.inclusion">docs#subgroup.inclusion</a> also missing, I'm not sure whether or not it is magically inherited from submonoids.</p>



<a name="212503006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212503006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212503006">(Oct 07 2020 at 00:31)</a>:</h4>
<p>It looks like you'd have to use <code>to_submonoid</code> and then use some lemma to turn the coercion of <code>to_submonoid</code> of the subgroup into the coercion of the subgroup, since <code>submonoid</code> and <code>subgroup</code> are structures and not classes.</p>



<a name="212503077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212503077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212503077">(Oct 07 2020 at 00:32)</a>:</h4>
<p>I think <span class="user-mention" data-user-id="246273">@Bhavik Mehta</span> mentioned a couple weeks ago that there was a category of the lattice of subobjects that got added to mathlib. That would include all the induced maps from inclusion, I think</p>



<a name="212503545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212503545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212503545">(Oct 07 2020 at 00:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212503006">said</a>:</p>
<blockquote>
<p>It looks like you'd have to use <code>to_submonoid</code> and then use some lemma to turn the coercion of <code>to_submonoid</code> of the subgroup into the coercion of the subgroup, since <code>submonoid</code> and <code>subgroup</code> are structures and not classes.</p>
</blockquote>
<p>Yes, it might be better to just construct <code>subgroup.inclusion</code> directly rather than trying to inherit something from monoids.  Don't know if it's the correct analogy, but this is what's done for fields (no attempt to inherit from rings):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">inclusion</span> <span class="o">{</span><span class="n">S</span> <span class="n">T</span> <span class="o">:</span> <span class="n">subfield</span> <span class="n">K</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">S</span> <span class="bp">≤</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">S</span> <span class="bp">→+*</span> <span class="n">T</span> <span class="o">:=</span>
<span class="n">S.subtype.cod_restrict_field</span> <span class="n">_</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">h</span> <span class="n">x.2</span><span class="o">)</span>
</code></pre></div>



<a name="212503610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212503610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212503610">(Oct 07 2020 at 00:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212503077">said</a>:</p>
<blockquote>
<p>I think <span class="user-mention silent" data-user-id="246273">Bhavik Mehta</span> mentioned a couple weeks ago that there was a category of the lattice of subobjects that got added to mathlib. That would include all the induced maps from inclusion, I think</p>
</blockquote>
<p>It's not in yet, I've got it in a repo but not yet in mathlib, I can prioritise that if it'd help though. That said I think it wouldn't make this a lot easier, since you'd have to go through all the category theory machinery</p>



<a name="212503715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212503715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212503715">(Oct 07 2020 at 00:45)</a>:</h4>
<p>I would like to propose instead that <span class="user-mention" data-user-id="310419">@Busiso Chisala</span> make a 4-line PR for <code>subgroup.inclusion</code> and <code>submodule.inclusion</code> <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span> </p>
<p>(If you have time!  Here's how: <a href="https://leanprover-community.github.io/contribute/index.html">https://leanprover-community.github.io/contribute/index.html</a> , and anyone here will be happy to answer questions.)</p>



<a name="212523275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212523275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212523275">(Oct 07 2020 at 07:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212503545">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212503006">said</a>:</p>
<blockquote>
<p>It looks like you'd have to use <code>to_submonoid</code> and then use some lemma to turn the coercion of <code>to_submonoid</code> of the subgroup into the coercion of the subgroup, since <code>submonoid</code> and <code>subgroup</code> are structures and not classes.</p>
</blockquote>
<p>Yes, it might be better to just construct <code>subgroup.inclusion</code> directly rather than trying to inherit something from monoids.  Don't know if it's the correct analogy, but this is what's done for fields (no attempt to inherit from rings):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">inclusion</span> <span class="o">{</span><span class="n">S</span> <span class="n">T</span> <span class="o">:</span> <span class="n">subfield</span> <span class="n">K</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">S</span> <span class="bp">≤</span> <span class="n">T</span><span class="o">)</span> <span class="o">:</span> <span class="n">S</span> <span class="bp">→+*</span> <span class="n">T</span> <span class="o">:=</span>
<span class="n">S.subtype.cod_restrict_field</span> <span class="n">_</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">h</span> <span class="n">x.2</span><span class="o">)</span>
</code></pre></div>

</blockquote>
<p>This is exactly what I need. Having defined my <code>incl</code> map, I realized that I actually need a monomorphism. I have yet to do that (easy enough) but thus far here is my ugly demonstration of injectivity:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code> <span class="k">let</span> <span class="n">incl</span><span class="o">:</span> <span class="n">F</span> <span class="bp">→</span> <span class="n">K</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">⟨</span><span class="n">x.1</span><span class="o">,</span> <span class="n">f2k</span> <span class="n">x.2</span><span class="o">⟩,</span>
  <span class="c1">-- verify some properties</span>
  <span class="k">have</span> <span class="n">incl_inj</span><span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">F</span><span class="o">,</span> <span class="n">incl</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">incl</span> <span class="n">b</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span>
    <span class="n">intros</span> <span class="n">a</span> <span class="n">b</span> <span class="n">cond</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">one</span><span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,(</span><span class="n">incl</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">val</span> <span class="bp">=</span> <span class="n">x.val</span><span class="o">:=</span> <span class="kd">by</span><span class="o">{</span> <span class="n">intro</span> <span class="n">a</span><span class="o">,</span><span class="n">simp</span> <span class="o">[</span><span class="n">incl</span><span class="o">],},</span>
    <span class="k">have</span> <span class="n">two</span> <span class="o">:</span> <span class="o">(</span><span class="n">incl</span> <span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="n">val</span> <span class="bp">=</span> <span class="o">(</span><span class="n">incl</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">val</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">cond</span><span class="o">,},</span>
    <span class="k">have</span> <span class="n">onea</span><span class="o">:=</span> <span class="n">one</span> <span class="n">a</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">oneb</span> <span class="o">:=</span> <span class="n">one</span> <span class="n">b</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="n">a.val</span> <span class="bp">=</span> <span class="n">b.val</span> <span class="o">:=</span> <span class="n">eq.trans</span> <span class="o">(</span><span class="n">eq.trans</span> <span class="n">onea.symm</span> <span class="n">two</span><span class="o">)</span> <span class="n">oneb</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">subtype.eq</span> <span class="n">two</span><span class="o">,},</span>
</code></pre></div>

<p>excuse the absence of lambdas :)</p>



<a name="212524007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212524007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212524007">(Oct 07 2020 at 07:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="311453">Frédéric Dupuis</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212475279">said</a>:</p>
<blockquote>
<p>That looks like a statement we would definitely want in mathlib! If you're planning to PR it, I would suggest doing it for <code>submodule 𝕜 E</code> where <code>𝕜</code> is an <code>[is_R_or_C 𝕜]</code>; this way we get the statement for both the real and complex case at the same time.</p>
</blockquote>
<p>This was my original plan, even though I'm only interested in the real field. But my headers simply wouldn't run! Here was where I started:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module</span>
<span class="kn">import</span> <span class="n">linear_algebra.basic</span>
<span class="kn">import</span> <span class="n">data.complex.is_R_or_C</span>
<span class="kn">import</span> <span class="n">analysis.normed_space.real_inner_product</span>

<span class="kd">noncomputable theory</span>

<span class="c1">-- open is_R_or_C real</span>
<span class="n">open_locale</span> <span class="n">big_operators</span> <span class="n">classical</span>

<span class="kd">variables</span> <span class="o">{</span><span class="bp">𝕜</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">is_R_or_C</span> <span class="bp">𝕜</span><span class="o">]</span>  <span class="o">[</span><span class="n">inner_product_space</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span>
</code></pre></div>

<p>And Lean complained about classes ..</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="bp">𝕜</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">,</span>
<span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span>
<span class="bp">⊢</span> <span class="n">nondiscrete_normed_field</span> <span class="bp">𝕜</span>
</code></pre></div>

<p>So I abandoned that route, once I saw that the old style was fussless. Where did I mess up?</p>



<a name="212524295"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212524295" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212524295">(Oct 07 2020 at 07:46)</a>:</h4>
<p>This looks like an outdated mathlib. You shouldn't have analysis.normed_space.real_inner_product nowadays</p>



<a name="212524648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212524648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212524648">(Oct 07 2020 at 07:51)</a>:</h4>
<p>I don't know what you want to do because I didn't follow this thread, but the lines you posted above compile just fine on an up to date mathlib as long as you replace <code>import analysis.normed_space.real_inner_product</code> by <code>import analysis.normed_space.inner_product</code>.</p>



<a name="212536040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212536040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212536040">(Oct 07 2020 at 09:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212524648">said</a>:</p>
<blockquote>
<p>I don't know what you want to do because I didn't follow this thread, but the lines you posted above compile just fine on an up to date mathlib as long as you replace <code>import analysis.normed_space.real_inner_product</code> by <code>import analysis.normed_space.inner_product</code>.</p>
</blockquote>
<p>Thanks. This is the fix I wanted. I don't think my mathlib is dated - I only recently started.</p>
<p>I take that back. It wont compile, cant find the stuff. What do I do about my mathlib?</p>



<a name="212539360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212539360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212539360">(Oct 07 2020 at 10:27)</a>:</h4>
<p><code>leanproject upgrade-mathlib</code></p>



<a name="212539369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212539369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212539369">(Oct 07 2020 at 10:27)</a>:</h4>
<p>(or just <code>leanproject up</code> for short)</p>



<a name="212539380"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212539380" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212539380">(Oct 07 2020 at 10:27)</a>:</h4>
<p>This assumes that you followed the <a href="https://leanprover-community.github.io/get_started.html#regular-install">#install</a> instructions.</p>



<a name="212539486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212539486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212539486">(Oct 07 2020 at 10:28)</a>:</h4>
<p>If you're working in a branch on mathlib, rather than in a project with mathlib as a dependency, then instead you need <code>git merge master</code>.</p>



<a name="212539713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212539713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212539713">(Oct 07 2020 at 10:31)</a>:</h4>
<p>(mathlib changes about 20 times each day at the moment, so "out of date" is almost certain :-)</p>



<a name="212556035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212556035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212556035">(Oct 07 2020 at 13:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212539380">said</a>:</p>
<blockquote>
<p>This assumes that you followed the <a href="https://leanprover-community.github.io/get_started.html#regular-install">#install</a> instructions.</p>
</blockquote>
<p>I'm pretty sure that I did. I have upgraded mathlib and went back and did so a second time, because nothing changed except the substantial download. My project only recognizes <code>import analysis.normed_space.real_inner_product </code> as a normed space import. No idea.</p>



<a name="212560686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212560686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212560686">(Oct 07 2020 at 13:49)</a>:</h4>
<p>Can you directly open up the folder <code>src/analysis/normed_space/...</code> and see the names of the files listed there?</p>



<a name="212561575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212561575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212561575">(Oct 07 2020 at 13:55)</a>:</h4>
<p>Older versions of leanproject can leave oleans  behind, and imports work if the olean is still there</p>



<a name="212561803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212561803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212561803">(Oct 07 2020 at 13:57)</a>:</h4>
<p>If I have weirdness like this going on I usually manually delete all the olean files and then put the correct ones back with leanproject get-cache (they will be backed up locally)</p>



<a name="212561954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212561954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212561954">(Oct 07 2020 at 13:58)</a>:</h4>
<p>Make sure your mathlib is up to date and your leanproject</p>



<a name="212562076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212562076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212562076">(Oct 07 2020 at 13:59)</a>:</h4>
<p>By the way, for more specific help you should clarify whether you are working with a clone of mathlib or with a project which has mathlib as a dependency</p>



<a name="212564550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212564550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212564550">(Oct 07 2020 at 14:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="260507">Heather Macbeth</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212560686">said</a>:</p>
<blockquote>
<p>Can you directly open up the folder <code>src/analysis/normed_space/...</code> and see the names of the files listed there?</p>
</blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>    <span class="bp">-</span><span class="n">rw</span><span class="bp">-</span><span class="n">r</span><span class="c1">--r--    1 busiso   busiso     74232 Oct  7 13:17 inner_product.lean</span>
    <span class="bp">-</span><span class="n">rw</span><span class="bp">-</span><span class="n">r</span><span class="c1">--r--    1 busiso   busiso    487192 Oct  7 14:05 inner_product.olean</span>
    <span class="bp">-</span><span class="n">rw</span><span class="bp">-</span><span class="n">r</span><span class="c1">--r--    1 busiso   busiso      6213 Sep 20 10:53 mazur_ulam.lean</span>
</code></pre></div>

<p>and then</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code> <span class="bp">-</span><span class="n">rw</span><span class="bp">-</span><span class="n">r</span><span class="c1">--r--    1 busiso   busiso    312421 Oct  7 14:05 real_inner_product.olean</span>
</code></pre></div>

<p>the offending <code>olean</code>?</p>



<a name="212564636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212564636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212564636">(Oct 07 2020 at 14:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212562076">said</a>:</p>
<blockquote>
<p>By the way, for more specific help you should clarify whether you are working with a clone of mathlib or with a project which has mathlib as a dependency</p>
</blockquote>
<p>mathlib dependent project</p>



<a name="212572162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212572162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212572162">(Oct 07 2020 at 15:07)</a>:</h4>
<p>I would recommend going into the project, deleting <code>_target</code> and then typing <code>leanproject up</code>.</p>



<a name="212574853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/inner%20product%20on%20subspaces/near/212574853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Busiso Chisala <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/inner.20product.20on.20subspaces.html#212574853">(Oct 07 2020 at 15:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/inner.20product.20on.20subspaces/near/212572162">said</a>:</p>
<blockquote>
<p>I would recommend going into the project, deleting <code>_target</code> and then typing <code>leanproject up</code>.</p>
</blockquote>
<p>Will do</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>