---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/with.20or.20.2E.2E.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html">with or ..</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="271971827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271971827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271971827">(Feb 15 2022 at 13:16)</a>:</h4>
<p>Is there a difference between <code>{ foo with bar := baz, }</code> and <code>{bar := baz, ..foo}</code>?</p>



<a name="271971913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271971913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271971913">(Feb 15 2022 at 13:17)</a>:</h4>
<p>I think only the latter syntax lets you unpack multiple structures</p>



<a name="271971924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271971924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271971924">(Feb 15 2022 at 13:17)</a>:</h4>
<p>Maybe there's more to it though</p>



<a name="271972661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271972661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271972661">(Feb 15 2022 at 13:24)</a>:</h4>
<p>According to my grep attempt, mathlib only uses the former a few times in tactics</p>



<a name="271972683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271972683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271972683">(Feb 15 2022 at 13:24)</a>:</h4>
<p>I didn't know it existed</p>



<a name="271973374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271973374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271973374">(Feb 15 2022 at 13:30)</a>:</h4>
<p>I find slightly odd that the <code>..</code> syntax is preferred, when the <code>{ foo with …}</code> is (IMHO) more readable and natural: You start with the object you want to extend, and then you list the additional fields.<br>
But maybe uniformity is useful, and so <code>with</code> really shouldn’t be used in mathlib?</p>



<a name="271973673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271973673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271973673">(Feb 15 2022 at 13:33)</a>:</h4>
<p>The reference manual at &lt;<a href="https://leanprover.github.io/reference/declarations.html#structures-and-records">https://leanprover.github.io/reference/declarations.html#structures-and-records</a>&gt; doesn't give much guidance. Although unless I am blind it only documents <code>with</code>, but not <code>..foo</code> syntax?</p>



<a name="271973754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271973754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271973754">(Feb 15 2022 at 13:34)</a>:</h4>
<p>I personally didn't even know this syntax existed.</p>



<a name="271974296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271974296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271974296">(Feb 15 2022 at 13:39)</a>:</h4>
<p>Does <code>{ foo with ... }</code> work when you want to have multiple <code>foo</code>s?</p>



<a name="271974333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271974333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271974333">(Feb 15 2022 at 13:39)</a>:</h4>
<p>E.g.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">foo</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">bar</span> <span class="kd">extends</span> <span class="n">foo</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>

<span class="kd">structure</span> <span class="n">baz</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>
<span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>
<span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">foo</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">bar</span><span class="o">)</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">baz</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">c</span><span class="o">,</span> <span class="bp">..</span> <span class="n">f</span><span class="o">,</span> <span class="bp">..</span> <span class="n">g</span> <span class="o">}</span>
</code></pre></div>



<a name="271974417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271974417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271974417">(Feb 15 2022 at 13:40)</a>:</h4>
<p>There might be some way to do this with the <code>{ foo with ... }</code> syntax, but I don't know what it is.</p>



<a name="271976222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271976222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271976222">(Feb 15 2022 at 13:54)</a>:</h4>
<p>Sounds like the <code>..</code> is more versatile and powerful, and conversely <code>with</code> simpler?</p>



<a name="271985157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271985157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271985157">(Feb 15 2022 at 14:53)</a>:</h4>
<p>Maybe there is a difference in intention (even if not technically, not sure): <code>{ x with a := t' }</code> suggests we already have a structure of the same type and we are changing one of the fields, while <code>{ b := u, .. x }</code> suggests that we are building a bigger structure reusing some fields from <code>x</code>.</p>



<a name="271985320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271985320" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271985320">(Feb 15 2022 at 14:54)</a>:</h4>
<p>The first one would be relatively rare in math (for instance if the structure is a proposition, then it makes no sense).</p>



<a name="271988945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271988945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271988945">(Feb 15 2022 at 15:19)</a>:</h4>
<p>Hmm, in a language with extensible records I am not surprised that <code>with</code> allows extension, not just updates. But I see your point.</p>
<p>Is <code>{.. x, b := u}</code> legal? (On the phone right now)</p>



<a name="271989811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271989811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271989811">(Feb 15 2022 at 15:25)</a>:</h4>
<p>It's not legal it seems</p>



<a name="271991461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271991461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271991461">(Feb 15 2022 at 15:37)</a>:</h4>
<p>The thing is that the <code>..</code> fill in everything they can as soon as they're used. So you want to use them last.</p>



<a name="271991485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271991485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271991485">(Feb 15 2022 at 15:37)</a>:</h4>
<p>Isnt that odd? I can out a .. foo before.. bar, but not before individual field assignments? Anyways, probably all not so important, and I'll adjust to the mathlib style</p>



<a name="271991608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271991608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271991608">(Feb 15 2022 at 15:38)</a>:</h4>
<p>Are you using the old or new structure command? What is the value of <code>old_structure_cmd</code>?</p>



<a name="271991767"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/271991767" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#271991767">(Feb 15 2022 at 15:40)</a>:</h4>
<p>If you're using the new one, then usually what you consider a single field of a structure is actually a field of a parent one and the structure you have in hand has that parent as a field. If you understand this, then you'll see why the <code>{ := , := }</code> is such a nice syntax sugar.</p>



<a name="272027126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/272027126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#272027126">(Feb 15 2022 at 19:39)</a>:</h4>
<p>I thought I had remembered Mario discussing <code>with</code> vs <code>..</code> and the history of <code>..</code> in Lean 3, but all I managed to dig up was <a href="#narrow/stream/270676-lean4/topic/.22.2E.2Es.22.20in.20structure.20literals/near/224902754">https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/.22.2E.2Es.22.20in.20structure.20literals/near/224902754</a></p>
<p>Too bad "with" is a stop word for Zulip's search...</p>



<a name="272072009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/with%20or%20../near/272072009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/with.20or.20.2E.2E.html#272072009">(Feb 16 2022 at 04:20)</a>:</h4>
<p>By the way for the curious, the <code>..s</code> notation has since been added as a mathlib4 extension written <code>__ := s</code>. I think it is also less restrictive in terms of its positioning wrt other fields</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>