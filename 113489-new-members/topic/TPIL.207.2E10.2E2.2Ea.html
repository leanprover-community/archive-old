---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html">TPIL 7.10.2.a</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="183520868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183520868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eduardo Cavazos <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183520868">(Dec 16 2019 at 05:28)</a>:</h4>
<p>TPIL exercise 7.10.2.a says to prove the following:</p>
<div class="codehilite"><pre><span></span>Length (s ++ t) = Length s + Length t
</pre></div>


<p>(Note, <code>List</code> and <code>Length</code> and others below are capitalized so as not to clash with the ones provided by Lean. Their definitions are from earlier in chapter 7.)</p>
<p>Here's what I have so far:</p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">s</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span> <span class="o">:=</span>

    <span class="n">List</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">s</span>

        <span class="o">(</span><span class="k">show</span> <span class="n">Length</span> <span class="o">(</span><span class="n">Nil</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">Nil</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">,</span> <span class="k">from</span>
            <span class="k">calc</span>
                <span class="n">Length</span> <span class="o">(</span><span class="n">Nil</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>   <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">t</span><span class="o">)</span>    <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nil_append</span><span class="o">]</span>
                <span class="bp">...</span>                 <span class="bp">=</span> <span class="mi">0</span> <span class="bp">+</span> <span class="n">Length</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="o">:</span> <span class="n">eq</span><span class="bp">.</span><span class="n">symm</span><span class="o">(</span><span class="n">zero_add</span> <span class="o">(</span><span class="n">Length</span> <span class="n">t</span><span class="o">)))</span>

        <span class="o">(</span><span class="bp">λ</span>  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
            <span class="o">(</span><span class="n">a_1</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span>
            <span class="o">(</span><span class="n">ih</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">),</span>

            <span class="k">show</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span><span class="o">)</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">,</span> <span class="k">from</span>

                <span class="k">calc</span>

                    <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>  <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">))</span>              <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">cons_append</span><span class="o">]</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>        <span class="o">:</span> <span class="n">length_cons</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="o">(</span><span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">)</span>  <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">ih</span><span class="o">]</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span>    <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">add_assoc</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span><span class="o">)</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span>          <span class="o">:</span> <span class="n">length_cons</span><span class="o">)</span>
</pre></div>


<p>Note that <code>length_cons</code> that's referenced in the <code>calc</code> expression does not exist. Lean seem to be OK with the rest of the proof (there are no other red squiggles).</p>
<p>As you can see, I sketched out an approach that assumes the existence of something like this:</p>
<div class="codehilite"><pre><span></span>theorem length_cons (a : α) (s : List α) : Length (a :: s) = Length [a] + Length s
</pre></div>


<p>Is this a good approach? Should I continue on in proving <code>length_cons</code> and use that? Or would you recommend another approach?</p>
<p>Thanks for any suggestions!</p>



<a name="183523350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183523350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> YH <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183523350">(Dec 16 2019 at 06:48)</a>:</h4>
<div class="codehilite"><pre><span></span>lemma ex1 {A : Type} {s t : list A} : length (s ++ t) = length s + length t :=
begin
induction s with x xs hs,
unfold length,
rw list.nil_append,
rw zero_add,
rw list.cons_append,
unfold length,
rw hs,
rwa add_assoc,
end
</pre></div>



<a name="183529234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183529234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183529234">(Dec 16 2019 at 08:50)</a>:</h4>
<p>If you can state <code>length_cons</code>, sorry the proof, and get the example compiling modulo that one sorry, then sure you should continue!  As YH points out, it can be much easier to write this stuff in tactic mode, although I suspect they are using standard facts about <code>list</code>s which you might not have proved for <code>List</code>s.</p>



<a name="183564985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183564985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> YH <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183564985">(Dec 16 2019 at 16:24)</a>:</h4>
<p><code>nil_append</code> and <code>cons_append</code> are just proved by <code>rfl</code> in mathlib, should be easy for <code>List</code> too.</p>
<div class="codehilite"><pre><span></span>@[simp] lemma nil_append (s : list α) : [] ++ s = s :=
rfl

@[simp] lemma cons_append (x : α) (s t : list α) : (x::s) ++ t = x::(s ++ t) :=
rfl
</pre></div>



<a name="183565177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183565177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183565177">(Dec 16 2019 at 16:26)</a>:</h4>
<p>You can <code>#print prefix List</code> to see all the functions which Lean made for you to use with <code>List</code>.</p>



<a name="183572298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183572298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eduardo Cavazos <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183572298">(Dec 16 2019 at 17:39)</a>:</h4>
<blockquote>
<p>If you can state <code>length_cons</code>, sorry the proof, and get the example compiling modulo that one sorry, then sure you should continue!  As YH points out, it can be much easier to write this stuff in tactic mode, although I suspect they are using standard facts about <code>list</code>s which you might not have proved for <code>List</code>s.</p>
</blockquote>
<p>Good suggestion <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>  regarding using <code>sorry</code> with <code>length_cons</code> to see if the whole thing compiles. Thanks!</p>
<p>This version does indeed appear to compile:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">length_cons</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">s</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">s</span> <span class="o">:=</span> <span class="n">sorry</span>


<span class="kn">example</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">s</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span> <span class="o">:=</span>

    <span class="n">List</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">s</span>

        <span class="o">(</span><span class="k">show</span> <span class="n">Length</span> <span class="o">(</span><span class="n">Nil</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">Nil</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">,</span> <span class="k">from</span>
            <span class="k">calc</span>
                <span class="n">Length</span> <span class="o">(</span><span class="n">Nil</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>   <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">t</span><span class="o">)</span>    <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nil_append</span><span class="o">]</span>
                <span class="bp">...</span>                 <span class="bp">=</span> <span class="mi">0</span> <span class="bp">+</span> <span class="n">Length</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="o">:</span> <span class="n">eq</span><span class="bp">.</span><span class="n">symm</span><span class="o">(</span><span class="n">zero_add</span> <span class="o">(</span><span class="n">Length</span> <span class="n">t</span><span class="o">)))</span>

        <span class="o">(</span><span class="bp">λ</span>  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
            <span class="o">(</span><span class="n">a_1</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span>
            <span class="o">(</span><span class="n">ih</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">),</span>

            <span class="k">show</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span><span class="o">)</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">,</span> <span class="k">from</span>

                <span class="k">calc</span>

                    <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>  <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">))</span>              <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">cons_append</span><span class="o">]</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>        <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">length_cons</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="o">(</span><span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">)</span>  <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">ih</span><span class="o">]</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span>    <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">add_assoc</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span><span class="o">)</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span>          <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="err">←</span><span class="n">length_cons</span><span class="o">)</span>
</pre></div>



<a name="183612036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183612036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eduardo Cavazos <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183612036">(Dec 17 2019 at 02:24)</a>:</h4>
<p>Given that the above works in terms of an assumed <code>length_cons</code>,  I decided to look into proving that.</p>
<p>This section of the chapter is emphasizing <code>rec_on</code> so I took an approach using that first:</p>
<div class="codehilite"><pre><span></span><span class="c1">-- length_cons</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">s</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">s</span> <span class="o">:=</span>

    <span class="n">List</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">s</span>

        <span class="n">rfl</span>

        <span class="o">(</span><span class="bp">λ</span>  <span class="o">(</span><span class="n">α_1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
            <span class="o">(</span><span class="n">a_2</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span>
            <span class="o">(</span><span class="n">ih</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">a_2</span><span class="o">),</span>

            <span class="k">show</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">α_1</span> <span class="bp">::</span> <span class="n">a_2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="o">(</span><span class="n">α_1</span> <span class="bp">::</span> <span class="n">a_2</span><span class="o">),</span> <span class="k">from</span>

                <span class="bp">_</span>
        <span class="o">)</span>
</pre></div>


<p>The helper that we end up with:</p>
<div class="codehilite"><pre><span></span>ih : Length (a :: a_2) = Length [a] + Length a_2
</pre></div>


<p>is very awkward and doesn't seem to help.</p>
<p>Moreover, the goal left to prove is:</p>
<div class="codehilite"><pre><span></span>Length (a :: α_1 :: a_2) = Length [a] + Length (α_1 :: a_2)
</pre></div>


<p>which is seemingly more complex than the original statement! :-)</p>
<p>So it seems like maybe this approach to <code>length_cons</code> is not the way to go. Perhaps I should not use <code>rec_on</code>? Any suggestions are welcome.</p>



<a name="183612752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183612752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183612752">(Dec 17 2019 at 02:45)</a>:</h4>
<p><code>length_cons</code> should be <code>rfl</code>, i.e. by definition.</p>



<a name="183612805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183612805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183612805">(Dec 17 2019 at 02:46)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">list</span>

<span class="kn">namespace</span> <span class="n">list</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">length_cons&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">l</span><span class="o">)</span> <span class="bp">=</span> <span class="n">length</span> <span class="n">l</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">end</span> <span class="n">list</span>
</pre></div>



<a name="183612825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183612825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183612825">(Dec 17 2019 at 02:47)</a>:</h4>
<p>But I'm not sure of your definition of <code>Length</code>.</p>



<a name="183612941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183612941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183612941">(Dec 17 2019 at 02:50)</a>:</h4>
<p>By the way, it seems that <code>length_append</code> can be solved by <code>simp</code>. </p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">list</span>

<span class="kn">namespace</span> <span class="n">list</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">length_cons&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">l</span><span class="o">)</span> <span class="bp">=</span> <span class="n">length</span> <span class="n">l</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">lemma</span> <span class="n">length_append&#39;</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">length</span> <span class="o">(</span><span class="n">s</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">length</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">length</span> <span class="n">t</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">s</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">squeeze_simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">squeeze_simp</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">list</span>
</pre></div>


<p>You can look into <code>squeeze_simp</code> to see what lemmas are used.</p>



<a name="183613031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183613031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183613031">(Dec 17 2019 at 02:53)</a>:</h4>
<p>Here is what it looks like if you do it by hand.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">list</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span>

<span class="kn">namespace</span> <span class="n">list</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kn">lemma</span> <span class="n">length_cons&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">l</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">l</span><span class="o">)</span> <span class="bp">=</span> <span class="n">length</span> <span class="n">l</span> <span class="bp">+</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">lemma</span> <span class="n">length_append&#39;</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">length</span> <span class="o">(</span><span class="n">s</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">length</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">length</span> <span class="n">t</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">induction</span> <span class="n">s</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nil_append</span><span class="o">,</span> <span class="n">length</span><span class="o">],</span> <span class="n">ring</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">cons_append</span><span class="o">,</span> <span class="n">length</span><span class="o">,</span> <span class="n">length</span><span class="o">,</span> <span class="n">length_append</span><span class="o">],</span> <span class="n">ring</span> <span class="o">}</span>
<span class="kn">end</span>

<span class="kn">end</span> <span class="n">list</span>
</pre></div>



<a name="183614150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183614150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eduardo Cavazos <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183614150">(Dec 17 2019 at 03:22)</a>:</h4>
<p>Thanks for your suggestions <span class="user-mention" data-user-id="127148">@Joe</span>!</p>
<blockquote>
<p>But I'm not sure of your definition of <code>Length</code>.</p>
</blockquote>
<p>Here's what I'm using:</p>
<div class="codehilite"><pre><span></span><span class="n">def</span> <span class="n">Length</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">},</span> <span class="n">List</span> <span class="n">α</span> <span class="bp">→</span> <span class="bp">ℕ</span> <span class="o">:=</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">α</span> <span class="n">ls</span><span class="o">,</span>
        <span class="n">List</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">ls</span>
            <span class="mi">0</span>
            <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span> <span class="n">ls</span> <span class="n">n</span><span class="o">,</span>
                <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span>
</pre></div>



<a name="183614567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183614567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eduardo Cavazos <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183614567">(Dec 17 2019 at 03:32)</a>:</h4>
<p>This appears to work:</p>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">length_cons&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">s</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kn">theorem</span> <span class="n">length_cons</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">s</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">s</span> <span class="o">:=</span>

    <span class="k">calc</span>

        <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">s</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span>     <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">length_cons&#39;</span>
        <span class="bp">...</span>             <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">s</span>     <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">add_comm</span>


<span class="kn">theorem</span> <span class="n">length_append</span> <span class="o">(</span><span class="n">s</span> <span class="n">t</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">s</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">s</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span> <span class="o">:=</span>

    <span class="n">List</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">s</span>

        <span class="o">(</span><span class="k">show</span> <span class="n">Length</span> <span class="o">(</span><span class="n">Nil</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">Nil</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">,</span> <span class="k">from</span>
            <span class="k">calc</span>
                <span class="n">Length</span> <span class="o">(</span><span class="n">Nil</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>   <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">t</span><span class="o">)</span>    <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nil_append</span><span class="o">]</span>
                <span class="bp">...</span>                 <span class="bp">=</span> <span class="mi">0</span> <span class="bp">+</span> <span class="n">Length</span><span class="o">(</span><span class="n">t</span><span class="o">)</span> <span class="o">:</span> <span class="n">eq</span><span class="bp">.</span><span class="n">symm</span><span class="o">(</span><span class="n">zero_add</span> <span class="o">(</span><span class="n">Length</span> <span class="n">t</span><span class="o">)))</span>

        <span class="o">(</span><span class="bp">λ</span>  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
            <span class="o">(</span><span class="n">a_1</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span><span class="o">)</span>
            <span class="o">(</span><span class="n">ih</span> <span class="o">:</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">),</span>

            <span class="k">show</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span><span class="o">)</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">,</span> <span class="k">from</span>

                <span class="k">calc</span>

                    <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>  <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">))</span>              <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">cons_append</span><span class="o">]</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a_1</span> <span class="bp">++</span> <span class="n">t</span><span class="o">)</span>        <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">length_cons</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="o">(</span><span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span><span class="o">)</span>  <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">ih</span><span class="o">]</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">[</span><span class="n">a</span><span class="o">]</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">a_1</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span>    <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">add_assoc</span>
                    <span class="bp">...</span>                     <span class="bp">=</span> <span class="n">Length</span> <span class="o">(</span><span class="n">a</span> <span class="bp">::</span> <span class="n">a_1</span><span class="o">)</span> <span class="bp">+</span> <span class="n">Length</span> <span class="n">t</span>          <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="err">←</span><span class="n">length_cons</span><span class="o">)</span>
</pre></div>



<a name="183618302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183618302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eduardo Cavazos <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183618302">(Dec 17 2019 at 04:43)</a>:</h4>
<p><span class="user-mention" data-user-id="127148">@Joe</span> ,</p>
<p>This comment from you was key:</p>
<blockquote>
<p><code>length_cons</code> should be <code>rfl</code>, i.e. by definition.</p>
</blockquote>
<p>When I tried to use <code>rfl</code>, I noticed that it didn't work:</p>
<div class="codehilite"><pre><span></span>theorem length_cons (a : α) (s : List α) : Length (a :: s) = Length [a] + Length s
</pre></div>


<p>however, swapping the arguments to <code>+</code> causes it to work:</p>
<div class="codehilite"><pre><span></span>theorem length_cons&#39; (a : α) (s : List α) : Length (a :: s) = Length s + Length [a] := rfl
</pre></div>


<p>Thank you so much for your help and suggestions!</p>



<a name="183618715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183618715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eduardo Cavazos <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183618715">(Dec 17 2019 at 04:51)</a>:</h4>
<p><span class="user-mention" data-user-id="249123">@YH</span> , thanks for your tactics based solution!</p>
<p>I wanted to try to use <code>rec_on</code> as that was what was emphasized in the section of the chapter. This is the approach demonstrated above.</p>



<a name="183618725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/TPIL%207.10.2.a/near/183618725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/TPIL.207.2E10.2E2.2Ea.html#183618725">(Dec 17 2019 at 04:51)</a>:</h4>
<p>You're welcome.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>