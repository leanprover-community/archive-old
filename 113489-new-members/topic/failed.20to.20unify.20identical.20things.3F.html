---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html">failed to unify identical things?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="213774203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774203">(Oct 19 2020 at 11:57)</a>:</h4>
<p>I am very perplexed by the following error I am getting</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">invalid</span> <span class="n">apply</span> <span class="n">tactic</span><span class="o">,</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">unify</span>
  <span class="n">is_integral</span> <span class="n">R</span> <span class="n">x</span>
<span class="k">with</span>
  <span class="n">is_integral</span> <span class="n">R</span> <span class="n">x</span>
</code></pre></div>

<p>I can produce a mwe, but I am wondering if there might be something hidden preventing me to see that the two <code>is_integral R x</code> are not actually the same thing.</p>



<a name="213774228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774228">(Oct 19 2020 at 11:57)</a>:</h4>
<p>Have you tried <code>set_option pp.all true</code>?</p>



<a name="213774246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774246">(Oct 19 2020 at 11:57)</a>:</h4>
<p>Before the beginning of the <code>lemma</code>?</p>



<a name="213774265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774265">(Oct 19 2020 at 11:58)</a>:</h4>
<p>Yes</p>



<a name="213774309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774309">(Oct 19 2020 at 11:58)</a>:</h4>
<p>Another trick is to use the <code>convert</code> tactic instead of <code>apply</code>, then it should make a goal for the terms that don't match.</p>



<a name="213774406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774406">(Oct 19 2020 at 11:59)</a>:</h4>
<p>OK, with the <code>set_option pp.all true</code> I think I see that they are not equal (although the error is some 50 lines long and I can't read it). I' ll try with <code>convert</code> and see what happens.</p>



<a name="213774790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774790">(Oct 19 2020 at 12:03)</a>:</h4>
<p>Thanks! The situation evolved (not that I'm in an extremely nice position, now). I keep on fighting with the fact that fractional ideals are defined in terms of the localizing morphism <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>, but the localization of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span> at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> (eg at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>R</mi><mo>∖</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">S=R\setminus 0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∖</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>) is not defined as an <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span></span></span></span>-algebra but only as a ring.</p>



<a name="213774866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774866">(Oct 19 2020 at 12:04)</a>:</h4>
<p>Hmm, <code>f.codomain</code> should have an algebra instance, I think</p>



<a name="213774965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213774965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213774965">(Oct 19 2020 at 12:04)</a>:</h4>
<p>I somehow found it, I think it is <code>ring_hom.to_algebra f.to_map</code>.</p>



<a name="213775159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213775159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213775159">(Oct 19 2020 at 12:06)</a>:</h4>
<p>Yet when I try to compare <code>f.codomain</code> with <code>K</code> they are different things when it gets to very deep coercions (at least this is how interpret the following error):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">term</span>
  <span class="n">A</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">subalgebra</span> <span class="n">R</span> <span class="n">K</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring.to_comm_semiring</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">integral_domain.to_comm_ring</span> <span class="n">R</span> <span class="n">_inst_3</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">K</span> <span class="o">(</span><span class="bp">@</span><span class="n">division_ring.to_ring</span> <span class="n">K</span> <span class="o">(</span><span class="bp">@</span><span class="n">field.to_division_ring</span> <span class="n">K</span> <span class="n">_inst_2</span><span class="o">)))</span>
    <span class="n">h_KRalg</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">subalgebra</span> <span class="n">R</span> <span class="n">K</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring.to_comm_semiring</span> <span class="n">R</span> <span class="o">(</span><span class="bp">@</span><span class="n">integral_domain.to_comm_ring</span> <span class="n">R</span> <span class="n">_inst_3</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="n">K</span> <span class="o">(</span><span class="bp">@</span><span class="n">division_ring.to_ring</span> <span class="n">K</span> <span class="o">(</span><span class="bp">@</span><span class="n">field.to_division_ring</span> <span class="n">K</span> <span class="n">_inst_2</span><span class="o">)))</span>
    <span class="n">h_RalgK</span>
</code></pre></div>



<a name="213775322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213775322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213775322">(Oct 19 2020 at 12:08)</a>:</h4>
<p>Well, this one is easy for now: one of them uses <code>h_KRalg</code> (whatever that is) while the other uses <code>h_RalgK</code> (whatever that is).</p>



<a name="213775578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/failed%20to%20unify%20identical%20things%3F/near/213775578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/failed.20to.20unify.20identical.20things.3F.html#213775578">(Oct 19 2020 at 12:10)</a>:</h4>
<p>You're right, I am messing things up. At any rate, with Anne's advice I guess I can go a bit further in understanding what I got wrong.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>