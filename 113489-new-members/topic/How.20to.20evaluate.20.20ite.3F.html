---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html">How to evaluate  ite?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="287827180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287827180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287827180">(Jun 29 2022 at 09:27)</a>:</h4>
<p>I am new to Lean and trying to formalize some proofs in my paper (starting from some very basic stuffs) <br>
In the tactic mode, I get the goal as the following:<br>
<a href="/user_uploads/3121/2Ge8s34AnJunDXyT1KAqDxdV/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/2Ge8s34AnJunDXyT1KAqDxdV/image.png" title="image.png"><img src="/user_uploads/3121/2Ge8s34AnJunDXyT1KAqDxdV/image.png"></a></div><p>Then I got no idea how to proceed. There are at least two obstructions to me. </p>
<ol>
<li>how to treat "ite" ? (clearly one must use -1 \neq 1) </li>
<li>how to treat _match_2 ?</li>
</ol>
<p>It seems there are no documents on these two points. </p>
<p>Thanks.</p>



<a name="287828729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287828729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287828729">(Jun 29 2022 at 09:41)</a>:</h4>
<p>Can you share a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> that includes your definition of <code>mat_mul</code>?</p>



<a name="287828968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287828968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287828968">(Jun 29 2022 at 09:43)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/if_neg">docs#if_neg</a> will let you eliminate the third <code>ite</code></p>



<a name="287830680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287830680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287830680">(Jun 29 2022 at 09:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/287828729">said</a>:</p>
<blockquote>
<p>Can you share a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> that includes your definition of <code>mat_mul</code>?</p>
</blockquote>
<p><a href="/user_uploads/3121/QttIh-vdhjg1pahSrtY-4KlT/image.png">image.png</a> <br>
I am trying to define the structure of monomial_matrix (over the coefficient ring int, for simplicity),  mat_mul is the multiplication of two monomail_matrix. </p>
<div class="message_inline_image"><a href="/user_uploads/3121/QttIh-vdhjg1pahSrtY-4KlT/image.png" title="image.png"><img src="/user_uploads/3121/QttIh-vdhjg1pahSrtY-4KlT/image.png"></a></div><p>The code is attached. Thanks. <br>
<a href="/user_uploads/3121/iiwvZQGnPxfY5pjuAB2dGxRI/test.lean">test.lean</a></p>



<a name="287831686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287831686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287831686">(Jun 29 2022 at 10:09)</a>:</h4>
<p>Can you paste the code here in <a href="https://github.com/leanprover-community/mathlib/wiki/Code-in-backticks">#backticks</a> rather than attaching it?</p>



<a name="287831833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287831833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287831833">(Jun 29 2022 at 10:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/287831686">said</a>:</p>
<blockquote>
<p>Can you paste the code here in <a href="https://github.com/leanprover-community/mathlib/wiki/Code-in-backticks">#backticks</a> rather than attaching it?</p>
</blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- basis of V_l are {v_i} R=integer</span>
<span class="c1">-- a scalar of a basis vector c_i v_i is identified with (c_i, i)R × int</span>

<span class="c1">-- A lifting of simple refelection is a map int -&gt; R × int</span>
<span class="kd">structure</span> <span class="n">monomial_matrix</span>  <span class="o">:=</span>
<span class="n">mk</span>  <span class="o">::</span>  <span class="o">(</span><span class="n">mat</span><span class="o">:</span> <span class="n">int</span> <span class="bp">-&gt;</span> <span class="n">int</span> <span class="bp">×</span> <span class="n">int</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">mat_mul</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">monomial_matrix</span><span class="o">)</span> <span class="o">(</span><span class="n">wp</span> <span class="o">:</span> <span class="n">monomial_matrix</span><span class="o">)</span> <span class="o">:</span> <span class="n">monomial_matrix</span> <span class="o">:=</span>
  <span class="n">monomial_matrix.mk</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span>
        <span class="k">let</span> <span class="o">(</span><span class="n">cwp_j</span><span class="o">,</span> <span class="n">wp_j</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">wp.mat</span> <span class="n">j</span><span class="o">)</span> <span class="k">in</span>
        <span class="k">let</span> <span class="o">(</span><span class="n">cw_wp_j</span><span class="o">,</span> <span class="n">w_wp_j</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">w.mat</span> <span class="n">wp_j</span><span class="o">)</span>
          <span class="k">in</span> <span class="o">(</span><span class="n">cw_wp_j</span> <span class="bp">*</span> <span class="n">cwp_j</span><span class="o">,</span> <span class="n">w_wp_j</span><span class="o">))</span>

<span class="kd">def</span> <span class="n">t</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">monomial_matrix</span> <span class="o">:=</span>
  <span class="n">monomial_matrix.mk</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">j</span><span class="o">:</span> <span class="n">int</span><span class="o">),</span>
    <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span> <span class="bp">-</span><span class="n">i</span><span class="o">)</span> <span class="k">else</span>
    <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="bp">-</span><span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="bp">-</span><span class="n">eps</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span>
    <span class="k">else</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="n">j</span><span class="o">))</span>

<span class="c1">-- The idenetity map</span>
<span class="kd">def</span> <span class="n">id_mat</span> <span class="o">:</span> <span class="n">monomial_matrix</span> <span class="o">:=</span>
  <span class="n">monomial_matrix.mk</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="n">j</span><span class="o">))</span>

<span class="kd">infixl</span> <span class="bp">`</span> <span class="bp">*</span> <span class="bp">`</span><span class="o">:</span><span class="mi">75</span> <span class="o">:=</span> <span class="n">mat_mul</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">mat_mul</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">mat_mul</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">t</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>

<span class="kd">end</span>
</code></pre></div>



<a name="287831858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287831858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287831858">(Jun 29 2022 at 10:10)</a>:</h4>
<p><del>Make sure to read <a href="https://github.com/leanprover-community/mathlib/wiki/Code-in-backticks">#backticks</a> (that's a link)</del></p>
<p>Edit: ah, you need a second set of backticks because the first set is part of the <code> ```quote ``` </code> syntax; you used the <code> ``` </code> that was inserted automatically by the quotation, and didn't actually type new ones for the code.</p>



<a name="287832092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287832092" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287832092">(Jun 29 2022 at 10:13)</a>:</h4>
<p>The <code>_match</code> terms are being generated by your use of <code>let (cw_wp_j, w_wp_j) := (w.mat wp_j)</code></p>



<a name="287832150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287832150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287832150">(Jun 29 2022 at 10:14)</a>:</h4>
<p>If you use <code>let w_wp := (w.mat wp_j)</code> and <code>w_wp.1</code>, <code>w_wp.2</code> instead, then they will go away</p>



<a name="287832461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287832461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287832461">(Jun 29 2022 at 10:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/287832150">said</a>:</p>
<blockquote>
<p>If you use <code>let w_wp := (w.mat wp_j)</code> and <code>w_wp.1</code>, <code>w_wp.2</code> instead, then they will go away</p>
</blockquote>
<p>Just updated the code.</p>



<a name="287834452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287834452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287834452">(Jun 29 2022 at 10:41)</a>:</h4>
<p>If you <code>import tactic</code> then you can use <code>split_ifs</code> which does all the dirty work for you:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">mat_mul</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mat_mul</span><span class="o">,</span> <span class="n">t</span><span class="o">],</span>
  <span class="n">split_ifs</span><span class="bp">;</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="287834952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287834952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287834952">(Jun 29 2022 at 10:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/287834452">said</a>:</p>
<blockquote>
<p>If you <code>import tactic</code> then you can use <code>split_ifs</code> which does all the dirty work for you:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">mat_mul</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mat_mul</span><span class="o">,</span> <span class="n">t</span><span class="o">],</span>
  <span class="n">split_ifs</span><span class="bp">;</span>
  <span class="n">simp</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Thanks. Like magic <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span> .<br>
Why split_ifs ends with ";" instead of ", " ?</p>



<a name="287836013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287836013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287836013">(Jun 29 2022 at 10:59)</a>:</h4>
<p><code>;</code> means "apply the following tactic to all goals created by the previous"</p>



<a name="287836081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287836081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287836081">(Jun 29 2022 at 11:00)</a>:</h4>
<p>So I assume in this case we want to simplify both the positive and negative outcome of the if statement.</p>



<a name="287836124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287836124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287836124">(Jun 29 2022 at 11:00)</a>:</h4>
<p>Maybe this is a clearer proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">mat_mul</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mat_mul</span><span class="o">,</span> <span class="n">t</span><span class="o">],</span>
  <span class="n">split_ifs</span> <span class="k">with</span> <span class="n">h</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">cases</span> <span class="n">h</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span><span class="o">,</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="287861466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287861466" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287861466">(Jun 29 2022 at 14:24)</a>:</h4>
<p>Or an even clearer proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">mat_mul</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">dec_trivial</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mat_mul</span><span class="o">,</span> <span class="n">t</span><span class="o">,</span> <span class="n">this</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>



<a name="287880972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287880972" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287880972">(Jun 29 2022 at 16:22)</a>:</h4>
<p>Now I am trying to prove something more complex. <br>
Basically, I want to verify certain listings in GL_n of simple reflections of a Weyl satisfy the braid relation. </p>
<p>I have edited my original question to include the codes. <br>
Here is the relevant part. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- The definition of s_i</span>
<span class="kd">def</span> <span class="n">s</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">monomial_matrix</span> <span class="o">:=</span>
  <span class="n">monomial_matrix.mk</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">j</span><span class="o">:</span> <span class="n">int</span><span class="o">),</span>
    <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="bp">-</span> <span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="k">else</span>
    <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span> <span class="k">then</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="k">else</span>
    <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="k">then</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span><span class="bp">-</span><span class="n">i</span><span class="o">)</span> <span class="k">else</span>
    <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="bp">-</span><span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="bp">-</span> <span class="n">eps</span><span class="o">,</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="k">else</span>
    <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="n">j</span><span class="o">))</span>

<span class="c1">-- s_i s_{i+1} s_i = s_{i+1} s_i s_{i+1}</span>
<span class="c1">-- i≠ 0, j≠ 0</span>
<span class="kd">lemma</span> <span class="n">s_i_s_ip_s_i_eq_s_ip_s_i_s_ip</span>
  <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span> <span class="o">(</span><span class="n">hi</span> <span class="o">:</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">int</span><span class="o">)</span> <span class="bp">≠</span> <span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">int</span><span class="o">))</span> <span class="o">(</span><span class="n">hj</span> <span class="o">:</span> <span class="bp">-</span><span class="n">j</span><span class="bp">≠</span> <span class="n">j</span><span class="o">)</span>
  <span class="o">:</span>
  <span class="o">((</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">s</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="bp">*</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="n">j</span> <span class="bp">=</span> <span class="o">((</span><span class="n">s</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">s</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)))</span><span class="bp">.</span><span class="n">mat</span> <span class="n">j</span>
  <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">mat_mul</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">hi</span><span class="o">,</span> <span class="n">hj</span><span class="o">],</span>
  <span class="n">split_ifs</span><span class="o">,</span>

<span class="kd">end</span>
</code></pre></div>
<p>Here are the problems:</p>
<ol>
<li>split_ifs runs timeout by default (and my VS code go crush <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> ) , and I removed the time limitation. </li>
<li>after split_ifs, it give 859 goals to solve but most goals include a hypothesis such as</li>
</ol>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">h</span><span class="o">:</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span> <span class="bp">+</span><span class="mi">1</span> <span class="bp">=</span> <span class="n">i</span>
</code></pre></div>
<p>which is clearly false. <br>
So my question is:</p>
<ol>
<li>Is there a better way to rewrite the definition of s_i so that number of cases can be reduced. </li>
<li>Is there some way to automatically eliminate the goal containing false assumptions. </li>
<li>Although I known how to disprove i+1+1 =1 in the natural number game, I still don't know how to solve it effectively using lean/mathlib. </li>
</ol>
<p>Thanks.</p>



<a name="287884509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287884509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287884509">(Jun 29 2022 at 16:50)</a>:</h4>
<p>Ouch, that looks like a pretty extreme case. Is there a lemma called something like lt_succ_succ that you could use with ne_of_gt?</p>



<a name="287885018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287885018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287885018">(Jun 29 2022 at 16:54)</a>:</h4>
<p>I think probably the way to do this is handle the cases when <code>j</code> is <code>(i+2)</code>, <code>(i+1)</code>, <code>i</code>, <code>-i</code>, <code>-(i+1)</code>, <code>-(i+2)</code> separately</p>



<a name="287885065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287885065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287885065">(Jun 29 2022 at 16:55)</a>:</h4>
<p>Which will give you only 7 cases to handle</p>



<a name="287885229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287885229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287885229">(Jun 29 2022 at 16:56)</a>:</h4>
<p>Based on your comment:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- A lifting of simple refelection is a map int -&gt; R × int</span>
<span class="kd">structure</span> <span class="n">monomial_matrix</span>  <span class="o">:=</span>
<span class="n">mk</span>  <span class="o">::</span>  <span class="o">(</span><span class="n">mat</span><span class="o">:</span> <span class="n">int</span> <span class="bp">-&gt;</span> <span class="n">int</span> <span class="bp">×</span> <span class="n">int</span><span class="o">)</span>
</code></pre></div>
<p>you probably actually want</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">monomial_matrix</span> <span class="o">(</span><span class="n">ι</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">mat</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">R</span> <span class="bp">×</span> <span class="n">ι</span><span class="o">)</span>  <span class="c1">-- lean does `mk :: ` automatically</span>
<span class="c1">-- is `(mat j).2` the column number containing `(mat j).1` in row `j`,</span>
<span class="c1">-- or the row number containing ... in column `j`?</span>
</code></pre></div>
<p>where I would guess <code>def s [ring R] (i : nat) : monomial_matrix ℤ R</code></p>



<a name="287887119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287887119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287887119">(Jun 29 2022 at 17:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/287885018">said</a>:</p>
<blockquote>
<p>I think probably the way to do this is handle the cases when <code>j</code> is <code>(i+2)</code>, <code>(i+1)</code>, <code>i</code>, <code>-i</code>, <code>-(i+1)</code>, <code>-(i+2)</code> separately</p>
</blockquote>
<p>Mathematically yes, and the claim is easy to check by hand. However, is there a more automated way?</p>



<a name="287887743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287887743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287887743">(Jun 29 2022 at 17:15)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/287885229">said</a>:</p>
<blockquote>
<p>Based on your comment:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- A lifting of simple refelection is a map int -&gt; R × int</span>
<span class="kd">structure</span> <span class="n">monomial_matrix</span>  <span class="o">:=</span>
<span class="n">mk</span>  <span class="o">::</span>  <span class="o">(</span><span class="n">mat</span><span class="o">:</span> <span class="n">int</span> <span class="bp">-&gt;</span> <span class="n">int</span> <span class="bp">×</span> <span class="n">int</span><span class="o">)</span>
</code></pre></div>
<p>you probably actually want</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">monomial_matrix</span> <span class="o">(</span><span class="n">ι</span> <span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">mat</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="n">R</span> <span class="bp">×</span> <span class="n">ι</span><span class="o">)</span>  <span class="c1">-- lean does `mk :: ` automatically</span>
<span class="c1">-- is `(mat j).2` the column number containing `(mat j).1` in row `j`,</span>
<span class="c1">-- or the row number containing ... in column `j`?</span>
</code></pre></div>
<p>where I would guess <code>def s [ring R] (i : nat) : monomial_matrix ℤ R</code></p>
</blockquote>
<p>Thanks for the improvement.  <code>(mat j).2</code> is the row number containing <code>(mat j).1</code>  in column <code>j</code> (by viewing a vector as a column vector).</p>



<a name="287888518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287888518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287888518">(Jun 29 2022 at 17:21)</a>:</h4>
<blockquote>
<p>However, is there a more automated way?</p>
</blockquote>
<p>I recommend first writing the five lemmas:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="n">i</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span> <span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span><span class="bp">=</span> <span class="o">(</span><span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span><span class="bp">=</span> <span class="o">(</span><span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="bp">-</span><span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span> <span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="o">(</span><span class="n">h4</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="bp">-</span><span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="n">j</span><span class="bp">=</span> <span class="o">(</span><span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="287964291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287964291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287964291">(Jun 30 2022 at 01:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/287888518">said</a>:</p>
<blockquote>
<blockquote>
<p>However, is there a more automated way?</p>
</blockquote>
<p>I recommend first writing the five lemmas:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="n">i</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span> <span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span><span class="bp">=</span> <span class="o">(</span><span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span><span class="bp">=</span> <span class="o">(</span><span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="bp">-</span><span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span> <span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
<span class="kd">example</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="o">(</span><span class="n">h4</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="bp">-</span><span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="n">j</span><span class="bp">=</span> <span class="o">(</span><span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div><br>
</p>
</blockquote>
<p>First two are simple:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">nat</span><span class="o">):</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="n">i</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span> <span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">s</span><span class="o">,</span> <span class="n">ip_ne_i</span><span class="o">],</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">s</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span><span class="bp">=</span> <span class="o">(</span><span class="n">eps</span> <span class="o">,</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">s</span><span class="o">],</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>The third one is not easy already, I am run into the trouble to prove that </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">neq_ii</span> <span class="o">(</span><span class="n">i</span><span class="o">:</span> <span class="n">nat</span> <span class="o">):</span> <span class="bp">-</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">int</span><span class="o">)</span> <span class="bp">≠</span>  <span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">int</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
<span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>The whole thing is not difficult mathematically. My feeling is that the definition of <code>s</code> and <code>monomial_matrix</code> is not good.</p>



<a name="287989058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287989058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287989058">(Jun 30 2022 at 07:57)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#linarith">tactic#linarith</a> can solve that</p>



<a name="287989326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/287989326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#287989326">(Jun 30 2022 at 08:00)</a>:</h4>
<p>If you want to know how to do it manually,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">neq_ii</span> <span class="o">(</span><span class="n">i</span><span class="o">:</span> <span class="n">nat</span> <span class="o">):</span> <span class="bp">-</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">int</span><span class="o">)</span> <span class="bp">≠</span>  <span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">int</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">neg_add</span><span class="o">,</span> <span class="n">neg_eq_iff_add_eq_zero</span><span class="o">,</span> <span class="n">add_assoc</span><span class="o">,</span> <span class="n">add_comm</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="288114096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288114096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288114096">(Jul 01 2022 at 03:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/287989326">said</a>:</p>
<blockquote>
<p>If you want to know how to do it manually,</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">neq_ii</span> <span class="o">(</span><span class="n">i</span><span class="o">:</span> <span class="n">nat</span> <span class="o">):</span> <span class="bp">-</span><span class="mi">1</span> <span class="bp">+</span> <span class="bp">-</span><span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">int</span><span class="o">)</span> <span class="bp">≠</span>  <span class="o">(</span><span class="n">i</span><span class="o">:</span><span class="n">int</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span><span class="n">neg_add</span><span class="o">,</span> <span class="n">neg_eq_iff_add_eq_zero</span><span class="o">,</span> <span class="n">add_assoc</span><span class="o">,</span> <span class="n">add_comm</span><span class="o">]</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Thanks.<br>
<code>linarith</code> works perfectly. <br>
But it seems I have to supply a big set of all such kinds of inequalities to <code>simp</code>. Is it possible to automate the process? For example, apply linarith on all the hypothesis?</p>



<a name="288118497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288118497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288118497">(Jul 01 2022 at 04:21)</a>:</h4>
<p>Is <code>any_goals { linarith }</code> what you are looking for?</p>



<a name="288119766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288119766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288119766">(Jul 01 2022 at 04:40)</a>:</h4>
<p>If you want to use a tactic on all side-goals generated by the application of one tactic, you can also use <code>;</code>.  For instance,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">tactic1</span><span class="bp">;</span>
<span class="n">tactic2</span>
</code></pre></div>
<p>means "use <code>tactic2</code> on all goals that <code>tactic1</code> produces".</p>



<a name="288181522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288181522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288181522">(Jul 01 2022 at 15:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="321459">Damiano Testa</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/288118497">said</a>:</p>
<blockquote>
<p>Is <code>any_goals { linarith }</code> what you are looking for?</p>
</blockquote>
<p>Is it  possible to make Lean to <code>reduce</code> the expression of the both sides of the equation? just like <code>#reduce</code> can do ? </p>
<p>For example using <code>#reduce</code> I got </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#reduce</span> <span class="o">((</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span>      <span class="c1">-- (eps.neg.mul -[1+ 0], v.p 1)</span>
</code></pre></div>
<p>But is I would like to <code>proof</code> the statement <code>((t 1) * (t 1)).mat (v.p 1)  = (eps, v.p 1)</code>: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span>  <span class="o">:</span> <span class="o">((</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span>  <span class="bp">=</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span>
<span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">t</span><span class="o">],</span>

<span class="kd">end</span>
</code></pre></div>
<p>What I can get is the following big chunk of unsolved goal:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">there</span> <span class="n">are</span> <span class="n">unsolved</span> <span class="n">goals</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">eps</span> <span class="o">:</span> <span class="n">ℤ</span>
<span class="bp">⊢</span> <span class="o">({</span><span class="n">mat</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">bb</span> <span class="o">:</span> <span class="n">v</span><span class="o">),</span>
                 <span class="n">v.rec</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">ite</span> <span class="o">(</span><span class="n">i</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">v.n</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">ite</span> <span class="o">(</span><span class="n">i</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="n">eps</span><span class="o">,</span> <span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span>
                   <span class="n">bb</span><span class="o">}</span> <span class="bp">*</span>
       <span class="o">{</span><span class="n">mat</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">bb</span> <span class="o">:</span> <span class="n">v</span><span class="o">),</span>
                 <span class="n">v.rec</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">ite</span> <span class="o">(</span><span class="n">i</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">v.n</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">ite</span> <span class="o">(</span><span class="n">i</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="bp">-</span><span class="n">eps</span><span class="o">,</span> <span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span>
                   <span class="n">bb</span><span class="o">})</span><span class="bp">.</span><span class="n">mat</span>
      <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span>
    <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span>
</code></pre></div>



<a name="288182394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288182394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288182394">(Jul 01 2022 at 15:11)</a>:</h4>
<p>Can you post an updated MWE so people can try things out?</p>



<a name="288182447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288182447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288182447">(Jul 01 2022 at 15:12)</a>:</h4>
<p>Does <code>refl</code> work to prove the equality with the output of reduce?</p>



<a name="288193301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288193301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288193301">(Jul 01 2022 at 16:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="127136">Alex J. Best</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/288182394">said</a>:</p>
<blockquote>
<p>Can you post an updated MWE so people can try things out?</p>
</blockquote>
<p>I rewrote the code so it is different from the original one. <br>
The last example is where I got stuck. Thanks. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="c1">-- Basis of the vector space V_l</span>
<span class="c1">-- The basis is v^±_0 , v^±_1 , ⋯, v^\pm_l</span>
<span class="kd">inductive</span> <span class="n">v</span>
<span class="bp">|</span> <span class="n">p</span>  <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">v</span>
<span class="bp">|</span> <span class="n">n</span>  <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">v</span>

<span class="k">#check</span> <span class="n">v.p</span> <span class="mi">1</span>
<span class="kd">def</span> <span class="n">bb</span> <span class="o">:</span> <span class="n">v</span> <span class="o">:=</span> <span class="n">v.p</span> <span class="mi">1</span>
<span class="k">#reduce</span> <span class="n">bb</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">refl</span>
<span class="kd">example</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span> <span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">v.p</span> <span class="n">i</span><span class="o">)</span> <span class="bp">≠</span> <span class="o">(</span><span class="n">v.p</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span> <span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">v.p</span> <span class="n">i</span><span class="o">)</span> <span class="bp">≠</span> <span class="o">(</span><span class="n">v.n</span> <span class="o">(</span><span class="n">i</span><span class="bp">+</span><span class="mi">1</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">simp</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kd">end</span>

<span class="c1">-- Monomail matrix by specify the value at the basis vector</span>
<span class="kd">structure</span> <span class="n">monomial_matrix</span>  <span class="o">:=</span>  <span class="o">(</span><span class="n">mat</span><span class="o">:</span> <span class="n">v</span> <span class="bp">-&gt;</span> <span class="n">int</span> <span class="bp">×</span> <span class="n">v</span><span class="o">)</span>

<span class="c1">-- indentity matrix</span>
<span class="kd">def</span> <span class="n">id_mat</span> <span class="o">:</span> <span class="n">monomial_matrix</span> <span class="o">:=</span>
  <span class="o">{</span> <span class="n">mat</span> <span class="o">:=</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="n">j</span><span class="o">))}</span>


<span class="kd">def</span> <span class="n">mat_mul</span> <span class="o">(</span><span class="n">w</span> <span class="o">:</span> <span class="n">monomial_matrix</span><span class="o">)</span> <span class="o">(</span><span class="n">wp</span> <span class="o">:</span> <span class="n">monomial_matrix</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">monomial_matrix</span> <span class="o">:=</span>  <span class="n">monomial_matrix.mk</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span>
        <span class="k">let</span> <span class="n">wp_j</span> <span class="o">:=</span> <span class="o">(</span><span class="n">wp.mat</span> <span class="n">j</span><span class="o">)</span> <span class="k">in</span>
        <span class="k">let</span> <span class="n">w_wp_j</span><span class="o">:=</span> <span class="o">(</span><span class="n">w.mat</span> <span class="n">wp_j.2</span><span class="o">)</span>
          <span class="k">in</span> <span class="o">(</span><span class="n">w_wp_j.1</span> <span class="bp">*</span> <span class="n">wp_j.1</span><span class="o">,</span> <span class="n">w_wp_j.2</span><span class="o">))</span>

<span class="kd">infixl</span> <span class="bp">`</span> <span class="bp">*</span> <span class="bp">`</span><span class="o">:</span><span class="mi">75</span> <span class="o">:=</span> <span class="n">mat_mul</span>

<span class="kn">section</span>

<span class="kd">parameter</span> <span class="o">(</span><span class="n">eps</span> <span class="o">:</span> <span class="n">int</span><span class="o">)</span>
<span class="c1">-- def eps := 1</span>

<span class="c1">-- attribute [reducible]</span>
<span class="c1">-- def t_map (i : nat) (bb : v) : int × v :=</span>
<span class="c1">--  v.cases_on bb (λ j, if   j= i then (-1, v.n i) else (1, bb))</span>
<span class="c1">--   (λ j, if j = i then (-eps, v.p i) else (1, bb))</span>

<span class="kn">attribute</span> <span class="o">[</span><span class="n">reducible</span><span class="o">]</span>
<span class="kd">def</span> <span class="n">t</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">monomial_matrix</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">mat</span> <span class="o">:=</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">bb</span><span class="o">,</span> <span class="n">v.cases_on</span> <span class="n">bb</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="k">if</span>   <span class="n">j</span><span class="bp">=</span> <span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">v.n</span> <span class="n">i</span><span class="o">)</span> <span class="k">else</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="bp">-</span><span class="n">eps</span><span class="o">,</span> <span class="n">v.p</span> <span class="n">i</span><span class="o">)</span> <span class="k">else</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span>
    <span class="o">)</span>
    <span class="o">}</span>


<span class="kd">def</span> <span class="n">eps_map</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">(</span><span class="n">bb</span> <span class="o">:</span> <span class="n">v</span><span class="o">)</span> <span class="o">:</span> <span class="n">int</span> <span class="bp">×</span> <span class="n">v</span> <span class="o">:=</span>
  <span class="n">v.cases_on</span> <span class="n">bb</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="n">bb</span><span class="o">)</span> <span class="k">else</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="n">bb</span><span class="o">)</span> <span class="k">else</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span>


<span class="kn">attribute</span> <span class="o">[</span><span class="n">reducible</span><span class="o">]</span>
<span class="kd">def</span> <span class="n">eps_mat</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="n">monomial_matrix</span> <span class="o">:=</span> <span class="o">{</span>
  <span class="n">mat</span> <span class="o">:=</span>   <span class="o">(</span><span class="bp">λ</span> <span class="n">bb</span><span class="o">,</span> <span class="n">v.cases_on</span> <span class="n">bb</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="n">bb</span><span class="o">)</span> <span class="k">else</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">j</span><span class="o">,</span> <span class="k">if</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">i</span> <span class="k">then</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="n">bb</span><span class="o">)</span> <span class="k">else</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">bb</span><span class="o">))</span>
    <span class="o">)</span>
  <span class="o">}</span>

<span class="k">#reduce</span>  <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">v.n</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
 <span class="n">simp</span> <span class="o">[</span><span class="n">t</span><span class="o">],</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">:</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.n</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span> <span class="n">eps</span><span class="o">,</span> <span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">begin</span>
 <span class="n">simp</span> <span class="o">[</span><span class="n">t</span><span class="o">],</span>
<span class="kd">end</span>

<span class="k">#reduce</span> <span class="o">((</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span>


<span class="c1">-- example (l: nat) (hl: l=1 ): ((t l) * (t l)).mat (v.p l)  = (eps_mat l).mat (v.p l)</span>
<span class="kd">example</span>  <span class="o">:</span> <span class="o">((</span><span class="n">t</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">t</span> <span class="mi">1</span><span class="o">))</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span>  <span class="bp">=</span> <span class="o">(</span><span class="n">eps</span><span class="o">,</span> <span class="n">v.p</span> <span class="mi">1</span><span class="o">)</span>
<span class="o">:=</span> <span class="kd">begin</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">t</span><span class="o">],</span>
  <span class="n">refl</span><span class="o">,</span>

<span class="kd">end</span>

<span class="kd">end</span>
</code></pre></div>



<a name="288193943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288193943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ma, Jia-Jun <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288193943">(Jul 01 2022 at 16:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="127136">Alex J. Best</span> <a href="#narrow/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F/near/288182447">said</a>:</p>
<blockquote>
<p>Does <code>refl</code> work to prove the equality with the output of reduce?</p>
</blockquote>
<p>no. <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="288196313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288196313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288196313">(Jul 01 2022 at 16:42)</a>:</h4>
<p>You should be adding lemmas in the style of the ones I suggested before</p>



<a name="288196335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288196335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288196335">(Jul 01 2022 at 16:42)</a>:</h4>
<p>Don't start writing lemmas about multiplication until you've written the basic lemmas about <code>t</code></p>



<a name="288196932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/How%20to%20evaluate%20%20ite%3F/near/288196932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/How.20to.20evaluate.20.20ite.3F.html#288196932">(Jul 01 2022 at 16:46)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">t_mat_p_eq</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.p</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span><span class="mi">1</span><span class="o">,</span> <span class="n">v.n</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="n">if_pos</span> <span class="n">rfl</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">t_mat_n_eq</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.n</span> <span class="n">i</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">-</span><span class="n">eps</span><span class="o">,</span> <span class="n">v.p</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="n">if_pos</span> <span class="n">rfl</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">t_mat_p_ne</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.p</span> <span class="n">j</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">v.p</span> <span class="n">j</span><span class="o">)</span> <span class="o">:=</span> <span class="n">if_neg</span> <span class="n">h</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">t_mat_n_ne</span> <span class="o">{</span><span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">≠</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">t</span> <span class="n">i</span><span class="o">)</span><span class="bp">.</span><span class="n">mat</span> <span class="o">(</span><span class="n">v.n</span> <span class="n">j</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="n">v.n</span> <span class="n">j</span><span class="o">)</span> <span class="o">:=</span> <span class="n">if_neg</span> <span class="n">h</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>