---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html">sum of two negligible function is also a negligible function</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="203632199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203632199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mukesh Tiwari <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203632199">(Jul 12 2020 at 07:28)</a>:</h4>
<p>I am trying to prove that sum of two negligible functions are negligible, but I am stuck with this goal: </p>
<div class="codehilite"><pre><span></span><code><span class="n">tactic</span> <span class="n">failed</span><span class="o">,</span> <span class="n">there</span> <span class="n">are</span> <span class="n">unsolved</span> <span class="n">goals</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">μ₁</span> <span class="n">μ₂</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">,</span>
<span class="n">H₁</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n₀</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₀</span> <span class="bp">→</span> <span class="n">μ₁</span> <span class="n">n</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">n</span> <span class="bp">^</span> <span class="n">c</span> <span class="bp">&lt;</span> <span class="mi">1</span><span class="o">,</span>
<span class="n">H₂</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n₀</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₀</span> <span class="bp">→</span> <span class="n">μ₂</span> <span class="n">n</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">n</span> <span class="bp">^</span> <span class="n">c</span> <span class="bp">&lt;</span> <span class="mi">1</span><span class="o">,</span>
<span class="n">c</span> <span class="n">n₁</span> <span class="n">n₂</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">,</span>
<span class="n">Hn</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">max</span> <span class="n">n₁</span> <span class="o">(</span><span class="n">max</span> <span class="n">n₂</span> <span class="mi">2</span><span class="o">),</span>
<span class="n">Ht</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₁</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">max</span> <span class="n">n₂</span> <span class="mi">2</span><span class="o">,</span>
<span class="n">Ht₁</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₁</span><span class="o">,</span>
<span class="n">Ht₃</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₂</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≥</span> <span class="mi">2</span><span class="o">,</span>
<span class="n">Ht₂</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₂</span><span class="o">,</span>
<span class="n">Ht₃</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≥</span> <span class="mi">2</span><span class="o">,</span>
<span class="n">Hn₁</span> <span class="o">:</span> <span class="n">μ₁</span> <span class="n">n</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">n</span> <span class="bp">^</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">1</span><span class="o">,</span>
<span class="n">Hn₂</span> <span class="o">:</span> <span class="n">μ₂</span> <span class="n">n</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">n</span> <span class="bp">^</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">1</span>
<span class="err">⊢</span> <span class="o">(</span><span class="n">μ₁</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">μ₂</span> <span class="n">n</span><span class="o">)</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">n</span> <span class="bp">^</span> <span class="n">c</span> <span class="bp">&lt;</span> <span class="mi">1</span>
</code></pre></div>


<p>Based on my calculation, unless I missed something very obvious, adding <br>
Hn₁ : μ₁ n * ↑n ^ (c + 2) &lt; 1,<br>
Hn₂ : μ₂ n * ↑n ^ (c + 2) &lt; 1 <br>
would give me  ( μ₁ n + μ₂ n) * ↑n ^ c  * ↑n ^ 2  &lt; 2 . Since  n ≥ 2 (Ht₃ ), 2/↑n ^ 2  &lt; 1 which proves the goal. Below is the complete working code: </p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>
  <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">basic</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">order</span>
  <span class="n">tactic</span><span class="bp">.</span><span class="n">omega</span>


<span class="n">def</span> <span class="n">neg_fn</span> <span class="o">(</span><span class="n">μ</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n₀</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span>
    <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₀</span> <span class="bp">→</span> <span class="o">(</span><span class="n">μ</span> <span class="n">n</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">^</span> <span class="n">c</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">1</span>

<span class="n">def</span> <span class="n">sum_neg_fn</span> <span class="o">(</span><span class="n">μ₁</span> <span class="n">μ₂</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span> <span class="o">:=</span>
  <span class="bp">λ</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">μ₁</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">μ₂</span> <span class="n">n</span>

<span class="kn">theorem</span> <span class="n">upper_bound_max</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="n">n₁</span> <span class="n">n₂</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">max</span> <span class="n">n₁</span> <span class="n">n₂</span> <span class="bp">→</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₁</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₂</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">n₁</span> <span class="n">n₂</span> <span class="n">Hn</span><span class="o">,</span> <span class="n">exact</span> <span class="n">max_le_iff</span><span class="bp">.</span><span class="n">mp</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">sum_neg_fn_is_neg_fn</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">μ₁</span> <span class="n">μ₂</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">),</span> <span class="n">neg_fn</span> <span class="n">μ₁</span> <span class="bp">→</span> <span class="n">neg_fn</span> <span class="n">μ₂</span> <span class="bp">→</span> <span class="n">neg_fn</span> <span class="o">(</span><span class="n">sum_neg_fn</span> <span class="n">μ₁</span> <span class="n">μ₂</span><span class="o">)</span> <span class="o">:=</span>
  <span class="k">begin</span>
    <span class="n">unfold</span> <span class="n">sum_neg_fn</span> <span class="n">neg_fn</span><span class="o">,</span> <span class="n">intros</span> <span class="n">μ₁</span> <span class="n">μ₂</span> <span class="n">H₁</span> <span class="n">H₂</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">destruct</span> <span class="o">(</span><span class="n">H₁</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)),</span> <span class="n">intros</span> <span class="n">n₁</span> <span class="n">Hn₁</span><span class="o">,</span>
    <span class="n">destruct</span> <span class="o">(</span><span class="n">H₂</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)),</span> <span class="n">intros</span> <span class="n">n₂</span> <span class="n">Hn₂</span><span class="o">,</span>
    <span class="n">existsi</span> <span class="o">(</span><span class="n">max</span> <span class="n">n₁</span> <span class="o">(</span><span class="n">max</span> <span class="n">n₂</span> <span class="mi">2</span><span class="o">)),</span> <span class="n">intros</span> <span class="n">n</span> <span class="n">Hn</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">Ht</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₁</span> <span class="bp">∧</span>  <span class="n">n</span> <span class="bp">≥</span> <span class="n">max</span> <span class="n">n₂</span> <span class="mi">2</span> <span class="o">:=</span> <span class="k">begin</span>
      <span class="n">apply</span> <span class="n">upper_bound_max</span><span class="o">,</span> <span class="n">apply_assumption</span><span class="o">,</span>
    <span class="kn">end</span><span class="o">,</span>
    <span class="n">destruct</span> <span class="n">Ht</span><span class="o">,</span> <span class="n">intros</span> <span class="n">Ht₁</span> <span class="n">Ht₂</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">Ht₃</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≥</span> <span class="n">n₂</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">≥</span> <span class="mi">2</span> <span class="o">:=</span> <span class="k">begin</span>
      <span class="n">apply</span> <span class="n">upper_bound_max</span><span class="o">,</span> <span class="n">apply_assumption</span><span class="o">,</span>
    <span class="kn">end</span><span class="o">,</span> <span class="n">clear</span> <span class="n">Ht₂</span><span class="o">,</span>
    <span class="n">destruct</span> <span class="n">Ht₃</span><span class="o">,</span> <span class="n">intros</span> <span class="n">Ht₂</span> <span class="n">Ht₃</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="o">(</span><span class="n">Hn₁</span> <span class="n">n</span> <span class="n">Ht₁</span><span class="o">),</span> <span class="n">specialize</span> <span class="o">(</span><span class="n">Hn₂</span> <span class="n">n</span> <span class="n">Ht₂</span><span class="o">),</span>
   <span class="c">/-</span><span class="cm"> How to finish rest -/</span>
  <span class="kn">end</span>
</code></pre></div>



<a name="203635704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203635704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203635704">(Jul 12 2020 at 09:26)</a>:</h4>
<p>So far so good.  I modified your tactics to look more like idiomatic Lean (as far as I understand it), and after a good amount of <code>library_search</code>, I found the following proof:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">order</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="n">def</span> <span class="n">neg_fn</span> <span class="o">(</span><span class="n">μ</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n₀</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span>
    <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">n₀</span> <span class="bp">≤</span> <span class="n">n</span> <span class="bp">→</span> <span class="o">(</span><span class="n">μ</span> <span class="n">n</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">^</span> <span class="n">c</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">1</span>

<span class="n">def</span> <span class="n">sum_neg_fn</span> <span class="o">(</span><span class="n">μ₁</span> <span class="n">μ₂</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span> <span class="o">:=</span>
  <span class="bp">λ</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">μ₁</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">μ₂</span> <span class="n">n</span>

<span class="kn">theorem</span> <span class="n">sum_neg_fn_is_neg_fn</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">μ₁</span> <span class="n">μ₂</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">),</span> <span class="n">neg_fn</span> <span class="n">μ₁</span> <span class="bp">→</span> <span class="n">neg_fn</span> <span class="n">μ₂</span> <span class="bp">→</span> <span class="n">neg_fn</span> <span class="o">(</span><span class="n">sum_neg_fn</span> <span class="n">μ₁</span> <span class="n">μ₂</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">μ₁</span> <span class="n">μ₂</span> <span class="n">H₁</span> <span class="n">H₂</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">H₁</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="k">with</span> <span class="n">n₁</span> <span class="n">Hn₁</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">H₂</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="k">with</span> <span class="n">n₂</span> <span class="n">Hn₂</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">max</span> <span class="n">n₁</span> <span class="o">(</span><span class="n">max</span> <span class="n">n₂</span> <span class="mi">2</span><span class="o">),</span> <span class="n">intros</span> <span class="n">n</span> <span class="n">Hn</span><span class="o">,</span>
  <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">max_le_iff</span> <span class="n">at</span> <span class="n">Hn</span> <span class="o">},</span>
  <span class="n">rcases</span> <span class="n">Hn</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">Ht₁</span><span class="o">,</span> <span class="n">Ht₂</span><span class="o">,</span> <span class="n">Ht₃</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">Hn₁</span> <span class="n">n</span> <span class="n">Ht₁</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">Hn₂</span> <span class="n">n</span> <span class="n">Ht₂</span><span class="o">,</span>
  <span class="n">dunfold</span> <span class="n">sum_neg_fn</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">pow_add</span><span class="o">,</span> <span class="err">←</span><span class="n">mul_assoc</span><span class="o">]</span> <span class="n">at</span> <span class="n">Hn₁</span> <span class="n">Hn₂</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">npos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">),</span> <span class="o">{</span> <span class="n">norm_cast</span><span class="o">,</span> <span class="n">linarith</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">hsqp</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span> <span class="n">pow_pos</span> <span class="n">npos</span> <span class="mi">2</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span><span class="n">lt_div_iff</span> <span class="n">hsqp</span> <span class="n">at</span> <span class="n">Hn₁</span> <span class="n">Hn₂</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">Ht₃&#39;</span> <span class="o">:</span> <span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span><span class="bp">^</span><span class="mi">2</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">norm_cast</span><span class="o">,</span> <span class="n">exact</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow_le_pow_of_le_left</span> <span class="n">Ht₃</span> <span class="mi">2</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">Ht₃&#39;&#39;</span> <span class="o">:</span> <span class="mi">1</span><span class="bp">/</span><span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">≤</span> <span class="mi">1</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">div_le_div_of_le_left</span> <span class="n">zero_le_one</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="n">Ht₃&#39;</span> <span class="o">},</span>
  <span class="n">linarith</span> <span class="o">[</span><span class="n">Hn₁</span><span class="o">,</span> <span class="n">Hn₂</span><span class="o">,</span> <span class="n">Ht₃&#39;&#39;</span><span class="o">],</span>
<span class="kn">end</span>
</code></pre></div>



<a name="203635775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203635775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203635775">(Jul 12 2020 at 09:28)</a>:</h4>
<p>One curiosity is that changing the proof of <code>Ht₃''</code> to be term mode and not <code>exact</code> causes Lean to time out.  I have no idea why this is.</p>



<a name="203636137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203636137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203636137">(Jul 12 2020 at 09:39)</a>:</h4>
<p>Also, to get the <code>max_le_iff</code> rewrite to work, I changed the inequality in <code>neg_fn</code> to <code>n₀ ≤ n</code>.  Lean tends to prefer <code>≤</code> since <code>≥</code> is defined in terms of it.</p>



<a name="203636292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203636292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203636292">(Jul 12 2020 at 09:44)</a>:</h4>
<p>A question of my own: does mathlib have pointwise addition of functions?  It seems like something like <code>sum_neg_fn</code> should be defined already.</p>



<a name="203636431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203636431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203636431">(Jul 12 2020 at 09:49)</a>:</h4>
<p>Sure, <a href="https://leanprover-community.github.io/mathlib_docs/algebra/pi_instances.html">https://leanprover-community.github.io/mathlib_docs/algebra/pi_instances.html</a></p>



<a name="203636633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203636633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203636633">(Jul 12 2020 at 09:55)</a>:</h4>
<p>Great!</p>
<p>In that case, this can be given as</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">order</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">pi_instances</span>
<span class="kn">import</span> <span class="n">tactic</span>

<span class="n">def</span> <span class="n">neg_fn</span> <span class="o">(</span><span class="n">μ</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">c</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n₀</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span>
    <span class="bp">∀</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="n">n₀</span> <span class="bp">≤</span> <span class="n">n</span> <span class="bp">→</span> <span class="o">(</span><span class="n">μ</span> <span class="n">n</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">^</span> <span class="n">c</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="mi">1</span>

<span class="kn">theorem</span> <span class="n">sum_neg_fn_is_neg_fn</span> <span class="o">:</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">μ₁</span> <span class="n">μ₂</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">),</span> <span class="n">neg_fn</span> <span class="n">μ₁</span> <span class="bp">→</span> <span class="n">neg_fn</span> <span class="n">μ₂</span> <span class="bp">→</span> <span class="n">neg_fn</span> <span class="o">(</span><span class="n">μ₁</span> <span class="bp">+</span> <span class="n">μ₂</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">intros</span> <span class="n">μ₁</span> <span class="n">μ₂</span> <span class="n">H₁</span> <span class="n">H₂</span> <span class="n">c</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">H₁</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="k">with</span> <span class="n">n₁</span> <span class="n">Hn₁</span><span class="o">,</span>
  <span class="n">cases</span> <span class="n">H₂</span> <span class="o">(</span><span class="n">c</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="k">with</span> <span class="n">n₂</span> <span class="n">Hn₂</span><span class="o">,</span>
  <span class="n">use</span> <span class="n">max</span> <span class="n">n₁</span> <span class="o">(</span><span class="n">max</span> <span class="n">n₂</span> <span class="mi">2</span><span class="o">),</span> <span class="n">intros</span> <span class="n">n</span> <span class="n">Hn</span><span class="o">,</span>
  <span class="n">repeat</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">max_le_iff</span> <span class="n">at</span> <span class="n">Hn</span> <span class="o">},</span>
  <span class="n">rcases</span> <span class="n">Hn</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">Ht₁</span><span class="o">,</span> <span class="n">Ht₂</span><span class="o">,</span> <span class="n">Ht₃</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">Hn₁</span> <span class="n">n</span> <span class="n">Ht₁</span><span class="o">,</span>
  <span class="n">specialize</span> <span class="n">Hn₂</span> <span class="n">n</span> <span class="n">Ht₂</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">pi</span><span class="bp">.</span><span class="n">add_apply</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">pow_add</span><span class="o">,</span> <span class="err">←</span><span class="n">mul_assoc</span><span class="o">]</span> <span class="n">at</span> <span class="n">Hn₁</span> <span class="n">Hn₂</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">npos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">),</span> <span class="o">{</span> <span class="n">norm_cast</span><span class="o">,</span> <span class="n">linarith</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">hsqp</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">^</span> <span class="mi">2</span> <span class="o">:=</span> <span class="n">pow_pos</span> <span class="n">npos</span> <span class="mi">2</span><span class="o">,</span>
  <span class="n">rw</span> <span class="err">←</span><span class="n">lt_div_iff</span> <span class="n">hsqp</span> <span class="n">at</span> <span class="n">Hn₁</span> <span class="n">Hn₂</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">Ht₃&#39;</span> <span class="o">:</span> <span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">≤</span> <span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span><span class="bp">^</span><span class="mi">2</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">norm_cast</span><span class="o">,</span> <span class="n">exact</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow_le_pow_of_le_left</span> <span class="n">Ht₃</span> <span class="mi">2</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">Ht₃&#39;&#39;</span> <span class="o">:</span> <span class="mi">1</span><span class="bp">/</span><span class="o">(</span><span class="err">↑</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">≤</span> <span class="mi">1</span><span class="bp">/</span><span class="o">(</span><span class="mi">4</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">div_le_div_of_le_left</span> <span class="n">zero_le_one</span> <span class="o">(</span><span class="k">by</span> <span class="n">linarith</span><span class="o">)</span> <span class="n">Ht₃&#39;</span> <span class="o">},</span>
  <span class="n">linarith</span> <span class="o">[</span><span class="n">Hn₁</span><span class="o">,</span> <span class="n">Hn₂</span><span class="o">,</span> <span class="n">Ht₃&#39;&#39;</span><span class="o">],</span>
<span class="kn">end</span>
</code></pre></div>



<a name="203636898"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203636898" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203636898">(Jul 12 2020 at 10:02)</a>:</h4>
<p>It is perhaps nicer to write the theorem statement as</p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">sum_neg_fn_is_neg_fn</span> <span class="o">(</span><span class="n">μ₁</span> <span class="n">μ₂</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">H₁</span> <span class="o">:</span> <span class="n">neg_fn</span> <span class="n">μ₁</span><span class="o">)</span> <span class="o">(</span><span class="n">H₂</span> <span class="o">:</span> <span class="n">neg_fn</span> <span class="n">μ₂</span><span class="o">)</span> <span class="o">:</span> <span class="n">neg_fn</span> <span class="o">(</span><span class="n">μ₁</span> <span class="bp">+</span> <span class="n">μ₂</span><span class="o">)</span>
</code></pre></div>


<p>and then adjust the <code>intros</code> to <code>intro c</code> accordingly.</p>
<p>Or, it could even be given with implicit arguments</p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">sum_neg_fn_is_neg_fn</span> <span class="o">{</span><span class="n">μ₁</span> <span class="n">μ₂</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">ℚ</span><span class="o">}</span> <span class="o">(</span><span class="n">H₁</span> <span class="o">:</span> <span class="n">neg_fn</span> <span class="n">μ₁</span><span class="o">)</span> <span class="o">(</span><span class="n">H₂</span> <span class="o">:</span> <span class="n">neg_fn</span> <span class="n">μ₂</span><span class="o">)</span> <span class="o">:</span> <span class="n">neg_fn</span> <span class="o">(</span><span class="n">μ₁</span> <span class="bp">+</span> <span class="n">μ₂</span><span class="o">)</span>
</code></pre></div>


<p>since the functions can be inferred from <code>H₁</code> and <code>H₂</code>.</p>



<a name="203637990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203637990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mukesh Tiwari <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203637990">(Jul 12 2020 at 10:36)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span>  Thank you very much. I have a question: how did you find this  lemma   by lt_div_iff library search (to pattern match something in the assumptions and find the lemma)? What my understanding of library_search is: when I write library_search, it pattern matches the goal and try to come up with matching lemmas, and if it can not find any, then it fails.  I have no idea how to use library_search to pattern match in assumptions.</p>



<a name="203638442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203638442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203638442">(Jul 12 2020 at 10:52)</a>:</h4>
<p><span class="user-mention" data-user-id="239476">@Mukesh Tiwari</span> you can find <code>lt_div_iff</code> by guessing that this is what it is called. This is a really important technique. You try <code>lt_div</code> because one side is <code>a &lt; b / c</code> and then you hit ctrl-space and you can see all Lean theorems which have lt_div in, and you scroll up and down with the arrow keys to find the one you want. See <a href="https://youtu.be/bghu6jVt0SY?t=320">https://youtu.be/bghu6jVt0SY?t=320</a></p>
<div class="youtube-video message_inline_image"><a data-id="bghu6jVt0SY" href="https://youtu.be/bghu6jVt0SY?t=320"><img src="https://i.ytimg.com/vi/bghu6jVt0SY/default.jpg"></a></div>



<a name="203638982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203638982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mukesh Tiwari <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203638982">(Jul 12 2020 at 11:06)</a>:</h4>
<p>Thank you very much everyone for answering my questions patiently.</p>



<a name="203658502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/sum%20of%20two%20negligible%20function%20is%20also%20a%20negligible%20function/near/203658502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/sum.20of.20two.20negligible.20function.20is.20also.20a.20negligible.20function.html#203658502">(Jul 12 2020 at 20:04)</a>:</h4>
<p><span class="user-mention" data-user-id="239476">@Mukesh Tiwari</span> I wasn't able to guess what it was called in this case out of inexperience, so what I did was create a new goal with the single transform I wanted to do:</p>
<div class="codehilite"><pre><span></span><code><span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="n">μ₁</span> <span class="n">n</span> <span class="bp">*</span> <span class="err">↑</span><span class="n">n</span> <span class="bp">^</span> <span class="n">c</span> <span class="bp">&lt;</span> <span class="mi">1</span> <span class="bp">/</span> <span class="err">↑</span><span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">,</span> <span class="o">{</span> <span class="n">library_search</span> <span class="o">},</span>
</code></pre></div>


<p>Then Lean responded with</p>
<div class="codehilite"><pre><span></span><code><span class="n">Try</span> <span class="n">this</span><span class="o">:</span> <span class="n">exact</span> <span class="o">(</span><span class="n">lt_div_iff</span> <span class="n">hsqp</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">Hn₁</span>
</code></pre></div>


<p>and then I modified this suggested tactic to use <code>rw</code> since it could apply to both hypotheses.</p>
<p>One complication was that I knew the theorem would need to know <code>n^2 &gt; 0</code>, so I made sure to prove that first.  For <code>(4 : ℚ) ≤ (↑n : ℚ)^2</code>, I did a <code>norm_cast</code> first to turn it into <code>4 ≤ n^2</code>, since I figured there would be a theorem about this for the naturals already, and that's when I used <code>library_search</code> again, even though I probably could have guessed the name.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>