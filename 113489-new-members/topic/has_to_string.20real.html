---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/has_to_string.20real.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html">has_to_string real</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="199290844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199290844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Charlie Conneen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199290844">(May 31 2020 at 05:03)</a>:</h4>
<p>I have a type defined which is dependent on <code>list real</code>, and I would like to be able to use the <code>#eval</code> command on it. The issue is, reals don't have a way of converting them to strings, at least not that Lean could find when I typed out the following code:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="o">:</span> <span class="n">has_repr</span> <span class="n">R3</span> <span class="o">:=</span> <span class="bp">⟨λ</span> <span class="n">x</span> <span class="o">:</span> <span class="n">R3</span><span class="o">,</span> <span class="n">x</span><span class="bp">.</span><span class="mi">1</span><span class="bp">.</span><span class="n">to_string</span><span class="bp">⟩</span>
</code></pre></div>


<p>What is the solution to this? There are reals we can't write down, but all the ones we can write down can be represented by at least the corresponding equivalence class of Cauchy sequences in <code>rat</code>. Is there a way to define <code>real.to_string</code> in a nice way?</p>



<a name="199290971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199290971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199290971">(May 31 2020 at 05:07)</a>:</h4>
<p>how do you propose writing down an equivalence class of cauchy sequences in <code>rat</code>?</p>



<a name="199290984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199290984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199290984">(May 31 2020 at 05:07)</a>:</h4>
<p>why do you want to use <code>eval</code> on your structure?</p>



<a name="199290989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199290989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199290989">(May 31 2020 at 05:07)</a>:</h4>
<p>are there actually going to be concrete reals in there?</p>



<a name="199291092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291092" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Charlie Conneen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291092">(May 31 2020 at 05:10)</a>:</h4>
<p>Eventually I plan to take floats from real-world data, cut them off at some digit, and map them to rationals. So realistically I'll only be using the rationals, but would like the generalization to the reals for the purposes of my example.</p>



<a name="199291186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Charlie Conneen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291186">(May 31 2020 at 05:13)</a>:</h4>
<p>For writing down the equivalence class, if I were to construct a real number as an equivalence class, could I not just do it formally by giving it a sequence in <code>rat</code>? So we could just print the real number as that sequence in some way</p>



<a name="199291197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291197">(May 31 2020 at 05:13)</a>:</h4>
<p>It is not possible to write <code>real.to_string</code> computably</p>



<a name="199291237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291237">(May 31 2020 at 05:14)</a>:</h4>
<p>unless it prints <code>"this is a real"</code> on any input</p>



<a name="199291258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291258" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291258">(May 31 2020 at 05:15)</a>:</h4>
<p>There are no computable non-constant functions <code>real -&gt; bool</code></p>



<a name="199291265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Charlie Conneen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291265">(May 31 2020 at 05:15)</a>:</h4>
<p>I suppose that makes sense. To make <code>real.to_string</code>, one would have to take in an arbitrary real number and have an algorithm which outputs a string. But there are countably many strings :)</p>



<a name="199291311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291311">(May 31 2020 at 05:16)</a>:</h4>
<p>Even so, the representative of a real number is a cauchy sequence, which <em>eventually</em> converges to x but doesn't have to get there in a hurry</p>



<a name="199291333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291333">(May 31 2020 at 05:16)</a>:</h4>
<p>There is a cauchy sequence for pi that starts 0,0,0,0,0,...,0 with n 0's</p>



<a name="199291336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291336">(May 31 2020 at 05:16)</a>:</h4>
<p>same thing for e and sqrt 2 and every other real number</p>



<a name="199291344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291344">(May 31 2020 at 05:17)</a>:</h4>
<p>so you can ask questions about the sequence all day and still have no idea what real number is being described</p>



<a name="199291401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291401">(May 31 2020 at 05:18)</a>:</h4>
<p>We do have an open issue about computable reals: <a href="https://github.com/leanprover-community/mathlib/issues/1038">#1038</a> but I don't think anyone is working on it right now.</p>



<a name="199291413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291413">(May 31 2020 at 05:18)</a>:</h4>
<p>What I would recommend is using rationals, or floats or some other similar type that makes the approximation process explicit</p>



<a name="199291418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291418">(May 31 2020 at 05:19)</a>:</h4>
<p>Well, you could do slightly better - you could say "this might be the real number 0, but we don't know", or "we were unable even to guess what this real might be"</p>



<a name="199291422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291422">(May 31 2020 at 05:19)</a>:</h4>
<p>If the user has defined their real in any "normal" way, they might find this useful</p>



<a name="199291463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Charlie Conneen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291463">(May 31 2020 at 05:20)</a>:</h4>
<p>Ok, that's fair. Is there a way to do something like <code>real.to_debug_string</code>? Just, anything that's a little better than the thousands of lines of code I get when Lean spits out the internal representation</p>



<a name="199291473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Charlie Conneen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291473">(May 31 2020 at 05:20)</a>:</h4>
<p>If not, I think just temporarily using the rationals will be the plan</p>



<a name="199291475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291475">(May 31 2020 at 05:20)</a>:</h4>
<p>The reason this doesn't work is because <code>real</code> is a quotient, which means that you are <em>required</em> to prove that your answer is not dependent on the sequence chosen from the equivalence class. Something like a function that returns "it looks like 0" if you see a bunch of 0's is not stable under equivalence</p>



<a name="199291499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291499">(May 31 2020 at 05:22)</a>:</h4>
<p>It is possible to have a type that is classically equivalent to <code>real</code> but has more useful computational content (I believe that's what <a href="https://github.com/leanprover-community/mathlib/issues/1038">#1038</a> is about). The simplest thing is to have an explicit modulus of convergence, for example asserting that the n'th element of the sequence is within 2^-n of x</p>



<a name="199291558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291558">(May 31 2020 at 05:23)</a>:</h4>
<p>You can also cheat and use <code>quot.unquot</code> to escape the quotient computably but unsoundly, for diagnostic purposes. Then you can just print <code>the sequence starts 0,1,1.5,1.75,1.875</code> and let the user decide what to do with this info</p>



<a name="199291609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Charlie Conneen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291609">(May 31 2020 at 05:25)</a>:</h4>
<p>That's very interesting. I think then for now I'll just use rationals when I want to do any computation. I'll probably look more into computational formalisms soon enough...</p>



<a name="199291729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291729">(May 31 2020 at 05:28)</a>:</h4>
<p>If you care about performance, I would not suggest trying out computational reals unless you know what you are doing. Because functions are values here it becomes very haskell-ish and you have to be careful to memoize stuff to get reasonable performance</p>



<a name="199291734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199291734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199291734">(May 31 2020 at 05:28)</a>:</h4>
<p>rational numbers or fixed point arithmetic is much easier to reason about</p>



<a name="199297147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199297147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199297147">(May 31 2020 at 08:40)</a>:</h4>
<p>Another option is to work over an arbitrary ordered field (say) as far as possible, and then specialize to <code>real</code> for proving, and to <code>rat</code> for calculating</p>



<a name="199299640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199299640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199299640">(May 31 2020 at 10:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113489-new-members/topic/has_to_string.20real/near/199291558">said</a>:</p>
<blockquote>
<p>You can also cheat and use <code>quot.unquot</code> to escape the quotient computably but unsoundly, for diagnostic purposes. Then you can just print <code>the sequence starts 0,1,1.5,1.75,1.875</code> and let the user decide what to do with this info</p>
</blockquote>
<p>ooh ooh I bet it's 2</p>



<a name="199299700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199299700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199299700">(May 31 2020 at 10:05)</a>:</h4>
<p>Too bad... it was <code>37</code></p>



<a name="199299814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/has_to_string%20real/near/199299814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/has_to_string.20real.html#199299814">(May 31 2020 at 10:09)</a>:</h4>
<p>These questions are so hard. That one isn't even in OEIS</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>