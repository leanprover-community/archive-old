---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html">My first project: help with coercion?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="247822899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247822899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hugo Labrande <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247822899">(Jul 31 2021 at 20:32)</a>:</h4>
<p>Hello everyone, I recently found out about Lean and did some tutorials, and I really like the idea of contributing to mathlib (I'm a former math teacher, and the idea of being able to dive back in sounds appealing :D )<br>
For my first little project, I wanted to prove that the degree of the nth Chebyshev polynomial was n (super easy, inductive proof). My proof is rather complicated and I'll no doubt make it more efficient later ("suggest" has been rather unhelpful, unfortunately), but I'm stuck on the last few things, which are a bit silly and both have to do with coercion (I think? they both involve the ↑):</p>
<ul>
<li>proving that "<a href="http://r1.degree">r1.degree</a> = ↑(r1.nat_degree)"</li>
<li>proving that the degree of 2X is 1 : I want to use "nat_degree_C_mul_X", but it fails to unify (2 * X).nat_degree = 1 with (⇑C ?m_3 * X).nat_degree = 1<br>
Could anyone tell me what I'm missing, and how to get around these? I'd appreciate it very much :) Thank you!</li>
</ul>



<a name="247823069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247823069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247823069">(Jul 31 2021 at 20:38)</a>:</h4>
<p>Welcome! Would you be able to produce a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> with the goals you're stuck on?</p>



<a name="247823319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247823319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hugo Labrande <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247823319">(Jul 31 2021 at 20:44)</a>:</h4>
<p>Sure! I'll try to isolate these. (I can also post my 70-line proof with my 3 sorrys, if needed) Thank you!</p>



<a name="247823397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247823397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hugo Labrande <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247823397">(Jul 31 2021 at 20:48)</a>:</h4>
<p>Here, I spun these into two lemmas, each with one of the problems. Thanks :) <a href="/user_uploads/3121/b74ULUeaEgBzsSmagfDvfhP-/mwe.lean">mwe.lean</a></p>



<a name="247823438"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247823438" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247823438">(Jul 31 2021 at 20:48)</a>:</h4>
<p>A <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> would indeed be helpful, but I think <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.degree_eq_nat_degree">docs#polynomial.degree_eq_nat_degree</a> would help for the first issue</p>



<a name="247823447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247823447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247823447">(Jul 31 2021 at 20:49)</a>:</h4>
<p>Can you post code in zulip using <a href="https://github.com/leanprover-community/mathlib/wiki/Code-in-backticks">#backticks</a> ?</p>



<a name="247823531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247823531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hugo Labrande <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247823531">(Jul 31 2021 at 20:52)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.polynomial.degree</span>
<span class="kn">import</span> <span class="n">ring_theory.polynomial.chebyshev</span>
<span class="kn">import</span> <span class="n">analysis.complex.basic</span>

<span class="kd">noncomputable theory</span>
<span class="kn">namespace</span> <span class="n">polynomial.chebyshev</span>
<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kd">lemma</span> <span class="n">problem_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">T</span> <span class="n">ℂ</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">nat_degree</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">let</span> <span class="n">r1</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">X</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">m1</span> <span class="o">:</span> <span class="n">r1</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">X</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">refl</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">d1</span> <span class="o">:</span> <span class="n">r1.nat_degree</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span> <span class="kd">begin</span>
      <span class="n">rw</span> <span class="n">m1</span><span class="o">,</span>
      <span class="c">/-</span><span class="cm"> issue here -/</span>
      <span class="n">apply</span> <span class="n">nat_degree_C_mul_X</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">l1</span> <span class="o">:</span> <span class="n">r1.leading_coeff</span> <span class="bp">≠</span> <span class="mi">0</span> <span class="o">:=</span> <span class="kd">by</span> <span class="kd">begin</span>
      <span class="n">apply</span> <span class="n">coeff_ne_zero_of_eq_degree</span><span class="o">,</span>
      <span class="c">/-</span><span class="cm"> how to proceed?-/</span>
    <span class="kd">end</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="247823571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247823571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hugo Labrande <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247823571">(Jul 31 2021 at 20:52)</a>:</h4>
<p>Like this?</p>



<a name="247824661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247824661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247824661">(Jul 31 2021 at 21:24)</a>:</h4>
<p>I've cleaned up your code a bit, and added a few hints. The last sorry should be doable, but once you finish it off, I suggest trying to shorten the proof a bit.</p>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.polynomial.degree</span>
<span class="kn">import</span> <span class="n">ring_theory.polynomial.chebyshev</span>
<span class="kn">import</span> <span class="n">analysis.complex.basic</span>

<span class="kd">noncomputable theory</span>
<span class="kn">namespace</span> <span class="n">polynomial.chebyshev</span>
<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kd">lemma</span> <span class="n">problem_1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="o">(</span><span class="n">T</span> <span class="n">ℂ</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">nat_degree</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">set</span> <span class="n">r1</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">X</span> <span class="k">with</span> <span class="n">m1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">d1</span> <span class="o">:</span> <span class="n">r1.nat_degree</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">,</span>
  <span class="o">{</span>  <span class="n">rw</span> <span class="n">m1</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="mi">2</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℂ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">polynomial.C</span> <span class="mi">2</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">nat_degree_C_mul_X</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">two_ne_zero'</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">l1</span> <span class="o">:</span> <span class="n">r1.leading_coeff</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">apply</span> <span class="n">coeff_ne_zero_of_eq_degree</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">degree_eq_nat_degree</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">ne.def</span><span class="o">,</span> <span class="n">mul_eq_zero</span><span class="o">,</span> <span class="n">not_or_distrib</span><span class="o">],</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="n">_</span><span class="o">,</span> <span class="n">X_ne_zero</span><span class="o">⟩,</span>
    <span class="gr">sorry</span> <span class="o">},</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">end</span> <span class="n">polynomial.chebyshev</span>
</code></pre></div>
</div></div>



<a name="247824751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247824751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247824751">(Jul 31 2021 at 21:26)</a>:</h4>
<p>One thing that's a bit confusing here is that when you wrote <code>let r1 : polynomial ℂ := 2*X,</code>, lean considers the <code>2</code> as an element of <code>polynomial \C</code>. Whenever you have a ring <code>A</code>, lean lets you write <code>2 : A</code>. But it's a theorem that this agrees with <code>polynomial.C 2</code> in this case, and lean needs some hints to be able to see this.</p>



<a name="247824972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247824972" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247824972">(Jul 31 2021 at 21:33)</a>:</h4>
<p>Is <code>(2 : ℂ) • X</code> easier or harder to work with than <code>2*X</code>?</p>



<a name="247825013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247825013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kalle Kytölä <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247825013">(Jul 31 2021 at 21:34)</a>:</h4>
<p>As far as I can tell, the shorter syntax</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">set</span> <span class="n">r1</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">X</span> <span class="k">with</span> <span class="n">m1</span><span class="o">,</span>
</code></pre></div>
<p>has identical effect as your first two lines:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">let</span> <span class="n">r1</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">X</span><span class="o">,</span>
<span class="k">have</span> <span class="n">m1</span> <span class="o">:</span> <span class="n">r1</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">X</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">refl</span><span class="o">,</span>
</code></pre></div>
<p>I think it is convenient to use <code>set ... with</code> instead of <code>let</code> most of the time. (Actually are there any benefits to <code>let</code>? It is a bit unfortunate that <em>let</em> is common in written math, but not so convenient in Lean.)</p>
<p>Regarding the actual question... It is possible to use e.g. <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.nat_degree_monomial">docs#polynomial.nat_degree_monomial</a> together with <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.monomial_eq_C_mul_X">docs#polynomial.monomial_eq_C_mul_X</a> , but I'm almost sure that Adam's answer is better (in particular explains why the latter lemma was needed).</p>



<a name="247825014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247825014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247825014">(Jul 31 2021 at 21:34)</a>:</h4>
<p>My inclination would be to say that <code>\smul</code> would be easier in this case, but I haven't tried.</p>



<a name="247825128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247825128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247825128">(Jul 31 2021 at 21:38)</a>:</h4>
<p>Also, it seems that we're missing some instances: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.polynomial.degree</span>
<span class="kn">import</span> <span class="n">ring_theory.polynomial.chebyshev</span>
<span class="kn">import</span> <span class="n">analysis.complex.basic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">char_zero</span> <span class="n">ℂ</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply_instance</span>
<span class="kd">example</span> <span class="o">:</span> <span class="n">char_zero</span> <span class="o">(</span><span class="n">polynomial</span> <span class="n">ℂ</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply_instance</span> <span class="c1">-- fails</span>
</code></pre></div>



<a name="247827046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/My%20first%20project%3A%20help%20with%20coercion%3F/near/247827046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Hugo Labrande <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/My.20first.20project.3A.20help.20with.20coercion.3F.html#247827046">(Jul 31 2021 at 22:36)</a>:</h4>
<p>Thank you so much everybody! I'm going to take a look at all that. I also appreciate the hints to shorten proofs; I was wondering how you used "let" definitions as propositions (for rewriting for instance) so that really helps!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>