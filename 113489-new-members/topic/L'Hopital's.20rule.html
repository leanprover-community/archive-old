---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/L'Hopital's.20rule.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html">L'Hopital's rule</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="202195781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202195781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202195781">(Jun 27 2020 at 17:13)</a>:</h4>
<p>(deleted)</p>



<a name="202195827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202195827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202195827">(Jun 27 2020 at 17:14)</a>:</h4>
<p>(deleted)</p>



<a name="202195925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202195925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202195925">(Jun 27 2020 at 17:16)</a>:</h4>
<p>Ok so after the harmonic series thing, which I still have to PR, I've been working on proving L'Hopital's rule, which is also one of the 100 theorems. I based myself upon the proof given here <a href="https://fr.wikiversity.org/wiki/Fonctions_d%27une_variable_r%C3%A9elle/D%C3%A9rivabilit%C3%A9#Th%C3%A9or%C3%A8mes_sur_la_d%C3%A9rivation">https://fr.wikiversity.org/wiki/Fonctions_d%27une_variable_r%C3%A9elle/D%C3%A9rivabilit%C3%A9#Th%C3%A9or%C3%A8mes_sur_la_d%C3%A9rivation</a> (in French), and I got this. Of course there is still a lot to do :</p>
<ul>
<li>get rid of the "continuity on [a,b[" hypothesis by extending the functions</li>
<li>prove the case where we take the limit at the right bound of derivability interval</li>
<li>deduce the case where we take the limit in the middle of derivability interval</li>
<li>and others...</li>
</ul>
<p>Here is the current proof, I'll take any advice !</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">deriv</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">mean_value</span>

<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">cancel_denoms</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span> <span class="n">dense_inducing</span>

<span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">classical</span><span class="bp">.</span><span class="n">prop_decidable</span>

<span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span>
    <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="bp">→</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">)</span> <span class="n">l</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="o">(</span><span class="n">tendsto_congr&#39;</span> <span class="o">(</span><span class="n">mem_inf_sets_of_right</span> <span class="o">(</span><span class="k">by</span> <span class="n">exact</span> <span class="n">h</span><span class="o">)))</span><span class="bp">.</span><span class="mi">1</span>

<span class="kn">lemma</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_of_eventually_within</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">β</span><span class="o">]</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">β</span><span class="o">}</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">β</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span>
    <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">l</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">b</span><span class="o">))</span> <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="bp">∀</span><span class="err">ᶠ</span> <span class="n">x</span> <span class="k">in</span> <span class="n">l</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">)</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">l</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">b</span> <span class="n">s</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">unfold</span> <span class="n">nhds_within</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">tendsto_inf</span><span class="o">,</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">tendsto_principal</span><span class="bp">.</span><span class="mi">2</span> <span class="n">h2</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">lhopital_right</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">{</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">ℝ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hdf</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">f</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span> <span class="o">(</span><span class="n">hdg</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">g</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hcf</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">f</span> <span class="o">(</span><span class="n">Ico</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span> <span class="o">(</span><span class="n">hcg</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">g</span> <span class="o">(</span><span class="n">Ico</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">),</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">hg&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">),</span> <span class="o">(</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hfa</span> <span class="o">:</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">hga</span> <span class="o">:</span> <span class="n">g</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdiv</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">f</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span> <span class="bp">/</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span><span class="o">))</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="k">have</span> <span class="n">sub1</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">Icc</span> <span class="n">a</span> <span class="n">x</span> <span class="err">⊆</span> <span class="n">Ico</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mem_Ioo</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span>
      <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mem_Icc</span> <span class="n">at</span> <span class="n">hy</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mem_Ico</span><span class="o">,</span>
      <span class="n">split</span><span class="o">,</span> <span class="n">linarith</span><span class="o">,</span> <span class="n">linarith</span><span class="o">},</span>
  <span class="k">have</span> <span class="n">sub2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">x</span> <span class="err">⊆</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mem_Ioo</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span>
      <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mem_Ioo</span> <span class="n">at</span> <span class="n">hy</span><span class="o">,</span>
      <span class="n">rw</span> <span class="n">mem_Ioo</span><span class="o">,</span>
      <span class="n">split</span><span class="o">,</span> <span class="n">linarith</span><span class="o">,</span> <span class="n">linarith</span><span class="o">},</span>
  <span class="k">have</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="bp">∃</span> <span class="n">c</span><span class="o">,</span> <span class="o">(</span><span class="n">x</span> <span class="err">∉</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">c</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">x</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">f</span><span class="o">)</span> <span class="n">c</span><span class="o">))),</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">by_cases</span> <span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">(</span><span class="k">show</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">f</span> <span class="n">a</span><span class="o">,</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">),</span>
    <span class="n">rw</span> <span class="o">(</span><span class="k">show</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">g</span> <span class="n">a</span><span class="o">,</span> <span class="k">by</span> <span class="n">linarith</span><span class="o">),</span>
    <span class="k">have</span> <span class="o">:=</span> <span class="n">exists_ratio_deriv_eq_ratio_slope</span> <span class="n">g</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="n">f</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">this</span> <span class="k">with</span> <span class="n">c</span> <span class="n">hc</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hc</span> <span class="k">with</span> <span class="n">hca</span> <span class="n">hcb</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">c</span><span class="o">,</span>
    <span class="n">right</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span> <span class="n">exact</span> <span class="n">hca</span><span class="o">,</span> <span class="n">exact</span> <span class="n">hcb</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rw</span> <span class="n">mem_Ioo</span> <span class="n">at</span> <span class="n">hx</span><span class="o">,</span> <span class="n">linarith</span> <span class="o">},</span>
    <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">mono</span> <span class="n">hcg</span> <span class="o">(</span><span class="n">sub1</span> <span class="n">x</span> <span class="n">hx</span><span class="o">),</span>
    <span class="n">exact</span> <span class="n">differentiable_on</span><span class="bp">.</span><span class="n">mono</span> <span class="n">hdg</span> <span class="o">(</span><span class="n">sub2</span> <span class="n">x</span> <span class="n">hx</span><span class="o">),</span>
    <span class="n">exact</span> <span class="n">continuous_on</span><span class="bp">.</span><span class="n">mono</span> <span class="n">hcf</span> <span class="o">(</span><span class="n">sub1</span> <span class="n">x</span> <span class="n">hx</span><span class="o">),</span>
    <span class="n">exact</span> <span class="n">differentiable_on</span><span class="bp">.</span><span class="n">mono</span> <span class="n">hdf</span> <span class="o">(</span><span class="n">sub2</span> <span class="n">x</span> <span class="n">hx</span><span class="o">),</span>
    <span class="n">use</span> <span class="mi">0</span><span class="o">,</span>
    <span class="n">left</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hx</span> <span class="o">},</span>
  <span class="n">choose</span> <span class="n">c</span> <span class="n">hc</span> <span class="kn">using</span> <span class="n">this</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="o">((</span><span class="bp">λ</span> <span class="n">x&#39;</span><span class="o">,</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">f</span><span class="o">)</span> <span class="n">x&#39;</span><span class="o">)</span> <span class="bp">/</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x&#39;</span><span class="o">))</span> <span class="err">∘</span> <span class="n">c</span><span class="o">)</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">/</span> <span class="n">g</span> <span class="n">x</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">unfold</span> <span class="n">function</span><span class="bp">.</span><span class="n">comp</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hc</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">exfalso</span><span class="o">,</span> <span class="n">exact</span> <span class="n">h</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h</span> <span class="k">with</span> <span class="n">ha</span> <span class="n">hb</span><span class="o">,</span>
    <span class="n">field_simp</span> <span class="o">[</span><span class="n">hg</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="n">hg&#39;</span> <span class="o">(</span><span class="n">c</span> <span class="n">x</span><span class="o">)</span> <span class="o">((</span><span class="n">sub2</span> <span class="n">x</span> <span class="n">hx</span><span class="o">)</span> <span class="n">ha</span><span class="o">)],</span>
    <span class="n">symmetry</span><span class="o">,</span>
    <span class="n">rwa</span> <span class="n">mul_comm</span> <span class="o">(</span><span class="n">deriv</span> <span class="n">f</span> <span class="o">(</span><span class="n">c</span> <span class="n">x</span><span class="o">))</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">cmp</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">c</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">c</span> <span class="n">x</span> <span class="bp">&lt;</span> <span class="n">x</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">hc</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">hc</span><span class="o">,</span>
    <span class="n">exfalso</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hc</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hc</span><span class="bp">.</span><span class="mi">1</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="err">←</span> <span class="n">nhds_within_Ioo_eq_nhds_within_Ioi</span> <span class="n">hab</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_within_of_eq_within</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">change</span> <span class="n">tendsto</span> <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">),</span> <span class="n">deriv</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">/</span> <span class="n">deriv</span> <span class="n">g</span> <span class="n">x</span><span class="o">)</span> <span class="err">∘</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span> <span class="n">l</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">tendsto</span><span class="bp">.</span><span class="n">comp</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hdiv</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds_of_eventually_within</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">tendsto_of_tendsto_of_tendsto_of_le_of_le&#39;</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">tendsto_const_nhds</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">tendsto_nhds_within_of_tendsto_nhds</span> <span class="n">tendsto_id</span><span class="o">,</span>
  <span class="n">repeat</span>
  <span class="o">{</span> <span class="n">use</span> <span class="n">univ</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">univ_sets</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">split</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">mem_principal_self</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">univ_inter</span><span class="o">,</span>
    <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">mem_set_of_eq</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:=</span> <span class="n">cmp</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">try</span> <span class="o">{</span><span class="n">rw</span> <span class="n">mem_Ioi</span><span class="o">},</span>
    <span class="n">try</span> <span class="o">{</span><span class="n">unfold</span> <span class="n">id</span><span class="o">},</span>
    <span class="n">linarith</span> <span class="o">},</span>
<span class="kn">end</span>
</code></pre></div>



<a name="202196799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202196799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202196799">(Jun 27 2020 at 17:40)</a>:</h4>
<p>Cool! It's really nice to see this being done!<br>
(However, don't forget to PR to mathlib. It's not easy, I know. But if you don't do it, your code will rot away.)</p>



<a name="202196834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202196834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202196834">(Jun 27 2020 at 17:41)</a>:</h4>
<p>One thing that I don't know (analysis is not my strongest point)... is there "one l'Hopital to rule them all"? A generalisation of the infty and -infty, and 0, cases?</p>



<a name="202200690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202200690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202200690">(Jun 27 2020 at 19:12)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113489-new-members/topic/L'Hopital's.20rule/near/202196799">said</a>:</p>
<blockquote>
<p>Cool! It's really nice to see this being done!<br>
(However, don't forget to PR to mathlib. It's not easy, I know. But if you don't do it, your code will rot away.)</p>
</blockquote>
<p>Do you talk about PR-ing this or the harmonic series ?</p>



<a name="202201247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202201247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202201247">(Jun 27 2020 at 19:25)</a>:</h4>
<p>Both (-;</p>



<a name="202201254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202201254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202201254">(Jun 27 2020 at 19:25)</a>:</h4>
<p>But this is maybe not completely ready? I didn't look carefully</p>



<a name="202201259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202201259" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202201259">(Jun 27 2020 at 19:25)</a>:</h4>
<p>No it isn't</p>



<a name="202204398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202204398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202204398">(Jun 27 2020 at 20:50)</a>:</h4>
<p>You don't have to assume that <code>g</code> doesn't vanish on<code>Ioo a b</code>, it follows from the assumption on <code>g a</code> (provided you modify <code>g</code> by insisting <code>g a</code> = 0<code>) , the assumption on </code>g'` and Rolle.</p>



<a name="202204420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202204420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202204420">(Jun 27 2020 at 20:50)</a>:</h4>
<p>You can shorten things using <code>Icc_subset_Ico_right</code> and its friends.</p>



<a name="202205785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202205785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202205785">(Jun 27 2020 at 21:29)</a>:</h4>
<p>Also, the end of the proof would be easier using</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">eventually_nhds_with_of_forall</span>
  <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">}</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">p</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span><span class="err">ᶠ</span> <span class="n">x</span> <span class="k">in</span> <span class="n">nhds_within</span> <span class="n">a</span> <span class="n">s</span><span class="o">,</span> <span class="n">p</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">mem_inf_sets_of_right</span> <span class="n">h</span>
</code></pre></div>



<a name="202206023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202206023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202206023">(Jun 27 2020 at 21:36)</a>:</h4>
<p>It is indeed</p>



<a name="202206045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202206045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202206045">(Jun 27 2020 at 21:36)</a>:</h4>
<p>Do you think L'Hopital's rule is useful enough to get into Mathlib ?</p>



<a name="202206260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202206260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202206260">(Jun 27 2020 at 21:42)</a>:</h4>
<p>It doesn't have to be that useful to get into mathlib. And the fact that it needs several new lemmas about <code>nhds_within</code> is good.</p>



<a name="202219322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202219322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202219322">(Jun 28 2020 at 04:31)</a>:</h4>
<p>If this is on Freek's list then mathlib will almost surely find a place for it</p>



<a name="202234597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202234597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202234597">(Jun 28 2020 at 12:26)</a>:</h4>
<p>Do we have a canonical way to extend functions ? Right now, my strategy to get rid of the "continuous on [a,b[" hypothesis is to use the functions <code>(λ x, cond (x ∈ Ioo a b) (f x) 0)</code> and <code>(λ x, cond (x ∈ Ioo a b) (g x) 0)</code>, but proving all the hypothesis to use the original lemma are true is a nightmare, and I'm still struggling to prove that these are continuous on [a,b[. So I feel like, maybe, there is something better I should be using ?</p>



<a name="202240883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202240883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202240883">(Jun 28 2020 at 15:18)</a>:</h4>
<p>Now I'm really hoping there isn't cause I managed to do it with this. Btw this made me state and prove a few lemmas about <code>continuous_within_at</code></p>



<a name="202246046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202246046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202246046">(Jun 28 2020 at 17:29)</a>:</h4>
<p>The thing I know in this direction is <a href="https://leanprover-community.github.io/mathlib_docs/find/continuous_if">docs#continuous_if</a></p>



<a name="202875924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202875924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202875924">(Jul 04 2020 at 14:24)</a>:</h4>
<p>Ok so I managed to prove the rule for the cases where we wanna compute the limit of f/g at some real value, and I'm now working on the case where we're interested in the limit at +inf. I have a paper proof on the following lemma : </p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">calculus</span><span class="bp">.</span><span class="n">mean_value</span>

<span class="kn">open</span> <span class="n">filter</span> <span class="n">set</span>

<span class="kn">theorem</span> <span class="n">lhopital_zero_at_top_nhds</span> <span class="o">{</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hdf</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">f</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="o">(</span><span class="n">hdg</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">g</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hg&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">),</span> <span class="o">(</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hftop</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="n">at_top</span> <span class="o">(</span><span class="n">nhds</span> <span class="mi">0</span><span class="o">))</span> <span class="o">(</span><span class="n">hgtop</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="n">at_top</span> <span class="o">(</span><span class="n">nhds</span> <span class="mi">0</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hdiv</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">f</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span> <span class="bp">/</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span> <span class="n">at_top</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">l</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span><span class="o">))</span> <span class="n">at_top</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">l</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>


<p>which you can see here : <a href="https://drive.google.com/file/d/1nEaHw6D1B_diIVgHWxDyJu0XZo754RPq/view?usp=sharing">https://drive.google.com/file/d/1nEaHw6D1B_diIVgHWxDyJu0XZo754RPq/view?usp=sharing</a><br>
But I am struggling writing this in term of filters, especially because of the <code>epsilon / 2</code>, because you can't divide a neighborhood set x)</p>



<a name="202875942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202875942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202875942">(Jul 04 2020 at 14:25)</a>:</h4>
<p>Maybe there's a more direct proof working for all filters, not only <code>nhds l</code>. I managed to do this for the finite case, but I can't wrap my head around how I should do this here</p>



<a name="202875989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202875989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202875989">(Jul 04 2020 at 14:26)</a>:</h4>
<p>(Btw sorry for my writing, I was too lazy to make a Latex doc)</p>



<a name="202876524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202876524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202876524">(Jul 04 2020 at 14:38)</a>:</h4>
<p>What you wrote on "paper" doesn't seem to match your formal statement, and seems weird.</p>



<a name="202876630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202876630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202876630">(Jul 04 2020 at 14:41)</a>:</h4>
<p>Oh I forgot to write down a few things that were in my head, I'll reupload it soon</p>



<a name="202877298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202877298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202877298">(Jul 04 2020 at 14:58)</a>:</h4>
<p>Is this <a href="https://drive.google.com/file/d/1c768NAsdmsuoFfQNmU-1CVBkQlIlNGJN/view?usp=sharing">https://drive.google.com/file/d/1c768NAsdmsuoFfQNmU-1CVBkQlIlNGJN/view?usp=sharing</a> any better ? I thought of that "proof" at 1am, so it may be completely wrong</p>



<a name="202877624"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202877624" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202877624">(Jul 04 2020 at 15:07)</a>:</h4>
<p>I don't have time to read the details now but it certainly looks much better</p>



<a name="202877633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202877633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202877633">(Jul 04 2020 at 15:07)</a>:</h4>
<p>since it starts with listing assumptions</p>



<a name="202877673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202877673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202877673">(Jul 04 2020 at 15:08)</a>:</h4>
<p>Indeed <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="202879082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202879082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202879082">(Jul 04 2020 at 15:42)</a>:</h4>
<p>Hmmm this still doesn't seem satisfying to me so I'll try another approach</p>



<a name="202887768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202887768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202887768">(Jul 04 2020 at 19:22)</a>:</h4>
<p>That was definitely a good idea. I should never listen to 1am me</p>



<a name="202989566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/202989566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#202989566">(Jul 06 2020 at 13:39)</a>:</h4>
<p>Before I go further, either by writing a PR or working on cases where <code>g -&gt; infinity</code>, I'd like to know your thoughts on what I already did, which is here : <a href="https://gitlab.com/Someody42/lhopital">https://gitlab.com/Someody42/lhopital</a> (sorry, I just realized there's no lean syntax highlighting on Gitlab, if someone knows about Ruby we can maybe fix that). Again, this is just me being nervous about PR-ing some absolute nonsense or anything like that, so thanks in advance for your help !</p>



<a name="203022480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203022480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203022480">(Jul 06 2020 at 18:11)</a>:</h4>
<p>I had a quick look. I'm not sure we can avoid stating many variations, but certainly the proofs shouldn't be repeated like that.</p>



<a name="203022535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203022535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203022535">(Jul 06 2020 at 18:11)</a>:</h4>
<p>I think a good starting point is to state and prove more general versions of Rolle.</p>



<a name="203022661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203022661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203022661">(Jul 06 2020 at 18:13)</a>:</h4>
<p>You should need to assume continuity on the closed interval, and also need the version where the interval is infinite.</p>



<a name="203022742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203022742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203022742">(Jul 06 2020 at 18:13)</a>:</h4>
<p>Does anyone has Bourbaki "Fonction d'une variable réelle" at hand? If they cover this L'Hopital rule we can certainly take inspiration.</p>



<a name="203023401"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203023401" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203023401">(Jul 06 2020 at 18:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/L'Hopital's.20rule/near/203022480">said</a>:</p>
<blockquote>
<p>I had a quick look. I'm not sure we can avoid stating many variations, but certainly the proofs shouldn't be repeated like that.</p>
</blockquote>
<p>I hope so. I thought I'd avoid it by reducing every other case to the first one using composition, but 1) it ends up being almost as long as if I just copy-pasted the whole proof, and 2) there is also some parts of the composition mess that I ended up copy-pasting, so I would say my objective wasn't really fulfilled</p>



<a name="203028356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203028356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203028356">(Jul 06 2020 at 19:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/L'Hopital's.20rule/near/203022742">said</a>:</p>
<blockquote>
<p>Does anyone has Bourbaki "Fonction d'une variable réelle" at hand? If they cover this L'Hopital rule we can certainly take inspiration.</p>
</blockquote>
<p>I do, but I've glanced through chapter 1 and I can't see it in there.</p>



<a name="203028694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203028694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203028694">(Jul 06 2020 at 19:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/L'Hopital's.20rule/near/203022742">said</a>:</p>
<blockquote>
<p>Does anyone has Bourbaki "Fonction d'une variable réelle" at hand? If they cover this L'Hopital rule we can certainly take inspiration.</p>
</blockquote>
<p>I am sure you know about this, but probably some young people don't. Since it's not completely legal though, I won't mention libgen here.</p>



<a name="203028878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203028878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203028878">(Jul 06 2020 at 19:10)</a>:</h4>
<p>My home ISP has blocked it! But actually Imperial gives me access to all Bourbaki online via our libary :D</p>



<a name="203029238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203029238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203029238">(Jul 06 2020 at 19:14)</a>:</h4>
<p>I am sure you know about this, but probably some young people don't. Since it's completely legal, let me say that you can use another DNS than your provider's, for instance Google's. It could unblock some things that are blocked just at the DNS level by your provider.</p>



<a name="203029385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203029385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Carl Friedrich Bolz-Tereick <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203029385">(Jul 06 2020 at 19:15)</a>:</h4>
<p>That, or the Wikipedia entry usually contains up-to-date info how to reach it (same for sci-hub which should also not be mentioned)</p>



<a name="203029709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203029709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203029709">(Jul 06 2020 at 19:19)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> <a href="https://universiteparissud.focus.universite-paris-saclay.fr/primo-explore/fulldisplay?docid=33UDPS_SFX1000000000282794&amp;context=L&amp;vid=33UDPS_VU1&amp;lang=fr_FR&amp;search_scope=default_scope&amp;adaptor=Local%20Search%20Engine&amp;tab=default_tab&amp;query=any,contains,fonctions%20d%27une%20variable%20r%C3%A9elle%20bourbaki&amp;offset=0&amp;pcAvailability=false">https://universiteparissud.focus.universite-paris-saclay.fr/primo-explore/fulldisplay?docid=33UDPS_SFX1000000000282794&amp;context=L&amp;vid=33UDPS_VU1&amp;lang=fr_FR&amp;search_scope=default_scope&amp;adaptor=Local%20Search%20Engine&amp;tab=default_tab&amp;query=any,contains,fonctions%20d%27une%20variable%20r%C3%A9elle%20bourbaki&amp;offset=0&amp;pcAvailability=false</a></p>



<a name="203029755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203029755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203029755">(Jul 06 2020 at 19:19)</a>:</h4>
<p>The legal way x)</p>



<a name="203033799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203033799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203033799">(Jul 06 2020 at 20:00)</a>:</h4>
<p>All those almost legal ways are still much less convenient that having the book in your hand, right? Bu thanks anyway</p>



<a name="203033832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203033832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203033832">(Jul 06 2020 at 20:00)</a>:</h4>
<p>Did anyone found what we are looking for in all those pdfs?</p>



<a name="203034490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203034490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203034490">(Jul 06 2020 at 20:05)</a>:</h4>
<p>I didn't <span aria-label="oh no" class="emoji emoji-1f615" role="img" title="oh no">:oh_no:</span> In mine it is just evoked as a special application of series expansion</p>



<a name="203034583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203034583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203034583">(Jul 06 2020 at 20:06)</a>:</h4>
<p>Under which assumptions?</p>



<a name="203034805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203034805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203034805">(Jul 06 2020 at 20:08)</a>:</h4>
<p>Where is that?</p>



<a name="203034831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203034831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203034831">(Jul 06 2020 at 20:08)</a>:</h4>
<p>Actually this is more of an historical reference, they don't even state it rigorously</p>



<a name="203034847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203034847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203034847">(Jul 06 2020 at 20:08)</a>:</h4>
<p>Oh</p>



<a name="203034861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203034861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203034861">(Jul 06 2020 at 20:08)</a>:</h4>
<p>It's in "historical reference"</p>



<a name="203034927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203034927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203034927">(Jul 06 2020 at 20:09)</a>:</h4>
<p>So no concrete math here (p 288)</p>



<a name="203034944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203034944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203034944">(Jul 06 2020 at 20:09)</a>:</h4>
<p>That's probably assuming differentiability at the point where you take the limit (which is of course the trivial case)</p>



<a name="203035007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203035007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203035007">(Jul 06 2020 at 20:10)</a>:</h4>
<p>Yup</p>



<a name="203035038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203035038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203035038">(Jul 06 2020 at 20:10)</a>:</h4>
<p>So it seems they didn't care about the non-trivial case.</p>



<a name="203035095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203035095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203035095">(Jul 06 2020 at 20:11)</a>:</h4>
<p>They don't even state several version of Rolle. Of course all variations are mathematically obviously equivalent to what they state.</p>



<a name="203035223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203035223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203035223">(Jul 06 2020 at 20:12)</a>:</h4>
<p>The wiki webpage that you cited a long time ago is actually extremely sloppy here. They write the usual version of Rolle and then seem to apply it without having the required assumptions.</p>



<a name="203035510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203035510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203035510">(Jul 06 2020 at 20:15)</a>:</h4>
<p>It works for the trivial case, but it soon starts to fail yes</p>



<a name="203036103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036103">(Jul 06 2020 at 20:20)</a>:</h4>
<p>Did you try to state and prove a version of Rolle where you assume <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo lspace="0em" mathvariant="normal" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">f'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> exists on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> tends to zero at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>?</p>



<a name="203036136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036136">(Jul 06 2020 at 20:20)</a>:</h4>
<p>beware of the stupid international notation for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">]</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo fence="true">[</mo></mrow><annotation encoding="application/x-tex">\left]a, b\right[</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">]</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose delimcenter" style="top:0em;">[</span></span></span></span></span></p>



<a name="203036294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036294">(Jul 06 2020 at 20:22)</a>:</h4>
<p>(still more logical than the whole "non increasing" nonsense <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span> ). Jokes aside I didn't, I'll look at it</p>



<a name="203036400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036400">(Jul 06 2020 at 20:23)</a>:</h4>
<p>Of course on paper there is nothing to say, you can just redefine <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> to  vanish at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span> and the conclusion of the theorem is unaffected while the assumption become standard.</p>



<a name="203036491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036491">(Jul 06 2020 at 20:24)</a>:</h4>
<p>But in Lean this could be painful. I don't even know if it would be easier to redo the proof or use the existing lemma.</p>



<a name="203036582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036582">(Jul 06 2020 at 20:25)</a>:</h4>
<p>I did work with redefining for <code>lhopital_zero_at_left_of_Ioo</code>, and it was quite painful indeed</p>



<a name="203036640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036640">(Jul 06 2020 at 20:26)</a>:</h4>
<p>Oh, why did you work with <code>cond</code> instead of <code>if</code>?</p>



<a name="203036704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036704">(Jul 06 2020 at 20:26)</a>:</h4>
<p><code>cond</code> is the <code>bool</code> version, this is for programming, not math.</p>



<a name="203036730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036730">(Jul 06 2020 at 20:26)</a>:</h4>
<p>Well... I didn't know about if yet <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="203036909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036909">(Jul 06 2020 at 20:28)</a>:</h4>
<p>But yeah that could simplify a lot of things indeed</p>



<a name="203036916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036916">(Jul 06 2020 at 20:28)</a>:</h4>
<p>It probably wouldn't change much, but you can write <code>λ x, if x ∈ Ioo a b then f x else 0</code></p>



<a name="203036935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036935">(Jul 06 2020 at 20:29)</a>:</h4>
<p>That probably have more useful lemmas already proved</p>



<a name="203036995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203036995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203036995">(Jul 06 2020 at 20:29)</a>:</h4>
<p>Such as the <code>continuous_if</code> you already mentioned...</p>



<a name="203037361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203037361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203037361">(Jul 06 2020 at 20:33)</a>:</h4>
<p><code>continuous_if</code> is not enough because it assumes too much. We need the version I wrote for the sphere eversion project.</p>



<a name="203037391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203037391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203037391">(Jul 06 2020 at 20:33)</a>:</h4>
<p><a href="https://github.com/leanprover-community/sphere-eversion/blob/master/src/gluing.lean#L107-L111">https://github.com/leanprover-community/sphere-eversion/blob/master/src/gluing.lean#L107-L111</a></p>



<a name="203037499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203037499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203037499">(Jul 06 2020 at 20:34)</a>:</h4>
<p>and its special case <a href="https://github.com/leanprover-community/sphere-eversion/blob/master/src/gluing.lean#L168-L170">https://github.com/leanprover-community/sphere-eversion/blob/master/src/gluing.lean#L168-L170</a></p>



<a name="203037607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203037607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203037607">(Jul 06 2020 at 20:35)</a>:</h4>
<p>except we need another special case of course.</p>



<a name="203037802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203037802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203037802">(Jul 06 2020 at 20:37)</a>:</h4>
<p>A bit like my <code>continuous_on_Ico_of_extend_continuous_Ioo</code> ?</p>



<a name="203037822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203037822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203037822">(Jul 06 2020 at 20:37)</a>:</h4>
<p>With ite rather than cond of course</p>



<a name="203037944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203037944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203037944">(Jul 06 2020 at 20:38)</a>:</h4>
<p>(in <code>lemmas.lean</code>)</p>



<a name="203037981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203037981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203037981">(Jul 06 2020 at 20:39)</a>:</h4>
<p>yes</p>



<a name="203038390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203038390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203038390">(Jul 06 2020 at 20:42)</a>:</h4>
<p>When I wanted to prove something like this I used <code>continuous_subtype_is_closed_cover</code>. We should probably have a version for two subsets.</p>



<a name="203038473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203038473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203038473">(Jul 06 2020 at 20:43)</a>:</h4>
<p>Oh this is a nice one.</p>



<a name="203038675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203038675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203038675">(Jul 06 2020 at 20:45)</a>:</h4>
<p>Wait, it doesn't help at all here, right?</p>



<a name="203038782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203038782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203038782">(Jul 06 2020 at 20:46)</a>:</h4>
<p>Which means mine also doesn't help.</p>



<a name="203038882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203038882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203038882">(Jul 06 2020 at 20:47)</a>:</h4>
<p><span aria-label="lol" class="emoji emoji-1f606" role="img" title="lol">:lol:</span> the statement of <a href="https://leanprover-community.github.io/mathlib_docs/find/exists_deriv_eq_zero">docs#exists_deriv_eq_zero</a> is really cute.</p>



<a name="203038976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203038976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203038976">(Jul 06 2020 at 20:48)</a>:</h4>
<p>Notice how it doesn't assume any differentiability.</p>



<a name="203039004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203039004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203039004">(Jul 06 2020 at 20:48)</a>:</h4>
<p>Yup, I did notice</p>



<a name="203039010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203039010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203039010">(Jul 06 2020 at 20:48)</a>:</h4>
<p>Because <code>deriv f</code> is defined to be zero at <code>x</code> if <code>f</code> is not differentiable at <code>x</code>.</p>



<a name="203039630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203039630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203039630">(Jul 06 2020 at 20:55)</a>:</h4>
<p>This is much more evil than <code>1/0</code>. I suggest Kevin doesn't mention this on twitter.</p>



<a name="203039661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203039661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203039661">(Jul 06 2020 at 20:55)</a>:</h4>
<p>Yeah, let's git blame that one.</p>



<a name="203039728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203039728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203039728">(Jul 06 2020 at 20:56)</a>:</h4>
<p>I guess Yury.</p>



<a name="203039783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203039783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203039783">(Jul 06 2020 at 20:57)</a>:</h4>
<p>If not you then certainly Yury</p>



<a name="203039826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203039826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203039826">(Jul 06 2020 at 20:57)</a>:</h4>
<p>GitHub says Yury but also  <a href="https://github.com/leanprover-community/mathlib/pull/1807#pullrequestreview-334554896">https://github.com/leanprover-community/mathlib/pull/1807#pullrequestreview-334554896</a></p>



<a name="203039925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203039925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203039925">(Jul 06 2020 at 20:58)</a>:</h4>
<p>Oh, I just found a way to put emoji reactions to my own messages.</p>



<a name="203040178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203040178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203040178">(Jul 06 2020 at 21:01)</a>:</h4>
<p>In fact, the assumptions of the theorem are too strong; you just need to assume continuity within <code>Icc a b</code> at the endpoints, not in the middle.</p>



<a name="203040335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203040335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203040335">(Jul 06 2020 at 21:02)</a>:</h4>
<p>Who would have guess we could make such huge progress on this classic theorem!</p>



<a name="203041181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203041181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203041181">(Jul 06 2020 at 21:11)</a>:</h4>
<p>Why not just define the derivative of a function that doesn't satisfy Rolle's theorem to be 0 and be done with it</p>



<a name="203041217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203041217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203041217">(Jul 06 2020 at 21:11)</a>:</h4>
<p>x)</p>



<a name="203042119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203042119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203042119">(Jul 06 2020 at 21:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/L'Hopital's.20rule/near/203036103">said</a>:</p>
<blockquote>
<p>Did you try to state and prove a version of Rolle where you assume <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo lspace="0em" mathvariant="normal" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">f'</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> exists on <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(a, b)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> tends to zero at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>?</p>
</blockquote>
<p>Why "<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> tends to zero at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>" ? I mean in my case that's what I need, but in general <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span></span></span></span> tends to the same <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mo>∈</mo><mi mathvariant="double-struck">R</mi></mrow><annotation encoding="application/x-tex">l\in\mathbb{R}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">R</span></span></span></span></span> at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span> should suffice, no ?</p>



<a name="203042153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203042153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203042153">(Jul 06 2020 at 21:20)</a>:</h4>
<p>Sure, that's what I meant</p>



<a name="203045145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203045145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203045145">(Jul 06 2020 at 21:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110050">Sebastien Gouezel</span> <a href="#narrow/stream/113489-new-members/topic/L'Hopital's.20rule/near/203040178">said</a>:</p>
<blockquote>
<p>In fact, the assumptions of the theorem are too strong; you just need to assume continuity within <code>Icc a b</code> at the endpoints, not in the middle.</p>
</blockquote>
<p>That's actually quite a big problem, because it means I cannot use it by redefining the function at a and b : it won't be continuous on <code>Icc a b</code> if it wasn't originally on <code>Ioo a b</code></p>



<a name="203045496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203045496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203045496">(Jul 06 2020 at 21:56)</a>:</h4>
<p>Guess I'll have to make variations of <code>exists_Ioo_extr_on_Icc</code> and <code>exists_local_extr_Ioo</code> too</p>



<a name="203045563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203045563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203045563">(Jul 06 2020 at 21:57)</a>:</h4>
<p>Maybe yes, maybe not.</p>



<a name="203047207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203047207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203047207">(Jul 06 2020 at 22:15)</a>:</h4>
<p>Rah, congr lemmas are really lacking sometimes. Anyway, I'll continue tomorrow</p>



<a name="203444879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203444879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203444879">(Jul 09 2020 at 21:44)</a>:</h4>
<p>Okay so, back after a 2-day lean break, I finally managed to prove this stronger Rolle : </p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">exists_deriv_eq_zero&#39;</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">l</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">(</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hfa</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">l</span><span class="o">))</span> <span class="o">(</span><span class="n">hfb</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">b</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">l</span><span class="o">))</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">c</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">deriv</span> <span class="n">f</span> <span class="n">c</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="203445148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203445148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203445148">(Jul 09 2020 at 21:46)</a>:</h4>
<p>Funny how we don't even need continuity for this one to work x)</p>



<a name="203445760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203445760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203445760">(Jul 09 2020 at 21:51)</a>:</h4>
<p>Note this is what Sébastien announced.</p>



<a name="203445801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203445801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203445801">(Jul 09 2020 at 21:51)</a>:</h4>
<p>It does look very fishy.</p>



<a name="203445918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203445918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203445918">(Jul 09 2020 at 21:52)</a>:</h4>
<p>But I can totally see the proof.</p>



<a name="203445955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203445955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203445955">(Jul 09 2020 at 21:52)</a>:</h4>
<p>This is insane.</p>



<a name="203446245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203446245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203446245">(Jul 09 2020 at 21:55)</a>:</h4>
<p>I claim that Lean damaged Sébastien's mind. Otherwise he wouldn't have immediately seen this statement.</p>



<a name="203446620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203446620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203446620">(Jul 09 2020 at 21:59)</a>:</h4>
<p>You're part of our secret society now, you must swear not to tell anyone about this lemma outside this place, even (especially?) in your family.</p>



<a name="203446636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203446636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203446636">(Jul 09 2020 at 21:59)</a>:</h4>
<p>This is just nuts</p>



<a name="203446784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203446784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203446784">(Jul 09 2020 at 22:00)</a>:</h4>
<p>The point is just that if it's not math-differentiable on the interval then the lean derivative is zero?</p>



<a name="203446803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203446803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203446803">(Jul 09 2020 at 22:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/L'Hopital's.20rule/near/203446620">said</a>:</p>
<blockquote>
<p>You're part of our secret society now, you must swear not to tell anyone about this lemma outside this place, even (especially?) in your family.</p>
</blockquote>
<p>I want to know what my father would say if I tell him what Sebastien told me to prove <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="203447051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203447051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203447051">(Jul 09 2020 at 22:02)</a>:</h4>
<p>I'm definitely going to mention this on Twitter</p>



<a name="203447076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203447076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203447076">(Jul 09 2020 at 22:03)</a>:</h4>
<p>Yes Kevin, if there is any point in the interior where <code>f</code> is not continuous then it's also not differentiable there, hence you can pick that point and the derivative there is zero by definition.</p>



<a name="203447258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203447258" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203447258">(Jul 09 2020 at 22:04)</a>:</h4>
<p>Kevin, you're a completely failed cabalist.</p>



<a name="203447324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203447324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203447324">(Jul 09 2020 at 22:05)</a>:</h4>
<p>If you really want to do that you should prepare explanation about about you still need the reasonable assumptions as soon as you want to deduce anything non empty from this.</p>



<a name="203447499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203447499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203447499">(Jul 09 2020 at 22:06)</a>:</h4>
<blockquote>
<p>I want to know what my father would say if I tell him what Sebastien told me to prove <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>
</blockquote>
<p>For those who didn't get this: Anatole's father is a mathematician who wrote several papers with Sébastien. Now I'm sure he'll blame Covid for not allowing Anatole to return to my university in September.</p>



<a name="203448020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203448020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203448020">(Jul 09 2020 at 22:11)</a>:</h4>
<p>I wouldn't say "several" though, I do only count 4 on my father's homepage (though it's a bit outdated, I'm supposed to work on that too <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span> )</p>



<a name="203515319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203515319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203515319">(Jul 10 2020 at 14:46)</a>:</h4>
<p>Little progress update : I have proven a similar version of Cauchy's mean value theorem : </p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">exists_ratio_deriv_eq_ratio_slope&#39;</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">lfa</span> <span class="n">lga</span> <span class="n">lfb</span> <span class="n">lgb</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">(</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hdf</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">f</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdg</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">g</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hfa</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">lfa</span><span class="o">))</span> <span class="o">(</span><span class="n">hga</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">lga</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hfb</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">b</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">lfb</span><span class="o">))</span> <span class="o">(</span><span class="n">hgb</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">b</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">lgb</span><span class="o">))</span> <span class="o">:</span>
<span class="bp">∃</span> <span class="n">c</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="o">(</span><span class="n">lgb</span> <span class="bp">-</span> <span class="n">lga</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">deriv</span> <span class="n">f</span> <span class="n">c</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">lfb</span> <span class="bp">-</span> <span class="n">lfa</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="n">deriv</span> <span class="n">g</span> <span class="n">c</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>


<p>Thus I can now prove </p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">lhopital_zero_at_left_of_Ioo</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">{</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">ℝ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hdf</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">f</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span> <span class="o">(</span><span class="n">hdg</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">g</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hg&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">),</span> <span class="o">(</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hfa</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="o">(</span><span class="n">nhds</span> <span class="mi">0</span><span class="o">))</span> <span class="o">(</span><span class="n">hga</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">g</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="o">(</span><span class="n">nhds</span> <span class="mi">0</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hdiv</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">f</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span> <span class="bp">/</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span><span class="o">))</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="n">l</span> <span class="o">:=</span>
</code></pre></div>


<p>without doing all the if-then-else stuff here, and most importantly without relying on the <code>Ico</code> version as I did before</p>



<a name="203517293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203517293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203517293">(Jul 10 2020 at 15:01)</a>:</h4>
<p>Which means the <code>Ico</code> version proof is now down to : </p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">lhopital_zero_at_left_of_Ico&#39;</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">{</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">l</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">ℝ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hdf</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">f</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span> <span class="o">(</span><span class="n">hdg</span> <span class="o">:</span> <span class="n">differentiable_on</span> <span class="n">ℝ</span> <span class="n">g</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hcf</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">f</span> <span class="o">(</span><span class="n">Ico</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span> <span class="o">(</span><span class="n">hcg</span> <span class="o">:</span> <span class="n">continuous_on</span> <span class="n">g</span> <span class="o">(</span><span class="n">Ico</span> <span class="n">a</span> <span class="n">b</span><span class="o">))</span>
  <span class="o">(</span><span class="n">hg&#39;</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="o">(</span><span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">),</span> <span class="o">(</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hfa</span> <span class="o">:</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">hga</span> <span class="o">:</span> <span class="n">g</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdiv</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">f</span><span class="o">)</span> <span class="n">x</span><span class="o">)</span> <span class="bp">/</span> <span class="o">((</span><span class="n">deriv</span> <span class="n">g</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="n">l</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">tendsto</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">/</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span><span class="o">))</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="o">(</span><span class="n">Ioi</span> <span class="n">a</span><span class="o">))</span> <span class="n">l</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">lhopital_zero_at_left_of_Ioo</span> <span class="n">f</span> <span class="n">g</span> <span class="n">hdf</span> <span class="n">hdg</span> <span class="n">hg&#39;</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">hfa</span><span class="o">,</span> <span class="err">←</span> <span class="n">nhds_within_Ioo_eq_nhds_within_Ioi</span><span class="o">],</span>
  <span class="n">exact</span> <span class="n">continuous_within_at</span><span class="bp">.</span><span class="n">tendsto</span> <span class="o">(</span><span class="n">continuous_within_at</span><span class="bp">.</span><span class="n">mono</span> <span class="o">(</span><span class="n">hcf</span> <span class="n">a</span> <span class="err">$</span> <span class="n">left_mem_Ico</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">hab</span><span class="o">)</span> <span class="n">Ioo_subset_Ico_self</span><span class="o">),</span>
  <span class="n">exact</span> <span class="n">hab</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">hga</span><span class="o">,</span> <span class="err">←</span> <span class="n">nhds_within_Ioo_eq_nhds_within_Ioi</span><span class="o">],</span>
  <span class="n">exact</span> <span class="n">continuous_within_at</span><span class="bp">.</span><span class="n">tendsto</span> <span class="o">(</span><span class="n">continuous_within_at</span><span class="bp">.</span><span class="n">mono</span> <span class="o">(</span><span class="n">hcg</span> <span class="n">a</span> <span class="err">$</span> <span class="n">left_mem_Ico</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">hab</span><span class="o">)</span> <span class="n">Ioo_subset_Ico_self</span><span class="o">),</span>
  <span class="n">exact</span> <span class="n">hab</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hdiv</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hab</span>
<span class="kn">end</span>
</code></pre></div>



<a name="203517474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203517474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anatole Dedecker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203517474">(Jul 10 2020 at 15:02)</a>:</h4>
<p>I just noticed both Rolle and Cauchy were originally written using <code>has_deriv</code>, should I do that too ?</p>



<a name="203525830"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203525830" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203525830">(Jul 10 2020 at 16:06)</a>:</h4>
<p>I think you can go back and forth between stating stuff with <code>has_deriv</code> and <code>differentiable_at</code>.</p>



<a name="203526328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/L%27Hopital%27s%20rule/near/203526328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/L'Hopital's.20rule.html#203526328">(Jul 10 2020 at 16:10)</a>:</h4>
<p>Anatole Dedecker <a href="#narrow/stream/113489-new-members/topic/L'Hopital's.20rule/near/203444879">said</a>:</p>
<blockquote>
<p>Okay so, back after a 2-day lean break, I finally managed to prove this stronger Rolle : </p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">exists_deriv_eq_zero&#39;</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">l</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">(</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hfa</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">l</span><span class="o">))</span> <span class="o">(</span><span class="n">hfb</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">b</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">l</span><span class="o">))</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">c</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">deriv</span> <span class="n">f</span> <span class="n">c</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>


</blockquote>
<p>I wanted to come back to this in case Kevin can't keep a secret. For the record, here is a proof that this statement contains the reasonable statement:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">rolle</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">l</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">}</span> <span class="o">(</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hfa</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">a</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">l</span><span class="o">))</span> <span class="o">(</span><span class="n">hfb</span> <span class="o">:</span> <span class="n">tendsto</span> <span class="n">f</span> <span class="o">(</span><span class="n">nhds_within</span> <span class="n">b</span> <span class="err">$</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">nhds</span> <span class="n">l</span><span class="o">))</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">differentiable_at</span> <span class="n">ℝ</span> <span class="n">f</span> <span class="n">x</span><span class="o">):</span>
  <span class="bp">∃</span> <span class="n">c</span> <span class="err">∈</span> <span class="n">Ioo</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="n">is_o</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">f</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">c</span><span class="o">)</span> <span class="o">(</span><span class="err">𝓝</span> <span class="n">c</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rcases</span> <span class="n">exists_deriv_eq_zero&#39;</span> <span class="n">f</span> <span class="n">hab</span> <span class="n">hfa</span> <span class="n">hfb</span> <span class="k">with</span> <span class="bp">⟨</span><span class="n">c</span><span class="o">,</span> <span class="n">c_in</span><span class="o">,</span> <span class="n">hc</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">use</span> <span class="o">[</span><span class="n">c</span><span class="o">,</span> <span class="n">c_in</span><span class="o">],</span>
  <span class="n">convert</span> <span class="n">differentiable_at</span><span class="bp">.</span><span class="n">has_deriv_at</span> <span class="o">(</span><span class="n">h</span> <span class="n">c</span> <span class="n">c_in</span><span class="o">),</span>
  <span class="n">ext</span> <span class="n">x</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hc</span><span class="o">],</span>
<span class="kn">end</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>