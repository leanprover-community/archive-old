---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/faster.20lean.20--make.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html">faster lean --make</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="269722713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269722713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269722713">(Jan 28 2022 at 11:41)</a>:</h4>
<p>When changing files down in the dependency chain, or after pulling <code>master</code> on a slow or expensive internet connection (so better no <code>leanproject get-cache</code>), I run <code>lean --make src/file/I/plan/to/edit.lean</code> before opening that file in vscode, and that can take a while.<br>
Does <code>lean --make</code> support a “fast mode” where it skips checking proofs in dependent files? At least those irrelevant proofs of <code>Prop</code> things? Or is that fundamentally not possible.</p>



<a name="269723022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269723022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269723022">(Jan 28 2022 at 11:44)</a>:</h4>
<p>maybe <code>--old</code> is what you're looking for? <a href="https://leanprover-community.github.io/tips_and_tricks.html#old-mode">here</a> is an overview of it</p>



<a name="269725310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269725310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269725310">(Jan 28 2022 at 12:04)</a>:</h4>
<p>Thanks!<br>
Not exactly what I had in mind, but also a good trick.  I assume that new lemmas will still be visible through transitive imports, even if the intermediate module’s old lean file was still used?</p>



<a name="269725311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269725311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269725311">(Jan 28 2022 at 12:04)</a>:</h4>
<p><code>lean --help</code> calls it <code>--old-oleans</code>. Is that the same? Should I update the docs to use the full flag name to avoid confusion?</p>



<a name="269725407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269725407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269725407">(Jan 28 2022 at 12:05)</a>:</h4>
<p>What I had in mind could maybe be rephrased as: “Replace every proof of a <code>lemma</code> that produces a <code>Prop</code> and has it’s result type fully spelled out with <code>by sorry</code>”</p>



<a name="269727936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269727936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269727936">(Jan 28 2022 at 12:29)</a>:</h4>
<p>huh, I thought it was just <code>--old</code> but the code disagrees  <a href="/user_uploads/3121/qXjvF23pSLIEsfvt4Wh3rhU_/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/qXjvF23pSLIEsfvt4Wh3rhU_/image.png" title="image.png"><img src="/user_uploads/3121/qXjvF23pSLIEsfvt4Wh3rhU_/image.png"></a></div>



<a name="269729483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269729483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269729483">(Jan 28 2022 at 12:43)</a>:</h4>
<p>Do you want to skip checking proofs, but still check definitions? Because if you skip those, your proofs that use defeq will fail.</p>



<a name="269750895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269750895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269750895">(Jan 28 2022 at 15:14)</a>:</h4>
<p>Right, that why I (very naively, I'm very new here) suggest that only for proofs that are irrelevant for downstream modules.</p>



<a name="269752711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269752711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269752711">(Jan 28 2022 at 15:24)</a>:</h4>
<p>I'm afraid namespaces and <code>@[simp]</code> lemmas make this task more challenging than we'd like, because building such dependency chain becomes a semantic task rather than purely syntactical</p>



<a name="269753741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269753741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269753741">(Jan 28 2022 at 15:31)</a>:</h4>
<p>Hmm, I don’t see it yet, can you elaborate?</p>



<a name="269754627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269754627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269754627">(Jan 28 2022 at 15:37)</a>:</h4>
<p>Suppose you have a file A in which <code>bar</code> is declared in the namespace <code>foo</code>. Then file B imports A and opens <code>foo</code> in order to use <code>bar</code>. Now, in the file C, <code>bar</code> is declared openly, even though it also imports A. B and C import A and make use of <code>bar</code> (without dots), but they're talking about different declarations of <code>bar</code></p>



<a name="269755278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269755278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269755278">(Jan 28 2022 at 15:41)</a>:</h4>
<p>It might be possible to figure that out with some meticulous parsing, but it doesn't look like an easy task to me.</p>
<p>And in the case of <code>simp</code> lemmas, it's really impossible to know they're being used just by parsing text files</p>



<a name="269755946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269755946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269755946">(Jan 28 2022 at 15:46)</a>:</h4>
<p>Using a lemma does not mean you necessarily need to know the proof of the lemma though. <code>simp [foo.bar]</code> doesn't care about the proof of <code>foo.bar</code>. The question is what would break if we replaced all proofs of lemmas by <code>sorry</code>.</p>



<a name="269756036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269756036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269756036">(Jan 28 2022 at 15:46)</a>:</h4>
<p>I think this was discussed long ago but I don't remember if there was a conclusion about whether a feature like this could work.</p>



<a name="269756947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269756947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269756947">(Jan 28 2022 at 15:53)</a>:</h4>
<p>Right, I am _not_ talking about only checking the “obvious dependencies” on a symbol level of the file I care about (that is hardly possible with <code>simp</code> and instances etc.), but about skipping the checking of (all irrelevant) proofs.<br>
Although that’s done in parallel anyways, isn’t it? So maybe it wouldn’t help that much.</p>



<a name="269758341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/faster%20lean%20--make/near/269758341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/faster.20lean.20--make.html#269758341">(Jan 28 2022 at 16:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="470149">Joachim Breitner</span> <a href="#narrow/stream/113489-new-members/topic/faster.20lean.20--make/near/269725311">said</a>:</p>
<blockquote>
<p><code>lean --help</code> calls it <code>--old-oleans</code>. Is that the same? Should I update the docs to use the full flag name to avoid confusion?</p>
</blockquote>
<p>You could update the doc if you like, it seems most people here just call it old though, as getopt_long is used, unambiguous abbreviations are allowed in command line args. Even the original PR description <a href="https://github.com/leanprover-community/lean/pull/208">https://github.com/leanprover-community/lean/pull/208</a> calls it old <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>