---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Playing.20with.20polynomials.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html">Playing with polynomials</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="210652189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210652189" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210652189">(Sep 20 2020 at 06:26)</a>:</h4>
<p>Hello, in an effort to play with polynomials in Lean I came up with the following,</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span>

<span class="kn">open</span> <span class="n">polynomial</span>

<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">P</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span> <span class="o">:=</span> <span class="mi">3</span> <span class="bp">*</span> <span class="n">X</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="mi">1</span>
<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">Q</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span> <span class="o">:=</span> <span class="mi">4</span> <span class="bp">*</span> <span class="n">X</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="mi">7</span> <span class="bp">*</span> <span class="n">X</span> <span class="bp">+</span> <span class="mi">6</span>

<span class="bp">#</span><span class="kn">check</span> <span class="n">P</span> <span class="bp">+</span> <span class="n">Q</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">P</span> <span class="bp">-</span> <span class="n">Q</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">P</span> <span class="bp">*</span> <span class="n">Q</span>
<span class="bp">#</span><span class="kn">check</span> <span class="n">P</span> <span class="bp">/</span><span class="err">ₘ</span> <span class="n">Q</span>

<span class="bp">#</span><span class="kn">eval</span> <span class="n">P</span> <span class="bp">+</span> <span class="n">Q</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">P</span> <span class="bp">-</span> <span class="n">Q</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">P</span> <span class="bp">*</span> <span class="n">Q</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">P</span> <span class="bp">/</span><span class="err">ₘ</span> <span class="n">Q</span>
</code></pre></div>


<p>The <code>#eval</code> lines give the error "code generation failed, VM does not have code for 'classical.choice'", and the definitions of <code>P</code> and <code>Q</code> demand the <code>noncomputable</code>. Is there some way around the noncomputability of polynomials, so that <code>#eval P + Q</code> gives <code>7 * X^2 + 7 * X + 7</code>?</p>



<a name="210652610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210652610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210652610">(Sep 20 2020 at 06:43)</a>:</h4>
<p>"If you want to calculate, use Python"</p>



<a name="210652657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210652657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210652657">(Sep 20 2020 at 06:44)</a>:</h4>
<p>(or use an older version of Lean/mathlib before we decided to make everything noncomputable)</p>



<a name="210652660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210652660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210652660">(Sep 20 2020 at 06:44)</a>:</h4>
<p>probably some version in 2018</p>



<a name="210653077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210653077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210653077">(Sep 20 2020 at 06:57)</a>:</h4>
<p>Ok.</p>



<a name="210660677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210660677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210660677">(Sep 20 2020 at 10:51)</a>:</h4>
<p>Or use a future version of Lean/mathlib with the <code>norm_poly</code> tactic</p>



<a name="210662989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210662989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210662989">(Sep 20 2020 at 11:44)</a>:</h4>
<p><span class="user-mention" data-user-id="209436">@Lucas Allen</span> can you please leave 2020, you've come to the wrong year. Please recalibrate a couple of years in either direction.</p>



<a name="210663316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210663316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210663316">(Sep 20 2020 at 11:52)</a>:</h4>
<p>I need a telephone booth emoji</p>



<a name="210663906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210663906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210663906">(Sep 20 2020 at 12:06)</a>:</h4>
<p>Polynomials used to be computable but this caused trouble with reasoning. Now they're noncomputable but apparently this causes problems with computation. Is Reid right that this can be fixed with a tactic?</p>



<a name="210663966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210663966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210663966">(Sep 20 2020 at 12:08)</a>:</h4>
<p>yes</p>



<a name="210663969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210663969" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210663969">(Sep 20 2020 at 12:08)</a>:</h4>
<p>just like <code>norm_num</code> but for polynomials</p>



<a name="210663990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210663990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210663990">(Sep 20 2020 at 12:09)</a>:</h4>
<p>The trick is the kind of "computation" you want is not the same as the <code>noncomputable</code> kind. For example, <code>norm_num</code> works on the reals too</p>



<a name="210666104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210666104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210666104">(Sep 20 2020 at 12:58)</a>:</h4>
<p>that there are two meanings of "computation": the Lean meaning, which is that you write a program that does it; the mathematical meaning, which is that you reduce something to a normal form.</p>



<a name="210669699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210669699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210669699">(Sep 20 2020 at 14:38)</a>:</h4>
<p>There's some trickery involved though, isn't there? Because norm_num doesn't _really_ work with reals, right? It can only make progress if all the reals are rational.</p>



<a name="210670016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670016">(Sep 20 2020 at 14:48)</a>:</h4>
<p>It really works with <code>expr</code>s that represent reals</p>



<a name="210670025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670025">(Sep 20 2020 at 14:48)</a>:</h4>
<p>Aah!</p>



<a name="210670032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670032">(Sep 20 2020 at 14:49)</a>:</h4>
<p>So why don't we teach it that sqrt(x)*sqrt(x)=x :-)</p>



<a name="210670104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670104">(Sep 20 2020 at 14:51)</a>:</h4>
<p>Like this?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">norm_num</span>

<span class="kn">example</span> <span class="o">:</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span> <span class="bp">*</span> <span class="n">real</span><span class="bp">.</span><span class="n">sqrt</span> <span class="mi">5</span> <span class="bp">=</span> <span class="mi">5</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">norm_num</span>
</code></pre></div>



<a name="210670258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670258" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670258">(Sep 20 2020 at 14:54)</a>:</h4>
<p>Thanks!</p>



<a name="210670266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670266">(Sep 20 2020 at 14:55)</a>:</h4>
<p>(I never knew it did that -- I had the wrong mental model)</p>



<a name="210670344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670344">(Sep 20 2020 at 14:57)</a>:</h4>
<p>I think the main obstruction to turning <code>norm_num</code> into something more like a computer algebra system is that it's not obvious (at least to me) what kind of organizational framework is appropriate</p>



<a name="210670350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670350">(Sep 20 2020 at 14:57)</a>:</h4>
<p>along with perhaps a lack of specific applications at the moment</p>



<a name="210670400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670400">(Sep 20 2020 at 14:58)</a>:</h4>
<p>I want to prove that <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>−</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">x^2-4</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span> is not irreduible without doing any work.</p>



<a name="210670412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670412">(Sep 20 2020 at 14:58)</a>:</h4>
<p>but for any computation you can do in a CAS, provided you can give a proof that the computation is correct (when it succeeds), there's no reason that something like <code>norm_num</code> couldn't be extended to do it</p>



<a name="210670417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670417">(Sep 20 2020 at 14:59)</a>:</h4>
<p>Actually I don't really want to prove this at all, I just want to prove stuff about DVRs etc. I don't have a specific application.</p>



<a name="210670421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670421">(Sep 20 2020 at 14:59)</a>:</h4>
<p>This example is pretty trivial because <code>ring</code> can already do the correctness proof</p>



<a name="210670434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670434">(Sep 20 2020 at 14:59)</a>:</h4>
<p>I guess sometimes I want to prove that y^2=x^3-4x has rank 0 (or 1 or whatever).</p>



<a name="210670435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670435">(Sep 20 2020 at 14:59)</a>:</h4>
<p>so you can "just" do the factorization in an untrusted program</p>



<a name="210670442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670442">(Sep 20 2020 at 15:00)</a>:</h4>
<p>and Cremona's software is not spitting out a formally verifiable thing here</p>



<a name="210670484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670484">(Sep 20 2020 at 15:00)</a>:</h4>
<p>Right, I think you skipped over a large range of difficulties there <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="210670506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670506">(Sep 20 2020 at 15:00)</a>:</h4>
<p>Nobody can prove the algorithm terminates, for starters</p>



<a name="210670523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670523">(Sep 20 2020 at 15:01)</a>:</h4>
<p>Well that's not actually a problem</p>



<a name="210670598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670598">(Sep 20 2020 at 15:03)</a>:</h4>
<p>Try telling that to the equation compiler</p>



<a name="210670608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670608">(Sep 20 2020 at 15:03)</a>:</h4>
<p>Of course I see what you mean, tactics are meta</p>



<a name="210670742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670742">(Sep 20 2020 at 15:06)</a>:</h4>
<p>For a procedure like this, there are two relevant outcomes:</p>
<ul>
<li>the procedure succeeds in producing an answer along with a correct proof</li>
<li>all other behavior: nontermination, answer but no certificate, certificate but it doesn't type check somehow</li>
</ul>



<a name="210670808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670808">(Sep 20 2020 at 15:08)</a>:</h4>
<p>If you can build a procedure which provably always has the first behavior then great, but in practice it's fine to have tactics that can fail, as long as they work when you need them to</p>



<a name="210670844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670844">(Sep 20 2020 at 15:09)</a>:</h4>
<p>since our goal is to compute the ranks of elliptic curves (or whatever), not prove an internal theorem "there exists an algorithm which computes the rank of every elliptic curve"</p>



<a name="210670897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210670897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210670897">(Sep 20 2020 at 15:10)</a>:</h4>
<p>which is good because that's an open problem</p>



<a name="210683579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210683579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210683579">(Sep 20 2020 at 20:24)</a>:</h4>
<p>FYI, this was a surprise to me as well. <code>norm_num</code> doesn't know anything about square roots, that's all <code>simp</code>'s work</p>



<a name="210683682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210683682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210683682">(Sep 20 2020 at 20:27)</a>:</h4>
<p>aha!</p>



<a name="210684454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210684454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210684454">(Sep 20 2020 at 20:42)</a>:</h4>
<p>Returning to the initial question, right now <code>#simp [P,Q] P + Q</code> just returns <code>3 * X ^ 2 + 1 + (4 * X ^ 2 + 7 * X + 6)</code>, but maybe it's possible to add some simp lemmas (or make a simp set?) to make it more "useful".</p>



<a name="210701054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701054">(Sep 21 2020 at 04:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113489-new-members/topic/Playing.20with.20polynomials/near/210662989">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="209436">Lucas Allen</span> can you please leave 2020, you've come to the wrong year. Please recalibrate a couple of years in either direction.</p>
</blockquote>
<p>I think practicing the art of impeccable timing is starting to pay off.</p>



<a name="210701161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701161">(Sep 21 2020 at 04:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="123965">Bryan Gin-ge Chen</span> <a href="#narrow/stream/113489-new-members/topic/Playing.20with.20polynomials/near/210684454">said</a>:</p>
<blockquote>
<p>Returning to the initial question, right now <code>#simp [P,Q] P + Q</code> just returns <code>3 * X ^ 2 + 1 + (4 * X ^ 2 + 7 * X + 6)</code>, but maybe it's possible to add some simp lemmas (or make a simp set?) to make it more "useful".</p>
</blockquote>
<p>I had a go at adding a simp lemma to see if it worked,</p>
<div class="codehilite"><pre><span></span><code><span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">X_add</span> <span class="o">:</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">X</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="bp">#</span><span class="n">simp</span> <span class="o">[</span><span class="n">X</span><span class="o">]</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">X</span>
</code></pre></div>


<p>It gives "monomial 1 1 + monomial 1 1", but I want "2 * X". I also tried <code>#simp [(X : polynomial ℤ)] X + X</code> but this gives "simplify tactic failed to simplify." Is there some way to get this to work?</p>



<a name="210701181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701181">(Sep 21 2020 at 04:43)</a>:</h4>
<p>Ooh, you don't want to put <code>X</code> in the simpset, rather put <code>X_add</code> between the <code>[]</code></p>



<a name="210701314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701314">(Sep 21 2020 at 04:47)</a>:</h4>
<p><code>#simp [X_add] X + X</code> gives "simplify tactic failed to simplify". Do I need to say something about it being a <code>ℤ</code> polynomial?</p>



<a name="210701358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701358">(Sep 21 2020 at 04:48)</a>:</h4>
<p>Aah, I guess you do</p>



<a name="210701372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701372">(Sep 21 2020 at 04:48)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">X_add</span> <span class="o">:</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">X</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="bp">#</span><span class="n">simp</span> <span class="o">[</span><span class="n">X_add</span><span class="o">]</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">X</span>
</code></pre></div>


<p>does this work?</p>



<a name="210701381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701381">(Sep 21 2020 at 04:49)</a>:</h4>
<p>Yes!</p>



<a name="210701694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701694">(Sep 21 2020 at 04:58)</a>:</h4>
<p>Why is this an invalid simp lemma?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">X_add</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">X</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">*</span> <span class="n">X</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">add_mul</span> <span class="err">↑</span><span class="n">a</span> <span class="err">↑</span><span class="n">b</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="210701699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210701699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210701699">(Sep 21 2020 at 04:59)</a>:</h4>
<p>Adding <code>@[simp]</code> gives a red squiggle.</p>



<a name="210702743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210702743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210702743">(Sep 21 2020 at 05:29)</a>:</h4>
<p><span class="user-mention" data-user-id="209436">@Lucas Allen</span> because the statement doesn't use <code>m</code></p>



<a name="210702881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210702881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210702881">(Sep 21 2020 at 05:33)</a>:</h4>
<p>Oh no.</p>



<a name="210702883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210702883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210702883">(Sep 21 2020 at 05:33)</a>:</h4>
<p>sorry.</p>



<a name="210703131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703131">(Sep 21 2020 at 05:39)</a>:</h4>
<p>I get a deterministic timeout with the following</p>
<div class="codehilite"><pre><span></span><code><span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">X_add</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">b</span> <span class="bp">*</span> <span class="n">X</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">*</span> <span class="n">X</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">add_mul</span> <span class="err">↑</span><span class="n">a</span> <span class="err">↑</span><span class="n">b</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">test</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span> <span class="bp">*</span> <span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="mi">5</span> <span class="bp">*</span> <span class="n">X</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">8</span> <span class="bp">*</span> <span class="n">X</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">X_add</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>I don't know why, and I hope it's not obvious again...</p>



<a name="210703266"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703266" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703266">(Sep 21 2020 at 05:42)</a>:</h4>
<p>What happens if you <code>rw</code> instead of <code>apply</code>?</p>



<a name="210703275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703275">(Sep 21 2020 at 05:43)</a>:</h4>
<p>I would have expected the apply to work though.</p>



<a name="210703717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703717">(Sep 21 2020 at 05:52)</a>:</h4>
<p>"rewrite tactic failed, did not find instance of the pattern in the target expression<br>
  ↑?m_1 * X + ↑?m_2 * X<br>
state:<br>
⊢ 3 * X + 5 * X = 8 * X"</p>
<p>no deterministic timeout though.</p>



<a name="210703779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703779">(Sep 21 2020 at 05:54)</a>:</h4>
<p>I'm wondering if it has something to do with the fact that <code>a * X</code> has type polynomial <code>ℤ</code>, and it's not <code>(a : ℤ) * X</code>.</p>



<a name="210703788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703788">(Sep 21 2020 at 05:54)</a>:</h4>
<p>But <code>(a : ℤ) * X</code> doesn't work.</p>



<a name="210703875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703875">(Sep 21 2020 at 05:57)</a>:</h4>
<p><code>lemma X_add (a b : ℤ) : a * (X : polynomial ℤ) + b * X = (a + b) * X :=</code>gives red squiggles under the <code>*</code>'s. It likes <code>lemma test : 3 * (X : polynomial ℤ) + 5 * (X) = 8 * X := </code> however.</p>



<a name="210703878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703878">(Sep 21 2020 at 05:57)</a>:</h4>
<p>Try <code>(3 : \Z)</code> instead</p>



<a name="210703893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703893">(Sep 21 2020 at 05:57)</a>:</h4>
<p>but rather, I think you should use <code>C</code> to create constant polynomials</p>



<a name="210703940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703940">(Sep 21 2020 at 05:58)</a>:</h4>
<p>Arguably, we should consider making <code>a \bu X</code> the standard way of multiplying by scalars, instead of <code>C a * X</code>.</p>



<a name="210703943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703943">(Sep 21 2020 at 05:58)</a>:</h4>
<p><code>lemma xxx : (3 : ℤ) * (X : polynomial ℤ) + (5 : ℤ) * (X) = (8 : ℤ) * X := </code>gives red squiggles under the *'s type mismatch error.</p>



<a name="210703952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210703952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210703952">(Sep 21 2020 at 05:58)</a>:</h4>
<p><code>((3 : \Z) * X : ...)</code> ?</p>



<a name="210704020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210704020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210704020">(Sep 21 2020 at 06:00)</a>:</h4>
<p>I think it was<code> (3 : \Z) * (X : ...)</code></p>



<a name="210704063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/210704063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lucas Allen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#210704063">(Sep 21 2020 at 06:01)</a>:</h4>
<p>It likes the <code>\bu</code>. Everything works now.</p>
<div class="codehilite"><pre><span></span><code><span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span> <span class="kn">lemma</span> <span class="n">X_add</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="err">•</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span> <span class="err">•</span> <span class="n">X</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="err">•</span> <span class="n">X</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">exact</span> <span class="o">(</span><span class="n">add_smul</span> <span class="n">a</span> <span class="n">b</span> <span class="n">X</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">xxx</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="err">•</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="mi">5</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="err">•</span> <span class="o">(</span><span class="n">X</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">8</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="err">•</span> <span class="n">X</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">X_add</span><span class="o">,</span>
<span class="kn">end</span>

<span class="bp">#</span><span class="n">simp</span> <span class="o">[</span><span class="n">X_add</span><span class="o">]</span> <span class="o">(</span><span class="mi">3</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="err">•</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="mi">5</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="err">•</span> <span class="o">(</span><span class="n">X</span><span class="o">)</span> <span class="c1">--(3 + 5) • X</span>
</code></pre></div>



<a name="243661361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243661361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243661361">(Jun 23 2021 at 14:38)</a>:</h4>
<p>This is the best I could come up with but I have a feeling it's not idiomatic (or correct?). Is there a way to eval directly into <code>polynomial R</code> ?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">aopsbook_v2_c6_em2</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℝ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">polynomial.mod</span> <span class="n">f</span> <span class="o">(</span><span class="n">polynomial.X</span> <span class="bp">-</span> <span class="n">polynomial.C</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">polynomial.C</span> <span class="o">(</span><span class="n">polynomial.eval</span> <span class="n">a</span> <span class="n">f</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="243661452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243661452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243661452">(Jun 23 2021 at 14:39)</a>:</h4>
<p>There is <code>eval\_2</code>, I think. It takes a ring hom as argument</p>



<a name="243661555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243661555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243661555">(Jun 23 2021 at 14:40)</a>:</h4>
<p>Maybe</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">open</span> <span class="n">polynomial</span>

<span class="bp">...</span> <span class="bp">=</span> <span class="n">aeval</span> <span class="n">f</span> <span class="o">(</span><span class="n">C</span> <span class="n">a</span><span class="o">)</span>
</code></pre></div>



<a name="243661637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243661637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243661637">(Jun 23 2021 at 14:40)</a>:</h4>
<p>Well from the <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.eval">docs#polynomial.eval</a>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">polynomial.eval</span> <span class="bp">=</span> <span class="n">polynomial.eval₂</span> <span class="o">(</span><span class="n">ring_hom.id</span> <span class="n">R</span><span class="o">)</span>
</code></pre></div>
<p>so it should land in R as well?</p>



<a name="243661799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243661799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243661799">(Jun 23 2021 at 14:41)</a>:</h4>
<p>No, if you pass it something different from <code>ring_hom.id R</code>... then you can land in another ring</p>



<a name="243661877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243661877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243661877">(Jun 23 2021 at 14:42)</a>:</h4>
<p>Hmmm <code>aeval f (C a)</code> typechecks.</p>



<a name="243661897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243661897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243661897">(Jun 23 2021 at 14:42)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">aopsbook_v2_c6_em2</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℝ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">polynomial.mod</span> <span class="n">f</span> <span class="o">(</span><span class="n">polynomial.X</span> <span class="bp">-</span> <span class="n">polynomial.C</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">polynomial.aeval</span> <span class="n">f</span> <span class="o">(</span><span class="n">polynomial.C</span> <span class="n">a</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="243662014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243662014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243662014">(Jun 23 2021 at 14:43)</a>:</h4>
<p>Doesn't <code>aeval f (C a)</code> mean "evaluate the constant polynomial <code>C a</code> at the point <code>f</code>? <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.aeval">docs#polynomial.aeval</a></p>



<a name="243662103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243662103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243662103">(Jun 23 2021 at 14:43)</a>:</h4>
<p>Ooh, so maybe you need to swap the arguments <span aria-label="see no evil" class="emoji emoji-1f648" role="img" title="see no evil">:see_no_evil:</span></p>



<a name="243662284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243662284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243662284">(Jun 23 2021 at 14:44)</a>:</h4>
<p>Yes, we want instead <code>aeval (C a) f</code>, which is the same as <code>C (aeval a f) = C (eval a f)</code>. (See e.g. my PR <a href="https://github.com/leanprover-community/mathlib/issues/8038">#8038</a>)</p>



<a name="243662331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243662331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243662331">(Jun 23 2021 at 14:45)</a>:</h4>
<p>Fantastic!</p>



<a name="243800493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243800493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243800493">(Jun 24 2021 at 15:09)</a>:</h4>
<p>Follow up question. I'd like to state the rational root theorem using a non generalized form (polynomial with integer coefficients and consider rational roots).</p>
<p>I therefore need to state that the polynomial has integer coefficient and that a fraction in <code>ℚ</code> is a root of the polynomial but that does not typechecks because I'm no authorized to evaluate the polynomial in <code>ℚ</code> if it's defined as <code>polynomial ℤ</code>. Example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">aopsbook_v2_c6_em6</span>
  <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℤ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h₀</span> <span class="o">:</span> <span class="n">p.gcd</span> <span class="n">q</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">is_root</span> <span class="n">P</span> <span class="o">(</span><span class="n">p</span><span class="o">:</span><span class="n">ℚ</span><span class="bp">/</span><span class="n">q</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">p</span> <span class="bp">∣</span> <span class="n">P.coeff</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">q</span> <span class="bp">∣</span> <span class="n">P.leading_coeff</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>
<p>What exactly does <code>polynomial R</code> mean? Does it mean that the coeffs are in <code>R</code>? Can one define a polynomial whose coefficient are in R1 but codomain/domain R2 ?</p>



<a name="243801177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801177">(Jun 24 2021 at 15:14)</a>:</h4>
<p>I think <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.aeval">docs#polynomial.aeval</a> should work?</p>



<a name="243801200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801200">(Jun 24 2021 at 15:14)</a>:</h4>
<p>Rephrasing, I'm surprised that <code>eval : R → polynomial R → R</code> or <code>is_root : polynomial R → R → Prop</code> and not <code>is_root: polynomial R → S → Prop</code> ?</p>



<a name="243801270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801270">(Jun 24 2021 at 15:15)</a>:</h4>
<p><span class="user-mention" data-user-id="243562">@Adam Topaz</span> what would be the syntax to use <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.aeval">docs#polynomial.aeval</a> here?</p>



<a name="243801305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801305">(Jun 24 2021 at 15:15)</a>:</h4>
<p>(and I would use that to specify that <code>p/q</code> is a root) ?</p>



<a name="243801356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801356">(Jun 24 2021 at 15:15)</a>:</h4>
<p>One sec I'll try to sketch some code</p>



<a name="243801523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801523">(Jun 24 2021 at 15:16)</a>:</h4>
<p>You can use <a href="https://leanprover-community.github.io/mathlib_docs/find/polynomial.map">docs#polynomial.map</a> to interpret a polynomial with integer coefficients as a polynomial with rational coefficients</p>



<a name="243801563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801563">(Jun 24 2021 at 15:17)</a>:</h4>
<p>Sure, you can do that too, but I think you can just use aeval in this case.</p>



<a name="243801721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801721">(Jun 24 2021 at 15:18)</a>:</h4>
<p>Interesting, and out of curiousity how do I define <code>(f : R →+* S)</code> for <code>ℤ</code> and <code>ℚ</code> ?</p>



<a name="243801784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801784">(Jun 24 2021 at 15:18)</a>:</h4>
<p>I presume it's <code>fraction_map ℤ ℚ</code> assuming that type checks ? <span aria-label="grimacing" class="emoji emoji-1f62c" role="img" title="grimacing">:grimacing:</span></p>



<a name="243801812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801812">(Jun 24 2021 at 15:19)</a>:</h4>
<p>Almost, <code>algebra_map ℤ ℚ</code></p>



<a name="243801822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801822">(Jun 24 2021 at 15:19)</a>:</h4>
<p>But I agree with Adam that <code>aeval</code> Is better</p>



<a name="243801993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243801993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243801993">(Jun 24 2021 at 15:20)</a>:</h4>
<p>In mathlib we tend to define an <code>algebra R S</code> instance if there's a canonical map <code>algebra_map R S : R →+* S</code>.</p>



<a name="243802013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802013">(Jun 24 2021 at 15:20)</a>:</h4>
<p>Something like this is what I had in mind:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.polynomial.basic</span>

<span class="k">#check</span> <span class="bp">@</span><span class="n">polynomial.aeval</span>

<span class="kd">example</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">ℤ</span> <span class="n">ℚ</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">apply_instance</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p.gcd</span> <span class="n">q</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">hh</span> <span class="o">:</span> <span class="n">polynomial.aeval</span> <span class="o">((</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">/</span> <span class="n">q</span><span class="o">)</span> <span class="n">f</span>  <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">true</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="243802140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802140">(Jun 24 2021 at 15:21)</a>:</h4>
<p>(sorry, the <code>#check</code> and first <code>example</code> were just a sanity check for myself ;) )</p>



<a name="243802142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802142">(Jun 24 2021 at 15:21)</a>:</h4>
<p>We also have <a href="https://leanprover-community.github.io/mathlib_docs/find/int.cast_ring_hom">docs#int.cast_ring_hom</a></p>



<a name="243802173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802173">(Jun 24 2021 at 15:22)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/fraction_map">docs#fraction_map</a> is more like <code>ring_hom</code>, in that <code>fraction_map ℤ ℚ</code> is the type of maps <code>ℤ → ℚ</code> that display <code>ℚ</code> as the fraction field of <code>ℤ</code></p>



<a name="243802421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802421">(Jun 24 2021 at 15:23)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="243562">@Adam Topaz</span>!</p>



<a name="243802452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802452">(Jun 24 2021 at 15:23)</a>:</h4>
<p>And thanks <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> and <span class="user-mention" data-user-id="238446">@Anne Baanen</span> things are getting much clearer to me \o/</p>



<a name="243802555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802555">(Jun 24 2021 at 15:24)</a>:</h4>
<p>Unfortunately it looks like we can't use dot notation for <code>polynomial.aeval</code> because it gives the evaluation as a ring hom.</p>



<a name="243802577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802577">(Jun 24 2021 at 15:24)</a>:</h4>
<p>I.e. <code>f.aeval ...</code> doesn't work</p>



<a name="243802824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243802824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243802824">(Jun 24 2021 at 15:26)</a>:</h4>
<p>Try it in Lean 4!</p>



<a name="243806547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243806547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243806547">(Jun 24 2021 at 15:52)</a>:</h4>
<p>So just to make sure I understand, <code>aeval</code> infers the mapping based on the types of the arguments and the right mapping is defined somewhere for it to pick it up automatically?</p>



<a name="243807469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243807469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243807469">(Jun 24 2021 at 15:58)</a>:</h4>
<p>Yes, there's a long list of "canonical" mappings at <a href="https://leanprover-community.github.io/mathlib_docs/find/algebra">docs#algebra</a></p>



<a name="243807518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243807518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243807518">(Jun 24 2021 at 15:59)</a>:</h4>
<p>(under <code>&gt; Instances</code>)</p>



<a name="243808640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243808640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243808640">(Jun 24 2021 at 16:07)</a>:</h4>
<p><span class="user-mention" data-user-id="249373">@Stanislas Polu</span> the <code>a</code> in <code>aeval</code> stands for <code>algebra</code>. So it infers the right mapping based on an algebra instance. Fortunately for you, any ring has a unique structure of a Z-algebra and I think this is an actual instance in mathlib. So presumably you should be able to use <code>aeval</code> to evaluate an integral polynomial at an element in any ring.</p>



<a name="243811809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/243811809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#243811809">(Jun 24 2021 at 16:32)</a>:</h4>
<p>Thanks! Makes sense <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="244139230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244139230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244139230">(Jun 28 2021 at 12:51)</a>:</h4>
<p>Hi! Me again <span aria-label="wave" class="emoji emoji-1f44b" role="img" title="wave">:wave:</span>  What would be an elegant way to define the k-th symmetric sum of the roots of a polynomial to prove that it's <code>(-1)^k*a_{n-k}/a_n</code> ?</p>



<a name="244139309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244139309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244139309">(Jun 28 2021 at 12:51)</a>:</h4>
<p>I've been looking for that theorem to no avail, and have no good idea on how to define such a summation?</p>



<a name="244139862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244139862" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244139862">(Jun 28 2021 at 12:56)</a>:</h4>
<p><span class="user-mention" data-user-id="249373">@Stanislas Polu</span> Note that there is <code>src/ring_theory/polynomial/symmetric.lean</code>, but I don't think it contains exactly what you want.</p>



<a name="244141950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244141950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244141950">(Jun 28 2021 at 13:13)</a>:</h4>
<p>Thanks! will look into it <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="244142083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244142083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244142083">(Jun 28 2021 at 13:14)</a>:</h4>
<p>(Seems quite unrelated indeed)</p>



<a name="244142252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244142252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244142252">(Jun 28 2021 at 13:15)</a>:</h4>
<p>Well, a more fleshed out version of that file would hopefully make it very easy to talk about the k-th symmetric sum, etc...</p>



<a name="244147127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244147127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244147127">(Jun 28 2021 at 13:51)</a>:</h4>
<p>Relatedly how can I describe a sum on a multiset (to describe a sum that depends on the roots of a polynomial)?</p>



<a name="244147333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244147333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244147333">(Jun 28 2021 at 13:52)</a>:</h4>
<p>If you have <code>s : multiset α</code> and you have a term <code>f x</code> for each <code>x ∈ s</code> that you want to add up, then you can use <code>(s.map f).sum</code> (see <a href="https://leanprover-community.github.io/mathlib_docs/find/multiset.map">docs#multiset.map</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/multiset.sum">docs#multiset.sum</a>).</p>



<a name="244147567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244147567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244147567">(Jun 28 2021 at 13:54)</a>:</h4>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span> Thanks!</p>



<a name="244147835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244147835" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stanislas Polu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244147835">(Jun 28 2021 at 13:56)</a>:</h4>
<p>Fantastic!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kn">import</span> <span class="n">data.polynomial</span>
<span class="kn">open</span> <span class="n">polynomial</span>

<span class="kd">theorem</span> <span class="n">aopsbook_v2_c6_ex7</span>
  <span class="o">(</span><span class="n">P</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℝ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="bp">-&gt;</span> <span class="n">ℝ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h₀</span> <span class="o">:</span> <span class="n">P</span> <span class="bp">=</span> <span class="o">(</span><span class="n">C</span> <span class="mi">3</span><span class="o">)</span><span class="bp">*</span><span class="n">X</span><span class="bp">^</span><span class="mi">3</span> <span class="bp">-</span> <span class="o">(</span><span class="n">C</span> <span class="mi">14</span><span class="o">)</span><span class="bp">*</span><span class="n">X</span><span class="bp">^</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">X</span> <span class="bp">+</span> <span class="n">C</span> <span class="mi">62</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">r</span><span class="o">,</span> <span class="n">f</span><span class="o">(</span><span class="n">r</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="bp">/</span><span class="o">(</span><span class="n">r</span><span class="bp">+</span><span class="mi">3</span><span class="o">))</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">P.roots.map</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="bp">=</span> <span class="mi">83</span><span class="bp">/</span><span class="mi">74</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="244192293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Playing%20with%20polynomials/near/244192293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Playing.20with.20polynomials.html#244192293">(Jun 28 2021 at 19:17)</a>:</h4>
<p>This does not look true to me. The cubic only has one real root and P.roots looks to me to be the multiset of real roots. Have I made a mistake?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>