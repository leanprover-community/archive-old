---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html">Is the denominator  LCD in rational addition?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="222234766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222234766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222234766">(Jan 10 2021 at 18:40)</a>:</h4>
<p>We have this theorem in <code>mathlib</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">add_num_denom</span> <span class="o">(</span><span class="n">q</span> <span class="n">r</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">+</span> <span class="n">r</span> <span class="bp">=</span>
  <span class="o">((</span><span class="n">q.num</span> <span class="bp">*</span> <span class="n">r.denom</span> <span class="bp">+</span> <span class="n">q.denom</span> <span class="bp">*</span> <span class="n">r.num</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">))</span> <span class="bp">/.</span> <span class="o">(</span><span class="bp">↑</span><span class="n">q.denom</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">r.denom</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:=</span>
</code></pre></div>
<p>Now suppose </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.rat.basic</span>

<span class="kd">variables</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℤ</span>
<span class="kd">variables</span> <span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span>
<span class="kd">def</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℚ</span> <span class="o">:=</span> <span class="n">a</span> <span class="bp">/</span> <span class="mi">2</span><span class="bp">^</span><span class="n">n</span>
<span class="kd">def</span> <span class="n">r</span> <span class="o">:</span> <span class="n">ℚ</span> <span class="o">:=</span> <span class="n">b</span> <span class="bp">/</span> <span class="mi">2</span><span class="bp">^</span><span class="n">m</span>
</code></pre></div>
<p><strong>Question:</strong> Does <code>(q+r).denom</code> actually look like <code>(↑q.denom * ↑r.denom : ℤ) </code>, or something else?  If it's that, can I rely on it in a proof?</p>
<p>I'm asking because somewhere in the code it says that Lean likes to keep the size of the denominator down to avoid space crunches in proofs.  In the above case, suppose <code>m ≥ n</code>.  Then</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">q</span> <span class="bp">*</span> <span class="n">r</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="mi">2</span><span class="bp">^</span><span class="n">m</span> <span class="bp">+</span> <span class="n">b</span><span class="bp">*</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span><span class="bp">/</span><span class="mi">2</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">)</span>
         <span class="bp">=</span> <span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="mi">2</span><span class="bp">^</span><span class="o">(</span><span class="n">m</span><span class="bp">-</span><span class="n">n</span><span class="o">)</span><span class="bp">*</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="bp">+</span><span class="n">b</span><span class="bp">*</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span><span class="bp">/</span><span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span><span class="bp">^</span><span class="n">m</span><span class="o">)</span>
         <span class="bp">=</span> <span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="mi">2</span><span class="bp">^</span><span class="o">(</span><span class="n">m</span><span class="bp">-</span><span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">/</span><span class="mi">2</span><span class="bp">^</span><span class="n">m</span>
</code></pre></div>
<p>in which case </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">q</span><span class="bp">+</span><span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">^</span><span class="n">m</span>
</code></pre></div>
<p>Or is it really</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">q</span><span class="bp">+</span><span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">^</span><span class="o">(</span><span class="n">m</span><span class="bp">+</span><span class="n">n</span><span class="o">)</span>
</code></pre></div>
<p>I need to know which way Lean behaves for a proof.</p>
<p>This is an interesting (to me) edge case where the proof might depend on an implementation detail which is not strictly a mathematical truth.</p>



<a name="222235422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222235422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222235422">(Jan 10 2021 at 18:58)</a>:</h4>
<p>Denom is a function on rationals so if two rationals are equal they must have equal denominators, hence it cannot depend om what you added together to get that rational.</p>



<a name="222237265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222237265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222237265">(Jan 10 2021 at 19:23)</a>:</h4>
<p>1/3 + 1/6 = 1/2</p>



<a name="222240279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240279">(Jan 10 2021 at 20:24)</a>:</h4>
<p>@Kenny Lau I'm trying to figure out if, under the hood, <code>1/3 + 1/6 = 1/2</code> as you say, or <code>9/18</code>.   If I just looked at </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">add_num_denom</span> <span class="o">(</span><span class="n">q</span> <span class="n">r</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="n">q</span> <span class="bp">+</span> <span class="n">r</span> <span class="bp">=</span>
  <span class="o">((</span><span class="n">q.num</span> <span class="bp">*</span> <span class="n">r.denom</span> <span class="bp">+</span> <span class="n">q.denom</span> <span class="bp">*</span> <span class="n">r.num</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">))</span> <span class="bp">/.</span> <span class="o">(</span><span class="bp">↑</span><span class="n">q.denom</span> <span class="bp">*</span> <span class="bp">↑</span><span class="n">r.denom</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:=</span>
</code></pre></div>
<p>I might think it was <code>9/18</code>.  What patch of code in Lean makes it <code>1/2</code>?</p>



<a name="222240319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240319">(Jan 10 2021 at 20:25)</a>:</h4>
<p>you need to look at the <strong>definition</strong> of <code>+</code></p>



<a name="222240323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240323">(Jan 10 2021 at 20:25)</a>:</h4>
<p>or <code>/.</code></p>



<a name="222240384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240384">(Jan 10 2021 at 20:26)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/3e7efd4ecd5d379932a89212eebd362beb01309e/src/data/rat/basic.lean">https://github.com/leanprover-community/mathlib/blob/3e7efd4ecd5d379932a89212eebd362beb01309e/src/data/rat/basic.lean</a><br>
L254:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_add</span> <span class="n">ℚ</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">rat.add</span><span class="o">⟩</span>
</code></pre></div>
<p>LL251-252:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">protected</span> <span class="kd">def</span> <span class="n">add</span> <span class="o">:</span> <span class="n">ℚ</span> <span class="bp">→</span> <span class="n">ℚ</span> <span class="bp">→</span> <span class="n">ℚ</span>
<span class="bp">|</span> <span class="o">⟨</span><span class="n">n₁</span><span class="o">,</span> <span class="n">d₁</span><span class="o">,</span> <span class="n">h₁</span><span class="o">,</span> <span class="n">c₁</span><span class="o">⟩</span> <span class="o">⟨</span><span class="n">n₂</span><span class="o">,</span> <span class="n">d₂</span><span class="o">,</span> <span class="n">h₂</span><span class="o">,</span> <span class="n">c₂</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">mk_pnat</span> <span class="o">(</span><span class="n">n₁</span> <span class="bp">*</span> <span class="n">d₂</span> <span class="bp">+</span> <span class="n">n₂</span> <span class="bp">*</span> <span class="n">d₁</span><span class="o">)</span> <span class="o">⟨</span><span class="n">d₁</span> <span class="bp">*</span> <span class="n">d₂</span><span class="o">,</span> <span class="n">mul_pos</span> <span class="n">h₁</span> <span class="n">h₂</span><span class="o">⟩</span>
</code></pre></div>
<p>LL73-86:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- Form the quotient `n / d` where `n:ℤ` and `d:ℕ+` (not necessarily coprime) -/</span>
<span class="kd">def</span> <span class="n">mk_pnat</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span> <span class="bp">→</span> <span class="n">ℚ</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">d</span><span class="o">,</span> <span class="n">dpos</span><span class="o">⟩</span> <span class="o">:=</span>
<span class="k">let</span> <span class="n">n'</span> <span class="o">:=</span> <span class="n">n.nat_abs</span><span class="o">,</span> <span class="n">g</span> <span class="o">:=</span> <span class="n">n'.gcd</span> <span class="n">d</span> <span class="k">in</span>
<span class="o">⟨</span><span class="n">n</span> <span class="bp">/</span> <span class="n">g</span><span class="o">,</span> <span class="n">d</span> <span class="bp">/</span> <span class="n">g</span><span class="o">,</span> <span class="kd">begin</span>
  <span class="n">apply</span> <span class="o">(</span><span class="n">nat.le_div_iff_mul_le</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">nat.gcd_pos_of_pos_right</span> <span class="n">_</span> <span class="n">dpos</span><span class="o">))</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span> <span class="n">exact</span> <span class="n">nat.le_of_dvd</span> <span class="n">dpos</span> <span class="o">(</span><span class="n">nat.gcd_dvd_right</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span>
<span class="kd">end</span><span class="o">,</span> <span class="kd">begin</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">int.nat_abs</span> <span class="o">(</span><span class="n">n</span> <span class="bp">/</span> <span class="bp">↑</span><span class="n">g</span><span class="o">)</span> <span class="bp">=</span> <span class="n">n'</span> <span class="bp">/</span> <span class="n">g</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">cases</span> <span class="n">int.nat_abs_eq</span> <span class="n">n</span> <span class="k">with</span> <span class="n">e</span> <span class="n">e</span><span class="bp">;</span> <span class="n">rw</span> <span class="n">e</span><span class="o">,</span> <span class="o">{</span> <span class="n">refl</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">int.neg_div_of_dvd</span><span class="o">,</span> <span class="n">int.nat_abs_neg</span><span class="o">],</span> <span class="o">{</span> <span class="n">refl</span> <span class="o">},</span>
    <span class="n">exact</span> <span class="n">int.coe_nat_dvd.2</span> <span class="o">(</span><span class="n">nat.gcd_dvd_left</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">nat.coprime_div_gcd_div_gcd</span> <span class="o">(</span><span class="n">nat.gcd_pos_of_pos_right</span> <span class="n">_</span> <span class="n">dpos</span><span class="o">)</span>
<span class="kd">end</span><span class="o">⟩</span>
</code></pre></div>



<a name="222240389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240389">(Jan 10 2021 at 20:27)</a>:</h4>
<p>the simplest evidence is this</p>



<a name="222240394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240394">(Jan 10 2021 at 20:27)</a>:</h4>
<p>OK here it is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- Form the quotient `n / d` where `n:ℤ` and `d:ℕ+` (not necessarily coprime) -/</span>
<span class="kd">def</span> <span class="n">mk_pnat</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span><span class="bp">+</span> <span class="bp">→</span> <span class="n">ℚ</span> <span class="bp">|</span> <span class="o">⟨</span><span class="n">d</span><span class="o">,</span> <span class="n">dpos</span><span class="o">⟩</span> <span class="o">:=</span>
<span class="k">let</span> <span class="n">n'</span> <span class="o">:=</span> <span class="n">n.nat_abs</span><span class="o">,</span> <span class="n">g</span> <span class="o">:=</span> <span class="n">n'.gcd</span> <span class="n">d</span> <span class="k">in</span>
<span class="o">⟨</span><span class="n">n</span> <span class="bp">/</span> <span class="n">g</span><span class="o">,</span> <span class="n">d</span> <span class="bp">/</span> <span class="n">g</span><span class="o">,</span> <span class="kd">begin</span>
  <span class="n">apply</span> <span class="o">(</span><span class="n">nat.le_div_iff_mul_le</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">nat.gcd_pos_of_pos_right</span> <span class="n">_</span> <span class="n">dpos</span><span class="o">))</span><span class="bp">.</span><span class="mi">2</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span> <span class="n">exact</span> <span class="n">nat.le_of_dvd</span> <span class="n">dpos</span> <span class="o">(</span><span class="n">nat.gcd_dvd_right</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span>
<span class="kd">end</span><span class="o">,</span> <span class="kd">begin</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">int.nat_abs</span> <span class="o">(</span><span class="n">n</span> <span class="bp">/</span> <span class="bp">↑</span><span class="n">g</span><span class="o">)</span> <span class="bp">=</span> <span class="n">n'</span> <span class="bp">/</span> <span class="n">g</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">cases</span> <span class="n">int.nat_abs_eq</span> <span class="n">n</span> <span class="k">with</span> <span class="n">e</span> <span class="n">e</span><span class="bp">;</span> <span class="n">rw</span> <span class="n">e</span><span class="o">,</span> <span class="o">{</span> <span class="n">refl</span> <span class="o">},</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">int.neg_div_of_dvd</span><span class="o">,</span> <span class="n">int.nat_abs_neg</span><span class="o">],</span> <span class="o">{</span> <span class="n">refl</span> <span class="o">},</span>
    <span class="n">exact</span> <span class="n">int.coe_nat_dvd.2</span> <span class="o">(</span><span class="n">nat.gcd_dvd_left</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">nat.coprime_div_gcd_div_gcd</span> <span class="o">(</span><span class="n">nat.gcd_pos_of_pos_right</span> <span class="n">_</span> <span class="n">dpos</span><span class="o">)</span>
<span class="kd">end</span><span class="o">⟩</span>
</code></pre></div>
<p>and this would support my 2nd interpretation of my original problem, namely that </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">q</span><span class="bp">+</span><span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">^</span><span class="n">m</span>
</code></pre></div>
<p>in the case that I set up.  Which means potentially I need to expand the proof of <code>rat.add</code> to establish that.</p>



<a name="222240398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240398">(Jan 10 2021 at 20:27)</a>:</h4>
<p>LL39-49:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- `rat`, or `ℚ`, is the type of rational numbers. It is defined</span>
<span class="sd">  as the set of pairs ⟨n, d⟩ of integers such that `d` is positive and `n` and</span>
<span class="sd">  `d` are coprime. This representation is preferred to the quotient</span>
<span class="sd">  because without periodic reduction, the numerator and denominator can grow</span>
<span class="sd">  exponentially (for example, adding 1/2 to itself repeatedly). -/</span>
<span class="kd">structure</span> <span class="n">rat</span> <span class="o">:=</span> <span class="n">mk'</span> <span class="o">::</span>
<span class="o">(</span><span class="n">num</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span>
<span class="o">(</span><span class="n">denom</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>
<span class="o">(</span><span class="n">pos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">denom</span><span class="o">)</span>
<span class="o">(</span><span class="n">cop</span> <span class="o">:</span> <span class="n">num.nat_abs.coprime</span> <span class="n">denom</span><span class="o">)</span>
<span class="kd">notation</span> <span class="bp">`</span><span class="n">ℚ</span><span class="bp">`</span> <span class="o">:=</span> <span class="n">rat</span>
</code></pre></div>



<a name="222240404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240404">(Jan 10 2021 at 20:27)</a>:</h4>
<p>so a rational number is defined to have coprime numerator and denominator</p>



<a name="222240415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240415">(Jan 10 2021 at 20:27)</a>:</h4>
<p>Thanks that gives me a short cut to proving</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="n">q</span><span class="bp">+</span><span class="n">r</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">^</span><span class="n">m</span>
</code></pre></div>
<p>in my example.</p>



<a name="222240455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240455">(Jan 10 2021 at 20:28)</a>:</h4>
<p>great</p>



<a name="222240465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240465">(Jan 10 2021 at 20:28)</a>:</h4>
<p>I think.  I'm trying to prove this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">rat_pow2_denom_sum</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span>
  <span class="n">m</span> <span class="bp">≥</span> <span class="n">n</span> <span class="bp">→</span>
  <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">→</span>
  <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="bp">→</span>
  <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h3</span><span class="o">,</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222240471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240471">(Jan 10 2021 at 20:28)</a>:</h4>
<p>I mean you can probably prove (or maybe even find) that if <code>n</code> and <code>d</code> are coprime then <code>(n / d : \Q).denom = d</code></p>



<a name="222240474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240474">(Jan 10 2021 at 20:28)</a>:</h4>
<p>this is the right way to think about it</p>



<a name="222240481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240481">(Jan 10 2021 at 20:29)</a>:</h4>
<p>is to extract lemma</p>



<a name="222240490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240490">(Jan 10 2021 at 20:29)</a>:</h4>
<p>your lemma is false btw, 1/2 + 1/2 = 1/1</p>



<a name="222240492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240492">(Jan 10 2021 at 20:29)</a>:</h4>
<p>also, move the arrows to the left of colon</p>



<a name="222240500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240500">(Jan 10 2021 at 20:29)</a>:</h4>
<p>there's no point to put them to the right of colon and then spend 3 lines to <code>intro</code> them one by one</p>



<a name="222240549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240549">(Jan 10 2021 at 20:30)</a>:</h4>
<p>I don't know how to put equations and inequalities on the left, just slide them over in parentheses?</p>



<a name="222240559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240559">(Jan 10 2021 at 20:30)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">rat_pow2_denom_sum</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h3</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222240567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240567">(Jan 10 2021 at 20:31)</a>:</h4>
<p>Thanks!  Anyway I have to rethink the lemma.</p>



<a name="222240611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240611" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240611">(Jan 10 2021 at 20:32)</a>:</h4>
<p>well you can (and you probably already did) phrase it in terms of the 2-adic valuation</p>



<a name="222240616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240616">(Jan 10 2021 at 20:32)</a>:</h4>
<p>I'm on the trail of Exercise 6F, this is where I'm at (with the lemma wrong):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.subring</span>
<span class="kn">import</span> <span class="n">data.rat.basic</span>
<span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">open</span> <span class="n">rat</span>
<span class="kn">open</span> <span class="n">nat</span>

<span class="kd">lemma</span> <span class="n">rat_pow2_denom_sum</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">):</span>
  <span class="n">m</span> <span class="bp">≥</span> <span class="n">n</span> <span class="bp">→</span>
  <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">→</span>
  <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="bp">→</span>
  <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h2</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h3</span><span class="o">,</span>

<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">gcd_a_vs_2n_to_dvd</span> <span class="o">(</span><span class="n">a</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">)</span> <span class="o">:</span> <span class="n">gcd</span> <span class="n">a</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">↔</span> <span class="bp">¬</span> <span class="o">(</span><span class="mi">2</span> <span class="bp">∣</span> <span class="n">a</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">refine</span> <span class="n">not_dvd_of_pos_of_lt</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">h1</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">,</span>
  <span class="n">assumption</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">gcd_ab_vs_2nm</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">gcd</span> <span class="n">a</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">→</span>
  <span class="n">gcd</span> <span class="n">b</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">m</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">→</span>
  <span class="n">gcd</span> <span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">))</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">h2</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">gcd_a_vs_2n_to_dvd</span> <span class="n">a</span> <span class="n">n</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">gcd_a_vs_2n_to_dvd</span> <span class="n">b</span> <span class="n">m</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">gcd_a_vs_2n_to_dvd</span> <span class="o">(</span><span class="n">a</span><span class="bp">*</span><span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">),</span>
  <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="n">h3.1</span> <span class="n">h1</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">h7</span> <span class="o">:=</span> <span class="n">h4.1</span> <span class="n">h2</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">def</span> <span class="n">B</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">ℚ</span> <span class="o">:=</span>
<span class="o">{</span>
  <span class="n">carrier</span> <span class="o">:=</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℚ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">x.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="o">},</span>
  <span class="n">one_mem'</span> <span class="c">/-</span><span class="cm"> (1 : M) ∈ carrier) -/</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span><span class="o">,</span>
    <span class="n">use</span> <span class="mi">0</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">mul_mem'</span> <span class="c">/-</span><span class="cm"> {a b} : a ∈ carrier → b ∈ carrier → a * b ∈ carrier) -/</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span> <span class="n">at</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">n</span> <span class="n">hn</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:=</span> <span class="n">rat.mul_num</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span> <span class="c1">-- just for context</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">rat.mul_denom</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h4</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hn</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hm</span><span class="o">,</span>
    <span class="n">use</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="n">m</span><span class="o">),</span>
    <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">pow_add</span> <span class="mi">2</span> <span class="n">n</span> <span class="n">m</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="n">a.cop</span><span class="o">,</span>
    <span class="n">unfold</span> <span class="n">coprime</span> <span class="n">at</span> <span class="n">h6</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h8</span> <span class="o">:=</span> <span class="n">b.cop</span><span class="o">,</span>
    <span class="n">unfold</span> <span class="n">coprime</span> <span class="n">at</span> <span class="n">h8</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hn</span> <span class="n">at</span> <span class="n">h6</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hm</span> <span class="n">at</span> <span class="n">h8</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h12</span> <span class="o">:=</span> <span class="n">gcd_ab_vs_2nm</span> <span class="n">a.num.nat_abs</span> <span class="n">b.num.nat_abs</span> <span class="n">n</span> <span class="n">m</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h13</span> <span class="o">:=</span> <span class="n">h12</span> <span class="n">h6</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h14</span> <span class="o">:=</span> <span class="n">h13</span> <span class="n">h8</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">h5</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h15</span> <span class="o">:=</span> <span class="n">int.nat_abs_mul</span> <span class="n">a.num</span> <span class="n">b.num</span><span class="o">,</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">h15</span> <span class="n">at</span> <span class="n">h14</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h14</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">zero_mem'</span> <span class="c">/-</span><span class="cm"> (0 : M) ∈ carrier -/</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span><span class="o">,</span>
    <span class="n">use</span> <span class="mi">0</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">add_mem'</span> <span class="c">/-</span><span class="cm"> {a b} : a ∈ carrier → b ∈ carrier → a + b ∈ carrier -/</span><span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">b</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span> <span class="n">at</span> <span class="n">h2</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">n</span> <span class="n">hn</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h2</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span><span class="o">,</span>
    <span class="n">by_cases</span> <span class="n">h3</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span>
    <span class="o">{</span>
      <span class="n">use</span> <span class="n">m</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">h4</span> <span class="o">:=</span> <span class="n">rat_pow2_denom_sum</span> <span class="n">a</span> <span class="n">b</span> <span class="n">n</span> <span class="n">m</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">h4</span> <span class="n">h3</span> <span class="n">hn</span> <span class="n">hm</span><span class="o">,</span>
    <span class="o">},</span>
    <span class="o">{</span>
      <span class="n">use</span> <span class="n">n</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">h5</span> <span class="o">:=</span> <span class="n">rat_pow2_denom_sum</span> <span class="n">b</span> <span class="n">a</span> <span class="n">m</span> <span class="n">n</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">h6</span> <span class="o">:=</span> <span class="n">le_of_not_ge</span> <span class="n">h3</span><span class="o">,</span>
      <span class="k">have</span> <span class="n">h7</span> <span class="o">:=</span> <span class="n">h5</span> <span class="n">h6</span> <span class="n">hm</span> <span class="n">hn</span><span class="o">,</span>
      <span class="n">rw</span> <span class="o">(</span><span class="n">add_comm</span> <span class="n">b</span> <span class="n">a</span><span class="o">)</span> <span class="n">at</span> <span class="n">h7</span><span class="o">,</span>
      <span class="n">assumption</span><span class="o">,</span>
    <span class="o">},</span>
  <span class="kd">end</span><span class="o">,</span>
  <span class="n">neg_mem'</span> <span class="c">/-</span><span class="cm"> {x} : x ∈ carrier →d -x ∈ carrier -/</span><span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">intro</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">intro</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span> <span class="n">at</span> <span class="n">h1</span><span class="o">,</span>
    <span class="n">cases</span> <span class="n">h1</span> <span class="k">with</span> <span class="n">n</span> <span class="n">hn</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">set.mem_set_of_eq</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">n</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hn</span><span class="o">,</span>
  <span class="kd">end</span><span class="o">,</span>
 <span class="o">}</span>

<span class="kd">abbreviation</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
  <span class="bp">∃</span> <span class="o">(</span><span class="n">sr</span> <span class="o">:</span> <span class="n">subring</span> <span class="n">α</span><span class="o">)</span> <span class="o">[</span><span class="n">integral_domain</span> <span class="n">sr</span><span class="o">],</span> <span class="n">s</span> <span class="bp">=</span> <span class="n">sr</span>

<span class="kd">theorem</span> <span class="n">ex6f</span> <span class="o">:</span> <span class="n">is_an_integral_domain</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℚ</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">x.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="o">}</span>  <span class="o">:=</span>
<span class="o">⟨</span><span class="n">B</span><span class="o">,</span> <span class="n">infer_instance</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span>
</code></pre></div>



<a name="222240618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240618">(Jan 10 2021 at 20:32)</a>:</h4>
<p>this is just saying that |x| &lt; |y| implies |x+y| = |y|</p>



<a name="222240628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240628">(Jan 10 2021 at 20:32)</a>:</h4>
<p>what is exercise 6f?</p>



<a name="222240650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240650">(Jan 10 2021 at 20:33)</a>:</h4>
<p>The last one here:<br>
<a href="/user_uploads/3121/xTIda_e9KvuLk3HqyHQsoMwn/Screenshot-from-2021-01-10-15-33-13.png">Screenshot-from-2021-01-10-15-33-13.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/xTIda_e9KvuLk3HqyHQsoMwn/Screenshot-from-2021-01-10-15-33-13.png" title="Screenshot-from-2021-01-10-15-33-13.png"><img src="/user_uploads/3121/xTIda_e9KvuLk3HqyHQsoMwn/Screenshot-from-2021-01-10-15-33-13.png"></a></div>



<a name="222240705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240705">(Jan 10 2021 at 20:34)</a>:</h4>
<p>well what is your mathematical proof?</p>



<a name="222240715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240715">(Jan 10 2021 at 20:34)</a>:</h4>
<p>you need to know which lemma to extract to make this most efficient</p>



<a name="222240718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240718">(Jan 10 2021 at 20:34)</a>:</h4>
<p>That it's closed under multiplication and addition.</p>



<a name="222240721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240721">(Jan 10 2021 at 20:35)</a>:</h4>
<p>the correct lemma is that (a / 2^n) has denominator a power of 2</p>



<a name="222240732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240732">(Jan 10 2021 at 20:35)</a>:</h4>
<p>i.e. "denominator being a power of 2" doesn't depend on the representation</p>



<a name="222240744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240744">(Jan 10 2021 at 20:35)</a>:</h4>
<p>I would say that the most crucial skill in formalization is knowing the right lemmas</p>



<a name="222240752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240752">(Jan 10 2021 at 20:35)</a>:</h4>
<p>everything else is secondary</p>



<a name="222240796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240796">(Jan 10 2021 at 20:36)</a>:</h4>
<p>you need to know how to convert from mathematical proof to a rigorous proof</p>



<a name="222240806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240806">(Jan 10 2021 at 20:36)</a>:</h4>
<p>your proof is probably (a/2^m) + (b/2^n) = (a x 2^n + b x 2^m) / 2^(m+n)</p>



<a name="222240816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240816">(Jan 10 2021 at 20:36)</a>:</h4>
<p>but you're implicitly using the fact that k / 2^p has denominator a power of 2</p>



<a name="222240818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240818">(Jan 10 2021 at 20:37)</a>:</h4>
<p>i.e. the RHS</p>



<a name="222240824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240824">(Jan 10 2021 at 20:37)</a>:</h4>
<p>At the top level it's easy, if <code>p=a/2^n</code> and <code>q=b/2^m</code> then <code>p * q = (a*b)/2^(n+m)</code>.  However in Lean I think I need to deal with the factor that numerator and denominator are coprime.</p>



<a name="222240837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240837">(Jan 10 2021 at 20:37)</a>:</h4>
<p>I would say that you don't actually understand the predicate "whose denominator is a power of 2"</p>



<a name="222240841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240841">(Jan 10 2021 at 20:38)</a>:</h4>
<p>is 3/6 in that ring?</p>



<a name="222240897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240897">(Jan 10 2021 at 20:38)</a>:</h4>
<p>Yes because <code>3/6 = 3 / (2*3) = 1/2</code>.</p>



<a name="222240901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240901">(Jan 10 2021 at 20:38)</a>:</h4>
<p>but 6 isn't a power of 2</p>



<a name="222240905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240905">(Jan 10 2021 at 20:38)</a>:</h4>
<p>you see the issue here</p>



<a name="222240917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240917">(Jan 10 2021 at 20:39)</a>:</h4>
<p>what you wrote is <strong>not</strong> a proof that the denominator of p+q is a power of 2</p>



<a name="222240926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240926">(Jan 10 2021 at 20:39)</a>:</h4>
<p>you proved that p+q = (a x 2^n + b x 2^m) / 2^(m+n)</p>



<a name="222240931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240931">(Jan 10 2021 at 20:39)</a>:</h4>
<p>but you need to prove that any fraction of that form satisfies the predicate</p>



<a name="222240932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240932">(Jan 10 2021 at 20:39)</a>:</h4>
<p>therefore what I said is the correct lemma to extract</p>



<a name="222240936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222240936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222240936">(Jan 10 2021 at 20:39)</a>:</h4>
<p>that any k/2^N satisfies the predicate</p>



<a name="222241003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241003">(Jan 10 2021 at 20:41)</a>:</h4>
<p>Thanks, I will work on that direction.  I was trying to normalize the result in the proof to be coprime and then prove that the normalized form had the form a/2^m where 2 did not divide a and m was an natural number.</p>



<a name="222241021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241021">(Jan 10 2021 at 20:41)</a>:</h4>
<p>do you understand why the denominator of k/2^N is always a power of 2?</p>



<a name="222241071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241071">(Jan 10 2021 at 20:42)</a>:</h4>
<p>Yes, I understand how rationals multiply and add and what the result of adding or multiplying two forms of shape a/2^m and b/2^n is.</p>



<a name="222241078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241078">(Jan 10 2021 at 20:42)</a>:</h4>
<p>I'm talking about just k/2^N</p>



<a name="222241080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241080">(Jan 10 2021 at 20:42)</a>:</h4>
<p>where k is any integer</p>



<a name="222241082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241082">(Jan 10 2021 at 20:42)</a>:</h4>
<p>and N is any natural number</p>



<a name="222241086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241086">(Jan 10 2021 at 20:42)</a>:</h4>
<p>why is the denominator of k/2^N a power of 2?</p>



<a name="222241157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241157">(Jan 10 2021 at 20:44)</a>:</h4>
<p>By construction of <code>rat</code> in Lean, <code>k</code> and <code>2^N</code> will be coprime at birth.  If that's not the case, and <code>k</code> has a power of <code>2</code> in it, then you can just subtract that from <code>N</code>.  In any event, <code>k</code> as an integer will have a factorization into primes of which 2 may or may not be present.  Am I missing something?</p>



<a name="222241205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241205">(Jan 10 2021 at 20:45)</a>:</h4>
<p>you can just form <code>(k / 2^N : \Q)</code></p>



<a name="222241210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241210">(Jan 10 2021 at 20:46)</a>:</h4>
<p>they won't be coprime at birth</p>



<a name="222241255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241255">(Jan 10 2021 at 20:46)</a>:</h4>
<p>In this case, by construction of the problem, the denominator is a power of 2 to begin with, for all the starting numbers.</p>



<a name="222241271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241271">(Jan 10 2021 at 20:47)</a>:</h4>
<p>But I guess the construction is not specific enough and <code>k</code> could have a power of 2 in it, which you can just subtract from <code>N</code> to normalize.</p>



<a name="222241335"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241335" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241335">(Jan 10 2021 at 20:48)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.rat.basic</span>

<span class="kd">lemma</span> <span class="n">denom_div_two_pow</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">k</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">N</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222241337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241337">(Jan 10 2021 at 20:48)</a>:</h4>
<p>this is what I mean</p>



<a name="222241456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241456">(Jan 10 2021 at 20:51)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.rat.basic</span>

<span class="kd">lemma</span> <span class="n">denom_div_two_pow</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">N</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">k</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">N</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">denom_two_pow_iff</span> <span class="o">(</span><span class="n">q</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∃</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">q.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="bp">∃</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="o">(</span><span class="n">k</span> <span class="bp">/</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">q</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="222241460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241460">(Jan 10 2021 at 20:51)</a>:</h4>
<p>then the second lemma will help you a lot</p>



<a name="222241521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241521">(Jan 10 2021 at 20:52)</a>:</h4>
<p>or you can "cheat" and just claim that the RHS of my lemma is what they mean by "whose denominators are 1 or a power of 2"</p>



<a name="222241528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241528">(Jan 10 2021 at 20:52)</a>:</h4>
<p>then you won't have to go through all these <code>denom</code> shenanigans</p>



<a name="222241665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241665">(Jan 10 2021 at 20:56)</a>:</h4>
<p>Thanks, I will rethink it with your advice.</p>
<p>My confusion is that you noted <code>9/18=3/6=1/2</code> so there are multiple representatives of a single rational with different denominators in the same sense that <code>0=5=10=15 mod 5</code>.  So to say that denominator  being a power of 2 doesn't depend on the representation assumes a canonical representation.  In the Lean case the canonical representation is that in rational <code>a/m</code>, <code>a</code> and <code>m</code> are coprime.  So it seems safer to say that in the canonical representation, <code>a/2^n</code> has a denominator which is a power of 2, because we aren't seeing other possible representations like <code>(3*a)/(3*2^n)</code>.</p>



<a name="222241729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241729">(Jan 10 2021 at 20:58)</a>:</h4>
<p>Indeed, I was wrong when I said that it doesn't depend on the representation</p>



<a name="222241732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241732">(Jan 10 2021 at 20:58)</a>:</h4>
<p>but what I wrote in Lean code should be correct</p>



<a name="222241738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241738">(Jan 10 2021 at 20:58)</a>:</h4>
<p>Thanks!</p>



<a name="222241827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241827">(Jan 10 2021 at 21:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110064">Kenny Lau</span> <a href="#narrow/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F/near/222241521">said</a>:</p>
<blockquote>
<p>or you can "cheat" and just claim that the RHS of my lemma is what they mean by "whose denominators are 1 or a power of 2"</p>
</blockquote>
<p>this brings an important point: what they write in mathematics doesn't necessarily correspond to the same notation in Lean</p>



<a name="222241832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241832">(Jan 10 2021 at 21:00)</a>:</h4>
<p><code>3 - 5</code> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>−</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">3 - 5</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span></span></span></span> don't mean the same thing</p>



<a name="222241837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241837">(Jan 10 2021 at 21:00)</a>:</h4>
<p>(one is <code>0</code>, the other one is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">-2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">2</span></span></span></span>)</p>



<a name="222241855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222241855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222241855">(Jan 10 2021 at 21:01)</a>:</h4>
<p>there is no point following a definition verbatim</p>



<a name="222250871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Is%20the%20denominator%20%20LCD%20in%20rational%20addition%3F/near/222250871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Lars Ericson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Is.20the.20denominator.20.20LCD.20in.20rational.20addition.3F.html#222250871">(Jan 11 2021 at 00:48)</a>:</h4>
<p>I think this reflects your advice and eliminates the dependency on the canonical representation, and also doesn't cause <code>slim_check</code> to produce a counterexample:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">import</span> <span class="n">tactic.slim_check</span>

<span class="kd">lemma</span> <span class="n">mul_injective</span>
        <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span>
        <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
        <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span>
        <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">):</span>
        <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">*</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">plus_injective</span>
        <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">}</span>
        <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
        <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">n</span><span class="o">)</span>
        <span class="o">(</span><span class="n">hb</span> <span class="o">:</span> <span class="n">b.denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">m</span><span class="o">):</span>
        <span class="bp">∃</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">^</span> <span class="n">k</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>