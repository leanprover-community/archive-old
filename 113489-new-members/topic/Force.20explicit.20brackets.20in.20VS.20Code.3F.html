---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html">Force explicit brackets in VS Code?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="267558536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267558536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267558536">(Jan 11 2022 at 09:51)</a>:</h4>
<p>Is there a way to get VS Code to explicitly write all the brackets that it normally suppresses, e.g to write <code>(a + b) - c</code> rather than <code>a + b - c</code>?</p>



<a name="267558717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267558717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267558717">(Jan 11 2022 at 09:53)</a>:</h4>
<p>There should be some argument to <code>set_option</code> that does this.</p>



<a name="267560321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267560321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267560321">(Jan 11 2022 at 10:09)</a>:</h4>
<p>I've tried <code>set_option pp.</code> and looked through the autocomplete suggestions but nothing seems to be the thing I want.  Is there documentation for <code>set_option</code> somewhere?  (I didn't have much luck with a Google search for "mathlib set_option")</p>



<a name="267566860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267566860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267566860">(Jan 11 2022 at 11:13)</a>:</h4>
<p><code>#help options</code></p>



<a name="267571482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267571482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267571482">(Jan 11 2022 at 12:01)</a>:</h4>
<p>Wait! I think that what Yael means is "someone should write such code", not "such code already exists".</p>



<a name="267579839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267579839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267579839">(Jan 11 2022 at 13:25)</a>:</h4>
<p>Ah!  That would explain why I couldn't find it!  :)</p>



<a name="267605927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267605927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267605927">(Jan 11 2022 at 16:22)</a>:</h4>
<p>It seems possible to implement without much difficulty. In lean/src/frontends/lean/pp.cpp there's a function <code>add_paren_if_needed</code> that could decide that they're always needed. There are other functions, too, that seem to decide whether to add parens, like <code>pp_num</code>, <code>pp_notation_child</code>, and maybe some things about pretty printing universe levels.</p>



<a name="267630591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267630591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Johnson <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267630591">(Jan 11 2022 at 19:10)</a>:</h4>
<p>I suggest that we do not include parentheses in function application. For example, <code>f x y z</code> should not be <code>(((f x) y) z)</code>, but <code>(f x y z)</code> is fine. Otherwise, the output of <code>pp.all</code> will be even less readable than it is now.</p>



<a name="267743916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267743916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267743916">(Jan 12 2022 at 15:55)</a>:</h4>
<p>I'm also interested in an option to force some more parentheses, for teaching purposes. I guess this doesn't require modifying cpp files. I think we can add it in <a href="https://github.com/leanprover-community/mathlib/blob/master/src/tactic/interactive_expr.lean">tactic.interactive_expr</a>. This has the advantage that anyone can use it in a project, it doesn't have to be in mathlib. This is what I do to use <a href="https://github.com/leanprover-community/mathlib/pull/5440">#5440</a> for teaching. I'd be very grateful if someone understanding the widget framework could show how to tun every  <code>a+b</code> into <code>(a+b)</code> by modifying that file.</p>



<a name="267747464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267747464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267747464">(Jan 12 2022 at 16:20)</a>:</h4>
<p>Ok its not what you really want or pretty but I just tried a quick experiment with a much more low-level feature, custom info view css:</p>
<ul>
<li>Open Vscode settings, go to "Lean: Info view style"</li>
<li>Paste in</li>
</ul>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">.</span><span class="n">expr</span><span class="bp">-</span><span class="n">boundary</span><span class="o">:</span><span class="n">before</span> <span class="o">{</span><span class="n">content</span><span class="o">:</span> <span class="sc">'('</span><span class="bp">;</span><span class="o">}</span> <span class="bp">.</span><span class="n">expr</span><span class="bp">-</span><span class="n">boundary</span><span class="o">:</span><span class="n">after</span> <span class="o">{</span> <span class="n">content</span><span class="o">:</span> <span class="sc">')'</span><span class="bp">;</span> <span class="o">}</span>
</code></pre></div>
<ul>
<li>close and re-open the info view and you get:<br>
<a href="/user_uploads/3121/Cd04U_jrWmoUfK1LpWNVMDu-/Screen-Shot-2022-01-12-at-17.19.41.png">Screen-Shot-2022-01-12-at-17.19.41.png</a><div class="message_inline_image"><a href="/user_uploads/3121/Cd04U_jrWmoUfK1LpWNVMDu-/Screen-Shot-2022-01-12-at-17.19.41.png" title="Screen-Shot-2022-01-12-at-17.19.41.png"><img src="/user_uploads/3121/Cd04U_jrWmoUfK1LpWNVMDu-/Screen-Shot-2022-01-12-at-17.19.41.png"></a></div></li>
</ul>



<a name="267750756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267750756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267750756">(Jan 12 2022 at 16:42)</a>:</h4>
<p>I have a reason to dig into the pretty printer for something else anyway -- seeing as there's more interest in a parens option, I'll create a lean PR for it. (Maybe I'll figure out how to do <a href="https://github.com/leanprover-community/mathlib/pull/5440">#5440</a>, too, <span class="user-mention" data-user-id="110031">@Patrick Massot</span>)</p>



<a name="267752612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267752612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267752612">(Jan 12 2022 at 16:55)</a>:</h4>
<p>Thanks! What do you mean by "do <a href="https://github.com/leanprover-community/mathlib/pull/5440">#5440</a>"? This PR already works perfectly. Do you mean adding a config option?</p>



<a name="267752691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267752691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267752691">(Jan 12 2022 at 16:55)</a>:</h4>
<p>In the mean time I managed to do what I suggested except that I'm stuck at adding a config option.</p>



<a name="267752788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267752788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267752788">(Jan 12 2022 at 16:56)</a>:</h4>
<p>I tried to hack <code>tactic.is_trace_enabled_for</code> but I can't get it to work</p>



<a name="267752848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267752848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267752848">(Jan 12 2022 at 16:56)</a>:</h4>
<p>It's really a pain that adding options is not easy</p>



<a name="267753634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267753634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267753634">(Jan 12 2022 at 17:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F/near/267752612">said</a>:</p>
<blockquote>
<p>Thanks! What do you mean by "do <a href="https://github.com/leanprover-community/mathlib/pull/5440">#5440</a>"? This PR already works perfectly. Do you mean adding a config option?</p>
</blockquote>
<p>I mean get it implemented directly in the pretty printer along with a configurable option</p>



<a name="267755012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267755012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267755012">(Jan 12 2022 at 17:10)</a>:</h4>
<p>Nice</p>



<a name="267755526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267755526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267755526">(Jan 12 2022 at 17:14)</a>:</h4>
<p>I would still be really interested in getting help with my option issue. Maybe <span class="user-mention" data-user-id="110596">@Rob Lewis</span> could have a look? I put my file at <a href="https://gist.github.com/PatrickMassot/5700bded8c1536f4bd470df3852de6f2">https://gist.github.com/PatrickMassot/5700bded8c1536f4bd470df3852de6f2</a></p>



<a name="267755575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267755575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267755575">(Jan 12 2022 at 17:14)</a>:</h4>
<p>The line that does nothing is 148</p>



<a name="267755608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267755608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267755608">(Jan 12 2022 at 17:15)</a>:</h4>
<p>At the very bottom there an example that fails</p>



<a name="267755675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267755675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267755675">(Jan 12 2022 at 17:15)</a>:</h4>
<p>Replacing line 148 by <code>match tt with ...</code> makes the example work</p>



<a name="267756329"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267756329" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267756329">(Jan 12 2022 at 17:18)</a>:</h4>
<p>I'm not insisting on using a trace option, any way of having some sort of custom option would be good.</p>



<a name="267759207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267759207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267759207">(Jan 12 2022 at 17:38)</a>:</h4>
<p>I have no idea about widgets. It seems like maybe it's reading options from a different environment or something</p>



<a name="267759970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267759970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267759970">(Jan 12 2022 at 17:43)</a>:</h4>
<p>Thanks for trying. Maybe <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> could help then?</p>



<a name="267760486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267760486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267760486">(Jan 12 2022 at 17:48)</a>:</h4>
<p>I have another meta question for Rob. In the following code, is it possible to rewrite <code>foo</code> so that it looks like <code>foo'</code> (which doesn't work at all)?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic.basic</span>

<span class="kn">namespace</span> <span class="n">tactic.interactive</span>
<span class="n">setup_tactic_parser</span>
<span class="kn">open</span> <span class="n">tactic</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="k">do</span>
   <span class="n">goal</span> <span class="bp">←</span> <span class="n">get_goal</span> <span class="bp">&gt;&gt;=</span> <span class="n">infer_type</span><span class="o">,</span>
   <span class="k">match</span> <span class="n">goal</span> <span class="k">with</span>
   <span class="bp">|</span> <span class="o">(</span><span class="n">expr.pi</span> <span class="n">n</span> <span class="n">_</span> <span class="n">t</span> <span class="n">b</span><span class="o">)</span> <span class="o">:=</span> <span class="k">do</span> <span class="n">trace</span> <span class="s2">"a"</span><span class="o">,</span> <span class="n">skip</span>
   <span class="bp">|</span> <span class="n">_</span> <span class="o">:=</span> <span class="k">do</span> <span class="n">trace</span> <span class="s2">"b"</span>
   <span class="kd">end</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">foo'</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="k">do</span>
   <span class="o">{</span> <span class="bp">`</span><span class="o">(</span><span class="bp">∀</span> <span class="bp">%%</span><span class="n">n</span> <span class="o">:</span> <span class="bp">%%</span><span class="n">t</span><span class="o">,</span> <span class="bp">%%</span><span class="n">b</span><span class="o">)</span> <span class="bp">←</span> <span class="n">get_goal</span> <span class="bp">&gt;&gt;=</span> <span class="n">infer_type</span><span class="o">,</span>
     <span class="n">trace</span> <span class="s2">"a"</span><span class="o">,</span> <span class="n">skip</span> <span class="o">}</span> <span class="bp">&lt;|&gt;</span> <span class="k">do</span> <span class="o">{</span> <span class="n">trace</span> <span class="s2">"b"</span><span class="o">,</span> <span class="n">skip</span><span class="o">}</span>
   <span class="kd">end</span>

<span class="kd">end</span> <span class="n">tactic.interactive</span>
</code></pre></div>



<a name="267760571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267760571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267760571">(Jan 12 2022 at 17:49)</a>:</h4>
<p>The motivation is first readability but also I'd like to have a more complicated pattern in my real use case.</p>



<a name="267762066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267762066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267762066">(Jan 12 2022 at 17:59)</a>:</h4>
<p>Here you go: <a href="https://gist.github.com/gebner/87defe68efaac3de248d1f0639fcff2e">https://gist.github.com/gebner/87defe68efaac3de248d1f0639fcff2e</a></p>



<a name="267762877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267762877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267762877">(Jan 12 2022 at 18:04)</a>:</h4>
<p>Thank you so much Gabriel!</p>



<a name="267762922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267762922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267762922">(Jan 12 2022 at 18:04)</a>:</h4>
<p>Is <code>tactic.get_bool_option</code> the key thing  I was missing?</p>



<a name="267763025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763025">(Jan 12 2022 at 18:05)</a>:</h4>
<p>(Line 543 should say "1 goal" instead of "1 but")</p>



<a name="267763067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763067">(Jan 12 2022 at 18:05)</a>:</h4>
<p>I think that's French.</p>



<a name="267763089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763089">(Jan 12 2022 at 18:05)</a>:</h4>
<p>Aha! TIL.</p>



<a name="267763163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763163">(Jan 12 2022 at 18:06)</a>:</h4>
<p>Oh yes, this is all for French speaking teaching</p>



<a name="267763274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763274">(Jan 12 2022 at 18:07)</a>:</h4>
<p>Having a tactic that switches this on is perfectly fine , but I'm still curious to know whether it could be done with a set_option</p>



<a name="267763280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763280">(Jan 12 2022 at 18:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F/near/267762922">said</a>:</p>
<blockquote>
<p>Is <code>tactic.get_bool_option</code> the key thing  I was missing?</p>
</blockquote>
<p>Trace options are kind of special, <code>is_trace_enabled_for</code> doesn't look at the options.  I think <code>get_bool_option `trace.parens ff</code> would work as well (if you wanted to abuse the trace option).</p>



<a name="267763330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763330" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763330">(Jan 12 2022 at 18:07)</a>:</h4>
<p><code>set_option</code> is hard because afair there is no way to register options from the Lean side.</p>



<a name="267763452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763452">(Jan 12 2022 at 18:08)</a>:</h4>
<p>But there is still <code>declare_trace</code> that sounded promising</p>



<a name="267763539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763539">(Jan 12 2022 at 18:09)</a>:</h4>
<p>I mean sure if you want <code>set_option trace.parens true</code> then that should work (declare_trace + get_bool_option).</p>



<a name="267763670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763670">(Jan 12 2022 at 18:10)</a>:</h4>
<p>Ok, I'll try for learning purposes but I'll probably keep the tactic anyway.</p>



<a name="267763778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267763778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267763778">(Jan 12 2022 at 18:11)</a>:</h4>
<p>Julian, there are other teaching tweaks in this file. For instance the "goals accomplished message" is not only translated, it's also written bigger, because math is hard.</p>



<a name="267764403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267764403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267764403">(Jan 12 2022 at 18:15)</a>:</h4>
<p>For the record: using the trace option does indeed work.</p>



<a name="267764616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267764616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267764616">(Jan 12 2022 at 18:17)</a>:</h4>
<p>and we can have both: the trace option and the switching tactic.</p>



<a name="267764903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267764903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267764903">(Jan 12 2022 at 18:18)</a>:</h4>
<p>Last question for Gabriel : is the if-then-else <code>bool.tt ← tactic.get_bool_option `trace.parens ff | pure s,</code> a normal trick? I was searching around stuff like <code>when</code> and gave up because I had other issues.</p>



<a name="267764949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267764949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267764949">(Jan 12 2022 at 18:19)</a>:</h4>
<p>For the record, another option would be to add a checkbox in the goal view.  This is not that complicated, see here for an example with a counter: <a href="https://github.com/leanprover-community/lean/blob/a8cf8a0c9ea19a633baeb3aa7e8d706b86c2c0f9/tests/lean/widget/widget2.lean">https://github.com/leanprover-community/lean/blob/a8cf8a0c9ea19a633baeb3aa7e8d706b86c2c0f9/tests/lean/widget/widget2.lean</a></p>



<a name="267765075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765075">(Jan 12 2022 at 18:20)</a>:</h4>
<p>That would be really nice! Would you know how to make that persistent?</p>



<a name="267765125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765125">(Jan 12 2022 at 18:20)</a>:</h4>
<blockquote>
<p>is the if-then-else <code>bool.tt ← tactic.get_bool_option `trace.parens ff | pure s</code>, a normal trick?</p>
</blockquote>
<p>I think I used it pretty often in Lean 3, although not everyone liked it.  In Lean 4 you can also use the slightly more readable <code>if !(← getBoolOption `trace.parens) then return s</code>.</p>



<a name="267765151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765151">(Jan 12 2022 at 18:20)</a>:</h4>
<p>I mean more persistent than the tactic state filtering.</p>



<a name="267765183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765183">(Jan 12 2022 at 18:21)</a>:</h4>
<p>...which we can't make persistent, right?</p>



<a name="267765215"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765215" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765215">(Jan 12 2022 at 18:21)</a>:</h4>
<p>although around here you get the impression that anything can happen nowadays</p>



<a name="267765216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765216" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765216">(Jan 12 2022 at 18:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F/near/267765075">said</a>:</p>
<blockquote>
<p>That would be really nice! Would you know how to make that persistent?</p>
</blockquote>
<p>Unfortunately that's just as impossible as the tactic state filtering.</p>



<a name="267765245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765245">(Jan 12 2022 at 18:21)</a>:</h4>
<p>Yes Kevin, that's why I was asking.</p>



<a name="267765255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765255">(Jan 12 2022 at 18:21)</a>:</h4>
<p>Lean 4?</p>



<a name="267765262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765262">(Jan 12 2022 at 18:22)</a>:</h4>
<p>Ritual question: Lean 4?</p>



<a name="267765430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765430">(Jan 12 2022 at 18:23)</a>:</h4>
<p>In Lean 4 all of this happens on the vscode/editor side.  So: persistent tactic filters → super easy, I hope that Chris will do this soon; French localization → impossible from the Lean side, you'll need to PR it to the vscode extension.</p>



<a name="267765652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765652">(Jan 12 2022 at 18:24)</a>:</h4>
<p>(More parentheses → probably doable by adding a custom delaborator)</p>



<a name="267765762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765762">(Jan 12 2022 at 18:25)</a>:</h4>
<p>The impossible localization is bad news <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="267765983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765983">(Jan 12 2022 at 18:27)</a>:</h4>
<p>I didn't know Chris is working on this. Which Chris do you mean btw?</p>



<a name="267765994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267765994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267765994">(Jan 12 2022 at 18:27)</a>:</h4>
<p>Impossible to do from the Lean side, you can still customize the extension though (but I realize that this is organizationally much harder).</p>



<a name="267766017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267766017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267766017">(Jan 12 2022 at 18:27)</a>:</h4>
<p>Chris Lovett.</p>



<a name="267766049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/267766049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#267766049">(Jan 12 2022 at 18:27)</a>:</h4>
<p>It's dinner time. I need to go. Thanks again for all your help!</p>



<a name="268102684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268102684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268102684">(Jan 15 2022 at 03:55)</a>:</h4>
<p>What do we think about this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">set_option</span> <span class="n">pp.parens</span> <span class="n">true</span>

<span class="k">#check</span> <span class="bp">@</span><span class="n">nat.add_assoc</span>
<span class="c">/-</span><span class="cm"> nat.add_assoc : ∀ (n m k : ℕ), (((n + m) + k) = (n + (m + k))) -/</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">y</span> <span class="bp">-</span> <span class="n">z</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">+</span> <span class="n">y</span> <span class="bp">*</span> <span class="n">z</span> <span class="bp">-</span> <span class="n">y</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c">/-</span><span class="cm"> ⊢ (((x + y) - z) = ((x + (y * z)) - y)) -/</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span> <span class="mi">2</span> <span class="o">(</span><span class="n">f</span> <span class="mi">3</span> <span class="mi">4</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">+</span> <span class="mi">2</span> <span class="bp">=</span> <span class="n">f</span> <span class="mi">1</span> <span class="mi">2</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c">/-</span><span class="cm"> ⊢ ((f 2 (f 3 4 + 1) + 2) = f 1 2) -/</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">-</span> <span class="bp">-</span><span class="mi">3</span> <span class="bp">=</span> <span class="bp">-</span><span class="mi">2</span> <span class="bp">+</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c">/-</span><span class="cm"> ⊢ ((x - (-3)) = ((-2) + x)) -/</span>
<span class="kd">end</span>
</code></pre></div>
<p>(Ping: <span class="user-mention" data-user-id="422543">@Stuart Presnell</span>)</p>



<a name="268102750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268102750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268102750">(Jan 15 2022 at 03:57)</a>:</h4>
<p>The implementation is just to wrap anything that is notation in parentheses, which seemed to be the smallest modification I could do that would get this feature to work, without adding way too many parentheses.</p>



<a name="268102805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268102805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268102805">(Jan 15 2022 at 03:58)</a>:</h4>
<p>To create a PR, should I push directly to the lean repository? Or can I do it from a fork? (This is my first lean PR, and I don't have write access.)</p>



<a name="268102809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268102809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268102809">(Jan 15 2022 at 03:58)</a>:</h4>
<p>Diff: <a href="https://github.com/leanprover-community/lean/compare/master...kmill:kmill_pp_parens?expand=1">https://github.com/leanprover-community/lean/compare/master...kmill:kmill_pp_parens?expand=1</a></p>



<a name="268104151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268104151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268104151">(Jan 15 2022 at 04:34)</a>:</h4>
<p>Outermost parentheses seem superfluous, but otherwise it looks good!</p>



<a name="268109730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268109730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268109730">(Jan 15 2022 at 06:49)</a>:</h4>
<p>I agree that it would be nice to get rid of the outermost brackets, but otherwise this looks like just what I was hoping for!</p>



<a name="268130185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268130185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268130185">(Jan 15 2022 at 15:14)</a>:</h4>
<p>Getting rid of outermost parentheses looks really hard, it requires a more global analysis. This output is also what you get with my implementation based on widgets.</p>



<a name="268136136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268136136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268136136">(Jan 15 2022 at 17:15)</a>:</h4>
<p>I had also considered an approach where <code>pp.parens</code> overrides the precedences of notation to convince lean to add more parentheses, but I couldn't convince myself that it would always produce correct output.</p>



<a name="268136137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268136137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268136137">(Jan 15 2022 at 17:15)</a>:</h4>
<p>Even if the outermost parentheses seem superfluous, at least there's this invariant that every notation has a corresponding set of parentheses wrapping it. All the examples above are equalities, so we see outermost ones.</p>
<p>In contrast, in this example there are no outermost parentheses so we know the top-level expression is not notation:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">p</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="mi">3</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c">/-</span><span class="cm"> ⊢ p (1 + 2) 3 -/</span>
<span class="kd">end</span>
</code></pre></div>



<a name="268141139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268141139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268141139">(Jan 15 2022 at 19:02)</a>:</h4>
<p><span class="user-mention" data-user-id="456794">@Patrick Johnson</span> Since you mentioned <code>pp.all</code>, what I learned looking through the source code is that, contrary to its name, it just overrides a handful of pretty printer options. Here's a complete list, for the curious:</p>
<ul>
<li><code>pp.implicit true</code></li>
<li><code>pp.proofs true</code></li>
<li><code>pp.coercions true</code></li>
<li><code>pp.notation false</code></li>
<li><code>pp.universes true</code></li>
<li><code>pp.full_names true</code></li>
<li><code>pp.beta false</code></li>
<li><code>pp.numerals false</code></li>
<li><code>pp.strings false</code></li>
<li><code>pp.binder_types true</code></li>
<li><code>pp.generalized_field_notation false</code></li>
</ul>



<a name="268172275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268172275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268172275">(Jan 16 2022 at 08:20)</a>:</h4>
<p>Oh wow, I had assumed that there was nothing between eg <code>pp.proofs true</code> and <code>pp.all</code>. I had no idea I had such fine control over output. This is surely helpful for debugging</p>



<a name="268172803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268172803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268172803">(Jan 16 2022 at 08:34)</a>:</h4>
<p>I will often use <code>pp.implicit true</code> and/or <code>pp.notation false</code> as a minimal set of options to see what I want (usually implicit typeclass arguments) without as much stuff as <code>pp.all</code></p>



<a name="268173213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Force%20explicit%20brackets%20in%20VS%20Code%3F/near/268173213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Force.20explicit.20brackets.20in.20VS.20Code.3F.html#268173213">(Jan 16 2022 at 08:44)</a>:</h4>
<p>Yes you've told me that before, but in situations where you need more I'd not realised that there are still many options available. I guess I'm yet to find out if this is useful in practice</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>