---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/simp.20and.20unfolding.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html">simp and unfolding</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="232157359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232157359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alistair Tucker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232157359">(Mar 28 2021 at 10:16)</a>:</h4>
<p>I thought it might work to have these simp lemmas:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">with_bot.coe_sup</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">semilattice_sup</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">((</span><span class="n">a</span> <span class="bp">⊔</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="n">α</span><span class="o">)</span> <span class="bp">⊔</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">with_bot</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">with_top.coe_sup</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">semilattice_sup</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">((</span><span class="n">a</span> <span class="bp">⊔</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">with_top</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">with_top</span> <span class="n">α</span><span class="o">)</span> <span class="bp">⊔</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">with_top</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>
<p>But it seems like <code>simp</code> will only ever use one (the more recently defined) for both cases, which would make it a pretty bad idea. I guess it sees the left hand side of both as just <code>((a ⊔ b : α) : option α)</code>?</p>



<a name="232157394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232157394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alistair Tucker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232157394">(Mar 28 2021 at 10:17)</a>:</h4>
<p>Was just wondering if there was some way to make this work</p>



<a name="232159450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232159450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232159450">(Mar 28 2021 at 10:58)</a>:</h4>
<p>I'm pretty sure I saw this in a recent PR. An easy compromise is to remove <code>@[simp]</code> from one of them, and add comments that reference each other.</p>



<a name="232159614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232159614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232159614">(Mar 28 2021 at 11:01)</a>:</h4>
<p>No, adding <code>@[simp]</code> to just one would be bad because the <code>⊔</code> on the right is annotated with the <code>with_bot</code> type so if it fires on a <code>with_top</code> goal then you will get type confusion issues</p>



<a name="232161377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232161377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232161377">(Mar 28 2021 at 11:37)</a>:</h4>
<p>This is exactly why we should just have three isomorphic types and duplicate a load of code :-)</p>



<a name="232163544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232163544" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232163544">(Mar 28 2021 at 12:22)</a>:</h4>
<p><code>irreducible</code> would fix this, right?</p>



<a name="232164534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232164534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232164534">(Mar 28 2021 at 12:41)</a>:</h4>
<p>I think they are already irreducible. This is a bug in <code>simp</code> which has already caused problems for mathport</p>



<a name="232165204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232165204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alistair Tucker <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232165204">(Mar 28 2021 at 12:54)</a>:</h4>
<p>Thanks! That may have been my PR <a href="https://github.com/leanprover-community/mathlib/issues/6922">#6922</a>.  I have removed the <code>@[simp]</code> tags for the moment.<br>
I don't know about <code>irreducible</code> but a quick search for the term in <code>bounded_lattice.lean</code> does not yield any results.</p>



<a name="232166637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/simp%20and%20unfolding/near/232166637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/simp.20and.20unfolding.html#232166637">(Mar 28 2021 at 13:19)</a>:</h4>
<p>I don't think they're irreducible. This has been discussed several times, but I don't think it made it to mathlib.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>