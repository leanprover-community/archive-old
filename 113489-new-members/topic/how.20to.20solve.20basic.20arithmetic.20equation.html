---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html">how to solve basic arithmetic equation</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="278870653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278870653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278870653">(Apr 13 2022 at 18:35)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">▶</span> <span class="mi">1</span> <span class="n">goal</span>
<span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">RawInt</span>
<span class="n">xy</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">y</span>
<span class="n">yz</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">~</span> <span class="n">z</span>
<span class="n">summed</span> <span class="o">:</span> <span class="n">x.1</span> <span class="bp">+</span> <span class="n">y.2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.1</span> <span class="bp">+</span> <span class="n">z.2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">y.1</span> <span class="bp">+</span> <span class="n">x.2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">z.1</span> <span class="bp">+</span> <span class="n">y.2</span><span class="o">)</span>
<span class="bp">⊢</span> <span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span> <span class="bp">+</span> <span class="o">(</span><span class="n">x.1</span> <span class="bp">+</span> <span class="n">z.2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span> <span class="bp">+</span> <span class="o">(</span><span class="n">z.1</span> <span class="bp">+</span> <span class="n">x.2</span><span class="o">)</span>
</code></pre></div>
<p>Is there any way to solve this without manually applying a bunch of lemmas to both sides?</p>
<p>This is the code I have so far (I am doing this for educational reasons)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">LeanSandbox.Nat</span>

<span class="kd">structure</span> <span class="n">RawInt</span> <span class="n">where</span>
  <span class="n">pos</span> <span class="o">:</span> <span class="n">Nat</span>
  <span class="n">neg</span> <span class="o">:</span> <span class="n">Nat</span>

<span class="kn">private</span> <span class="kd">def</span> <span class="n">eqv</span> <span class="o">:</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span><span class="o">:</span> <span class="n">RawInt</span><span class="o">)</span> <span class="bp">→</span> <span class="kt">Prop</span>
  <span class="bp">|</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span><span class="o">⟩,</span> <span class="o">⟨</span><span class="n">c</span><span class="o">,</span> <span class="n">d</span><span class="o">⟩</span> <span class="bp">=&gt;</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">d</span> <span class="bp">=</span> <span class="n">c</span> <span class="bp">+</span> <span class="n">b</span>

<span class="kd">infix</span><span class="o">:</span><span class="mi">50</span> <span class="s2">" ~ "</span> <span class="bp">=&gt;</span> <span class="n">eqv</span>

<span class="kn">private</span> <span class="kd">theorem</span> <span class="n">eqv.refl</span> <span class="o">(</span><span class="n">x</span><span class="o">:</span> <span class="n">RawInt</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">rfl</span>
<span class="kn">private</span> <span class="kd">theorem</span> <span class="n">eqv.symm</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span><span class="o">:</span> <span class="n">RawInt</span><span class="o">}</span> <span class="o">(</span><span class="n">xy</span><span class="o">:</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">y</span><span class="o">):</span>  <span class="n">y</span> <span class="bp">~</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">Eq.symm</span> <span class="n">xy</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">a - b   c - d   e - f</span>
<span class="cm">a + d = c + b</span>
<span class="cm">c + f = e + d</span>
<span class="cm"> =&gt; a + f = e + b -- the target</span>

<span class="cm">a + d + c + f = c + b + e + d</span>
<span class="cm">a + f + e + b -- done</span>
<span class="cm">-/</span>
<span class="kn">private</span> <span class="kd">theorem</span> <span class="n">eqv.trans</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">RawInt</span><span class="o">}</span> <span class="o">(</span><span class="n">xy</span><span class="o">:</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">y</span><span class="o">)</span> <span class="o">(</span><span class="n">yz</span><span class="o">:</span> <span class="n">y</span> <span class="bp">~</span> <span class="n">z</span><span class="o">):</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">z</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="k">have</span> <span class="n">summed</span><span class="o">:</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">Nat.add_equations</span> <span class="n">xy</span> <span class="n">yz</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">Nat.subtract_to_equation_left</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span><span class="o">)</span>
  <span class="n">simp</span>
</code></pre></div>



<a name="278887987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278887987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278887987">(Apr 13 2022 at 20:46)</a>:</h4>
<p>I'm not familiar with lean4; but why is that pretty-printing mixing <code>.1</code> and <code>.pos</code>?</p>



<a name="278888439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278888439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278888439">(Apr 13 2022 at 20:50)</a>:</h4>
<p><span class="user-mention" data-user-id="486803">@Matei Adriel</span> What's in <code>LeanSandbox</code>? Can you extract the minimal code necessary to run the code you pasted? Or point to a GitHub repo</p>



<a name="278888849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278888849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278888849">(Apr 13 2022 at 20:53)</a>:</h4>
<p>(deleted)</p>



<a name="278901967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278901967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278901967">(Apr 13 2022 at 22:57)</a>:</h4>
<p><span class="user-mention" data-user-id="451983">@Arthur Paulino</span> Lean sandbox is just my "learning lean" folder. I'll make a repo the next time I'm on my laptop</p>



<a name="278907341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278907341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278907341">(Apr 14 2022 at 00:12)</a>:</h4>
<p>(deleted)</p>



<a name="278907899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278907899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278907899">(Apr 14 2022 at 00:21)</a>:</h4>
<p><span class="user-mention" data-user-id="486803">@Matei Adriel</span> If you were using Lean 3 and mathlib, then I'd suggest <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#ring_nf">tactic#ring_nf</a> or <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#linear_combination">tactic#linear_combination</a>. Something you can still do is use <code>simp</code> to put terms into a normal form, if you give it enough lemmas:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">RawInt</span><span class="o">)</span>
  <span class="o">(</span><span class="n">summed</span> <span class="o">:</span> <span class="n">x.1</span> <span class="bp">+</span> <span class="n">y.2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.1</span> <span class="bp">+</span> <span class="n">z.2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">y.1</span> <span class="bp">+</span> <span class="n">x.2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">z.1</span> <span class="bp">+</span> <span class="n">y.2</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span> <span class="bp">+</span> <span class="o">(</span><span class="n">x.1</span> <span class="bp">+</span> <span class="n">z.2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span> <span class="bp">+</span> <span class="o">(</span><span class="n">z.1</span> <span class="bp">+</span> <span class="n">x.2</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">by</span>
   <span class="n">simp</span> <span class="o">[</span><span class="n">Nat.add_assoc</span><span class="o">,</span> <span class="n">Nat.add_left_comm</span><span class="o">,</span> <span class="n">Nat.add_comm</span><span class="o">]</span> <span class="n">at</span> <span class="n">summed</span> <span class="bp">⊢</span>
   <span class="n">exact</span> <span class="n">summed</span>
</code></pre></div>



<a name="278909139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278909139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278909139">(Apr 14 2022 at 00:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation/near/278887987">said</a>:</p>
<blockquote>
<p>I'm not familiar with lean4; but why is that pretty-printing mixing <code>.1</code> and <code>.pos</code>?</p>
</blockquote>
<p>This is the issue I mentioned in <a href="#narrow/stream/270676-lean4/topic/Working.20with.20primitive.20projections">https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Working.20with.20primitive.20projections</a></p>



<a name="278909161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278909161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278909161">(Apr 14 2022 at 00:39)</a>:</h4>
<p>when you see <code>.1</code> it's a primitive projection, while <code>.pos</code> is the projection function for the structure</p>



<a name="278909333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278909333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278909333">(Apr 14 2022 at 00:41)</a>:</h4>
<p>You can do this by two applications of <code>ring</code>: <code>Eq.trans (by ring) summed |&gt;.trans (by ring)</code></p>



<a name="278909359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278909359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278909359">(Apr 14 2022 at 00:41)</a>:</h4>
<p>This kind of arithmetic manipulation is something that I struggle with. How to use <code>this</code> to eliminate the <code>sorry</code> in</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">axiom</span> <span class="n">sumeqs</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">}</span> <span class="o">(</span><span class="n">hab</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">hcd</span><span class="o">:</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">d</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">c</span> <span class="bp">=</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">d</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">RawInt</span><span class="o">}</span> <span class="o">(</span><span class="n">xy</span><span class="o">:</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">y</span><span class="o">)</span> <span class="o">(</span><span class="n">yz</span><span class="o">:</span> <span class="n">y</span> <span class="bp">~</span> <span class="n">z</span><span class="o">):</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">z</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">sumeqs</span> <span class="n">xy</span> <span class="n">yz</span>
  <span class="c1">-- this : x.pos + y.neg + (y.pos + z.neg) = y.pos + x.neg + (z.pos + y.neg)</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="n">x.pos</span> <span class="bp">+</span> <span class="n">z.neg</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">z.pos</span> <span class="bp">+</span> <span class="n">x.neg</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span><span class="o">)</span> <span class="o">:=</span> <span class="gr">sorry</span>
  <span class="n">exact</span> <span class="n">Nat.add_right_cancel</span> <span class="n">h</span>
</code></pre></div>



<a name="278909483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278909483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278909483">(Apr 14 2022 at 00:43)</a>:</h4>
<p>I suspect this reasoning is similar to what Matei had in mind according to his code comments</p>



<a name="278910200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278910200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278910200">(Apr 14 2022 at 00:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="486803">Matei Adriel</span> <a href="#narrow/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation/near/278901967">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> Lean sandbox is just my "learning lean" folder. I'll make a repo the next time I'm on my laptop</p>
</blockquote>
<p>Np, I only asked because I thought you wanted to know how to use <code>Nat.add_equations</code> and <code>Nat.subtract_to_equation_left</code> to prove the theorem</p>



<a name="278910336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278910336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278910336">(Apr 14 2022 at 00:54)</a>:</h4>
<p>You can use the same sort of thing:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">RawInt</span><span class="o">}</span> <span class="o">(</span><span class="n">xy</span><span class="o">:</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">y</span><span class="o">)</span> <span class="o">(</span><span class="n">yz</span><span class="o">:</span> <span class="n">y</span> <span class="bp">~</span> <span class="n">z</span><span class="o">):</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">z</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">sumeqs</span> <span class="n">xy</span> <span class="n">yz</span>
  <span class="c1">-- this : x.pos + y.neg + (y.pos + z.neg) = y.pos + x.neg + (z.pos + y.neg)</span>
  <span class="k">have</span> <span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="n">x.pos</span> <span class="bp">+</span> <span class="n">z.neg</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">z.pos</span> <span class="bp">+</span> <span class="n">x.neg</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
    <span class="n">simp</span> <span class="o">[</span><span class="n">Nat.add_assoc</span><span class="o">,</span> <span class="n">Nat.add_left_comm</span><span class="o">,</span> <span class="n">Nat.add_comm</span><span class="o">]</span> <span class="n">at</span> <span class="n">this</span> <span class="bp">⊢</span>
    <span class="n">exact</span> <span class="n">this</span>
  <span class="n">exact</span> <span class="n">Nat.add_right_cancel</span> <span class="n">h</span>
</code></pre></div>



<a name="278910642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278910642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278910642">(Apr 14 2022 at 00:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation/near/278909333">said</a>:</p>
<blockquote>
<p>You can do this by two applications of <code>ring</code>: <code>Eq.trans (by ring) summed |&gt;.trans (by ring)</code></p>
</blockquote>
<p>Just to show that this suggestion works even with a bad emulation of the <code>ring</code> tactic, if you're not using mathlib4 for some reason.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">macro</span> <span class="s2">"ring"</span> <span class="o">:</span> <span class="n">tactic</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">simp</span> <span class="o">[</span><span class="n">Nat.add_assoc</span><span class="o">,</span> <span class="n">Nat.add_left_comm</span><span class="o">,</span> <span class="n">Nat.add_comm</span><span class="o">])</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">RawInt</span><span class="o">)</span>
  <span class="o">(</span><span class="n">summed</span> <span class="o">:</span> <span class="n">x.1</span> <span class="bp">+</span> <span class="n">y.2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.1</span> <span class="bp">+</span> <span class="n">z.2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">y.1</span> <span class="bp">+</span> <span class="n">x.2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">z.1</span> <span class="bp">+</span> <span class="n">y.2</span><span class="o">))</span> <span class="o">:</span>
  <span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span> <span class="bp">+</span> <span class="o">(</span><span class="n">x.1</span> <span class="bp">+</span> <span class="n">z.2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span> <span class="bp">+</span> <span class="o">(</span><span class="n">z.1</span> <span class="bp">+</span> <span class="n">x.2</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">Eq.trans</span> <span class="o">(</span><span class="kd">by</span> <span class="n">ring</span><span class="o">)</span> <span class="n">summed</span> <span class="bp">|&gt;.</span><span class="n">trans</span> <span class="o">(</span><span class="kd">by</span> <span class="n">ring</span><span class="o">)</span>
</code></pre></div>



<a name="278910758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278910758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278910758">(Apr 14 2022 at 00:58)</a>:</h4>
<p>Ah, then the reasoning is that we don't shape the hypothesis to be in the same form as the goal, but rather shape the hypothesis <em>and</em> the goal to be in the same form. And I thought that "normal form" would be <code>((a + b) + c) + d</code> but it's actually <code>a + (b + (c + d))</code> right?</p>



<a name="278949945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278949945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278949945">(Apr 14 2022 at 10:55)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> I'll try your solution next time I'm on my laptop!<br>
<span class="user-mention" data-user-id="451983">@Arthur Paulino</span> yep, that's exactly what my code is doing. Is there a way to search for existing lemmas, hoogle style?</p>



<a name="278950564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278950564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278950564">(Apr 14 2022 at 11:02)</a>:</h4>
<p>I'm not familiar with Hoogle, but in Mathlib there's a tactic called <code>library_search</code> that tries to find the right lemma/theorem in your environment to prove a certain theorem. It works nicely in Lean 3, but for Lean 4 we'll need to wait some more</p>



<a name="278950928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278950928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278950928">(Apr 14 2022 at 11:07)</a>:</h4>
<p>Mathlib4 has a Hoogle equivalent: <a href="https://leanprover-community.github.io/mathlib4_docs/Mathlib/Tactic/Find.html">https://leanprover-community.github.io/mathlib4_docs/Mathlib/Tactic/Find.html</a></p>



<a name="278951058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/278951058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#278951058">(Apr 14 2022 at 11:08)</a>:</h4>
<p>But, as Arthur said, <code>library_search</code> is the way to go in Lean 3 and will eventually work great in Lean 4 too</p>



<a name="279090523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279090523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279090523">(Apr 15 2022 at 15:26)</a>:</h4>
<p>So I have tried </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">private</span> <span class="kd">theorem</span> <span class="n">eqv.trans</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">RawInt</span><span class="o">}</span> <span class="o">(</span><span class="n">xy</span><span class="o">:</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">y</span><span class="o">)</span> <span class="o">(</span><span class="n">yz</span><span class="o">:</span> <span class="n">y</span> <span class="bp">~</span> <span class="n">z</span><span class="o">):</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">z</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="k">have</span> <span class="n">summed</span><span class="o">:</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">Nat.add_equations</span> <span class="n">xy</span> <span class="n">yz</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">Nat.subtract_to_equation_left</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span><span class="o">)</span>
  <span class="n">simp_all</span> <span class="o">[</span><span class="n">Nat.add_assoc</span><span class="o">,</span> <span class="n">Nat.add_left_comm</span><span class="o">,</span> <span class="n">Nat.add_comm</span><span class="o">]</span>
  <span class="n">exact</span> <span class="n">summed</span>
</code></pre></div>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> and I get this error:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Diagnostics</span><span class="o">:</span>
<span class="mi">1</span><span class="bp">.</span> <span class="n">type</span> <span class="n">mismatch</span>
     <span class="n">summed</span>
   <span class="n">has</span> <span class="n">type</span>
     <span class="n">x.1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.2</span> <span class="bp">+</span> <span class="n">z.2</span><span class="o">))</span> <span class="bp">=</span> <span class="n">y.1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">z.1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">x.2</span> <span class="bp">+</span> <span class="n">y.2</span><span class="o">))</span> <span class="o">:</span> <span class="kt">Prop</span>
   <span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
     <span class="n">x.1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">z.2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.neg</span> <span class="bp">+</span> <span class="n">y.pos</span><span class="o">))</span> <span class="bp">=</span> <span class="n">z.1</span> <span class="bp">+</span> <span class="o">(</span><span class="n">x.2</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y.neg</span> <span class="bp">+</span> <span class="n">y.pos</span><span class="o">))</span> <span class="o">:</span> <span class="kt">Prop</span>
</code></pre></div>



<a name="279091152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279091152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279091152">(Apr 15 2022 at 15:33)</a>:</h4>
<p>I had a similar sort of error before upgrading to the newest Lean 4 nightly build. What seems to be the case is that primitive projections and projection functions end up being sorted by <code>simp</code> in a different order, and in the newest version primitive projections stopped appearing. (Maybe <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> has an idea of what changed?)</p>



<a name="279091305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279091305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279091305">(Apr 15 2022 at 15:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation/near/279091152">said</a>:</p>
<blockquote>
<p>I had a similar sort of error before upgrading to the newest Lean 4 nightly build. What seems to be the case is that primitive projections and projection functions end up being sorted by <code>simp</code> in a different order, and in the newest version primitive projections stopped appearing. (Maybe <span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> has an idea of what changed?)</p>
</blockquote>
<p>How can I update using elan?</p>



<a name="279091663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279091663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279091663">(Apr 15 2022 at 15:38)</a>:</h4>
<p>tried elan update but I still get the same error</p>



<a name="279091936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279091936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279091936">(Apr 15 2022 at 15:41)</a>:</h4>
<p>The error is unrelated, your x and z are in different places</p>



<a name="279092017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279092017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279092017">(Apr 15 2022 at 15:42)</a>:</h4>
<p>so is there any way to get rid of that without manually applying a bazillion lemmas</p>



<a name="279092067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279092067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279092067">(Apr 15 2022 at 15:43)</a>:</h4>
<p>What does <code>simpa</code> do here?</p>



<a name="279092177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279092177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279092177">(Apr 15 2022 at 15:44)</a>:</h4>
<p>what <span class="user-mention" data-user-id="306601">@Kyle Miller</span> proposed</p>



<a name="279092354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279092354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279092354">(Apr 15 2022 at 15:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation/near/279091936">said</a>:</p>
<blockquote>
<p>The error is unrelated, your x and z are in different places</p>
</blockquote>
<p>The primitive projections seem to cause a different sort order</p>



<a name="279092366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279092366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279092366">(Apr 15 2022 at 15:46)</a>:</h4>
<p><span class="user-mention" data-user-id="486803">@Matei Adriel</span> If you post a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> I can try it on my own computer</p>



<a name="279092622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279092622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279092622">(Apr 15 2022 at 15:49)</a>:</h4>
<p><a href="https://github.com/Mateiadrielrafael/lean-sandbox">https://github.com/Mateiadrielrafael/lean-sandbox</a></p>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span></p>



<a name="279092928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279092928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279092928">(Apr 15 2022 at 15:51)</a>:</h4>
<p>On the Lean nightly from the last couple days, your code works. Actually, you need to delete the <code>exact summed</code></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">private</span> <span class="kd">theorem</span> <span class="n">eqv.trans</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">:</span> <span class="n">RawInt</span><span class="o">}</span> <span class="o">(</span><span class="n">xy</span><span class="o">:</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">y</span><span class="o">)</span> <span class="o">(</span><span class="n">yz</span><span class="o">:</span> <span class="n">y</span> <span class="bp">~</span> <span class="n">z</span><span class="o">):</span> <span class="n">x</span> <span class="bp">~</span> <span class="n">z</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="k">have</span> <span class="n">summed</span><span class="o">:</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">Nat.add_equations</span> <span class="n">xy</span> <span class="n">yz</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">Nat.add_right_cancel</span> <span class="n">_</span> <span class="o">(</span><span class="n">y.pos</span> <span class="bp">+</span> <span class="n">y.neg</span><span class="o">)</span> <span class="n">_</span>
  <span class="n">simp_all</span> <span class="o">[</span><span class="n">Nat.add_assoc</span><span class="o">,</span> <span class="n">Nat.add_left_comm</span><span class="o">,</span> <span class="n">Nat.add_comm</span><span class="o">]</span>
</code></pre></div>



<a name="279093068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279093068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279093068">(Apr 15 2022 at 15:52)</a>:</h4>
<p>yeah, removing the exact doesn't solve it either. How can I install the nightly build using elan?</p>



<a name="279093154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279093154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279093154">(Apr 15 2022 at 15:53)</a>:</h4>
<p>Btw, I wasn't suggesting to tell you to delete <code>exact summed</code> -- I was just mentioning that you get "goals accomplished" on the newest Lean at the <code>simp_all</code> line.</p>



<a name="279093244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279093244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279093244">(Apr 15 2022 at 15:54)</a>:</h4>
<p>I don't know how you're <em>supposed</em> to update your Lean 4 toolchain in a project, but for one of my projects I set the <code>lean-toolchain</code> file to contain <code>leanprover/lean4:nightly</code> rather than a specific version.</p>



<a name="279093370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279093370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279093370">(Apr 15 2022 at 15:55)</a>:</h4>
<p>what lean-toolchain file?</p>



<a name="279093715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279093715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279093715">(Apr 15 2022 at 15:58)</a>:</h4>
<p>I only know that I have one in the root folder of my project -- sorry, I can't really help beyond this.</p>



<a name="279094127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/how%20to%20solve%20basic%20arithmetic%20equation/near/279094127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matei Adriel <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/how.20to.20solve.20basic.20arithmetic.20equation.html#279094127">(Apr 15 2022 at 16:02)</a>:</h4>
<p>thanks, figured it out eventually</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>