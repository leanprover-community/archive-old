---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html">Natural numbers game - Advanced addition</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="204108322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204108322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204108322">(Jul 16 2020 at 16:28)</a>:</h4>
<p>I managed to solve the Advanced Addition World Level 1 and 2 (<a href="http://wwwf.imperial.ac.uk/~buzzard/xena/natural_number_game/?world=8&amp;level=1">http://wwwf.imperial.ac.uk/~buzzard/xena/natural_number_game/?world=8&amp;level=1</a>) using the commands below, but, honestly, I do not understand why it worked.  Can someone explain the reason why this is a valid proof?  Thank you!</p>
<p>Level 1:<br>
cases hs with g h,<br>
refl,</p>
<p>Level21:<br>
cases h with g h,<br>
refl,</p>



<a name="204108774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204108774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204108774">(Jul 16 2020 at 16:31)</a>:</h4>
<p>Ha, there's a bit of trickery going on there...</p>



<a name="204108819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204108819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204108819">(Jul 16 2020 at 16:32)</a>:</h4>
<p>I think this is not the "intended solution" (<span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> correct me if I'm wrong)</p>



<a name="204108976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204108976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204108976">(Jul 16 2020 at 16:33)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> I think Kevin wanted to have you start with <code>apply succ_inj</code>, or something like that.</p>



<a name="204109367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204109367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204109367">(Jul 16 2020 at 16:36)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span> If you have <code>h : x = complicated thing</code>, and you run <code>cases h</code>, then Lean figures out that it should just substitute all occurences of <code>x</code> with <code>complicated thing</code> (I actually don't know the details of why).<br>
In this case it seems to figure out that the only way that <code>succ a</code> and <code>succ b</code> can be equal is if <code>a = b</code>, so it replaces all occurences of <code>b</code> with <code>a</code>.</p>



<a name="204109403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204109403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204109403">(Jul 16 2020 at 16:36)</a>:</h4>
<p><span class="user-mention" data-user-id="111080">@Floris van Doorn</span> or <span class="user-mention" data-user-id="110865">@Jeremy Avigad</span> could you maybe give the "official" explanation?</p>



<a name="204109942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204109942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204109942">(Jul 16 2020 at 16:41)</a>:</h4>
<p>It has to do with the fact that equality is defined internally as an indexed inductive type with a single constructor, reflexivity; the elimination principle is essentially just substitution. </p>
<p>Probably the best way to think of it is this: when you ask Lean to do cases on an equality "x = y", it knows that x and y are supposed to be the same, and so it replaces x by y.</p>



<a name="204110132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204110132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204110132">(Jul 16 2020 at 16:43)</a>:</h4>
<p>Another way to say it: the canonical way to "use" an equation is just to substitute. <code>cases</code> on something is supposed to give us the canonical way of using it.</p>



<a name="204110555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204110555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204110555">(Jul 16 2020 at 16:46)</a>:</h4>
<p>But how can it "see through" the succ on both sides...</p>



<a name="204110567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204110567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204110567">(Jul 16 2020 at 16:46)</a>:</h4>
<p>Why does it change <code>a = b</code> in the goal to <code>a = a</code></p>



<a name="204111029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204111029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204111029">(Jul 16 2020 at 16:50)</a>:</h4>
<p><code>cases</code> has special support to deal with equalities between constructors of inductive types. Under the hood I'm quite sure it calls <code>no_confusion</code>. <br>
<code>no_confusion</code> is the way in Lean to simultaneously do show things:</p>
<ul>
<li>Two different constructors of an inductive type are never equal;</li>
<li>Every constructor is injective: they are only equal if <em>all</em> their inputs are equal.</li>
</ul>



<a name="204111067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204111067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204111067">(Jul 16 2020 at 16:51)</a>:</h4>
<p>Yup, it calls <code>no_confusion</code></p>



<a name="204111133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204111133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204111133">(Jul 16 2020 at 16:51)</a>:</h4>
<p>Johan is correct that in this case it does <em>not</em> just apply the induction principle of equality, so it's more than just <code>induction hs</code> (which should fail)</p>



<a name="204111464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204111464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204111464">(Jul 16 2020 at 16:54)</a>:</h4>
<p>Yup, that indeed fails.</p>



<a name="204111631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204111631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204111631">(Jul 16 2020 at 16:56)</a>:</h4>
<p>Sorry, yes, I read too quickly. Leo did a lot of work on the cases tactic so that it would do the right thing when pattern matching in function definitions. So there are heuristics being applied under the hood, including <code>no_confusion</code>.</p>



<a name="204114120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204114120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204114120">(Jul 16 2020 at 17:14)</a>:</h4>
<p>rofl so <span class="user-mention" data-user-id="321459">@Damiano Testa</span> it's all about <code>no_confusion</code>, so I hope you're no longer confused :-)</p>



<a name="204114137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204114137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204114137">(Jul 16 2020 at 17:14)</a>:</h4>
<p>but I rather suspect you are now more confused :-/</p>



<a name="204114189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204114189" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204114189">(Jul 16 2020 at 17:15)</a>:</h4>
<p>These are great proofs by the way!</p>



<a name="204141383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204141383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204141383">(Jul 16 2020 at 20:53)</a>:</h4>
<p>Dear All,</p>
<p>Thank you very much for your answers!  I do not fully understand them and as <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> suggests, I will need to apply  no_confusion a few more times!  Anyway, it is fun to learn Lean!</p>



<a name="204141496"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Natural%20numbers%20game%20-%20Advanced%20addition/near/204141496" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Natural.20numbers.20game.20-.20Advanced.20addition.html#204141496">(Jul 16 2020 at 20:53)</a>:</h4>
<p><a href="https://xenaproject.wordpress.com/2018/03/24/no-confusion-over-no_confusion/">https://xenaproject.wordpress.com/2018/03/24/no-confusion-over-no_confusion/</a> <span class="user-mention" data-user-id="321459">@Damiano Testa</span></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>