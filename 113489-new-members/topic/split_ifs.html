---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/split_ifs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html">split_ifs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="207714153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207714153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207714153">(Aug 22 2020 at 08:24)</a>:</h4>
<p>How can I resolve this goal?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">normed_space</span><span class="bp">.</span><span class="n">indicator_function</span>
<span class="kn">import</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">set_integral</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">specific_limits</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">geom_sum</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">fin_cases</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">complex</span><span class="bp">.</span><span class="n">exponential</span>
<span class="kn">import</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">probability_mass_function</span>
<span class="kn">import</span> <span class="n">set_theory</span><span class="bp">.</span><span class="n">cardinal_ordinal</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="kn">universe</span> <span class="n">u</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span>


<span class="n">def</span> <span class="n">expectation</span> <span class="o">(</span><span class="n">pr</span> <span class="o">:</span> <span class="n">pmf</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">real</span><span class="o">)</span> <span class="o">:</span> <span class="n">real</span> <span class="o">:=</span>
<span class="err">∑&#39;</span> <span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">pr</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">a</span>



<span class="n">def</span> <span class="n">real_of_bool</span> <span class="o">(</span><span class="n">b</span><span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">:</span> <span class="n">real</span> <span class="o">:=</span> <span class="k">if</span> <span class="n">b</span> <span class="bp">=</span> <span class="n">true</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>


<span class="n">def</span> <span class="n">bernoulli_expectation</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">nnreal</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≤</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="n">expectation</span> <span class="o">(</span><span class="n">pmf</span><span class="bp">.</span><span class="n">bernoulli</span> <span class="n">p</span> <span class="n">h</span><span class="o">)</span> <span class="n">real_of_bool</span> <span class="bp">=</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">unfold</span> <span class="n">expectation</span><span class="o">,</span>
<span class="n">unfold</span> <span class="n">pmf</span><span class="bp">.</span><span class="n">bernoulli</span><span class="o">,</span>
<span class="c1">-- p: nnreal</span>
<span class="c1">-- h: p ≤ 1</span>
<span class="c1">-- ⊢ (∑&#39; (a : bool), ↑(⇑(pmf.of_fintype (λ (b : bool), cond b p (1 - p)) _) a) * real_of_bool a) = ↑p</span>
<span class="n">unfold</span> <span class="n">tsum</span><span class="o">,</span>
<span class="n">split_ifs</span><span class="o">,</span>
<span class="c1">-- 2 goals</span>
<span class="c1">-- p: nnreal</span>
<span class="c1">-- h: p ≤ 1</span>
<span class="c1">-- h_1: summable (λ (a : bool), ↑(⇑(pmf.of_fintype (λ (b : bool), cond b p (1 - p)) _) a) * real_of_bool a)</span>
<span class="c1">-- ⊢ classical.some h_1 = ↑p</span>
<span class="c1">-- p: nnreal</span>
<span class="c1">-- h: p ≤ 1</span>
<span class="c1">-- h_1: ¬summable (λ (a : bool), ↑(⇑(pmf.of_fintype (λ (b : bool), cond b p (1 - p)) _) a) * real_of_bool a)</span>
<span class="c1">-- ⊢ 0 = ↑p</span>
<span class="kn">end</span>
</code></pre></div>



<a name="207715217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207715217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207715217">(Aug 22 2020 at 09:01)</a>:</h4>
<p>you would benefit from my advice "stop unfolding!"</p>



<a name="207715408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207715408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207715408">(Aug 22 2020 at 09:07)</a>:</h4>
<p>(it does not apply to <code>expectation</code> or <code>pmf.bernoulli</code> because there are no theorems for them)</p>



<a name="207715556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207715556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207715556">(Aug 22 2020 at 09:11)</a>:</h4>
<p>I used <code>unfold tsum</code> because I couldn't see what else to do :-)</p>



<a name="207715562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207715562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207715562">(Aug 22 2020 at 09:11)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">normed_space</span><span class="bp">.</span><span class="n">indicator_function</span>
<span class="kn">import</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">set_integral</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">specific_limits</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">geom_sum</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">fin_cases</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">complex</span><span class="bp">.</span><span class="n">exponential</span>
<span class="kn">import</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">probability_mass_function</span>
<span class="kn">import</span> <span class="n">set_theory</span><span class="bp">.</span><span class="n">cardinal_ordinal</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="kn">universe</span> <span class="n">u</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span>

<span class="c1">-- we prefer unicode</span>
<span class="n">def</span> <span class="n">expectation</span> <span class="o">(</span><span class="n">pr</span> <span class="o">:</span> <span class="n">pmf</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="err">∑&#39;</span> <span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">pr</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">a</span>

<span class="c1">-- use `cond`</span>
<span class="n">def</span> <span class="n">real_of_bool</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">bool</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="n">cond</span> <span class="n">b</span> <span class="mi">1</span> <span class="mi">0</span>

<span class="n">def</span> <span class="n">bernoulli_expectation</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">nnreal</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≤</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">expectation</span> <span class="o">(</span><span class="n">pmf</span><span class="bp">.</span><span class="n">bernoulli</span> <span class="n">p</span> <span class="n">h</span><span class="o">)</span> <span class="n">real_of_bool</span> <span class="bp">=</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">unfold</span> <span class="n">expectation</span> <span class="n">pmf</span><span class="bp">.</span><span class="n">bernoulli</span> <span class="n">real_of_bool</span> <span class="n">pmf</span><span class="bp">.</span><span class="n">of_fintype</span><span class="o">,</span> <span class="c1">-- unfold things without API</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">tsum_fintype</span><span class="o">,</span> <span class="n">fintype</span><span class="bp">.</span><span class="n">sum_bool</span><span class="o">],</span>
  <span class="n">change</span> <span class="o">(</span><span class="n">p</span> <span class="bp">*</span> <span class="mi">1</span> <span class="bp">+</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span> <span class="o">:</span> <span class="n">nnreal</span><span class="o">)</span> <span class="bp">*</span> <span class="mi">0</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">p</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">mul_one</span><span class="o">,</span> <span class="n">mul_zero</span><span class="o">,</span> <span class="n">add_zero</span><span class="o">]</span>
<span class="kn">end</span>
</code></pre></div>



<a name="207715608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207715608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207715608">(Aug 22 2020 at 09:12)</a>:</h4>
<p><span class="user-mention" data-user-id="253355">@Iocta</span> ask yourself: how can I remove the noise to reveal the essence of the next step? Then you would know that taking the tsum of a fintype should be the same as the sum over the fintype</p>



<a name="207715881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207715881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207715881">(Aug 22 2020 at 09:21)</a>:</h4>
<p>What made you think to go straight to the <code>fintype</code> api?</p>



<a name="207716004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716004">(Aug 22 2020 at 09:25)</a>:</h4>
<p>(instead of sum-related stuff, or bool stuff, or pmf stuff or measure stuff)</p>



<a name="207716137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716137">(Aug 22 2020 at 09:30)</a>:</h4>
<p>I don't really know how to answer that question</p>



<a name="207716160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716160">(Aug 22 2020 at 09:30)</a>:</h4>
<p>perhaps <span class="user-mention" data-user-id="112680">@Johan Commelin</span> could help</p>



<a name="207716166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716166">(Aug 22 2020 at 09:30)</a>:</h4>
<p>Let me read the question (-;</p>



<a name="207716167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716167">(Aug 22 2020 at 09:30)</a>:</h4>
<p>I mean, "my intuition told me so" is neither helpful nor valid: intuition just means something you can't explain</p>



<a name="207716175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716175">(Aug 22 2020 at 09:31)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> what's the first thing that comes to mind when you see the goal <code>(∑' (a : bool), ↑(⇑⟨λ (b : bool), cond b p (1 - p), _⟩ a) * cond a 1 0) = ↑p</code>?</p>



<a name="207716180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716180">(Aug 22 2020 at 09:31)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">p</span> <span class="o">:</span> <span class="n">nnreal</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≤</span> <span class="mi">1</span>
<span class="err">⊢</span> <span class="o">(</span><span class="err">∑&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">bool</span><span class="o">),</span> <span class="err">↑</span><span class="o">(</span><span class="err">⇑</span><span class="bp">⟨λ</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">bool</span><span class="o">),</span> <span class="n">cond</span> <span class="n">b</span> <span class="n">p</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">),</span> <span class="bp">_⟩</span> <span class="n">a</span><span class="o">)</span> <span class="bp">*</span> <span class="n">cond</span> <span class="n">a</span> <span class="mi">1</span> <span class="mi">0</span><span class="o">)</span> <span class="bp">=</span> <span class="err">↑</span><span class="n">p</span>
</code></pre></div>



<a name="207716182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716182">(Aug 22 2020 at 09:31)</a>:</h4>
<p>That <code>tsum</code> is aweful</p>



<a name="207716187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716187">(Aug 22 2020 at 09:31)</a>:</h4>
<p>see we have the same intuition</p>



<a name="207716189"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716189" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716189">(Aug 22 2020 at 09:31)</a>:</h4>
<p>But yes, turning that into a <code>finset.sum</code> is a great start</p>



<a name="207716190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716190">(Aug 22 2020 at 09:31)</a>:</h4>
<p>but how can you explain it?</p>



<a name="207716191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716191">(Aug 22 2020 at 09:31)</a>:</h4>
<p>it's like Magnus Carlsen explaining his move because it "felt intuitive"</p>



<a name="207716230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716230">(Aug 22 2020 at 09:32)</a>:</h4>
<p>sure, it works for him, but it doesn't explain anything</p>



<a name="207716231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716231">(Aug 22 2020 at 09:32)</a>:</h4>
<p>Well, it's an infinite sum, which means you have to care about convergence etc...</p>



<a name="207716234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716234">(Aug 22 2020 at 09:32)</a>:</h4>
<p>So if you sum over a finite type, then certainly you don't want to care about that</p>



<a name="207716237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716237">(Aug 22 2020 at 09:32)</a>:</h4>
<p>the way it works for me, I see the infinite sum, I think to myself, oh that's "just" a finite sum</p>



<a name="207716241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716241">(Aug 22 2020 at 09:32)</a>:</h4>
<p>so why not rewrite it as a finite sum</p>



<a name="207716251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716251">(Aug 22 2020 at 09:33)</a>:</h4>
<p>my intuition tells me that tsum is something I know nothing about and sum is something I know more about</p>



<a name="207716284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716284">(Aug 22 2020 at 09:34)</a>:</h4>
<p>so it's I guess the same mentality as "unfolding definitions"</p>



<a name="207716296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716296">(Aug 22 2020 at 09:34)</a>:</h4>
<p>but not using <code>unfold</code></p>



<a name="207716299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716299">(Aug 22 2020 at 09:34)</a>:</h4>
<p>because mathematical definition is not the same as Lean definition</p>



<a name="207716302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716302">(Aug 22 2020 at 09:34)</a>:</h4>
<p>in Lean one object has one definition (Kevin would call this implementation)</p>



<a name="207716306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716306">(Aug 22 2020 at 09:34)</a>:</h4>
<p>in math one object can have 37 definitions</p>



<a name="207716312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716312">(Aug 22 2020 at 09:35)</a>:</h4>
<p>using the appropriate API to me feels like choosing the right definition to unfold</p>



<a name="207716316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716316">(Aug 22 2020 at 09:35)</a>:</h4>
<p><span class="user-mention" data-user-id="253355">@Iocta</span> I hope this is more helpful than "well my intuition told me so"</p>



<a name="207716391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716391">(Aug 22 2020 at 09:37)</a>:</h4>
<p>Yes, it is. Similar to replacing <code>ite</code> with <code>cond</code></p>



<a name="207716408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716408">(Aug 22 2020 at 09:37)</a>:</h4>
<p>oh that one</p>



<a name="207716451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716451">(Aug 22 2020 at 09:38)</a>:</h4>
<p><code>if</code> is for Prop</p>



<a name="207716454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716454">(Aug 22 2020 at 09:38)</a>:</h4>
<p>no need to convert it to Prop if there is a version for bool</p>



<a name="207716467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716467">(Aug 22 2020 at 09:39)</a>:</h4>
<p>switching to a less powerful tool without losing info</p>



<a name="207716470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716470">(Aug 22 2020 at 09:39)</a>:</h4>
<p>it isn't less powerful</p>



<a name="207716475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716475">(Aug 22 2020 at 09:39)</a>:</h4>
<p>well, possibly-infinite -&gt; finite, arbitrary prop -&gt; bool</p>



<a name="207716517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207716517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207716517">(Aug 22 2020 at 09:40)</a>:</h4>
<p>fair enough</p>



<a name="207742076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207742076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207742076">(Aug 22 2020 at 21:03)</a>:</h4>
<p>What is this error about?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">set_integral</span>
<span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">specific_limits</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">geom_sum</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">fin_cases</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">set</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">complex</span><span class="bp">.</span><span class="n">exponential</span>
<span class="kn">import</span> <span class="n">measure_theory</span><span class="bp">.</span><span class="n">probability_mass_function</span>
<span class="kn">import</span> <span class="n">set_theory</span><span class="bp">.</span><span class="n">cardinal_ordinal</span>

<span class="n">noncomputable</span> <span class="n">theory</span>

<span class="kn">universe</span> <span class="n">u</span>
<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span>


<span class="n">def</span> <span class="n">expectation</span> <span class="o">(</span><span class="n">pr</span> <span class="o">:</span> <span class="n">pmf</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span> <span class="o">:=</span>
<span class="err">∑&#39;</span> <span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">pr</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">f</span> <span class="n">a</span>


<span class="n">def</span> <span class="n">binomial_pmf</span> <span class="o">{</span><span class="n">p</span><span class="o">:</span> <span class="n">nnreal</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">p</span> <span class="bp">≤</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">pmf</span> <span class="bp">ℕ</span> <span class="o">:=</span>
<span class="bp">⟨</span> <span class="bp">λ</span> <span class="n">k</span><span class="o">,</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">choose</span> <span class="n">n</span> <span class="n">k</span><span class="o">)</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">k</span><span class="o">)</span> <span class="o">,</span> <span class="n">sorry</span> <span class="bp">⟩</span>


<span class="kn">lemma</span> <span class="n">mul_choose</span> <span class="o">(</span><span class="n">n</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span><span class="bp">.</span><span class="n">choose</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="o">((</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="o">(</span><span class="n">k</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span> <span class="o">:=</span> <span class="n">sorry</span>

<span class="kn">theorem</span> <span class="n">binomial_expectation</span> <span class="o">{</span><span class="n">p</span> <span class="o">:</span> <span class="n">nnreal</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">p</span> <span class="bp">≤</span> <span class="mi">1</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span>
<span class="n">expectation</span> <span class="o">(</span><span class="n">binomial_pmf</span> <span class="n">h</span> <span class="n">n</span><span class="o">)</span> <span class="n">coe</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">p</span> <span class="o">:=</span>
<span class="k">begin</span>
<span class="n">unfold</span> <span class="n">expectation</span> <span class="n">binomial_pmf</span> <span class="n">pmf</span><span class="bp">.</span><span class="n">of_fintype</span><span class="o">,</span>
<span class="n">suffices</span> <span class="o">:</span> <span class="o">(</span><span class="err">∑&#39;</span><span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="err">↑</span><span class="o">(</span><span class="n">n</span><span class="bp">.</span><span class="n">choose</span> <span class="n">k</span><span class="o">)</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">k</span><span class="o">)</span> <span class="bp">*</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="err">↑</span><span class="n">n</span> <span class="bp">*</span> <span class="n">p</span><span class="o">,</span>
<span class="o">{</span>
<span class="c1">--p: nnreal</span>
<span class="c1">--h: p ≤ 1</span>
<span class="c1">--n: ℕ</span>
<span class="c1">--this: (∑&#39; (k : ℕ), ↑(n.choose k) * p ^ k * (1 - p) ^ (n - k) * ↑k) = ↑n * p</span>
<span class="c1">--⊢ (∑&#39; (a : ℕ), ↑(⇑⟨λ (k : ℕ), ↑(n.choose k) * p ^ k * (1 - p) ^ (n - k), _⟩ a) * ↑a) = ↑n * ↑p</span>
    <span class="n">sorry</span><span class="o">,</span>
<span class="o">},</span>
<span class="k">calc</span> <span class="o">(</span><span class="err">∑&#39;</span><span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">),</span> <span class="err">↑</span><span class="o">(</span><span class="n">n</span><span class="bp">.</span><span class="n">choose</span> <span class="n">k</span><span class="o">)</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">k</span><span class="o">)</span> <span class="bp">*</span> <span class="n">k</span><span class="o">)</span> <span class="bp">=</span> <span class="err">∑&#39;</span> <span class="n">k</span> <span class="err">∈</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="n">n</span><span class="o">),</span> <span class="o">(</span><span class="n">n</span><span class="bp">.</span><span class="n">choose</span> <span class="n">k</span><span class="o">)</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">k</span><span class="o">)</span> <span class="bp">*</span> <span class="n">k</span><span class="o">:</span> <span class="n">sorry</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="err">∑&#39;</span> <span class="n">k</span> <span class="err">∈</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="n">n</span><span class="o">),</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span><span class="bp">.</span><span class="n">choose</span> <span class="n">k</span><span class="o">)</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">k</span><span class="o">)</span> <span class="o">:</span> <span class="n">sorry</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="err">∑&#39;</span> <span class="n">k</span> <span class="err">∈</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="n">n</span><span class="o">),</span> <span class="n">n</span> <span class="bp">*</span> <span class="o">((</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="o">(</span><span class="n">k</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">k</span><span class="o">)</span> <span class="o">:</span> <span class="n">sorry</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="o">(</span><span class="err">∑&#39;</span> <span class="n">k</span> <span class="err">∈</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="n">n</span><span class="o">),</span> <span class="o">((</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="o">(</span><span class="n">k</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="n">k</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">k</span><span class="o">))</span> <span class="o">:</span> <span class="n">sorry</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">*</span> <span class="o">(</span><span class="err">∑&#39;</span> <span class="n">k</span> <span class="err">∈</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="n">n</span><span class="o">)</span> <span class="err">\</span> <span class="o">{</span><span class="mi">0</span><span class="o">},</span> <span class="o">((</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="o">(</span><span class="n">k</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="o">(</span><span class="n">k</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="n">k</span><span class="o">))</span> <span class="o">:</span> <span class="n">sorry</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">*</span> <span class="o">(</span><span class="err">∑&#39;</span> <span class="n">j</span> <span class="err">∈</span> <span class="o">(</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)),</span> <span class="o">((</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="n">j</span><span class="o">)</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">^</span> <span class="n">j</span> <span class="bp">*</span> <span class="o">(</span><span class="mi">1</span> <span class="bp">-</span> <span class="n">p</span><span class="o">)</span> <span class="bp">^</span> <span class="o">(</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">-</span> <span class="n">j</span><span class="o">))</span> <span class="o">:</span> <span class="n">sorry</span>
<span class="c1">-- type mismatch at application</span>
<span class="c1">--   ∑&#39; (H : j ∈ finset.range (n - 1)), ↑((n - 1).choose j) * p ^ j * (1 - p) ^ (n - 1 - j)</span>
<span class="c1">-- term</span>
<span class="c1">--   λ (H : j ∈ finset.range (n - 1)), ↑((n - 1).choose j) * p ^ j * (1 - p) ^ (n - 1 - j)</span>
<span class="c1">-- has type</span>
<span class="c1">--   j ∈ finset.range (n - 1) → nnreal : Type</span>
<span class="c1">-- but is expected to have type</span>
<span class="c1">--   ?m_1 → nnreal : Type ?</span>
<span class="c1">-- state:</span>
<span class="bp">...</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">p</span> <span class="o">:</span> <span class="n">sorry</span>
<span class="kn">end</span>
</code></pre></div>



<a name="207742129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207742129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207742129">(Aug 22 2020 at 21:04)</a>:</h4>
<p>Also, how do I fill that first <code>sorry</code> (the <code>suffices</code> one)?</p>



<a name="207742673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207742673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207742673">(Aug 22 2020 at 21:19)</a>:</h4>
<p>... of course maybe my <code>suffices</code> statement is wrong :-)</p>



<a name="207742833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207742833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207742833">(Aug 22 2020 at 21:24)</a>:</h4>
<p>I don't know much about probability, but your <code>mul_choose</code> is definitely wrong -- if ever you use natural subtraction you can be pretty sure that something is wrong, because natural subtraction is a pathological function.</p>



<a name="207743473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743473">(Aug 22 2020 at 21:48)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> Do you think I should try to reformulate <code>binomial_pmf</code> to not mention <code>n - k</code>?</p>



<a name="207743514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743514">(Aug 22 2020 at 21:48)</a>:</h4>
<p>n-k is fine if you know k&lt;=n. But you don't know this in mul_choose</p>



<a name="207743518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743518">(Aug 22 2020 at 21:49)</a>:</h4>
<p>I mean, you don't know k&gt;=1 so you'll be in trouble with k-1 if k=0</p>



<a name="207743735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743735">(Aug 22 2020 at 21:57)</a>:</h4>
<p>So do I want to just add an <code>(h: k &gt;= 1)</code> or try to build the &gt;=1 into the terms some other way?</p>



<a name="207743737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743737">(Aug 22 2020 at 21:57)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">mul_choose</span> <span class="o">(</span><span class="n">w</span> <span class="n">b</span><span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">w</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">≥</span> <span class="mi">1</span><span class="o">):</span> <span class="n">w</span> <span class="bp">*</span> <span class="o">((</span><span class="n">w</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="n">w</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">w</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(((</span><span class="n">w</span> <span class="bp">+</span> <span class="n">b</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="o">(</span><span class="n">w</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>


<p>getting rid of <code>n</code> doesn't seem to help</p>



<a name="207743776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743776">(Aug 22 2020 at 21:58)</a>:</h4>
<p>(still need the hypothesis)</p>



<a name="207743914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743914">(Aug 22 2020 at 22:03)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">mul_choose</span> <span class="o">(</span><span class="n">w_minus_1</span> <span class="n">b</span><span class="o">:</span> <span class="bp">ℕ</span><span class="o">):</span> <span class="o">(</span><span class="n">w_minus_1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">*</span> <span class="o">((</span><span class="n">w_minus_1</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="o">(</span><span class="n">w_minus_1</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">=</span> <span class="o">(</span><span class="n">w_minus_1</span> <span class="bp">+</span> <span class="n">b</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(((</span><span class="n">w_minus_1</span> <span class="bp">+</span> <span class="n">b</span> <span class="o">)</span><span class="bp">.</span><span class="n">choose</span> <span class="n">w_minus_1</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>


<p>¯\_(ツ)_/¯</p>



<a name="207743966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743966">(Aug 22 2020 at 22:04)</a>:</h4>
<p>All I'm saying was that your lemma as it stood was false because k=0 gave counterexamples. What you should do instead is entirely up to you but for sure you can't use a false lemma.</p>



<a name="207743984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207743984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207743984">(Aug 22 2020 at 22:05)</a>:</h4>
<p>And the reason I took one look at it and suspected it might be false was that it used unsafe natural subtraction, subtracting one from things which hadn't been assumed to be &gt;= 1.</p>



<a name="207744033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207744033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207744033">(Aug 22 2020 at 22:06)</a>:</h4>
<p>Sure that makes sense</p>



<a name="207744337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207744337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207744337">(Aug 22 2020 at 22:16)</a>:</h4>
<p>I think your error is because you're just not using the <code>∑'</code> syntax correctly. I've never used <code>∑'</code> before but you seem to have <code>∑' (k : nat)</code> and <code>∑' k \in (some finset)</code> which doesn't bode well. What is the syntax of <code>∑'</code>?</p>



<a name="207744883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207744883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207744883">(Aug 22 2020 at 22:31)</a>:</h4>
<p>I've used it above in the expectation definition <code>∑' a : α, pr a * f a</code> and I agree that's different from here with the <code>\in</code>.</p>



<a name="207744946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207744946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207744946">(Aug 22 2020 at 22:33)</a>:</h4>
<p>So what I mean is <code>(∑ j in (finset.range (n - 1)), _</code></p>



<a name="207745198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207745198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207745198">(Aug 22 2020 at 22:41)</a>:</h4>
<p>or so I thought from <a href="https://github.com/leanprover-community/mathlib/blob/abe4459/src/algebra/big_operators/basic.lean#L24">here</a> </p>
<div class="codehilite"><pre><span></span><code><span class="bp">*</span> <span class="bp">`</span><span class="err">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="bp">`</span> <span class="n">is</span> <span class="kn">notation</span> <span class="n">for</span> <span class="bp">`</span><span class="n">finset</span><span class="bp">.</span><span class="n">sum</span> <span class="n">s</span> <span class="n">f</span><span class="bp">`</span> <span class="o">(</span><span class="n">assuming</span> <span class="bp">`</span><span class="n">β</span><span class="bp">`</span> <span class="n">is</span> <span class="n">an</span> <span class="bp">`</span><span class="n">add_comm_monoid</span><span class="bp">`</span><span class="o">)</span>
</code></pre></div>


<p>but </p>
<div class="codehilite"><pre><span></span><code><span class="kn">variable</span> <span class="o">(</span><span class="n">k</span><span class="o">:</span> <span class="n">nat</span><span class="o">)</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="err">∑</span> <span class="n">k</span> <span class="k">in</span> <span class="o">((</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="mi">5</span><span class="o">)</span> <span class="err">\</span> <span class="o">{</span><span class="mi">0</span><span class="o">}),</span> <span class="n">k</span><span class="o">)</span>
</code></pre></div>


<p>doesn't even parse</p>



<a name="207745956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207745956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Stanescu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207745956">(Aug 22 2020 at 23:06)</a>:</h4>
<p>This works for me and the result is <code>10</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="err">∑</span> <span class="n">k</span> <span class="k">in</span> <span class="o">((</span><span class="n">finset</span><span class="bp">.</span><span class="n">range</span> <span class="mi">5</span><span class="o">)</span> <span class="err">\</span> <span class="o">{</span><span class="mi">0</span><span class="o">}),</span> <span class="n">k</span><span class="o">)</span> <span class="c1">-- 10</span>
</code></pre></div>



<a name="207745961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207745961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Stanescu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207745961">(Aug 22 2020 at 23:07)</a>:</h4>
<p>Do you have the correct imports?</p>



<a name="207745964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207745964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207745964">(Aug 22 2020 at 23:07)</a>:</h4>
<p>Which imports do you have?</p>



<a name="207746002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207746002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207746002">(Aug 22 2020 at 23:08)</a>:</h4>
<p>Make sure you have</p>
<div class="codehilite"><pre><span></span><code><span class="n">open_locale</span> <span class="n">big_operators</span>
</code></pre></div>


<p>to include the notation.</p>



<a name="207746010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207746010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Stanescu <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207746010">(Aug 22 2020 at 23:08)</a>:</h4>
<p>I have all of these in a file for a different purpose, but you probably don't need the first two:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">algebra</span><span class="bp">.</span><span class="n">big_operators</span>

<span class="n">open_locale</span> <span class="n">big_operators</span>
</code></pre></div>



<a name="207746016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207746016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207746016">(Aug 22 2020 at 23:09)</a>:</h4>
<p>Ah, that's the trick</p>



<a name="207788663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/split_ifs/near/207788663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Iocta <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/split_ifs.html#207788663">(Aug 23 2020 at 19:57)</a>:</h4>
<p>What's the notation for <code>(α × β)</code> but with countable elements? Is that <code>def myprod (t : ℕ → Type u) : Π (n: nat), t n := _</code>?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>