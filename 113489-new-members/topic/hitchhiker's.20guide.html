---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/hitchhiker's.20guide.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html">hitchhiker's guide</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="196701355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196701355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196701355">(May 06 2020 at 21:37)</a>:</h4>
<p>is the palindrome proposition in hitchhiker's guide... wrong? how would it work with even-length palindromes?</p>



<a name="196701402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196701402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196701402">(May 06 2020 at 21:37)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">inductive</span> <span class="n">palindrome</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">nil</span> <span class="o">:</span> <span class="n">palindrome</span> <span class="o">[]</span>
<span class="bp">|</span> <span class="n">single</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">palindrome</span> <span class="o">[</span><span class="n">x</span><span class="o">]</span>
<span class="bp">|</span> <span class="n">sandwich</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">xs</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">hxs</span> <span class="o">:</span> <span class="n">palindrome</span> <span class="n">xs</span><span class="o">)</span> <span class="o">:</span>
<span class="n">palindrome</span> <span class="o">([</span><span class="n">x</span><span class="o">]</span> <span class="bp">++</span> <span class="n">xs</span> <span class="bp">++</span> <span class="o">[</span><span class="n">x</span><span class="o">])</span>
</code></pre></div>



<a name="196701453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196701453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196701453">(May 06 2020 at 21:37)</a>:</h4>
<p>[] has even length</p>



<a name="196701599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196701599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196701599">(May 06 2020 at 21:38)</a>:</h4>
<p>ahhh, i see where i got it wrong now. the <code>sandwich</code> constructor sandwiching a <strong>list</strong></p>



<a name="196701630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196701630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196701630">(May 06 2020 at 21:39)</a>:</h4>
<p>i read it wrongly to be two lists sandwiching an element</p>



<a name="196728093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196728093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jasmin Blanchette <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196728093">(May 07 2020 at 05:18)</a>:</h4>
<p>Kevin, for a mathematician, your mastery of C.S. topics is astonishing.</p>



<a name="196746018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196746018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196746018">(May 07 2020 at 09:28)</a>:</h4>
<p>Once I remember an undergraduate asking me if zero was an even number</p>



<a name="196746043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196746043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196746043">(May 07 2020 at 09:28)</a>:</h4>
<p>The alternative being that the predicate only made sense on positive integers</p>



<a name="196911096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196911096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jasmin Blanchette <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196911096">(May 08 2020 at 15:37)</a>:</h4>
<p>The Ancient Greeks didn't like division by 1, I'm told. They would write things like "if n = 1, then m; otherwise m / n".</p>



<a name="196911997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196911997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Aniruddh Agarwal <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196911997">(May 08 2020 at 15:43)</a>:</h4>
<p>Thereby allowing division by 0? <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="196915441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/196915441" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#196915441">(May 08 2020 at 16:08)</a>:</h4>
<p>Division by what now?</p>



<a name="197091538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197091538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197091538">(May 11 2020 at 01:44)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">action</span> <span class="o">(</span><span class="n">σ</span> <span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">:=</span> <span class="n">σ</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">×</span> <span class="n">σ</span>
<span class="n">def</span> <span class="n">diff_list</span> <span class="o">:</span> <span class="n">list</span> <span class="n">N</span> <span class="bp">→</span> <span class="n">action</span> <span class="n">N</span> <span class="o">(</span><span class="n">list</span> <span class="n">N</span><span class="o">)</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">diff_list</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">]</span> <span class="mi">0</span>
</code></pre></div>


<p>#. why is the body of the first <code>def</code>, erm, kinda weird? it is a function type.<br>
#. <code>diff_list</code> has one argument, why do we call it with 2 (a list, and the initial state)? is this the first argument (\sigma) in <code>action</code>?</p>



<a name="197091659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197091659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197091659">(May 11 2020 at 01:49)</a>:</h4>
<p><code>action</code> is defining a type, which is a function type in this case</p>



<a name="197091662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197091662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197091662">(May 11 2020 at 01:49)</a>:</h4>
<p>the type of <code>action</code> is <code>action : Type -&gt; Type -&gt; Type</code></p>



<a name="197091710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197091710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197091710">(May 11 2020 at 01:50)</a>:</h4>
<p><code>diff_list</code> has one argument, but the result is an <code>action</code>, which is itself a function, expecting an argument of its own (the sigma, as you say)</p>



<a name="197092841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197092841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197092841">(May 11 2020 at 02:21)</a>:</h4>
<p>so the first <code>def</code> is like a typedef in C?</p>



<a name="197092849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197092849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197092849">(May 11 2020 at 02:21)</a>:</h4>
<p>is there a keyword for that? say, <code>alias</code>?</p>



<a name="197097988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197097988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197097988">(May 11 2020 at 04:08)</a>:</h4>
<p><code>def</code> is like <code>typedef</code> indeed. There is no separate keyword, as in DTT the operations of making a type and making a term are the same</p>



<a name="197499440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499440">(May 14 2020 at 02:00)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">action</span><span class="bp">.</span><span class="n">pure</span> <span class="o">{</span><span class="n">σ</span> <span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">action</span> <span class="n">σ</span> <span class="n">α</span>
<span class="n">def</span> <span class="n">action</span><span class="bp">.</span><span class="n">bind</span> <span class="o">{</span><span class="n">σ</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">ma</span> <span class="o">:</span> <span class="n">action</span> <span class="n">σ</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">action</span> <span class="n">σ</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">action</span> <span class="n">σ</span> <span class="n">β</span>

<span class="bp">@</span><span class="o">[</span><span class="kn">instance</span><span class="o">]</span> <span class="n">def</span> <span class="n">action</span><span class="bp">.</span><span class="n">lawful_monad</span> <span class="o">{</span><span class="n">σ</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">:</span>
<span class="n">lawful_monad</span> <span class="o">(</span><span class="n">action</span> <span class="n">σ</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">pure</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">action</span><span class="bp">.</span><span class="n">pure</span> <span class="n">σ</span><span class="o">,</span>
<span class="n">bind</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">action</span><span class="bp">.</span><span class="n">bind</span> <span class="n">σ</span><span class="o">,</span>
<span class="bp">...</span>
</code></pre></div>


<p>how should I read the <code>@action.pure \sigma</code>? action.pure does not take a type, does it?</p>



<a name="197499662"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499662" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499662">(May 14 2020 at 02:06)</a>:</h4>
<p><code>action.pure</code> takes three arguments: <code>σ</code> <code>α</code> and <code>a</code>, but normally the first two are inferred because they are written in <code>{}</code> binders. When you use <code>@action.pure</code> they all become explicit, and so it's expecting three arguments. If you only provide the first, that is, <code>σ</code>, you get a function waiting for the other two arguments</p>



<a name="197499686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499686">(May 14 2020 at 02:07)</a>:</h4>
<p>(and actually, if I recall the definition of <code>action</code> from your last question, there is another argument hidden inside the definition of <code>action</code> itself, so you can actually put four arguments in before you get a value.)</p>



<a name="197499738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499738">(May 14 2020 at 02:08)</a>:</h4>
<p>i see. thank you!</p>



<a name="197499752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499752">(May 14 2020 at 02:08)</a>:</h4>
<p>speaking of my previous questions, it was something like this.</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">diff_list</span> <span class="o">:</span> <span class="n">list</span> <span class="n">N</span> <span class="bp">→</span> <span class="n">action</span> <span class="n">N</span> <span class="o">(</span><span class="n">list</span> <span class="n">N</span><span class="o">)</span>
<span class="bp">...</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="n">diff_list</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">2</span><span class="o">]</span> <span class="mi">0</span>
</code></pre></div>



<a name="197499778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499778">(May 14 2020 at 02:09)</a>:</h4>
<p>which brings me to another question. <code>diff_list [1, 2, 3, 2]</code> returns an <code>action</code>, which is <code>\sigma -&gt; \alpha \times \sigma</code>, which is a function</p>



<a name="197499829"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499829" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499829">(May 14 2020 at 02:10)</a>:</h4>
<p>You should be able to do something similar with <code>pure</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">eval</span> <span class="bp">@</span><span class="n">action</span><span class="bp">.</span><span class="n">pure</span> <span class="n">N</span> <span class="o">(</span><span class="n">list</span> <span class="n">N</span><span class="o">)</span> <span class="o">[</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">,</span><span class="mi">3</span><span class="o">]</span> <span class="mi">0</span>
<span class="c1">-- (0, [1,2,3])</span>
</code></pre></div>


<p>note that I passed 4 arguments to <code>pure</code></p>



<a name="197499838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499838">(May 14 2020 at 02:11)</a>:</h4>
<p>so do i get it right that <code>#eval diff_list [1, 2, 3, 2]</code> won't do much?</p>



<a name="197499846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197499846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197499846">(May 14 2020 at 02:11)</a>:</h4>
<p>it's a curried function, so no, it might do some computation but it's still waiting for an argument</p>



<a name="197500095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197500095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197500095">(May 14 2020 at 02:16)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">diff_list</span> <span class="o">:</span> <span class="n">list</span> <span class="n">N</span> <span class="bp">→</span> <span class="n">action</span> <span class="n">N</span> <span class="o">(</span><span class="n">list</span> <span class="n">N</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">[]</span> <span class="o">:=</span> <span class="n">pure</span> <span class="o">[]</span>
<span class="bp">...</span>
</code></pre></div>


<p>why do i not have to specify <code>action.pure</code>? how does lean know if the <code>pure []</code> is for <code>action</code> and not, say, <code>set</code>? is that because it is matched with the return type?</p>



<a name="197500104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197500104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197500104">(May 14 2020 at 02:17)</a>:</h4>
<p>but which type is right? which declaration takes precedence? the signature, or the code in the body?</p>



<a name="197500653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197500653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197500653">(May 14 2020 at 02:30)</a>:</h4>
<p><code>pure</code> is not actually the same function as <code>action.pure</code>, it is the <code>pure</code> function from the root namespace. This function has a typeclass argument allowing it to work on anything with a monad instance, and your <code>@[instance] def action.lawful_monad </code> registered <code>action.pure</code> as the pure operation of the action monad</p>



<a name="197500677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197500677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197500677">(May 14 2020 at 02:31)</a>:</h4>
<p>It knows to look for the monad instance on <code>action</code> and not <code>set</code> because the expected return type of <code>pure []</code> is <code>action N (list N)</code></p>



<a name="197500861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197500861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197500861">(May 14 2020 at 02:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="284601">Nam</span> <a href="#narrow/stream/113489-new-members/topic/hitchhiker's.20guide/near/197500104">said</a>:</p>
<blockquote>
<p>but which type is right? which declaration takes precedence? the signature, or the code in the body?</p>
</blockquote>
<p>Elaboration in lean proceeds outside-in, from the expected type down to the types of variables. So the signature is always taken verbatim unless it is not provided (and you are required to provide it at the top level of a definition by cases like that one).</p>



<a name="197500928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197500928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197500928">(May 14 2020 at 02:36)</a>:</h4>
<p>If lean didn't know the expected type, it wouldn't be able to figure out what <code>pure []</code> means in this instance</p>



<a name="197500999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197500999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197500999">(May 14 2020 at 02:38)</a>:</h4>
<p>For example,</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">diff_list</span> <span class="o">:</span> <span class="n">list</span> <span class="n">nat</span> <span class="bp">→</span> <span class="n">state</span> <span class="n">nat</span> <span class="o">(</span><span class="n">list</span> <span class="n">nat</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span> <span class="k">let</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">pure</span> <span class="o">[]</span> <span class="k">in</span> <span class="n">x</span>
</code></pre></div>


<p>fails because I haven't said what type <code>x</code> is</p>



<a name="197503720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197503720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Nam <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197503720">(May 14 2020 at 03:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113489-new-members/topic/hitchhiker's.20guide/near/197500999">said</a>:</p>
<blockquote>
<p>For example,</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">diff_list</span> <span class="o">:</span> <span class="n">list</span> <span class="n">nat</span> <span class="bp">→</span> <span class="n">state</span> <span class="n">nat</span> <span class="o">(</span><span class="n">list</span> <span class="n">nat</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">_</span> <span class="o">:=</span> <span class="k">let</span> <span class="n">x</span> <span class="o">:=</span> <span class="n">pure</span> <span class="o">[]</span> <span class="k">in</span> <span class="n">x</span>
</code></pre></div>


<p>fails because I haven't said what type <code>x</code> is</p>
</blockquote>
<p>could you elaborate why it fails? my guess is at the <code>let</code> declaration, <code>x</code> type is not known. but shouldn't the return type be propagated backward because that same <code>x</code> is returned?</p>



<a name="197505734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197505734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197505734">(May 14 2020 at 04:42)</a>:</h4>
<p>When lean elaborates a let expression, it first tries to elaborate the let definition, and then only if that is successful, uses the result in the body. This is done mostly to localize error reporting, but it does prevent it from finding the solution in this case, even though the information is available in principle</p>



<a name="197583418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197583418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jake <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197583418">(May 14 2020 at 16:43)</a>:</h4>
<p>"Dependent types often make deﬁnitions and proofs more diﬀicult". My prior intuition was the opposite, i thought being more precise means the compiler could help you out more, and code generation / simplification is better. Can someone explain what the author means by difficult here?</p>



<a name="197584658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197584658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197584658">(May 14 2020 at 16:52)</a>:</h4>
<p>You can do more stuff. The new stuff is hard.</p>



<a name="197584666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197584666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197584666">(May 14 2020 at 16:53)</a>:</h4>
<p>That's a very brief summary.</p>



<a name="197584722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197584722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197584722">(May 14 2020 at 16:53)</a>:</h4>
<p>For evidence of the pain, search the history of this chat for "motive is not type correct".</p>



<a name="197587172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197587172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197587172">(May 14 2020 at 17:09)</a>:</h4>
<p>I think the author means he's more used to Isabelle.</p>



<a name="197587928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197587928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197587928">(May 14 2020 at 17:14)</a>:</h4>
<p>More dependent types means more arguments to functions across the board, so it's not necessarily the case that code performance improves</p>



<a name="197587965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197587965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197587965">(May 14 2020 at 17:15)</a>:</h4>
<p>Hard to guess what the author had in mind with so little context.</p>



<a name="197587986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197587986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197587986">(May 14 2020 at 17:15)</a>:</h4>
<p>simplification is much harder because of complicated definitional equality problems that can come up at any point</p>



<a name="197588053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197588053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197588053">(May 14 2020 at 17:15)</a>:</h4>
<p>for example, more difficult than what: programming without dependent types, or theorem proving without dependent types?</p>



<a name="197588230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197588230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197588230">(May 14 2020 at 17:17)</a>:</h4>
<p>and there are a number of constructions that would be convenient to do in a proof that are only type correct up to a propositional equality, and these require the insertion of "cast" functions into the term that later obstruct simplification and other kinds of term analysis</p>



<a name="197588296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197588296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197588296">(May 14 2020 at 17:17)</a>:</h4>
<p>that is a slightly less brief summary of "DTT hell"</p>



<a name="197588530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197588530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197588530">(May 14 2020 at 17:19)</a>:</h4>
<p>Dependent types <em>can</em> enhance a programmatic proof with invariants and such without adding any additional overhead, when everything goes well and things fit together nicely. But when things don't work out exactly right, the fallback is much worse than the simply typed scenario</p>



<a name="197588709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197588709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197588709">(May 14 2020 at 17:20)</a>:</h4>
<p>I think Conor McBride has a number of papers on what DTT looks like on a good day</p>



<a name="197667278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197667278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197667278">(May 15 2020 at 09:30)</a>:</h4>
<p>I've changed the sentence to: "Dependent inductive types often cause difficulties when the terms they depend on don't line up nicely.", basically what <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> says.</p>



<a name="197694710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/hitchhiker%27s%20guide/near/197694710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jasmin Blanchette <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/hitchhiker's.20guide.html#197694710">(May 15 2020 at 13:58)</a>:</h4>
<p>And I've edited it further with an example in parentheses (<code>m + n</code> vs. <code>n + m</code>).</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>