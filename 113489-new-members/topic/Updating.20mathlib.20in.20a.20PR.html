---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html">Updating mathlib in a PR</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="272511541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272511541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Monnet <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272511541">(Feb 19 2022 at 11:10)</a>:</h4>
<p>I'm working on a PR, and I want to make use of a recent change to mathlib (the change took place after I created the PR). When I run <code>leanproject up</code> in the project of the PR, it doesn't seem to bring in the change I'm trying to use. Can anyone explain why this is happening and what I can do about it?</p>



<a name="272512884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272512884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272512884">(Feb 19 2022 at 11:37)</a>:</h4>
<p><code>leanproject up</code> updates mathlib if it is a dependency of the current project, so it doesn't work in mathlib itself. <code>git merge master</code> is what you're after - assuming <code>master</code> is up to date</p>



<a name="272513041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272513041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272513041">(Feb 19 2022 at 11:40)</a>:</h4>
<p><code>git fetch; git merge origin/master</code> is a safer bet.</p>



<a name="272513396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272513396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272513396">(Feb 19 2022 at 11:48)</a>:</h4>
<p>And don't forget to run <code>leanproject get-mathlib-cache</code>!</p>



<a name="272513504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272513504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272513504">(Feb 19 2022 at 11:50)</a>:</h4>
<p><code>leanproject get-cache</code> rather, assuming it's on a branch of the <code>mathlib</code> repo</p>



<a name="272514091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272514091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272514091">(Feb 19 2022 at 12:01)</a>:</h4>
<p>Yeah but there won't be a cache</p>



<a name="272514424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272514424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272514424">(Feb 19 2022 at 12:07)</a>:</h4>
<p>So you should always push after a merge so that github can start building a cache!</p>



<a name="272514436"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272514436" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272514436">(Feb 19 2022 at 12:07)</a>:</h4>
<p><code>get-cache --fallback=download-first</code> will try to pick a "close" cache</p>



<a name="272514794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272514794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272514794">(Feb 19 2022 at 12:14)</a>:</h4>
<p>What I usually do, if I want to quickly be able to work after merging master is the following:</p>
<ul>
<li><code>git checkout master</code> and <code>git pull</code>.</li>
<li><code>leanproject get-mathlib cache</code>, so I have master's olean.</li>
<li><code>git checkout mybranch</code> and <code>git merge master</code>.<br>
Now I don't have the oleans for my branch, but usually the changes are small and I can immediately work.</li>
</ul>



<a name="272515241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272515241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272515241">(Feb 19 2022 at 12:23)</a>:</h4>
<p>I usually type <code>get-m</code> rather than <code>get-mathlib-cache</code>; this works. Note that this now works even if you're working on mathlib itself (which Sebastian is, I believe), because <code>get-m</code> defaults to <code>get-c</code> if in mathlib itself (assuming your <code>leanproject</code> is relatively new).</p>



<a name="272516363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272516363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272516363">(Feb 19 2022 at 12:45)</a>:</h4>
<p>Note that <code>get-m</code> doesn't support --rev or --fallback because that doesn't make sense for the intended use of get-mathlib-cache</p>



<a name="272516431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272516431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272516431">(Feb 19 2022 at 12:46)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span>, there's no need to do that - either <code>get-cache --rev origin/master</code> or <code>get-cache --fallback=download-first</code> will have the same effect</p>



<a name="272516449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272516449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272516449">(Feb 19 2022 at 12:47)</a>:</h4>
<p>And that approach avoids you risking losing your work when you checkout, as unlike your approach it doesn't touch any of your files.</p>



<a name="272516459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272516459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272516459">(Feb 19 2022 at 12:47)</a>:</h4>
<p>Ah, nice! Thanks</p>



<a name="272516511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Updating%20mathlib%20in%20a%20PR/near/272516511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Updating.20mathlib.20in.20a.20PR.html#272516511">(Feb 19 2022 at 12:48)</a>:</h4>
<p>(I guess you still need <code>git fetch origin; git merge master</code> before that - but you get to skip the checkout step)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>