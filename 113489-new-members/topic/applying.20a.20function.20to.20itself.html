---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html">applying a function to itself</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="199635704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199635704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199635704">(Jun 03 2020 at 15:37)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">meta</span> <span class="n">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">:=</span>
<span class="n">foo</span> <span class="bp">→</span> <span class="n">foo</span>

<span class="bp">#</span><span class="kn">check</span> <span class="bp">λ</span> <span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">foo</span><span class="o">,</span> <span class="n">f</span> <span class="n">g</span>
</code></pre></div>



<a name="199635714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199635714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199635714">(Jun 03 2020 at 15:37)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">f</span> <span class="n">g</span>
<span class="n">term</span>
  <span class="n">g</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">foo</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="o">[</span><span class="n">foo</span><span class="bp">._</span><span class="n">main</span><span class="o">]</span>
</code></pre></div>



<a name="199635735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199635735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199635735">(Jun 03 2020 at 15:37)</a>:</h4>
<p>how do I make it work?</p>



<a name="199635752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199635752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199635752">(Jun 03 2020 at 15:37)</a>:</h4>
<p>I want to apply a function to itself</p>



<a name="199635786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199635786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199635786">(Jun 03 2020 at 15:37)</a>:</h4>
<p>why does <code>foo</code> have no equational lemma?</p>



<a name="199956257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199956257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199956257">(Jun 06 2020 at 04:52)</a>:</h4>
<p>I am not familiar with <code>meta</code> definitions in Lean, but <code>meta def foo : Type := foo → foo</code> seems to be a hack-y attempt at an untyped identity function.</p>



<a name="199956358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199956358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199956358">(Jun 06 2020 at 04:56)</a>:</h4>
<p>You cannot apply a <em>strictly</em> one argument function to itself, because that necessarily would lead to a type mismatch. That is, you would have <code>α → b</code> and <code>α = α → b</code>, so <code>α</code> would have to be a fix-point <code>((... → b) → b) → b</code>, which is not possible, because <em>terms themselves</em> can't be infinite.</p>



<a name="199956524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199956524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199956524">(Jun 06 2020 at 05:02)</a>:</h4>
<p>You can, however, (kind-of) apply an identify function to itself.</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">id&#39;</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span>
</code></pre></div>


<p><code>id</code> is a function of <em>two</em> arguments, the first of which is implicit, so Lean will try to figure it out for us if it can.</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">check</span> <span class="n">id&#39;</span> <span class="n">id&#39;</span>
</code></pre></div>


<p>Lean will figure out that the type <code>α</code> for the leftmost <code>id'</code> is <code>Π {α : Type*}, α → α</code>. You can make implicit arguments explicit using <code>@</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">check</span> <span class="bp">@</span><span class="n">id&#39;</span> <span class="o">(</span><span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">},</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="bp">@</span><span class="n">id&#39;</span>
</code></pre></div>



<a name="199956539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/199956539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Minicz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#199956539">(Jun 06 2020 at 05:03)</a>:</h4>
<p>Another example of interest:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">variable</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span>

<span class="bp">#</span><span class="kn">check</span> <span class="bp">@</span><span class="n">id&#39;</span> <span class="o">(</span><span class="n">β</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="n">id&#39;</span>
</code></pre></div>



<a name="200420159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420159">(Jun 10 2020 at 14:05)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>



<a name="200420273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420273">(Jun 10 2020 at 14:06)</a>:</h4>
<p>hi</p>



<a name="200420298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420298">(Jun 10 2020 at 14:06)</a>:</h4>
<p>it's not going to work</p>



<a name="200420356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420356">(Jun 10 2020 at 14:06)</a>:</h4>
<p>why not</p>



<a name="200420376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420376">(Jun 10 2020 at 14:06)</a>:</h4>
<p>because this would make the typechecker diverge</p>



<a name="200420407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420407">(Jun 10 2020 at 14:07)</a>:</h4>
<p>what does diverge mean?</p>



<a name="200420418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420418">(Jun 10 2020 at 14:07)</a>:</h4>
<p>not stop</p>



<a name="200420475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420475">(Jun 10 2020 at 14:07)</a>:</h4>
<p>recursive meta definitions use macros to indicate the recursion, they aren't defeq to their unfolding</p>



<a name="200420565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420565">(Jun 10 2020 at 14:08)</a>:</h4>
<p>but can we prove <code>foo = [foo._main]</code>?</p>



<a name="200420575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420575">(Jun 10 2020 at 14:08)</a>:</h4>
<p>I'm not even sure the concept makes sense since the kernel never sees meta defs</p>



<a name="200420637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420637">(Jun 10 2020 at 14:09)</a>:</h4>
<p>what does that even mean? In meta land everything is provable</p>



<a name="200420667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420667">(Jun 10 2020 at 14:09)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">meta</span> <span class="n">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="kt">Type</span> <span class="o">:=</span>
<span class="n">foo</span> <span class="bp">→</span> <span class="n">foo</span>

<span class="bp">#</span><span class="kn">print</span> <span class="kn">prefix</span> <span class="n">foo</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">foo : Type</span>
<span class="cm">foo._main : Type</span>
<span class="cm">-/</span>

<span class="bp">#</span><span class="kn">print</span> <span class="n">foo</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">meta def foo : Type :=</span>
<span class="cm">foo._main</span>
<span class="cm">-/</span>

<span class="bp">#</span><span class="kn">print</span> <span class="n">foo</span><span class="bp">._</span><span class="n">main</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">meta def foo._main : Type :=</span>
<span class="cm">id_rhs Type ([foo._main] → [foo._main])</span>
<span class="cm">-/</span>
</code></pre></div>



<a name="200420771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420771">(Jun 10 2020 at 14:10)</a>:</h4>
<p>what is the <code>[]</code> in <code>[foo._main]</code>?</p>



<a name="200420785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420785">(Jun 10 2020 at 14:10)</a>:</h4>
<p>a macro</p>



<a name="200420838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420838">(Jun 10 2020 at 14:10)</a>:</h4>
<p>I just thought it meant "you dunfolded too much"</p>



<a name="200420866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420866">(Jun 10 2020 at 14:11)</a>:</h4>
<p>how is <code>[]</code> defined?</p>



<a name="200420870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420870">(Jun 10 2020 at 14:11)</a>:</h4>
<p>You are thinking of the projection macro</p>



<a name="200420890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420890">(Jun 10 2020 at 14:11)</a>:</h4>
<p>It is <code>expr.macro</code></p>



<a name="200420924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200420924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200420924">(Jun 10 2020 at 14:11)</a>:</h4>
<p>it is a separate constructor from <code>pi</code>, <code>lam</code>, <code>var</code>,<code>mvar</code> and everything else</p>



<a name="200421040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421040">(Jun 10 2020 at 14:12)</a>:</h4>
<p>Here's a projection macro:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">print</span> <span class="n">and</span><span class="bp">.</span><span class="n">left</span>
<span class="c1">-- @[reducible]</span>
<span class="c1">-- def and.left : ∀ {a b : Prop}, a ∧ b → a :=</span>
<span class="c1">-- λ (a b : Prop) (c : a ∧ b), [and.left c]</span>
</code></pre></div>



<a name="200421046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421046">(Jun 10 2020 at 14:12)</a>:</h4>
<p>how do I produce a term of type <code>[\a]</code>?</p>



<a name="200421050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421050">(Jun 10 2020 at 14:12)</a>:</h4>
<p>You can't</p>



<a name="200421078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421078">(Jun 10 2020 at 14:12)</a>:</h4>
<p>seriously, this is super annoying</p>



<a name="200421124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421124">(Jun 10 2020 at 14:12)</a>:</h4>
<p>alright sorry</p>



<a name="200421125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421125">(Jun 10 2020 at 14:12)</a>:</h4>
<p>but <code>expr.macro</code> uses an opaque type <code>macro_def</code> that lean code can't create</p>



<a name="200421140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421140">(Jun 10 2020 at 14:13)</a>:</h4>
<p>no, not you, macros are annoying</p>



<a name="200421168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421168">(Jun 10 2020 at 14:13)</a>:</h4>
<p>can I use unchecked_cast?</p>



<a name="200421190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421190">(Jun 10 2020 at 14:13)</a>:</h4>
<p>I think that will work</p>



<a name="200421192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421192">(Jun 10 2020 at 14:13)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">check</span> <span class="bp">λ</span> <span class="n">f</span> <span class="o">:</span> <span class="n">foo</span><span class="o">,</span> <span class="n">f</span> <span class="err">$</span> <span class="n">unchecked_cast</span> <span class="n">f</span>
</code></pre></div>



<a name="200421214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421214">(Jun 10 2020 at 14:13)</a>:</h4>
<p>but would it "work" like I want it to?</p>



<a name="200421296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421296">(Jun 10 2020 at 14:14)</a>:</h4>
<p>hm, best think of a better test</p>



<a name="200421320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421320" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421320">(Jun 10 2020 at 14:14)</a>:</h4>
<p>maybe use the Y combinator so that it halts</p>



<a name="200421494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421494">(Jun 10 2020 at 14:15)</a>:</h4>
<p>You can at least use <code>expr.macro_def_name</code> to see what kind of macro you are looking at</p>



<a name="200421671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421671">(Jun 10 2020 at 14:17)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">variable</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">Y</span> <span class="o">:</span> <span class="o">(</span><span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">|</span> <span class="n">f</span> <span class="o">:=</span> <span class="n">f</span> <span class="o">(</span><span class="n">Y</span> <span class="n">f</span><span class="o">)</span>

<span class="bp">#</span><span class="kn">check</span> <span class="bp">λ</span> <span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">,</span> <span class="o">(</span><span class="n">rfl</span> <span class="o">:</span> <span class="n">Y</span> <span class="n">f</span> <span class="bp">=</span> <span class="n">f</span> <span class="o">(</span><span class="n">Y</span> <span class="n">f</span><span class="o">))</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">invalid type ascription, term has type</span>
<span class="cm">  ?m_2 = ?m_2</span>
<span class="cm">but is expected to have type</span>
<span class="cm">  Y f = f (Y f)</span>
<span class="cm">-/</span>
</code></pre></div>



<a name="200421675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200421675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200421675">(Jun 10 2020 at 14:17)</a>:</h4>
<p>oh no</p>



<a name="200422140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422140">(Jun 10 2020 at 14:21)</a>:</h4>
<p>is it true that |A| = |A^A| iff |A| = 1?</p>



<a name="200422168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422168">(Jun 10 2020 at 14:21)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">print</span> <span class="n">has_add</span><span class="bp">.</span><span class="n">add</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">@[pattern, reducible]</span>
<span class="cm">def has_add.add : Π {α : Type u} [c : has_add α], α → α → α :=</span>
<span class="cm">λ (α : Type u) [c : has_add α], [has_add.add c]</span>
<span class="cm">-/</span>
</code></pre></div>


<p>Is that also a macro?</p>



<a name="200422226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422226">(Jun 10 2020 at 14:21)</a>:</h4>
<p>If |A|&gt;1 then |A^A|&gt;=|2^A|&gt;|A|</p>



<a name="200422351"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422351" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422351">(Jun 10 2020 at 14:22)</a>:</h4>
<p>so we have proved that <code>foo \equiv unit</code></p>



<a name="200422419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422419">(Jun 10 2020 at 14:23)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">meta</span> <span class="n">def</span> <span class="n">cantor</span> <span class="o">:=</span> <span class="n">cantor</span> <span class="bp">→</span> <span class="kt">Prop</span>
</code></pre></div>



<a name="200422440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422440">(Jun 10 2020 at 14:23)</a>:</h4>
<p>yay I broke Lean</p>



<a name="200422467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422467">(Jun 10 2020 at 14:23)</a>:</h4>
<p>You only meta-broke it -- that's allowed</p>



<a name="200422546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422546">(Jun 10 2020 at 14:24)</a>:</h4>
<p>Reid proved false the other day in meta land -- it wasn't hard</p>



<a name="200422835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422835" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422835">(Jun 10 2020 at 14:26)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> how about this as a test: can you prove <code>false</code> using <code>unchecked_cast</code> and <code>cantor</code>?</p>



<a name="200422861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422861">(Jun 10 2020 at 14:26)</a>:</h4>
<p>you can prove false using just <code>unchecked_cast</code></p>



<a name="200422875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422875">(Jun 10 2020 at 14:26)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">meta</span> <span class="n">def</span> <span class="n">cantor</span> <span class="o">:=</span> <span class="n">cantor</span> <span class="bp">→</span> <span class="kt">Prop</span>

<span class="n">meta</span> <span class="kn">example</span> <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span>
<span class="k">let</span> <span class="n">R</span> <span class="o">:</span> <span class="n">cantor</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">A</span><span class="o">,</span> <span class="bp">¬</span> <span class="o">(</span><span class="bp">@</span><span class="n">unchecked_cast</span> <span class="bp">_</span> <span class="n">cantor</span> <span class="n">A</span><span class="o">)</span> <span class="n">A</span> <span class="k">in</span>
<span class="n">sorry</span>
</code></pre></div>



<a name="200422880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422880">(Jun 10 2020 at 14:26)</a>:</h4>
<p>i.e. something like this</p>



<a name="200422902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422902">(Jun 10 2020 at 14:27)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">meta</span> <span class="kn">example</span> <span class="o">:</span> <span class="n">false</span> <span class="o">:=</span> <span class="n">unchecked_cast</span> <span class="n">trivial</span>
</code></pre></div>



<a name="200422927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422927">(Jun 10 2020 at 14:27)</a>:</h4>
<p>i.e. can you translate cantor's paradox</p>



<a name="200422941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200422941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200422941">(Jun 10 2020 at 14:27)</a>:</h4>
<p>yes</p>



<a name="200423103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423103">(Jun 10 2020 at 14:28)</a>:</h4>
<p>you need to use <code>unchecked_cast</code> to prove the side condition on <code>cantor_injective</code> though</p>



<a name="200423119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423119">(Jun 10 2020 at 14:28)</a>:</h4>
<p>so it's not very impressive</p>



<a name="200423407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423407">(Jun 10 2020 at 14:30)</a>:</h4>
<p>Without the theorem that says that <code>cantor = (cantor → Prop)</code>, you won't get anywhere in the proof</p>



<a name="200423425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423425">(Jun 10 2020 at 14:30)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="n">set</span> <span class="n">cantor</span><span class="o">,</span>
<span class="n">H</span> <span class="o">:</span> <span class="n">unchecked_cast</span> <span class="n">A</span> <span class="bp">=</span> <span class="n">unchecked_cast</span> <span class="n">B</span>
<span class="err">⊢</span> <span class="n">A</span> <span class="bp">=</span> <span class="n">B</span>
</code></pre></div>



<a name="200423433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423433">(Jun 10 2020 at 14:30)</a>:</h4>
<p>you mean this is <code>unchecked_cast H</code>?</p>



<a name="200423539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423539">(Jun 10 2020 at 14:31)</a>:</h4>
<p>It's <code>unchecked_cast</code> of anything you want</p>



<a name="200423563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423563">(Jun 10 2020 at 14:31)</a>:</h4>
<p>I think you are ascribing more meaning to this than is warranted</p>



<a name="200423584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423584">(Jun 10 2020 at 14:31)</a>:</h4>
<p>do we even "know" that <code>cantor = (cantor \to Prop)</code>?</p>



<a name="200423658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423658">(Jun 10 2020 at 14:32)</a>:</h4>
<p>oh right, in meta land everything is true</p>



<a name="200423696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423696">(Jun 10 2020 at 14:32)</a>:</h4>
<p>In meta land, it's not a complete free for all, there is a semantics but it is more like the semantics of Haskell</p>



<a name="200423732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423732">(Jun 10 2020 at 14:32)</a>:</h4>
<p>however <code>unchecked_cast</code> breaks even that</p>



<a name="200423770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423770">(Jun 10 2020 at 14:32)</a>:</h4>
<p>oh no this doesn't terminate:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="n">reduce</span> <span class="bp">@</span><span class="n">unchecked_cast</span> <span class="n">true</span> <span class="n">false</span> <span class="n">trivial</span>
</code></pre></div>



<a name="200423812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423812">(Jun 10 2020 at 14:33)</a>:</h4>
<p><code>unchecked_cast</code> is implemented as a loop IIRC</p>



<a name="200423845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423845">(Jun 10 2020 at 14:33)</a>:</h4>
<p>oh nvm</p>



<a name="200423864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423864">(Jun 10 2020 at 14:33)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">eval</span> <span class="bp">@</span><span class="n">unchecked_cast</span> <span class="bp">ℕ</span> <span class="bp">ℤ</span> <span class="mi">3</span> <span class="c1">-- 3</span>
</code></pre></div>



<a name="200423918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200423918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200423918">(Jun 10 2020 at 14:33)</a>:</h4>
<p>try it for larger numbers :)</p>



<a name="200424006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200424006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200424006">(Jun 10 2020 at 14:34)</a>:</h4>
<p>guess the outputs:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">eval</span> <span class="bp">@</span><span class="n">unchecked_cast</span> <span class="n">empty</span> <span class="bp">ℕ</span> <span class="o">(</span><span class="n">unchecked_cast</span> <span class="n">tt</span><span class="o">)</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="bp">@</span><span class="n">unchecked_cast</span> <span class="n">empty</span> <span class="bp">ℕ</span> <span class="o">(</span><span class="n">unchecked_cast</span> <span class="n">ff</span><span class="o">)</span>
</code></pre></div>



<a name="200424327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200424327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200424327">(Jun 10 2020 at 14:36)</a>:</h4>
<p>One of these is not like the others:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">range</span> <span class="mi">34</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span> <span class="bp">@</span><span class="n">unchecked_cast</span> <span class="bp">ℕ</span> <span class="bp">ℤ</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span>
<span class="c1">-- [0, 1, 3, 7, 15, 31, 63, 127, 255, 511, 1023, 2047, 4095, 8191, 16383,</span>
<span class="c1">--  32767, 65535, 131071, 262143, 524287, 1048575, 2097151, 4194303, 8388607,</span>
<span class="c1">--  16777215, 33554431, 67108863, 134217727, 268435455, 536870911, 1073741823,</span>
<span class="c1">--  -1, 4294967295, 8589934591]</span>
</code></pre></div>



<a name="200424676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200424676" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200424676">(Jun 10 2020 at 14:38)</a>:</h4>
<p>Oh haha the reason <code>#reduce @unchecked_cast true false trivial</code> doesn't terminate is for the very silly reason that strings are involved</p>



<a name="200424908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200424908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200424908">(Jun 10 2020 at 14:40)</a>:</h4>
<p>this works fine</p>
<div class="codehilite"><pre><span></span><code><span class="n">meta</span> <span class="n">def</span> <span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">unchecked_cast&#39;</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">u</span><span class="o">}</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span> <span class="o">:=</span>
<span class="n">cast</span> <span class="o">(</span><span class="n">undefined_core</span> <span class="s2">&quot;&quot;</span><span class="o">)</span>

<span class="bp">#</span><span class="n">reduce</span> <span class="bp">@</span><span class="n">unchecked_cast&#39;</span> <span class="n">true</span> <span class="n">false</span> <span class="n">trivial</span>
<span class="c1">-- eq.rec true.intro (undefined_core {data := list.nil char})</span>
</code></pre></div>



<a name="200425013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200425013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200425013">(Jun 10 2020 at 14:40)</a>:</h4>
<p>why does it being <code>"undefined"</code> make it not terminate?</p>



<a name="200425022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200425022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200425022">(Jun 10 2020 at 14:41)</a>:</h4>
<p>It reminds me that we have something for <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span>  who is already hunting down ideas for Lean 3.17.0: fix <a href="https://github.com/leanprover-community/doc-gen/blob/master/src/export_json.lean#L284-L287">https://github.com/leanprover-community/doc-gen/blob/master/src/export_json.lean#L284-L287</a>. I had to use the same <code>itersplit</code> trick in the sphere eversion infrastructure.</p>



<a name="200425154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200425154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200425154">(Jun 10 2020 at 14:41)</a>:</h4>
<p>it terminates but only after about O(size of unicode * length of string * very large #reduce constant) steps</p>



<a name="200425230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200425230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200425230">(Jun 10 2020 at 14:42)</a>:</h4>
<p>I'm not sure if these two are related, but this applies for both of them: please file a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> at the lean bug tracker!</p>



<a name="200425332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200425332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200425332">(Jun 10 2020 at 14:42)</a>:</h4>
<p>wait, is there a lean feature suggestion in this thread?</p>



<a name="200425339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200425339" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200425339">(Jun 10 2020 at 14:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113489-new-members/topic/applying.20a.20function.20to.20itself/near/200424327">said</a>:</p>
<blockquote>
<p>One of these is not like the others:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">eval</span> <span class="o">(</span><span class="n">list</span><span class="bp">.</span><span class="n">range</span> <span class="mi">34</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span><span class="o">,</span> <span class="bp">@</span><span class="n">unchecked_cast</span> <span class="bp">ℕ</span> <span class="bp">ℤ</span> <span class="o">(</span><span class="mi">2</span><span class="bp">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span>
<span class="c1">-- [0, 1, 3, 7, 15, 31, 63, 127, 255, 511, 1023, 2047, 4095, 8191, 16383,</span>
<span class="c1">--  32767, 65535, 131071, 262143, 524287, 1048575, 2097151, 4194303, 8388607,</span>
<span class="c1">--  16777215, 33554431, 67108863, 134217727, 268435455, 536870911, 1073741823,</span>
<span class="c1">--  -1, 4294967295, 8589934591]</span>
</code></pre></div>


</blockquote>
<p><a href="https://oeis.org/search?q=0%2C+1%2C+3%2C+7%2C+15%2C+31%2C+63%2C+127%2C+255%2C+511%2C+1023%2C+2047%2C+4095%2C+8191%2C+16383%2C+32767%2C+65535%2C+131071%2C+262143%2C+524287%2C+1048575%2C+2097151%2C+4194303%2C+8388607%2C++16777215%2C+33554431%2C+67108863%2C+134217727%2C+268435455%2C+536870911%2C+1073741823%2C++-1%2C+4294967295%2C+8589934591&amp;sort=&amp;language=english&amp;go=Search">https://oeis.org/search?q=0%2C+1%2C+3%2C+7%2C+15%2C+31%2C+63%2C+127%2C+255%2C+511%2C+1023%2C+2047%2C+4095%2C+8191%2C+16383%2C+32767%2C+65535%2C+131071%2C+262143%2C+524287%2C+1048575%2C+2097151%2C+4194303%2C+8388607%2C++16777215%2C+33554431%2C+67108863%2C+134217727%2C+268435455%2C+536870911%2C+1073741823%2C++-1%2C+4294967295%2C+8589934591&amp;sort=&amp;language=english&amp;go=Search</a> <br>
:(</p>



<a name="200426327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200426327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200426327">(Jun 10 2020 at 14:49)</a>:</h4>
<p>When I've got my number theorists hat on and I find a non-OEIS sequence I add it! But I'm not sure they'll like this one...</p>



<a name="200426465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/applying%20a%20function%20to%20itself/near/200426465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/applying.20a.20function.20to.20itself.html#200426465">(Jun 10 2020 at 14:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110064">Kenny Lau</span> <a href="#narrow/stream/113489-new-members/topic/applying.20a.20function.20to.20itself/near/200424006">said</a>:</p>
<blockquote>
<p>guess the outputs:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">eval</span> <span class="bp">@</span><span class="n">unchecked_cast</span> <span class="n">empty</span> <span class="bp">ℕ</span> <span class="o">(</span><span class="n">unchecked_cast</span> <span class="n">tt</span><span class="o">)</span>
<span class="bp">#</span><span class="kn">eval</span> <span class="bp">@</span><span class="n">unchecked_cast</span> <span class="n">empty</span> <span class="bp">ℕ</span> <span class="o">(</span><span class="n">unchecked_cast</span> <span class="n">ff</span><span class="o">)</span>
</code></pre></div>


</blockquote>
<p><a href="http://bash.org/?10958">http://bash.org/?10958</a> (aah, the old days)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>