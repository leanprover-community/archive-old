---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html">Subtracting a partial sum from a sum</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="228124091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228124091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228124091">(Feb 28 2021 at 11:18)</a>:</h4>
<p>I have this:</p>
<div class="codehilite" data-code-language="1"><pre><span></span><code>k: ℕ+
z: ℂ
ε: ℝ
H: ε &gt; 0
⊢ ∃ (i : ℕ), ∀ (j : ℕ), i ≤ j → abs' (∑ (x : ℕ) in range j, abs (z ^ (x * ↑k)) / ↑(x * ↑k)! - ∑ (x : ℕ) in range i, abs (z ^ (x * ↑k)) / ↑(x * ↑k)!) &lt; ε
</code></pre></div>
<p>How do I rewrite this goal in the form <code>∑ (x : ℕ) in range (j - i), abs (z ^ (x * ↑(k + i))) / ↑(x * ↑(k + i))!</code>?</p>



<a name="228124764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228124764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228124764">(Feb 28 2021 at 11:31)</a>:</h4>
<p>I suspect there should be a lemma somewhere in the library for f: ℕ→ℂ<br>
<code>∀ (i : ℕ), ∀ (j : ℕ),  i ≤ j → ∑ (x : ℕ) in range j, f x - ∑ (x : ℕ) in range i, f x = ∑ (x : ℕ) in range (j - i), f (x + i)</code><br>
Actually, there should be something more general than this where f: ℕ→{some arbitrary structure with addition}.</p>



<a name="228124917"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228124917" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228124917">(Feb 28 2021 at 11:34)</a>:</h4>
<p>That theorem is false?</p>



<a name="228124967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228124967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228124967">(Feb 28 2021 at 11:35)</a>:</h4>
<p>Or rather the lemma needs a <code>+ i</code> in it</p>



<a name="228124991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228124991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228124991">(Feb 28 2021 at 11:35)</a>:</h4>
<p>Oh, I forgot i ≤ j. Did I forget anything else?<br>
Copy pasted, and did not edit properly.</p>



<a name="228125043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125043">(Feb 28 2021 at 11:36)</a>:</h4>
<p>Not the original goal, the proposed lemma is not correct</p>



<a name="228125059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125059">(Feb 28 2021 at 11:36)</a>:</h4>
<p>There should be something along the lines <code>range (a + b) = range a ++ map (+a) (range b)</code> which can be transformed into something like your lemma</p>



<a name="228125088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125088">(Feb 28 2021 at 11:37)</a>:</h4>
<p>Fixed?</p>



<a name="228125090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125090">(Feb 28 2021 at 11:37)</a>:</h4>
<p><span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="228125158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125158">(Feb 28 2021 at 11:38)</a>:</h4>
<p>I'll try to prove my lemma myself while waiting for feedback. It seems like something someone else would have already done though.</p>



<a name="228125252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125252">(Feb 28 2021 at 11:40)</a>:</h4>
<p>This should be in <code>algebra.big_operators.basic</code> but it's not</p>



<a name="228125269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125269">(Feb 28 2021 at 11:41)</a>:</h4>
<p>but it should be a one liner</p>



<a name="228125271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125271">(Feb 28 2021 at 11:41)</a>:</h4>
<p>Can you give a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a> complete with imports?</p>



<a name="228125523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125523">(Feb 28 2021 at 11:46)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.complex.basic</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">big_operators</span> <span class="n">nat</span>

<span class="kn">open</span> <span class="n">finset</span>

<span class="kd">lemma</span> <span class="n">subtract_subsum_from_sum</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">):</span>
 <span class="n">i</span> <span class="bp">≤</span> <span class="n">j</span> <span class="bp">→</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">j</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span>
       <span class="bp">-</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span>
       <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="n">i</span><span class="o">),</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">i</span><span class="o">):=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="228125553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125553">(Feb 28 2021 at 11:47)</a>:</h4>
<p>It probably is easier to prove if you replace <code>j</code> with <code>i+k</code> and eliminate the hypothesis</p>



<a name="228125568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228125568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228125568">(Feb 28 2021 at 11:47)</a>:</h4>
<p>Although that's not to say that what you have isn't also a useful lemma</p>



<a name="228126838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228126838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228126838">(Feb 28 2021 at 12:11)</a>:</h4>
<p>Do we at least have a lemma like this in the library?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.complex.basic</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">big_operators</span> <span class="n">nat</span>

<span class="kn">open</span> <span class="n">finset</span>

<span class="kd">lemma</span> <span class="n">take_first_from_sum</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">):</span>
 <span class="mi">1</span> <span class="bp">≤</span> <span class="n">j</span> <span class="bp">→</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">j</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span>
       <span class="bp">-</span> <span class="n">f</span> <span class="mi">0</span>
       <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">),</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">):=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span>
<span class="kd">end</span>
</code></pre></div>



<a name="228127066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127066">(Feb 28 2021 at 12:15)</a>:</h4>
<p>That's <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sum_range_succ'">docs#finset.sum_range_succ'</a> except that you made it harder by using the poorly-behaved subtraction function on the naturals. Why not let k be j-1 and then you can avoid subtraction on naturals and dump your hypothesis</p>



<a name="228127249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127249">(Feb 28 2021 at 12:19)</a>:</h4>
<p>I don't know how to do that; I am still a beginner.</p>



<a name="228127405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127405">(Feb 28 2021 at 12:22)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.complex.basic</span>

<span class="n">open_locale</span> <span class="n">classical</span> <span class="n">big_operators</span> <span class="n">nat</span>

<span class="kn">open</span> <span class="n">finset</span>

<span class="kd">lemma</span> <span class="n">take_first_from_sum</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">):</span>
 <span class="mi">1</span> <span class="bp">≤</span> <span class="n">j</span> <span class="bp">→</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">j</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span>
       <span class="bp">-</span> <span class="n">f</span> <span class="mi">0</span>
       <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">),</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">):=</span>
<span class="kd">begin</span>
  <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">set</span> <span class="n">k</span> <span class="o">:=</span> <span class="n">j</span> <span class="bp">-</span> <span class="mi">1</span> <span class="k">with</span> <span class="n">hk</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hj</span> <span class="o">:</span> <span class="n">j</span> <span class="bp">=</span> <span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">hk</span><span class="o">,</span> <span class="n">nat.sub_add_cancel</span> <span class="n">h</span><span class="o">],</span>
  <span class="n">rw</span> <span class="n">hj</span><span class="o">,</span> <span class="c1">-- no more j</span>
  <span class="n">rw</span> <span class="n">sum_range_succ'</span><span class="o">,</span>
  <span class="n">simp</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="228127632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127632">(Feb 28 2021 at 12:26)</a>:</h4>
<p>Nice, Thanks! I think that can be used with induction to get</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">subtract_subsum_from_sum</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℂ</span><span class="o">):</span>
 <span class="n">i</span> <span class="bp">≤</span> <span class="n">j</span> <span class="bp">→</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">j</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span>
       <span class="bp">-</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span>
       <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">j</span> <span class="bp">-</span> <span class="n">i</span><span class="o">),</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">i</span><span class="o">):=</span>
</code></pre></div>
<p>Having this in Mathlib is worthwhile, IMO.</p>



<a name="228127654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127654">(Feb 28 2021 at 12:26)</a>:</h4>
<p>In general subtraction on the complexes is fine, but subtraction on the naturals involves a lot of faffing around because 2 - 3 = 0 (it has to be a natural because the type of subtraction is X -&gt; X -&gt; X) and a lot of the lemmas about subtraction come with extra hypotheses and are a pain to use. In your original question you have a hypothesis i &lt;= j and are then using j - i: the proposal is that instead you define k := j - i and then kill j completely and use i + k instead. It will make things much smoother.</p>



<a name="228127761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127761">(Feb 28 2021 at 12:28)</a>:</h4>
<p>Interesting. I will play around with it.</p>



<a name="228127817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127817">(Feb 28 2021 at 12:29)</a>:</h4>
<p>Mathematically the statements are equivalent, but in practice the i + k version is better because it doesn't have the auxiliary hypothesis so is easier to use directly in things like rewrites.</p>



<a name="228127909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127909">(Feb 28 2021 at 12:30)</a>:</h4>
<p>The i + k version will be in mathlib already, or perhaps a combination of two lemmas: we have <code>Ico a b</code>, the naturals a&lt;=n&lt;b, and a bunch of lemmas about summing over that finite set.</p>



<a name="228127935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127935">(Feb 28 2021 at 12:31)</a>:</h4>
<p>What's the unprimed version, <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sum_range_succ">docs#finset.sum_range_succ</a>?</p>



<a name="228127952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228127952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228127952">(Feb 28 2021 at 12:32)</a>:</h4>
<p>Ah right - removing <code>f 0</code> vs <code>f n</code></p>



<a name="228128007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228128007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228128007">(Feb 28 2021 at 12:32)</a>:</h4>
<p>A <code>sum_range_add</code> lemma would be a nice first contribution to mathlib</p>



<a name="228129512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228129512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228129512">(Feb 28 2021 at 13:03)</a>:</h4>
<p>I suppose you mean adding</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">sum_range_add</span> <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">n</span><span class="o">))</span> <span class="o">:=</span>
</code></pre></div>
<p>to mathlib/src/algebra/big_operators/basic.lean? I will see what I can do, I hope someone else adds it if I don't.</p>



<a name="228129621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228129621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228129621">(Feb 28 2021 at 13:05)</a>:</h4>
<p>Maybe I should play the natural number game first.</p>



<a name="228148540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148540">(Feb 28 2021 at 18:46)</a>:</h4>
<p>I proved it, but it is a monstrosity... far from a one-liner.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">sum_range_add</span> <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">n</span><span class="o">))</span> <span class="o">:=</span>
  <span class="kd">begin</span>
    <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">d</span> <span class="n">hd</span><span class="o">,</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">hsucc</span> <span class="o">:</span> <span class="n">d.succ</span> <span class="bp">+</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">d</span> <span class="bp">+</span> <span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">nat.succ_add</span> <span class="n">d</span> <span class="n">m</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hsucc</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">(</span><span class="n">sum_range_succ</span> <span class="n">f</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="n">m</span><span class="o">)),</span>
    <span class="k">have</span> <span class="n">hsucc2</span> <span class="o">:</span> <span class="n">d.succ</span> <span class="bp">=</span> <span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">,</span>
    <span class="n">refl</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hsucc2</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">(</span><span class="n">sum_range_succ</span> <span class="n">f</span> <span class="n">d</span><span class="o">),</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">hd</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h3</span> <span class="o">:</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span>  <span class="n">m</span>     <span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">+</span> <span class="n">f</span> <span class="n">d</span> <span class="bp">=</span>
              <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">m</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span>  <span class="n">d</span>     <span class="o">),</span>
    <span class="n">rw</span> <span class="n">sum_range_succ'</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">d</span><span class="o">)),</span>
    <span class="n">simp</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h4</span> <span class="o">:</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">d</span><span class="o">),</span>
    <span class="n">intros</span><span class="o">,</span><span class="n">exact</span> <span class="o">(</span><span class="n">nat.succ_add_eq_succ_add</span> <span class="n">x</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h5</span> <span class="o">:</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span>
            <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">d</span><span class="o">),</span>
    <span class="n">refine</span> <span class="n">congr</span> <span class="n">rfl</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">funext</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">intros</span> <span class="n">x</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">congr_arg</span> <span class="n">f</span> <span class="o">(</span><span class="n">h4</span> <span class="n">x</span><span class="o">),</span>
    <span class="n">rw</span> <span class="n">h5</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h6</span> <span class="o">:</span> <span class="n">f</span> <span class="n">d</span> <span class="bp">+</span> <span class="o">(</span><span class="n">range</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span> <span class="bp">=</span> <span class="o">(</span><span class="n">range</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span> <span class="bp">+</span> <span class="n">f</span> <span class="n">d</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">add_comm</span> <span class="o">(</span><span class="n">f</span> <span class="n">d</span><span class="o">)</span> <span class="o">((</span><span class="n">range</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span><span class="o">),</span>
    <span class="n">rw</span> <span class="n">h6</span><span class="o">,</span>
    <span class="k">have</span> <span class="n">h7</span> <span class="o">:</span> <span class="n">f</span> <span class="n">d</span> <span class="bp">+</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span>
            <span class="bp">=</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span> <span class="bp">+</span> <span class="n">f</span> <span class="n">d</span><span class="o">,</span>
            <span class="n">exact</span> <span class="n">add_comm</span> <span class="o">(</span><span class="n">f</span> <span class="n">d</span><span class="o">)</span> <span class="o">(</span><span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))),</span>
    <span class="k">have</span> <span class="n">h8</span> <span class="o">:</span> <span class="o">(</span><span class="n">range</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span> <span class="bp">+</span> <span class="n">f</span> <span class="n">d</span> <span class="bp">+</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))</span>
            <span class="bp">=</span> <span class="o">(</span><span class="n">range</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span> <span class="bp">+</span> <span class="o">(</span><span class="n">f</span> <span class="n">d</span> <span class="bp">+</span> <span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))),</span>
    <span class="n">exact</span> <span class="n">add_assoc</span> <span class="o">((</span><span class="n">range</span> <span class="n">d</span><span class="o">)</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span><span class="o">)</span> <span class="o">(</span><span class="n">f</span> <span class="n">d</span><span class="o">)</span> <span class="o">(</span><span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">))),</span>
    <span class="n">rw</span> <span class="n">h8</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h7</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">h3</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">add_left_comm</span> <span class="o">(</span><span class="n">f</span> <span class="o">(</span><span class="n">d</span> <span class="bp">+</span> <span class="n">m</span><span class="o">))</span> <span class="o">(</span><span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">d</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="bp">∑</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">d</span><span class="o">)),</span>
    <span class="n">rw</span> <span class="n">sum_range_succ</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">a</span> <span class="bp">+</span> <span class="n">d</span><span class="o">))</span> <span class="n">m</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">add_comm</span> <span class="n">d</span> <span class="n">m</span><span class="o">,</span>
  <span class="kd">end</span>
</code></pre></div>



<a name="228148783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148783">(Feb 28 2021 at 18:50)</a>:</h4>
<p>Presumably we should have something like an inclusion/exclusion lemma for finest.sum</p>



<a name="228148788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148788">(Feb 28 2021 at 18:50)</a>:</h4>
<p>Have a look at <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sum_range_succ'/src">src#finset.sum_range_succ'</a> for some inspiration on how to shorten that. I'd expect you you want to use <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.range_add">docs#finset.range_add</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.sum_union">docs#finset.sum_union</a> or something like that. If those lemmas don't exist, then probably you want to write those too.</p>



<a name="228148894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148894">(Feb 28 2021 at 18:52)</a>:</h4>
<p>Why isn't <code>finset.sum_union</code> called <code>finset.sum_disjoint_union</code>?</p>



<a name="228148906"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148906" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148906">(Feb 28 2021 at 18:52)</a>:</h4>
<p>Because the expression it applies to is <code>finset.sum (union a b)</code></p>



<a name="228148910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148910">(Feb 28 2021 at 18:52)</a>:</h4>
<p><code>disjoint</code> is just the condition necessary for it to be true, it's not part of the goal state</p>



<a name="228148953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148953">(Feb 28 2021 at 18:53)</a>:</h4>
<p>Ok, but you you might want to know that the sum over a union in general is the sum of the individual components minus the sum over the intersection.</p>



<a name="228148963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148963">(Feb 28 2021 at 18:53)</a>:</h4>
<p>And THAT would be called sum_union</p>



<a name="228148983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228148983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228148983">(Feb 28 2021 at 18:53)</a>:</h4>
<p>Good point - I guess when someone adds that lemma it should be renamed <code>sum_union_of_disjoint</code> or similar</p>



<a name="228149032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149032">(Feb 28 2021 at 18:54)</a>:</h4>
<p>Which would be proved trivially from the lemma you suggest</p>



<a name="228149058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149058">(Feb 28 2021 at 18:54)</a>:</h4>
<p>That's the exclusion/inclusion thing I was referring too</p>



<a name="228149084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149084">(Feb 28 2021 at 18:55)</a>:</h4>
<p>The lemma that's already there should be enough for this thread though</p>



<a name="228149099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149099">(Feb 28 2021 at 18:55)</a>:</h4>
<p>Oh sure</p>



<a name="228149207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149207">(Feb 28 2021 at 18:56)</a>:</h4>
<p>A simpler induction proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">sum_range_add</span> <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">n</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">m</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nat.add_succ</span><span class="o">,</span> <span class="n">finset.sum_range_succ</span><span class="o">,</span> <span class="n">hm</span><span class="o">,</span> <span class="n">finset.sum_range_succ</span><span class="o">,</span>
    <span class="n">add_left_comm</span><span class="o">,</span> <span class="n">add_comm</span> <span class="n">m</span> <span class="n">n</span><span class="o">]</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="228149324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149324">(Feb 28 2021 at 18:59)</a>:</h4>
<p>Could <span class="user-mention" data-user-id="308899">@Yakov Pechersky</span> 's proof be added to Mathlib, please?</p>



<a name="228149336"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149336" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149336">(Feb 28 2021 at 18:59)</a>:</h4>
<p>imo it should probably be generalized</p>



<a name="228149571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149571">(Feb 28 2021 at 19:03)</a>:</h4>
<p>I suppose, so long as this result is accessible. It is quite useful for showing infinite sums are Cauchy. What generalization do you propose?</p>



<a name="228149701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228149701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228149701">(Feb 28 2021 at 19:05)</a>:</h4>
<p>I'd probably have the conclusion be <code>n + x</code> not <code>x + n</code>, so that <code>n</code> is added on the right uniformly through the lemma</p>



<a name="228150342"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228150342" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228150342">(Feb 28 2021 at 19:14)</a>:</h4>
<p>That does make it shorter.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">sum_range_add</span> <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">x</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">m</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nat.add_succ</span><span class="o">,</span> <span class="n">finset.sum_range_succ</span><span class="o">,</span> <span class="n">hm</span><span class="o">,</span> <span class="n">finset.sum_range_succ</span><span class="o">,</span>
    <span class="n">add_left_comm</span><span class="o">]</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="228150718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228150718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228150718">(Feb 28 2021 at 19:20)</a>:</h4>
<p>Should I make a pull request for this?</p>



<a name="228151582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228151582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228151582">(Feb 28 2021 at 19:37)</a>:</h4>
<p>Made one. <a href="https://github.com/leanprover-community/mathlib/pull/6482">https://github.com/leanprover-community/mathlib/pull/6482</a></p>



<a name="228152362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228152362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228152362">(Feb 28 2021 at 19:51)</a>:</h4>
<p>Stubbing out the actual sublemma:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">finset.range_add</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">finset.range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">)</span> <span class="bp">=</span> <span class="n">finset.range</span> <span class="n">n</span> <span class="bp">∪</span> <span class="o">(</span><span class="n">finset.range</span> <span class="n">m</span><span class="o">)</span><span class="bp">.</span><span class="n">image</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">m</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">nat.add_succ</span><span class="o">,</span> <span class="n">finset.range_succ</span><span class="o">,</span> <span class="n">hm</span><span class="o">]</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">sum_range_add</span> <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">finset.range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">x</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">finset.range_add</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">finset.sum_union</span> <span class="n">_</span> <span class="n">using</span> <span class="mi">1</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">finset.sum_image</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="n">finset.disjoint_iff_ne.mpr</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">and_imp</span><span class="o">,</span> <span class="n">finset.mem_image</span><span class="o">,</span> <span class="n">ne.def</span><span class="o">,</span> <span class="n">forall_apply_eq_imp_iff₂</span><span class="o">,</span>
               <span class="n">finset.mem_range</span><span class="o">,</span> <span class="n">exists_imp_distrib</span><span class="o">],</span>
    <span class="n">intros</span> <span class="n">x</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">ne_of_lt</span> <span class="o">(</span><span class="n">nat.lt_add_right</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">hx</span><span class="o">)</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="228152419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228152419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228152419">(Feb 28 2021 at 19:52)</a>:</h4>
<p>Of course, it makes the latter proof look more complicated. There's probably some golfing possible.</p>



<a name="228152750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228152750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228152750">(Feb 28 2021 at 19:58)</a>:</h4>
<p>I now have this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">prod_range_add</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∏</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">(</span><span class="bp">∏</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">∏</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">x</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">m</span> <span class="k">with</span> <span class="n">m</span> <span class="n">hm</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">nat.add_succ</span><span class="o">,</span> <span class="n">finset.prod_range_succ</span><span class="o">,</span> <span class="n">hm</span><span class="o">,</span> <span class="n">finset.prod_range_succ</span><span class="o">,</span> <span class="n">mul_left_comm</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">]</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="228153206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228153206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228153206">(Feb 28 2021 at 20:04)</a>:</h4>
<p>And this seems to work, though I was just guessing.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">sum_range_add</span> <span class="o">{</span><span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">m</span><span class="o">),</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span>
  <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="bp">∑</span> <span class="n">x</span> <span class="k">in</span> <span class="n">range</span> <span class="n">m</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="n">x</span><span class="o">))</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">prod_range_add</span> <span class="o">(</span><span class="n">multiplicative</span> <span class="n">β</span><span class="o">)</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span>
<span class="kn">attribute</span> <span class="o">[</span><span class="n">to_additive</span><span class="o">]</span> <span class="n">prod_range_add</span>
</code></pre></div>



<a name="228154084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154084">(Feb 28 2021 at 20:19)</a>:</h4>
<p>I put these 2 in a pull request: <a href="https://github.com/leanprover-community/mathlib/pull/6483">https://github.com/leanprover-community/mathlib/pull/6483</a></p>



<a name="228154332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154332">(Feb 28 2021 at 20:23)</a>:</h4>
<p><span class="user-mention" data-user-id="385848">@Mark Gerads</span> I mentioned this briefly when I closed the previous PR, but I probably wasn't clear. Our CI scripts will only run on PRs made from branches in the main mathlib repo, not forks. Can you push your work to a new branch in the mathlib repo and open a PR from there?</p>
<p>(We set things up like this because the CI scripts upload files containing compiled versions of branch heads to an Azure server for use by <code>leanproject</code>.)</p>



<a name="228154485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154485">(Feb 28 2021 at 20:26)</a>:</h4>
<p>Hmmm. I have not used git this way before. Is there an example?<br>
I will try to figure it out.</p>



<a name="228154549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154549">(Feb 28 2021 at 20:27)</a>:</h4>
<p>There are some instructions (and even a tutorial video) on our community site <a href="https://leanprover-community.github.io/contribute/index.html">here</a>.</p>



<a name="228154579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154579">(Feb 28 2021 at 20:28)</a>:</h4>
<p>But feel free to ask for help here as well!</p>



<a name="228154703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154703">(Feb 28 2021 at 20:30)</a>:</h4>
<p><code>git remote set-url origin &lt;the url you have now but with leanprover-community instead of your name&gt;</code> is all you need to do</p>



<a name="228154750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154750">(Feb 28 2021 at 20:31)</a>:</h4>
<p>Right, that will make the <code>origin</code> remote (which presumably currently points to your fork) point to <code>leanprover-community/mathlib</code>.</p>



<a name="228154893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154893">(Feb 28 2021 at 20:33)</a>:</h4>
<p>If I do a <code>git push</code>, won't it go directly to master without a pull request though?</p>



<a name="228154959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mark Gerads <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154959">(Feb 28 2021 at 20:34)</a>:</h4>
<p>I'll just follow the instruction at the link.</p>



<a name="228154961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228154961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228154961">(Feb 28 2021 at 20:34)</a>:</h4>
<p>try <code>git push --set-upstream origin your_branch_name</code></p>



<a name="228155212"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228155212" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228155212">(Feb 28 2021 at 20:38)</a>:</h4>
<p>Ah you're right, the way you made the original PR was also not the way it's normally done</p>



<a name="228155230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Subtracting%20a%20partial%20sum%20from%20a%20sum/near/228155230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Subtracting.20a.20partial.20sum.20from.20a.20sum.html#228155230">(Feb 28 2021 at 20:38)</a>:</h4>
<p>I'd assumed you'd made a branch in your own local repo, not just used master</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>