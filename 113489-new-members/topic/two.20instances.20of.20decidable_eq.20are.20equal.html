---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html">two instances of decidable_eq are equal</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="201516567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201516567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201516567">(Jun 21 2020 at 04:42)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">h1</span> <span class="bp">=</span> <span class="n">h2</span> <span class="o">:=</span> <span class="n">sorry</span>
</code></pre></div>



<a name="201516572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201516572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201516572">(Jun 21 2020 at 04:42)</a>:</h4>
<p><code>rfl</code> doesn't work here, and this is causing issues where two terms that are equal except for the <code>decidable_eq</code> terms cannot be unified (<a href="https://en.wikipedia.org/wiki/XY_problem">#xy</a>)</p>



<a name="201516635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201516635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201516635">(Jun 21 2020 at 04:44)</a>:</h4>
<p>obviously I can prove it like this:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">h1</span> <span class="bp">=</span> <span class="n">h2</span> <span class="o">:=</span>
<span class="n">funext</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">funext</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">y</span><span class="o">,</span> <span class="k">by</span> <span class="n">cases</span> <span class="n">h1</span> <span class="n">x</span> <span class="n">y</span><span class="bp">;</span> <span class="n">cases</span> <span class="n">h2</span> <span class="n">x</span> <span class="n">y</span><span class="bp">;</span> <span class="n">cc</span>
</code></pre></div>


<p>but this doesn't solve the unification issue</p>



<a name="201516695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201516695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201516695">(Jun 21 2020 at 04:47)</a>:</h4>
<p>I guess another solution is to just remove <code>decidable_eq</code> from everything and use <code>open_locale classical</code></p>



<a name="201516698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201516698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201516698">(Jun 21 2020 at 04:47)</a>:</h4>
<p>but the problem is that I'm in a file where this hasn't been used</p>



<a name="201516742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201516742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201516742">(Jun 21 2020 at 04:48)</a>:</h4>
<p>so using classical for new definitions only push the problem back one level at a time</p>



<a name="201517095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517095">(Jun 21 2020 at 05:01)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">constant</span> <span class="n">foo</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span><span class="bp">*</span><span class="o">},</span> <span class="n">decidable_eq</span> <span class="n">α</span> <span class="bp">→</span> <span class="bp">ℕ</span>

<span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">h1</span> <span class="bp">=</span> <span class="n">h2</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">congr</span> <span class="c1">-- fails</span>
<span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">foo</span> <span class="n">h1</span> <span class="bp">=</span> <span class="n">foo</span> <span class="n">h2</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">congr</span> <span class="c1">-- works</span>
</code></pre></div>



<a name="201517097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517097">(Jun 21 2020 at 05:01)</a>:</h4>
<p>I don't understand this</p>



<a name="201517173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517173">(Jun 21 2020 at 05:03)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">h1</span> <span class="bp">=</span> <span class="n">h2</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">congr</span> <span class="c1">--fails</span>
<span class="kn">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">id</span> <span class="n">h1</span> <span class="bp">=</span> <span class="n">id</span> <span class="n">h2</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">congr</span> <span class="c1">--works</span>
</code></pre></div>



<a name="201517174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517174">(Jun 21 2020 at 05:03)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> what's going on here?</p>



<a name="201517302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517302">(Jun 21 2020 at 05:07)</a>:</h4>
<p>I think <code>decidable_eq A</code> should be a <code>subsingleton</code></p>



<a name="201517346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517346">(Jun 21 2020 at 05:08)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">theorem</span> <span class="n">test2</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">),</span> <span class="n">id</span> <span class="n">h1</span> <span class="bp">=</span> <span class="n">id</span> <span class="n">h2</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">),</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="n">a_1</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">),</span>
     <span class="o">((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">),</span> <span class="n">eq</span><span class="bp">.</span><span class="n">refl</span> <span class="o">(</span><span class="n">id</span> <span class="n">a</span><span class="o">))</span> <span class="n">a</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="o">(</span><span class="n">congr</span> <span class="o">(</span><span class="n">eq</span><span class="bp">.</span><span class="n">refl</span> <span class="n">id</span><span class="o">)</span> <span class="o">(</span><span class="n">subsingleton</span><span class="bp">.</span><span class="n">elim</span> <span class="n">a</span> <span class="n">a_1</span><span class="o">)))</span>
    <span class="n">h1</span>
    <span class="n">h2</span>
</code></pre></div>



<a name="201517360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517360">(Jun 21 2020 at 05:08)</a>:</h4>
<p>This works:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">variable</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span>
<span class="bp">#</span><span class="kn">check</span> <span class="o">(</span><span class="k">by</span> <span class="n">apply_instance</span> <span class="o">:</span> <span class="n">subsingleton</span> <span class="o">(</span><span class="n">decidable_eq</span> <span class="n">A</span><span class="o">))</span>
</code></pre></div>



<a name="201517362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517362">(Jun 21 2020 at 05:08)</a>:</h4>
<p>yeah but for my usecase it just times out</p>



<a name="201517371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517371">(Jun 21 2020 at 05:09)</a>:</h4>
<p>Apparently <code>congr</code> doesn't think to apply <code>subsingleton.elim</code> immediately, but it does apply it on subgoals</p>



<a name="201517372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517372">(Jun 21 2020 at 05:09)</a>:</h4>
<p>and <code>convert</code> fails:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">theorem</span> <span class="n">test2</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="n">Sort</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">h1</span> <span class="n">h2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">id</span> <span class="n">h1</span> <span class="bp">=</span> <span class="n">id</span> <span class="n">h2</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">convert</span> <span class="n">rfl</span> <span class="c1">--fails</span>
</code></pre></div>



<a name="201517374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517374">(Jun 21 2020 at 05:09)</a>:</h4>
<p>hence why <code>id x = id y</code> works</p>



<a name="201517417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517417">(Jun 21 2020 at 05:10)</a>:</h4>
<p>I'm confused what the goal is here now</p>



<a name="201517421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517421">(Jun 21 2020 at 05:10)</a>:</h4>
<p>two instances of <code>decidable_eq</code> are indeed equal, and the typeclass system knows this</p>



<a name="201517424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517424">(Jun 21 2020 at 05:10)</a>:</h4>
<p>so where is the problem?</p>



<a name="201517492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517492">(Jun 21 2020 at 05:12)</a>:</h4>
<p>I can't produce an MWE yet, but it times out</p>



<a name="201517663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/two%20instances%20of%20decidable_eq%20are%20equal/near/201517663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/two.20instances.20of.20decidable_eq.20are.20equal.html#201517663">(Jun 21 2020 at 05:18)</a>:</h4>
<p>ok I found a workaround</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>