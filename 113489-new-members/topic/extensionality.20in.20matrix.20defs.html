---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html">extensionality in matrix defs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="200506889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200506889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200506889">(Jun 11 2020 at 05:26)</a>:</h4>
<p>I'm trying to show simple examples of matrix proofs. If the definition of a matrix is a <code>m -&gt; n -&gt; k</code>, then why does the first proof not typecheck? I understand why the second one (specialized form of the #data/matrix proof) works.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">matrix</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span>

<span class="c1">-- Multiplication of a matrix by a real scalar, doesn&#39;t work</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="err">•</span> <span class="n">A</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">∀</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">s</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span> <span class="n">j</span><span class="o">))</span> <span class="o">:=</span>
<span class="n">sorry</span>
<span class="c1">-- type expected at</span>
<span class="c1">--  s * A i j</span>
<span class="c1">-- term has type</span>
<span class="c1">--  ℝ</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span><span class="o">)</span>

<span class="c1">-- works</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">j</span> <span class="o">:</span> <span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">:</span>
        <span class="o">(</span><span class="n">s</span> <span class="err">•</span> <span class="n">A</span><span class="o">)</span> <span class="n">i</span> <span class="n">j</span>  <span class="bp">=</span> <span class="n">s</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">matrix</span><span class="bp">.</span><span class="n">smul_val</span> <span class="n">s</span> <span class="n">A</span> <span class="n">i</span> <span class="n">j</span>
</code></pre></div>



<a name="200507190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507190">(Jun 11 2020 at 05:34)</a>:</h4>
<p>You need to use <code>λ</code>, not <code>∀</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">matrix</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="err">•</span> <span class="n">A</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">s</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span> <span class="n">j</span><span class="o">))</span> <span class="o">:=</span>
<span class="n">sorry</span>
</code></pre></div>



<a name="200507213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507213">(Jun 11 2020 at 05:35)</a>:</h4>
<p>Totally. I should sleep more, confusing one triangle looking symbol with another.</p>



<a name="200507282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507282">(Jun 11 2020 at 05:37)</a>:</h4>
<p>However,</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">check</span> <span class="bp">@</span><span class="n">matrix</span><span class="bp">.</span><span class="n">smul_val</span>
<span class="c1">-- matrix.smul_val :</span>
<span class="c1">--   ∀ {m n : Type u_1} [_inst_2 : fintype m] [_inst_3 : fintype n] {α : Type u_2} [_inst_5 : semiring α] (a : α)</span>
<span class="c1">--   (A : matrix m n α) (i : m) (j : n), (a • A) i j = a * A i j</span>
</code></pre></div>



<a name="200507337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507337">(Jun 11 2020 at 05:38)</a>:</h4>
<p>Which means I can't just supply <code>matrix.smul_val s A</code> since it needs some <code>i j</code>s explicitly</p>



<a name="200507512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507512">(Jun 11 2020 at 05:44)</a>:</h4>
<p>And simp can't solve it either. Gotta supply some <code>funext</code>.</p>



<a name="200507636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507636">(Jun 11 2020 at 05:46)</a>:</h4>
<p><code>by congr</code> will solve it. Here's a more explicit term proof:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">real</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">matrix</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">}</span>

<span class="c1">-- Multiplication of a matrix by a real scalar, doesn&#39;t work</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="err">•</span> <span class="n">A</span> <span class="bp">=</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">s</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span> <span class="n">j</span><span class="o">))</span> <span class="o">:=</span>
<span class="n">congr_arg</span> <span class="o">((</span><span class="err">•</span><span class="o">)</span> <span class="n">s</span><span class="o">)</span> <span class="n">rfl</span>
</code></pre></div>



<a name="200507728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507728">(Jun 11 2020 at 05:49)</a>:</h4>
<p><code>congr</code> is not something I'm very familiar with, the tutorials didn't really cover it in depth. Any good docs on it? Mouse-over for it gives no info either. <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#congr">https://leanprover-community.github.io/mathlib_docs/tactics.html#congr</a> doesn't mention <code>congr_arg</code> directly, <code>solve_by_elim</code> does though.</p>



<a name="200507873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507873">(Jun 11 2020 at 05:53)</a>:</h4>
<p>Is it more idiomatic to use <code>congr_arg</code> or <code>funext</code>, like in:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="err">•</span> <span class="n">A</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">s</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="o">{</span> <span class="n">funext</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">exact</span> <span class="n">matrix</span><span class="bp">.</span><span class="n">smul_val</span> <span class="n">s</span> <span class="n">A</span> <span class="n">i</span> <span class="n">j</span> <span class="o">}</span>
</code></pre></div>



<a name="200507927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200507927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200507927">(Jun 11 2020 at 05:54)</a>:</h4>
<p><code>congr</code> stands for congruence in the sense of <a href="https://en.wikipedia.org/wiki/Congruence_relation">congruence relation</a>. Now that I look at the docs, I'm not so sure about the tactic, but lemmas starting with <code>congr</code> are frequently useful when you have a function applied to both sides of an equality.</p>



<a name="200508049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200508049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200508049">(Jun 11 2020 at 05:57)</a>:</h4>
<p>I'm not sure what's more idiomatic. Maybe this?</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">A</span> <span class="o">:</span> <span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="n">n</span><span class="o">)</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">:</span> <span class="n">s</span> <span class="err">•</span> <span class="n">A</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">s</span> <span class="bp">*</span> <span class="o">(</span><span class="n">A</span> <span class="n">i</span> <span class="n">j</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="o">{</span> <span class="n">funext</span> <span class="n">i</span> <span class="n">j</span><span class="o">,</span> <span class="n">refl</span> <span class="o">}</span>
</code></pre></div>



<a name="200508054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200508054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200508054">(Jun 11 2020 at 05:57)</a>:</h4>
<p>Your statement that we're applying a function on both sides implies the fact that <code>\all (t : R), s  • t = s * t</code>. Does <code>rfl</code> also utilize that?</p>



<a name="200508526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200508526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200508526">(Jun 11 2020 at 06:07)</a>:</h4>
<p><code>rfl</code> is a term that proves an equality by asserting that the two sides are definitionally equal. <code>refl</code> is the tactic version of that. </p>
<p>The goal that <code>refl</code> closes in this case is: <code>(s • A) i j = s * A i j</code></p>
<p>To see that this is a definitional equality, you can look at how <a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.has_scalar/src">src#matrix.has_scalar</a> is defined. Well, it directs you to <a href="https://leanprover-community.github.io/mathlib_docs/find/pi.has_scalar/src">src#pi.has_scalar</a>, which is <code>λ s x, λ i, s • (x i)</code>. Here, <code>•</code> is the scalar multiplication of <code>ℝ</code>, which is definitionally the same as the ordinary multiplication <code>*</code>.</p>



<a name="200508615"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200508615" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200508615">(Jun 11 2020 at 06:09)</a>:</h4>
<p>Sorry... it's late, so I'm probably not explaining this very well.</p>



<a name="200508822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200508822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200508822">(Jun 11 2020 at 06:14)</a>:</h4>
<p>It's a great explanation, thanks for the insight about the underlying <code>pi.has_scalar</code> definition. It's impressive how far down the <code>rfl</code> term goes without needing additional help. So in this example, recognizing that scalar multiplication <code>((•) s)</code>  on the underlying field is just that field's multiplication.</p>



<a name="200509152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/extensionality%20in%20matrix%20defs/near/200509152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/extensionality.20in.20matrix.20defs.html#200509152">(Jun 11 2020 at 06:23)</a>:</h4>
<p><code>rfl</code> can be impressive, but since it can force Lean to unfold lots and lots, it's sometimes better to use lemmas instead. I found the discussion in <a href="#narrow/stream/113489-new-members/topic/zero_max.20a.20rfl.20lemma/near/178820379">this thread</a> enlightening.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>