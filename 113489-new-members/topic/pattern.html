---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/pattern.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html">pattern</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="198069890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198069890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198069890">(May 19 2020 at 14:02)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">universe</span> <span class="n">u</span>

<span class="kn">inductive</span> <span class="n">free_magma</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span>
<span class="bp">|</span> <span class="n">of</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">free_magma</span>
<span class="bp">|</span> <span class="n">mul</span> <span class="o">:</span> <span class="n">free_magma</span> <span class="bp">→</span> <span class="n">free_magma</span> <span class="bp">→</span> <span class="n">free_magma</span>

<span class="kn">instance</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">:</span> <span class="n">has_mul</span> <span class="o">(</span><span class="n">free_magma</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">⟨</span><span class="n">free_magma</span><span class="bp">.</span><span class="n">mul</span><span class="bp">⟩</span>

<span class="n">attribute</span> <span class="o">[</span><span class="n">pattern</span><span class="o">]</span> <span class="n">free_magma</span><span class="bp">.</span><span class="n">mul</span>

<span class="n">def</span> <span class="n">test</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">:</span> <span class="n">free_magma</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">unit</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">free_magma</span><span class="bp">.</span><span class="n">of</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span> <span class="o">()</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">)</span> <span class="o">:=</span> <span class="o">()</span> <span class="c1">-- invalid pattern, must be an application, constant, variable, type ascription, aliasing pattern or inaccessible term</span>

<span class="n">def</span> <span class="n">test&#39;</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="n">unit</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="o">:=</span> <span class="o">()</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="o">()</span>
</code></pre></div>



<a name="198069930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198069930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198069930">(May 19 2020 at 14:02)</a>:</h4>
<p>how do I make lean recognize <code>x * y</code> as a pattern?</p>



<a name="198070053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198070053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198070053">(May 19 2020 at 14:03)</a>:</h4>
<p>I never really understood why <code>(n + 1)</code> works with nat.</p>



<a name="198070264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198070264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198070264">(May 19 2020 at 14:04)</a>:</h4>
<p>I thought the way you are doing it was supposed to work.</p>



<a name="198070526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198070526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198070526">(May 19 2020 at 14:06)</a>:</h4>
<p>I think <code>add</code> is marked as the pattern for <code>nat</code>, but it's <code>succ</code> which is being picked up. Have I misremembered? I could never see the logic.</p>



<a name="198070788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198070788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198070788">(May 19 2020 at 14:08)</a>:</h4>
<p>Oh hmm, now I'm not sure.</p>



<a name="198070948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198070948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198070948">(May 19 2020 at 14:09)</a>:</h4>
<p>The algorithm must be something like: if Lean wants a pattern but it sees an application of something that is not a constructor, unfold the definition of that thing. Then <code>pattern</code> must control this unfolding somehow but I don't know exactly how that works.</p>



<a name="198071010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071010">(May 19 2020 at 14:10)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">attribute</span> <span class="o">[</span><span class="n">pattern</span><span class="o">]</span> <span class="n">has_mul</span><span class="bp">.</span><span class="n">mul</span>
</code></pre></div>


<p>works</p>



<a name="198071181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071181">(May 19 2020 at 14:10)</a>:</h4>
<p>but wouldn't this make every other multiplication a pattern?</p>



<a name="198071193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071193">(May 19 2020 at 14:11)</a>:</h4>
<p>is this a good attribute?</p>



<a name="198071374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071374">(May 19 2020 at 14:12)</a>:</h4>
<p>I'm not at lean right now. Is <code>has_add.add</code> a pattern? You can check with #print</p>



<a name="198071481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071481">(May 19 2020 at 14:12)</a>:</h4>
<p>yes it is</p>



<a name="198071554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071554">(May 19 2020 at 14:13)</a>:</h4>
<p>Well this attribute is clearly not causing too much harm</p>



<a name="198071771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071771">(May 19 2020 at 14:14)</a>:</h4>
<p>Why not make a new branch of mathlib, add the attribute to <code>*</code> in logic.basic, push and see if CI compiles mathlib</p>



<a name="198071810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071810">(May 19 2020 at 14:15)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean/blob/master/library/init/core.lean#L400">https://github.com/leanprover-community/lean/blob/master/library/init/core.lean#L400</a></p>



<a name="198071839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198071839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198071839">(May 19 2020 at 14:15)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">attribute</span> <span class="o">[</span><span class="n">pattern</span><span class="o">]</span> <span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="n">has_one</span><span class="bp">.</span><span class="n">one</span> <span class="n">bit0</span> <span class="n">bit1</span> <span class="n">has_add</span><span class="bp">.</span><span class="n">add</span> <span class="n">has_neg</span><span class="bp">.</span><span class="n">neg</span>
</code></pre></div>



<a name="198072082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/pattern/near/198072082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/pattern.html#198072082">(May 19 2020 at 14:17)</a>:</h4>
<p>I would guess nothing should change, since it should be impossible to use <code>*</code> in a pattern currently and therefore there must not be any such usages.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>