---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/index.html">new members</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html">Can't display a number whose type is wrapped in a structure</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="310860855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310860855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310860855">(Nov 18 2022 at 16:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure/near/310650069">said</a>:</p>
<blockquote>
<p>This feels like an <a href="https://en.wikipedia.org/wiki/XY_problem">#xy</a> problem</p>
</blockquote>
<p>What do you think my X is?</p>



<a name="310860943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310860943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310860943">(Nov 18 2022 at 16:31)</a>:</h4>
<p>Or maybe I should say, what makes you think what I'm asking about isn't my X?  Isn't it reasonable to want to display things?</p>



<a name="310861156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310861156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310861156">(Nov 18 2022 at 16:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="127136">Alex J. Best</span> <a href="#narrow/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure/near/310650163">said</a>:</p>
<blockquote>
<p>What do you mean by instance of wrap (instance is a keyword) are you varying wrapN or the class?</p>
</blockquote>
<p>I mean different elements of <code>wrap</code> in which <code>t</code> is different.</p>



<a name="310862913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310862913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310862913">(Nov 18 2022 at 16:40)</a>:</h4>
<p>I have no idea what your X is, but I'm very skeptical that <code>structure wrap := (t : Type)</code> is something you want to go anywhere near</p>



<a name="310862979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310862979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310862979">(Nov 18 2022 at 16:41)</a>:</h4>
<p>Well, we have newtypes like that in mathlib in several places.</p>



<a name="310863000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310863000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310863000">(Nov 18 2022 at 16:41)</a>:</h4>
<p>Do we? Can you give an example?</p>



<a name="310863031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310863031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310863031">(Nov 18 2022 at 16:41)</a>:</h4>
<p>Category theory is maybe the only place I can think of</p>



<a name="310863044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310863044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310863044">(Nov 18 2022 at 16:41)</a>:</h4>
<p>But usually they are very much on a one-off basis, and so reimplementing a couple of typeclasses is not a problem.</p>



<a name="310863477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310863477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310863477">(Nov 18 2022 at 16:43)</a>:</h4>
<p>For example, we have something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">real</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">cauchy</span> <span class="o">:</span> <span class="bp">@</span><span class="n">cau_seq.completion.Cauchy</span> <span class="n">ℚ</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">abs</span> <span class="n">_</span><span class="o">)</span>
</code></pre></div>



<a name="310863583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310863583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310863583">(Nov 18 2022 at 16:44)</a>:</h4>
<p>Which is a similar pattern.</p>



<a name="310863660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310863660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310863660">(Nov 18 2022 at 16:44)</a>:</h4>
<p>Johan, I think you're misreading <code>structure wrap := (t : Type)</code> for <code>structure wrap := (val : some_type)</code> where <code>some_type : Type</code></p>



<a name="310863848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310863848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310863848">(Nov 18 2022 at 16:45)</a>:</h4>
<p>Fair enough.</p>



<a name="310900399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310900399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310900399">(Nov 18 2022 at 18:58)</a>:</h4>
<p>Well, the actual example has more fields of course:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">group</span> <span class="o">:=</span>
  <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span>
  <span class="o">(</span><span class="n">op</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">→</span> <span class="n">t</span> <span class="bp">→</span> <span class="n">t</span><span class="o">)</span>
  <span class="c1">-- etc.</span>
</code></pre></div>



<a name="310900943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310900943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310900943">(Nov 18 2022 at 19:01)</a>:</h4>
<p>You could probably <code>@[derive has_repr]</code>    and save a few characters</p>



<a name="310901007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310901007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310901007">(Nov 18 2022 at 19:01)</a>:</h4>
<p>(In the Nat case, that is)</p>



<a name="310901305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310901305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310901305">(Nov 18 2022 at 19:03)</a>:</h4>
<p>What behaviour do you expect from eval in the group case?</p>



<a name="310901818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310901818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310901818">(Nov 18 2022 at 19:05)</a>:</h4>
<p><code>group</code> is the analogue of the general <code>wrap</code>.  I would only want to display elements of particular groups, like a <code>groupN</code>.</p>



<a name="310902374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310902374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310902374">(Nov 18 2022 at 19:09)</a>:</h4>
<p>Where do I put <code>@[derive has_repr]</code>?</p>



<a name="310903650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310903650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310903650">(Nov 18 2022 at 19:17)</a>:</h4>
<p>hmmm <code>derive</code> doesn't quite work. sorry!</p>



<a name="310903768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310903768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310903768">(Nov 18 2022 at 19:18)</a>:</h4>
<p>wasn't the solution already shown?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_repr</span> <span class="n">wrapN.t</span> <span class="o">:=</span> <span class="n">nat.has_repr</span>
</code></pre></div>



<a name="310903811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310903811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310903811">(Nov 18 2022 at 19:18)</a>:</h4>
<p>yeah that works</p>



<a name="310904912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310904912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310904912">(Nov 18 2022 at 19:24)</a>:</h4>
<p>you can also do</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_repr</span> <span class="n">wrapN.t</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">dunfold</span> <span class="n">wrapN</span><span class="bp">;</span> <span class="n">apply_instance</span>
</code></pre></div>
<p>if you don't know the instance name</p>



<a name="310936978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310936978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310936978">(Nov 18 2022 at 22:53)</a>:</h4>
<p>Okay, this works for ℕ, but not for ℝ.  When I try it with ℝ I get</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">kernel</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">type</span> <span class="n">check</span> <span class="n">declaration</span> <span class="bp">'</span><span class="n">t.has_repr'</span> <span class="n">this</span> <span class="n">is</span> <span class="n">usually</span> <span class="n">due</span> <span class="n">to</span> <span class="n">a</span> <span class="n">buggy</span> <span class="n">tactic</span> <span class="n">or</span> <span class="n">a</span> <span class="n">bug</span> <span class="k">in</span> <span class="n">the</span> <span class="n">builtin</span> <span class="n">elaborator</span>
<span class="n">elaborated</span> <span class="n">type</span><span class="o">:</span>
  <span class="n">has_repr</span> <span class="n">Rvsp.t</span>
<span class="n">elaborated</span> <span class="n">value</span><span class="o">:</span>
  <span class="n">id</span> <span class="n">real.has_repr</span>
<span class="n">nested</span> <span class="n">exception</span> <span class="n">message</span><span class="o">:</span>
<span class="n">invalid</span> <span class="kd">definition</span><span class="o">,</span> <span class="n">it</span> <span class="n">uses</span> <span class="n">untrusted</span> <span class="n">declaration</span> <span class="bp">'</span><span class="n">real.has_repr'</span>
</code></pre></div>



<a name="310937055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310937055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310937055">(Nov 18 2022 at 22:54)</a>:</h4>
<p>You need the word <code>meta</code> for <code>real</code></p>



<a name="310937135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310937135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310937135">(Nov 18 2022 at 22:54)</a>:</h4>
<p>Note that if you use my <code>@[reducible]</code> suggestion I made in the third post you don't have to deal with any of this</p>



<a name="310954726"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310954726" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310954726">(Nov 19 2022 at 01:58)</a>:</h4>
<p>Where does the word <code>meta</code> go?</p>



<a name="310954992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310954992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310954992">(Nov 19 2022 at 02:02)</a>:</h4>
<p>In the form <code>meta instance ...</code> should work</p>



<a name="310955886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310955886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310955886">(Nov 19 2022 at 02:17)</a>:</h4>
<p>Thanks.  What does <code>meta</code> mean?</p>



<a name="310955958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310955958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310955958">(Nov 19 2022 at 02:18)</a>:</h4>
<p>It's a tag that's used for defs at the metaprogramming level</p>



<a name="310955981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310955981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310955981">(Nov 19 2022 at 02:19)</a>:</h4>
<p>(In Lean3. Lean4 doesn't have <code>meta</code>.)</p>



<a name="310956132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956132">(Nov 19 2022 at 02:20)</a>:</h4>
<p>And why does the instance for <code>real</code> need to be at the metaprogramming level, but not the one for <code>nat</code>?</p>



<a name="310956164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956164">(Nov 19 2022 at 02:21)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/real.has_repr/src">src#real.has_repr</a> (just so I can take a look ;))</p>



<a name="310956260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956260">(Nov 19 2022 at 02:23)</a>:</h4>
<p>I was wondering if you were going to ask that... :) It's the same issue I <a href="#narrow/stream/113489-new-members/topic/Error.3A.20missing.20'noncomputable'.20modifier/near/310908013">highlighted before</a>: the implementation has to cheat using unsafe code to get at the representation behind the quotient</p>



<a name="310956279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956279">(Nov 19 2022 at 02:23)</a>:</h4>
<p>The ultimate source of this unsafe hackery is <a href="https://leanprover-community.github.io/mathlib_docs/find/quot.unquot/src">src#quot.unquot</a></p>



<a name="310956454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956454">(Nov 19 2022 at 02:26)</a>:</h4>
<p>As you yourself said <span class="user-mention" data-user-id="381187">@Mike Shulman</span> there are no computable functions definable in the logic which can distinguish real numbers by a continuity argument, but clearly a function that turns a <code>real</code> into a <code>string</code> would have to do just that</p>



<a name="310956693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956693">(Nov 19 2022 at 02:30)</a>:</h4>
<p><code>meta</code> means "I don't care if this introduces type unsafety or unsoundness" and enables access to stuff like unchecked type casting, unguarded recursion and C++ FFI. The lean 4 equivalent is <code>unsafe</code> and luckily it is much less necessary than it was in lean 3. <code>meta</code> declarations don't exist as far as the kernel is concerned, they are only for the VM/compiler.</p>



<a name="310956818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956818">(Nov 19 2022 at 02:33)</a>:</h4>
<p>Thanks.  I think the error message could have been more helpful in indicating that this was the problem...</p>



<a name="310956881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956881">(Nov 19 2022 at 02:34)</a>:</h4>
<p>do you have a mwe?</p>



<a name="310956892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956892">(Nov 19 2022 at 02:34)</a>:</h4>
<p>it is true that the error message is pretty bad, it looks like something made it past the first line of defense and you are getting the backup error message</p>



<a name="310956911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310956911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310956911">(Nov 19 2022 at 02:35)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.real.basic</span>
<span class="kd">structure</span> <span class="n">wrap</span> <span class="o">:=</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span>
<span class="kd">def</span> <span class="n">wrapR</span> <span class="o">:</span> <span class="n">wrap</span> <span class="o">:=</span> <span class="o">{</span><span class="n">t</span> <span class="o">:=</span> <span class="n">ℝ</span><span class="o">}</span>
<span class="kd">instance</span> <span class="o">:</span> <span class="n">has_repr</span> <span class="n">wrapR.t</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">dunfold</span> <span class="n">wrapR</span><span class="bp">;</span> <span class="n">apply_instance</span>
</code></pre></div>



<a name="310957133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310957133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310957133">(Nov 19 2022 at 02:39)</a>:</h4>
<p>Huh, I guess that's always what you get when you use a meta declaration in a non-meta one. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">meta</span> <span class="kd">def</span> <span class="n">bar</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="kd">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="n">bar</span>
<span class="c1">-- kernel failed to type check declaration 'foo' this is usually due to a buggy tactic or a bug in the builtin elaborator</span>
<span class="c1">-- elaborated type:</span>
<span class="c1">--   ℕ</span>
<span class="c1">-- elaborated value:</span>
<span class="c1">--   bar</span>
<span class="c1">-- nested exception message:</span>
<span class="c1">-- invalid definition, it uses untrusted declaration 'bar'</span>
</code></pre></div>
<p>The error for missing <code>noncomputable</code> is much better:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">noncomputable</span><span class="bp">!</span> <span class="kd">def</span> <span class="n">bar</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="mi">0</span>
<span class="kd">def</span> <span class="n">foo</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="n">bar</span>
<span class="c1">-- missing 'noncomputable' modifier, definition 'foo' depends on 'bar'</span>
</code></pre></div>



<a name="310961254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310961254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310961254">(Nov 19 2022 at 03:59)</a>:</h4>
<p>The last line "invalid definition, it uses untrusted declaration 'bar'" would be fairly informative if it were on its own.</p>



<a name="310972369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113489-new%20members/topic/Can%27t%20display%20a%20number%20whose%20type%20is%20wrapped%20in%20a%20structure/near/310972369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113489-new-members/topic/Can't.20display.20a.20number.20whose.20type.20is.20wrapped.20in.20a.20structure.html#310972369">(Nov 19 2022 at 07:13)</a>:</h4>
<p>Is this related to <code>bundled</code>?</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>