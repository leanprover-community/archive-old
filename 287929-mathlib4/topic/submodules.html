---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/submodules.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html">submodules</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="312593695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312593695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312593695">(Nov 28 2022 at 10:17)</a>:</h4>
<p>I believe that in <a href="https://github.com/leanprover-community/mathlib4/pull/700">mathlib4#700</a> <span class="user-mention" data-user-id="110087">@Scott Morrison</span> accidentally added the dependencies of mathlib as submodules. As a result many bors batches are now failing. I tried fixing this in <a href="https://github.com/leanprover-community/mathlib4/pull/766">mathlib4#766</a>, but maybe we also need to reset the runner? (Previous discussion: <a href="#narrow/stream/113488-general/topic/Weird.20CI.20failure">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Weird.20CI.20failure</a>)</p>



<a name="312631307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312631307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312631307">(Nov 28 2022 at 13:47)</a>:</h4>
<p>Gah, sorry. When lake moved its files around I must have added them. :-(</p>



<a name="312631445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312631445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312631445">(Nov 28 2022 at 13:48)</a>:</h4>
<p>Changing branches too often.</p>



<a name="312638130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312638130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312638130">(Nov 28 2022 at 14:18)</a>:</h4>
<p>A tip for next time: never use <code>git add .</code>. Use <code>git add -u</code> instead. This will only ever add files that are already tracked (or use <code>git commit -am &lt;commit message&gt;</code> directly).</p>



<a name="312642725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312642725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312642725">(Nov 28 2022 at 14:38)</a>:</h4>
<p>Can someone merge <a href="https://github.com/leanprover-community/mathlib4/pull/766">mathlib4#766</a> so that we can all merge master and stop getting these lint style errors?</p>



<a name="312645141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312645141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312645141">(Nov 28 2022 at 14:50)</a>:</h4>
<p>The build failed. I don't know if the error is even related to submodules: <a href="https://github.com/leanprover-community/mathlib4/actions/runs/3565817172/jobs/5991456034">https://github.com/leanprover-community/mathlib4/actions/runs/3565817172/jobs/5991456034</a></p>



<a name="312645501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312645501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312645501">(Nov 28 2022 at 14:52)</a>:</h4>
<p>Not that I really know anything about it, but it seems to me like it just lost a connection causing the download to fail. So maybe retry?</p>



<a name="312645540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312645540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312645540">(Nov 28 2022 at 14:52)</a>:</h4>
<p>Scott retried already</p>



<a name="312645750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312645750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312645750">(Nov 28 2022 at 14:53)</a>:</h4>
<p>I was so excited to see the title of this thread and learn that the port has reached submodules already ...</p>



<a name="312645824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312645824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312645824">(Nov 28 2022 at 14:53)</a>:</h4>
<p>sorry to disappoint :-)</p>



<a name="312647263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312647263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312647263">(Nov 28 2022 at 14:59)</a>:</h4>
<p>How far could they be...<br>
<a href="/user_uploads/3121/TU_rIDpuL0uke4iJ-b9V8Xp0/Screenshot-from-2022-11-28-15-59-25.png">/user_uploads/3121/TU_rIDpuL0uke4iJ-b9V8Xp0/Screenshot-from-2022-11-28-15-59-25.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/TU_rIDpuL0uke4iJ-b9V8Xp0/Screenshot-from-2022-11-28-15-59-25.png"><img src="/user_uploads/3121/TU_rIDpuL0uke4iJ-b9V8Xp0/Screenshot-from-2022-11-28-15-59-25.png"></a></div><p>... oh</p>



<a name="312647658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312647658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312647658">(Nov 28 2022 at 15:01)</a>:</h4>
<p>Even at that blurry resolution, I can recognise that big chunk on the left as "finiteness", which presumably isn't really needed to say what a submodule is...</p>



<a name="312648453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312648453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312648453">(Nov 28 2022 at 15:04)</a>:</h4>
<p>You've been looking at too many of those graphs, I think :)</p>
<p>At least one of the ways it depends on finiteness is through <code>algebra.group.conj</code>, which might be a candidate for splitting</p>



<a name="312648752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312648752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312648752">(Nov 28 2022 at 15:05)</a>:</h4>
<p>And <code>order.atoms</code></p>



<a name="312649823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312649823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312649823">(Nov 28 2022 at 15:10)</a>:</h4>
<p>Seems like the CI runner may need to be reset. Seems like it's still looking for those submodules: see <a href="https://github.com/leanprover-community/mathlib4/pull/612">mathlib4#612</a> and <a href="https://github.com/leanprover-community/mathlib4/pull/762">mathlib4#762</a></p>



<a name="312652663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312652663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312652663">(Nov 28 2022 at 15:23)</a>:</h4>
<p>Do you know what needs to be done? Happy to have instructions here if there's something I can do.</p>



<a name="312654123"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312654123" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312654123">(Nov 28 2022 at 15:30)</a>:</h4>
<p>No, note really. My guess: there are (now untracked) folders or files that are sitting around on the CI runner relating to these submodules that need to be deleted.</p>



<a name="312654540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312654540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312654540">(Nov 28 2022 at 15:31)</a>:</h4>
<p>In case anyone wants a full resolution version of the submodule graph: <a href="/user_uploads/3121/iRUglkyt5SFKLLq6ZY_weARB/algebra.module.submodule.basic.pdf">algebra.module.submodule.basic.pdf</a></p>



<a name="312687316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312687316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312687316">(Nov 28 2022 at 17:57)</a>:</h4>
<p>Does this involve the <code>hoskinson</code> runners? Sorry to be clueless -- if someone can explain to me what needs to be done, I'll try to do it (or ask <span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> for help).</p>



<a name="312689404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312689404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312689404">(Nov 28 2022 at 18:07)</a>:</h4>
<p>It looks like the linked actions did finish, are any runners still stuck? Happy to reset them.</p>



<a name="312703826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312703826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312703826">(Nov 28 2022 at 19:20)</a>:</h4>
<p>It took a few tries, but they eventually got there. Not sure exactly what magic made them succeed. I'll ping you if I encounter it again.</p>



<a name="312708037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312708037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312708037">(Nov 28 2022 at 19:45)</a>:</h4>
<p>I wonder if we have a poisoned runner now, and they succeeded because on later attempts they were given to non-poisoned runners...</p>



<a name="312713854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312713854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312713854">(Nov 28 2022 at 20:19)</a>:</h4>
<p>Hm, for example <a href="https://github.com/leanprover-community/mathlib4/actions/runs/3566620460/jobs/5993297093">this build</a> failed with an error as opposed to getting stuck in a loop, and runners should start every new build with a clean state. So as long as one is not stuck looping, it should be fine?</p>



<a name="312742242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312742242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312742242">(Nov 28 2022 at 23:42)</a>:</h4>
<blockquote>
<p>runners should start every new build with a clean state</p>
</blockquote>
<p>This is not the case for self-hosted runners.  We need to run <code>rm -rf *</code> manually.</p>



<a name="312743445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312743445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312743445">(Nov 28 2022 at 23:54)</a>:</h4>
<p>Ok, this is useful info.</p>



<a name="312914128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312914128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312914128">(Nov 29 2022 at 19:04)</a>:</h4>
<p>We're still getting transient errors <a href="https://github.com/leanprover-community/mathlib4/actions/runs/3577158206/jobs/6015832572">https://github.com/leanprover-community/mathlib4/actions/runs/3577158206/jobs/6015832572</a>.</p>



<a name="312914170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312914170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312914170">(Nov 29 2022 at 19:05)</a>:</h4>
<p>So I suspect at least one of the runners is poisoned.</p>



<a name="312914271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312914271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312914271">(Nov 29 2022 at 19:05)</a>:</h4>
<p>I'm not entirely sure at what point, or where, we need to run <code>run -rf *</code>, and I'm a little hesitant to experiment. :-)</p>



<a name="312917599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312917599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312917599">(Nov 29 2022 at 19:12)</a>:</h4>
<p><span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span>, do you know where we should do this? Or could you just rebuild the hoskinson runners? We're currently unable to reliably merge mathlib4 PRs.</p>



<a name="312917950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312917950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312917950">(Nov 29 2022 at 19:14)</a>:</h4>
<p>My guess is that the <code>.git/config</code> lists a submodule but there is no <code>.gitmodules</code> file and so it complains.</p>



<a name="312918154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312918154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312918154">(Nov 29 2022 at 19:15)</a>:</h4>
<p>removing it there would probably be sufficient.</p>



<a name="312918359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312918359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312918359">(Nov 29 2022 at 19:16)</a>:</h4>
<p>Okay -- but that is a file that only exists on the runner, right?</p>



<a name="312918363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312918363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312918363">(Nov 29 2022 at 19:16)</a>:</h4>
<p>This would persist even between branches and updates to master because <code>.git/config</code> isn't tracked, so it fits the symptoms.</p>



<a name="312918393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312918393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312918393">(Nov 29 2022 at 19:16)</a>:</h4>
<p>Yes, that's correct.</p>



<a name="312918486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312918486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312918486">(Nov 29 2022 at 19:16)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib4/pull/787">https://github.com/leanprover-community/mathlib4/pull/787</a> attempts to cleanup before starting.</p>



<a name="312918632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312918632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312918632">(Nov 29 2022 at 19:17)</a>:</h4>
<p>Actually, everyone has a copy of that file, but they will have different things listed there.</p>



<a name="312918717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312918717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312918717">(Nov 29 2022 at 19:17)</a>:</h4>
<p>It seems to do okay in CI, so I guess we can just merge it and see if it resolves the problem?</p>



<a name="312919258"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312919258" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312919258">(Nov 29 2022 at 19:19)</a>:</h4>
<p>Looks like bors is accepting the <code>rm -rf *</code> PR. It passed lint style.</p>



<a name="312919442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312919442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312919442">(Nov 29 2022 at 19:20)</a>:</h4>
<p>Are we sure <code>rm -rf *</code> is running the right directory? If so, that seems fine. Otherwise, it seems dangerous.</p>



<a name="312919697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312919697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312919697">(Nov 29 2022 at 19:21)</a>:</h4>
<p>Nope, not sure at all. :-)</p>



<a name="312919768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312919768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312919768">(Nov 29 2022 at 19:22)</a>:</h4>
<p>(Note: I know virtually nothing about the CI workflows)</p>



<a name="312919877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312919877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312919877">(Nov 29 2022 at 19:22)</a>:</h4>
<p>In the worst case, these CI machines are docker images generated from a script, so we can always rebuild them from scratch.</p>



<a name="312923551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312923551" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312923551">(Nov 29 2022 at 19:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/287929-mathlib4/topic/submodules/near/312917599">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="128280">Wojciech Nawrocki</span>, do you know where we should do this? Or could you just rebuild the hoskinson runners? We're currently unable to reliably merge mathlib4 PRs.</p>
</blockquote>
<p>I will rebuild all runners with the <code>mathlib4</code> tag now.</p>



<a name="312923848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312923848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312923848">(Nov 29 2022 at 19:44)</a>:</h4>
<p>Oh, there is no such tag. I guess mathlib4 tasks are put on the general <code>bors</code> queue?</p>



<a name="312924618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312924618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312924618">(Nov 29 2022 at 19:49)</a>:</h4>
<p>It seems my <code>rm -rf *</code> step in mathlib4 CI has resolved the issue for now anyway.</p>



<a name="312925812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312925812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312925812">(Nov 29 2022 at 19:55)</a>:</h4>
<p>Okay, I will not restart everything with <code>bors</code> for now because it would kill the currently running jobs. Please ping me if you see any more transient failures.</p>



<a name="312926534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312926534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312926534">(Nov 29 2022 at 19:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/287929-mathlib4/topic/submodules/near/312742242">said</a>:</p>
<blockquote>
<blockquote>
<p>runners should start every new build with a clean state</p>
</blockquote>
<p>This is not the case for self-hosted runners.  We need to run <code>rm -rf *</code> manually.</p>
</blockquote>
<p>did you mean <code>rm -rf actions-runner/_work/mathlib4/*</code>?</p>



<a name="312927831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312927831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312927831">(Nov 29 2022 at 20:06)</a>:</h4>
<p>I mean a <code>rm -rf *</code> build step in the work file.</p>



<a name="312927892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312927892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312927892">(Nov 29 2022 at 20:06)</a>:</h4>
<p>If you want to run it manually that's <code>rm -rf actions-runner/_work/mathlib4</code>, yes.</p>



<a name="312929771"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312929771" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312929771">(Nov 29 2022 at 20:17)</a>:</h4>
<p>Yes, I added <code>rm -rf *</code> as a build step, and that seems to have worked.</p>



<a name="312933659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312933659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312933659">(Nov 29 2022 at 20:39)</a>:</h4>
<p>uh... <a href="https://github.com/leanprover-community/mathlib4/actions/runs/3577730611/jobs/6017062376">https://github.com/leanprover-community/mathlib4/actions/runs/3577730611/jobs/6017062376</a></p>



<a name="312933778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312933778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312933778">(Nov 29 2022 at 20:40)</a>:</h4>
<p>:-(</p>



<a name="312933819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312933819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312933819">(Nov 29 2022 at 20:40)</a>:</h4>
<p><span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span>, could you rebuild all the runners?</p>



<a name="312934224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312934224" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312934224">(Nov 29 2022 at 20:42)</a>:</h4>
<p>I guess <code>rm -rf *</code> is not actually deleting <code>.git</code> or <code>.gitmodules</code> or whatever the infected file is.</p>



<a name="312934758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312934758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312934758">(Nov 29 2022 at 20:45)</a>:</h4>
<p>Okay, I've tried again, with <code>find . -name . -o -prune -exec rm -rf -- {} +</code> instead.</p>



<a name="312934833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312934833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312934833">(Nov 29 2022 at 20:46)</a>:</h4>
<p>(Following <a href="https://unix.stackexchange.com/questions/77127/rm-rf-all-files-and-all-hidden-files-without-error">https://unix.stackexchange.com/questions/77127/rm-rf-all-files-and-all-hidden-files-without-error</a>)</p>



<a name="312935005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312935005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312935005">(Nov 29 2022 at 20:47)</a>:</h4>
<p>IIRC the <code>*</code> glob doesn't pick up on things with a <code>.</code> prefix, like <code>.git/config</code>, which is probably why it failed before.</p>



<a name="312935098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312935098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312935098">(Nov 29 2022 at 20:47)</a>:</h4>
<p>ah, you just linked that.</p>



<a name="312936433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/submodules/near/312936433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/submodules.html#312936433">(Nov 29 2022 at 20:55)</a>:</h4>
<p>That seems to have worked. I'll tell bors to try again on everything.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>