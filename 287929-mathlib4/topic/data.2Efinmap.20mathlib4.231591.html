---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html">data.finmap mathlib4#1591</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="321642538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321642538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321642538">(Jan 16 2023 at 13:37)</a>:</h4>
<p>Hello Everyone,<br>
I am starting to port <code>data.finmap</code>. In order to avoid merge conflicts, please message here before adding commits to the PR.</p>



<a name="321654184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321654184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321654184">(Jan 16 2023 at 14:27)</a>:</h4>
<p>The notation introduced in this line: <code>local notation:arg "⟦" a "⟧" =&gt; AList.toFinmap a</code> is causing ambiguities that lean complains about. So I am disambiguating by explicitly inserting <code>Alist.toFinmap</code></p>



<a name="321704762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321704762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arien Malec <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321704762">(Jan 16 2023 at 19:16)</a>:</h4>
<p>I have a fix for <code>replace</code> &amp; can push doc fixes.</p>



<a name="321705500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321705500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321705500">(Jan 16 2023 at 19:21)</a>:</h4>
<p>I wish you had let me know. I have a bunch of work on this PR that I have spent 2 hours on that I have to discard.</p>



<a name="321705688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321705688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321705688">(Jan 16 2023 at 19:23)</a>:</h4>
<p>It creates merge conflicts for me</p>



<a name="321705936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321705936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321705936">(Jan 16 2023 at 19:23)</a>:</h4>
<p>Plus all my work becomes pointless</p>



<a name="321709975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321709975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arien Malec <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321709975">(Jan 16 2023 at 19:56)</a>:</h4>
<p>We can just roll back. Sorry, should have waited longer</p>



<a name="321710403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321710403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321710403">(Jan 16 2023 at 19:59)</a>:</h4>
<p>I would like to place a lock on this PR until  23:30 CET</p>



<a name="321711009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321711009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321711009">(Jan 16 2023 at 20:04)</a>:</h4>
<p><span class="user-mention" data-user-id="466334">@Shreyas Srinivas</span>  Note that you can use <code>&lt;time</code>-tabcomplete to write timezone aware times in Zulip.</p>



<a name="321714640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321714640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321714640">(Jan 16 2023 at 20:36)</a>:</h4>
<p>ah thanks. I had trouble finding the command for  the time. I would like to place a lock on the file until : <time datetime="2023-01-16T22:30:00Z">2023-01-16T23:30:00+01:00</time> . If I need an extension, I will place a similar time-bound lock again.</p>



<a name="321725536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321725536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321725536">(Jan 16 2023 at 22:18)</a>:</h4>
<p>I'm extending the lock for 2 more hours</p>



<a name="321736616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321736616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321736616">(Jan 17 2023 at 00:30)</a>:</h4>
<p>I am still working on this. I will release it within an hour or so, since I need to wrap up for the day anyway.</p>



<a name="321740525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321740525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321740525">(Jan 17 2023 at 01:19)</a>:</h4>
<p>I am dropping the lock on this. The definition of liftOn does not seem to carry over from lean3's version. I have left the version of the definition from mathport more or less.</p>



<a name="321867096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321867096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321867096">(Jan 17 2023 at 16:08)</a>:</h4>
<p>I lock for 3 hours again. <span aria-label="locked" class="emoji emoji-1f512" role="img" title="locked">:locked:</span></p>



<a name="321867784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321867784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321867784">(Jan 17 2023 at 16:11)</a>:</h4>
<p>Not to say that what you're doing is wrong, Shreyas, but I find it funny that VCS like git was originally designed so locking files didn't have to be an issue, and yet here we are lol</p>



<a name="321869562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321869562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321869562">(Jan 17 2023 at 16:19)</a>:</h4>
<p>Microsoft created both Lean and Visual SourceSafe. Coincidence? I do like the terminology there, though: checking out a file was like checking out a book at the library.</p>
<p>(Also not a reply to Shreyas' message! Today's not the first time I was reminded of VSS)</p>



<a name="321873714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321873714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321873714">(Jan 17 2023 at 16:38)</a>:</h4>
<p>Well, git will handle this fine - the trouble starts when multiple people are trying to make roughly the same changes to the same file at the same time</p>



<a name="321875041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321875041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321875041">(Jan 17 2023 at 16:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="307953">Ruben Van de Velde</span> <a href="#narrow/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591/near/321873714">said</a>:</p>
<blockquote>
<p>Well, git will handle this fine - the trouble starts when multiple people are trying to make roughly the same changes to the same file at the same time</p>
</blockquote>
<p>I think this might partly be peculiar to the port effort and the workflow that has been adopted here. The normal git  flow would work something like this: People make forks of the repo and  push there. Then make a pull request from their repo to the port branch. Whichever pull request passes the tests first gets integrated.  This is cleaner from a VCS perspective, but has two disadvantages:</p>
<ol>
<li>CI : I am not sure if github requires a premium account for this, but if it does, then not everyone has premium accounts. I am not sure how to get automated build+test on such a workflow. </li>
<li>Competing PRs for the same file : This duplicates effort.</li>
</ol>



<a name="321905308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321905308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321905308">(Jan 17 2023 at 19:08)</a>:</h4>
<p>Lock <span aria-label="locked" class="emoji emoji-1f512" role="img" title="locked">:locked:</span> extension for 1 hour.</p>



<a name="321906908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321906908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arien Malec <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321906908">(Jan 17 2023 at 19:15)</a>:</h4>
<p>I tend to do atomic commits (commit every fix) and push as soon as I commit to reduce the surface area for any merge issue; it also means there's less to regret if there is something I need to redo. The problem really magnifies with large commits and parallel work.</p>



<a name="321909389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321909389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321909389">(Jan 17 2023 at 19:27)</a>:</h4>
<p>I am stuck on <code>def liftOn</code>. It seems to be the key to further fixes.</p>



<a name="321909740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321909740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321909740">(Jan 17 2023 at 19:29)</a>:</h4>
<p>In fact I think I'd like to ask for help at this point. So I have pushed the file as it stands now.</p>



<a name="321909765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321909765" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321909765">(Jan 17 2023 at 19:29)</a>:</h4>
<p>lock lifted</p>



<a name="321913542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321913542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321913542">(Jan 17 2023 at 19:51)</a>:</h4>
<p>To my eyes, the <span aria-label="locked" class="emoji emoji-1f512" role="img" title="locked">:locked:</span> (locked) and <span aria-label="unlocked" class="emoji emoji-1f513" role="img" title="unlocked">:unlocked:</span> (unlocked) emojis look too similar</p>



<a name="321913639"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321913639" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Shreyas Srinivas <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321913639">(Jan 17 2023 at 19:52)</a>:</h4>
<p>To me the difference is observable if I look very closely but not otherwise</p>



<a name="321959983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.finmap%20mathlib4%231591/near/321959983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591.html#321959983">(Jan 18 2023 at 01:38)</a>:</h4>
<p><span class="user-mention silent" data-user-id="307953">Ruben Van de Velde</span> <a href="#narrow/stream/287929-mathlib4/topic/data.2Efinmap.20mathlib4.231591/near/321873714">said</a>:</p>
<blockquote>
<p>Well, git will handle this fine - the trouble starts when multiple people are trying to make roughly the same changes to the same file at the same time</p>
</blockquote>
<p>In my experience, requests to lock files in git usually come down to some combination of:</p>
<ul>
<li>Commits being too non-atomic to make merged easy</li>
<li>Contributors not having experience with dealing with merge conflicts</li>
<li>Merge conflict resolution tools doing a really bad job on particular kinds of changes</li>
</ul>
<p>Note that GitHub supports making PRs against other PR branches; this allows you to try out CI on and share a fix without preventing someone else trying something different. The work duplication problem is still there though.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>