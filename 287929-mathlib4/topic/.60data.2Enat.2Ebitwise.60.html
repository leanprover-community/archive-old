---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html">`data.nat.bitwise`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="319910300"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319910300" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319910300">(Jan 07 2023 at 06:23)</a>:</h4>
<p>I noticed from <a href="https://math.commelin.net/files/port_status.html">https://math.commelin.net/files/port_status.html</a> that <code>data.nat.bitwise</code> is ready to port, since <code>data.list.basic</code> was ported.<br>
However, this file only has two dependencies: <code>set_theory.game.nim</code> and <code>data.nat.multiplicity</code>. I've gone through the latter, and it doesn't actually seem to use any of <code>data.nat.bitwise</code>'s definitions<br>
is this file actually useful?</p>



<a name="319910786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319910786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319910786">(Jan 07 2023 at 06:27)</a>:</h4>
<p>The <code>simp [h, one_right h2.not_unit]</code> in <code>data.nat.multiplicity</code> uses a lemma from <code>data.nat.bitwise</code>.</p>



<a name="319910908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319910908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319910908">(Jan 07 2023 at 06:29)</a>:</h4>
<p>It's perhaps not the most exciting file, but we'd like it ported eventually. If you're just getting started files like this (off the critical path) are actually pretty good as warm-up exercises. :-)</p>



<a name="319910940"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319910940" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319910940">(Jan 07 2023 at 06:29)</a>:</h4>
<p>When you want to focus on the most important targets, I'd suggest instead of going to the port_status page, go to the <a href="#narrow/stream/287929-mathlib4/topic/port.20progress">port progress</a> thread, and click on the links to the graphs that the port-progress-bot posts.</p>



<a name="319911034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319911034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319911034">(Jan 07 2023 at 06:30)</a>:</h4>
<p>Light blue indicates files ready to port, dark blue means there is an open PR, which most likely could do with either help or review.</p>



<a name="319911170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319911170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319911170">(Jan 07 2023 at 06:32)</a>:</h4>
<p>ah, right, simp lemmas <span aria-label="stuck out tongue closed eyes" class="emoji emoji-1f61d" role="img" title="stuck out tongue closed eyes">:stuck_out_tongue_closed_eyes:</span> <br>
yes I was thinking this file might be a nice start, since it wasn't really blocking anything and seemed simple enough<br>
I wasn't really able to find any light blue circles without a PR in <a href="#narrow/stream/287929-mathlib4/topic/port.20progress">port progress</a> either, but I might have not looked hard enough</p>



<a name="319912073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319912073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319912073">(Jan 07 2023 at 06:45)</a>:</h4>
<p>Helping out on the dark blue circles is very important too! You're welcome to push fixes to anyone's PRs, by default.</p>



<a name="319918163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319918163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319918163">(Jan 07 2023 at 08:07)</a>:</h4>
<p>I've started work in <a href="https://github.com/leanprover-community/mathlib4/pull/1404">mathlib4#1404</a><br>
already getting a little bit of weird behaivour here<br>
for example, simp is leaving me with a goal of</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">‚ä¢</span> <span class="o">(</span><span class="k">match</span> <span class="n">bits</span> <span class="n">n</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="o">[]</span> <span class="bp">=&gt;</span> <span class="n">false</span>
  <span class="bp">|</span> <span class="n">a</span> <span class="o">::</span> <span class="n">tail</span> <span class="bp">=&gt;</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span>
  <span class="n">List.head</span><span class="bp">!</span> <span class="o">(</span><span class="n">bits</span> <span class="n">n</span><span class="o">)</span>
</code></pre></div>
<p>which is closed by rfl.</p>
<p>I can't add <code>rfl</code> to the list of lemmas, because simp won't allow that.<br>
code pointer: <a href="https://github.com/leanprover-community/mathlib4/pull/1404/files#diff-f6a569804f7aec89a2a69cc9f1c115b1da9ff00349ebd8df8845b35c85b3acb5R80">https://github.com/leanprover-community/mathlib4/pull/1404/files#diff-f6a569804f7aec89a2a69cc9f1c115b1da9ff00349ebd8df8845b35c85b3acb5R80</a></p>



<a name="319918629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319918629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319918629">(Jan 07 2023 at 08:13)</a>:</h4>
<p>ah,  this is probably because the lean3 code is different, and <code>head</code> does not panic.</p>



<a name="319918713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319918713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319918713">(Jan 07 2023 at 08:14)</a>:</h4>
<p>I would try and figure out how that <code>match</code> is getting there. Looks like <code>simp</code> unfolded too much.</p>



<a name="319919676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319919676" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319919676">(Jan 07 2023 at 08:26)</a>:</h4>
<p>Yeah, in <code>Mathlib.Init.Data.List.Basic</code> <code>headI</code> is marked with <code>@[simp]</code>. That seems wrong.</p>



<a name="319920527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319920527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319920527">(Jan 07 2023 at 08:33)</a>:</h4>
<p>You might want to merge <a href="https://github.com/leanprover-community/mathlib4/pull/1407">mathlib4#1407</a> into <a href="https://github.com/leanprover-community/mathlib4/pull/1404">mathlib4#1404</a>.</p>



<a name="319924227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319924227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319924227">(Jan 07 2023 at 09:09)</a>:</h4>
<p>This  still leaves the goal <code>‚ä¢ List.headI (bits n) = List.head! (bits n)</code> which is solved by rfl<br>
seems like there needs to be a simp lemma stating these are equal<br>
either that or we should start using <code>headI</code> instead of mixing <code>headI</code> and <code>head!</code></p>



<a name="319932875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319932875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319932875">(Jan 07 2023 at 10:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="382349">Calvin Lee</span> <a href="#narrow/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60/near/319924227">said</a>:</p>
<blockquote>
<p>either that or we should start using <code>headI</code> instead of mixing <code>headI</code> and <code>head!</code></p>
</blockquote>
<p>Yeah I don't think we should be using <code>head!</code> at all, really; where did that come from?</p>



<a name="319933715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319933715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319933715">(Jan 07 2023 at 10:31)</a>:</h4>
<p>Oh huh apparently we decided Lean 3's <code>head</code> maps to <code>head!</code> not <code>headI</code>; is that really right?</p>



<a name="319933892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319933892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319933892">(Jan 07 2023 at 10:33)</a>:</h4>
<p>Some folks looked at what lean 4 had and thought that <code>head</code> should map to <code>head!</code></p>



<a name="319933948"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319933948" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319933948">(Jan 07 2023 at 10:33)</a>:</h4>
<p>Is that because <code>headI</code> didn't exist? I see it is in the invisible folder Mathlib.Init</p>



<a name="319933955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319933955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319933955">(Jan 07 2023 at 10:33)</a>:</h4>
<p>yes</p>



<a name="319933970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319933970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319933970">(Jan 07 2023 at 10:33)</a>:</h4>
<p><code>getI_zero_eq_head!</code> is just strange</p>



<a name="319933989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319933989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319933989">(Jan 07 2023 at 10:33)</a>:</h4>
<p>I mean, given that <code>headI</code> is there too</p>



<a name="319933998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319933998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319933998">(Jan 07 2023 at 10:33)</a>:</h4>
<p>yeah I think there is some cleanup to be had</p>



<a name="319934920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319934920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319934920">(Jan 07 2023 at 10:41)</a>:</h4>
<p>Just asking as I was probably the one who put <code>head!</code> in that file, what is the reason to prefer <code>headI</code> over <code>head!</code>? In what use cases is it better to silently use a default instead of doing so with a panic?</p>



<a name="319935000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935000">(Jan 07 2023 at 10:42)</a>:</h4>
<p>I realize that using both is wrong. My question is why not <code>head!</code> always?</p>



<a name="319935017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935017">(Jan 07 2023 at 10:42)</a>:</h4>
<p>why would it be wrong to use a default?</p>



<a name="319935086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935086">(Jan 07 2023 at 10:42)</a>:</h4>
<p>it is only if you assume that [] means "error" that it would even make sense to panic</p>



<a name="319935166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935166">(Jan 07 2023 at 10:43)</a>:</h4>
<p>if the list represents a finitely supported function then I might just want the value <code>default</code> out of range</p>



<a name="319935248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935248">(Jan 07 2023 at 10:44)</a>:</h4>
<p>I mean in my own code I would either use <code>head!</code> (if I am sure there is a head but don't want to bother to prove this) or <code>headD</code> and specify what I want as fallback. It is just that <code>headI</code> is very non-local.</p>



<a name="319935288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935288">(Jan 07 2023 at 10:44)</a>:</h4>
<p><code>headI</code> is a shorter way to write <code>headD default</code></p>



<a name="319935319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935319">(Jan 07 2023 at 10:44)</a>:</h4>
<p>because <code>default</code> is very often the thing you want to use as a default</p>



<a name="319935391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935391">(Jan 07 2023 at 10:45)</a>:</h4>
<p><code>head!</code> is one of those functions that will be called a mistake in the future (and in the present, if you listen to the right people)</p>



<a name="319935477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935477">(Jan 07 2023 at 10:46)</a>:</h4>
<p>I guess in time I will see many cases of calling <code>default</code> (so far I usually know what I want as default).</p>



<a name="319935525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935525">(Jan 07 2023 at 10:46)</a>:</h4>
<p>There is nothing wrong with using <code>head!</code> when you know the list is nonempty, and you aren't interested in proving things about your code</p>



<a name="319935559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935559">(Jan 07 2023 at 10:47)</a>:</h4>
<p>I think of functions like <code>head!</code> as a compromise between proving correctness and silent unexpected behaviour.</p>



<a name="319935591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935591">(Jan 07 2023 at 10:47)</a>:</h4>
<p>If you are going to prove things then you won't use <code>head!</code> in the first place. So lemmas about <code>head!</code> are sort of weird.</p>



<a name="319935661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935661">(Jan 07 2023 at 10:48)</a>:</h4>
<p>while I generally agree with that, in large scale programs it can get problematic to argue that a program doesn't panic</p>



<a name="319935744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935744">(Jan 07 2023 at 10:48)</a>:</h4>
<p>this is a problem in rust for some applications</p>



<a name="319935988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319935988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319935988">(Jan 07 2023 at 10:50)</a>:</h4>
<p>it's kind of a false dichotomy to say "either you want to prove things or you don't" and then put programmers on the other side of that line</p>



<a name="319936127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319936127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319936127">(Jan 07 2023 at 10:51)</a>:</h4>
<p>Given Godel-Turing-Church etc it will be a pretty silly dichotomy anyway.</p>



<a name="319936134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319936134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319936134">(Jan 07 2023 at 10:52)</a>:</h4>
<p>Sure, I don't mean <code>head!</code> is the right tool for every case.</p>



<a name="319936406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319936406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319936406">(Jan 07 2023 at 10:53)</a>:</h4>
<p>it is especially problematic when you use it in foundational things (looking at you haskell <code>list.head</code>) because those permeate the ecosystem and make it so that everything of interest has a dependency that panics</p>



<a name="319936814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319936814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319936814">(Jan 07 2023 at 10:57)</a>:</h4>
<p>I guess I tended to think of <code>Inhabited</code> as <em>non-empty</em>, but that is the typeclass <code>NonEmpty</code>. If one thinks of <code>Inhabited</code> as <em>based</em> (i.e., with base point) it becomes natural to use <code>getI</code>, <code>headI</code> etc.</p>



<a name="319936923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319936923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319936923">(Jan 07 2023 at 10:58)</a>:</h4>
<p>But as a mathematician I would say the typeclass should be called <code>Based</code> in that case.</p>



<a name="319939804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319939804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319939804">(Jan 07 2023 at 11:19)</a>:</h4>
<p>I think we usually use the term <code>Pointed</code> for the mathematical notion</p>



<a name="319942504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319942504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319942504">(Jan 07 2023 at 11:40)</a>:</h4>
<p>True, <code>pointed</code> is used. In topology one says based, e.g. "based loop space" versus "free loop space" maybe because "pointed space" sounds a bit weird, hence my bias.</p>



<a name="319942618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319942618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319942618">(Jan 07 2023 at 11:41)</a>:</h4>
<p>I guess the extra data is a basepoint, so there is a choice which part is dropped in making the adjective.</p>



<a name="319942984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319942984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319942984">(Jan 07 2023 at 11:44)</a>:</h4>
<p>On the flip side, with a vector space "based" sounds like with a basis, which would be confusing.</p>
<p>The upshot is that I will update my mental view of <code>Inhabited</code>.</p>



<a name="319996902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319996902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319996902">(Jan 07 2023 at 19:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60/near/319933970">said</a>:</p>
<blockquote>
<p><code>getI_zero_eq_head!</code> is just strange</p>
</blockquote>
<p>agree, changing to <code>getI_zero_eq_headI</code> which also solves the <code>simp</code> issue brought up in this thread</p>



<a name="319996986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/319996986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#319996986">(Jan 07 2023 at 19:03)</a>:</h4>
<p>just so I'm understanding the mathlib4 flow a little bit better<br>
should a fix like this be its own PR that is then merged back into the port PR?</p>



<a name="320011343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320011343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320011343">(Jan 07 2023 at 22:23)</a>:</h4>
<p>Is there any reason <code>Bool.and_assoc</code> and <code>Bool.or_assoc</code> from <code>Init.SimpLemmas</code> aren't marked as simp?<br>
I just ported the <code>bitwise_assoc_tac</code> tactic, and had to add these two to the simp list to get all the goals to close</p>



<a name="320011560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320011560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320011560">(Jan 07 2023 at 22:26)</a>:</h4>
<p>See <a href="https://github.com/leanprover-community/mathlib4/pull/1404/commits/a7f5e50bff2ff558c14ed080cefc55c8e790c097">https://github.com/leanprover-community/mathlib4/pull/1404/commits/a7f5e50bff2ff558c14ed080cefc55c8e790c097</a> for the relevant changes</p>



<a name="320015213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320015213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320015213">(Jan 07 2023 at 23:18)</a>:</h4>
<p>Associativity lemmas are usually not simp, but instead marked as simp locally when building the API.</p>



<a name="320015252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320015252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320015252">(Jan 07 2023 at 23:19)</a>:</h4>
<p>So <code>local attribute [simp] Bool.or_assoc Bool.and_assoc</code> is likely the idiomatic solution</p>



<a name="320015810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320015810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320015810">(Jan 07 2023 at 23:26)</a>:</h4>
<p>I got around it by changing the simp lemma list, which is fine with me<br>
this just appears to be a difference from mathlib where <code>band_assoc</code> and <code>bor_assoc</code> are simp</p>



<a name="320016539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320016539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ya√´l Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320016539">(Jan 07 2023 at 23:36)</a>:</h4>
<p>Oh if they are simp in mathlib, then no problem.</p>



<a name="320025453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320025453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320025453">(Jan 08 2023 at 01:43)</a>:</h4>
<p>one <code>sorry</code> left and this should be ready to land<br>
it's a bit tricky through, since the last lemma runs <code>simp</code> on three different goals, and none really seem to succeed in lean4<br>
would be happy to let others take a look</p>



<a name="320031675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320031675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Calvin Lee <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320031675">(Jan 08 2023 at 03:36)</a>:</h4>
<p>Ok, I decided to just manually prove the last lemma in this file, since the simplifier couldn't close it.</p>
<p>The file should be ready to review<br>
tests aren't passing though, because of <code>bit0</code> and <code>bit1</code> deprecation. Is there any way to get rid of these warnings?</p>



<a name="320031718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60data.nat.bitwise%60/near/320031718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60data.2Enat.2Ebitwise.60.html#320031718">(Jan 08 2023 at 03:37)</a>:</h4>
<p><code>set_option linter.deprecated false</code> around any theorems using them</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>