---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/structure.20cmd.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/structure.20cmd.html">structure cmd</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="249131849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/structure%20cmd/near/249131849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/structure.20cmd.html#249131849">(Aug 11 2021 at 16:23)</a>:</h4>
<p>Leo implemented a solution to <a href="https://github.com/dselsam/mathport/issues/9">https://github.com/dselsam/mathport/issues/9</a>, here is an example going all the way up to <code>Field</code>: <a href="https://github.com/leanprover/lean4/blob/master/tests/lean/diamond7.lean">https://github.com/leanprover/lean4/blob/master/tests/lean/diamond7.lean</a> The generated coercions are much more compact than the ones in Lean3 and it could be a lot of faster. It would be great if someone could stress-test this (for the use-cases important to porting mathlib).</p>



<a name="249133806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/structure%20cmd/near/249133806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Renshaw <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/structure.20cmd.html#249133806">(Aug 11 2021 at 16:38)</a>:</h4>
<p>So we don't even need to set a flag like <code>set_option old_structure_cmd true</code>?</p>



<a name="249134437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/structure%20cmd/near/249134437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Daniel Selsam <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/structure.20cmd.html#249134437">(Aug 11 2021 at 16:43)</a>:</h4>
<p>No, there is only one structure command now. If there are clashes/diamonds it looks for common ancestors rather than flattening everything like <code>old_structure_cmd</code> does in Lean3.</p>



<a name="249138148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/structure%20cmd/near/249138148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/structure.20cmd.html#249138148">(Aug 11 2021 at 17:10)</a>:</h4>
<p>Presumably the effect is that the first parent is the "true" parent <del>(such that <code>derived_A.to_first_parent = derived_B.to_first_parent</code> is true by refl)</del> and the second parent is inserted as an automatic definition <del>(such that <code>derived_A.to_second_parent = derived_B.to_second_parent</code> requires invoking a recursor)?</del></p>



<a name="249138341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/structure%20cmd/near/249138341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/structure.20cmd.html#249138341">(Aug 11 2021 at 17:12)</a>:</h4>
<p>Hmm, that's not the discriminator I thought it was. There's some observable difference between first and second parents though, right?</p>



<a name="249139856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/structure%20cmd/near/249139856" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/structure.20cmd.html#249139856">(Aug 11 2021 at 17:23)</a>:</h4>
<p>If you look at the constructor of the structure, the flattened parents will be passed as a bunch of fields instead of a structure argument</p>



<a name="249140049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/structure%20cmd/near/249140049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/structure.20cmd.html#249140049">(Aug 11 2021 at 17:25)</a>:</h4>
<p>it also has consequences for whether <code>(foo.mk instA otherStuff).to_A = instA</code> is defeq or not</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>