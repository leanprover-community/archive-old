---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/Mathport.20oneshot.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html">Mathport oneshot</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="305816645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/305816645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#305816645">(Oct 24 2022 at 13:16)</a>:</h4>
<p>I want to bring attention to a new "feature" of mathport (really just some shell script wrangling), oneshot execution, added in <a href="https://github.com/leanprover-community/mathport/pull/191">mathport#191</a>. You can now write a lean 3 file, add some <code>#align</code>s in a lean 4 file, and run <code>make oneshot</code> and in less than a second it will do all the work to compile everything and produce a lean 4 output file. This is useful both for mathport developers testing out changes, as well as end users who want to add <code>#align</code>s and get immediate feedback in the rest of the file.</p>



<a name="305901800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/305901800" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#305901800">(Oct 24 2022 at 19:44)</a>:</h4>
<p>Oh this is super helpful, thanks! I'd been doing all this manually and it was a bit tedious</p>



<a name="307630548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/307630548" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#307630548">(Nov 02 2022 at 22:44)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span>, do you have an elan override that is making this work? I'm getting</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>% make oneshot
cd sources/lean &amp;&amp; lean --make --recursive --ast --tlean ../../Oneshot/lean3-in
lean: unrecognized option `--make'
Unknown command line option
Lean (version 4.0.0-nightly-2022-10-29, commit 62ec0bfdb02e, Release)
</code></pre></div>



<a name="307631129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/307631129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#307631129">(Nov 02 2022 at 22:49)</a>:</h4>
<p>Even if I add an override in <code>sources/lean</code>, I get:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>% make oneshot
cd sources/lean &amp;&amp; lean --make --recursive --ast --tlean ../../Oneshot/lean3-in
./build/bin/mathport config.oneshot.json Oneshot::main &gt;&gt; Logs/oneshot.out 2&gt; &gt;(tee -a Logs/oneshot.err &gt;&amp;2)
porting Main
uncaught exception: [resolveMod3] failed to resolve 'init'
make: *** [Outputs/src/oneshot/Oneshot/Main.lean] Error 1
</code></pre></div>



<a name="307664366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/307664366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#307664366">(Nov 03 2022 at 06:29)</a>:</h4>
<p>I thought that this override had already been set up by mathport's default installation. <code>make lean3-predata</code> is doing the same thing</p>



<a name="307664375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/307664375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#307664375">(Nov 03 2022 at 06:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span></p>



<a name="307664621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/307664621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#307664621">(Nov 03 2022 at 06:31)</a>:</h4>
<p>Ah, I see, the makefile target for <code>lean3-predata</code> is creating that elan override, but I guess I have a checked out copy in which I've never run that target.</p>



<a name="307664623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/307664623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#307664623">(Nov 03 2022 at 06:31)</a>:</h4>
<p>oh, <code>lean3-predata</code> does an <code>elan override</code> immediately prior, I'll make the <code>oneshot</code> command do that as well</p>



<a name="309143574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/309143574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#309143574">(Nov 11 2022 at 07:51)</a>:</h4>
<p>Lake build fails if I want to run <code>oneshot</code> on a fresh clone of mathport after running <code>make predata</code> (which was successful).</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">└─$</span> <span class="n">make</span> <span class="n">oneshot</span>
<span class="n">cd</span> <span class="n">Oneshot</span><span class="bp">/</span><span class="n">lean3</span><span class="bp">-</span><span class="k">in</span> <span class="bp">&amp;&amp;</span> <span class="n">elan</span> <span class="n">override</span> <span class="n">set</span> <span class="bp">`</span><span class="n">cat</span> <span class="bp">../../</span><span class="n">sources</span><span class="bp">/</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">leanpkg.toml</span> <span class="bp">|</span> <span class="n">grep</span> <span class="n">lean_version</span> <span class="bp">|</span> <span class="n">cut</span> <span class="bp">-</span><span class="n">d</span> <span class="sc">'"'</span> <span class="bp">-</span><span class="n">f2</span><span class="bp">`</span>
<span class="n">info</span><span class="o">:</span> <span class="n">using</span> <span class="n">existing</span> <span class="n">install</span> <span class="n">for</span> <span class="bp">'</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">lean</span><span class="o">:</span><span class="mi">3</span><span class="bp">.</span><span class="mi">48</span><span class="bp">.</span><span class="mi">0</span><span class="bp">'</span>
<span class="n">info</span><span class="o">:</span> <span class="n">override</span> <span class="n">toolchain</span> <span class="n">for</span> <span class="bp">'/</span><span class="n">home</span><span class="bp">/</span><span class="n">moritz</span><span class="bp">/</span><span class="n">coding</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">mathport</span><span class="bp">/</span><span class="n">Oneshot</span><span class="bp">/</span><span class="n">lean3</span><span class="bp">-</span><span class="k">in</span><span class="bp">'</span> <span class="n">set</span> <span class="n">to</span> <span class="bp">'</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">lean</span><span class="o">:</span><span class="mi">3</span><span class="bp">.</span><span class="mi">48</span><span class="bp">.</span><span class="mi">0</span><span class="bp">'</span>

  <span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">lean</span><span class="o">:</span><span class="mi">3</span><span class="bp">.</span><span class="mi">48</span><span class="bp">.</span><span class="mi">0</span> <span class="n">unchanged</span> <span class="bp">-</span> <span class="n">Lean</span> <span class="o">(</span><span class="n">version</span> <span class="mi">3</span><span class="bp">.</span><span class="mi">48</span><span class="bp">.</span><span class="mi">0</span><span class="o">,</span> <span class="n">commit</span> <span class="mi">283</span><span class="n">f6ed8083a</span><span class="o">,</span> <span class="n">Release</span><span class="o">)</span>

<span class="n">cd</span> <span class="n">Oneshot</span><span class="bp">/</span><span class="n">lean3</span><span class="bp">-</span><span class="k">in</span> <span class="bp">&amp;&amp;</span> <span class="n">lean</span> <span class="c1">--make --recursive --ast --tlean .</span>
<span class="n">cd</span> <span class="n">Oneshot</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">-</span><span class="k">in</span> <span class="bp">&amp;&amp;</span> <span class="n">lake</span> <span class="n">build</span>
<span class="n">error</span><span class="o">:</span> <span class="n">no</span> <span class="n">such</span> <span class="n">file</span> <span class="n">or</span> <span class="n">directory</span> <span class="o">(</span><span class="n">error</span> <span class="n">code</span><span class="o">:</span> <span class="mi">2</span><span class="o">)</span>
  <span class="n">file</span><span class="o">:</span> <span class="bp">./../../</span><span class="n">lean_packages</span><span class="bp">/</span><span class="n">mathlib</span><span class="bp">/</span><span class="n">lakefile.lean</span>
<span class="n">make</span><span class="o">:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">Makefile</span><span class="o">:</span><span class="mi">127</span><span class="o">:</span> <span class="n">Oneshot</span><span class="bp">/</span><span class="n">lean4</span><span class="bp">-</span><span class="k">in</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">lib</span><span class="bp">/</span><span class="n">Oneshot.trace</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">1</span>
</code></pre></div>



<a name="309188076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/309188076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#309188076">(Nov 11 2022 at 13:00)</a>:</h4>
<p>you also need to build mathport itself (<code>make build</code> or <code>lake build</code>)</p>



<a name="310712268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/310712268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#310712268">(Nov 17 2022 at 22:34)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> can you (or someone else who knows how) add some step-by-step instructions for using mathport oneshot to the mathlib4 wiki? I know it was covered in the meeting last week but that audio was really hard to hear in the recording on YouTube, and it would be nice to have them written somewhere anyway.</p>



<a name="315519159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315519159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315519159">(Dec 13 2022 at 06:21)</a>:</h4>
<p>Hey, i'm getting this error</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>r@pc-60 ~/P/mathport <span class="o">(</span>master<span class="o">)</span>&gt; make oneshot
<span class="nb">cd</span> Oneshot/lean4-in <span class="o">&amp;&amp;</span> lake build
warning: manifest out of date: <span class="nb">source</span> kind <span class="o">(</span>git/path<span class="o">)</span> of dependency mathlib changed, use <span class="sb">`</span>lake update<span class="sb">`</span> to update
warning: manifest out of date: <span class="nb">source</span> kind <span class="o">(</span>git/path<span class="o">)</span> of dependency std changed, use <span class="sb">`</span>lake update<span class="sb">`</span> to update
warning: manifest out of date: <span class="nb">source</span> kind <span class="o">(</span>git/path<span class="o">)</span> of dependency Qq changed, use <span class="sb">`</span>lake update<span class="sb">`</span> to update
./build/bin/mathport config.oneshot.json Oneshot::main &gt;&gt; Logs/oneshot.out <span class="m">2</span>&gt; &gt;<span class="o">(</span>tee -a Logs/oneshot.err &gt;<span class="p">&amp;</span><span class="m">2</span><span class="o">)</span>
bash: line <span class="m">1</span>: Logs/oneshot.out: No such file or directory
make: *** <span class="o">[</span>Makefile:127: Outputs/src/oneshot/Oneshot/Main.lean<span class="o">]</span> Error <span class="m">1</span>
</code></pre></div>
<p>I've done <code>lake build</code> and <code>make lean3-predata</code> beforehand. Any idea what's wrong?</p>



<a name="315519718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315519718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315519718">(Dec 13 2022 at 06:26)</a>:</h4>
<p><code>mkdir -p Logs/</code> first should help</p>



<a name="315519739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315519739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315519739">(Dec 13 2022 at 06:27)</a>:</h4>
<p>It would get created automatically by some of the other targets, but not this one</p>



<a name="315519935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315519935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315519935">(Dec 13 2022 at 06:28)</a>:</h4>
<p>ah thanks! i did mkdir the  <code>Logs</code> at some point but I guess there were other issues at that point, and now that really is the problem/solution.</p>



<a name="315520447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315520447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315520447">(Dec 13 2022 at 06:32)</a>:</h4>
<p>Mmh, I put <a href="https://github.com/leanprover-community/mathlib/blob/e64d8a5bffaef322a12ddb9240fc6c399846f683/src/combinatorics/quiver/symmetric.lean">this file</a> in <code>main.lean</code> and nothing in the <code>Oneshot.lean</code> part and got: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">./</span><span class="n">build</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">mathport</span> <span class="n">config.oneshot.json</span> <span class="n">Oneshot</span><span class="o">::</span><span class="n">main</span> <span class="bp">&gt;&gt;</span> <span class="n">Logs</span><span class="bp">/</span><span class="n">oneshot.out</span> <span class="mi">2</span><span class="bp">&gt;</span> <span class="bp">&gt;</span><span class="o">(</span><span class="n">tee</span> <span class="bp">-</span><span class="n">a</span> <span class="n">Logs</span><span class="bp">/</span><span class="n">oneshot.err</span> <span class="bp">&gt;&amp;</span><span class="mi">2</span><span class="o">)</span>
<span class="n">porting</span> <span class="n">Main</span>
<span class="n">uncaught</span> <span class="n">exception</span><span class="o">:</span> <span class="o">[</span><span class="n">resolveMod3</span><span class="o">]</span> <span class="n">failed</span> <span class="n">to</span> <span class="n">resolve</span> <span class="bp">'</span><span class="n">combinatorics.quiver.basic'</span>
<span class="n">make</span><span class="o">:</span> <span class="bp">***</span> <span class="o">[</span><span class="n">Makefile</span><span class="o">:</span><span class="mi">127</span><span class="o">:</span> <span class="n">Outputs</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">oneshot</span><span class="bp">/</span><span class="n">Oneshot</span><span class="bp">/</span><span class="n">Main.lean</span><span class="o">]</span> <span class="n">Error</span> <span class="mi">1</span>
</code></pre></div>
<p>Should I synchronize manually or something?</p>



<a name="315526518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315526518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315526518">(Dec 13 2022 at 07:28)</a>:</h4>
<p>you need to get the mathlib release data if you want to import mathlib files</p>



<a name="315526541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315526541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315526541">(Dec 13 2022 at 07:28)</a>:</h4>
<p><code>./download-release.sh nightly-YYYY-MM-DD</code></p>



<a name="315526638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315526638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315526638">(Dec 13 2022 at 07:29)</a>:</h4>
<p>Thanks! how do I know which release I want?</p>



<a name="315526741"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315526741" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315526741">(Dec 13 2022 at 07:30)</a>:</h4>
<p>either that or compile them yourself:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">./</span><span class="n">build</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">mathport</span> <span class="c1">--make config.json Mathbin::combinatorics.quiver.basic &gt;&gt; Logs/mathport.out</span>
</code></pre></div>



<a name="315526792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315526792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315526792">(Dec 13 2022 at 07:30)</a>:</h4>
<p>I just get yesterday's release</p>



<a name="315526900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315526900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315526900">(Dec 13 2022 at 07:31)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathport/tags">https://github.com/leanprover-community/mathport/tags</a></p>



<a name="315526923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315526923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315526923">(Dec 13 2022 at 07:31)</a>:</h4>
<p>oh, the syntax might have changed since they are now more than nightly</p>



<a name="315527027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315527027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315527027">(Dec 13 2022 at 07:32)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">r</span><span class="bp">@</span><span class="n">pc</span><span class="bp">-</span><span class="mi">60</span> <span class="bp">~/</span><span class="n">P</span><span class="bp">/</span><span class="n">mathport</span> <span class="o">(</span><span class="n">master</span><span class="o">)</span> <span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="bp">&gt;</span>

                                   <span class="bp">./</span><span class="n">download</span><span class="bp">-</span><span class="n">release.sh</span> <span class="n">nightly</span><span class="bp">-</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">12</span><span class="bp">-</span><span class="mi">12</span>

<span class="bp">+</span> <span class="bp">./</span><span class="n">download</span><span class="bp">-</span><span class="n">ported.sh</span> <span class="n">nightly</span><span class="bp">-</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">12</span><span class="bp">-</span><span class="mi">12</span>
<span class="bp">+</span> <span class="n">mkdir</span> <span class="bp">-</span><span class="n">p</span> <span class="n">Outputs</span><span class="bp">/</span><span class="n">oleans</span><span class="bp">/</span><span class="n">leanbin</span><span class="bp">/</span>
<span class="bp">+</span> <span class="n">pushd</span> <span class="n">Outputs</span><span class="bp">/</span><span class="n">oleans</span><span class="bp">/</span><span class="n">leanbin</span><span class="bp">/</span>
<span class="bp">~/</span><span class="n">Projects</span><span class="bp">/</span><span class="n">mathport</span><span class="bp">/</span><span class="n">Outputs</span><span class="bp">/</span><span class="n">oleans</span><span class="bp">/</span><span class="n">leanbin</span> <span class="bp">~/</span><span class="n">Projects</span><span class="bp">/</span><span class="n">mathport</span>
<span class="bp">+</span> <span class="n">curl</span> <span class="bp">-</span><span class="n">L</span> <span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">github.com</span><span class="bp">/</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">mathport</span><span class="bp">/</span><span class="n">releases</span><span class="bp">/</span><span class="n">download</span><span class="bp">/</span><span class="n">nightly</span><span class="bp">-</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">12</span><span class="bp">-</span><span class="mi">12</span><span class="bp">/</span><span class="n">lean3</span><span class="bp">-</span><span class="n">binport.tar.gz</span>
<span class="bp">+</span> <span class="n">tar</span> <span class="n">xz</span>
  <span class="bp">%</span> <span class="n">Total</span>    <span class="bp">%</span> <span class="n">Received</span> <span class="bp">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>     <span class="mi">9</span>  <span class="mi">100</span>     <span class="mi">9</span>    <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">45</span>      <span class="mi">0</span> <span class="c1">--:--:-- --:--:-- --:--:--    46</span>

<span class="n">gzip</span><span class="o">:</span> <span class="n">stdin</span><span class="o">:</span> <span class="n">not</span> <span class="k">in</span> <span class="n">gzip</span> <span class="n">format</span>
<span class="n">tar</span><span class="o">:</span> <span class="n">Child</span> <span class="n">returned</span> <span class="n">status</span> <span class="mi">1</span>
<span class="n">tar</span><span class="o">:</span> <span class="n">Error</span> <span class="n">is</span> <span class="n">not</span> <span class="n">recoverable</span><span class="o">:</span> <span class="n">exiting</span> <span class="n">now</span>
</code></pre></div>



<a name="315527033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315527033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315527033">(Dec 13 2022 at 07:32)</a>:</h4>
<p>let me see</p>



<a name="315527073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315527073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315527073">(Dec 13 2022 at 07:32)</a>:</h4>
<p>you should pick a name that shows up on that list</p>



<a name="315527135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315527135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315527135">(Dec 13 2022 at 07:33)</a>:</h4>
<p>(it would be nice if <code>download-release</code> just automatically got the latest version)</p>



<a name="315527202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315527202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315527202">(Dec 13 2022 at 07:33)</a>:</h4>
<p>I get the same error with <code>predata-nightly-2022-12-13-01</code></p>



<a name="315528001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315528001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315528001">(Dec 13 2022 at 07:40)</a>:</h4>
<p>OK, let me recap the process to get Oneshot running:</p>
<ol>
<li>
<p>Clone <code>https://github.com/leanprover-community/mathport/</code><br>
<code>
   git clone https://github.com/leanprover-community/mathport/
   </code></p>
</li>
<li>
<p>get in the folder:<br>
<code>
   cd mathport
   </code></p>
</li>
<li>
<p>I had to install <code>cmake</code> and <code>gmp</code> <br>
<code>
   sudo dnf install cmake gmp gmp-devel
   </code></p>
</li>
<li>
<p>Run <code>make build</code></p>
</li>
<li>Run <code>make lean3-predata</code></li>
<li>Get a mathport release with <code>./download_release $my_choice</code>.</li>
<li>Modify the <code>Oneshot/lean3-in/main.lean</code> file to my wishes.</li>
<li>Run <code>make oneshot</code></li>
</ol>



<a name="315529730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315529730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315529730">(Dec 13 2022 at 07:54)</a>:</h4>
<p>I see the URL for <code>mathlib-predata</code> is </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">github.com</span><span class="bp">/</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">mathport</span><span class="bp">/</span><span class="n">releases</span><span class="bp">/</span><span class="n">download</span><span class="bp">/</span><span class="n">predata</span><span class="bp">-</span><span class="n">nightly</span><span class="bp">-</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">12</span><span class="bp">-</span><span class="mi">13</span><span class="bp">-</span><span class="mi">01</span><span class="bp">/</span><span class="n">mathlib3</span><span class="bp">-</span><span class="n">predata.tar.gz</span>
</code></pre></div>
<p>while the script tries to get</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">github.com</span><span class="bp">/</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">mathport</span><span class="bp">/</span><span class="n">releases</span><span class="bp">/</span><span class="n">download</span><span class="bp">/</span><span class="n">predata</span><span class="bp">-</span><span class="n">nightly</span><span class="bp">-</span><span class="mi">2022</span><span class="bp">-</span><span class="mi">12</span><span class="bp">-</span><span class="mi">13</span><span class="bp">-</span><span class="mi">01</span><span class="bp">/</span><span class="n">lean3</span><span class="bp">-</span><span class="n">binport.tar.gz</span>
</code></pre></div>
<p>is that what's going wrong?</p>



<a name="315530655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315530655" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315530655">(Dec 13 2022 at 08:01)</a>:</h4>
<p>No these are different things. e.g. the most recent mathport output appears to be <a href="https://github.com/leanprover-community/mathport/releases/tag/nightly-2022-12-13-04">https://github.com/leanprover-community/mathport/releases/tag/nightly-2022-12-13-04</a></p>



<a name="315530918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315530918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315530918">(Dec 13 2022 at 08:03)</a>:</h4>
<p>Ah, I just chose wrong!</p>



<a name="315530937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315530937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315530937">(Dec 13 2022 at 08:03)</a>:</h4>
<p>For <code>download_release.sh</code> I think you should use one of those version strings e.g. <code>nightly-2022-12-13-04</code> (one without <code>predata</code>).</p>



<a name="315531110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531110">(Dec 13 2022 at 08:05)</a>:</h4>
<p>Don't know why github lists the "releases" in an unhelpful order</p>



<a name="315531223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531223">(Dec 13 2022 at 08:05)</a>:</h4>
<p>how did you find the correct one to use?</p>



<a name="315531305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531305">(Dec 13 2022 at 08:06)</a>:</h4>
<p>because choosing <code>nightly-2022-12-13-01</code>, which I see at the top of the <code>tag</code> page, does not work</p>



<a name="315531358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531358">(Dec 13 2022 at 08:06)</a>:</h4>
<p>I used the "Next" button.</p>



<a name="315531375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531375">(Dec 13 2022 at 08:07)</a>:</h4>
<p>Are you sure you don't see <code>predata-nightly-2022-12-13-01</code>?</p>



<a name="315531399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531399">(Dec 13 2022 at 08:07)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">r</span><span class="bp">@</span><span class="n">pc</span><span class="bp">-</span><span class="mi">60</span> <span class="bp">~/</span><span class="n">P</span><span class="bp">/</span><span class="n">mathport</span> <span class="o">(</span><span class="n">master</span><span class="o">)</span><span class="bp">&gt;</span> <span class="n">make</span> <span class="n">oneshot</span>
<span class="bp">./</span><span class="n">build</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">mathport</span> <span class="n">config.oneshot.json</span> <span class="n">Oneshot</span><span class="o">::</span><span class="n">main</span> <span class="bp">&gt;&gt;</span> <span class="n">Logs</span><span class="bp">/</span><span class="n">oneshot.out</span> <span class="mi">2</span><span class="bp">&gt;</span> <span class="bp">&gt;</span><span class="o">(</span><span class="n">tee</span> <span class="bp">-</span><span class="n">a</span> <span class="n">Logs</span><span class="bp">/</span><span class="n">oneshot.err</span> <span class="bp">&gt;&amp;</span><span class="mi">2</span><span class="o">)</span>
<span class="n">porting</span> <span class="n">Main</span>
<span class="bp">#</span> <span class="n">output</span> <span class="n">is</span> <span class="k">in</span> <span class="n">Outputs</span><span class="bp">/</span><span class="n">src</span><span class="bp">/</span><span class="n">oneshot</span><span class="bp">/</span><span class="n">Oneshot</span><span class="bp">/</span><span class="n">Main.lean</span>
</code></pre></div>



<a name="315531524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531524">(Dec 13 2022 at 08:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/315531375">said</a>:</p>
<blockquote>
<p>Are you sure you don't see <code>predata-nightly-2022-12-13-01</code>?</p>
</blockquote>
<p>Ah, I do, actually. I thought I just had to <strong>strip</strong> the <code>predata</code> part!</p>



<a name="315531538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531538">(Dec 13 2022 at 08:08)</a>:</h4>
<p>I'm not sure what you need to download specifically for Oneshot to work, but the <code>predata-</code> ones should be used with <code>download-predata.sh</code> and the others with <code>download-release.sh</code></p>



<a name="315531606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531606">(Dec 13 2022 at 08:08)</a>:</h4>
<p>You need to download any release which is compatible with the mathlib4 version used to compile mathport</p>



<a name="315531773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531773">(Dec 13 2022 at 08:10)</a>:</h4>
<p>Ahh I think github is basing the release "date" on the git commit of mathport itself, so it doesn't realize that newer releases (which are based on more recent versions of mathlib) are better, and should be shown on the first page</p>



<a name="315531776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531776">(Dec 13 2022 at 08:10)</a>:</h4>
<p>incompatibilities usually manifest as an error saying that the mathport environment could not be loaded because some definition already exists</p>



<a name="315531885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315531885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315531885">(Dec 13 2022 at 08:11)</a>:</h4>
<p>I was just about to push a fix to download-release which uses the github API to get the releases and takes the last one, but this is yielding <code>nightly-2022-12-13-01</code> so it sounds like it is not correct</p>



<a name="315532139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315532139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315532139">(Dec 13 2022 at 08:13)</a>:</h4>
<p><code>predata-nightly-2022-12-13-01</code> is the most recent one of those</p>



<a name="315532707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315532707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315532707">(Dec 13 2022 at 08:17)</a>:</h4>
<p><span class="user-mention" data-user-id="461830">@Rémi Bottinelli</span> Just checking, you're not doing this for the mathlib port, are you?  If you want to port a mathlib file, the mathport output is already available at <br>
<a href="https://github.com/leanprover-community/mathlib3port/tree/master/Mathbin">https://github.com/leanprover-community/mathlib3port/tree/master/Mathbin</a></p>



<a name="315532890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315532890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315532890">(Dec 13 2022 at 08:19)</a>:</h4>
<p>I want to port a PR that I made and that got in conflict with some port first.<br>
But then, that's good info: If I want to port an existing file (in master), I can just start with your link (?)</p>



<a name="315533047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315533047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315533047">(Dec 13 2022 at 08:20)</a>:</h4>
<p>ok it's now getting <code>nightly-2022-12-13-04</code> via</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">curl</span> <span class="bp">-</span><span class="n">H</span> <span class="s2">"Accept: application/vnd.github+json"</span> <span class="bp">-</span><span class="n">H</span> <span class="s2">"X-GitHub-Api-Version: 2022-11-28"</span> <span class="bp">\</span>
  <span class="n">https</span><span class="o">:</span><span class="bp">//</span><span class="n">api.github.com</span><span class="bp">/</span><span class="n">repos</span><span class="bp">/</span><span class="n">leanprover</span><span class="bp">-</span><span class="n">community</span><span class="bp">/</span><span class="n">mathport</span><span class="bp">/</span><span class="n">releases</span> <span class="bp">\</span>
<span class="bp">|</span> <span class="n">jq</span> <span class="bp">'</span><span class="n">last</span><span class="o">([</span><span class="bp">.</span><span class="o">[]</span><span class="bp">.</span><span class="n">tag_name</span> <span class="bp">|</span> <span class="n">select</span><span class="o">(</span><span class="n">startswith</span><span class="o">(</span><span class="s2">"nightly-"</span><span class="o">))]</span> <span class="bp">|</span> <span class="n">sort</span> <span class="bp">|</span> <span class="bp">.</span><span class="o">[])</span><span class="bp">'</span> <span class="bp">-</span><span class="n">r</span>
</code></pre></div>



<a name="315534640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315534640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315534640">(Dec 13 2022 at 08:30)</a>:</h4>
<p>So I can update my recap with just <code>./download_release</code> ?</p>



<a name="315536379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/315536379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#315536379">(Dec 13 2022 at 08:40)</a>:</h4>
<p>yes</p>



<a name="318848895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/318848895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#318848895">(Jan 01 2023 at 12:04)</a>:</h4>
<p>Can we add some instructions on how to use oneshot on the porting wiki, <a href="https://github.com/leanprover-community/mathlib4/wiki/Porting-wiki">https://github.com/leanprover-community/mathlib4/wiki/Porting-wiki</a>?</p>



<a name="318849302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/318849302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#318849302">(Jan 01 2023 at 12:07)</a>:</h4>
<p>In particular, it would be great if there were a streamlined process for "get the mathport output for a mathlib3 PR"</p>



<a name="318849549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/318849549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#318849549">(Jan 01 2023 at 12:09)</a>:</h4>
<p>Note that I tried to improve the documentation of oneshot in <a href="https://github.com/leanprover-community/mathport/pull/213">https://github.com/leanprover-community/mathport/pull/213</a> but that PR is somehow stuck because I don't understand Mario's suggestion.</p>



<a name="318849936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/318849936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#318849936">(Jan 01 2023 at 12:12)</a>:</h4>
<p>I just pushed a fix that I think addressed Mario's comment; your list was <code>1, 2, 3, 5, 6, 7, 8</code> with no 4.</p>



<a name="318853720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/318853720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#318853720">(Jan 01 2023 at 12:46)</a>:</h4>
<p>I understood the numbering thing (although I think it would have rendered correctly). But my impression was that Mario also meant something else.</p>



<a name="318906760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/318906760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#318906760">(Jan 01 2023 at 21:19)</a>:</h4>
<p>no, that's what I meant</p>



<a name="319234665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/319234665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#319234665">(Jan 03 2023 at 16:42)</a>:</h4>
<p>Failure of the day:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>mkdir -p Logs/
./build/bin/mathport config.oneshot.json Oneshot::main &gt;&gt; Logs/oneshot.out 2&gt; &gt;(tee -a Logs/oneshot.err &gt;&amp;2)
porting Main
uncaught exception: failed to port Oneshot:Main with imports [Leanbin.Init.Default, Oneshot]:
import Leanbin.Init.Data.Nat.Lemmas failed, environment already contains 'Nat.findX' from Mathlib.Init.Data.Nat.Lemmas
make: *** [Makefile:134: Outputs/src/oneshot/Oneshot/Main.lean] Error 1
</code></pre></div>



<a name="319234755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/319234755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#319234755">(Jan 03 2023 at 16:42)</a>:</h4>
<p>Any idea about this?</p>



<a name="319256207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/319256207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#319256207">(Jan 03 2023 at 18:34)</a>:</h4>
<p>My first guess is mismatched Lean/std4/etc. versions.  You need to have the same mathport commit (which fixes the dependencies) as the release.</p>



<a name="319678206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/319678206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#319678206">(Jan 05 2023 at 21:46)</a>:</h4>
<p>omg it worked!</p>



<a name="319678234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/319678234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#319678234">(Jan 05 2023 at 21:46)</a>:</h4>
<p>It would be nice if it took less than 45 minutes to get a working setup</p>



<a name="319678973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/319678973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#319678973">(Jan 05 2023 at 21:51)</a>:</h4>
<p>... I wasn't supposed to <code>rm -rf Outputs/</code>, was I.</p>



<a name="320022009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022009">(Jan 08 2023 at 00:56)</a>:</h4>
<p>Has anyone seen the following oneshot error before?  This is my first time trying it.</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>% make oneshot
cd Oneshot/lean3-in &amp;&amp; elan override set `cat ../../sources/mathlib/leanpkg.toml | grep lean_version | cut -d '"' -f2`
cat: ../../sources/mathlib/leanpkg.toml: No such file or directory
error: The following required arguments were not provided:
    &lt;toolchain&gt;

USAGE:
    elan override set &lt;toolchain&gt;

For more information try --help
</code></pre></div>



<a name="320022525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022525">(Jan 08 2023 at 01:03)</a>:</h4>
<p>That message suggests that <code>sources/mathlib</code> doesn't exist or doesn't have a <code>leanpkg.toml</code> file</p>



<a name="320022604"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022604" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022604">(Jan 08 2023 at 01:04)</a>:</h4>
<p>you have to run <code>./download-release.sh</code> to get a download of mathlib3 first</p>



<a name="320022648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022648">(Jan 08 2023 at 01:05)</a>:</h4>
<p>It would be great if we could setup a gitpod or something that had everything setup in a way that Just Works; but maybe there's too much configuration for that to make sense</p>



<a name="320022674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022674">(Jan 08 2023 at 01:05)</a>:</h4>
<p>oh, that would be nice</p>



<a name="320022698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022698">(Jan 08 2023 at 01:05)</a>:</h4>
<p>there is a lot of downloading but not a lot of (mandatory) configuration</p>



<a name="320022777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022777">(Jan 08 2023 at 01:06)</a>:</h4>
<p>I don't know whether that belongs in <a href="https://github.com/leanprover-community/mathlib4/pull/1419">the gitpod config for mathlib4</a>, or maybe in the mathport repo instead</p>



<a name="320022812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022812">(Jan 08 2023 at 01:07)</a>:</h4>
<p>I would put it in the mathport repo</p>



<a name="320022838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022838">(Jan 08 2023 at 01:07)</a>:</h4>
<p>It's possible to set up gitpod to open multiple repos in single workspace, if that's at all useful</p>



<a name="320022844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320022844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320022844">(Jan 08 2023 at 01:07)</a>:</h4>
<p><span class="user-mention" data-user-id="260507">@Heather Macbeth</span> Did you follow the directions at <a href="https://github.com/leanprover-community/mathport/tree/master/Oneshot">https://github.com/leanprover-community/mathport/tree/master/Oneshot</a> ? We may need to make adjustments if the directions don't work</p>



<a name="320023410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023410">(Jan 08 2023 at 01:15)</a>:</h4>
<p>I did follow the directions.  And this is correct:</p>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/287929-mathlib4/topic/Mathport.20oneshot/near/320022525">said</a>:</p>
<blockquote>
<p>That message suggests that <code>sources/mathlib</code> doesn't exist or doesn't have a <code>leanpkg.toml</code> file</p>
</blockquote>



<a name="320023469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023469">(Jan 08 2023 at 01:16)</a>:</h4>
<p>Earlier I had got this:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>% ./download-release.sh
./download-release.sh: line 11: jq: command not found
</code></pre></div>



<a name="320023491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023491">(Jan 08 2023 at 01:17)</a>:</h4>
<p>But later I tried this and it seemed to work:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>% ./download-release.sh nightly-2022-12-13-04
getting release nightly-2022-12-13-04
+ ./download-ported.sh nightly-2022-12-13-04
+ mkdir -p Outputs/oleans/leanbin/
+ pushd Outputs/oleans/leanbin/
[... tons more stuff ...]
</code></pre></div>



<a name="320023673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023673">(Jan 08 2023 at 01:19)</a>:</h4>
<p>aha, you don't have <code>jq</code></p>



<a name="320023702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023702">(Jan 08 2023 at 01:20)</a>:</h4>
<p>are you on a debian such that you can follow the <code>sudo apt ...</code> install instructions?</p>



<a name="320023751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023751">(Jan 08 2023 at 01:20)</a>:</h4>
<p>mac</p>



<a name="320023768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023768">(Jan 08 2023 at 01:20)</a>:</h4>
<p>hm, we need something similar for macs</p>



<a name="320023793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023793">(Jan 08 2023 at 01:20)</a>:</h4>
<p><code>brew install jq</code>?</p>



<a name="320023828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320023828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320023828">(Jan 08 2023 at 01:21)</a>:</h4>
<p>even if you can get the release by specifying it directly, <code>jq</code> is used later in the oneshot script so you will probably want to get it</p>



<a name="320024028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20oneshot/near/320024028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20oneshot.html#320024028">(Jan 08 2023 at 01:24)</a>:</h4>
<p>OK, <code>./download_release.sh</code> seems to be doing something now.  Thanks!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>