---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/by.20.7B.20.7D.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html">by { }</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="313714736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313714736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313714736">(Dec 03 2022 at 17:22)</a>:</h4>
<p>What's the equivalent of one-line <code>by { }</code> proofs?</p>



<a name="313714793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313714793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313714793">(Dec 03 2022 at 17:23)</a>:</h4>
<p>just leave out the braces?</p>



<a name="313714805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313714805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313714805">(Dec 03 2022 at 17:23)</a>:</h4>
<p><code>by X; Y &lt;;&gt; Z</code></p>



<a name="313714813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313714813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313714813">(Dec 03 2022 at 17:23)</a>:</h4>
<p>And use <code>;</code></p>



<a name="313714937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313714937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313714937">(Dec 03 2022 at 17:24)</a>:</h4>
<p>Not a MWE but is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">refine'</span> <span class="o">⟨</span><span class="k">fun</span> <span class="n">h</span> <span class="bp">↦</span> <span class="n">_</span><span class="o">,</span> <span class="kd">by</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">rfl</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span><span class="bp">;</span> <span class="n">refl</span><span class="o">⟩</span>
</code></pre></div>
<p>supposed to work?</p>



<a name="313715424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715424">(Dec 03 2022 at 17:29)</a>:</h4>
<p>Seems syntactically valid.</p>



<a name="313715702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715702">(Dec 03 2022 at 17:31)</a>:</h4>
<p>Fails in <a href="https://github.com/leanprover-community/mathlib4/pull/840">mathlib4#840</a> but you're welcome to prove me wrong!</p>



<a name="313715735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715735">(Dec 03 2022 at 17:31)</a>:</h4>
<p>It was a different problem.</p>



<a name="313715744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715744">(Dec 03 2022 at 17:31)</a>:</h4>
<p>simpa has changed behaviour slightly, I've pushed a fix</p>



<a name="313715804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715804">(Dec 03 2022 at 17:32)</a>:</h4>
<p>Note <code>A; B</code> no longer means "do B to all goals from A"</p>



<a name="313715806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715806">(Dec 03 2022 at 17:32)</a>:</h4>
<p>for that you need <code>&lt;;&gt;</code></p>



<a name="313715873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715873">(Dec 03 2022 at 17:33)</a>:</h4>
<p>Then, the other change is that <code>simpa using h</code> will fail it if simplifies <code>h</code> to <code>False</code>. You have to change this just to <code>simp at h</code>.</p>



<a name="313715883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715883">(Dec 03 2022 at 17:33)</a>:</h4>
<p>Yeah, I thought so too, so I tried <code>; ... &lt;:&gt;</code>, but you did <code>&lt;;&gt; ... ;</code> instead?</p>



<a name="313715922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313715922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313715922">(Dec 03 2022 at 17:33)</a>:</h4>
<p>Wait sorry, why does simplifying it to <code>False</code> make it fail?</p>



<a name="313716010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716010">(Dec 03 2022 at 17:34)</a>:</h4>
<p>In  your case, the <code>simpa using h</code> was doing something pretty weird: there were two goals open. It killed the first one during the <code>simp at h</code> stage, and then tried <code>exact h</code> on the second goal, but by then <code>h</code> wasn't in scope anymore (rather: there was an <code>h</code> in scope, but a different one)</p>



<a name="313716044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716044">(Dec 03 2022 at 17:34)</a>:</h4>
<p>Because if <code>simp at h</code> reduces <code>h</code> to <code>False</code> it will immediately close the goal.</p>



<a name="313716076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716076">(Dec 03 2022 at 17:34)</a>:</h4>
<p>and <code>simpa</code> is currently not smart enough to realise it shouldn't try assumption.</p>



<a name="313716113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716113">(Dec 03 2022 at 17:35)</a>:</h4>
<p>This should be fixed; someone needs to make a PR to <code>std</code>, where <code>simpa</code> now lives.</p>



<a name="313716219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716219">(Dec 03 2022 at 17:36)</a>:</h4>
<p>(The reason I knew something weird was happening with the goals was that the error message had a tombstone next to the h, indicating it wasn't the <code>h</code> I thought it was.)</p>



<a name="313716223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716223">(Dec 03 2022 at 17:36)</a>:</h4>
<p>That calls for more questions than it answers :^)</p>
<ol>
<li>Haven't we fixed the fact that <code>simpa</code> doesn't focus on one goal?</li>
<li>Can't we use the same name for different hypotheses through goals anymore? I thought it was a great, if not hacky, feature, as that means you can run the same proof in parallel when doing a case bash.</li>
</ol>



<a name="313716274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716274">(Dec 03 2022 at 17:37)</a>:</h4>
<p><del>Oh I guess that answers 1</del> actually no, we are talking about different things. But I still don't see why the <code>h</code> in the second goal was a different <code>h</code>. It was introduced with the same lambda.</p>



<a name="313716457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716457">(Dec 03 2022 at 17:38)</a>:</h4>
<p>sort of... :-) There are two different <code>h</code>s here. When you use <code>&lt;;&gt;</code> it correctly uses the correct <code>h</code> in each branch of the proof (see the fix I pushed). However when <code>simpa using h</code> did something wonky switching from one goal to another, Lean correctly detected that it was talking about the wrong <code>h</code>!</p>



<a name="313716497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313716497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313716497">(Dec 03 2022 at 17:39)</a>:</h4>
<p>There's certainly a problem in <code>simpa</code>, but Lean 4 handled the bad instructions it received well.</p>



<a name="313754706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313754706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313754706">(Dec 04 2022 at 02:10)</a>:</h4>
<p>Oh, I had some recent fixes to <code>simpa</code> but apparently they weren't pushed. Is there a MWE for the issue you folks are talking about so I can see if this issue has already been fixed?</p>



<a name="313754833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313754833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313754833">(Dec 04 2022 at 02:12)</a>:</h4>
<p>(It appears I can't even look at the original PR, since it was force-pushed away. Please don't do that to issues which have been permalinked to zulip.)</p>



<a name="313755079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313755079" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313755079">(Dec 04 2022 at 02:16)</a>:</h4>
<p>Yes you can. I just force-pushed over Ruben's fix as I had a better fix in local, but the first commit still has the error mentioned here.</p>



<a name="313755543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313755543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313755543">(Dec 04 2022 at 02:23)</a>:</h4>
<p>can you please MWE it?</p>



<a name="313755673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313755673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313755673">(Dec 04 2022 at 02:25)</a>:</h4>
<p>I don't even see <code>simpa</code> in the code</p>



<a name="313756178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313756178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313756178">(Dec 04 2022 at 02:33)</a>:</h4>
<p>Actually, reading Scott's description of the issue I'm pretty sure it's exactly what I was trying to fix, so I think I'll just leave it at that.</p>



<a name="313790271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/by%20%7B%20%7D/near/313790271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/by.20.7B.20.7D.html#313790271">(Dec 04 2022 at 10:37)</a>:</h4>
<p>Ah sorry, actually Scott answered <a href="https://github.com/leanprover-community/mathlib/pull/839">#839</a> on this thread that was about <a href="https://github.com/leanprover-community/mathlib/pull/840">#840</a>. <a href="https://github.com/leanprover-community/mathlib/pull/839">#839</a> is where the failing <code>simpa</code> is.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>