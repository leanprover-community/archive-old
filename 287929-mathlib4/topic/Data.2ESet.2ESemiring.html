---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html">Data.Set.Semiring</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="321147269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321147269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321147269">(Jan 13 2023 at 12:22)</a>:</h4>
<p>The <a href="https://math.commelin.net/files/port_status.html">#port-status</a> page says <code>data.set.semiring</code> is ready to be ported, but we are missing <code>Mathlib.Data.Set.Pointwise.Smul</code> (the only import in mathlib3). Is this a bug?</p>



<a name="321147431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321147431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321147431">(Jan 13 2023 at 12:23)</a>:</h4>
<p>Sorry, it's there.</p>



<a name="321147599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321147599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321147599">(Jan 13 2023 at 12:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> has marked this topic as resolved.</p>



<a name="321149728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321149728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321149728">(Jan 13 2023 at 12:35)</a>:</h4>
<p>I guess you noticed it's called SMul now</p>



<a name="321153225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321153225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Notification Bot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321153225">(Jan 13 2023 at 12:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> has marked this topic as unresolved.</p>



<a name="321153586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321153586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321153586">(Jan 13 2023 at 12:54)</a>:</h4>
<p>This file essentially only contains results like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[simp]</span>
<span class="kn">protected</span> <span class="kd">theorem</span> <span class="n">down_up</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">s.up.down</span> <span class="bp">=</span> <span class="n">s</span> <span class="o">:=</span>
  <span class="n">rfl</span>
<span class="bp">#</span><span class="n">align</span> <span class="n">set_semiring.down_up</span> <span class="n">SetSemiring.down_up</span>
</code></pre></div>
<p>This now doesn't work because of dot notation. This works</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[simp]</span>
<span class="kn">protected</span> <span class="kd">theorem</span> <span class="n">down_up</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">Set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">SetSemiring.down</span> <span class="o">(</span><span class="n">Set.up</span> <span class="n">s</span><span class="o">)</span> <span class="bp">=</span> <span class="n">s</span> <span class="o">:=</span>
  <span class="n">rfl</span>
<span class="bp">#</span><span class="n">align</span> <span class="n">set_semiring.down_up</span> <span class="n">SetSemiring.down_up</span>
</code></pre></div>
<p>Is there a way of making dot notation working again? Note that <code>SetSemiring.down</code> is protected, so it is really annoying to use.</p>



<a name="321153823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321153823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321153823">(Jan 13 2023 at 12:55)</a>:</h4>
<p>Oh, while you're on this file, let me know that some statements do not elaborate the way we want them to.</p>



<a name="321153909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321153909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321153909">(Jan 13 2023 at 12:56)</a>:</h4>
<p>I tried fixing them, to no avail</p>



<a name="321162740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321162740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321162740">(Jan 13 2023 at 13:35)</a>:</h4>
<p>There is one error in <code>instance [CommMonoid α] : CanonicallyOrderedCommSemiring (SetSemiring α)</code> coming from the fact that in <code>NoZeroDivisors</code> we have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">eq_zero_or_eq_zero_of_mul_eq_zero</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">M₀</span><span class="o">},</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span>
</code></pre></div>
<p>while in <code>CanonicallyOrderedCommSemiring</code> it's</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="kn">protected</span> <span class="n">eq_zero_or_eq_zero_of_mul_eq_zero</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span>
</code></pre></div>
<p>It's easy to fix, but I am curious why this wasn't a problem in mathlib3.</p>



<a name="321163287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321163287" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321163287">(Jan 13 2023 at 13:37)</a>:</h4>
<p>lean4 eagerly intros implicit args</p>



<a name="321163602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321163602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321163602">(Jan 13 2023 at 13:39)</a>:</h4>
<p>or it could be a protected attr issue where in one case it has it, in the other it doesn't. What's the error?</p>



<a name="321163733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321163733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321163733">(Jan 13 2023 at 13:39)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span>
  <span class="n">eq_zero_or_eq_zero_of_mul_eq_zero</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="bp">?</span><span class="n">m.16230</span> <span class="bp">*</span> <span class="bp">?</span><span class="n">m.16231</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">→</span> <span class="bp">?</span><span class="n">m.16230</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="bp">?</span><span class="n">m.16231</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="kt">Prop</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">SetSemiring</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∨</span> <span class="n">b</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:</span> <span class="kt">Prop</span>
</code></pre></div>
<p>so it seems because of the implict variables.</p>



<a name="321163756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321163756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321163756">(Jan 13 2023 at 13:39)</a>:</h4>
<p>that's a implicit lambda issue</p>



<a name="321163911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321163911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321163911">(Jan 13 2023 at 13:40)</a>:</h4>
<p>It's solved by adding explictely (instead of getting it from <code>NoZeroDivisors</code>)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">eq_zero_or_eq_zero_of_mul_eq_zero</span> <span class="o">:=</span> <span class="k">fun</span> <span class="n">_</span> <span class="n">_</span> <span class="n">ab</span> <span class="bp">=&gt;</span> <span class="n">eq_zero_or_eq_zero_of_smul_eq_zero</span> <span class="n">ab</span>
</code></pre></div>



<a name="321163999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321163999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321163999">(Jan 13 2023 at 13:40)</a>:</h4>
<p>But I am wondering if we should use the same implicitness in both def</p>



<a name="321164008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321164008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321164008">(Jan 13 2023 at 13:40)</a>:</h4>
<p>Actually it's not about lambdas, that's a bug in lean 3, which normally introduces implicit variables in that situation</p>



<a name="321164113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321164113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321164113">(Jan 13 2023 at 13:41)</a>:</h4>
<p>It should be implicit in both places, I think</p>



<a name="321164226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321164226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321164226">(Jan 13 2023 at 13:41)</a>:</h4>
<p>Let me see what happens if I change it in mathlib3</p>



<a name="321164341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321164341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321164341">(Jan 13 2023 at 13:42)</a>:</h4>
<p>lean 3 will not introduce implicit variables when you reference a structure projection directly. If you make a wrapper, even if it has exactly the same binder info as the projection, it will not have the same behavior</p>



<a name="321166192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321166192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321166192">(Jan 13 2023 at 13:51)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/18167">#18167</a></p>
<p>I indeed had to modify</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">to_no_zero_divisors</span> <span class="o">:</span> <span class="n">no_zero_divisors</span> <span class="n">α</span> <span class="o">:=</span>
</code></pre></div>



<a name="321207895"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Set.Semiring/near/321207895" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2ESet.2ESemiring.html#321207895">(Jan 13 2023 at 16:49)</a>:</h4>
<p>mathlib3 seems happy, I've opened <a href="https://github.com/leanprover-community/mathlib4/pull/1545">#1545</a>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>