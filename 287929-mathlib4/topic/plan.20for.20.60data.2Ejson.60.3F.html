---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html">plan for `data.json`?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="313811981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/plan%20for%20%60data.json%60%3F/near/313811981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html#313811981">(Dec 04 2022 at 13:53)</a>:</h4>
<p>I would guess that instead of defining <code>exceptional</code> and <code>json_serializable</code>the plan is to use <code>FromJson</code> and <code>ToJson</code> from the lean core? </p>
<ul>
<li>Is that correct? </li>
<li>If so would it be useful to try to make this kind of port (or better to leave this for the core developers to put in Std say)?</li>
<li>If yes to the above, would it be better to define a single <code>FromToJson</code> class including both and "export" instances to the separate classes or to make pairs of instances while porting?</li>
</ul>



<a name="313814925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/plan%20for%20%60data.json%60%3F/near/313814925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html#313814925">(Dec 04 2022 at 14:19)</a>:</h4>
<p>I think probably the thing to do is forward-port the missing features from mathlib3 to lean4, rather than do a direct port</p>



<a name="313814952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/plan%20for%20%60data.json%60%3F/near/313814952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html#313814952">(Dec 04 2022 at 14:19)</a>:</h4>
<p>I wrote <a href="https://leanprover-community.github.io/mathlib_docs/find/json_serializable">docs#json_serializable</a> before I was aware that Lean4 had an implementation already</p>



<a name="313815156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/plan%20for%20%60data.json%60%3F/near/313815156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html#313815156">(Dec 04 2022 at 14:20)</a>:</h4>
<p>Backporting to Lean3 would also be quite reasonable</p>



<a name="313815233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/plan%20for%20%60data.json%60%3F/near/313815233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html#313815233">(Dec 04 2022 at 14:21)</a>:</h4>
<p>I don't understand your comment about <code>exceptional</code>; isn't <a href="https://leanprover-community.github.io/mathlib_docs/find/exceptional">docs#exceptional</a> just <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Except#doc">docs4#Except</a> ?</p>



<a name="313827124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/plan%20for%20%60data.json%60%3F/near/313827124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html#313827124">(Dec 04 2022 at 16:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F/near/313815233">said</a>:</p>
<blockquote>
<p>I don't understand your comment about <code>exceptional</code>; isn't <a href="https://leanprover-community.github.io/mathlib_docs/find/exceptional">docs#exceptional</a> just <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Except#doc">docs4#Except</a> ?</p>
</blockquote>
<p><code>mathlib3port</code> ported <code>exceptional</code>to a new monad I believe, so in that sense it is not <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Except#doc">docs4#Except</a>. But I assumed it is meant to be as you say.</p>



<a name="313827465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/plan%20for%20%60data.json%60%3F/near/313827465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html#313827465">(Dec 04 2022 at 16:04)</a>:</h4>
<p>Ah I see, <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Lean.FromJson#doc">docs4#Lean.FromJson</a> only allows string error messages, not <code>format!""</code> ones</p>



<a name="313827576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/plan%20for%20%60data.json%60%3F/near/313827576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/plan.20for.20.60data.2Ejson.60.3F.html#313827576">(Dec 04 2022 at 16:05)</a>:</h4>
<p>So <code>exceptional X</code> in Lean 3 is <code>Except (Lean.Options â†’ Std.Format) X</code> in Lean 4</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>