---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html">Linting standards for mathlib</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="310712205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310712205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310712205">(Nov 17 2022 at 22:34)</a>:</h4>
<p>A couple of questions about how happy we should make the linter:</p>
<ol>
<li>Should comments and docstrings both stick to the â‰¤ 100 character line limit? I'd imagine that we wouldn't want odd newlines appearing suddenly in docstrings (but rather let the dosctring-viewer handle word wrapping itself, since it'll likely display it in a proportional font, which can make newlines after 100 characters seem out of place), but I'm not sure.</li>
</ol>



<a name="310712446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310712446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310712446">(Nov 17 2022 at 22:36)</a>:</h4>
<p>No, <em>everything</em> is cut to 100 chars; this is the same as in mathlib3. The docstrings are formatted by doc-gen4, so it's not really an issue.</p>



<a name="310712512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310712512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310712512">(Nov 17 2022 at 22:36)</a>:</h4>
<ol start="2">
<li>I have a lot of definitions that only are to be used within the file. Should these also have a docstring to make the linter happy? Or should they be marked <code>private</code> or something like that?</li>
</ol>



<a name="310712547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310712547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310712547">(Nov 17 2022 at 22:37)</a>:</h4>
<p>As for the linter, you should make it perfectly happy always (* technically there are certain circumstances where it's okay to add a <code>nolint</code> attribute, but those are comparatively rare).</p>



<a name="310712562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310712562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310712562">(Nov 17 2022 at 22:37)</a>:</h4>
<p>(there is one exception to the line length limit, which is lines that contain a URL; those usually can't be line-broken and are excluded by the style linter)</p>



<a name="310712603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310712603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310712603">(Nov 17 2022 at 22:37)</a>:</h4>
<p>There's some special context here: I'm basing my current work off of an existing file in <code>Lean/Elab</code>, which doesn't have docstrings nor <code>private</code> declarations for most definitions. Also I've noticed several comments and docstrings (none of which contain a URL) in the source file that are &gt; 100 characters. Should those be changed?</p>



<a name="310712692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310712692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310712692">(Nov 17 2022 at 22:38)</a>:</h4>
<p>Leo has a giant monitor and does not observe the 100 character line length convention</p>



<a name="310712694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310712694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310712694">(Nov 17 2022 at 22:38)</a>:</h4>
<p>I don't think Lean 4 core has the same linting restrictions as Mathlib.</p>



<a name="310713390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310713390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310713390">(Nov 17 2022 at 22:43)</a>:</h4>
<p>Hmmm. Should I make sure my additions are lint-free and then somehow turn off the linter on this particular file, since it's a minimally-invasive modification of <code>StructInst.lean</code>in lean 4 core? Or should I wrangle its original contents into conformity?</p>



<a name="310713560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310713560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310713560">(Nov 17 2022 at 22:44)</a>:</h4>
<p>And, as part of this: how should I handle the missing docstrings on 95% of the function's existing definitions (which aren't used outside the file)?</p>



<a name="310713739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310713739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310713739">(Nov 17 2022 at 22:45)</a>:</h4>
<p>everything should be lint-free</p>



<a name="310713877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310713877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310713877">(Nov 17 2022 at 22:46)</a>:</h4>
<p>If it's intended as a modification to <code>StructInst.lean</code> then it should be a PR to core and then the linters don't matter</p>



<a name="310714543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310714543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310714543">(Nov 17 2022 at 22:51)</a>:</h4>
<p>Although note that some changes (not sure here!) that <em>could</em> go in core, should not, for sake of not using up core developer's bandwidth. mathlib4 is happy to take things in the meantime, but in that case wants complete lint compliance. :-)</p>



<a name="310716825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310716825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310716825">(Nov 17 2022 at 23:09)</a>:</h4>
<p>Ok! But, if we put it in mathlib in the meantime, with an eye towards putting it in core eventually...does that mean attaching a docstring to every function in this file without one (about 101 declarations), even though they're just used within the file and nowhere else?</p>
<p>Which, I mean, I guess I couldâ€”I understand it well enough by now! ðŸ˜… I just wonder if my mathlib-contribution time could be put to better use. (Or should I maybe attach an empty/copy-pasted docstring?)</p>



<a name="310716971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310716971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> YaÃ«l Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310716971">(Nov 17 2022 at 23:10)</a>:</h4>
<p>Only definitions <em>need</em> docstrings.</p>



<a name="310717045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310717045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310717045">(Nov 17 2022 at 23:11)</a>:</h4>
<p>Yes, but <code>#lint</code> tells me there are 101 of those in this file. <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="310717117"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310717117" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310717117">(Nov 17 2022 at 23:12)</a>:</h4>
<p>This file just defines a term elaborator, so all of its definitions only really go towards that. So if there's a way I can <code>private</code> them all or something...not sure if that would fix it anyway, though.</p>



<a name="310717159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310717159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> YaÃ«l Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310717159">(Nov 17 2022 at 23:12)</a>:</h4>
<p>Then you're in for a rough time <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="310718579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310718579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310718579">(Nov 17 2022 at 23:23)</a>:</h4>
<p>Hmm... I'm inclined to say it's still valuable, since of course core should have the doc-strings too. :-) But I hear your pain.</p>



<a name="310718666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310718666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310718666">(Nov 17 2022 at 23:23)</a>:</h4>
<p>Adding all those doc-strings might be a nice present to go along with the core PR. :-)</p>



<a name="310722206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310722206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310722206">(Nov 17 2022 at 23:50)</a>:</h4>
<p>Yeah. Core could always use more doc strings.</p>



<a name="310723298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/310723298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#310723298">(Nov 17 2022 at 23:54)</a>:</h4>
<p>Ok, I'll give the docstrings  a shot! :)</p>



<a name="311109890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Linting%20standards%20for%20mathlib/near/311109890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Linting.20standards.20for.20mathlib.html#311109890">(Nov 20 2022 at 08:28)</a>:</h4>
<p>Alright! Docstrings written, linting (and build) passed! <span aria-label="smiling face" class="emoji emoji-263a" role="img" title="smiling face">:smiling_face:</span> Still <a href="#narrow/stream/270676-lean4/topic/.5BRFC.5D.20refine_struct.20functionality.20via.20new.20.3F.2E.2E.20syntax/near/310715244">a couple design choices that can be made/tweaked/confirmed</a> and some comment cleanup once that's done, but it's up and running! :)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>