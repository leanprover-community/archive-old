---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/mathport.20funext.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html">mathport funext</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="320403673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320403673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320403673">(Jan 10 2023 at 09:05)</a>:</h4>
<p>Small issue -- looks like when porting lean3 <code>funext</code> tactic, mathport just put lean4 <code>funext</code>, which doesn't work -- it should probably (?) be replaced with <code>funext _</code> everywhere it's used</p>



<a name="320405686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320405686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320405686">(Jan 10 2023 at 09:18)</a>:</h4>
<p>what does <code>funext</code> do in lean 3 and lean 4?</p>



<a name="320405808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320405808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320405808">(Jan 10 2023 at 09:19)</a>:</h4>
<p>Usually when tactic behavior doesn't match up it is preferable to fix the tactics rather than automate a wide scale usability regression</p>



<a name="320405934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320405934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320405934">(Jan 10 2023 at 09:20)</a>:</h4>
<p>unless there is an argument for why the new behavior is better than the old one</p>



<a name="320406569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320406569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320406569">(Jan 10 2023 at 09:23)</a>:</h4>
<p>Both are basically equivalent to <code>apply funext; intro</code>, is my impression. lean3 funext would autogenerate a name if none was provided, while lean4 funext requires it. since lean4 <code>intro</code> autogenerates a name, <code>funext</code> should probably be modified to do the same</p>



<a name="320407036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320407036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320407036">(Jan 10 2023 at 09:25)</a>:</h4>
<p>So basically there's a bunch of unhygienic lean 3 code being incorrectly ported</p>



<a name="320407221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320407221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320407221">(Jan 10 2023 at 09:26)</a>:</h4>
<p>(Is there a situation where <code>apply funext; intro _</code> wouldn't work as a translation..? not sure what effect hygiene issues have on porting)</p>



<a name="320407577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320407577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320407577">(Jan 10 2023 at 09:28)</a>:</h4>
<p>There's actually a few unrelated mathport issues cropping up in <code>Data.List.Permutation</code>, should I make new threads or just list them here?</p>



<a name="320413500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320413500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320413500">(Jan 10 2023 at 10:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="407274">James Gallicchio</span> <a href="#narrow/stream/287929-mathlib4/topic/mathport.20funext/near/320406569">said</a>:</p>
<blockquote>
<p>Both are basically equivalent to <code>apply funext; intro</code>, is my impression. lean3 funext would autogenerate a name if none was provided, while lean4 funext requires it.</p>
</blockquote>
<p>I'm asking what <code>funext</code> does, full stop no extra argument</p>



<a name="320413562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320413562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320413562">(Jan 10 2023 at 10:03)</a>:</h4>
<p>what do you mean by lean4 funext requires it? Is it an error?</p>



<a name="320413862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320413862" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320413862">(Jan 10 2023 at 10:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/287929-mathlib4/topic/mathport.20funext/near/320407036">said</a>:</p>
<blockquote>
<p>So basically there's a bunch of unhygienic lean 3 code being incorrectly ported</p>
</blockquote>
<p>It's not clear to me that hygiene is the issue here. That would only be if follow up code talks about <code>a</code> or something assuming that the introduced name is <code>a</code>; our use of <img alt=":ahat:" class="emoji" src="https://zulip-avatars.s3.amazonaws.com/3121/emoji/images/19435.png" title="ahat"> in lean 3 addresses most of those cases though</p>



<a name="320414013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320414013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320414013">(Jan 10 2023 at 10:06)</a>:</h4>
<p>Not in the case of <code>ext</code>, though. <code>ext</code> gets its name from the variable name that is used in the lambda expression.</p>



<a name="320414081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320414081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320414081">(Jan 10 2023 at 10:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="407274">James Gallicchio</span> <a href="#narrow/stream/287929-mathlib4/topic/mathport.20funext/near/320407577">said</a>:</p>
<blockquote>
<p>There's actually a few unrelated mathport issues cropping up in <code>Data.List.Permutation</code>, should I make new threads or just list them here?</p>
</blockquote>
<p>You can put them in one thread, but the thread should be called Data.List.Permutation in that case</p>



<a name="320414139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320414139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320414139">(Jan 10 2023 at 10:06)</a>:</h4>
<p>And that is unhygienic because those names tend to change when lemmas are moved around.</p>



<a name="320414161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320414161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320414161">(Jan 10 2023 at 10:06)</a>:</h4>
<p>I said most</p>



<a name="320414255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320414255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320414255">(Jan 10 2023 at 10:07)</a>:</h4>
<p>lean 4 can do that too (variable names are officially part of the signature now)</p>



<a name="320414432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320414432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320414432">(Jan 10 2023 at 10:08)</a>:</h4>
<p>so you should not change the names of variables by moving them, that's a breaking change similar to changing the lemma statement</p>



<a name="320414488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320414488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> James Gallicchio <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320414488">(Jan 10 2023 at 10:08)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/287929-mathlib4/topic/mathport.20funext/near/320413562">said</a>:</p>
<blockquote>
<p>what do you mean by lean4 funext requires it? Is it an error?</p>
</blockquote>
<p>syntax error:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">macro_rules</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span><span class="n">funext</span> <span class="bp">$</span><span class="n">x</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">apply</span> <span class="n">funext</span><span class="bp">;</span> <span class="n">intro</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">term</span><span class="o">)</span>
  <span class="bp">|</span> <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span><span class="n">funext</span> <span class="bp">$</span><span class="n">x</span> <span class="bp">$</span><span class="n">xs</span><span class="bp">*</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">apply</span> <span class="n">funext</span><span class="bp">;</span> <span class="n">intro</span> <span class="bp">$</span><span class="n">x</span><span class="o">:</span><span class="n">term</span><span class="bp">;</span> <span class="n">funext</span> <span class="bp">$</span><span class="n">xs</span><span class="bp">*</span><span class="o">)</span>
</code></pre></div>
<p>It's a one-line fix :)</p>



<a name="320414531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mathport%20funext/near/320414531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mathport.20funext.html#320414531">(Jan 10 2023 at 10:09)</a>:</h4>
<p>well that was easy</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>