---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/data.2Eset.2Efunction.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html">data.set.function</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="315930811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315930811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315930811">(Dec 14 2022 at 23:00)</a>:</h4>
<p>The PR for Data.Set.Function is almost ready, but I have to stop working on it for several hours, in case anyone wants to have a go at finishing it up: <a href="https://github.com/leanprover-community/mathlib4/pull/1035">mathlib4#1035</a></p>



<a name="315930865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315930865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315930865">(Dec 14 2022 at 23:00)</a>:</h4>
<p>There are just 3 declarations that need their proofs fixed and I think a few long lines and then it will be done.</p>



<a name="315935243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315935243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315935243">(Dec 14 2022 at 23:37)</a>:</h4>
<p><span class="user-mention" data-user-id="412682">@Moritz Doll</span>, does your reaction mean you’re working on it? I’ll give it a go rn if you’re not.</p>



<a name="315935602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315935602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315935602">(Dec 14 2022 at 23:40)</a>:</h4>
<p>yes, I am having a look at it now. I don't mind if you look at it as well</p>



<a name="315935677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315935677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315935677">(Dec 14 2022 at 23:41)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> who has some open PRs against the mathlib3 file</p>



<a name="315935905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315935905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315935905">(Dec 14 2022 at 23:43)</a>:</h4>
<p>Ok! I saw your reaction after I did the easy bit: fixing the formatting. We just delete mathport warnings (which are above declarations that are good to go), right?</p>



<a name="315936218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315936218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315936218">(Dec 14 2022 at 23:46)</a>:</h4>
<p>(Pushed the format-fixing commit assuming so. If not I’ll undo it.)</p>



<a name="315937268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315937268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315937268">(Dec 14 2022 at 23:57)</a>:</h4>
<p>partial progress for the first sorry:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">restrict_extend_range</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">)</span> <span class="o">(</span><span class="n">g'</span> <span class="o">:</span> <span class="n">β</span> <span class="bp">→</span> <span class="n">γ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">range</span> <span class="n">f</span><span class="o">)</span><span class="bp">.</span><span class="n">restrict</span> <span class="o">(</span><span class="n">extend</span> <span class="n">f</span> <span class="n">g</span> <span class="n">g'</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">g</span> <span class="n">x.coe_prop.some</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">classical</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">restrict_dite</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>works in mathlib3</p>



<a name="315937350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315937350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315937350">(Dec 14 2022 at 23:58)</a>:</h4>
<p>and also in mathlib4 <span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="315937556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315937556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315937556">(Dec 14 2022 at 23:59)</a>:</h4>
<p>sorries have been fixed - <span class="user-mention" data-user-id="548935">@Thomas Murrills</span> I leave the formatting things to you</p>



<a name="315937778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315937778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315937778">(Dec 15 2022 at 00:01)</a>:</h4>
<p>Maybe we should consider a terminal <code>convert</code> as evil</p>



<a name="315937967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315937967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315937967">(Dec 15 2022 at 00:02)</a>:</h4>
<p>Nice! <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span> my formatting commit apparently got in right before your commits, so with your merge I think we should be good!</p>



<a name="315940684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315940684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315940684">(Dec 15 2022 at 00:31)</a>:</h4>
<p>I missed two errors, but now it the branch builds without errors on my machine and also the linter is happy</p>



<a name="315940887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315940887" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Murrills <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315940887">(Dec 15 2022 at 00:33)</a>:</h4>
<p>Great! (I was finding and fixing the long lines manually—I've been struggling with some error building mathlib4 for the past hour or so, and couldn't access <code>#lint</code> 😅)</p>



<a name="315940971"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315940971" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315940971">(Dec 15 2022 at 00:34)</a>:</h4>
<blockquote>
<p>Maybe we should consider a terminal convert as evil</p>
</blockquote>
<p>I find non-terminal converts to be much more evil.</p>



<a name="315941016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315941016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315941016">(Dec 15 2022 at 00:35)</a>:</h4>
<p>but these are actually useful and not a hack</p>



<a name="315942276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315942276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315942276">(Dec 15 2022 at 00:48)</a>:</h4>
<p>How are terminal converts not useful?  They allow you to plug in a proof "up to subsingletons".</p>



<a name="315942533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315942533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315942533">(Dec 15 2022 at 00:51)</a>:</h4>
<p>On the other hand non-terminal converts are pretty fragile in my experience.  If you change the reducibility of a definition, or add subsingleton instances, the tactic suddenly returns a whole different set of goals.  And these goals might not even be provable anymore.  Whenever I see a convert break during a refactoring, I try to remove it.</p>



<a name="315943020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315943020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315943020">(Dec 15 2022 at 00:56)</a>:</h4>
<p>I've used terminal <code>convert</code> once or twice in mathlib3 and the reason was that <code>exact</code> had really weird errors, but I was convinced that it should be just <code>exact</code> <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span><br>
I agree that <code>convert</code> is very fragile, but sometimes it is very close to how the informal proof goes and it is more tedious to work around with rather artificial <code>have</code>s.</p>



<a name="315959232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315959232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315959232">(Dec 15 2022 at 04:45)</a>:</h4>
<p><span class="user-mention" data-user-id="412682">@Moritz Doll</span>, <span class="user-mention" data-user-id="197836">@Jireh Loreaux</span>, I fixed quite a few names in <a href="https://github.com/leanprover-community/mathlib4/pull/1035/commits/8fc6e42ae6ea6e1283c81b05e7f7c9420751d0c8">https://github.com/leanprover-community/mathlib4/pull/1035/commits/8fc6e42ae6ea6e1283c81b05e7f7c9420751d0c8</a>, for future reference.</p>
<p>I'll merge shortly.</p>



<a name="315959750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315959750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315959750">(Dec 15 2022 at 04:52)</a>:</h4>
<p>Thanks. But I'm confused why, for example, <code>Monotone.rangeFactorization</code> has that spelling. It's a theorem, so it should be snake_case, right?</p>



<a name="315959896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315959896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315959896">(Dec 15 2022 at 04:54)</a>:</h4>
<p>Oh wait, I get it. It's a lemma about <code>rangeFactorization</code>. Sorry, that's why I missed this and <code>codRestrict</code>. I'll check for this better next time.</p>



<a name="315959914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315959914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315959914">(Dec 15 2022 at 04:54)</a>:</h4>
<p>The <code>mapsTo</code> was just one that slipped by.</p>



<a name="315980408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315980408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315980408">(Dec 15 2022 at 08:24)</a>:</h4>
<blockquote>
<p>On the other hand non-terminal converts are pretty fragile in my experience.  If you change the reducibility of a definition, or add subsingleton instances, the tactic suddenly returns a whole different set of goals.  And these goals might not even be provable anymore.  Whenever I see a convert break during a refactoring, I try to remove it.</p>
</blockquote>
<p>only 7 hours later I have three broken <code>convert</code>s..</p>



<a name="315982176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.set.function/near/315982176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Eset.2Efunction.html#315982176">(Dec 15 2022 at 08:36)</a>:</h4>
<p><code>convert using 1</code> is a bit less fragile</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>