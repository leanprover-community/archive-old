---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/mapM'.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html">mapM'</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="313369657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313369657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313369657">(Dec 01 2022 at 20:25)</a>:</h4>
<p>The following are <code>#align</code>ed in <code>Mathlib/Init/Control/Combinators.lean</code> - is that right?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">list.mmap'</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">monad</span> <span class="n">m</span><span class="o">]</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">m</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">m</span> <span class="n">unit</span>
<span class="kd">def</span> <span class="n">mapM'</span> <span class="o">[</span><span class="n">Monad</span> <span class="n">m</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">m</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="n">List</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">m</span> <span class="o">(</span><span class="n">List</span> <span class="n">β</span><span class="o">)</span>
</code></pre></div>



<a name="313379142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313379142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313379142">(Dec 01 2022 at 21:17)</a>:</h4>
<p>I might have slipped in an extra apostrophe somewhere</p>



<a name="313380115"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313380115" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313380115">(Dec 01 2022 at 21:23)</a>:</h4>
<p>Yes, usually the primed versions are the "return nothing" versions.</p>



<a name="313547121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313547121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arien Malec <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313547121">(Dec 02 2022 at 17:14)</a>:</h4>
<p>really? not the Haskell convention of lazy vs strict?</p>



<a name="313549166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313549166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313549166">(Dec 02 2022 at 17:24)</a>:</h4>
<p>Nope. There's no such distinction here.</p>



<a name="313552076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313552076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313552076">(Dec 02 2022 at 17:37)</a>:</h4>
<p>The naming convention for "return nothing" map functions is <code>forM</code></p>



<a name="313552198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313552198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313552198">(Dec 02 2022 at 17:38)</a>:</h4>
<p>e.g <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.forM#doc">docs4#List.forM</a></p>



<a name="313552978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313552978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313552978">(Dec 02 2022 at 17:41)</a>:</h4>
<p>Is there a "return nothing" version of <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=List.foldrM#doc">docs4#List.foldrM</a> / <a href="https://leanprover-community.github.io/mathlib_docs/find/list.foldrm">docs#list.foldrm</a>?</p>



<a name="313553186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313553186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313553186">(Dec 02 2022 at 17:42)</a>:</h4>
<p>No, I don't think there is a more efficient implementation than <code>l.reverse.forM ...</code> anyway</p>



<a name="313553582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313553582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313553582">(Dec 02 2022 at 17:44)</a>:</h4>
<p>actually I guess <code>foldrM</code> is a bit more different than that</p>



<a name="313553776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313553776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313553776">(Dec 02 2022 at 17:45)</a>:</h4>
<p>Unlike <code>discard &lt;| mapM</code>, I don't really see the advantage of having a separate function for <code>discard &lt;| foldrM</code> since you have to construct the final state <code>s</code> anyway because you have to pass it through the list</p>



<a name="313792686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/mapM%27/near/313792686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Trebor Huang <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/mapM'.html#313792686">(Dec 04 2022 at 11:02)</a>:</h4>
<p>Haskell uses underlines for the "return nothing" version, iirc.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>