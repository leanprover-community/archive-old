---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/improved.20interaction.20of.20to_additive.20with.20other.20attributes.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/improved.20interaction.20of.20to_additive.20with.20other.20attributes.html">improved interaction of to_additive with other attributes</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="319416608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/improved%20interaction%20of%20to_additive%20with%20other%20attributes/near/319416608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/improved.20interaction.20of.20to_additive.20with.20other.20attributes.html#319416608">(Jan 04 2023 at 15:47)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib4/pull/1314">mathlib4#1314</a> is a big refactor of the <code>to_additive</code> attribute that improves the interaction with other attributes. It fixes issues <a href="https://github.com/leanprover-community/mathlib4/pull/950">mathlib4#950</a>, <a href="https://github.com/leanprover-community/mathlib4/pull/953">mathlib4#953</a> and <a href="https://github.com/leanprover-community/mathlib4/pull/1149">mathlib4#1149</a>.<br>
One major notational change is that when using <code>to_additive</code> with any other attributes (that should be on both the multiplicative and additive declaration) you have to use <code>@[to_additive (attr := ...)]</code> from now on, so e.g. </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[to_additive (attr := simp)]</span>
<span class="kd">@[to_additive (attr := simp, norm_cast)]</span>
<span class="kd">@[to_additive (attr := simps apply symm_apply)]</span>
<span class="kd">@[to_additive (attr := local simp 500)]</span>
</code></pre></div>
<p>Ideally mathport also starts using this syntax (<span class="user-mention" data-user-id="110049">@Mario Carneiro</span>). Note that in Lean 3 most other attributes come before <code>to_additive</code> but <code>simps</code> comes after it. After this PR is merged all of them should be in the <code>attr</code> field.</p>



<a name="319417095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/improved%20interaction%20of%20to_additive%20with%20other%20attributes/near/319417095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/improved.20interaction.20of.20to_additive.20with.20other.20attributes.html#319417095">(Jan 04 2023 at 15:50)</a>:</h4>
<p>Note: For now, writing something like <code>@[simp, to_additive]</code> will give a warning to change it to the new form, and similar for a few other common attributes, but not for all of them (for example not for <code>simps</code>).</p>



<a name="319420616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/improved%20interaction%20of%20to_additive%20with%20other%20attributes/near/319420616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/improved.20interaction.20of.20to_additive.20with.20other.20attributes.html#319420616">(Jan 04 2023 at 16:08)</a>:</h4>
<p>Note 2: the instance attribute is still copied, so we can still use <code>@[to_additive] instance</code>. This is one of the few attributes where we can actually read of all the relevant attribute information (priority, scope) from the environment.</p>



<a name="320298409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/improved%20interaction%20of%20to_additive%20with%20other%20attributes/near/320298409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/improved.20interaction.20of.20to_additive.20with.20other.20attributes.html#320298409">(Jan 09 2023 at 18:38)</a>:</h4>
<p>This just hit master. Every open PR that uses <code>to_additive</code> should merge master.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>