---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/indentation.2C.20by.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html">indentation, by</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="321979162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/321979162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#321979162">(Jan 18 2023 at 06:12)</a>:</h4>
<p>Which style is preferred now?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">blabla</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">foo</span>
</code></pre></div>
<p>or</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">blabla</span> <span class="o">:=</span>
  <span class="kd">by</span>
  <span class="n">foo</span>
</code></pre></div>
<p>?</p>



<a name="321979255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/321979255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#321979255">(Jan 18 2023 at 06:13)</a>:</h4>
<p>I believe the former, so for long declarations</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">blablabl</span> <span class="o">(</span><span class="n">h1</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">3</span><span class="o">)</span>
    <span class="o">(</span><span class="n">extra_long_hypothesis_takes_a_lot_of_space</span> <span class="o">:</span> <span class="mi">3</span> <span class="bp">=</span> <span class="mi">4</span><span class="o">)</span> <span class="o">:</span>
    <span class="n">goal_is_also_long</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">exact</span> <span class="n">my_proof</span>
</code></pre></div>



<a name="321979353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/321979353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#321979353">(Jan 18 2023 at 06:14)</a>:</h4>
<p>(4 space indent for subsequent lines of statement, <code>by</code> on same line as goal, 2 space indent for proof)</p>



<a name="321979530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/321979530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#321979530">(Jan 18 2023 at 06:17)</a>:</h4>
<p>I asked because <code>mathport</code> sometimes generates the second style.</p>



<a name="321979605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/321979605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#321979605">(Jan 18 2023 at 06:18)</a>:</h4>
<p>My impression is that it does this sometimes when there's an error in the proof it generated and it got confused about what syntax is what.</p>



<a name="321979799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/321979799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#321979799">(Jan 18 2023 at 06:21)</a>:</h4>
<p>Oh, is that if? I'd been wondering why it happened too</p>



<a name="321991386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/321991386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#321991386">(Jan 18 2023 at 07:56)</a>:</h4>
<p>This behavior of mathport is a bug. I don't think it has to do with errors in the proof (because mathport never actually tries to elaborate the expression), there is just some combination of indentation and context that is causing this behavior in the formatter. It would be great if someone could make a MWE; you can usually demonstrate these things without even using mathport because the formatter is in core</p>



<a name="321991782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/321991782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#321991782">(Jan 18 2023 at 07:59)</a>:</h4>
<p>As a general rule, don't take the output of mathport as gospel regarding the style guide. It gets pretty close, but it's still lacking a lot of features relative to a real source code formatter - it was originally only intended for pretty printing, so if it does something odd consider that it might be a bug and don't copy the bug into your own style!</p>



<a name="322028481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/322028481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#322028481">(Jan 18 2023 at 11:25)</a>:</h4>
<p>see also <a href="https://github.com/leanprover-community/mathlib4/pull/1525">mathlib4#1525</a> <a href="https://github.com/leanprover-community/mathlib4/pull/1523">mathlib4#1523</a> and <a href="https://github.com/leanprover-community/mathlib/pull/1529">mathlib#1529</a></p>



<a name="322028722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/indentation%2C%20by/near/322028722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Firsching <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/indentation.2C.20by.html#322028722">(Jan 18 2023 at 11:26)</a>:</h4>
<p>Fix files during port with </p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>awk -i inplace <span class="s1">'{do {{if (match($0, "^  by$") &amp;&amp; length(p) &lt; 98 &amp;&amp; (!(match(p, "^[ \t]*--.*$")))) {p=p " by";} else {if (NR!=1) {print p}; p=$0}}} while (getline == 1) if (getline==0) print p}'</span> ./Mathlib/File/Im/Porting.lean
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>