---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/Eq.2ErecOn.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html">Eq.recOn</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="321076349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Eq.recOn/near/321076349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Maxwell Thum <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html#321076349">(Jan 13 2023 at 03:26)</a>:</h4>
<p>I'm <a href="https://github.com/leanprover-community/mathlib4/pull/1516">porting Data.Fin.Tuple.Basic</a> and I'm having issues with <code>Eq.recOn</code>.</p>



<a name="321076357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Eq.recOn/near/321076357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Maxwell Thum <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html#321076357">(Jan 13 2023 at 03:27)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib4/blob/port/Data.Fin.Tuple.Basic/Mathlib/Data/Fin/Tuple/Basic.lean#L429">Here</a> I get the error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span>
  <span class="n">eq_rec_compose</span> <span class="bp">?</span><span class="n">m.49854</span> <span class="bp">?</span><span class="n">m.49855</span> <span class="bp">?</span><span class="n">m.49856</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">Eq.recOn</span> <span class="bp">?</span><span class="n">m.49854</span> <span class="o">(</span><span class="n">Eq.recOn</span> <span class="bp">?</span><span class="n">m.49855</span> <span class="bp">?</span><span class="n">m.49856</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Eq.recOn</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="bp">?</span><span class="n">m.49851</span> <span class="bp">=</span> <span class="bp">?</span><span class="n">m.49853</span><span class="o">)</span> <span class="bp">?</span><span class="n">m.49856</span> <span class="o">:</span> <span class="kt">Prop</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">_root_.cast</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="n">α</span> <span class="o">(</span><span class="bp">↑</span><span class="n">castSucc.toEmbedding</span> <span class="o">(</span><span class="n">castLt</span> <span class="n">j</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">j</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)))</span> <span class="bp">=</span> <span class="n">α</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">_root_.cast</span> <span class="n">C2</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">_root_.cast</span> <span class="n">C1</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">Prop</span>
</code></pre></div>



<a name="321076396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Eq.recOn/near/321076396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Maxwell Thum <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html#321076396">(Jan 13 2023 at 03:27)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib4/blob/port/Data.Fin.Tuple.Basic/Mathlib/Data/Fin/Tuple/Basic.lean#L550">Here</a> and in the line below, I get the error </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">elaborate</span> <span class="n">eliminator</span><span class="o">,</span> <span class="n">invalid</span> <span class="n">motive</span>
  <span class="k">fun</span> <span class="n">x</span> <span class="n">x_1</span> <span class="bp">=&gt;</span> <span class="n">α</span> <span class="n">x</span>
</code></pre></div>



<a name="321083891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Eq.recOn/near/321083891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Maxwell Thum <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html#321083891">(Jan 13 2023 at 05:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="570929">Maxwell Thum</span> <a href="#narrow/stream/287929-mathlib4/topic/Eq.2ErecOn/near/321076357">said</a>:</p>
<blockquote>
<p><a href="https://github.com/leanprover-community/mathlib4/blob/port/Data.Fin.Tuple.Basic/Mathlib/Data/Fin/Tuple/Basic.lean#L429">Here</a> I get the error</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span>
  <span class="n">eq_rec_compose</span> <span class="bp">?</span><span class="n">m.49854</span> <span class="bp">?</span><span class="n">m.49855</span> <span class="bp">?</span><span class="n">m.49856</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">Eq.recOn</span> <span class="bp">?</span><span class="n">m.49854</span> <span class="o">(</span><span class="n">Eq.recOn</span> <span class="bp">?</span><span class="n">m.49855</span> <span class="bp">?</span><span class="n">m.49856</span><span class="o">)</span> <span class="bp">=</span> <span class="n">Eq.recOn</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="bp">?</span><span class="n">m.49851</span> <span class="bp">=</span> <span class="bp">?</span><span class="n">m.49853</span><span class="o">)</span> <span class="bp">?</span><span class="n">m.49856</span> <span class="o">:</span> <span class="kt">Prop</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">_root_.cast</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="n">α</span> <span class="o">(</span><span class="bp">↑</span><span class="n">castSucc.toEmbedding</span> <span class="o">(</span><span class="n">castLt</span> <span class="n">j</span> <span class="o">(</span><span class="n">_</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">j</span> <span class="bp">&lt;</span> <span class="n">n</span><span class="o">)))</span> <span class="bp">=</span> <span class="n">α</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">_root_.cast</span> <span class="n">C2</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="n">_root_.cast</span> <span class="n">C1</span> <span class="n">y</span> <span class="o">:</span> <span class="kt">Prop</span>
</code></pre></div><br>
</p>
</blockquote>
<p>For this it turned out I just needed to fill in the blanks: <code>exact eq_rec_compose (Eq.trans C2.symm C1) C2 y</code>. Not sure why Lean 4 can't do this when Lean 3 could.</p>



<a name="321086257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Eq.recOn/near/321086257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Maxwell Thum <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html#321086257">(Jan 13 2023 at 05:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="570929">Maxwell Thum</span> <a href="#narrow/stream/287929-mathlib4/topic/Eq.2ErecOn/near/321076396">said</a>:</p>
<blockquote>
<p><a href="https://github.com/leanprover-community/mathlib4/blob/port/Data.Fin.Tuple.Basic/Mathlib/Data/Fin/Tuple/Basic.lean#L550">Here</a> and in the line below, I get the error </p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">elaborate</span> <span class="n">eliminator</span><span class="o">,</span> <span class="n">invalid</span> <span class="n">motive</span>
  <span class="k">fun</span> <span class="n">x</span> <span class="n">x_1</span> <span class="bp">=&gt;</span> <span class="n">α</span> <span class="n">x</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Replacing <code>Eq.recOn (succAbove_castLt hlt) (p _)</code> with <code>@Eq.recOn _ _ (fun x _ ↦ α x) _ (succAbove_castLt hlt) (p _)</code> (and analogous for the line below) works for some reason</p>



<a name="321108068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Eq.recOn/near/321108068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html#321108068">(Jan 13 2023 at 08:54)</a>:</h4>
<p>I tried to leave a comment on <a href="https://math.commelin.net/files/port_status.html">#port-status</a> for data.fin.tuple.basic saying "please wait for a mathlib3 PR (<a href="https://github.com/leanprover-community/mathlib/pull/10346">#10346</a>)", but the comment seems to be lost. <span class="user-mention" data-user-id="112680">@Johan Commelin</span>, what's the mechanism to write those comments? I thought I did what <a href="https://github.com/leanprover-community/mathlib/wiki/mathlib4-port-status">#port-wiki</a> requested</p>



<a name="321108229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Eq.recOn/near/321108229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html#321108229">(Jan 13 2023 at 08:54)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> <a href="https://github.com/leanprover-community/mathlib4/wiki/port-comments/_edit">https://github.com/leanprover-community/mathlib4/wiki/port-comments/_edit</a></p>



<a name="321108341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Eq.recOn/near/321108341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Eq.2ErecOn.html#321108341">(Jan 13 2023 at 08:55)</a>:</h4>
<p>Ugh I forgot the <code>.basic</code> at the end of this filename</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>