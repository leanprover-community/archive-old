---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/leanproject.20port.20command.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html">leanproject port command</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="316780978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316780978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316780978">(Dec 19 2022 at 16:23)</a>:</h4>
<p><span class="user-mention" data-user-id="308899">@Yakov Pechersky</span> I like your PR here <a href="https://github.com/leanprover-community/mathlib-tools/pull/147">https://github.com/leanprover-community/mathlib-tools/pull/147</a> <br>
I'm not really sure what you meant with the git credentials comment. Can you please clarify?</p>



<a name="316780998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316780998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316780998">(Dec 19 2022 at 16:23)</a>:</h4>
<p>It would be good to get this merged, I think.</p>



<a name="316783901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316783901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316783901">(Dec 19 2022 at 16:37)</a>:</h4>
<p>Should this command make actual PRs, and push? If so, one needs to have credentials to do so (for github). One could assume the credentials are stored already or prompt for them. Or just rely on the user to do the git commands themselves. I haven't planned that far.</p>



<a name="316784814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316784814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316784814">(Dec 19 2022 at 16:42)</a>:</h4>
<p>I think the tool would already be very useful if it just pushes to a branch (if the user approves), which should cause git to prompt the user for any credentials it might need. Then the "go here to open a PR" link should be displayed in the output as well.</p>



<a name="316785281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316785281" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316785281">(Dec 19 2022 at 16:44)</a>:</h4>
<p>Great, so it's almost there! The branch and the seed commits are created. I'm on <span aria-label="palm tree" class="emoji emoji-1f334" role="img" title="palm tree">:palm_tree:</span><span aria-label="dolphin" class="emoji emoji-1f42c" role="img" title="dolphin">:dolphin:</span><span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span> vacation right now, so I'm not able to contribute code for the next two weeks or so.</p>



<a name="316785482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316785482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316785482">(Dec 19 2022 at 16:46)</a>:</h4>
<p>I'm not sure if "git push --set-upstream..." is something gitpython does in a way that exposes the credentials prompt, or if it has to be configured with credentials already.</p>



<a name="316786633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316786633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316786633">(Dec 19 2022 at 16:52)</a>:</h4>
<blockquote>
<p>I think the tool would already be very useful if it just pushes to a branch </p>
</blockquote>
<p>Wouldn't it be better to just have all the branches ready to go for when the user needs them, as a nightly job run by mathport?</p>



<a name="316786703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316786703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316786703">(Dec 19 2022 at 16:52)</a>:</h4>
<p>Then the user / leanproject port just runs <code>git reset --hard mathport/some.file.name</code></p>



<a name="316796516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316796516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316796516">(Dec 19 2022 at 17:42)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> wanted the first commit on the branch to be done by the user that opens the PR, so that the user gets proper git credits.</p>



<a name="316796598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316796598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316796598">(Dec 19 2022 at 17:43)</a>:</h4>
<p>If <code>leanproject port</code> is reasonably fast, then I think we don't need to have the branches ready to go.</p>



<a name="316803816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316803816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316803816">(Dec 19 2022 at 18:23)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> If you think this looks ready to go, then I suggest we merge it.</p>



<a name="316805063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316805063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316805063">(Dec 19 2022 at 18:30)</a>:</h4>
<p>Has anyone tested that it still works? I just mean, because the PR is from a month ago.</p>



<a name="316810975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316810975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316810975">(Dec 19 2022 at 19:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/287929-mathlib4/topic/leanproject.20port.20command/near/316796516">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> wanted the first commit on the branch to be done by the user that opens the PR, so that the user gets proper git credits.</p>
</blockquote>
<p>Ah, I'd forgotten about that. Maybe I'll try and fix bors.</p>



<a name="316811096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316811096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316811096">(Dec 19 2022 at 19:04)</a>:</h4>
<p>(<a href="https://github.com/bors-ng/bors-ng/issues/1393">https://github.com/bors-ng/bors-ng/issues/1393</a>)</p>



<a name="316811304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316811304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316811304">(Dec 19 2022 at 19:05)</a>:</h4>
<p>In any case the automatic branch creation job would pretty much consist of running this same script</p>



<a name="316811338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316811338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316811338">(Dec 19 2022 at 19:05)</a>:</h4>
<p>Either way, the bot could still create the branches, and then leanproject could just run <code>git commit --amend --author ...</code></p>



<a name="316811464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316811464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316811464">(Dec 19 2022 at 19:06)</a>:</h4>
<p>The less we put in <code>leanproject</code>, the easier it is to change how things work without having users on old versions making a mess</p>



<a name="316812789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/leanproject%20port%20command/near/316812789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/leanproject.20port.20command.html#316812789">(Dec 19 2022 at 19:15)</a>:</h4>
<p>Last I tried the command, it worked. It only consumes info, doesn't send info back</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>