---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html">Mathport abs syntax clash</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="264882985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264882985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexander Bentkamp <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264882985">(Dec 14 2021 at 16:22)</a>:</h4>
<p>The notation for <code>abs</code> clashes with some variants of the match notation:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">Mathbin.Algebra.Abs</span> <span class="c1">-- works if this is not imported</span>

<span class="kd">def</span> <span class="n">test</span> <span class="o">:</span> <span class="n">Nat</span> <span class="bp">→</span> <span class="n">Nat</span>
<span class="bp">|</span> <span class="mi">0</span> <span class="bp">=&gt;</span> <span class="mi">0</span>  <span class="c1">-- expected '|'</span>
<span class="bp">|</span> <span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span> <span class="bp">=&gt;</span> <span class="mi">0</span>
</code></pre></div>
<p>Is there a way to switch off a notation that has already been introduced? Should I report this as a bug on the mathport GitHub?</p>



<a name="264884619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264884619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264884619">(Dec 14 2021 at 16:33)</a>:</h4>
<p>Yes, we can change the notation during the port.</p>



<a name="264887784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264887784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexander Bentkamp <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264887784">(Dec 14 2021 at 16:53)</a>:</h4>
<p>ok, I'll open an issue on GitHub.</p>



<a name="264888067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264888067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexander Bentkamp <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264888067">(Dec 14 2021 at 16:54)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathport/issues/73">https://github.com/leanprover-community/mathport/issues/73</a></p>



<a name="264888070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264888070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264888070">(Dec 14 2021 at 16:54)</a>:</h4>
<p>the abs notation is even weird in Lean3, where often you need to do <code>(|x|)</code> instead of just <code>|x|</code>. I wonder if there's another vertical bar we could use for abs?</p>



<a name="264888392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264888392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264888392">(Dec 14 2021 at 16:56)</a>:</h4>
<p>There is ∣ typed as <code>\mid</code> in the emacs Lean input method.</p>



<a name="264890065"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264890065" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264890065">(Dec 14 2021 at 17:05)</a>:</h4>
<p>that one is already in use for divides</p>



<a name="264890368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264890368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264890368">(Dec 14 2021 at 17:07)</a>:</h4>
<p>I will once again renew my suggestion to stop using symmetric bracket pairs and use <code>⸡x⸠</code> like in mathematica</p>



<a name="264899122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264899122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264899122">(Dec 14 2021 at 17:58)</a>:</h4>
<p>why is it so important that they're asymmetric? is it because of how Lean's parser works? I don't currently like that syntax but I could get used to it I think</p>



<a name="264899558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264899558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264899558">(Dec 14 2021 at 18:01)</a>:</h4>
<p>Symmetric brackets are fundamentally ambiguous</p>



<a name="264899751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264899751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264899751">(Dec 14 2021 at 18:02)</a>:</h4>
<p>last time this came up I used an example like <code>|1+|1-1|+|-|1|||</code></p>



<a name="264899890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264899890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264899890">(Dec 14 2021 at 18:03)</a>:</h4>
<p>In practice this simply doesn't arise</p>



<a name="264899904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264899904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264899904">(Dec 14 2021 at 18:03)</a>:</h4>
<p>So there is nothing to worry about.</p>



<a name="264899956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264899956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264899956">(Dec 14 2021 at 18:03)</a>:</h4>
<p>We have hundreds of year of training in putting parentheses when needed.</p>



<a name="264899958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264899958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264899958">(Dec 14 2021 at 18:03)</a>:</h4>
<p>In practice this particular notation has been singled out as causing problems on <em>several</em> occasions</p>



<a name="264900022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264900022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264900022">(Dec 14 2021 at 18:04)</a>:</h4>
<p>I see, a human would then work backwards from the totasl number of |s in a line if something as horrid as this came up but that doesn't seem good for a computer parser at all</p>



<a name="264900164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264900164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264900164">(Dec 14 2021 at 18:05)</a>:</h4>
<p>The issues that arise in practice are slightly different in expression, but fundamentally the issue is that you can't make a totally coherent parser for symmetric brackets because they are ambiguous</p>



<a name="264900248"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264900248" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264900248">(Dec 14 2021 at 18:05)</a>:</h4>
<p>I haven't seen realistic examples where this is an issue, but I may have missed them.</p>



<a name="264900373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264900373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264900373">(Dec 14 2021 at 18:06)</a>:</h4>
<p>the issue that arises in lean 3 is that you can't give the brackets the right precedence so you need to use parens</p>



<a name="264900425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264900425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264900425">(Dec 14 2021 at 18:06)</a>:</h4>
<p>in lean 4 it looks to be much worse because you are also colliding with some built in notation</p>



<a name="264900541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Mathport%20abs%20syntax%20clash/near/264900541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Mathport.20abs.20syntax.20clash.html#264900541">(Dec 14 2021 at 18:07)</a>:</h4>
<p>I believe this was also why we had to remove the ascii structure brackets <code>(|a, b, c|)</code></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>