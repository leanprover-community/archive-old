---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html">attr := simp</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="323283260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323283260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323283260">(Jan 24 2023 at 15:33)</a>:</h4>
<p><span class="user-mention" data-user-id="111080">@Floris van Doorn</span> We have</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">attribute</span> <span class="o">[</span><span class="n">to_additive</span> <span class="o">(</span><span class="n">attr</span> <span class="o">:=</span> <span class="n">simp</span><span class="o">)]</span>
  <span class="n">toDual_smul</span> <span class="n">ofDual_smul</span> <span class="n">toDual_smul'</span> <span class="n">ofDual_smul'</span>
  <span class="n">toLex_smul</span> <span class="n">ofLex_smul</span> <span class="n">toLex_smul'</span> <span class="n">ofLex_smul'</span>
</code></pre></div>
<p>which gets the following error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">The</span> <span class="n">source</span> <span class="n">declaration</span> <span class="n">has</span> <span class="kn">attribute</span> <span class="n">simp.</span>
<span class="n">This</span> <span class="kn">attribute</span> <span class="n">is</span> <span class="n">not</span> <span class="n">translated</span> <span class="n">to</span> <span class="n">the</span> <span class="n">declarations</span> <span class="n">generated</span> <span class="kd">by</span> <span class="n">to_additive.</span> <span class="n">Use</span> <span class="n">something</span> <span class="n">like</span>
<span class="bp">`</span><span class="kd">@[to_additive (attr := simp)]</span><span class="bp">`</span> <span class="n">instead.</span>
</code></pre></div>



<a name="323283533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323283533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323283533">(Jan 24 2023 at 15:34)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Algebra/Group/OrderSynonym.lean#L300L302">https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Algebra/Group/OrderSynonym.lean#L300L302</a></p>



<a name="323286646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323286646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323286646">(Jan 24 2023 at 15:46)</a>:</h4>
<p>You have to remove <code>simp</code> from the original declaration.</p>



<a name="323286714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323286714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323286714">(Jan 24 2023 at 15:47)</a>:</h4>
<p>Not the most readable style</p>



<a name="323287005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323287005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323287005">(Jan 24 2023 at 15:48)</a>:</h4>
<p>How can we compile mathlib in such a way that it reports all these messages on stdout?</p>



<a name="323298087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323298087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323298087">(Jan 24 2023 at 16:33)</a>:</h4>
<p>I am currently working on changing these warnings into linting errors, and fixing them all.<br>
I'm adding some new features of <code>to_additive</code> so that you can easily additivize an already additive declaration (which is what is happening here). Please don't touch them, I'll fix it.<br>
I'll improve the error message at the same time.</p>



<a name="323308609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323308609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323308609">(Jan 24 2023 at 17:18)</a>:</h4>
<p>What I'm doing is also going to be a relatively big change throughout the library, almost certainly conflicting with <a href="https://github.com/leanprover-community/mathlib4/pull/1816">!4#1816</a>, so I prefer if we merge <a href="https://github.com/leanprover-community/mathlib4/pull/1816">!4#1816</a> before I start changing many files. <span class="user-mention" data-user-id="112680">@Johan Commelin</span> are you currently working on that PR?</p>



<a name="323331490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323331490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323331490">(Jan 24 2023 at 19:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp/near/323287005">said</a>:</p>
<blockquote>
<p>How can we compile mathlib in such a way that it reports all these messages on stdout?</p>
</blockquote>
<p>It's <code>lake build -v</code>.  But that also shows the full Lean command-line.  <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> You were the one who decided to hide stderr/stdout by default in Lake.  At the time we had lots of noise because of the unused variable warnings.  Are there other reasons as well?  Should we show the output again?</p>



<a name="323331701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323331701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323331701">(Jan 24 2023 at 19:04)</a>:</h4>
<p>I wanted to hide the lean command-line, not stderr/stdout</p>



<a name="323331782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323331782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323331782">(Jan 24 2023 at 19:05)</a>:</h4>
<p>I think stdout should just be printed so that we can see noisy files</p>



<a name="323331967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323331967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323331967">(Jan 24 2023 at 19:06)</a>:</h4>
<p>stderr too, although it would be nice if lake could interpret the output to control when and how it is presented</p>



<a name="323332126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323332126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323332126">(Jan 24 2023 at 19:06)</a>:</h4>
<p>I think <code>cargo</code> does something like <code>rustc --json</code> to do this kind of thing</p>



<a name="323332165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323332165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323332165">(Jan 24 2023 at 19:06)</a>:</h4>
<p>In <a href="https://github.com/leanprover-community/mathlib4/pull/1819">!4#1819</a> I change the log info messages to linter errors, and fixed all the current linter errors.</p>



<a name="323332282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323332282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323332282">(Jan 24 2023 at 19:07)</a>:</h4>
<p>It would be nice if compilation of files continues after a linter error (both in CI and locally).</p>



<a name="323332359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323332359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323332359">(Jan 24 2023 at 19:07)</a>:</h4>
<p>oh yes that is a major peeve for me</p>



<a name="323332540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323332540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323332540">(Jan 24 2023 at 19:08)</a>:</h4>
<p>especially imports in interactive mode should not be blocked by warnings</p>



<a name="323337234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/attr%20%3A%3D%20simp/near/323337234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/attr.20.3A.3D.20simp.html#323337234">(Jan 24 2023 at 19:31)</a>:</h4>
<p>Filed as <a href="https://github.com/leanprover/lean4/pull/2061">lean4#2061</a>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>