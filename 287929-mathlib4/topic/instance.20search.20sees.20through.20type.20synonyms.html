---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/instance.20search.20sees.20through.20type.20synonyms.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/instance.20search.20sees.20through.20type.20synonyms.html">instance search sees through type synonyms</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="312898146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/instance%20search%20sees%20through%20type%20synonyms/near/312898146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/instance.20search.20sees.20through.20type.20synonyms.html#312898146">(Nov 29 2022 at 17:44)</a>:</h4>
<p>on <a href="https://github.com/leanprover-community/mathlib4/pull/783">mathlib4#783</a> I ran into a very concerning issue. The declaration <code>toLex_mono</code> (and similarly <code>toLex_strictMono</code>) picks up the wrong <code>Preorder</code> instance on <code>α ×ₗ β</code> despite having the type annotation <code>toLex : α × β → α ×ₗ β</code>.  It instead uses the non-lexicographic preorder (i.e., the <code>prod</code> preorder) on <code>α ×ₗ β</code>. This seems like a bug and an important one to fix (it took me a while to figure out this was the problem when the proof was just randomly broken). I don't think Lean should be blasting right through type synonyms on its type class search.</p>



<a name="312899837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/instance%20search%20sees%20through%20type%20synonyms/near/312899837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/instance.20search.20sees.20through.20type.20synonyms.html#312899837">(Nov 29 2022 at 17:52)</a>:</h4>
<p>Hopefully this is covered by <a href="https://github.com/leanprover/lean4/issues/1891">https://github.com/leanprover/lean4/issues/1891</a>, for which we'll have a fix tomorrow.</p>



<a name="312899901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/instance%20search%20sees%20through%20type%20synonyms/near/312899901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/instance.20search.20sees.20through.20type.20synonyms.html#312899901">(Nov 29 2022 at 17:52)</a>:</h4>
<p>It is at least a related error, but I haven't thought about whether it applies here.</p>



<a name="312900051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/instance%20search%20sees%20through%20type%20synonyms/near/312900051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/instance.20search.20sees.20through.20type.20synonyms.html#312900051">(Nov 29 2022 at 17:53)</a>:</h4>
<p>That seems like the same issue, thanks.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>