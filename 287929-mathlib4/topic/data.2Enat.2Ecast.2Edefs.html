---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html">data.nat.cast.defs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="310449419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310449419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310449419">(Nov 16 2022 at 16:33)</a>:</h4>
<p>I've been avoiding this file even though it's close to the top because I know that coercions have changed in Lean 4. Has anyone else started thinking about this file yet? If so, do we have any sort of plan?</p>



<a name="310460374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310460374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310460374">(Nov 16 2022 at 17:26)</a>:</h4>
<p>The thinking has been going on for a long time. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span>  Most of the file is already ported, just in the "wrong" places (grep for AddMonoidWithOne).  I think only some of the lemmas are missing.</p>



<a name="310465512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310465512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310465512">(Nov 16 2022 at 17:53)</a>:</h4>
<p>I kind of figured someone smarter than me had seen it coming. <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="310465683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310465683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310465683">(Nov 16 2022 at 17:55)</a>:</h4>
<p>Do we have any sort of standard procedure for dealing with the coercion transition then? If so, can we write it up somewhere?</p>



<a name="310523002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310523002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310523002">(Nov 16 2022 at 23:53)</a>:</h4>
<p>I think it should be done together with <code>Algebra.GroupWithZero.Defs</code> in <a href="https://github.com/leanprover-community/mathlib4/pull/563">mathlib4#563</a></p>



<a name="310674833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310674833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310674833">(Nov 17 2022 at 18:44)</a>:</h4>
<p>I will tackle this and then incorporate it into <a href="https://github.com/leanprover-community/mathlib4/pull/563">mathlib4#563</a></p>



<a name="310682316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310682316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310682316">(Nov 17 2022 at 19:23)</a>:</h4>
<p>Am I correct that <code>has_nat_cast</code> should just go away entirely?</p>



<a name="310682533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310682533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310682533">(Nov 17 2022 at 19:24)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span></p>



<a name="310685682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310685682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310685682">(Nov 17 2022 at 19:41)</a>:</h4>
<p>Well spotted!  I wrote both the Lean 3 and Lean 4 versions of add_monoid_with_one in parallel.  The first version didn't have has_nat_cast, and that's the state that mathlib4 is in.</p>



<a name="310685850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310685850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310685850">(Nov 17 2022 at 19:42)</a>:</h4>
<p>I think I've added has_nat_cast afterwards to make defining type class instances easier.  (That is, you can set up the <code>ℕ → R</code> map without first proving that <code>R</code> is an additive monoid.)</p>



<a name="310685909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310685909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310685909">(Nov 17 2022 at 19:43)</a>:</h4>
<p>So what we should do is backport (forward port?) the NatCast type class to mathlib4.</p>



<a name="310685967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310685967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310685967">(Nov 17 2022 at 19:43)</a>:</h4>
<p>Yes, from experience having <code>has_nat_cast</code> makes defining instances more comfortable.</p>



<a name="310686314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310686314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310686314">(Nov 17 2022 at 19:45)</a>:</h4>
<p>Okay, so I <em>should</em> port <code>has_nat_cast</code> to a <code>NatCast</code>type class. Got it.</p>



<a name="310686522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310686522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310686522">(Nov 17 2022 at 19:46)</a>:</h4>
<p>Should it still go in <code>data.nat.cast.defs</code>? Or should I put it in <code>Mathlib.Algebra.GroupWithZero.Defs</code>?</p>



<a name="310687396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310687396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310687396">(Nov 17 2022 at 19:51)</a>:</h4>
<p>I've also moved around the mathlib3 files long after the mathlib4 one was merged.  One reason was to reduce the imports.  So I think we should also have a <code>Mathlib.Data.Nat.Cast.Defs</code> split in mathlib4.</p>



<a name="310693911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310693911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310693911">(Nov 17 2022 at 20:30)</a>:</h4>
<p>Currently, in mathlib3, <code>add_monoid_with_one</code> and <code>has_nat_cast</code> are both defined in <code>data.nat.cast</code>. In mathlib4, <code>AddMonoidWithOne</code> is defined in <code>Mathlib.Algebra.GroupWithZero.Defs</code>. Are you wanting me to move that? Sorry, I'm just not understanding the plan.</p>



<a name="310694672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/data.nat.cast.defs/near/310694672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/data.2Enat.2Ecast.2Edefs.html#310694672">(Nov 17 2022 at 20:34)</a>:</h4>
<p>Nevermind, I think I understand now. I just read the details on <a href="https://github.com/leanprover-community/mathlib/pull/563">#563</a>. These things should move in mathlib4 to the places they appear in mathlib3.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>