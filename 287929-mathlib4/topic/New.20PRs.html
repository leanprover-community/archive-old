---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/New.20PRs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html">New PRs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="315316428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315316428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315316428">(Dec 12 2022 at 08:55)</a>:</h4>
<p>I'm curious what the status or plan is for PRs to mathlib4 with brand-new content, since the possibility of such doesn't seem that far away.</p>



<a name="315316553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315316553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315316553">(Dec 12 2022 at 08:56)</a>:</h4>
<p>I assume we'll ask them to be backported?</p>



<a name="315316749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315316749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315316749">(Dec 12 2022 at 08:57)</a>:</h4>
<p>I guess brand new content in brand new files isn't much of an issue. But when it's touching existing files (which is very likely) then I think it might cause some headaches.</p>



<a name="315316967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315316967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315316967">(Dec 12 2022 at 08:59)</a>:</h4>
<p>So what you're saying is that even mathlib PRs will now have a <code>for_mathlib</code> directory.</p>



<a name="315356071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315356071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315356071">(Dec 12 2022 at 12:35)</a>:</h4>
<p>Johan and I discussed it a bit and we don't really see any harm in accepting mathlib4 PRs, so long as they don't break backwards compatibility. That is, all of the not-yet-ported files of mathlib 3 are conceptually "clients" of the already-ported files, and we can't break them.</p>
<p>In practice this means that adding new files and likely also new definitions, lemmas etc. is fine but e.g. rearranging imports or changing existing definitions is probably not fine.</p>



<a name="315362051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315362051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315362051">(Dec 12 2022 at 13:06)</a>:</h4>
<p>I think even adding new definitions to existing files is a bad idea; it makes it much harder to ask "are these files in sync" programatically</p>



<a name="315362221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315362221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315362221">(Dec 12 2022 at 13:07)</a>:</h4>
<p>Maybe the solution is an <code>#alignnew</code> command to match <code>#align</code> and <code>#noalign</code>, indicating "this is new in mathlib4"</p>



<a name="315381719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315381719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315381719">(Dec 12 2022 at 14:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315362051">said</a>:</p>
<blockquote>
<p>I think even adding new definitions to existing files is a bad idea; it makes it much harder to ask "are these files in sync" programatically</p>
</blockquote>
<p>I think the claim is that you don't really need to ask this--all you need to know is "is this mathlib 4 file newer than a given mathlib 3 file"</p>



<a name="315382858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315382858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315382858">(Dec 12 2022 at 14:37)</a>:</h4>
<p>That doesn't tell you if the mathlib3 file has grown changes not present in mathlib4</p>



<a name="315408080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315408080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315408080">(Dec 12 2022 at 16:31)</a>:</h4>
<p>Ah sorry, what I meant to say was "newer than a given <em>version</em> of a mathlib 3 file"</p>



<a name="315408428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315408428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315408428">(Dec 12 2022 at 16:32)</a>:</h4>
<p>So as long as you have some knowledge of "mathlib 4 file X' contains all of mathlib 3 file X as of commit S", you can detect when new contents in mathlib 3 need to be ported to mathlib 4, while also allowing additions to the mathlib 4 file.</p>



<a name="315547587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315547587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315547587">(Dec 13 2022 at 09:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315356071">said</a>:</p>
<blockquote>
<p>Johan and I discussed it a bit and we don't really see any harm in accepting mathlib4 PRs, so long as they don't break backwards compatibility. That is, all of the not-yet-ported files of mathlib 3 are conceptually "clients" of the already-ported files, and we can't break them.</p>
<p>In practice this means that adding new files and likely also new definitions, lemmas etc. is fine but e.g. rearranging imports or changing existing definitions is probably not fine.</p>
</blockquote>
<p>I'm working (with <span class="user-mention" data-user-id="329754">@Antoine Labelle</span> ) on a few PRs only dealing with quivers, which are already almost entirely ported to Mathlib4.<br>
Does it make sense, then, to simply forget about mathlib3 and directly do the PRs for Mathlib4 ? That would be <em>way</em> easier than having to deal with synchronized PRs each time.</p>



<a name="315549373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315549373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315549373">(Dec 13 2022 at 09:59)</a>:</h4>
<p>I think that right now we're trying to keep mathlib3 and mathlib4 in sync, although there are discussions about how to let them diverge.</p>



<a name="315549645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315549645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315549645">(Dec 13 2022 at 10:01)</a>:</h4>
<p>I wouldn't bet on those discussions concluding real-soon-now, however. It sounds pretty scary to start diverging already.</p>



<a name="315549738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315549738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315549738">(Dec 13 2022 at 10:01)</a>:</h4>
<p>If you're <em>just</em> adding new files, not touching any files that have matching partners in mathlib3, then I'd guess everyone will be on board with that.</p>



<a name="315550027"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315550027" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315550027">(Dec 13 2022 at 10:02)</a>:</h4>
<p>... until someone who is working on mathlib wants them <span aria-label="upside down" class="emoji emoji-1f643" role="img" title="upside down">:upside_down:</span></p>



<a name="315550121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315550121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315550121">(Dec 13 2022 at 10:03)</a>:</h4>
<p>mathport doesn't do Lean 4 -&gt; Lean 3 translation, does it?</p>



<a name="315550148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315550148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315550148">(Dec 13 2022 at 10:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315549738">said</a>:</p>
<blockquote>
<p>If you're <em>just</em> adding new files, not touching any files that have matching partners in mathlib3, then I'd guess everyone will be on board with that.</p>
</blockquote>
<p>In principle this is true, but I expect this would be very frustrating very soon because when writing new files you always want to add a couple of lemmas in an older file. If those are put in the new file in mathlib4 then we'll simply accumulate mess for no good reason.</p>



<a name="315550365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315550365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315550365">(Dec 13 2022 at 10:04)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315550121">said</a>:</p>
<blockquote>
<p>mathport doesn't do Lean 4 -&gt; Lean 3 translation, does it?</p>
</blockquote>
<p>Nope, that's totally out of scope and not what we want to encourage in any case. We can and will use new lean 4 material as an extra carrot to move people across :)</p>



<a name="315550834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315550834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315550834">(Dec 13 2022 at 10:06)</a>:</h4>
<p>I think we should allow new theorems to be added to aligned mathlib4 files. As long as you don't reorder the aligned theorems, I don't think this poses any major issues for mathport. It currently isn't even really making use of mathlib4 theorem placement, as long as everything is defined and <code>#align</code>ed some time before <code>Mathlib.lean</code></p>



<a name="315551100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315551100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315551100">(Dec 13 2022 at 10:08)</a>:</h4>
<p>which is also what Reid said above</p>



<a name="315551422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315551422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315551422">(Dec 13 2022 at 10:10)</a>:</h4>
<p>This sounds like a headache when other people add similar lemmas to mathlib and want to port them over.</p>



<a name="315551641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315551641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315551641">(Dec 13 2022 at 10:11)</a>:</h4>
<p>Why?</p>



<a name="315551731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315551731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315551731">(Dec 13 2022 at 10:11)</a>:</h4>
<p>Because we'll have to refactor either mathlib or mathlib4 to account for material coming from the other side.</p>



<a name="315551785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315551785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315551785">(Dec 13 2022 at 10:12)</a>:</h4>
<p>the <code>#align</code> statements are the landmarks, just find the ones for the mathlib3 theorems before and after</p>



<a name="315551832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315551832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315551832">(Dec 13 2022 at 10:12)</a>:</h4>
<p>Yes, I'm saying <em>similar</em> lemmas, not <em>identical</em> lemmas.</p>



<a name="315551875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315551875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315551875">(Dec 13 2022 at 10:12)</a>:</h4>
<p>a synced mathlib4 file has #align statements for every statement in the mathlib3 file, in the same order</p>



<a name="315551950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315551950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315551950">(Dec 13 2022 at 10:13)</a>:</h4>
<p>there may also be additional declarations and theorems which have no align statements in between</p>



<a name="315552057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552057">(Dec 13 2022 at 10:13)</a>:</h4>
<p>if there are <em>similar</em> lemmas in mathlib3 with no mathlib4 equivalents then the file isn't aligned</p>



<a name="315552181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552181">(Dec 13 2022 at 10:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315551422">said</a>:</p>
<blockquote>
<p>This sounds like a headache when other people add similar lemmas to mathlib and want to port them over.</p>
</blockquote>
<p>If someone is adding lemmas to mathlib files that have been ported to mathlib4 then there is already a headache</p>



<a name="315552253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552253">(Dec 13 2022 at 10:14)</a>:</h4>
<p>Yes, but there's no decision to be made while porting. The mathlib file has authority on what the mathlib4 file contains.</p>



<a name="315552361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552361">(Dec 13 2022 at 10:15)</a>:</h4>
<p>no, the mathlib4 file must be a superset of the mathlib3 file</p>



<a name="315552451"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552451" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552451">(Dec 13 2022 at 10:15)</a>:</h4>
<p>Right now, whenever mathlib and mathlib4 diverge, mathlib has the last word and at worse we just report everything later. What you want to do is allow the mathlib4 to have a say.</p>



<a name="315552512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552512">(Dec 13 2022 at 10:16)</a>:</h4>
<p>Basically what I mean is in the situation you're describing, it is up to whoever wants to edit mathlib3 to make corresponding changes to mathlib4 appropriately</p>



<a name="315552661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552661">(Dec 13 2022 at 10:16)</a>:</h4>
<p>Yes, that I agree, but letting mathlib4 diverge means that the "corresponding changes to mathlib4" is not just porting anymore.</p>



<a name="315552733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552733">(Dec 13 2022 at 10:17)</a>:</h4>
<p>Sure, and that might be tricky to deal with for whoever wants to edit the mathlib3 file</p>



<a name="315552746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552746">(Dec 13 2022 at 10:17)</a>:</h4>
<p>I don't know what you mean by mathlib4 diverging here</p>



<a name="315552785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552785">(Dec 13 2022 at 10:17)</a>:</h4>
<p>I suspect that we already have procedures for whatever it is</p>



<a name="315552794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552794">(Dec 13 2022 at 10:17)</a>:</h4>
<p>"having a different set of lemmas/definitions"</p>



<a name="315552822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552822">(Dec 13 2022 at 10:17)</a>:</h4>
<p>that's what #align is for</p>



<a name="315552921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552921">(Dec 13 2022 at 10:18)</a>:</h4>
<p>you will get a message in mathport if the alignment isn't a defeq match</p>



<a name="315552961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315552961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315552961">(Dec 13 2022 at 10:18)</a>:</h4>
<p>and there are a few options for how to proceed</p>



<a name="315553377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315553377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315553377">(Dec 13 2022 at 10:20)</a>:</h4>
<p>you can do the alignment anyway, but this will make some statements fail to typecheck, or you can align with <code>\_x</code> which causes the mathport output to pretend it did the alignment without actually doing so in its internal state (this is best for when the alignment is not defeq but the elaborator will make up the difference); or you can align with <code>'</code> or some other name when it's genuinely a different definition</p>



<a name="315553458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315553458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315553458">(Dec 13 2022 at 10:20)</a>:</h4>
<p>That's what I call "headache" now <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="315553550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315553550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315553550">(Dec 13 2022 at 10:21)</a>:</h4>
<p>Sure, which is why we also have the option of doing something in mathlib to make them defeq match</p>



<a name="315553684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315553684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315553684">(Dec 13 2022 at 10:22)</a>:</h4>
<p>In any case, we can't be indiscriminately modifying already-ported files in mathlib3 as though the port doesn't exist. That's going to make the port impractical, regardless of whether mathlib4 has additional stuff that didn't come from mathlib3.</p>



<a name="315553724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315553724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315553724">(Dec 13 2022 at 10:22)</a>:</h4>
<p>but in any case the end result should be that <code>#align</code>s are more or less an exact match to mathlib3</p>



<a name="315553889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315553889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315553889">(Dec 13 2022 at 10:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315553684">said</a>:</p>
<blockquote>
<p>In any case, we can't be indiscriminately modifying already-ported files in mathlib3 as though the port doesn't exist.</p>
</blockquote>
<p>That's what I've been doing, in fact. It's extra work, but straightforward extra work.</p>



<a name="315555202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555202">(Dec 13 2022 at 10:29)</a>:</h4>
<p>What do you mean? What is the extra work, and who is doing it?</p>



<a name="315555524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555524">(Dec 13 2022 at 10:30)</a>:</h4>
<p>In this case the extra work is creating the mathlib4 update PRs, and <span class="user-mention" data-user-id="387244">@Yaël Dillies</span> has been doing those themselves.</p>



<a name="315555581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555581">(Dec 13 2022 at 10:31)</a>:</h4>
<p>The extra work is</p>
<ul>
<li>open a mathlib4 gitpod</li>
<li>wait 5 min for it to download Lean, mathlib4</li>
<li>replicate the mathlib changes</li>
<li>open the PR</li>
</ul>



<a name="315555635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555635">(Dec 13 2022 at 10:31)</a>:</h4>
<p>OK so then I wouldn't really describe this as "as though the port doesn't exist".</p>



<a name="315555643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555643">(Dec 13 2022 at 10:31)</a>:</h4>
<p>Takes a good 20min every time, because mathlib4 CI isn't great, still.</p>



<a name="315555840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555840">(Dec 13 2022 at 10:32)</a>:</h4>
<p>well if you didn't start from scratch every time it would be faster</p>



<a name="315555918"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555918" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555918">(Dec 13 2022 at 10:33)</a>:</h4>
<p>Well, if the Lean4 install was persistent, I wouldn't start from scratch every time!</p>



<a name="315555954"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555954" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555954">(Dec 13 2022 at 10:33)</a>:</h4>
<p>Do we need to make a new image for gitpod, for mathlib4?</p>



<a name="315555988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315555988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315555988">(Dec 13 2022 at 10:33)</a>:</h4>
<p>I assume this is the solution, yeah.</p>



<a name="315556001"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315556001" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315556001">(Dec 13 2022 at 10:33)</a>:</h4>
<p>Hopefully just copying the setup we have for mathlib over should be an easy start.</p>



<a name="315556167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315556167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315556167">(Dec 13 2022 at 10:34)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315555635">said</a>:</p>
<blockquote>
<p>OK so then I wouldn't really describe this as "as though the port doesn't exist".</p>
</blockquote>
<p>What I mean is that typically I'm not changing my PRs because of the port. Eric in <a href="https://github.com/leanprover-community/mathlib/pull/17895">#17895</a> was adding to a non-ported file a lemma that belonged to an already ported one. So I took it onto myself to move it to the correct spot and open the mathlib4 PR.</p>



<a name="315556283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315556283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315556283">(Dec 13 2022 at 10:35)</a>:</h4>
<p>Mario, if I stop and start the mathlib4 gitpod again, I need to reinstall Lean 4.</p>



<a name="315557024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557024">(Dec 13 2022 at 10:39)</a>:</h4>
<p><span class="user-mention" data-user-id="130384">@Riccardo Brasca</span>, <span class="user-mention" data-user-id="310045">@Eric Wieser</span>, <span class="user-mention" data-user-id="387244">@Yaël Dillies</span>, I saw <a href="https://github.com/leanprover-community/mathlib/pull/17895">https://github.com/leanprover-community/mathlib/pull/17895</a> was merged without there being any sign of the corresponding mathlib4 PR <a href="https://github.com/leanprover-community/mathlib4/pull/967">https://github.com/leanprover-community/mathlib4/pull/967</a> even being looked at.</p>
<p>I suggest that maintainers who are merging either side of a matching pair of PRs either:</p>
<ul>
<li>review and merge both at once, or</li>
<li>if you only have time to think about one side, only delegate that one and ask the author to merge once the other side has been approved</li>
</ul>



<a name="315557187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557187">(Dec 13 2022 at 10:40)</a>:</h4>
<p>i.e. neither should go to bors unless the other one is at the same time / already delegated or merged.</p>



<a name="315557292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557292">(Dec 13 2022 at 10:40)</a>:</h4>
<p>In this case, my initial PR didn't touch mathlib4 files but gained a mathlib4 change in review</p>



<a name="315557437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557437">(Dec 13 2022 at 10:41)</a>:</h4>
<p>OK I understand the issue now. You're saying--suppose some new mathlib3 development wants a new lemma in some already-ported file, but oops someone else already added such a lemma in mathlib4, but maybe it's in a different place or has a different name or something--which one do we take?</p>



<a name="315557442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557442">(Dec 13 2022 at 10:41)</a>:</h4>
<p>Perhaps I should have pushed back and said "we can move the lemma into an earlier file in a follow-up"</p>



<a name="315557454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557454">(Dec 13 2022 at 10:42)</a>:</h4>
<p>For a single lemma, it doesn't seem like a big deal--just pick something reasonable.</p>



<a name="315557508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557508">(Dec 13 2022 at 10:42)</a>:</h4>
<p>My bad, I didn't really read the github message about the mathlib4 file and I thought it was complaining about a long line. I will be more careful.</p>



<a name="315557600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557600">(Dec 13 2022 at 10:42)</a>:</h4>
<p>But if it's a whole new definition &amp; set of lemmas, then it's not as obvious how to proceed</p>



<a name="315557635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557635">(Dec 13 2022 at 10:42)</a>:</h4>
<p>Yes, precisely.</p>



<a name="315557680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557680">(Dec 13 2022 at 10:43)</a>:</h4>
<p>As long as there is some opportunity to explicitly consider a merge I don't see the issue</p>



<a name="315557713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557713">(Dec 13 2022 at 10:43)</a>:</h4>
<p>And we might not even notice the duplication before a long time.</p>



<a name="315557884"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557884" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557884">(Dec 13 2022 at 10:44)</a>:</h4>
<p>We already have that issue, where a mathlib4 definition is made and <code>#align</code>ed without noticing that a similar lean 4 definition already exists</p>



<a name="315557937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315557937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315557937">(Dec 13 2022 at 10:44)</a>:</h4>
<p>so we end up with two equivalent definitions in mathlib4</p>



<a name="315558030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315558030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315558030">(Dec 13 2022 at 10:45)</a>:</h4>
<p>this isn't a huge problem in the sense that it doesn't cause any failures, and as soon as someone notices it's fairly easy to deduplicate as long as the merge is defeq</p>



<a name="315558064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315558064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315558064">(Dec 13 2022 at 10:45)</a>:</h4>
<p>if it's not then we have the usual issues, backporting etc</p>



<a name="315558347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315558347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315558347">(Dec 13 2022 at 10:46)</a>:</h4>
<p>Right I think the main question is to decide whether, in this situation, it's mathlib4's job to match mathlib3, or mathlib3's job to match mathlib4.</p>



<a name="315558378"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315558378" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315558378">(Dec 13 2022 at 10:46)</a>:</h4>
<p>I think we should try to do the best thing, and it doesn't matter if that is in mathlib3 or mathlib4</p>



<a name="315558478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315558478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315558478">(Dec 13 2022 at 10:47)</a>:</h4>
<p>it's basically just two independent implementations of a thing and we have to merge them</p>



<a name="315558638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315558638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315558638">(Dec 13 2022 at 10:48)</a>:</h4>
<p>it's less bureaucracy to make mathlib4 match mathlib3 though</p>



<a name="315564751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315564751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315564751">(Dec 13 2022 at 11:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315556283">said</a>:</p>
<blockquote>
<p>Mario, if I stop and start the mathlib4 gitpod again, I need to reinstall Lean 4.</p>
</blockquote>
<p>Why is that? If you mean opening the same workspace again, I thought they were supposed to be persistent.</p>



<a name="315564865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315564865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315564865">(Dec 13 2022 at 11:20)</a>:</h4>
<p>No idea, really! But it's reproducible.</p>



<a name="315565128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315565128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315565128">(Dec 13 2022 at 11:21)</a>:</h4>
<p>Weird, I should try that. Though I heard Gitpod is declining anyway...</p>



<a name="315566247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315566247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315566247">(Dec 13 2022 at 11:27)</a>:</h4>
<p>I think the workspace directory is persistant but the user directory is transient</p>



<a name="315570072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315570072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémi Bottinelli <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315570072">(Dec 13 2022 at 11:46)</a>:</h4>
<p>Regarding synchronized PRs to already ported files: Would it be possible to allow doing only a mathlib3 PR first, with some kind of delayed "duty to synchronize" allowing the mathlib3 PR to be merged in order to get the mathport thing running automatically and doing the mathlib4 sync by merging the updated mathport output with the old mathlib4 content ? <br>
In the few such PRs I've made, I kind of had to manually deal with stuff and I guess it's more error-prone.</p>



<a name="315570986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315570986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315570986">(Dec 13 2022 at 11:51)</a>:</h4>
<p>Opening a mathlib4 issue would be a reasonable way to record that duty</p>



<a name="315571039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315571039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315571039">(Dec 13 2022 at 11:51)</a>:</h4>
<p>Why not open an empty PR?</p>



<a name="315571110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315571110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315571110">(Dec 13 2022 at 11:52)</a>:</h4>
<p>You can't?</p>



<a name="315571195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315571195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315571195">(Dec 13 2022 at 11:52)</a>:</h4>
<p>Oh, maybe with <code>git commit --allow-empty</code></p>



<a name="315571265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315571265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315571265">(Dec 13 2022 at 11:52)</a>:</h4>
<p>Can you not? I must say I never tried!</p>



<a name="315571526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315571526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315571526">(Dec 13 2022 at 11:54)</a>:</h4>
<p>Even if you do nothing, the "duty to synchronize" is recorded in the output of <code>port-status.py</code></p>



<a name="315574287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315574287" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315574287">(Dec 13 2022 at 12:08)</a>:</h4>
<p>In the general case there might be multiple mathlib3 PRs that want to modify the same already-ported file, and it would be tricky to update mathlib4 "atomically" for all of them.</p>



<a name="315574456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315574456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315574456">(Dec 13 2022 at 12:09)</a>:</h4>
<p>I think it's easier to let mathlib3 "go ahead" of mathlib4 for a bit, as long as the mathlib3 PR author has provided a mathlib4 branch or something with the needed changes, which can actually get applied later after the mathlib3 commit is merged</p>



<a name="315574487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315574487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315574487">(Dec 13 2022 at 12:09)</a>:</h4>
<p>I guess it's not so bad if a single mathlib4 PR synchronises several mathlib PRs?</p>



<a name="315574824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315574824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315574824">(Dec 13 2022 at 12:11)</a>:</h4>
<p>I think it makes it easier to track what mathlib3 content has been ported to mathlib4, especially if those several mathlib PRs got merged in a single bors run (then we have no way to even identify a subset of them by mathlib3 commit hash)</p>



<a name="315611245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315611245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315611245">(Dec 13 2022 at 15:01)</a>:</h4>
<p>Along the same lines of this discussion: <a href="https://github.com/leanprover-community/mathlib/pull/16919">#16919</a> changes an already ported file, however the dependencies that actually make use of these changes have not been ported yet AFAICT. I think this should still have a corresponding mathlib4 PR. What do you think?</p>



<a name="315611964"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315611964" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315611964">(Dec 13 2022 at 15:04)</a>:</h4>
<p>My feeling is that this change to <code>algebra.order.hom.basic</code> is way too big to be practical--why not create a new file?</p>



<a name="315612131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315612131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315612131">(Dec 13 2022 at 15:05)</a>:</h4>
<p>For the reasons mentioned in the PR description:</p>
<blockquote>
<p>I am explicitly against making a new file for the sake of the port, because by the time we can actually merge the two files again, we will have forgotten about it, and it doesn't make the port any easier anyway.</p>
</blockquote>



<a name="315612302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315612302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315612302">(Dec 13 2022 at 15:06)</a>:</h4>
<p>The picture here is that <code>algebra.order.hom.basic</code> is an advanced file that accidentally got caught under the tide before its imports were fully fixed.</p>



<a name="315612699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315612699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315612699">(Dec 13 2022 at 15:07)</a>:</h4>
<p>I don't understand how it could not make the port easier</p>



<a name="315613056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315613056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315613056">(Dec 13 2022 at 15:09)</a>:</h4>
<p>Because everything that depends on <code>algebra.order.hom.basic</code> will be ported much later than its prerequisites, so the question is just when we want to merge <a href="https://github.com/leanprover-community/mathlib/pull/16919">#16919</a> and when we want to port the changes.</p>



<a name="315613066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315613066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315613066">(Dec 13 2022 at 15:09)</a>:</h4>
<p>(I also separately don't understand why it wouldn't make sense to have two separate files anyways; all the new stuff seems to mention <code>norm</code>, and none of the old stuff mentions <code>norm</code>)</p>



<a name="315613164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315613164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315613164">(Dec 13 2022 at 15:09)</a>:</h4>
<p>Once again, it's explained in the PR description.</p>



<a name="315613369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315613369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315613369">(Dec 13 2022 at 15:10)</a>:</h4>
<p>I don't agree that it is "explained"</p>



<a name="315613627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315613627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315613627">(Dec 13 2022 at 15:11)</a>:</h4>
<p>I have three arguments there:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">*</span> <span class="n">The</span> <span class="n">new</span> <span class="n">file</span> <span class="n">is</span> <span class="n">still</span> <span class="n">small</span> <span class="n">and</span> <span class="n">cohesive.</span>
<span class="bp">*</span> <span class="n">There's</span> <span class="n">no</span> <span class="n">use</span> <span class="n">for</span> <span class="n">what</span> <span class="n">was</span> <span class="n">previously</span> <span class="bp">`</span><span class="n">algebra.order.hom.basic</span><span class="bp">`</span> <span class="n">without</span> <span class="n">the</span> <span class="n">new</span> <span class="n">material.</span>
<span class="bp">*</span> <span class="n">Increasing</span> <span class="n">the</span> <span class="n">imports</span> <span class="n">of</span> <span class="bp">`</span><span class="n">algebra.order.hom.basic</span><span class="bp">`</span> <span class="n">didn't</span> <span class="n">increase</span> <span class="n">the</span> <span class="n">imports</span> <span class="n">of</span> <span class="n">the</span> <span class="n">two</span>
  <span class="n">files</span> <span class="n">importing</span> <span class="n">it</span><span class="o">:</span> <span class="bp">`</span><span class="n">algebra.order.absolute_value</span><span class="bp">`</span> <span class="n">and</span> <span class="bp">`</span><span class="n">analysis.normed.group.seminorm</span><span class="bp">`.</span>
</code></pre></div>
<p>Not sure what you want more.</p>



<a name="315613647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315613647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315613647">(Dec 13 2022 at 15:11)</a>:</h4>
<p>But mostly I'm still perplexed about how it doesn't make the porting task more difficult</p>



<a name="315613909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315613909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315613909">(Dec 13 2022 at 15:13)</a>:</h4>
<p>It's because this file is very independent from the rest, and I will have a several months window between the port of the dependencies of <code>algebra.order.hom.basic</code> and its children files to port <a href="https://github.com/leanprover-community/mathlib/pull/16919">#16919</a> to mathlib4.</p>



<a name="315613968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315613968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315613968">(Dec 13 2022 at 15:13)</a>:</h4>
<p>Because we have no way to automatically merge synport output of modified files with the already finished ports of earlier versions, right?</p>



<a name="315614987"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315614987" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315614987">(Dec 13 2022 at 15:17)</a>:</h4>
<p>Basically it means these ~150 lines need to be handled manually. But in a new file they would be handled largely automatically.</p>



<a name="315615311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315615311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315615311">(Dec 13 2022 at 15:19)</a>:</h4>
<p>Another option is to simply delete the partial port of <code>algebra.order.hom.basic</code>. It's quite short anyway.</p>



<a name="315615617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315615617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315615617">(Dec 13 2022 at 15:20)</a>:</h4>
<p>It looks to me like a complete port but yes, that might be possible.</p>



<a name="315615802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315615802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315615802">(Dec 13 2022 at 15:21)</a>:</h4>
<p>But in general we cannot just throw away ported files on the whims of mathlib 3 PRs.</p>



<a name="315617247"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315617247" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315617247">(Dec 13 2022 at 15:27)</a>:</h4>
<p>I think we should also have some general "<code>port-todo</code>" mechanism to keep track of things that we would like to do but are too difficult or not worth doing the port, for example putting lemmas in the correct locations</p>



<a name="315617454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315617454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315617454">(Dec 13 2022 at 15:27)</a>:</h4>
<p>Because that's surely easier than any of the possibilities discussed above.</p>



<a name="315619283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315619283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315619283">(Dec 13 2022 at 15:36)</a>:</h4>
<p>Waiting for <code>algebra.group_power.order</code> to be ported is not too hard either, but I agree with you.</p>



<a name="315701178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/315701178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#315701178">(Dec 13 2022 at 22:43)</a>:</h4>
<p>(Would GitHub Issues be a sufficient platform to record such TODOs? Or a GitHub Project for something a little more kanban?)</p>



<a name="319582119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319582119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319582119">(Jan 05 2023 at 13:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/315557187">said</a>:</p>
<blockquote>
<p>i.e. neither should go to bors unless the other one is at the same time / already delegated or merged.</p>
</blockquote>
<p>Is this still true? <a href="https://github.com/leanprover-community/mathlib/pull/17956">#17956</a> has been waiting mathlib4 approval for a week and I think I'll just go ahead and merge it because I can't just wait an eternity on mathlib, then another eternity on mathlib4.</p>



<a name="319582422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319582422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319582422">(Jan 05 2023 at 13:12)</a>:</h4>
<p>And the same will happen to <a href="https://github.com/leanprover-community/mathlib/pull/17900">#17900</a>, I'm afraid.</p>



<a name="319622584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319622584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319622584">(Jan 05 2023 at 16:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/319582119">said</a>:</p>
<blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/pull/17956">#17956</a> has been waiting mathlib4 approval for a week and I think I'll just go ahead and merge it</p>
</blockquote>
<p>I don't think you should go ahead and merge something that was conditionally delegated to you if you're not following the conditions under which it was delegated.</p>
<p>But indeed we should have a policy here.  Should we ask that someone reviewing the mathlib3 version also review the mathlib4 version?</p>



<a name="319622994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319622994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319622994">(Jan 05 2023 at 16:34)</a>:</h4>
<p>The problem here is that I am unable to fulfill the conditions of the delegation.</p>



<a name="319623554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319623554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319623554">(Jan 05 2023 at 16:37)</a>:</h4>
<p>In fact, what are we expecting from a mathlib4 review? I want to say</p>
<ul>
<li>that both PRs' content match</li>
<li>that all the <code>#align</code> are correct</li>
<li>that the names are properly capitalised</li>
</ul>
<p>but each of those steps was skipped in the past. Indeed, I fixed mistakes that went against each point after delegation.</p>



<a name="319624003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319624003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319624003">(Jan 05 2023 at 16:39)</a>:</h4>
<p>So it seems that the only thing we expect from a mathlib4 review is more design considerations, eg regarding coercions, and compatibility with the port (avoid conflicting PRs, etc...).</p>



<a name="319624372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319624372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319624372">(Jan 05 2023 at 16:40)</a>:</h4>
<p>In particular, the content should not get reviewed a second time. Maybe if we make that clearer, <a href="https://bit.ly/3cKk3ld">#queue4</a> will empty faster.</p>



<a name="319624909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319624909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319624909">(Jan 05 2023 at 16:43)</a>:</h4>
<p>And PRs that are nontechnical (no coercion fiddling, and similar) and away from the tide don't really need their mathlib4 counterpart to be reviewed simultaneously.</p>



<a name="319625395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319625395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319625395">(Jan 05 2023 at 16:45)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/287929-mathlib4/topic/New.20PRs/near/319622994">said</a>:</p>
<blockquote>
<p>The problem here is that I am unable to fulfill the conditions of the delegation.</p>
</blockquote>
<p>This I think is particularly bad, because the PR disappears from the radar (long) before being dealt with, so attention isn't drawn to it anymore.</p>



<a name="319627695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/New%20PRs/near/319627695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/New.20PRs.html#319627695">(Jan 05 2023 at 16:56)</a>:</h4>
<p>Then you ask for review here on zulip, same as when you need another review? I looked at the mathlib4 pr and it seems fine</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>