---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html">Data.Real.CauSeq</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="317120668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317120668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317120668">(Dec 21 2022 at 10:02)</a>:</h4>
<p>I have a problem with <code>rw</code> being stupid:<br>
<a href="https://github.com/leanprover-community/mathlib4/blob/mcdoll/data_real_causeq/Mathlib/Data/Real/CauSeq.lean#L435">https://github.com/leanprover-community/mathlib4/blob/mcdoll/data_real_causeq/Mathlib/Data/Real/CauSeq.lean#L435</a><br>
<a href="https://github.com/leanprover-community/mathlib4/blob/mcdoll/data_real_causeq/Mathlib/Data/Real/CauSeq.lean#L467">https://github.com/leanprover-community/mathlib4/blob/mcdoll/data_real_causeq/Mathlib/Data/Real/CauSeq.lean#L467</a><br>
The first one is very weird: it should be a trivial application of <code>mul_apply</code>, but even when giving <code>mul_apply</code> all arguments it cannot find <code>(a * b) n</code>.</p>



<a name="317121885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317121885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317121885">(Dec 21 2022 at 10:08)</a>:</h4>
<p>Are there errors earlier in the file for you?</p>



<a name="317122337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317122337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317122337">(Dec 21 2022 at 10:10)</a>:</h4>
<p>yes, but they are very unrelated.</p>



<a name="317123425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317123425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317123425">(Dec 21 2022 at 10:17)</a>:</h4>
<p>replacing all broken proofs by sorry's does not help</p>



<a name="317124522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317124522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317124522">(Dec 21 2022 at 10:22)</a>:</h4>
<p>I replaced all broken proofs with <code>sorry</code> up to <code>instance ring : Ring (CauSeq Î² abv) := by</code> and for me this has an error (<code>unknown tactic</code> for <code>refine_struct</code>) and because this is the definition of the ring structure this might be the problem with the CommRing structure. Are you 100% sure that the problem is not the earlier errors? Can you post a version with no errors other than the ones you're interested in? I'm on your branch.</p>



<a name="317125272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317125272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317125272">(Dec 21 2022 at 10:27)</a>:</h4>
<p>pushed</p>



<a name="317125517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317125517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317125517">(Dec 21 2022 at 10:28)</a>:</h4>
<p>(have to go and make dinner, feel free to push fixes)</p>



<a name="317129815"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317129815" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317129815">(Dec 21 2022 at 10:53)</a>:</h4>
<p>I have a mathlib3 PR that removes the use of <code>refine_struct</code> there, if that's useful</p>



<a name="317129901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317129901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317129901">(Dec 21 2022 at 10:53)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/17796">#17796</a></p>



<a name="317131160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317131160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317131160">(Dec 21 2022 at 11:00)</a>:</h4>
<p><span class="user-mention" data-user-id="412682">@Moritz Doll</span> please tell us whether Eric's mathlib3 PR would make your mathlib4 life easier. If yes then we can merge the mathlib3 PR today and then we'll have to run mathport again.</p>



<a name="317132387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317132387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317132387">(Dec 21 2022 at 11:06)</a>:</h4>
<p>the diff does not say that it removes anything in CauSeq</p>



<a name="317132594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317132594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317132594">(Dec 21 2022 at 11:07)</a>:</h4>
<p>Are you honestly sure that the problem with a multiplication not being defeq to another multiplication is not related to the fact that you have sorried the ring structure?</p>



<a name="317132774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317132774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317132774">(Dec 21 2022 at 11:08)</a>:</h4>
<p>I don't understand these things well enough so I might be worrying about nothing.</p>



<a name="317134447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317134447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317134447">(Dec 21 2022 at 11:17)</a>:</h4>
<p>if the PR gets merged, ping me and I merge in the new mathport version into my mathlib4-PR</p>



<a name="317134523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317134523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317134523">(Dec 21 2022 at 11:17)</a>:</h4>
<p>The issue is that one multiplication uses <code>CauSeq.instMulCauSeq</code> and the other does not.</p>



<a name="317134702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317134702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317134702">(Dec 21 2022 at 11:18)</a>:</h4>
<blockquote>
<p>the diff does not say that it removes anything in CauSeq</p>
</blockquote>
<p>Fixed</p>



<a name="317134928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317134928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317134928">(Dec 21 2022 at 11:19)</a>:</h4>
<p>that is great - is it possible to remove the ring <code>refine_struct</code> as well?</p>



<a name="317135024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317135024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317135024">(Dec 21 2022 at 11:20)</a>:</h4>
<p>The other uses <code>srcâ</code> which uses <code>CauSeq.ring</code> which uses <code>sorry</code></p>



<a name="317135108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317135108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317135108">(Dec 21 2022 at 11:20)</a>:</h4>
<p>Sorrying data in structures is a very well-known way of creating a lot of hard to debug mess down the road.</p>



<a name="317135161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317135161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317135161">(Dec 21 2022 at 11:21)</a>:</h4>
<p>So Kevin's explanation seems very likely.</p>



<a name="317135167"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317135167" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317135167">(Dec 21 2022 at 11:21)</a>:</h4>
<p>One multiplication uses</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">Mul</span> <span class="o">(</span><span class="n">CauSeq</span> <span class="n">Î²</span> <span class="n">abv</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">â¨</span><span class="k">fun</span> <span class="n">f</span> <span class="n">g</span> <span class="bp">=&gt;</span>
    <span class="o">â¨</span><span class="n">f</span> <span class="bp">*</span> <span class="n">g</span><span class="o">,</span> <span class="k">fun</span> <span class="n">_</span> <span class="n">Îµ0</span> <span class="bp">=&gt;</span>
      <span class="k">let</span> <span class="o">â¨</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">hF</span><span class="o">â©</span> <span class="o">:=</span> <span class="n">f.bounded'</span> <span class="mi">0</span>
      <span class="k">let</span> <span class="o">â¨</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">hG</span><span class="o">â©</span> <span class="o">:=</span> <span class="n">g.bounded'</span> <span class="mi">0</span>
      <span class="k">let</span> <span class="o">â¨</span><span class="n">_</span><span class="o">,</span> <span class="n">Î´0</span><span class="o">,</span> <span class="n">HÎ´</span><span class="o">â©</span> <span class="o">:=</span> <span class="n">rat_mul_continuous_lemma</span> <span class="n">abv</span> <span class="n">Îµ0</span>
      <span class="k">let</span> <span class="o">â¨</span><span class="n">i</span><span class="o">,</span> <span class="n">H</span><span class="o">â©</span> <span class="o">:=</span> <span class="n">exists_forall_ge_and</span> <span class="o">(</span><span class="n">f.cauchyâ</span> <span class="n">Î´0</span><span class="o">)</span> <span class="o">(</span><span class="n">g.cauchyâ</span> <span class="n">Î´0</span><span class="o">)</span>
      <span class="o">â¨</span><span class="n">i</span><span class="o">,</span> <span class="k">fun</span> <span class="n">j</span> <span class="n">ij</span> <span class="bp">=&gt;</span>
        <span class="k">let</span> <span class="o">â¨</span><span class="n">Hâ</span><span class="o">,</span> <span class="n">Hâ</span><span class="o">â©</span> <span class="o">:=</span> <span class="n">H</span> <span class="n">_</span> <span class="n">le_rfl</span>
        <span class="n">HÎ´</span> <span class="o">(</span><span class="n">hF</span> <span class="n">j</span><span class="o">)</span> <span class="o">(</span><span class="n">hG</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">Hâ</span> <span class="n">_</span> <span class="n">ij</span><span class="o">)</span> <span class="o">(</span><span class="n">Hâ</span> <span class="n">_</span> <span class="n">ij</span><span class="o">)â©â©â©</span>
</code></pre></div>
<p>and the other uses</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">ring</span> <span class="o">:</span> <span class="n">Ring</span> <span class="o">(</span><span class="n">CauSeq</span> <span class="n">Î²</span> <span class="n">abv</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="gr">sorry</span>
</code></pre></div>
<p>and this is why the rewrite fails right now.</p>



<a name="317135637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317135637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317135637">(Dec 21 2022 at 11:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq/near/317134523">said</a>:</p>
<blockquote>
<p>The issue is that one multiplication uses <code>CauSeq.instMulCauSeq</code> and the other does not.</p>
</blockquote>
<p>you are right.</p>



<a name="317135646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317135646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317135646">(Dec 21 2022 at 11:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="412682">Moritz Doll</span> <a href="#narrow/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq/near/317134928">said</a>:</p>
<blockquote>
<p>that is great - is it possible to remove the ring <code>refine_struct</code> as well?</p>
</blockquote>
<p>Done. Is <code>Algebra.Ring.Pi</code> ported yet? <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pi.instRing?#doc">docs4#Pi.instRing?</a></p>



<a name="317135872"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317135872" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317135872">(Dec 21 2022 at 11:25)</a>:</h4>
<p>Seems not; my suggestion would be to port <code>Algebra.Ring.Pi</code> first, and then by the time you're done my PR could be through</p>



<a name="317135958"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317135958" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317135958">(Dec 21 2022 at 11:25)</a>:</h4>
<p>No it isn't ported yet.</p>



<a name="317136168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136168">(Dec 21 2022 at 11:26)</a>:</h4>
<p>Eric, can I assume the data/real folder compile on your branch?</p>



<a name="317136251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136251">(Dec 21 2022 at 11:27)</a>:</h4>
<p>Not as of the last two commits, because I only just authored them</p>



<a name="317136288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136288">(Dec 21 2022 at 11:27)</a>:</h4>
<p>I mean: does it compile on your computer?</p>



<a name="317136305"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136305" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136305">(Dec 21 2022 at 11:27)</a>:</h4>
<p>I can try for you now?</p>



<a name="317136367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136367">(Dec 21 2022 at 11:28)</a>:</h4>
<p>I'm not talking about compiling the whole mathlib, only those two files.</p>



<a name="317136511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136511">(Dec 21 2022 at 11:28)</a>:</h4>
<p>Oh, so not the whole data/real folder, just data/real/basic?</p>



<a name="317136611"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136611" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136611">(Dec 21 2022 at 11:29)</a>:</h4>
<p><code>data/real/basic.lean</code> and its dependencies compile on that branch</p>



<a name="317136690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136690">(Dec 21 2022 at 11:29)</a>:</h4>
<p>Note that we seem to be missing <code>Algebra.Group.Pi</code> as well as <code>Algebra.Ring.Pi</code></p>



<a name="317136793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136793">(Dec 21 2022 at 11:30)</a>:</h4>
<p>Ok, it is very unlikely that build will fail later so I told bors to merge.</p>



<a name="317136846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136846">(Dec 21 2022 at 11:30)</a>:</h4>
<p>Thanks!</p>



<a name="317136921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317136921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317136921">(Dec 21 2022 at 11:30)</a>:</h4>
<p>Now you can port  those two <code>Pi</code> files while waiting for the merge <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="317137049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317137049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317137049">(Dec 21 2022 at 11:31)</a>:</h4>
<p>I'm going to pretend/assume that was aimed at <span class="user-mention" data-user-id="412682">@Moritz Doll</span>!</p>



<a name="317137236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317137236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317137236">(Dec 21 2022 at 11:32)</a>:</h4>
<p>Moritz is having dinner now.</p>



<a name="317137267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317137267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317137267">(Dec 21 2022 at 11:33)</a>:</h4>
<p>Group.Pi landed in <a href="https://github.com/leanprover-community/mathlib4/pull/1088">mathlib4#1088</a></p>



<a name="317137462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317137462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317137462">(Dec 21 2022 at 11:34)</a>:</h4>
<p>And GroupAction.Pi landed in <a href="https://github.com/leanprover-community/mathlib4/pull/1115">mathlib4#1115</a>; so I think it really is just one file</p>



<a name="317155120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317155120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317155120">(Dec 21 2022 at 13:14)</a>:</h4>
<p>I can port <code>Algebra.Ring.Pi</code> tomorrow if nobody does it before me.<br>
As for the errors, did something change about extending <code>structure</code>s from Lean 3 to Lean 4? If a type has a <code>Mul</code> and an <code>Add</code> instance, then a sorried out <code>Ring</code> instance should not skrew up proofs without any good error messages.<br>
Probably I just never encountered this in Lean 3.</p>



<a name="317172508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317172508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317172508">(Dec 21 2022 at 14:32)</a>:</h4>
<p>There has definitely been a change in how instance synthesis works in Lean 4 v Lean 3, because if you set pp.all to true then in Lean 4 you get monster monster terms which we never had in Lean 3 -- stuff like <code>LinearOrder.toPartialOrder.toPreorder.toLE</code>.</p>



<a name="317172893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317172893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317172893">(Dec 21 2022 at 14:34)</a>:</h4>
<p>The first <code>a * b</code> is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">@</span><span class="n">HMul.hMul.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">instHMul.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">NonUnitalNonAssocSemiring.toMul.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">NonUnitalSemiring.toNonUnitalNonAssocSemiring.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
            <span class="o">(</span><span class="bp">@</span><span class="n">Semiring.toNonUnitalSemiring.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
              <span class="o">(</span><span class="bp">@</span><span class="n">Ring.toSemiring.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
                <span class="o">(</span><span class="bp">@</span><span class="n">Ring.mk.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.toSemiring.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.toNeg.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.toSub.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.sub_eq_add_neg.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.zsmul.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.zsmul_zero'.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.zsmul_succ'.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.zsmul_neg'.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.add_left_neg.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.toIntCast.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.intCast_ofNat.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)</span>
                  <span class="o">(</span><span class="bp">@</span><span class="n">Ring.intCast_negSucc.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
                    <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span> <span class="n">src</span><span class="bp">â</span><span class="o">)))))))</span>
      <span class="n">a</span> <span class="n">b</span>
</code></pre></div>
<p>and the second is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">@</span><span class="n">HMul.hMul.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
      <span class="o">(</span><span class="bp">@</span><span class="n">instHMul.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="n">Î²</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span><span class="o">)</span>
        <span class="o">(</span><span class="bp">@</span><span class="n">CauSeq.instMulCauSeq.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91476</span><span class="o">,</span> <span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î±</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">âÂ³</span> <span class="o">(</span><span class="bp">@</span><span class="n">CommRing.toRing.</span><span class="o">{</span><span class="bp">?</span><span class="n">u.91695</span><span class="o">}</span> <span class="n">Î²</span> <span class="n">inst</span><span class="bp">â</span><span class="o">)</span> <span class="n">abv</span> <span class="n">i</span><span class="o">))</span>
      <span class="n">a</span> <span class="n">b</span>
</code></pre></div>



<a name="317173147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317173147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317173147">(Dec 21 2022 at 14:35)</a>:</h4>
<p>The first one traces <code>Mul</code> back up to the sorried <code>Ring</code> instance even though the <code>Mul</code> is already there. The second one catches the <code>Mul</code> you already defined -- this is <code>@CauSeq.instMulCauSeq</code>.</p>



<a name="317192758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317192758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sky Wilshaw <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317192758">(Dec 21 2022 at 16:03)</a>:</h4>
<p>I was looking at porting <code>Algebra.Ring.Pi</code> yesterday, I think it required (a mathlib4 version of) <code>tactic.pi_instances</code>, which I don't think has been ported.</p>



<a name="317192997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317192997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317192997">(Dec 21 2022 at 16:04)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#pi_instances">tactic#pi_instances</a></p>



<a name="317214935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317214935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317214935">(Dec 21 2022 at 17:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq/near/317129815">said</a>:</p>
<blockquote>
<p>I have a mathlib3 PR that removes the use of <code>refine_struct</code> there, if that's useful</p>
</blockquote>
<p>I have a similar PR that removes the use for <code>real.comm_ring</code> at <a href="https://github.com/leanprover-community/mathlib/pull/8146">#8146</a>, although I expect that might have build issues</p>



<a name="317539981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317539981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317539981">(Dec 23 2022 at 11:05)</a>:</h4>
<p>I encountered a new and weird problem, namely that I have lots of casts that seem to be not defeq and there are no <code>simp</code>-lemmas for them. I have no time to work on that until the 25th, so if anyone that knows how casts in the algebraic hierachy work, please have a look at this mess:<br>
<a href="https://github.com/leanprover-community/mathlib4/pull/1124/files#diff-18f1434dcab7d38fad2c5144ab5f653c1eef55b9d1d49d20951e556af4ad0317R432">https://github.com/leanprover-community/mathlib4/pull/1124/files#diff-18f1434dcab7d38fad2c5144ab5f653c1eef55b9d1d49d20951e556af4ad0317R432</a><br>
(I've added a few definitions and lemmas that probably should not exist, but otherwise I had no idea what was going on)</p>



<a name="317540261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317540261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317540261">(Dec 23 2022 at 11:07)</a>:</h4>
<p>the <code>natCast</code> in <code>AddGroupWithOne</code> was previously <code>fun n =&gt; const n</code></p>



<a name="317549955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317549955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317549955">(Dec 23 2022 at 11:57)</a>:</h4>
<p>Can we get the mathlib 4 CI to show errors inline like mathlib 3 does?</p>



<a name="317550671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317550671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317550671">(Dec 23 2022 at 12:01)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">natCast_eq'</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">â</span><span class="o">}</span> <span class="o">:</span>
    <span class="bp">@</span><span class="n">Nat.cast</span> <span class="o">(</span><span class="n">â</span> <span class="bp">â</span> <span class="n">Î²</span><span class="o">)</span> <span class="n">NonAssocRing.toNatCast</span> <span class="n">n</span> <span class="n">m</span> <span class="bp">=</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Î²</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">simp</span>
  <span class="gr">sorry</span>
</code></pre></div>
<p>looks like <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pi.NonAssocRing#doc">docs4#Pi.NonAssocRing</a> was ported incorrectly</p>



<a name="317550728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317550728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317550728">(Dec 23 2022 at 12:01)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">natCast_eq'</span> <span class="o">{</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">â</span><span class="o">}</span> <span class="o">:</span>
    <span class="bp">@</span><span class="n">Nat.cast</span> <span class="o">(</span><span class="n">â</span> <span class="bp">â</span> <span class="n">Î²</span><span class="o">)</span> <span class="n">NonAssocRing.toNatCast</span> <span class="n">n</span> <span class="n">m</span> <span class="bp">=</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">Î²</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">simp</span>
  <span class="gr">sorry</span>
</code></pre></div>
<p>looks like <a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pi.NonAssocRing#doc">docs4#Pi.NonAssocRing</a> was ported incorrectly</p>



<a name="317550729"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317550729" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317550729">(Dec 23 2022 at 12:01)</a>:</h4>
<p>Oh. The docs are not up to date :(</p>



<a name="317550877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317550877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317550877">(Dec 23 2022 at 12:02)</a>:</h4>
<p>(bad wifi. Sorry for double post)</p>



<a name="317554751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317554751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317554751">(Dec 23 2022 at 12:22)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib4/pull/1185">mathlib4#1185</a> should fix this</p>



<a name="317555067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317555067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317555067">(Dec 23 2022 at 12:24)</a>:</h4>
<p>Do you understand why mathlib3 didn't hit this issue?</p>



<a name="317556177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317556177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317556177">(Dec 23 2022 at 12:30)</a>:</h4>
<p>Yes, because we broke the file in the port. It was not broken in mathlib3</p>



<a name="317556233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317556233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317556233">(Dec 23 2022 at 12:31)</a>:</h4>
<p>(The reason is that in mathlib3 we implemented things with a tactic that doesn't exist in mathlib4)</p>



<a name="317556315"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317556315" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317556315">(Dec 23 2022 at 12:31)</a>:</h4>
<p>I suppose the safe way to handle this is to backport the removal of the tactic first (to make sure everything works), then do a regular port</p>



<a name="317556988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317556988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317556988">(Dec 23 2022 at 12:34)</a>:</h4>
<p>I guess the most efficient way is to merge your fix but then think about backporting the removal of <code>pi_instance</code> in files that are sufficient far away from the rising tide.</p>



<a name="317655166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317655166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317655166">(Dec 23 2022 at 23:25)</a>:</h4>
<p>This should be unblocked again</p>



<a name="317672999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317672999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317672999">(Dec 24 2022 at 04:38)</a>:</h4>
<p>I've merged master (and your fix is definitively in there), but it did not fix the issue</p>



<a name="317673017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317673017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317673017">(Dec 24 2022 at 04:39)</a>:</h4>
<p>it seems there are other instances where we have defeq problems</p>



<a name="317685406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317685406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317685406">(Dec 24 2022 at 07:55)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/Pi.addMonoidWithOne">docs#Pi.addMonoidWithOne</a> is to blame, it also wasn't ported correctly</p>



<a name="317685463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317685463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317685463">(Dec 24 2022 at 07:56)</a>:</h4>
<p>Default arguments are dangerous because if we forget to port them, we get the wrong thing instead of an error</p>



<a name="317686045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317686045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317686045">(Dec 24 2022 at 08:05)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib4/pull/1197">mathlib4#1197</a></p>



<a name="317686510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317686510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317686510">(Dec 24 2022 at 08:11)</a>:</h4>
<p>thanks so much.</p>



<a name="317686527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317686527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317686527">(Dec 24 2022 at 08:11)</a>:</h4>
<p>That does fix the errors</p>



<a name="317686929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317686929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317686929">(Dec 24 2022 at 08:17)</a>:</h4>
<p>Dumb question: why is this in a different place than in mathlib 3?</p>



<a name="317686937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317686937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317686937">(Dec 24 2022 at 08:17)</a>:</h4>
<p>Ad-hoc thingy?</p>



<a name="317687043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317687043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317687043">(Dec 24 2022 at 08:18)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/master/src/data/nat/cast/basic.lean#L255">https://github.com/leanprover-community/mathlib/blob/master/src/data/nat/cast/basic.lean#L255</a></p>



<a name="317687145"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317687145" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317687145">(Dec 24 2022 at 08:19)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib4/pull/1088">mathlib4#1088</a></p>



<a name="317687722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317687722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317687722">(Dec 24 2022 at 08:26)</a>:</h4>
<p>So there is still <a href="https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Data/Nat/Cast/Basic.lean#L284">https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Data/Nat/Cast/Basic.lean#L284</a> as well; is this good/bad?</p>



<a name="317688171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317688171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317688171">(Dec 24 2022 at 08:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq/near/317686929">said</a>:</p>
<blockquote>
<p>Dumb question: why is this in a different place than in mathlib 3?</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="111080">Floris van Doorn</span> suggested this in <a href="#narrow/stream/287929-mathlib4/topic/not.20porting.20pi_instance/near/315626876">a previous thread</a></p>



<a name="317688198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317688198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317688198">(Dec 24 2022 at 08:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq/near/317687722">said</a>:</p>
<blockquote>
<p>So there is still <a href="https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Data/Nat/Cast/Basic.lean#L284">https://github.com/leanprover-community/mathlib4/blob/master/Mathlib/Data/Nat/Cast/Basic.lean#L284</a> as well; is this good/bad?</p>
</blockquote>
<p>I guess bad<del>, let me rewrite to use that</del> but it's not imported yet for me to use</p>



<a name="317688411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317688411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317688411">(Dec 24 2022 at 08:33)</a>:</h4>
<p>"messy" is probably more accurate than "bad"</p>



<a name="317690834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317690834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317690834">(Dec 24 2022 at 08:57)</a>:</h4>
<p>Can we get a porting note about how this instance was moved? Moving instances is always tricky, because of their implicit nature</p>



<a name="317691522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317691522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317691522">(Dec 24 2022 at 09:03)</a>:</h4>
<p>there seems to be one error left which probably also comes from a diamond: <code>sub_add_sub_cancel</code> times out on l592 in<br>
<a href="https://github.com/leanprover-community/mathlib4/pull/1124/files#diff-18f1434dcab7d38fad2c5144ab5f653c1eef55b9d1d49d20951e556af4ad0317R592">https://github.com/leanprover-community/mathlib4/pull/1124/files#diff-18f1434dcab7d38fad2c5144ab5f653c1eef55b9d1d49d20951e556af4ad0317R592</a><br>
My guess was that the <code>Sub</code> instance is somehow bad and I replaced it by the analogue of the <code>Add</code> instance, but that did not help, so I am suspecting that the Pi-stuff is to blame again.</p>



<a name="317695591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317695591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317695591">(Dec 24 2022 at 09:40)</a>:</h4>
<p>You're probably right</p>



<a name="317695660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317695660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317695660">(Dec 24 2022 at 09:41)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib4_docs/find/?pattern=Pi.addGroup#doc">docs4#Pi.addGroup</a></p>



<a name="317695875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317695875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317695875">(Dec 24 2022 at 09:42)</a>:</h4>
<p>Looks ok to me</p>



<a name="317695946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317695946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317695946">(Dec 24 2022 at 09:43)</a>:</h4>
<p>You can use the infoview to debug the diamond and tactics like <code>dsimp [Pi.addGroup]</code> etc</p>



<a name="317696087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317696087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317696087">(Dec 24 2022 at 09:44)</a>:</h4>
<p>It's apparent we need a linter to check that we don't define <code>WeakInstance Foo</code> and <code>StrongInstance Foo</code> in a way that causes a diamond</p>



<a name="317696154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317696154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317696154">(Dec 24 2022 at 09:45)</a>:</h4>
<p>Or we remove all the default-valued fields so that this doesn't happen in the first place</p>



<a name="317696301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317696301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317696301">(Dec 24 2022 at 09:46)</a>:</h4>
<p>I've used <code>set_option pp.all true</code> and that is a huge mess, but without that I cannot see anything useful in the infoview. I haven't considered <code>dsimp</code></p>



<a name="317696578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317696578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317696578">(Dec 24 2022 at 09:49)</a>:</h4>
<p>You can use the widgets in the infoview instead of pp.all</p>



<a name="317696616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317696616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317696616">(Dec 24 2022 at 09:49)</a>:</h4>
<p>You want to find where the instances come from (by clicking on <code>-</code>) and unfold them until you see a default coming from somewhere</p>



<a name="317745603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317745603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317745603">(Dec 24 2022 at 16:17)</a>:</h4>
<p>I had a quick look and nothing jumped out as obvious</p>



<a name="317745758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317745758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317745758">(Dec 24 2022 at 16:19)</a>:</h4>
<p>The usual approach of using <code>convert _ using 1</code> times out</p>



<a name="317775311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317775311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317775311">(Dec 24 2022 at 23:15)</a>:</h4>
<p>I pushed a commit that gets it to as simple as possible a case where <code>exact sub</code> fails</p>



<a name="317775559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317775559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317775559">(Dec 24 2022 at 23:19)</a>:</h4>
<p>Ah, fixed!</p>



<a name="317775569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317775569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317775569">(Dec 24 2022 at 23:19)</a>:</h4>
<p>I think this is just a Lean4 unification problem</p>



<a name="317775641"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317775641" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317775641">(Dec 24 2022 at 23:20)</a>:</h4>
<p>For whatever reason, <code>rw [some_lemma]</code> failed but <code>exact some_lemma.symm</code> worked</p>



<a name="317775687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317775687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317775687">(Dec 24 2022 at 23:21)</a>:</h4>
<p>It's pretty scary that this fails in such a confusing way</p>



<a name="317777625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317777625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317777625">(Dec 24 2022 at 23:54)</a>:</h4>
<p>that sounds like a bug to me. The <code>rw</code> should clearly not fail if all the instances are fine.</p>



<a name="317778124"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317778124" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317778124">(Dec 25 2022 at 00:01)</a>:</h4>
<p>My hunch is that we actually need to define the Pi instances more like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="k">Pi</span><span class="bp">.</span><span class="n">group'</span><span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">â</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="bp">â</span> <span class="n">i</span><span class="o">,</span> <span class="n">Group</span> <span class="bp">&lt;|</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">Group</span> <span class="o">(</span><span class="bp">â</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">{</span> <span class="k">Pi</span><span class="bp">.</span><span class="n">divInvMonoid</span> <span class="k">with</span>
    <span class="n">mul</span> <span class="o">:=</span> <span class="n">Mul.mul</span>
    <span class="n">div</span> <span class="o">:=</span> <span class="n">Div.div</span>
    <span class="n">inv</span> <span class="o">:=</span> <span class="n">Inv.inv</span>
    <span class="n">one</span> <span class="o">:=</span> <span class="n">One.one</span>
    <span class="n">zpow</span> <span class="o">:=</span> <span class="k">fun</span> <span class="n">z</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">=&gt;</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">^</span> <span class="n">z</span>
    <span class="c1">--pi_instance</span>
    <span class="n">mul_left_inv</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">mul_left_inv</span> <span class="n">_</span>
    <span class="o">}</span>
</code></pre></div>
<p>that is, copy over all the data fields manually in ways such that the inner operators unify differently</p>



<a name="317778220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317778220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317778220">(Dec 25 2022 at 00:02)</a>:</h4>
<p>We effectively do this in Mathlib3, and the port dropped this; I've run into problems in Lean3 in the past where this helped</p>



<a name="317779136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317779136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317779136">(Dec 25 2022 at 00:16)</a>:</h4>
<p>branch4#eric-wieser/test-pi-instances is hitting timeouts when I try to do the above, which suggests to me this might indeed be the fix</p>



<a name="317779163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317779163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317779163">(Dec 25 2022 at 00:17)</a>:</h4>
<p>In particular,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">commRing</span> <span class="o">[</span><span class="bp">â</span> <span class="n">i</span><span class="o">,</span> <span class="n">CommRing</span> <span class="bp">&lt;|</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">CommRing</span> <span class="o">(</span><span class="bp">â</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">{</span> <span class="k">Pi</span><span class="bp">.</span><span class="n">ring</span><span class="o">,</span> <span class="k">Pi</span><span class="bp">.</span><span class="n">commSemiring</span> <span class="k">with</span>
    <span class="n">zero</span> <span class="o">:=</span> <span class="n">Zero.zero</span>
    <span class="n">mul</span> <span class="o">:=</span> <span class="n">Mul.mul</span>
    <span class="n">one</span> <span class="o">:=</span> <span class="n">One.one</span>
    <span class="n">sub</span> <span class="o">:=</span> <span class="n">Sub.sub</span>
    <span class="n">add</span> <span class="o">:=</span> <span class="n">Add.add</span> <span class="o">}</span>
</code></pre></div>
<p>times out</p>



<a name="317779175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317779175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317779175">(Dec 25 2022 at 00:17)</a>:</h4>
<p>Which looks a bit like <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span>'s frame/coframe problem</p>



<a name="317779905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317779905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317779905">(Dec 25 2022 at 00:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq/near/317778124">said</a>:</p>
<blockquote>
<p>My hunch is that we actually need to define the Pi instances more like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="k">Pi</span><span class="bp">.</span><span class="n">group'</span><span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">â</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="bp">â</span> <span class="n">i</span><span class="o">,</span> <span class="n">Group</span> <span class="bp">&lt;|</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">Group</span> <span class="o">(</span><span class="bp">â</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">{</span> <span class="k">Pi</span><span class="bp">.</span><span class="n">divInvMonoid</span> <span class="k">with</span>
    <span class="n">mul</span> <span class="o">:=</span> <span class="n">Mul.mul</span>
    <span class="n">div</span> <span class="o">:=</span> <span class="n">Div.div</span>
    <span class="n">inv</span> <span class="o">:=</span> <span class="n">Inv.inv</span>
    <span class="n">one</span> <span class="o">:=</span> <span class="n">One.one</span>
    <span class="n">zpow</span> <span class="o">:=</span> <span class="k">fun</span> <span class="n">z</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">=&gt;</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">^</span> <span class="n">z</span>
    <span class="c1">--pi_instance</span>
    <span class="n">mul_left_inv</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">intros</span><span class="bp">;</span> <span class="n">ext</span><span class="bp">;</span> <span class="n">exact</span> <span class="n">mul_left_inv</span> <span class="n">_</span>
    <span class="o">}</span>
</code></pre></div>
<p>that is, copy over all the data fields manually in ways such that the inner operators unify differently</p>
</blockquote>
<p>Does this suggestion "go against new structures"? I would be interested in hearing the views of the people who properly understand why the switch to new structures is important. <span class="user-mention" data-user-id="111080">@Floris van Doorn</span> ?</p>



<a name="317780055"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317780055" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317780055">(Dec 25 2022 at 00:31)</a>:</h4>
<p>Note that also that <code>Pi</code> was not the only very slow instance in that complete lattice file. <a href="#narrow/stream/287929-mathlib4/topic/Performance.20issue.20with.20.60CompleteBooleanAlgebra.60/near/316817990">Here</a> I give three examples of super-speedup hacks, and only one involves Pi.</p>



<a name="317780242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317780242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317780242">(Dec 25 2022 at 00:34)</a>:</h4>
<p>I'm finding these things difficult to minimise because as I slim down the questions the timeouts get shorter. I replace a bunch of proofs with <code>sorry</code>s and a five second declaration goes down to two seconds. The actual time taken in the mathlib file is horrible. One could easily switch to my slick constructions in the link above and leave a porting note but my guess is that this is going to keep happening and I've seen situations where the data needed to feed to <code>mk</code> is not to hand; we're lucky in the linked examples.</p>
<p>By the way I don't know how to switch the profiler on,  but I would love to report something of the form "elaboration of this declaration took n heart beats on lean version blah, which was about 5 seconds on my new fast machine".</p>



<a name="317780354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317780354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317780354">(Dec 25 2022 at 00:36)</a>:</h4>
<p>I don't think this goes against new style structures necessarily. The conflict is between "a pi type has multiplication because it is a monoid because every fibre is a monoid" and "a pi type has multiplication because every fibre has multiplication because every fibre is a monoid". These are defeq, but tricky to unify and this only gets worse the more typeclass paths there are (eg for <code>Ring</code>)</p>



<a name="317780638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317780638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317780638">(Dec 25 2022 at 00:41)</a>:</h4>
<p>Another thing which would be nice would be a machine which de-mathlibiffied my examples because the code in the issue I opened <a href="https://github.com/leanprover/lean4/issues/1986">https://github.com/leanprover/lean4/issues/1986</a> took ages for me to write -- for example notation is getting complex and <code>notation3</code> is in mathlib and I don't really understand the code so stripping it out was hard for me. Also there is this crazy bug I run into in VS Code where jump to definition will sometimes jump to a file which is not imported, which is really confusing. Feels a bit like the issue where if you change a file you import and write to disc, Lean4 doesn't auto-reload. Also difficult to minimise -- stuff is just broken and you kill all Lean process and restart VS Code and it usually fixes itself.</p>



<a name="317961491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317961491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317961491">(Dec 26 2022 at 14:01)</a>:</h4>
<p>This PR is now ready for review</p>



<a name="317981164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/Data.Real.CauSeq/near/317981164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/Data.2EReal.2ECauSeq.html#317981164">(Dec 26 2022 at 16:36)</a>:</h4>
<p>Let's make sure to update the porting comments before merging</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>