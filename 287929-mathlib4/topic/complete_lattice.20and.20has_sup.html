---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html">complete_lattice and has_sup</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="316080054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316080054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316080054">(Dec 15 2022 at 16:13)</a>:</h4>
<p>As can be seen elsewhere, I wanted to open a PR to start working on <code>order.complete_lattice</code>. And the very first line is tricky. I'm sure this has been discussed but I can't find it. In Lean 3 we had <a href="https://leanprover-community.github.io/mathlib_docs/find/has_sup">docs#has_sup</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/has_Sup">docs#has_Sup</a>. How do we translate those?</p>



<a name="316081201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316081201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316081201">(Dec 15 2022 at 16:19)</a>:</h4>
<p>I've found <a href="#narrow/stream/270676-lean4/topic/sup.2FSup">https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/sup.2FSup</a> but it was inconclusive. Now is the time to decide something.</p>



<a name="316081387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316081387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316081387">(Dec 15 2022 at 16:19)</a>:</h4>
<p>We just decided to keep the Lean 3 capitalisation for <code>Icc</code> and friends. Should we do the same for <code>sup</code> and <code>Sup</code>?</p>



<a name="316081525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316081525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316081525">(Dec 15 2022 at 16:20)</a>:</h4>
<p>Also, wait until you get to <a href="https://tqft.net/mathlib/probability/independence">file#probability/independence</a> <span aria-label="grinning face with smiling eyes" class="emoji emoji-1f601" role="img" title="grinning face with smiling eyes">:grinning_face_with_smiling_eyes:</span></p>



<a name="316082309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316082309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316082309">(Dec 15 2022 at 16:23)</a>:</h4>
<p>Oh no. SUP?</p>



<a name="316082587"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316082587" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316082587">(Dec 15 2022 at 16:24)</a>:</h4>
<p>That doesn't work for lemma names, because it would get turned back into <code>sup</code></p>



<a name="316091435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316091435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316091435">(Dec 15 2022 at 17:02)</a>:</h4>
<p>SupCat</p>



<a name="316092947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316092947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316092947">(Dec 15 2022 at 17:09)</a>:</h4>
<p>what if <code>has_sup</code> becomes <code>BinarySup</code> and <code>has_Sup</code> becomes <code>Sup</code>?</p>



<a name="316093037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093037">(Dec 15 2022 at 17:09)</a>:</h4>
<p>That matches e.g. <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.limits.has_binary_products">docs#category_theory.limits.has_binary_products</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.limits.has_products">docs#category_theory.limits.has_products</a></p>



<a name="316093180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093180">(Dec 15 2022 at 17:10)</a>:</h4>
<p>So you want to write <code>binarySup_binarySup_binarySup_comm</code> for <a href="https://leanprover-community.github.io/mathlib_docs/find/sup_sup_sup_comm">docs#sup_sup_sup_comm</a>?</p>



<a name="316093246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093246">(Dec 15 2022 at 17:10)</a>:</h4>
<p>that lemma has a ridiculous name anyway</p>



<a name="316093330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093330" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093330">(Dec 15 2022 at 17:10)</a>:</h4>
<p>Thanks! I named it</p>



<a name="316093340"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093340" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093340">(Dec 15 2022 at 17:10)</a>:</h4>
<p>This is about the name of the class not the notation though</p>



<a name="316093477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093477">(Dec 15 2022 at 17:11)</a>:</h4>
<p>e.g. the name of the class for <code>\in</code> is <code>Membership</code></p>



<a name="316093506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093506">(Dec 15 2022 at 17:11)</a>:</h4>
<p>but the operator is called <code>mem</code></p>



<a name="316093658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093658">(Dec 15 2022 at 17:12)</a>:</h4>
<p>I don't think a longer name is much of a problem here since it will be rarely used</p>



<a name="316093810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316093810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316093810">(Dec 15 2022 at 17:12)</a>:</h4>
<p>I think binary sup (the operator) should be called <code>sup</code> and I hope that's not under discussion</p>



<a name="316094682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316094682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316094682">(Dec 15 2022 at 17:16)</a>:</h4>
<p>Oops, I manage to split this conversation into two threads because I wanted to connect with the older discussion.</p>



<a name="316095062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316095062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316095062">(Dec 15 2022 at 17:17)</a>:</h4>
<p>let's keep this one on the name of the notation classes</p>



<a name="316095176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316095176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316095176">(Dec 15 2022 at 17:18)</a>:</h4>
<p>although I suppose that it depends somewhat on the name of the operations</p>



<a name="316102479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316102479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316102479">(Dec 15 2022 at 17:50)</a>:</h4>
<p>I actually find <code>sup</code> for the binary operation the most confusing one</p>



<a name="316106317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316106317" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316106317">(Dec 15 2022 at 18:07)</a>:</h4>
<p>in part because it's not the terminology I'm used to, e.g., <a href="https://ncatlab.org/nlab/show/join">nlab</a></p>
<blockquote>
<p>A poset that has all finite joins is a join-semilattice [= <code>semilattice_sup + has_bot</code>]. A poset that has all suprema is a suplattice [= <code>complete_semilattice_Sup</code>].</p>
</blockquote>



<a name="316137706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316137706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316137706">(Dec 15 2022 at 20:50)</a>:</h4>
<p>The other thread is <a href="#narrow/stream/270676-lean4/topic/sup.2FSup">here</a></p>



<a name="316225369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316225369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316225369">(Dec 16 2022 at 10:00)</a>:</h4>
<p>We now settled on names for those functions. I started to update the file. But it would be nice to have help from mathport. Indeed mathport decided to rename all <code>Sup</code> to <code>sup</code> and it doesn't help at all with search and replace to enforce the new names. Can we somehow tell mathport to try again with the chosen <code>sup supₛ supᵢ inf infₛ infᵢ </code> as well as the corresponding class names (see <a href="https://github.com/leanprover-community/mathlib4/pull/1053">mathlib4#1053</a>).</p>



<a name="316225433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316225433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316225433">(Dec 16 2022 at 10:01)</a>:</h4>
<p>Can you get the oneshot feature to work?</p>



<a name="316225501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316225501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316225501">(Dec 16 2022 at 10:01)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathport/blob/master/Oneshot/README.md">https://github.com/leanprover-community/mathport/blob/master/Oneshot/README.md</a></p>



<a name="316227722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316227722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316227722">(Dec 16 2022 at 10:14)</a>:</h4>
<p>I'll try that later today</p>



<a name="316228053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316228053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316228053">(Dec 16 2022 at 10:16)</a>:</h4>
<p>If you already have a port of a file, you should be able to get git to help you here, by setting up your history as</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>old-mathport-output ------ your-partial-port
     \
      \------- new-mathport-output
</code></pre></div>
<p>and then merging the heads</p>



<a name="316241798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316241798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316241798">(Dec 16 2022 at 11:26)</a>:</h4>
<p>I did some more by hand, pushing hopefully complete fixes up to line 465. But I'm going to stop for the night (possibly even the whole weekend...)</p>



<a name="316256991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316256991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316256991">(Dec 16 2022 at 12:46)</a>:</h4>
<p>I did a mathport oneshot pass and pushed</p>



<a name="316275364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316275364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316275364">(Dec 16 2022 at 14:08)</a>:</h4>
<p>I did a big renaming and cleanup pass. The file now starts to make sense. I'm releasing the lock on this PR.</p>



<a name="316409207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316409207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316409207">(Dec 17 2022 at 06:43)</a>:</h4>
<p>Awesome! I did a little more, and we're getting closer.</p>



<a name="316411816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316411816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316411816">(Dec 17 2022 at 07:15)</a>:</h4>
<p>Okay, it compiles now, and I fixed a bunch of names involving <code>Sup</code>.</p>



<a name="316411831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316411831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316411831">(Dec 17 2022 at 07:15)</a>:</h4>
<p>There is some linting to do, if someone wants to look at that.</p>



<a name="316497982"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316497982" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316497982">(Dec 17 2022 at 18:44)</a>:</h4>
<p>The complete lattice file is almost linted but there are two remaining errors about a simp lemma not being able to simplify its left-hand side.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[simp]</span>
<span class="kd">theorem</span> <span class="n">sup</span><span class="bp">ᵢ</span><span class="n">_inf</span><span class="bp">ᵢ</span><span class="n">_ge_nat_add</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="bp">⨆</span> <span class="n">n</span><span class="o">,</span> <span class="bp">⨅</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">k</span><span class="o">))</span> <span class="bp">=</span> <span class="bp">⨆</span> <span class="n">n</span><span class="o">,</span> <span class="bp">⨅</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="o">:=</span>
  <span class="kd">by</span>
  <span class="k">have</span> <span class="n">hf</span> <span class="o">:</span> <span class="n">Monotone</span> <span class="k">fun</span> <span class="n">n</span> <span class="bp">=&gt;</span> <span class="bp">⨅</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">fun</span> <span class="n">n</span> <span class="n">m</span> <span class="n">h</span> <span class="bp">=&gt;</span> <span class="n">binf</span><span class="bp">ᵢ</span><span class="n">_mono</span> <span class="k">fun</span> <span class="n">i</span> <span class="bp">=&gt;</span> <span class="n">h.trans</span>
  <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">Monotone.sup</span><span class="bp">ᵢ</span><span class="n">_nat_add</span> <span class="n">hf</span> <span class="n">k</span><span class="o">]</span>
  <span class="bp">·</span> <span class="n">simp_rw</span> <span class="o">[</span><span class="n">inf</span><span class="bp">ᵢ</span><span class="n">_ge_eq_inf</span><span class="bp">ᵢ</span><span class="n">_nat_add</span><span class="o">,</span> <span class="bp">←</span> <span class="n">Nat.add_assoc</span><span class="o">]</span>
</code></pre></div>
<p>Note that, right after this lemma (where the linter already complains), you can try</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="bp">⨆</span> <span class="n">n</span><span class="o">,</span> <span class="bp">⨅</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">k</span><span class="o">))</span> <span class="bp">=</span> <span class="bp">⨆</span> <span class="n">n</span><span class="o">,</span> <span class="bp">⨅</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span> <span class="o">:=</span> <span class="kd">by</span>
   <span class="n">simp</span>
</code></pre></div>
<p>and it works. The version with <code>simp only [supᵢ_infᵢ_ge_nat_add]</code> also works. The only weird thing is that <code>simp?</code> reports <code>simp only [not_le, supᵢ_infᵢ_ge_nat_add]</code>. And <code>simp only [not_le]</code> doesn't seem to do anything.</p>



<a name="316515073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316515073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316515073">(Dec 17 2022 at 22:01)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> do you understand what is going with the simp linter in this example?</p>



<a name="316515093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316515093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316515093">(Dec 17 2022 at 22:01)</a>:</h4>
<p>This is in <a href="https://github.com/leanprover-community/mathlib4/pull/1053">mathlib4#1053</a></p>



<a name="316533972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316533972" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316533972">(Dec 18 2022 at 02:27)</a>:</h4>
<p>This is a hard nut to crack.  I can't really tell what's going on here either.  Weirdly enough, if I call <code>simpNF.test</code> directly then the linter passes.  It's only when run via <code>#lint</code> that it complains. <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="316534036"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316534036" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316534036">(Dec 18 2022 at 02:28)</a>:</h4>
<p>Either way, <code>supᵢ_infᵢ_ge_nat_add</code> should not be marked simp, the subterm <code>?f (i + ?k)</code> produces an ugly higher-order unification problem.</p>



<a name="316562493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/316562493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#316562493">(Dec 18 2022 at 09:56)</a>:</h4>
<p>Okay, I've removed the simp there, and left a link to this thread. I'll merge this PR soon! Thanks all for the work on this one. On to <code>data.list.basic</code>. :-)</p>



<a name="317129679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/317129679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#317129679">(Dec 21 2022 at 10:52)</a>:</h4>
<p>Is the use of <code>ge</code> instead of <code>le</code> causing the issue?</p>



<a name="317183548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/317183548" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#317183548">(Dec 21 2022 at 15:21)</a>:</h4>
<p>It doesn't seem to be. Interestingly, Patrick's example is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="bp">⨆</span> <span class="n">n</span><span class="o">,</span> <span class="bp">⨅</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">k</span><span class="o">))</span> <span class="bp">=</span> <span class="bp">⨆</span> <span class="n">n</span><span class="o">,</span> <span class="bp">⨅</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span>
</code></pre></div>
<p>and Chris' example <a href="#narrow/stream/287929-mathlib4/topic/Data.2ESet.2ELattice/near/317124508">here</a> is </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">(</span><span class="bp">⋃</span> <span class="n">n</span><span class="o">,</span> <span class="bp">⋂</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="o">(</span><span class="n">i</span> <span class="bp">+</span> <span class="n">k</span><span class="o">))</span> <span class="bp">=</span> <span class="bp">⋃</span> <span class="n">n</span><span class="o">,</span> <span class="bp">⋂</span> <span class="n">i</span> <span class="bp">≥</span> <span class="n">n</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span>
</code></pre></div>
<p>which are, erm, kind of similar.</p>



<a name="317188231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/complete_lattice%20and%20has_sup/near/317188231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/complete_lattice.20and.20has_sup.html#317188231">(Dec 21 2022 at 15:42)</a>:</h4>
<p>I've recorded the issue <a href="https://github.com/leanprover/std4/issues/71">here</a> but clearly the short term solution is just to remove the <code>simp</code> and move on.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>