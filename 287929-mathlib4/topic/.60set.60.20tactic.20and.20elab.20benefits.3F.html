---
layout: archive
title: Zulip Chat Archive
permalink: /stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/index.html">mathlib4</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html">`set` tactic and elab benefits?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="275020635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275020635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ian Benway <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275020635">(Mar 11 2022 at 19:13)</a>:</h4>
<p>Hi! In trying to learn Lean 4 metaprogramming, I've been working on porting the <code>set</code> tactic. I have a solution that (seems like it) works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">syntax</span> <span class="o">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">set</span><span class="o">)</span> <span class="s2">"set "</span> <span class="n">ident</span> <span class="o">(</span><span class="s2">" : "</span> <span class="n">term</span><span class="o">)</span><span class="bp">?</span> <span class="s2">" := "</span> <span class="n">term</span> <span class="o">(</span><span class="s2">" with "</span> <span class="s2">"←"</span><span class="bp">?</span> <span class="n">ident</span><span class="o">)</span><span class="bp">?</span> <span class="o">:</span> <span class="n">tactic</span>

<span class="n">macro_rules</span>
<span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span><span class="o">)</span> <span class="bp">=&gt;</span>
  <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="k">let</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="bp">;</span> <span class="n">try</span> <span class="n">rw</span> <span class="o">[(</span><span class="n">id</span> <span class="n">rfl</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span><span class="o">)]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">)</span>
<span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="o">:</span> <span class="bp">$</span><span class="n">tp</span><span class="o">:</span><span class="n">term</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span><span class="o">)</span> <span class="bp">=&gt;</span>
  <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="k">let</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:</span> <span class="bp">$</span><span class="n">tp</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="bp">;</span> <span class="n">try</span> <span class="n">try</span> <span class="n">rw</span> <span class="o">[(</span><span class="n">id</span> <span class="n">rfl</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span><span class="o">)]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">)</span>
<span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="o">:</span> <span class="bp">$</span><span class="n">tp</span><span class="o">:</span><span class="n">term</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span> <span class="k">with</span> <span class="bp">$</span><span class="n">h</span><span class="o">:</span><span class="n">ident</span><span class="o">)</span> <span class="bp">=&gt;</span>
  <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="k">let</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:</span> <span class="bp">$</span><span class="n">tp</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="bp">;</span> <span class="n">try</span> <span class="n">rw</span> <span class="o">[(</span><span class="n">id</span> <span class="n">rfl</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span><span class="o">)]</span> <span class="n">at</span> <span class="bp">*;</span> <span class="k">have</span> <span class="bp">$</span><span class="n">h</span> <span class="o">:</span> <span class="bp">$</span><span class="n">a</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">pv</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">)</span>
<span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span> <span class="k">with</span> <span class="bp">$</span><span class="n">h</span><span class="o">:</span><span class="n">ident</span><span class="o">)</span> <span class="bp">=&gt;</span>
  <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="k">let</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="bp">;</span> <span class="k">have</span> <span class="bp">$</span><span class="n">h</span> <span class="o">:</span> <span class="bp">$</span><span class="n">a</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">pv</span> <span class="o">:=</span> <span class="n">rfl</span><span class="bp">;</span> <span class="n">try</span> <span class="n">rw</span> <span class="o">[(</span><span class="n">id</span> <span class="n">rfl</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span><span class="o">)]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">)</span>
<span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="o">:</span> <span class="bp">$</span><span class="n">tp</span><span class="o">:</span><span class="n">term</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span> <span class="k">with</span> <span class="bp">←$</span><span class="n">h</span><span class="o">:</span><span class="n">ident</span><span class="o">)</span> <span class="bp">=&gt;</span>
  <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="k">let</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:</span> <span class="bp">$</span><span class="n">tp</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="bp">;</span> <span class="n">try</span> <span class="n">rw</span> <span class="o">[(</span><span class="n">id</span> <span class="n">rfl</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span><span class="o">)]</span> <span class="n">at</span> <span class="bp">*;</span> <span class="k">have</span> <span class="bp">$</span><span class="n">h</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">)</span>
<span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span> <span class="k">with</span> <span class="bp">←$</span><span class="n">h</span><span class="o">:</span><span class="n">ident</span><span class="o">)</span> <span class="bp">=&gt;</span>
  <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="k">let</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="bp">;</span> <span class="n">try</span> <span class="n">rw</span> <span class="o">[(</span><span class="n">id</span> <span class="n">rfl</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span><span class="o">)]</span> <span class="n">at</span> <span class="bp">*;</span> <span class="k">have</span> <span class="bp">$</span><span class="n">h</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">)</span>
</code></pre></div>
<p>I've spent way longer than I care to admit trying to write it with <code>elab_rules</code> and defining my own functions for adding to the context, changing variable names, etc. But the solution above is infinitely simpler, albeit a little ungraceful and probably written redundantly. So I'm wondering if there's a benefit to using an elaborator here, as apposed to a macro.<br>
Also any criticism of this solution is very much welcome : )</p>



<a name="275021550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275021550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275021550">(Mar 11 2022 at 19:20)</a>:</h4>
<p>You can use <code>$[]?</code> in the syntax quotations:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="bp">$</span><span class="o">[:</span> <span class="bp">$</span><span class="n">tp</span><span class="o">:</span><span class="n">term</span><span class="o">]</span><span class="bp">?</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span> <span class="bp">$</span><span class="o">[</span><span class="k">with</span> <span class="bp">$</span><span class="o">[</span><span class="bp">←</span><span class="o">]</span><span class="bp">?</span> <span class="bp">$</span><span class="n">h</span><span class="o">:</span><span class="n">ident</span><span class="o">]</span><span class="bp">?</span><span class="o">)</span> <span class="bp">=&gt;</span>
</code></pre></div>
<p>Not sure how to match the ← though, see my question in the simpa thread.</p>



<a name="275113197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275113197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ian Benway <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275113197">(Mar 12 2022 at 19:32)</a>:</h4>
<p>Thanks! With the answer to that question in the simpa thread, I thought I'd be able to do something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="bp">$</span><span class="o">[:</span> <span class="bp">$</span><span class="n">tp</span><span class="o">:</span><span class="n">term</span><span class="o">]</span><span class="bp">?</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span> <span class="bp">$</span><span class="o">[</span><span class="k">with</span> <span class="bp">$</span><span class="o">[</span><span class="bp">$</span><span class="n">rev</span><span class="bp">?</span><span class="o">:(</span><span class="bp">&amp;</span><span class="s2">"←"</span><span class="o">)]</span><span class="bp">?</span> <span class="bp">$</span><span class="n">h</span><span class="o">:</span><span class="n">ident</span><span class="o">]</span><span class="bp">?</span><span class="o">)</span>
</code></pre></div>
<p>or</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="bp">$</span><span class="o">[:</span> <span class="bp">$</span><span class="n">tp</span><span class="o">:</span><span class="n">term</span><span class="o">]</span><span class="bp">?</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span> <span class="bp">$</span><span class="o">[</span><span class="k">with</span> <span class="bp">$</span><span class="n">rev</span><span class="bp">?</span><span class="o">:(</span><span class="bp">&amp;</span><span class="s2">"←"</span><span class="o">)</span> <span class="bp">$</span><span class="n">h</span><span class="o">:</span><span class="n">ident</span><span class="o">]</span><span class="bp">?</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="k">do</span>
</code></pre></div>
<p>But I get the same error for both (<code>expected ')'</code>).</p>



<a name="275115477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275115477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275115477">(Mar 12 2022 at 20:24)</a>:</h4>
<p>This syntax does not exist: <code>:(&amp;"←")</code>. See the "simpa" thread for how to optionally insert a token, without testing it should be something like <code>$[←%$rev?]?</code></p>



<a name="275116249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275116249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275116249">(Mar 12 2022 at 20:43)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> why did you say that it was a misuse in the "simpa" thread? If this is the case, I think we could have a proper way of doing so</p>



<a name="275144709"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275144709" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275144709">(Mar 13 2022 at 09:54)</a>:</h4>
<p><span class="user-mention" data-user-id="451983">@Arthur Paulino</span> Mostly because I did not have this use case in mind while implementing the feature. One should keep in mind that this will also copy the source position from the token, which is the original use case, but this is of course also true for "regular" antiquotations, in a way.</p>



<a name="275996191"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275996191" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ian Benway <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275996191">(Mar 21 2022 at 00:45)</a>:</h4>
<p>This is super helpful! Could I please get permission to push what I have as a branch to Mathlib4? Github username: Beanway144</p>



<a name="275997466"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275997466" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275997466">(Mar 21 2022 at 01:15)</a>:</h4>
<p><span class="user-mention" data-user-id="462786">@Ian Benway</span> the Mathlib4 repo is not completely set yet (<code>master</code> branch is not protected, CI is not setup etc) but in the meantime you can open a PR from a fork to start off the process</p>



<a name="275998814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/275998814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ian Benway <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#275998814">(Mar 21 2022 at 01:51)</a>:</h4>
<p>I see! I'm new to using github on a larger scale, but I think I've made one here: <a href="https://github.com/leanprover-community/mathlib4/pull/242">https://github.com/leanprover-community/mathlib4/pull/242</a></p>



<a name="276126831"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276126831" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ian Benway <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276126831">(Mar 21 2022 at 23:26)</a>:</h4>
<p>Getting a bug on <a href="https://github.com/leanprover-community/mathlib4/pull/242">mathlib4#242</a> where <code>rw</code> solves the goal if it can via <code>rfl</code>. Like,</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">Nat</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">-</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">x</span> <span class="o">:=</span> <span class="kd">by</span>
  <span class="n">set</span> <span class="n">y</span> <span class="o">:=</span> <span class="n">x</span>
</code></pre></div>
<p>solves the goal. Is there a way around this?</p>



<a name="276132046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276132046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276132046">(Mar 22 2022 at 00:49)</a>:</h4>
<p><span class="user-mention" data-user-id="462786">@Ian Benway</span> Try this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">elab_rules</span> <span class="o">:</span> <span class="n">tactic</span>
<span class="bp">|`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">set</span> <span class="bp">$</span><span class="o">[</span><span class="bp">!%$</span><span class="n">rw</span><span class="bp">?</span><span class="o">]</span><span class="bp">?</span> <span class="bp">$</span><span class="n">a</span><span class="o">:</span><span class="n">ident</span> <span class="bp">$</span><span class="o">[:</span> <span class="bp">$</span><span class="n">tp</span><span class="bp">?</span><span class="o">:</span><span class="n">term</span><span class="o">]</span><span class="bp">?</span> <span class="o">:=</span> <span class="bp">$</span><span class="n">pv</span><span class="o">:</span><span class="n">term</span> <span class="bp">$</span><span class="o">[</span><span class="k">with</span> <span class="bp">$</span><span class="o">[</span><span class="bp">←%$</span><span class="n">rev</span><span class="bp">?</span><span class="o">]</span><span class="bp">?</span> <span class="bp">$</span><span class="n">h</span><span class="bp">?</span><span class="o">:</span><span class="n">ident</span><span class="o">]</span><span class="bp">?</span><span class="o">)</span> <span class="bp">=&gt;</span> <span class="k">do</span>
  <span class="n">withMainContext</span> <span class="k">do</span>
    <span class="k">let</span> <span class="o">(</span><span class="n">te</span><span class="o">,</span> <span class="n">pv</span><span class="o">)</span> <span class="bp">←</span> <span class="k">match</span> <span class="n">tp</span><span class="bp">?</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">some</span> <span class="n">t</span> <span class="bp">=&gt;</span> <span class="k">do</span>
      <span class="k">let</span> <span class="n">te</span> <span class="bp">←</span> <span class="n">elabTerm</span> <span class="n">t</span> <span class="n">none</span>
      <span class="k">let</span> <span class="n">pv</span> <span class="bp">←</span> <span class="n">elabTerm</span> <span class="n">pv</span> <span class="n">te</span>
      <span class="n">pure</span> <span class="o">(</span><span class="n">te</span><span class="o">,</span> <span class="n">pv</span><span class="o">)</span>
    <span class="bp">|</span> <span class="n">none</span>   <span class="bp">=&gt;</span> <span class="k">do</span>
      <span class="k">let</span> <span class="n">pv</span> <span class="bp">←</span> <span class="n">elabTerm</span> <span class="n">pv</span> <span class="n">none</span>
      <span class="k">let</span> <span class="n">te</span> <span class="bp">←</span> <span class="n">inferType</span> <span class="n">pv</span>
      <span class="n">pure</span> <span class="o">(</span><span class="n">te</span><span class="o">,</span> <span class="n">pv</span><span class="o">)</span>
    <span class="n">defineV</span> <span class="n">a.getId</span> <span class="n">te</span> <span class="n">pv</span>
  <span class="k">if</span> <span class="n">rw</span><span class="bp">?.</span><span class="n">isNone</span> <span class="k">then</span>
    <span class="n">evalTactic</span> <span class="o">(</span><span class="bp">←</span> <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="n">try</span> <span class="n">rewrite</span> <span class="o">[(</span><span class="n">id</span> <span class="n">rfl</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span><span class="o">)]</span> <span class="n">at</span> <span class="bp">*</span><span class="o">))</span>

  <span class="k">match</span> <span class="o">(</span><span class="n">h</span><span class="bp">?</span><span class="o">,</span> <span class="n">rev</span><span class="bp">?</span><span class="o">)</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="o">(</span><span class="n">some</span> <span class="n">h</span><span class="o">,</span> <span class="n">some</span> <span class="o">(</span><span class="n">none</span><span class="o">))</span>   <span class="bp">=&gt;</span>
    <span class="n">evalTactic</span> <span class="o">(</span><span class="bp">←</span> <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="k">have</span> <span class="bp">$</span><span class="n">h</span> <span class="o">:</span> <span class="bp">$</span><span class="n">a</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">pv</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">))</span>
  <span class="bp">|</span> <span class="o">(</span><span class="n">some</span> <span class="n">h</span><span class="o">,</span> <span class="n">some</span> <span class="o">(</span><span class="n">some</span> <span class="n">r</span><span class="o">))</span> <span class="bp">=&gt;</span>
    <span class="n">evalTactic</span> <span class="o">(</span><span class="bp">←</span> <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="k">have</span> <span class="bp">$</span><span class="n">h</span> <span class="o">:</span> <span class="bp">$</span><span class="n">pv</span> <span class="bp">=</span> <span class="bp">$</span><span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span><span class="o">))</span>
  <span class="bp">|</span> <span class="n">_</span>                       <span class="bp">=&gt;</span> <span class="n">pure</span> <span class="o">()</span>
</code></pre></div>



<a name="276133328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276133328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ian Benway <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276133328">(Mar 22 2022 at 01:14)</a>:</h4>
<p>Oh, nice! So changing <code>rw</code> to <code>rewrite</code> works. So is <code>rw</code> just <code>rewrite</code>, but it tries to solve via <code>rfl</code>?<br>
Also, thank you again! Change is pushed and ready for review.</p>



<a name="276133486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276133486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276133486">(Mar 22 2022 at 01:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="462786">Ian Benway</span> <a href="#narrow/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F/near/276133328">said</a>:</p>
<blockquote>
<p>So is <code>rw</code> just <code>rewrite</code>, but it tries to solve via <code>rfl</code>?</p>
</blockquote>
<p>I don't know if that's the only difference <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="276136251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276136251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276136251">(Mar 22 2022 at 02:15)</a>:</h4>
<p>Oh, that is unfortunate. In lean 3 these two are identical, and I don't want to teach this difference</p>



<a name="276136361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276136361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276136361">(Mar 22 2022 at 02:17)</a>:</h4>
<p>but indeed:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">syntax</span> <span class="o">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">rewriteSeq</span><span class="o">)</span> <span class="s2">"rewrite "</span> <span class="o">(</span><span class="n">config</span><span class="o">)</span><span class="bp">?</span> <span class="n">rwRuleSeq</span> <span class="o">(</span><span class="n">location</span><span class="o">)</span><span class="bp">?</span> <span class="o">:</span> <span class="n">tactic</span>

<span class="n">syntax</span> <span class="o">(</span><span class="n">name</span> <span class="o">:=</span> <span class="n">rwSeq</span><span class="o">)</span> <span class="s2">"rw "</span> <span class="o">(</span><span class="n">config</span><span class="o">)</span><span class="bp">?</span> <span class="n">rwRuleSeq</span> <span class="o">(</span><span class="n">location</span><span class="o">)</span><span class="bp">?</span> <span class="o">:</span> <span class="n">tactic</span>

<span class="kd">def</span> <span class="n">rwWithRfl</span> <span class="o">(</span><span class="n">kind</span> <span class="o">:</span> <span class="n">SyntaxNodeKind</span><span class="o">)</span> <span class="o">(</span><span class="n">atom</span> <span class="o">:</span> <span class="n">String</span><span class="o">)</span> <span class="o">(</span><span class="n">stx</span> <span class="o">:</span> <span class="n">Syntax</span><span class="o">)</span> <span class="o">:</span> <span class="n">MacroM</span> <span class="n">Syntax</span> <span class="o">:=</span> <span class="k">do</span>
  <span class="c1">-- We show the `rfl` state on `]`</span>
  <span class="k">let</span> <span class="n">seq</span>   <span class="o">:=</span> <span class="n">stx</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span>
  <span class="k">let</span> <span class="n">rbrak</span> <span class="o">:=</span> <span class="n">seq</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span>
  <span class="c1">-- Replace `]` token with one without position information in the expanded tactic</span>
  <span class="k">let</span> <span class="n">seq</span>   <span class="o">:=</span> <span class="n">seq.setArg</span> <span class="mi">2</span> <span class="o">(</span><span class="n">mkAtom</span> <span class="s2">"]"</span><span class="o">)</span>
  <span class="k">let</span> <span class="n">tac</span>   <span class="o">:=</span> <span class="n">stx.setKind</span> <span class="n">kind</span> <span class="bp">|&gt;.</span><span class="n">setArg</span> <span class="mi">0</span> <span class="o">(</span><span class="n">mkAtomFrom</span> <span class="n">stx</span> <span class="n">atom</span><span class="o">)</span> <span class="bp">|&gt;.</span><span class="n">setArg</span> <span class="mi">2</span> <span class="n">seq</span>
  <span class="bp">`</span><span class="o">(</span><span class="n">tactic</span><span class="bp">|</span> <span class="bp">$</span><span class="n">tac</span><span class="bp">;</span> <span class="n">try</span> <span class="o">(</span><span class="n">with_reducible</span> <span class="n">rfl</span><span class="bp">%$</span><span class="n">rbrak</span><span class="o">))</span>

<span class="kd">@[macro rwSeq]</span> <span class="kd">def</span> <span class="n">expandRwSeq</span> <span class="o">:</span> <span class="n">Macro</span> <span class="o">:=</span>
  <span class="n">rwWithRfl</span> <span class="bp">``</span><span class="n">Lean.Parser.Tactic.rewriteSeq</span> <span class="s2">"rewrite"</span>
</code></pre></div>
<p>This  says that <code>rw [a, b, c]</code> is equivalent to <code>rewrite [a, b, c]; try (with_reducible rfl)</code> (modulo some messing about with token positions for better error messages)</p>



<a name="276136684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276136684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276136684">(Mar 22 2022 at 02:22)</a>:</h4>
<p>The difference was introduced <a href="https://github.com/leanprover/lean4/commit/40e51270f5a40247c2ff405ca7bc3b3821ba01ee">here</a> but it doesn't look very intentional</p>



<a name="276141725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276141725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276141725">(Mar 22 2022 at 04:04)</a>:</h4>
<p>I remember reading about some slow <code>rfl</code>s. Are those real or just noise in my memory? And if they're real, isn't it worrisome that every <code>rw</code> tries <code>rfl</code>?</p>



<a name="276141950"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276141950" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276141950">(Mar 22 2022 at 04:10)</a>:</h4>
<p>that's why it is <code>with_reducible rfl</code> instead of just <code>rfl</code></p>



<a name="276141965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276141965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276141965">(Mar 22 2022 at 04:11)</a>:</h4>
<p>What's the difference?</p>



<a name="276142483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276142483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276142483">(Mar 22 2022 at 04:24)</a>:</h4>
<p><code>with_reducible rfl</code> only unfolds reducible definitions when checking defeq</p>



<a name="276158068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276158068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276158068">(Mar 22 2022 at 08:52)</a>:</h4>
<p>See also the unresolved <a href="#narrow/stream/270676-lean4/topic/Kinds.20of.20goals.20closed.20by.20rw.2Fsimp.20only.2Fsimp">https://leanprover.zulipchat.com/#narrow/stream/270676-lean4/topic/Kinds.20of.20goals.20closed.20by.20rw.2Fsimp.20only.2Fsimp</a></p>



<a name="276375919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276375919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276375919">(Mar 23 2022 at 18:01)</a>:</h4>
<p>This looks a bit strange: <code>example : a = a := by rw []</code></p>



<a name="276381228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276381228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276381228">(Mar 23 2022 at 18:39)</a>:</h4>
<p>I'm pretty sure there are lots of strange ways to prove <code>rfl</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">norm_num</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">tauto</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">finish</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">solve_by_elim</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">constructor</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">econstructor</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">fconstructor</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">split</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">nat.add</span><span class="o">]</span> <span class="n">at</span> <span class="n">a</span> <span class="bp">⊢</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp_intros</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">congr'</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">triv</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">trivial</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">refl</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">ac_refl</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[]</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">rwa</span> <span class="o">[]</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">erw</span> <span class="o">[]</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">cc</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">subst_vars</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">repeat</span> <span class="o">{</span> <span class="n">try</span> <span class="o">{</span> <span class="n">any_goals</span> <span class="o">{</span> <span class="n">cc</span> <span class="o">}</span> <span class="o">}</span> <span class="o">}</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">exact</span> <span class="n">rfl.trans</span> <span class="n">rfl</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">existsi</span> <span class="n">α</span>
</code></pre></div>



<a name="276381425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276381425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276381425">(Mar 23 2022 at 18:40)</a>:</h4>
<p>the <code>hint</code> tactic will even give you a variety of items from this list</p>



<a name="276381825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/287929-mathlib4/topic/%60set%60%20tactic%20and%20elab%20benefits%3F/near/276381825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/287929-mathlib4/topic/.60set.60.20tactic.20and.20elab.20benefits.3F.html#276381825">(Mar 23 2022 at 18:43)</a>:</h4>
<p>And this is just in the core library &amp; tactics. If you use mathlib you can derive it from quadratic reciprocity with some care</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>