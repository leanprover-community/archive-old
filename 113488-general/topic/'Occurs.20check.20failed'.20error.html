---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/'Occurs.20check.20failed'.20error.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html">'Occurs check failed' error</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="204081490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204081490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204081490">(Jul 16 2020 at 13:17)</a>:</h4>
<p>Hello! I'm getting an error message I don't understand. Can anyone help me?</p>
<p>I have, in the local context, a hypothesis  <code>h₁ : en = M :: (ys ++ ↑"U"),</code> and would like to close the goal <code>⊢ en = M :: ?m_1</code>. I try <code>rw h₁</code> and get the error message <code>exact tactic failed, failed to assign 
  eq.mpr (id (eq.rec (eq.refl (en = M :: ?m_1)) h₁)) htarget
to metavariable ?m_2 (possible cause: occurs check failed)</code>.</p>



<a name="204081661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204081661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204081661">(Jul 16 2020 at 13:18)</a>:</h4>
<p><span class="user-mention" data-user-id="233737">@Gihan Marasingha</span>  Does <code>exact h₁</code> work?</p>



<a name="204081697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204081697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204081697">(Jul 16 2020 at 13:18)</a>:</h4>
<p>If not, do you have other open goals, or is this the only one?</p>



<a name="204082042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204082042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204082042">(Jul 16 2020 at 13:21)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> . Thanks! <code> exact h₁</code> gives an 'invalid type ascription error'. This is not the only goal. My tactic state, before trying the rw is:</p>
<div class="codehilite"><pre><span></span><code><span class="mi">2</span> <span class="n">goals</span>
<span class="n">st</span> <span class="n">en</span> <span class="o">:</span> <span class="n">miustr</span><span class="o">,</span>
<span class="n">ys</span> <span class="o">:</span> <span class="n">list</span> <span class="n">miu_atom</span><span class="o">,</span>
<span class="n">h₂</span> <span class="o">:</span> <span class="n">st</span> <span class="bp">=</span> <span class="n">M</span> <span class="bp">::</span> <span class="n">ys</span><span class="o">,</span>
<span class="n">h₃</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">::</span> <span class="n">ys</span> <span class="bp">++</span> <span class="err">↑</span><span class="s2">&quot;U&quot;</span> <span class="bp">=</span> <span class="n">M</span> <span class="bp">::</span> <span class="o">(</span><span class="n">ys</span> <span class="bp">++</span> <span class="err">↑</span><span class="s2">&quot;U&quot;</span><span class="o">),</span>
<span class="n">h₁</span> <span class="o">:</span> <span class="n">en</span> <span class="bp">=</span> <span class="n">M</span> <span class="bp">::</span> <span class="o">(</span><span class="n">ys</span> <span class="bp">++</span> <span class="err">↑</span><span class="s2">&quot;U&quot;</span><span class="o">)</span>
<span class="err">⊢</span> <span class="n">en</span> <span class="bp">=</span> <span class="n">M</span> <span class="bp">::</span> <span class="err">?</span><span class="n">m_1</span>

<span class="n">st</span> <span class="n">en</span> <span class="o">:</span> <span class="n">miustr</span><span class="o">,</span>
<span class="n">h₁</span> <span class="o">:</span> <span class="n">rule1</span> <span class="n">st</span> <span class="n">en</span><span class="o">,</span>
<span class="n">h₂</span> <span class="o">:</span> <span class="n">goodstart</span> <span class="n">st</span>
<span class="err">⊢</span> <span class="n">list</span> <span class="n">miu_atom</span>
</code></pre></div>



<a name="204082251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204082251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204082251">(Jul 16 2020 at 13:23)</a>:</h4>
<p>Hmm... confusing. Maybe <code>convert</code> instead of <code>exact</code> can make Lean behave?</p>



<a name="204082297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204082297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204082297">(Jul 16 2020 at 13:23)</a>:</h4>
<p>Otherwise, <code>exact (ys ++ ↑"U")</code> in the other goal might give more info</p>



<a name="204084373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204084373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204084373">(Jul 16 2020 at 13:38)</a>:</h4>
<p>Thanks. I was mistaken in my previous comment regarding the tactic state. It was different. I've also just changed my code to avoid the coercion. Now the tactic state before the rw is:</p>
<p>---snip---</p>
<p>I haven't used <code>convert</code> before. I'll look into it.</p>



<a name="204084478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204084478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204084478">(Jul 16 2020 at 13:39)</a>:</h4>
<p><span class="user-mention" data-user-id="233737">@Gihan Marasingha</span> Actually, I don't know how the parens are in <code>h\1</code> !</p>



<a name="204084497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204084497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204084497">(Jul 16 2020 at 13:39)</a>:</h4>
<p>Maybe that's the issue why <code>exact</code> is not working</p>



<a name="204084610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204084610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204084610">(Jul 16 2020 at 13:40)</a>:</h4>
<p>Ooh, <code>h\3</code> is telling me the answer</p>



<a name="204088718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204088718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204088718">(Jul 16 2020 at 14:13)</a>:</h4>
<p>Ahh, I'm being an idiot and deleted an extra line in my last message (thus changing the goal). My original tactic state (modulo coercion) was what I have now.  In case it helps, when I try <code>exact h₁</code>, I get:</p>
<div class="codehilite"><pre><span></span><code><span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="n">en</span> <span class="bp">=</span> <span class="n">M</span> <span class="bp">::</span> <span class="o">(</span><span class="n">ys</span> <span class="bp">++</span> <span class="o">[</span><span class="n">U</span><span class="o">])</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">en</span> <span class="bp">=</span> <span class="n">M</span> <span class="bp">::</span> <span class="err">?</span><span class="n">m_1</span>
</code></pre></div>



<a name="204101290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%27Occurs%20check%20failed%27%20error/near/204101290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/'Occurs.20check.20failed'.20error.html#204101290">(Jul 16 2020 at 15:38)</a>:</h4>
<p>OK, it's all fixed now. I had an extra <code>split</code> at the start of my code that caused everything to foul up! Thanks for the help.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>