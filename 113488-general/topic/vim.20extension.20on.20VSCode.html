---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/vim.20extension.20on.20VSCode.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html">vim extension on VSCode</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="207799960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207799960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207799960">(Aug 24 2020 at 01:07)</a>:</h4>
<p>I use the vim bindings extension in VSCode. When I am typing in an open lean file, the VSCode Lean extension tries to recompile even while I am still typing, which results in a lot more lag in getting a response from the widget. It gets hung up on things like unmatched parens, or unknown tokens. Has anyone else faced this?</p>



<a name="207800847"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207800847" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frédéric Dupuis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207800847">(Aug 24 2020 at 01:33)</a>:</h4>
<p>Yeah -- is it really specific to the vim extension?  It would be nice to have a shortcut to start/stop the compilation.</p>



<a name="207800916"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207800916" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207800916">(Aug 24 2020 at 01:35)</a>:</h4>
<p>Yeah I've had this too, it's really frustrating</p>



<a name="207816487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207816487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207816487">(Aug 24 2020 at 08:05)</a>:</h4>
<p>This is typically because you have two files open that are on the opposite end of the import hierarchy (like <code>tactic.core</code> and <code>geometry.manifold.mfderiv</code>).</p>



<a name="207826508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207826508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Peattie <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207826508">(Aug 24 2020 at 10:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="311453">Frédéric Dupuis</span> <a href="#narrow/stream/113488-general/topic/vim.20extension.20on.20VSCode/near/207800847">said</a>:</p>
<blockquote>
<p>Yeah -- is it really specific to the vim extension?  It would be nice to have a shortcut to start/stop the compilation.</p>
</blockquote>
<p>I believe you can open the Command Palette and choose "Lean: Check Nothing" to disable compilation <span aria-label="relaxed" class="emoji emoji-263a" role="img" title="relaxed">:relaxed:</span></p>



<a name="207826712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207826712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Peattie <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207826712">(Aug 24 2020 at 10:11)</a>:</h4>
<p>And more generally you can use the "Lean: Check ..." commands to control how aggressive Lean/VSCode will be about compiling. For example "Lean: Check visible files" should stop the problem Gabriel mentioned caused by imports</p>



<a name="207826814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207826814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex Peattie <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207826814">(Aug 24 2020 at 10:13)</a>:</h4>
<p>You can also access the settings by clicking on the part of the bottom blue bar that says "Lean: <span aria-label="checkbox" class="emoji emoji-2611" role="img" title="checkbox">:checkbox:</span>️ (checking open files)"</p>



<a name="207844921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207844921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Frédéric Dupuis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207844921">(Aug 24 2020 at 13:49)</a>:</h4>
<p>Thanks! Do you know if there's a way to turn this into keyboard shortcuts? I was hoping to be able to do this very quickly when moving large blocks of code around.</p>



<a name="207851423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207851423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207851423">(Aug 24 2020 at 14:42)</a>:</h4>
<p>Yes, it is possible. The command names for those selections are <a href="https://github.com/leanprover/vscode-lean#server-commands">here</a> (click on "The choices can also be made directly:") and then you can add custom keybindings for those. </p>
<p>To do so, open "Keyboard Shortcuts" in VS Code via the menu in the bottom left gear (or press ctrl+k then ctrl+s, or search the ctrl+p menu). Then search for <code>lean.roiMode</code>.</p>



<a name="207851774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207851774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207851774">(Aug 24 2020 at 14:45)</a>:</h4>
<p>I suspect this is hiding a deeper issue though. I've been using Lean for a long time, including editing mathlib and I never felt the need to constantly change this setting.</p>



<a name="207853985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207853985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207853985">(Aug 24 2020 at 15:01)</a>:</h4>
<p>I think it has to do with how the vim extension is firing keypress events into VSCode itself. For example, it has a separate undo stack (via <code>u</code>) than the VSCode <code>ctrl-Z</code> stack. And <code>ctrl-z</code> will sometimes undo a keypress at a time, which isn't really how undo should work.</p>



<a name="207854095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207854095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207854095">(Aug 24 2020 at 15:02)</a>:</h4>
<p>I'm also using the vim extension (both of them actually, depending on the computer).</p>



<a name="207854128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207854128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207854128">(Aug 24 2020 at 15:02)</a>:</h4>
<p>And vim undo in VSCode is a completely unpredictable nightmare.</p>



<a name="207854165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207854165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207854165">(Aug 24 2020 at 15:03)</a>:</h4>
<p>So every time it fires the keypress event, it triggers the underlying "visible file has changed" event for sending the buffer to the lean server. As opposed to waiting for input to stop via your <code>Esc</code> sequence.</p>



<a name="207855170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207855170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207855170">(Aug 24 2020 at 15:11)</a>:</h4>
<p>Relevant vscodevim bug: <a href="https://github.com/VSCodeVim/Vim/issues/1490#issuecomment-352167221">https://github.com/VSCodeVim/Vim/issues/1490#issuecomment-352167221</a></p>



<a name="207855276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207855276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207855276">(Aug 24 2020 at 15:12)</a>:</h4>
<p>Basically, I'm saying, as exemplified by the weird vim undo in VSCode is that the vim extension doesn't play nicely with what counts as a changing (right now, in this moment) buffer over a buffer that has recently been changed (and isn't about to).</p>



<a name="207855360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/vim%20extension%20on%20VSCode/near/207855360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/vim.20extension.20on.20VSCode.html#207855360">(Aug 24 2020 at 15:12)</a>:</h4>
<p>And my guess is that the vim extension always makes it seem like the latter to VSCode and other extensions, even when it is really the former.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>