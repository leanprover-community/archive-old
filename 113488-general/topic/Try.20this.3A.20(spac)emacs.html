---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html">Try this: (spac)emacs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="224056218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224056218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224056218">(Jan 26 2021 at 15:36)</a>:</h4>
<p>Is there an easy way to get a key combo in (spac)emacs that will replace <code>tidy?</code> or <code>squeeze_simp</code> or <code>library_search</code> by the output of <code>Try this:</code>?</p>



<a name="224057609"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224057609" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesse Michael Han <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224057609">(Jan 26 2021 at 15:45)</a>:</h4>
<p>my hack is to just record an ad-hoc keyboard macro</p>



<a name="224058912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224058912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224058912">(Jan 26 2021 at 15:53)</a>:</h4>
<p>It would be nice to push something to the spacemacs layer for lean. But I've only been using spacemacs for ~6 days... so I'm not really an expert yet.</p>



<a name="224062801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224062801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesse Michael Han <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224062801">(Jan 26 2021 at 16:16)</a>:</h4>
<p>pinging our guru <span class="user-mention" data-user-id="110026">@Simon Hudon</span>, who has definitely thought about this at some point</p>



<a name="224064526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224064526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224064526">(Jan 26 2021 at 16:27)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Are you moving over to the dark side?</p>



<a name="224064747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224064747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224064747">(Jan 26 2021 at 16:29)</a>:</h4>
<p>I have a script that does that in my init file. I can move it to the <code>lean-mode</code> community contributions.</p>



<a name="224069007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224069007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224069007">(Jan 26 2021 at 16:58)</a>:</h4>
<p>Other things I need to figure out: currently I need to leave insert mode and push 3 buttons to get an autocomplete popup. I would like to just have it show up automatically and filter results as I type. Like in VScode</p>



<a name="224070190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224070190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224070190">(Jan 26 2021 at 17:05)</a>:</h4>
<p>That definitely worked for me in Lean 3 without leaving insert mode using</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="o">(</span><span class="n">global</span><span class="bp">-</span><span class="n">set</span><span class="bp">-</span><span class="n">key</span> <span class="o">(</span><span class="n">kbd</span> <span class="s2">"C-SPC"</span><span class="o">)</span> <span class="bp">#'</span><span class="n">company</span><span class="bp">-</span><span class="n">complete</span><span class="o">)</span>
</code></pre></div>



<a name="224070713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224070713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224070713">(Jan 26 2021 at 17:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113488-general/topic/Try.20this.3A.20(spac)emacs/near/224069007">said</a>:</p>
<blockquote>
<p>Other things I need to figure out: currently I need to leave insert mode and push 3 buttons to get an autocomplete popup. I would like to just have it show up automatically and filter results as I type. Like in VScode</p>
</blockquote>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> I was using vanilla emacs with company-complete, etc. for a while. I recently switched to <code>doom-emacs</code> and my life has been much easier. I've never seriously used spacemacs, but as far as I understand, doom-emacs is more minimal than spacemacs, hence much faster in many respects.</p>



<a name="224070752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224070752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224070752">(Jan 26 2021 at 17:09)</a>:</h4>
<p>In particular the automatic lean setup in doom emacs has an automatic popup that you're looking for.</p>



<a name="224070989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224070989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224070989">(Jan 26 2021 at 17:11)</a>:</h4>
<p>I guess I can dig a bit and try to find what package doom emacs uses for this, but if you don't actually care about spacemacs you might want to check out doom emacs as well.</p>



<a name="224071703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224071703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224071703">(Jan 26 2021 at 17:16)</a>:</h4>
<p>Hmmm... looks like it's company lean with some nonstandard configuration. See e.g.<br>
<a href="https://github.com/hlissner/doom-emacs/blob/develop/modules/lang/lean/config.el">https://github.com/hlissner/doom-emacs/blob/develop/modules/lang/lean/config.el</a><br>
<a href="https://github.com/hlissner/doom-emacs/blob/develop/modules/completion/company/config.el">https://github.com/hlissner/doom-emacs/blob/develop/modules/completion/company/config.el</a></p>



<a name="224081939"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224081939" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224081939">(Jan 26 2021 at 18:28)</a>:</h4>
<p>Thanks, I'll try to look into this asap</p>



<a name="224081977"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224081977" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224081977">(Jan 26 2021 at 18:28)</a>:</h4>
<p>Is doom emacs also vim-like? I kind of like spacemacs so far.</p>



<a name="224083367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224083367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224083367">(Jan 26 2021 at 18:38)</a>:</h4>
<p>Yes, the default in doom emacs is evil-mode</p>



<a name="224083376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224083376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224083376">(Jan 26 2021 at 18:38)</a>:</h4>
<p>As it should be.</p>



<a name="224095374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224095374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224095374">(Jan 26 2021 at 20:08)</a>:</h4>
<p>I just hacked together something for the Lean Next Error window that turns "Try this:" into a link that you can click/press enter on to copy the suggestion into the buffer.  (Disclaimer: very lightly tested.)</p>
<p>This replaces a function in <code>lean-flycheck.el</code> and gives a couple extra definitions:</p>
<div class="codehilite" data-code-language="EmacsLisp"><pre><span></span><code><span class="p">(</span><span class="nv">define-button-type</span> <span class="ss">'lean-suggestion-button</span>
  <span class="ss">'follow-link</span> <span class="no">t</span>
  <span class="ss">'action</span> <span class="ss">'lean-copy-try-this</span>
  <span class="ss">'help-echo</span> <span class="s">"mouse-1: copy suggestion into buffer"</span><span class="p">)</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">lean-copy-try-this</span> <span class="p">(</span><span class="nv">event</span><span class="p">)</span>
  <span class="p">(</span><span class="k">interactive</span> <span class="s">"e"</span><span class="p">)</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">window</span> <span class="p">(</span><span class="nv">posn-window</span> <span class="p">(</span><span class="nv">event-end</span> <span class="nv">event</span><span class="p">)))</span>
        <span class="p">(</span><span class="nv">pos</span> <span class="p">(</span><span class="nv">posn-point</span> <span class="p">(</span><span class="nv">event-end</span> <span class="nv">event</span><span class="p">))))</span>
    <span class="p">(</span><span class="nb">with-current-buffer</span> <span class="p">(</span><span class="nf">window-buffer</span> <span class="nv">window</span><span class="p">)</span>
      <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">sugg</span> <span class="p">(</span><span class="k">or</span> <span class="p">(</span><span class="nf">get-pos-property</span> <span class="nv">pos</span> <span class="ss">'lean-suggestion</span><span class="p">)</span>
                      <span class="c1">; don't understand why this is needed:</span>
                      <span class="p">(</span><span class="nf">get-pos-property</span> <span class="p">(</span><span class="nf">1+</span> <span class="nv">pos</span><span class="p">)</span> <span class="ss">'lean-suggestion</span><span class="p">))))</span>
        <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">buff</span> <span class="p">(</span><span class="nf">get-file-buffer</span> <span class="p">(</span><span class="nv">alist-get</span> <span class="ss">'filename</span> <span class="nv">sugg</span><span class="p">))))</span>
          <span class="p">(</span><span class="nb">when</span> <span class="nv">buff</span>
            <span class="p">(</span><span class="nf">message</span> <span class="p">(</span><span class="nf">buffer-name</span> <span class="nv">buff</span><span class="p">))</span>
            <span class="p">(</span><span class="nb">with-current-buffer</span> <span class="nv">buff</span>
              <span class="p">(</span><span class="nf">goto-char</span> <span class="p">(</span><span class="nv">alist-get</span> <span class="ss">'pos</span> <span class="nv">sugg</span><span class="p">))</span>
              <span class="p">(</span><span class="nf">princ</span> <span class="p">(</span><span class="nv">alist-get</span> <span class="ss">'suggest</span> <span class="nv">sugg</span><span class="p">)</span> <span class="nv">buff</span><span class="p">)</span>
              <span class="p">(</span><span class="nf">insert</span> <span class="s">","</span><span class="p">))))))))</span>

<span class="p">(</span><span class="nb">defun</span> <span class="nv">lean-next-error--handler</span> <span class="p">()</span>
  <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">lean-info-buffer-active</span> <span class="nv">lean-next-error-buffer-name</span><span class="p">)</span>
    <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">deactivate-mark</span><span class="p">)</span> <span class="c1">; keep transient mark</span>
          <span class="p">(</span><span class="nv">errors</span> <span class="p">(</span><span class="k">or</span>
                   <span class="c1">;; prefer error of current position, if any</span>
                   <span class="p">(</span><span class="nv">flycheck-overlay-errors-at</span> <span class="p">(</span><span class="nf">point</span><span class="p">))</span>
                   <span class="c1">;; try errors in current line next</span>
                   <span class="p">(</span><span class="nf">sort</span> <span class="p">(</span><span class="nv">flycheck-overlay-errors-in</span> <span class="p">(</span><span class="nf">line-beginning-position</span><span class="p">)</span> <span class="p">(</span><span class="nf">line-end-position</span><span class="p">))</span>
                         <span class="nf">#'</span><span class="nv">flycheck-error-&lt;</span><span class="p">)</span>
                   <span class="c1">;; fall back to next error position</span>
                   <span class="p">(</span><span class="nv">-if-let*</span> <span class="p">((</span><span class="nv">pos</span> <span class="p">(</span><span class="nv">flycheck-next-error-pos</span> <span class="mi">1</span><span class="p">)))</span>
                       <span class="p">(</span><span class="nv">flycheck-overlay-errors-at</span> <span class="nv">pos</span><span class="p">)))))</span>
      <span class="p">(</span><span class="nv">lean-with-info-output-to-buffer</span> <span class="nv">lean-next-error-buffer-name</span>
       <span class="p">(</span><span class="nb">dolist</span> <span class="p">(</span><span class="nv">e</span> <span class="nv">errors</span><span class="p">)</span>
         <span class="p">(</span><span class="nf">princ</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"%d:%d: "</span> <span class="p">(</span><span class="nv">flycheck-error-line</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nv">flycheck-error-column</span> <span class="nv">e</span><span class="p">)))</span>
         <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">i</span> <span class="p">(</span><span class="nf">point</span><span class="p">)))</span>
           <span class="p">(</span><span class="nf">princ</span> <span class="p">(</span><span class="nv">flycheck-error-message</span> <span class="nv">e</span><span class="p">))</span>
           <span class="p">(</span><span class="nb">when</span> <span class="p">(</span><span class="nv">string-prefix-p</span> <span class="s">"Try this:"</span> <span class="p">(</span><span class="nv">flycheck-error-message</span> <span class="nv">e</span><span class="p">))</span>
             <span class="p">(</span><span class="nv">make-button</span> <span class="nv">i</span> <span class="p">(</span><span class="nf">+</span> <span class="nv">i</span> <span class="p">(</span><span class="nf">length</span> <span class="s">"Try this:"</span><span class="p">))</span>
                          <span class="nb">:type</span> <span class="ss">'lean-suggestion-button</span>
                          <span class="ss">'lean-suggestion</span>
                          <span class="p">(</span><span class="nf">list</span> <span class="p">(</span><span class="nf">cons</span> <span class="ss">'filename</span> <span class="p">(</span><span class="nv">flycheck-error-filename</span> <span class="nv">e</span><span class="p">))</span>
                                <span class="p">(</span><span class="nf">cons</span> <span class="ss">'pos</span> <span class="p">(</span><span class="nv">flycheck-error-pos</span> <span class="nv">e</span><span class="p">))</span>
                                <span class="p">(</span><span class="nf">cons</span> <span class="ss">'suggest</span>
                                      <span class="p">(</span><span class="nv">string-trim</span>
                                       <span class="p">(</span><span class="nf">substring</span> <span class="p">(</span><span class="nv">flycheck-error-message</span> <span class="nv">e</span><span class="p">)</span>
                                                  <span class="p">(</span><span class="nf">length</span> <span class="s">"Try this: "</span><span class="p">))))))))</span>
         <span class="p">(</span><span class="nf">princ</span> <span class="s">"\n\n"</span><span class="p">))</span>
       <span class="p">(</span><span class="nb">when</span> <span class="nv">flycheck-current-errors</span>
         <span class="p">(</span><span class="nf">princ</span> <span class="p">(</span><span class="nf">format</span> <span class="s">"(%d more messages above...)"</span> <span class="p">(</span><span class="nf">length</span> <span class="nv">flycheck-current-errors</span><span class="p">))))))))</span>
</code></pre></div>



<a name="224095489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224095489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224095489">(Jan 26 2021 at 20:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/113488-general/topic/Try.20this.3A.20(spac)emacs/near/224083376">said</a>:</p>
<blockquote>
<p>As it should be.</p>
</blockquote>
<p>Are you using a constructive modal logic here? <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="224097199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224097199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224097199">(Jan 26 2021 at 20:21)</a>:</h4>
<p>The code just inserts the suggestion (with comma) right before the tactic that generated the suggestion, and it doesn't try to remove that tactic -- I wasn't sure of a reliable way to do this.</p>



<a name="224099033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224099033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224099033">(Jan 26 2021 at 20:35)</a>:</h4>
<p>Ooh, another problem with spacemacs is that I have no idea where I should paste such blobs of code into my config file...</p>



<a name="224099093"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224099093" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224099093">(Jan 26 2021 at 20:36)</a>:</h4>
<p>Same for the 1-liner that Sebastian share upstairs...</p>



<a name="224099161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224099161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224099161">(Jan 26 2021 at 20:36)</a>:</h4>
<p>But once Kyle's code is tested <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">\epsilon</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">ϵ</span></span></span></span> more, I wouldn't mind if such stuff were added to the default lean packages</p>



<a name="224099712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224099712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224099712">(Jan 26 2021 at 20:41)</a>:</h4>
<p>You can test things out by creating a new .el file anywhere and then <code>C-x C-e</code> at the ends of expressions to evaluate them (or <code>C-M-x</code> to evaluate a whole <code>defun</code> when your cursor is somewhere within it).</p>



<a name="224100285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224100285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224100285">(Jan 26 2021 at 20:45)</a>:</h4>
<p>But for the config file, I think this suggestion code would just need to be after <code>(require 'lean-mode)</code> and <code>(require 'flycheck)</code>, but I'm not completely sure.  Sebastian's code probably can go anywhere.</p>



<a name="224102066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224102066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224102066">(Jan 26 2021 at 20:59)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> <br>
I don't really know how spacemacs configs work. In doom-emacs, I put configuration for packages in a <code>(use-package foo ...)</code> declaration similar to the examples in the readme here: <a href="https://github.com/jwiegley/use-package">https://github.com/jwiegley/use-package</a> <br>
(This all takes place in a <code>config.el</code> file in a specific folder)</p>
<p>This might be how spacemacs does things too... not sure.</p>



<a name="224126314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224126314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224126314">(Jan 27 2021 at 00:49)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113488-general/topic/Try.20this.3A.20(spac)emacs/near/224097199">said</a>:</p>
<blockquote>
<p>The code just inserts the suggestion (with comma) right before the tactic that generated the suggestion, and it doesn't try to remove that tactic -- I wasn't sure of a reliable way to do this.</p>
</blockquote>
<p>I just implemented my own hacky version of this a few weeks ago and what I did was just go with delete the word under the cursor and nothing fancier</p>



<a name="224126326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224126326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224126326">(Jan 27 2021 at 00:49)</a>:</h4>
<p>The vscode implementation has some slightly lengthy heuristic it uses</p>



<a name="224128491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224128491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224128491">(Jan 27 2021 at 01:17)</a>:</h4>
<p>I considered that, but I frequently do <code>squeeze_simp [foo1, foo2]</code> and it wouldn't be good to have it automatically introduce a syntax error</p>



<a name="224213092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224213092" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jannis Limperg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224213092">(Jan 27 2021 at 17:07)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Configuration usually goes into your <code>.spacemacs</code>, specifically into the body of the function <code>dotspacemacs/user-config</code> there. This function is executed after Spacemacs has done its thing and loaded everything it wants to load.</p>



<a name="224442969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224442969" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224442969">(Jan 29 2021 at 08:41)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> would you mind pushing your functions to the lean mode repo?</p>



<a name="224443042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224443042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224443042">(Jan 29 2021 at 08:41)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/113488-general/topic/Try.20this.3A.20(spac)emacs/near/224071703">said</a>:</p>
<blockquote>
<p>Hmmm... looks like it's company lean with some nonstandard configuration. See e.g.<br>
<a href="https://github.com/hlissner/doom-emacs/blob/develop/modules/lang/lean/config.el">https://github.com/hlissner/doom-emacs/blob/develop/modules/lang/lean/config.el</a><br>
<a href="https://github.com/hlissner/doom-emacs/blob/develop/modules/completion/company/config.el">https://github.com/hlissner/doom-emacs/blob/develop/modules/completion/company/config.el</a></p>
</blockquote>
<p>Also, whoever effectively maintains the spacemaces layer... <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span> seems like cool-to-have.</p>



<a name="224444690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224444690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224444690">(Jan 29 2021 at 09:02)</a>:</h4>
<div class="codehilite" data-code-language="EmacsLisp"><pre><span></span><code><span class="p">(</span><span class="nb">defun</span> <span class="nv">dotspacemacs/user-config</span> <span class="p">()</span>
  <span class="s">"Configuration for user code:</span>
<span class="s">This function is called at the very end of Spacemacs startup, after layer</span>
<span class="s">configuration.</span>
<span class="s">Put your configuration code here, except for variables that should be set</span>
<span class="s">before packages are loaded."</span>
  <span class="c1">;; make treemacs hide .gitignore files</span>
  <span class="p">(</span><span class="nb">with-eval-after-load</span> <span class="ss">'treemacs</span>
    <span class="p">(</span><span class="nv">add-to-list</span> <span class="ss">'treemacs-pre-file-insert-predicates</span> <span class="nf">#'</span><span class="nv">treemacs-is-file-git-ignored?</span><span class="p">)</span>
    <span class="p">)</span>
  <span class="c1">;; easy access to completion</span>
  <span class="p">(</span><span class="nv">global-set-key</span> <span class="p">(</span><span class="nv">kbd</span> <span class="s">"C-return"</span><span class="p">)</span> <span class="nf">#'</span><span class="nv">company-complete</span><span class="p">)</span>
  <span class="p">)</span>
</code></pre></div>
<p>The treemacs blob has the intended effect, but <code>&lt;C-return&gt; is undefined</code></p>



<a name="224452513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Try%20this%3A%20%28spac%29emacs/near/224452513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Try.20this.3A.20(spac)emacs.html#224452513">(Jan 29 2021 at 10:25)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113488-general/topic/Try.20this.3A.20(spac)emacs/near/224442969">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> would you mind pushing your functions to the lean mode repo?</p>
</blockquote>
<p>I'll make a PR sometime soon, but in the meantime here's my branch: <a href="https://github.com/kmill/lean-mode/tree/try-this">https://github.com/kmill/lean-mode/tree/try-this</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>