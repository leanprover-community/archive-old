---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html">Lagrange theorem in finset form</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="279567750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279567750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279567750">(Apr 20 2022 at 16:27)</a>:</h4>
<p>I've been trying to prove  a version of Lagrange's theorem so I don't have to deal with all this type theory as I work on theorems. What is the right way to make progress here?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">group_theory.subgroup.basic</span>

<span class="kd">instance</span> <span class="n">subgroup_fintype</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">{</span><span class="n">H</span> <span class="o">:</span> <span class="n">subgroup</span> <span class="n">G</span><span class="o">}</span> <span class="o">:</span> <span class="n">fintype</span> <span class="n">H</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- library_search</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>

<span class="c1">-- Version of Lagrange's theorem using the formalism of a closed subset</span>
<span class="kd">lemma</span> <span class="n">card_closed_subset_dvd_card</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">group</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">closed_under_mul</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">b</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span> <span class="o">(</span><span class="n">closed_under_inv</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">,</span> <span class="n">a</span><span class="bp">⁻¹</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span>
  <span class="o">(</span><span class="n">id_mem</span> <span class="o">:</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span>  <span class="o">:</span>
  <span class="n">finset.card</span> <span class="n">s</span> <span class="bp">∣</span> <span class="n">fintype.card</span> <span class="n">α</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="k">have</span> <span class="n">s_subgroup</span> <span class="o">:</span> <span class="n">subgroup</span> <span class="n">α</span> <span class="o">:=</span> <span class="n">subgroup.mk</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:</span> <span class="n">s.card</span> <span class="bp">=</span> <span class="n">fintype.card</span> <span class="n">s_subgroup</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">tidy</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">fintype.card_subtype</span><span class="o">,</span> <span class="c1">--why does this fail</span>
    <span class="n">rw</span> <span class="bp">←</span> <span class="n">subgroup.mem_carrier</span><span class="o">,</span> <span class="c1">--why does this fail</span>
   <span class="o">},</span>
  <span class="n">rw</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">subgroup.card_subgroup_dvd_card</span> <span class="n">s_subgroup</span><span class="o">,</span>
  <span class="gr">sorry</span> <span class="o">{</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">},</span>
  <span class="gr">sorry</span> <span class="o">{</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">},</span>
  <span class="gr">sorry</span> <span class="o">{</span> <span class="n">tidy</span><span class="o">,</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



<a name="279568324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279568324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279568324">(Apr 20 2022 at 16:32)</a>:</h4>
<p>That doesn't compile for me -- I get a failed to synthesize <code>⊢ fintype ↥s_subgroup</code>.</p>



<a name="279568537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279568537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279568537">(Apr 20 2022 at 16:33)</a>:</h4>
<p>I'm getting that in the web editor too, but it works fine for me in vscode</p>



<a name="279568590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279568590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279568590">(Apr 20 2022 at 16:34)</a>:</h4>
<p>Maybe I need more imports</p>



<a name="279568652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279568652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279568652">(Apr 20 2022 at 16:34)</a>:</h4>
<p>that's probably because you have an outdated version of mathlib on your computer. But it makes it difficult for me to debug</p>



<a name="279569061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279569061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279569061">(Apr 20 2022 at 16:37)</a>:</h4>
<p>The issue was that I was missing an instance I had defined, sorry, it should be fixed now</p>



<a name="279569957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279569957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279569957">(Apr 20 2022 at 16:44)</a>:</h4>
<p>My guess is that the rewrite is failing because of some constructivist nonsense. Lean is finding a different proof of finiteness and you're not using <code>convert</code> so rotten luck. I wrote <code>nat.card</code> for a reason you know ;-) I might be wrong though.</p>



<a name="279570088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279570088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279570088">(Apr 20 2022 at 16:45)</a>:</h4>
<p>In fact I would thoroughly recommend <code>nat.card</code> for use with finite groups. It is nonconstructive and returns the value 0 for infinite types, which is great in group theory because finite groups can't have size 0.</p>



<a name="279570404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279570404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279570404">(Apr 20 2022 at 16:48)</a>:</h4>
<p>Yeah, this works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="k">have</span> <span class="o">:</span> <span class="n">s.card</span> <span class="bp">=</span> <span class="n">fintype.card</span> <span class="n">s_subgroup</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">tidy</span><span class="o">,</span>
    <span class="n">classical</span><span class="o">,</span>
    <span class="n">convert</span> <span class="o">(</span><span class="n">fintype.card_subtype</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">t</span><span class="o">,</span> <span class="n">t</span> <span class="bp">∈</span> <span class="n">s_subgroup</span><span class="o">))</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span>
</code></pre></div>
<p>so the issue is that fintype stinks. <code>convert</code> works its way around the constructive mess because it knows that <code>fintype</code> is a subsingleton.</p>



<a name="279570485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279570485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279570485">(Apr 20 2022 at 16:49)</a>:</h4>
<p><code>rw ← subgroup.mem_carrier</code> fails because <code>rw</code> won't work under a binder; <code>simp_rw ← subgroup.mem_carrier,</code> works.</p>



<a name="279570667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279570667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279570667">(Apr 20 2022 at 16:50)</a>:</h4>
<p>Oh! Another reason you'll have real problems is <code>have s_subgroup : subgroup α := ...</code>: this <code>have</code> needs to be a <code>let</code> because you're defining data here.</p>



<a name="279570698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279570698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279570698">(Apr 20 2022 at 16:50)</a>:</h4>
<p>In fact changing that might fix up a whole bunch of stuff.</p>



<a name="279570970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279570970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279570970">(Apr 20 2022 at 16:53)</a>:</h4>
<p>I would strongly recommend against all this <code>tidy</code> stuff by the way. Use <code>tidy?</code> to find out what it's doing and do that instead; it's much quicker :-)</p>



<a name="279572044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279572044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279572044">(Apr 20 2022 at 16:58)</a>:</h4>
<p>The documentation for <code>let</code> and <code>have</code> seems to be exactly the same, can you explain to me in what way they behave differently?</p>



<a name="279578324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279578324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279578324">(Apr 20 2022 at 17:42)</a>:</h4>
<p><code>have a : \N := 37</code> promptly forgets that <code>a = 37</code>, and you're just left with <code>a : nat</code> that you know nothing about.</p>



<a name="279596194"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279596194" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279596194">(Apr 20 2022 at 20:05)</a>:</h4>
<p>Btw, you also should not need <code>closed_under_inv</code> and <code>inv_mem</code>, right?</p>



<a name="279603371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lagrange%20theorem%20in%20finset%20form/near/279603371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lagrange.20theorem.20in.20finset.20form.html#279603371">(Apr 20 2022 at 21:06)</a>:</h4>
<p>Note that <code>have</code> in tactic mode doesn't actually make lean forget, it just pretends it's forgotten until you conclude the tactic block</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>