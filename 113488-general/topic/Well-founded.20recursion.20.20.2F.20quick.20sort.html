---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html">Well-founded recursion  / quick sort</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="244153539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244153539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244153539">(Jun 28 2021 at 14:32)</a>:</h4>
<p>I've spent the past few days trying (hopefully successfully) to understand well-founded recursion and have written an <a href="https://exlean.org/well-founded-recursion/">exlean blog post</a> on it, with exercises. In the post, I:</p>
<ol>
<li>Discuss the (informal) notion of a well-founded relation.</li>
<li>
<p>Show how to use well-founded relations (initially just with the &lt; relation on â„•) to define recursive functions and prove theorems</p>
<ul>
<li>using the equation compiler and</li>
<li>by writing proof terms.</li>
</ul>
</li>
<li>
<p>Explain why <code>rfl</code> proofs donâ€™t work for functions defined by well-founded recursion.</p>
</li>
<li>Employ sneaky equation compiler tricks to simplify function writing.</li>
<li>
<p>Explain how to use the <code>using_well_founded</code> command</p>
<ul>
<li>to work with custom relations via <code>rel_tac</code> and</li>
<li>to create decreasing proofs via <code>dec_tac</code>.</li>
</ul>
</li>
</ol>
<p>While writing the post, I wrote a proof (not in the post) that quicksort sorts a list (ableit with different definitions of <code>qsort</code> and <code>sorted</code> to those in mathlib). If it's worth having these in mathlib (I note <span class="user-mention" data-user-id="110865">@Jeremy Avigad</span> did similar proofs for <code>merge_sort</code> and <code>insertion_sort</code>), let me know!</p>



<a name="244155455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244155455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Huá»³nh Tráº§n Khanh <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244155455">(Jun 28 2021 at 14:44)</a>:</h4>
<p>thanks for the article! this is something I struggled to understand for a long time! many thanks ðŸ¥°ðŸ¥°ðŸ˜Š</p>



<a name="244157990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244157990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244157990">(Jun 28 2021 at 15:01)</a>:</h4>
<p>That's a great material! I always wished for something like this</p>



<a name="244159472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244159472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244159472">(Jun 28 2021 at 15:11)</a>:</h4>
<p>I wonder if you'd also like to provide a version of lg using <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.binary_rec">docs#nat.binary_rec</a></p>



<a name="244159721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244159721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Horatiu Cheval <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244159721">(Jun 28 2021 at 15:13)</a>:</h4>
<p>Does anyone know how well founded recursion will be done in lean4? Sure, the fundamentals will most likely be the same, but will the <code>dec_tac</code>, <code>rel_tac</code> structure be preserved?</p>



<a name="244165748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244165748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244165748">(Jun 28 2021 at 15:53)</a>:</h4>
<p><span class="user-mention" data-user-id="308899">@Yakov Pechersky</span> oh neat, I hadn't seen that before. Something like</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">lg_bin</span> <span class="o">:</span> <span class="n">â„•</span> <span class="bp">â†’</span> <span class="n">â„•</span> <span class="o">:=</span> <span class="n">nat.binary_rec</span> <span class="mi">0</span> <span class="o">(</span><span class="bp">Î»</span> <span class="n">b</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span> <span class="mi">1</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span>
</code></pre></div>
<p>?</p>



<a name="244166283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244166283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244166283">(Jun 28 2021 at 15:57)</a>:</h4>
<p>Yes, and there are helper lemmas <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.binary_rec_zero">docs#nat.binary_rec_zero</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.binary_rec_eq">docs#nat.binary_rec_eq</a>. An example of using it can be found in <a href="https://leanprover-community.github.io/mathlib_docs/find/nat.bin_cast_eq/src">src#nat.bin_cast_eq</a></p>



<a name="244190119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244190119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Brandon Brown <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244190119">(Jun 28 2021 at 18:57)</a>:</h4>
<p>Glad to know there's another blog about learning Lean besides the Xena blog</p>



<a name="244190409"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244190409" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244190409">(Jun 28 2021 at 18:59)</a>:</h4>
<p><span class="user-mention" data-user-id="233737">@Gihan Marasingha</span> , the exposition is really great. I wrote <code>merge_sort</code> and <code>insertion_sort</code> a long time ago, before the equation compiler could handle well-founded recursion (in Lean 2, I think?). I recently had to write two well-founded recursions by hand in Lean 4. It's a little scary at first but not so bad in the end, and even when we can get Lean to fill in the details automatically, it is nice to understand what is going on under the hood.</p>



<a name="244196231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244196231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gihan Marasingha <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244196231">(Jun 28 2021 at 19:54)</a>:</h4>
<p>Thanks. I haven't even tried wf recursion in Lean 4. Does the Lean 4 equation compiler handle wf recursion? That isn't clear from the manual.</p>



<a name="244197715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Well-founded%20recursion%20%20/%20quick%20sort/near/244197715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Brandon Brown <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Well-founded.20recursion.20.20.2F.20quick.20sort.html#244197715">(Jun 28 2021 at 20:06)</a>:</h4>
<p>Well-founded recursion isn't implemented in Lean4 yet, and it says so in the error message anytime a function is unable to be verified as structurally terminating by the termination checker</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>