---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/even.2Fodd.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html">even/odd</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="275412495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275412495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275412495">(Mar 15 2022 at 18:03)</a>:</h4>
<p>Dear All,</p>
<p>currently, <code>even</code> and <code>odd</code> are defined as follow:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span>

<span class="sd">/-- An element `a` of a semiring is even if there exists `k` such `a = 2*k`. -/</span>
<span class="kd">def</span> <span class="n">even</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">k</span>

<span class="sd">/-- An element `a` of a semiring is odd if there exists `k` such `a = 2*k + 1`. -/</span>
<span class="kd">def</span> <span class="n">odd</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span>
</code></pre></div>
<p>What would everyone think of redefining them in terms of <code>bit0</code> and <code>bit1</code>?  (Recall that <code>bit0 a  = a + a</code> and <code>bit1 a = a + a + 1</code>).</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="c1">--  new version</span>
<span class="sd">/-- An element `a` of a type with addition is even if there exists `k` such `a = k + k`. -/</span>
<span class="kd">def</span> <span class="n">even</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">bit0</span> <span class="n">k</span>

<span class="sd">/-- An element `a` of a semiring is odd if there exists `k` such `a = k + k + 1`. -/</span>
<span class="kd">def</span> <span class="n">odd</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">bit1</span> <span class="n">k</span>
</code></pre></div>
<p>This means that some of the lemmas in <code>data.nat/int.parity</code> can be proven more generally and only once, e.g. <code>even.add_even, even.add_odd</code>...</p>



<a name="275413270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275413270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275413270">(Mar 15 2022 at 18:08)</a>:</h4>
<p>Note that bit0/bit1 are gone in Lean 4.</p>



<a name="275413486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275413486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275413486">(Mar 15 2022 at 18:10)</a>:</h4>
<p>Ok, so maybe I am changing to using</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- An element `a` of a type with addition is even if there exists `k` such `a = k + k`. -/</span>
<span class="kd">def</span> <span class="n">even</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">k</span> <span class="bp">+</span> <span class="n">k</span>

<span class="sd">/-- An element `a` of a semiring is odd if there exists `k` such `a = k + k + 1`. -/</span>
<span class="kd">def</span> <span class="n">odd</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">k</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">k</span> <span class="bp">+</span> <span class="n">k</span> <span class="bp">+</span> <span class="mi">1</span>
</code></pre></div>
<p><span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="275416468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275416468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275416468">(Mar 15 2022 at 18:30)</a>:</h4>
<p>You only need <code>[has_add α] [has_one]</code> for <code>odd</code> <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="275416593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275416593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275416593">(Mar 15 2022 at 18:31)</a>:</h4>
<p>That's what I had, I'm not sure how I could have gone so much overboard with the assumptions!  <span aria-label="lol" class="emoji emoji-1f606" role="img" title="lol">:lol:</span></p>



<a name="275444581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275444581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275444581">(Mar 15 2022 at 22:33)</a>:</h4>
<p>As an experiment, I created a new file and proved the four lemmas about adding two elements of a semiring, with all combinations of even odd assumptions.</p>
<p>I then removed the duplicates in <code>data.nat/int.parity</code> and realized that these lemmas were not actually used!</p>



<a name="275444667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275444667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275444667">(Mar 15 2022 at 22:34)</a>:</h4>
<p>The PR is <a href="https://github.com/leanprover-community/mathlib/pull/12718">#12718</a>.  The definition of even/has not changed.</p>



<a name="275910086"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275910086" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275910086">(Mar 19 2022 at 13:12)</a>:</h4>
<p>... which broke some of my code upon updating mathlib; it was using some <code>nat.even.</code> stuff.</p>



<a name="275910216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275910216" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275910216">(Mar 19 2022 at 13:16)</a>:</h4>
<p>Oh, what is it?  Probably, removing a <code>nat.</code> or <code>int.</code> prefix might fix the issue?</p>



<a name="275910221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275910221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275910221">(Mar 19 2022 at 13:16)</a>:</h4>
<p>I'm not at a computer, though, so I will have limited possibilities of fixing this soon...</p>



<a name="275910225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275910225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275910225">(Mar 19 2022 at 13:17)</a>:</h4>
<p>(Also, hi Michael!)</p>



<a name="275911053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275911053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275911053">(Mar 19 2022 at 13:39)</a>:</h4>
<p><span class="user-mention" data-user-id="321459">@Damiano Testa</span>  Hi! Yes, I just had to remove the <code>nat.</code> prefix.</p>



<a name="275911130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275911130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275911130">(Mar 19 2022 at 13:40)</a>:</h4>
<p>I have tried being careful to only generalize statements, and not removing anything that was there, even if unused in master.</p>
<p>Glad that this was easy!</p>



<a name="275912057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275912057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275912057">(Mar 19 2022 at 14:02)</a>:</h4>
<p>In fact, in one of the lemmas, the order of arguments had to be switched, but it was no big deal.</p>



<a name="275912282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/275912282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#275912282">(Mar 19 2022 at 14:08)</a>:</h4>
<p>Ok.  I would have probably picked up on this, if the even/odd side of the library was more used.  As is, very few files use even/odd, so it is difficult to know if I made some "big" changes.  The most visible for me was the change in namespace.</p>



<a name="276037963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276037963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276037963">(Mar 21 2022 at 11:43)</a>:</h4>
<p>Actually, why weren't <code>even</code> and <code>odd</code> using <code>2 •</code> instead of <code>2 *</code>?</p>



<a name="276039355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276039355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276039355">(Mar 21 2022 at 11:59)</a>:</h4>
<p>I'm guessing that would mean inserting smul_eq_mul rewrites in a lot of places</p>



<a name="276039983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276039983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276039983">(Mar 21 2022 at 12:05)</a>:</h4>
<p>What would the motivation be to use smul instead of mul?</p>



<a name="276042137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276042137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276042137">(Mar 21 2022 at 12:25)</a>:</h4>
<p>... to not assume <code>has_mul</code></p>



<a name="276044128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276044128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276044128">(Mar 21 2022 at 12:43)</a>:</h4>
<p>If you want the reason, it's that a little over a year ago Patrick Massot defined them so that they can replace <code>nat.even</code>/<code>nat.odd</code> and <code>int.even</code>/<code>int.odd</code>.</p>
<p>Curious if there are any situations where you'd have <code>has_add</code> and <code>has_one</code>, have no <code>has_mul</code>, and want to know which elements are even or odd.</p>



<a name="276044526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276044526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276044526">(Mar 21 2022 at 12:46)</a>:</h4>
<p>For abelian groups aka <code>ℤ</code>-modules it seems a reasonable concept.</p>



<a name="276045113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276045113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276045113">(Mar 21 2022 at 12:50)</a>:</h4>
<p>Those have <code>has_add</code> and <code>has_zero</code>, but no <code>has_one</code>, right?</p>



<a name="276045149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276045149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276045149">(Mar 21 2022 at 12:50)</a>:</h4>
<p>Yes, so you can still talk about <code>even</code></p>



<a name="276045223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276045223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276045223">(Mar 21 2022 at 12:51)</a>:</h4>
<p>Ah sure, I was only thinking about <code>has_smul</code></p>



<a name="276053920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276053920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276053920">(Mar 21 2022 at 13:57)</a>:</h4>
<p>I was thinking of doing the change with \smul.  However, it seems a little bit of work, which eventually is almost entirely used in <code>nat, int, zmod 2</code>.</p>
<p>If you think that having <code>even</code> for abelian add_monoids, then I can go ahead and refactor.</p>



<a name="276150486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276150486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276150486">(Mar 22 2022 at 07:14)</a>:</h4>
<p>I have a proposal about this.</p>
<p>First a little bit of motivation.<br>
I feel that <code>even</code> is <em>much</em> more useful for a general type than <code>odd</code>.  The usefulness of <code>odd</code> is mostly for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">N</mi></mrow><annotation encoding="application/x-tex">\mathbb{N}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">N</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord mathbb">Z</span></span></span></span> and, a little artificially, for <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Z</mi><mi mathvariant="normal">/</mi><mn>2</mn><mi mathvariant="double-struck">Z</mi></mrow><annotation encoding="application/x-tex">\mathbb{Z}/2\mathbb{Z}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Z</span><span class="mord">/2</span><span class="mord mathbb">Z</span></span></span></span>.</p>
<p>Moreover, <code>even</code> is the additive version of <code>square</code>.  Btw, I did not find <code>square</code> or <code>is_square</code> in mathlib.</p>
<p>What do people think of the following?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.group.to_additive</span>

<span class="sd">/--  An element `a` of a type `α` with multiplication satisfies `square a` if `a = r * r`,</span>
<span class="sd">for some `r : α`. -/</span>
<span class="kd">@[to_additive even</span>
<span class="kd">"An element `a` of a type `α` with addition satisfies `even a` if `a = r + r`,</span>
<span class="kd">for some `r : α`."]</span>
<span class="kd">def</span> <span class="n">square</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_mul</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">r</span><span class="o">,</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">r</span> <span class="bp">*</span> <span class="n">r</span>
</code></pre></div>



<a name="276150519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276150519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276150519">(Mar 22 2022 at 07:15)</a>:</h4>
<p>Then, the "general theory" would use <code>\not even</code>, rather than <code>odd</code>.</p>



<a name="276150858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276150858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276150858">(Mar 22 2022 at 07:21)</a>:</h4>
<p>I think square is generally rendered in mathlib as <code>sq</code>, did you try searching for that?</p>



<a name="276150947"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276150947" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276150947">(Mar 22 2022 at 07:23)</a>:</h4>
<p>In any case, making <code>even</code> the <code>to_additive</code> of a new <code>is_sq</code> seems clever and a good idea.</p>



<a name="276151875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276151875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276151875">(Mar 22 2022 at 07:38)</a>:</h4>
<p>I just tried with <code>sq</code> and <code>is_sq</code>: with the former, there are several hits, but they all seem to be referring to lemmas describing a <code>^ 2</code> appearing in the type.</p>
<p>I could still not find a definition of a square.  It may very well be that it is not there.</p>



<a name="276151885"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276151885" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276151885">(Mar 22 2022 at 07:39)</a>:</h4>
<p>I also tried the more general <code>is_pow</code> and again I could not find it.</p>



<a name="276153381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276153381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276153381">(Mar 22 2022 at 08:00)</a>:</h4>
<p>I personally think that all this is abstraction for abstraction's sake. Where is the application? Of course we use it for \N and \Z. Do we ever use the concept of oddness elsewhere?</p>



<a name="276153934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276153934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276153934">(Mar 22 2022 at 08:06)</a>:</h4>
<p>I agree with you on <code>odd</code>: I do not think that <code>odd</code> is used except for <code>nat</code> and <code>int</code>.</p>
<p>However, <code>square/even</code> seem much more ubiquitous and that is the definition that I am proposing.</p>



<a name="276155769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276155769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276155769">(Mar 22 2022 at 08:28)</a>:</h4>
<p>Do you then want to define <code>odd a</code> as <code>¬ even a</code>?</p>



<a name="276155927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276155927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276155927">(Mar 22 2022 at 08:29)</a>:</h4>
<p>I am not even sure that I would define <code>odd</code> generally.  I would delay defining <code>odd</code> for as long as possible.  I think that<code>¬ even a</code> is good in general.  For <code>nat, int</code> it is possible that <code>+ 1</code> is a good choice.</p>



<a name="276156076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276156076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276156076">(Mar 22 2022 at 08:31)</a>:</h4>
<p>Okay sure. I quite like this idea.</p>



<a name="276156224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276156224" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276156224">(Mar 22 2022 at 08:32)</a>:</h4>
<p>Let me clarify: I am proposing to change the definition of <code>even</code> so that it is the <code>to_additive</code> version of <code>square</code>.</p>
<p>With respect to <code>odd</code> I am currently proposing no change: whatever is already in mathlib, stays as is.</p>
<p>Possibly, <code>odd</code> will be revamped later on, but for the moment I was concerning myself only with <code>even</code>.</p>



<a name="276156268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276156268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276156268">(Mar 22 2022 at 08:33)</a>:</h4>
<p>The main point we have to remember is that <code>even</code>/<code>square</code> really is a very basic property that we use to simplify very elementary arguments.</p>



<a name="276163011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276163011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276163011">(Mar 22 2022 at 09:46)</a>:</h4>
<p>In the code I have written so far to deal with the Hilbert symbol (over ℚ), I use <code>even</code> and <code>odd</code> a lot (of naturals), since it is very relevant if the p-adic valuation of something is even or odd. So I would hope that my squeezed <code>simp</code>s will continue to work...</p>



<a name="276163392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276163392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276163392">(Mar 22 2022 at 09:50)</a>:</h4>
<p>I hope so too!  In any case, I have not started this yet.  Once there is a PR, you can "test it out" by merging it into your branch and seeing if something breaks.</p>
<p>If/when it does, simply let me know and I will try to see what is going on.  I will attempt to only change the definition and replace it with an equivalent one, so that all "old" lemmas still hold.  What happened earlier was that some lemmas changed namespace, since they were no longer specific to <code>nat/int</code> but applied more generally.  This is, I hope, the largest change to be expected for the existing lemmas!</p>



<a name="276163418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276163418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276163418">(Mar 22 2022 at 09:50)</a>:</h4>
<p>Even the reordering of assumptions with which you had problems should <em>not</em> have happened.</p>



<a name="276163860"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276163860" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276163860">(Mar 22 2022 at 09:55)</a>:</h4>
<p>By the way, if you PR your lemmas and they make it to mathlib <em>before</em> the revamping of <code>even</code> takes place, then it is not your responsibility to make sure that it still compiles, but mine! <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="276164064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276164064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276164064">(Mar 22 2022 at 09:57)</a>:</h4>
<p>In fact, what you are describing is a great testing ground for the change in <code>even/square</code>.  Knowing that something has <code>even</code> valuation is not equivalent to it being a <code>square</code> and it would be kind of cool to see the interaction between these two "identical concepts in additive/multiplicative groups" playing out in Lean!</p>



<a name="276164334"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276164334" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276164334">(Mar 22 2022 at 09:59)</a>:</h4>
<p>It will take a while until my stuff will get into mathlib, so don't hold your breath.</p>



<a name="276164535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276164535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276164535">(Mar 22 2022 at 10:00)</a>:</h4>
<p>Anyway, here is a teaser:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">theorem</span> <span class="n">Hsymbol_product_formula_finprod</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∏ᶠ</span> <span class="n">v</span><span class="o">,</span> <span class="o">[</span><span class="n">a</span><span class="o">,</span> <span class="n">b</span> <span class="bp">|</span> <span class="n">v</span><span class="o">]</span><span class="n">_H</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="bp">...</span>
</code></pre></div>



<a name="276164627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276164627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276164627">(Mar 22 2022 at 10:01)</a>:</h4>
<p>I'll open a thread on this and the questions I have related to getting it into mathlib at some later point...</p>



<a name="276164949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276164949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276164949">(Mar 22 2022 at 10:04)</a>:</h4>
<p>Ok, in any case, once this gets going, I may ask you if I can merge your branch into mine, as a test.  At the moment, even/odd is not so used in mathlib and squares do not appear to even exist!</p>



<a name="276165174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276165174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276165174">(Mar 22 2022 at 10:06)</a>:</h4>
<p>Pretty sure they do, but the condition is written out.</p>



<a name="276167594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276167594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276167594">(Mar 22 2022 at 10:29)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span> Is that <code>Hsymbol_product_formula_finprod</code> sorry-free?</p>



<a name="276167635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276167635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276167635">(Mar 22 2022 at 10:29)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Yes!</p>



<a name="276167714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276167714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276167714">(Mar 22 2022 at 10:30)</a>:</h4>
<p>Wow! That's really nice!</p>



<a name="276167763"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276167763" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276167763">(Mar 22 2022 at 10:30)</a>:</h4>
<p>As it stands, it is ~3000 lines of code.</p>



<a name="276167799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276167799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276167799">(Mar 22 2022 at 10:31)</a>:</h4>
<p>And some stuff is still missing, like the characterization via solvability of ternary quadratic forms...</p>



<a name="276168442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276168442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276168442">(Mar 22 2022 at 10:36)</a>:</h4>
<p>When I embarked on that project, I did not anticipate that it would grow so large.</p>



<a name="276168531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276168531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276168531">(Mar 22 2022 at 10:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="479359">Michael Stoll</span> <a href="#narrow/stream/113488-general/topic/even.2Fodd/near/276168442">said</a>:</p>
<blockquote>
<p>When I embarked on that project, I did not anticipate that it would grow so large.</p>
</blockquote>
<p>I feel that! :)</p>



<a name="276230301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276230301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276230301">(Mar 22 2022 at 18:01)</a>:</h4>
<p>If you are interested, I started preparing the refactor of even.  The relevant PR is <a href="https://github.com/leanprover-community/mathlib/pull/12882">#12882</a>.</p>
<p>This PR is only moving (many) lemmas involving even/odd to a single file.  The change in definition will happen in a separate PR.</p>



<a name="276265299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276265299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276265299">(Mar 22 2022 at 22:52)</a>:</h4>
<p><span class="user-mention" data-user-id="479359">@Michael Stoll</span>, if you've got 3000 lines of code, you think some things are still missing, but substantial results are already sorry-free, I'd really encourage you to start PRing material. It's going to require many PRs to get your work into mathlib, and starting early is good for everyone. (mathlib gets the early content even if the content you still want to work on takes much longer, you get feedback that may require changes to the later work as early as possible, and reviewers get more time!)</p>



<a name="276387832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276387832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276387832">(Mar 23 2022 at 19:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> You are probably right, but I'm a bit afraid that doing all this will develop into an enormous time sink... (And first I have to learn how this all works.) So I'm planning to do it slowly.</p>



<a name="276395527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276395527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276395527">(Mar 23 2022 at 20:29)</a>:</h4>
<p>There is no doubt it will be an enormous time sink. But you'll learn a lot.</p>



<a name="276400082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/276400082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#276400082">(Mar 23 2022 at 21:02)</a>:</h4>
<p>And this way your code will not rot (especially after migration to Lean 4).</p>



<a name="277100450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/even/odd/near/277100450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/even.2Fodd.html#277100450">(Mar 30 2022 at 06:50)</a>:</h4>
<p>Dear All,</p>
<p>PR <a href="https://github.com/leanprover-community/mathlib/pull/13037">#13037</a> now has <code>olean</code>s!  Any comment would be greatly appreciated!</p>
<p>Thanks!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>