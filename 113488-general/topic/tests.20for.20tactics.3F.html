---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/tests.20for.20tactics.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html">tests for tactics?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="198843045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843045">(May 27 2020 at 02:05)</a>:</h4>
<p>I wrote an <code>assumption?</code> tactic, following [this thread].(<a href="#narrow/stream/113489-new-members/topic/Achievement.3A.20multiply.20convergent.20sequences/near/198830593">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/Achievement.3A.20multiply.20convergent.20sequences/near/198830593</a>) <br>
The code is in this <a href="https://github.com/leanprover-community/lean/compare/master...jalex-stark:assumption-question-mark">private branch</a>, and I think it's ready to PR modulo tests.</p>
<p>I'm not sure where to put the tests. <a href="https://github.com/leanprover-community/lean/tree/master/tests/lean">the test folder</a> is kind of a big place. I can't tell if there are already tests for <code>assumption</code> that the new tests should live with. Or maybe they should live on their own in the <code>interactive</code> folder?</p>



<a name="198843239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843239">(May 27 2020 at 02:10)</a>:</h4>
<p>I think the standard practice would just be to create <code>test/assumption.lean</code>. As this was a core tactic, it probably didn't have existing tests.</p>



<a name="198843254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843254">(May 27 2020 at 02:11)</a>:</h4>
<p>"was a core tactic"</p>
<p>should i be PRing this to mathlib instead of core?</p>



<a name="198843331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843331">(May 27 2020 at 02:13)</a>:</h4>
<p>The tests are separated into those that involve server interaction and those that don't. Other than that it's sort of a free for all as far as naming</p>



<a name="198843361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843361">(May 27 2020 at 02:13)</a>:</h4>
<p>Feel free to make a new file</p>



<a name="198843412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843412">(May 27 2020 at 02:14)</a>:</h4>
<p>the only assumption test I see is <code>assumption_tac_notation.lean</code></p>



<a name="198843417"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843417" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843417">(May 27 2020 at 02:14)</a>:</h4>
<p>okay, so I should make a new file inside of the <code>interactive</code> folder?</p>



<a name="198843432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843432">(May 27 2020 at 02:15)</a>:</h4>
<p>no, I think this one doesn't need server interaction so it would be in <code>tests/lean</code></p>



<a name="198843499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843499">(May 27 2020 at 02:16)</a>:</h4>
<p>oh okay, I guess i don't know what server interaction means</p>



<a name="198843516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843516">(May 27 2020 at 02:17)</a>:</h4>
<p>the test for trace is in <code>tests/lean/interactive</code>, I guess you're saying that <code>tests/lean</code> has ~no organization and I can plop down an <code>assumption.lean</code> wherever</p>



<a name="198843518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843518">(May 27 2020 at 02:17)</a>:</h4>
<p>In this case, you are just printing something. The server interaction would be checking that this gets highlighted, and clicking on it produces a working proof</p>



<a name="198843526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843526">(May 27 2020 at 02:17)</a>:</h4>
<p>but that is sort of orthogonal to <code>assumption?</code> itself</p>



<a name="198843628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843628">(May 27 2020 at 02:19)</a>:</h4>
<p>the <code>interactive</code> tests have an <code>expected.out</code> file that consists of the JSON commands that lean is expected to produce when given this input file. <code>interactive/trace.lean</code> for example is testing that the blue highlighted span covers the right characters</p>



<a name="198843691"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843691" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843691">(May 27 2020 at 02:20)</a>:</h4>
<p>for non-interactive tests, the <code>expected.out</code> file just contains the output you would get if you ran <code>lean foo.lean</code> on the console</p>



<a name="198843768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843768">(May 27 2020 at 02:22)</a>:</h4>
<p>So you would use <code>interactive</code> tests for testing things like hovers, getting the goal state, and other things like that that are not reported in non-interactive use</p>



<a name="198843775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843775">(May 27 2020 at 02:22)</a>:</h4>
<p>i see, thanks</p>



<a name="198843883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198843883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198843883">(May 27 2020 at 02:25)</a>:</h4>
<p>I'm not sure if there is a tool in the tests folder for producing a valid <code>expected.out</code> file, but it is easy enough for non-interactive tests, you run <code>lean my_test.lean &gt; my_test.lean.expected.out</code> and check that the file looks okay</p>



<a name="198844017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198844017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198844017">(May 27 2020 at 02:28)</a>:</h4>
<p>how do I get a lean binary that includes the changes I made to core?</p>



<a name="198844304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198844304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198844304">(May 27 2020 at 02:35)</a>:</h4>
<p>this is now [WIP] <a href="https://github.com/leanprover-community/lean/issues/281">lean#281</a>, maybe tomorrow I will figure out how to build the test</p>



<a name="198850180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/tests%20for%20tactics%3F/near/198850180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/tests.20for.20tactics.3F.html#198850180">(May 27 2020 at 05:11)</a>:</h4>
<p>The build instructions are <a href="https://github.com/leanprover-community/lean/blob/master/doc/make/index.md">here</a>. The bottom of the file also has info on running the tests.</p>
<p>As far as where to put the tests, there are several types. The simplest tests go in <code>tests/lean/run</code>. The files in that directory are just checked to make sure that they compile without errors. The files in the directory above that have an associated <code>.expected.out</code> file which the test runner checks against the produced output. The interactive tests have their own format, you can put in line comments with carets in them indicating where to run server commands (e.g. <a href="https://github.com/leanprover-community/lean/blob/master/tests/lean/interactive/complete_import.lean">this file</a>) and then the server output is compared to the contents of <code>.expected.out</code> (e.g. <a href="https://github.com/leanprover-community/lean/blob/master/tests/lean/interactive/complete_import.lean.expected.out">the corresponding file</a>).</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>