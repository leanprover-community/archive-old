---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html">sorry does not behave like NaN</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="195656789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195656789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195656789">(Apr 29 2020 at 03:46)</a>:</h4>
<p>I expected this to fail:</p>
<div class="codehilite"><pre><span></span><code><span class="bp">#</span><span class="kn">check</span> <span class="o">(</span><span class="n">rfl</span> <span class="o">:</span> <span class="o">(</span><span class="n">sorry</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">sorry</span><span class="o">)</span>
</code></pre></div>



<a name="195656811"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195656811" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195656811">(Apr 29 2020 at 03:46)</a>:</h4>
<p>should <code>sorry</code> behave like <code>NaN</code> in javascript?</p>



<a name="195656851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195656851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195656851">(Apr 29 2020 at 03:47)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="o">&gt;</span> <span class="kc">NaN</span> <span class="o">==</span> <span class="kc">NaN</span>
<span class="o">&lt;</span> <span class="kc">false</span>
</code></pre></div>



<a name="195656853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195656853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195656853">(Apr 29 2020 at 03:47)</a>:</h4>
<p>I was wondering the same thing</p>



<a name="195656881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195656881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195656881">(Apr 29 2020 at 03:47)</a>:</h4>
<p>please don't make that comparison, javascript is not something we should aspire to</p>



<a name="195656915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195656915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195656915">(Apr 29 2020 at 03:47)</a>:</h4>
<p>but <code>sorry</code> shouldn't be equal to <code>sorry</code> right</p>



<a name="195657002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657002">(Apr 29 2020 at 03:48)</a>:</h4>
<p>That depends on what you mean. I think that the way it currently works a <code>sorry</code> is marked only with its expected type, so of course it should be equal to itself in the same way that <code>choice nat</code> is equal to <code>choice nat</code></p>



<a name="195657007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657007">(Apr 29 2020 at 03:49)</a>:</h4>
<p>Isn't <code>sorry</code> basically like <code>choice</code>...</p>



<a name="195657012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657012">(Apr 29 2020 at 03:49)</a>:</h4>
<p>without that pesky <code>nonempty</code> side condition</p>



<a name="195657026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657026" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657026">(Apr 29 2020 at 03:49)</a>:</h4>
<p>or at least, that seems like a reasonable way for it to work</p>



<a name="195657074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657074">(Apr 29 2020 at 03:50)</a>:</h4>
<p>You might want distinct occurrences of <code>sorry</code> to turn into different constants</p>



<a name="195657077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657077">(Apr 29 2020 at 03:50)</a>:</h4>
<p>A reasonable alternative implementation has the <code>sorry</code> macro get a tag that is renewed every time the word <code>sorry</code> is parsed</p>



<a name="195657088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657088">(Apr 29 2020 at 03:50)</a>:</h4>
<p>so like those private definitions with those big numbers</p>



<a name="195657090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657090">(Apr 29 2020 at 03:50)</a>:</h4>
<p>yes</p>



<a name="195657094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657094">(Apr 29 2020 at 03:50)</a>:</h4>
<p>I don't know if the numbers would be public in this case though</p>



<a name="195657101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657101">(Apr 29 2020 at 03:51)</a>:</h4>
<p>if they are internal to the macro then they can't be forged</p>



<a name="195657126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657126">(Apr 29 2020 at 03:51)</a>:</h4>
<p>But it would not fix that time Patrick wrote something like <code>def smooth (f : real -&gt; real) : Prop := sorry</code> and <code>lemma smooth_constant (r) : smooth (\lam _, r)</code> and then found he could prove that all functions were <code>smooth</code>.</p>



<a name="195657137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657137">(Apr 29 2020 at 03:51)</a>:</h4>
<p>they would be part of the <code>macro_def</code> object that is not inspectable from lean</p>



<a name="195657198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657198">(Apr 29 2020 at 03:52)</a>:</h4>
<p><code>sorry</code> could capture its entire local context</p>



<a name="195657208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195657208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195657208">(Apr 29 2020 at 03:52)</a>:</h4>
<p>Yes, that's true.</p>



<a name="195666143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195666143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195666143">(Apr 29 2020 at 06:38)</a>:</h4>
<p>I don't think I ever sorried data from the day I saw Patrick's example</p>



<a name="195666739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195666739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195666739">(Apr 29 2020 at 06:47)</a>:</h4>
<p>note that there is an easy workaround for patrick's example, which is to sorry the function after reverting everything, i.e. <code>def smooth : (real -&gt; real) -&gt; Prop := sorry</code></p>



<a name="195666848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195666848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195666848">(Apr 29 2020 at 06:48)</a>:</h4>
<p>In fact, it would be an easy fix to the <code>sorry</code> tactic to make it call <code>revert_all</code> first</p>



<a name="195666887"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195666887" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195666887">(Apr 29 2020 at 06:48)</a>:</h4>
<p>and then at least <code>def smooth (f : real -&gt; real) : Prop := by sorry</code> would have the right behavior</p>



<a name="195684211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195684211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195684211">(Apr 29 2020 at 09:48)</a>:</h4>
<p>You can just use <code>constant smooth</code> as well</p>



<a name="195685384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195685384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195685384">(Apr 29 2020 at 09:57)</a>:</h4>
<p>why could he prove that all functions were smooth?</p>



<a name="195686522"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195686522" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195686522">(Apr 29 2020 at 10:06)</a>:</h4>
<p>When you write <code>def smooth (f : real -&gt; real) : Prop := sorry</code>, <code>sorry</code> is basically like <code>choice Prop</code>. So in particular it does not depend on <code>f</code>, and so this function, whatever it is, is a constant function.</p>



<a name="195686953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195686953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195686953">(Apr 29 2020 at 10:10)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">smooth</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="bp">ℕ</span> <span class="bp">→</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">sorry</span>
<span class="kn">lemma</span> <span class="n">smooth_constant</span> <span class="o">(</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">smooth</span> <span class="o">(</span><span class="bp">λ</span> <span class="bp">_</span><span class="o">,</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="n">sorry</span>
<span class="kn">lemma</span> <span class="n">smooth_all</span> <span class="o">(</span><span class="n">f</span><span class="o">)</span> <span class="o">:</span> <span class="n">smooth</span> <span class="n">f</span> <span class="o">:=</span> <span class="n">smooth_constant</span> <span class="mi">0</span>
</code></pre></div>



<a name="195686955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sorry%20does%20not%20behave%20like%20NaN/near/195686955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sorry.20does.20not.20behave.20like.20NaN.html#195686955">(Apr 29 2020 at 10:10)</a>:</h4>
<p>wow</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>