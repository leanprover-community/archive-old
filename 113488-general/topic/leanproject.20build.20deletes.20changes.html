---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/leanproject.20build.20deletes.20changes.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html">leanproject build deletes changes</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="229265517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/229265517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#229265517">(Mar 08 2021 at 08:49)</a>:</h4>
<p>Doing <code>leanproject build</code> just deleted all my uncommited changes in the affected folder (including deleting a new file). I can reproduce it: I write something in a mathlib file, save, execute leanproject build, and the change is gone. <br>
Is is a problem of my installation? Has leanproject been recently modified such that it is now supposed to do that? Any idea of how I can modify that behaviour or what additional info I could look for to understand what happens?</p>



<a name="229265966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/229265966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#229265966">(Mar 08 2021 at 08:53)</a>:</h4>
<p>a more detailed account of what I did: I created a branch <code>l2_space</code> on the mathlib github page, did <code>leanproject get -b mathlib:l2_space</code>, wrote some changes, did <code>leanproject build</code>, and my folder is back to the state it was in after <code>leanproject get -b mathlib:l2_space</code>.</p>



<a name="229266155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/229266155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#229266155">(Mar 08 2021 at 08:54)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib-tools/pull/96">https://github.com/leanprover-community/mathlib-tools/pull/96</a> fixes this. <code>leanproject</code> has always behaved like this, as far as I can tell</p>



<a name="229266433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/229266433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#229266433">(Mar 08 2021 at 08:56)</a>:</h4>
<p>It feels like it never did this to me before yesterday but I must be wrong.</p>



<a name="229266536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/229266536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#229266536">(Mar 08 2021 at 08:57)</a>:</h4>
<p>Thankfully I lost only some copy/pasted things from another folder, so I lost only 10min really.</p>



<a name="229266891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/229266891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#229266891">(Mar 08 2021 at 09:00)</a>:</h4>
<p>I'll be careful. Thanks for the reply!</p>



<a name="229267014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/229267014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#229267014">(Mar 08 2021 at 09:01)</a>:</h4>
<p>I'm now just using that branch instead of the released version of mathlibtools, as I've blown away files multiple times this way and don't want to risk it any more.</p>



<a name="236218009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/236218009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#236218009">(Apr 26 2021 at 18:03)</a>:</h4>
<p>Yep, this just happened to me as well. Is it possible yet to update to a version of <code>leanproject</code> that doesn't have this problem?</p>



<a name="236223905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/236223905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#236223905">(Apr 26 2021 at 18:45)</a>:</h4>
<p>Why not just do <code>lean --make src</code>? This has the extra advantage that you can add <code>-M6000</code> and stop Lean from taking your desktop down.</p>



<a name="236224673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/236224673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#236224673">(Apr 26 2021 at 18:50)</a>:</h4>
<p>Great advice. If <code>lean --make src</code> is the better practice though, it seems like  the guidance on the <a href="https://leanprover-community.github.io/contribute/index.html">contribution guidelines page</a> should say to do this rather than <code>leanproject build</code>. Can this be changed?</p>



<a name="236224689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/236224689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rémy Degenne <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#236224689">(Apr 26 2021 at 18:50)</a>:</h4>
<p>Personally, I think the reason I did <code>leanproject build</code> and was caught by that issue once was that I followed the instructions on the "how to contribute page" <a href="https://leanprover-community.github.io/contribute/index.html">https://leanprover-community.github.io/contribute/index.html</a> . It states among other steps:</p>
<ul>
<li>edit the necessary files, e.g. src/data/set/basic.lean</li>
<li>If you are anxious, leanproject build to check you didn't break anything.</li>
</ul>



<a name="236224751"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/236224751" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#236224751">(Apr 26 2021 at 18:51)</a>:</h4>
<p>Wow, it seems we made the same comment at the same time</p>



<a name="236225963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/236225963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#236225963">(Apr 26 2021 at 19:00)</a>:</h4>
<p>Oh I see! I hadn't realised that the claim was that the instructions are explicitly telling people to nuke their work!</p>



<a name="236242892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/236242892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#236242892">(Apr 26 2021 at 21:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/leanproject.20build.20deletes.20changes/near/229266155">said</a>:</p>
<blockquote>
<p><a href="https://github.com/leanprover-community/mathlib-tools/pull/96">https://github.com/leanprover-community/mathlib-tools/pull/96</a> fixes this. <code>leanproject</code> has always behaved like this, as far as I can tell</p>
</blockquote>
<p>I'm pretty sure this bug was not present in the beginning. It was introduced when tweaking stuff. Eric, I think I was waiting for action from your side in this PR. Are you still interested in working on this?</p>



<a name="236254137"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20build%20deletes%20changes/near/236254137" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20build.20deletes.20changes.html#236254137">(Apr 26 2021 at 22:25)</a>:</h4>
<p>Yeah, the ball is definitely in my court here. I realized that that PR messed up the workflow for people not working on mathlib, and haven't gotten around to getting back to it</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>