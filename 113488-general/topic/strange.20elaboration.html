---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/strange.20elaboration.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html">strange elaboration</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="200385623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200385623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200385623">(Jun 10 2020 at 07:31)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">normed_space</span><span class="bp">.</span><span class="n">basic</span>

<span class="n">open_locale</span> <span class="n">big_operators</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">normed_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">}</span>

<span class="c1">-- ∀ (ε : ℝ), ε &gt; 0 → ∥t.sum f∥ &lt; ε</span>
<span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">ε</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="err">∥</span> <span class="n">t</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span> <span class="err">∥</span> <span class="bp">&lt;</span> <span class="n">ε</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">skip</span>

<span class="c1">-- ∀ (ε : ℕ), ε &gt; 0 → ∥∑ (i : α) in t, f i∥ &lt; ↑ε</span>
<span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">ε</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="err">∥</span> <span class="o">(</span><span class="err">∑</span> <span class="n">i</span> <span class="k">in</span> <span class="n">t</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="err">∥</span> <span class="bp">&lt;</span> <span class="n">ε</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">skip</span>
</code></pre></div>



<a name="200385646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200385646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200385646">(Jun 10 2020 at 07:31)</a>:</h4>
<p>the epsilon in the second example is (wrongly) interpreted as a natural number</p>



<a name="200385718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200385718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200385718">(Jun 10 2020 at 07:32)</a>:</h4>
<p>the notation is irrelevant:</p>
<div class="codehilite"><pre><span></span><code><span class="c1">-- ∀ (ε : ℕ), ε &gt; 0 → ∥∑ (i : α) in t, f i∥ &lt; ↑ε</span>
<span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">ε</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="err">∥</span> <span class="n">t</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="err">∥</span> <span class="bp">&lt;</span> <span class="n">ε</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">skip</span>
</code></pre></div>



<a name="200385858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200385858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200385858">(Jun 10 2020 at 07:34)</a>:</h4>
<p>strangely enough the type is correct again if <code>&gt; 0</code> is removed:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis</span><span class="bp">.</span><span class="n">normed_space</span><span class="bp">.</span><span class="n">basic</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">normed_group</span> <span class="n">α</span><span class="o">]</span> <span class="o">{</span><span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">}</span>

<span class="c1">-- ∀ (ε : ℝ), ε &gt; 0 → ∥t.sum f∥ &lt; ε</span>
<span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">ε</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="err">∥</span> <span class="n">t</span><span class="bp">.</span><span class="n">sum</span> <span class="n">f</span> <span class="err">∥</span> <span class="bp">&lt;</span> <span class="n">ε</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">skip</span>

<span class="c1">-- ∀ (ε : ℝ), ∥t.sum (λ (i : α), f i)∥ &lt; ε</span>
<span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">ε</span><span class="o">,</span> <span class="err">∥</span> <span class="n">t</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="err">∥</span> <span class="bp">&lt;</span> <span class="n">ε</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">skip</span>

<span class="c1">-- INCORRECT</span>
<span class="c1">-- ∀ (ε : ℕ), ε &gt; 0 → ∥t.sum (λ (i : α), f i)∥ &lt; ↑ε</span>
<span class="kn">example</span> <span class="o">:</span> <span class="bp">∀</span><span class="n">ε</span> <span class="bp">&gt;</span> <span class="mi">0</span><span class="o">,</span> <span class="err">∥</span> <span class="n">t</span><span class="bp">.</span><span class="n">sum</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="err">∥</span> <span class="bp">&lt;</span> <span class="n">ε</span> <span class="o">:=</span> <span class="k">by</span> <span class="n">skip</span>
</code></pre></div>



<a name="200387752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200387752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200387752">(Jun 10 2020 at 08:03)</a>:</h4>
<p>In what sense is it incorrect? It looks like lean was able to type it either way</p>



<a name="200387798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200387798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200387798">(Jun 10 2020 at 08:03)</a>:</h4>
<p>The <code>0</code> is the source of the nat defaulting</p>



<a name="200388324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388324">(Jun 10 2020 at 08:10)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> then why does it get elaborated as \R in the first example?</p>



<a name="200388337"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388337" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388337">(Jun 10 2020 at 08:10)</a>:</h4>
<p>maybe not "incorrect" but rather "inconsistent"</p>



<a name="200388368"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388368" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388368">(Jun 10 2020 at 08:11)</a>:</h4>
<p>nat defaulting has always been a little weird, since it is somewhat outside the usual elaboration process. It happens "late" but it still has to trigger before type inference is complete</p>



<a name="200388400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388400">(Jun 10 2020 at 08:11)</a>:</h4>
<p>so should I change it to the longer form <code>\forall \e : \R, \e &gt; 0 \to</code>?</p>



<a name="200388411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388411">(Jun 10 2020 at 08:11)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/runs/756776916">https://github.com/leanprover-community/mathlib/runs/756776916</a></p>



<a name="200388413"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388413" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388413">(Jun 10 2020 at 08:11)</a>:</h4>
<p>I've never really been convinced it is a good idea, but the original point was so that people could just write <code>#eval 1 + 1</code> and get something sensible</p>



<a name="200388415"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388415" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388415">(Jun 10 2020 at 08:11)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/3014">https://github.com/leanprover-community/mathlib/pull/3014</a></p>



<a name="200388490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388490">(Jun 10 2020 at 08:12)</a>:</h4>
<p>AFAIR you can use <code>ε &gt; (0 : real)</code>.</p>



<a name="200388504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388504">(Jun 10 2020 at 08:13)</a>:</h4>
<p>You can also .. ninja'd</p>



<a name="200388525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388525">(Jun 10 2020 at 08:13)</a>:</h4>
<p>oh</p>



<a name="200388556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388556">(Jun 10 2020 at 08:13)</a>:</h4>
<p>we should make <code>∀(ε : ℝ) &gt; 0,</code> work</p>



<a name="200388612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388612">(Jun 10 2020 at 08:14)</a>:</h4>
<p>it's a bit silly that you can't put a type ascription there</p>



<a name="200388669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388669">(Jun 10 2020 at 08:15)</a>:</h4>
<p>#lean4 ?</p>



<a name="200388959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388959">(Jun 10 2020 at 08:18)</a>:</h4>
<p>3.x should be able to handle it without too much work</p>



<a name="200388979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/strange%20elaboration/near/200388979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/strange.20elaboration.html#200388979">(Jun 10 2020 at 08:18)</a>:</h4>
<p>although I'm not in a position to hack on lean ATM</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>