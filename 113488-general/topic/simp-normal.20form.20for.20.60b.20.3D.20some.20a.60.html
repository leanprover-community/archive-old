---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html">simp-normal form for `b = some a`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="287340760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287340760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287340760">(Jun 24 2022 at 14:49)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/option.mem_def">docs#option.mem_def</a> (<code>a ∈ b ↔ b = option.some a</code>) is already marked simp, but we have a lot of <code>iff</code> lemmas with <code>a ∈ b </code> on the LHS (eg <a href="https://leanprover-community.github.io/mathlib_docs/find/alist.mem_lookup_union">docs#alist.mem_lookup_union</a>). Should we change all of these to use the <code>=</code> spelling?</p>
<p>This comes up in <a href="https://github.com/leanprover-community/mathlib/pull/14930">#14930</a>, as lean 3.44.0 is much more eager to apply <code>option.mem_def</code> than it used to be.</p>



<a name="287340991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287340991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287340991">(Jun 24 2022 at 14:51)</a>:</h4>
<p>Alternatively, we could make <code>option.mem_def</code> not be a simp lemma</p>



<a name="287348424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287348424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287348424">(Jun 24 2022 at 15:47)</a>:</h4>
<p>On the one hand, simping away all instances of <code>a ∈ b</code> seems weird to me, because why define that notation in the first place? On the other hand, <code>b = some a</code> is much more familiar/useful to me than <code>a ∈ b</code> so I'd rather keep <code>mem_def</code>.</p>



<a name="287348468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287348468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287348468">(Jun 24 2022 at 15:47)</a>:</h4>
<p>So I'm going to cast a weak vote for the <code>=</code> spelling.</p>



<a name="287348651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287348651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287348651">(Jun 24 2022 at 15:49)</a>:</h4>
<p>If we made <code>option.mem_def</code> not a simp lemma, we could replace it with <a href="https://leanprover-community.github.io/mathlib_docs/find/option.mem_some_iff">docs#option.mem_some_iff</a> being <code>simp</code></p>



<a name="287351646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287351646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287351646">(Jun 24 2022 at 16:12)</a>:</h4>
<p>I agree that the <code>has_mem</code> instance is a bit weird and I certainly haven't used it myself.</p>



<a name="287352028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287352028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287352028">(Jun 24 2022 at 16:16)</a>:</h4>
<p>It turns out that there's not quite as much fallout from this as I expected, so perhaps we don't need to decide before bumping to lean 3.44.0</p>



<a name="287352087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287352087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287352087">(Jun 24 2022 at 16:16)</a>:</h4>
<p>But I guess the <code>simp_nf</code> linter will be the real test</p>



<a name="287370546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287370546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287370546">(Jun 24 2022 at 18:55)</a>:</h4>
<p>The <code>has_mem</code> instance here is used a lot in <code>finset.max</code> and related, but in that case also I think it would be nicer to have the <code>= some</code> versoin</p>



<a name="287401146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287401146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287401146">(Jun 25 2022 at 00:46)</a>:</h4>
<p>Strong vote for the <code>=</code>, I find the <code>∈</code> notation to be very odd</p>



<a name="287401151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287401151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287401151">(Jun 25 2022 at 00:47)</a>:</h4>
<p>And we already have the <code>simp</code> lemma, so might as well use it</p>



<a name="287401394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287401394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287401394">(Jun 25 2022 at 00:51)</a>:</h4>
<p>I've used the <code>has_mem</code> notation for <code>option</code> a few times, and it can be convenient in meta code.</p>
<p>I think what you're supposed to do is imagine that <code>option</code> could have been defined as lists of length at most 1.</p>



<a name="287450200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287450200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287450200">(Jun 25 2022 at 19:04)</a>:</h4>
<p>That logic makes sense, but<br>
a) using set notation for things that aren't sets or very similar reeks of ZFC<br>
b) we don't employ this logic in other places where it would make sense, like for <code>α ⊕ β</code> or <code>Σ i, α i</code> (with the appropriate instances)</p>



<a name="287461154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287461154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287461154">(Jun 25 2022 at 23:43)</a>:</h4>
<p>Regarding (a), pretty much every mathlib data structure that contains elements in some sense has a <code>has_mem</code> instance. I mentioned <code>list</code> because it has the same computational properties (and there's a map of monads from <code>option</code> to <code>list</code>), but, except for issues of computational relevance, <code>option</code> could also have been defined as sets of cardinality at most 1. (Just for fun, <a href="https://github.com/leanprover-community/mathlib/commit/8f4327ae0c45ed36037beb1449f8285cae1ebe9c#diff-f4580f39da30fe1ff184287725115ef220e320b4281e7ccc8c4d62501b579766">the commit</a> where this <code>has_mem</code> instance was introduced, five years ago.)</p>
<p>Regarding (b), I'm not sure I'm following; could you write out those instances?</p>



<a name="287465768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simp-normal%20form%20for%20%60b%20%3D%20some%20a%60/near/287465768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simp-normal.20form.20for.20.60b.20.3D.20some.20a.60.html#287465768">(Jun 26 2022 at 01:44)</a>:</h4>
<p>An issue with the = based expressions is that = has two syntactically different yet propositionally equal forms, b = some a and some a = b. While the has_mem has only one</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>