---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html">extension to `lift` tactic</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="198575418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575418">(May 24 2020 at 09:40)</a>:</h4>
<p>I'd love to see extensions to the <code>lift</code> tactic (possibly under a separate name) that allow me to write:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">foo</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">lift</span> <span class="n">h</span> <span class="n">to</span> <span class="bp">ℤ</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">h</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>


<p>instead of having to know the name of the lemma:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">foo&#39;</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">&lt;</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">exact</span> <span class="n">int</span><span class="bp">.</span><span class="n">lt_to_nat</span><span class="bp">.</span><span class="n">mp</span> <span class="n">h</span><span class="o">,</span>
<span class="kn">end</span>
</code></pre></div>



<a name="198575435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575435">(May 24 2020 at 09:41)</a>:</h4>
<p>I'm guessing we don't have any automation that does this at the moment.</p>



<a name="198575455"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575455" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575455">(May 24 2020 at 09:42)</a>:</h4>
<p>I'm not really certain of the scope of this, but even something that moves inequalities from <code>nat</code> to <code>int</code> would be very useful.</p>



<a name="198575492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575492">(May 24 2020 at 09:42)</a>:</h4>
<p>In this specific case the norm_cast tactics do it right?</p>



<a name="198575497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575497">(May 24 2020 at 09:42)</a>:</h4>
<p>How do I do it with <code>norm_cast</code>?</p>



<a name="198575500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575500">(May 24 2020 at 09:42)</a>:</h4>
<p>oh...</p>



<a name="198575502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575502">(May 24 2020 at 09:42)</a>:</h4>
<p>you mean jsut write <code>norm_cast</code>?</p>



<a name="198575506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575506">(May 24 2020 at 09:42)</a>:</h4>
<p>does <code>exact_mod_cast h</code> work?</p>



<a name="198575515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575515" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575515">(May 24 2020 at 09:43)</a>:</h4>
<p>Awesome, I didn't realise how much work <code>*_cast</code> tactics could already do!</p>



<a name="198575516"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575516" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575516">(May 24 2020 at 09:43)</a>:</h4>
<p><code>assumption_mod_cast</code></p>



<a name="198575518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575518">(May 24 2020 at 09:43)</a>:</h4>
<p>You don't even need to know the names of your hypotheses (-;</p>



<a name="198575563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575563">(May 24 2020 at 09:44)</a>:</h4>
<p>but <code>norm_cast</code> changes the goal</p>



<a name="198575568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575568">(May 24 2020 at 09:44)</a>:</h4>
<p>I suppose Scott wants a tactic that changes <code>h</code></p>



<a name="198575571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575571">(May 24 2020 at 09:44)</a>:</h4>
<p>In my actual use case <code>exact_mod_cast</code> is perfect.</p>



<a name="198575574"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575574" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575574">(May 24 2020 at 09:44)</a>:</h4>
<p>oh great</p>



<a name="198575579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198575579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198575579">(May 24 2020 at 09:45)</a>:</h4>
<p>but nevertheless it would be beneficial to have a tactic that changes <code>h</code></p>



<a name="198576685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198576685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198576685">(May 24 2020 at 10:18)</a>:</h4>
<p>Can't you do <code>norm_cast at h</code>?</p>



<a name="198576877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/198576877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#198576877">(May 24 2020 at 10:24)</a>:</h4>
<p>That goes the wrong way. <code>h : a &lt; b</code>, doesn't have any coercions in it. The idea is to add the coercions to the hypothesis. (And of course everyone pointed out it was easier in this minimal example to remove the coercions from the goal.)</p>



<a name="199124846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199124846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199124846">(May 29 2020 at 08:08)</a>:</h4>
<p>How about this example:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">hk</span> <span class="o">:</span> <span class="err">↑</span><span class="n">k</span> <span class="bp">=</span> <span class="err">↑</span><span class="n">m</span> <span class="bp">/</span> <span class="err">↑</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">k</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">admit</span>
<span class="kn">end</span>
</code></pre></div>



<a name="199124856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199124856" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199124856">(May 29 2020 at 08:08)</a>:</h4>
<p>This came up in practice.</p>



<a name="199124880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199124880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199124880">(May 29 2020 at 08:08)</a>:</h4>
<p>I don't want to remember how the fact "coercion from <code>int</code> to <code>rat</code> is injective" is called.</p>



<a name="199124920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199124920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199124920">(May 29 2020 at 08:09)</a>:</h4>
<p>So I want to hit this with <code>move_goal_to rat</code>, which figures out what to do.</p>



<a name="199126851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199126851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199126851">(May 29 2020 at 08:31)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic/near/199124880">said</a>:</p>
<blockquote>
<p>I don't want to remember how the fact "coercion from <code>int</code> to <code>rat</code> is injective" is called.</p>
</blockquote>
<p><code>norm_cast</code> knows about this so you shouldn't have to mention it. Do you have <code>data.rat.cast</code> imported?</p>



<a name="199126890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199126890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199126890">(May 29 2020 at 08:31)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> <code>norm_cast</code> goes the wrong way, right?</p>



<a name="199127013"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127013" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127013">(May 29 2020 at 08:32)</a>:</h4>
<p>I can't <code>rw_mod_cast hk</code> and end up with a goal in the rationals.</p>



<a name="199127014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127014">(May 29 2020 at 08:32)</a>:</h4>
<p>I mean, I think you can rephrase the proof to use <code>norm_cast</code> without making it longer.</p>



<a name="199127034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127034">(May 29 2020 at 08:33)</a>:</h4>
<p>How?</p>



<a name="199127058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127058">(May 29 2020 at 08:33)</a>:</h4>
<p>You can rewrite hk to make it multiplicative and norm_cast it, right?</p>



<a name="199127069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127069">(May 29 2020 at 08:33)</a>:</h4>
<div class="codehilite"><pre><span></span><code>    <span class="n">apply</span> <span class="bp">@</span><span class="n">int</span><span class="bp">.</span><span class="n">cast_injective</span> <span class="n">ℚ</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="n">exact_mod_cast</span> <span class="n">hn</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">int</span><span class="bp">.</span><span class="n">cast_mul</span><span class="o">,</span> <span class="n">hk</span><span class="o">,</span> <span class="n">mul_div_assoc&#39;</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">,</span> <span class="n">mul_div_cancel</span> <span class="bp">_</span> <span class="n">this</span><span class="o">]</span>
</code></pre></div>


<p>is what I have now</p>



<a name="199127108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127108">(May 29 2020 at 08:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span> <a href="#narrow/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic/near/199127058">said</a>:</p>
<blockquote>
<p>You can rewrite hk to make it multiplicative and norm_cast it, right?</p>
</blockquote>
<p>Aha, but then I have to remember how to do that...</p>



<a name="199127174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127174">(May 29 2020 at 08:34)</a>:</h4>
<p>And those are still manipulations that don't come intuitively to me... they seem to work in the wrong direction, for me.</p>



<a name="199127202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127202">(May 29 2020 at 08:34)</a>:</h4>
<p>The proof I posted above seems to be the natural "flow" of the proof, for me.</p>



<a name="199127364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127364">(May 29 2020 at 08:36)</a>:</h4>
<div class="codehilite"><pre><span></span><code>    <span class="n">apply</span> <span class="bp">@</span><span class="n">int</span><span class="bp">.</span><span class="n">cast_injective</span> <span class="n">ℚ</span><span class="o">,</span>
    <span class="k">have</span> <span class="o">:</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="n">exact_mod_cast</span> <span class="n">hn</span><span class="o">,</span>
    <span class="n">field_simp</span> <span class="o">[</span><span class="n">hk</span><span class="o">,</span> <span class="n">hn</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">],</span>
</code></pre></div>



<a name="199127410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127410">(May 29 2020 at 08:36)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">rat</span><span class="bp">.</span><span class="n">cast</span>

<span class="kn">example</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="n">k</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">(</span><span class="n">hk</span> <span class="o">:</span> <span class="o">(</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">=</span> <span class="err">↑</span><span class="n">m</span> <span class="bp">/</span> <span class="err">↑</span><span class="n">n</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">*</span> <span class="n">k</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">rw</span> <span class="n">eq_div_iff_mul_eq</span> <span class="n">at</span> <span class="n">hk</span><span class="o">,</span> <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">hk</span><span class="o">,</span>
  <span class="n">cc</span><span class="o">,</span> <span class="n">assumption_mod_cast</span>
<span class="kn">end</span>
</code></pre></div>


<p>Not that I care how you do the arithmetic, but this seems the core of the proof. "change division to multiplication, do some cast and equality reasoning."</p>



<a name="199127482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127482">(May 29 2020 at 08:37)</a>:</h4>
<p>Thanks!</p>



<a name="199127755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/extension%20to%20%60lift%60%20tactic/near/199127755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/extension.20to.20.60lift.60.20tactic.html#199127755">(May 29 2020 at 08:40)</a>:</h4>
<p>Total proof:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">rat</span><span class="bp">.</span><span class="n">denom_div_cast_eq_one_iff</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">(</span><span class="n">hn</span> <span class="o">:</span> <span class="n">n</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">((</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">/</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">denom</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">↔</span> <span class="n">n</span> <span class="err">∣</span> <span class="n">m</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">lift</span> <span class="o">((</span><span class="n">m</span> <span class="o">:</span> <span class="n">ℚ</span><span class="o">)</span> <span class="bp">/</span> <span class="n">n</span><span class="o">)</span> <span class="n">to</span> <span class="bp">ℤ</span> <span class="kn">using</span> <span class="n">h</span> <span class="k">with</span> <span class="n">k</span> <span class="n">hk</span><span class="o">,</span>
    <span class="n">use</span> <span class="n">k</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">eq_div_iff_mul_eq</span> <span class="bp">_</span> <span class="bp">_</span> <span class="o">(</span><span class="k">show</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span><span class="n">ℚ</span><span class="o">)</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="k">by</span> <span class="n">exact_mod_cast</span> <span class="n">hn</span><span class="o">)</span> <span class="n">at</span> <span class="n">hk</span><span class="o">,</span>
    <span class="n">norm_cast</span> <span class="n">at</span> <span class="n">hk</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">hk</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">],</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">rintros</span> <span class="bp">⟨</span><span class="n">d</span><span class="o">,</span> <span class="n">rfl</span><span class="bp">⟩</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">int</span><span class="bp">.</span><span class="n">cast_mul</span><span class="o">,</span> <span class="n">mul_comm</span><span class="o">,</span> <span class="n">mul_div_cancel</span><span class="o">,</span> <span class="n">rat</span><span class="bp">.</span><span class="n">coe_int_denom</span><span class="o">],</span>
    <span class="n">exact_mod_cast</span> <span class="n">hn</span> <span class="o">}</span>
<span class="kn">end</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>