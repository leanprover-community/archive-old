---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/diamond.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html">diamond</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="229636319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229636319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229636319">(Mar 10 2021 at 10:47)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">add_comm_group.int_module.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">_</span> <span class="n">int.ring</span><span class="o">)</span> <span class="bp">=</span>
  <span class="bp">@</span><span class="n">semiring.to_semimodule.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">comm_semiring.to_semiring.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring.to_comm_semiring.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="n">int.comm_ring</span><span class="o">))</span> <span class="o">:=</span>
<span class="n">rfl</span> <span class="c1">-- fails</span>
</code></pre></div>
<p>This one might be well-known. I think <span class="user-mention" data-user-id="310045">@Eric Wieser</span> reported similar issues before.</p>



<a name="229636385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229636385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229636385">(Mar 10 2021 at 10:47)</a>:</h4>
<p>It is stopping some statement from typechecking in LTE. Is there a chance that we can fix this?</p>



<a name="229636879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229636879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229636879">(Mar 10 2021 at 10:52)</a>:</h4>
<p>Using<code>local attribute [-instance] add_comm_group.int_module</code> so it doesn't appear in the first place is one solution</p>



<a name="229636999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229636999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229636999">(Mar 10 2021 at 10:53)</a>:</h4>
<p>I think this is the diamond that <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span>'s approach of redefining int/nat multiply might fix, although I don't recall whether their proposal worked for <code>int</code> too, or just <code>nat</code>.</p>



<a name="229639000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229639000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229639000">(Mar 10 2021 at 11:11)</a>:</h4>
<p>The proposal is to redefine the definitions of both nat and int multiplication in core, to make sure that this precise diamond is defeq. I have never tried it because I don't know how to work on core.</p>



<a name="229686506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229686506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229686506">(Mar 10 2021 at 15:53)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean/issues/551">lean#551</a></p>



<a name="229687757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229687757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229687757">(Mar 10 2021 at 15:58)</a>:</h4>
<p>courage!</p>



<a name="229687804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229687804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229687804">(Mar 10 2021 at 15:58)</a>:</h4>
<p>I wonder how big of a refactor this will be for mathlib</p>



<a name="229688803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229688803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229688803">(Mar 10 2021 at 16:01)</a>:</h4>
<p>Depends on how often people (ab)use defeq of <code>m * 0 = 0</code> and the succ version.</p>



<a name="229689585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229689585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229689585">(Mar 10 2021 at 16:03)</a>:</h4>
<p>I suspect it's rather on the other end: people didn't abuse defeq of <code>0 * m = 0</code> because it wasn't true. The change would make it possible to abuse it, but we won't notice because we already have the non-abusing proofs.</p>



<a name="229690447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229690447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229690447">(Mar 10 2021 at 16:06)</a>:</h4>
<p>Case in point:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">@[simp, norm_cast]</span> <span class="kd">theorem</span> <span class="n">cast_mul</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">m</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">n</span><span class="o">,</span> <span class="o">((</span><span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span>
<span class="bp">|</span> <span class="mi">0</span>     <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">convert</span> <span class="o">(</span><span class="n">mul_zero</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">mul_zero</span><span class="o">],</span> <span class="n">refl</span> <span class="o">}</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">convert</span> <span class="o">(</span><span class="n">cast_add</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="o">(</span>
<span class="k">show</span> <span class="o">((</span><span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">+</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">*</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">),</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">cast_mul</span> <span class="n">n</span><span class="o">,</span> <span class="n">left_distrib</span><span class="o">,</span> <span class="n">mul_one</span><span class="o">]),</span>
  <span class="n">exact</span> <span class="n">mul_succ</span> <span class="n">_</span> <span class="n">_</span> <span class="o">}</span>
</code></pre></div>



<a name="229690578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229690578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229690578">(Mar 10 2021 at 16:07)</a>:</h4>
<p>I added the <code>convert</code>, because before, it would "just work"</p>



<a name="229693303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229693303" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229693303">(Mar 10 2021 at 16:17)</a>:</h4>
<p>The unfolded version of the new <code>nat.mul</code> / the current <a href="https://leanprover-community.github.io/mathlib_docs/find/monoid.pow/src">src#monoid.pow</a> is very ugly compared to the current <code>nat.mul</code>, most notably now involving <code>nat.brec</code>. Does this have bad consequences for speed of definitional reduction?</p>



<a name="229694094"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229694094" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229694094">(Mar 10 2021 at 16:21)</a>:</h4>
<p>Why can't the equation compiler reduce <code>monoid.pow</code> to <code>nat.rec_on n 1 (λ _, (*) a)</code>?</p>



<a name="229759479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229759479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229759479">(Mar 10 2021 at 22:33)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/tree/pechersky/mul-on-left">branch#pechersky/mul-on-left</a></p>



<a name="229759517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229759517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229759517">(Mar 10 2021 at 22:33)</a>:</h4>
<p>Seems like it build on my machine</p>



<a name="229759697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229759697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229759697">(Mar 10 2021 at 22:34)</a>:</h4>
<p>That is, using the modified lean core. It should still work on regular lean, I think, because the proofs have been changed just to avoid the defeq <code>x * 0 = 0</code> mostly.</p>



<a name="229792234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229792234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229792234">(Mar 11 2021 at 04:32)</a>:</h4>
<p>This mathlib branch now builds on both 3.27.0 and the dev-nat-mul-on-left without needing any changes to support either lean version. However, Johan's example is still not <code>rfl</code> in either version:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">add_comm_group.int_module.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">_</span> <span class="n">int.ring</span><span class="o">)</span> <span class="bp">=</span>
  <span class="bp">@</span><span class="n">semiring.to_semimodule.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">comm_semiring.to_semiring.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring.to_comm_semiring.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="n">int.comm_ring</span><span class="o">))</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">convert</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">apply_instance</span>
<span class="kd">end</span>
</code></pre></div>
<p>Do you foresee that some other change is needed to make it work? I didn't change the defn of int-multiplication.</p>



<a name="229792343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229792343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229792343">(Mar 11 2021 at 04:34)</a>:</h4>
<p>In fact, I'm not sure how core int mul would be changed. This is what I have on the <a href="https://github.com/leanprover-community/lean/issues/511">lean#511</a> branch right now. To me, that just seems like a case-bash against the two constructors.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">protected</span> <span class="kd">def</span> <span class="n">mul</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℤ</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">of_nat</span> <span class="n">m</span><span class="o">)</span> <span class="o">(</span><span class="n">of_nat</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="n">of_nat</span> <span class="o">(</span><span class="n">m</span> <span class="bp">*</span> <span class="n">n</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">of_nat</span> <span class="n">m</span><span class="o">)</span> <span class="bp">-</span><span class="o">[</span><span class="mi">1</span><span class="bp">+</span> <span class="n">n</span><span class="o">]</span>    <span class="o">:=</span> <span class="n">neg_of_nat</span> <span class="o">(</span><span class="n">m</span> <span class="bp">*</span> <span class="n">succ</span> <span class="n">n</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">-</span><span class="o">[</span><span class="mi">1</span><span class="bp">+</span> <span class="n">m</span><span class="o">]</span>    <span class="o">(</span><span class="n">of_nat</span> <span class="n">n</span><span class="o">)</span> <span class="o">:=</span> <span class="n">neg_of_nat</span> <span class="o">(</span><span class="n">succ</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span><span class="o">)</span>
<span class="bp">|</span> <span class="bp">-</span><span class="o">[</span><span class="mi">1</span><span class="bp">+</span> <span class="n">m</span><span class="o">]</span>    <span class="bp">-</span><span class="o">[</span><span class="mi">1</span><span class="bp">+</span> <span class="n">n</span><span class="o">]</span>    <span class="o">:=</span> <span class="n">of_nat</span> <span class="o">(</span><span class="n">succ</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">succ</span> <span class="n">n</span><span class="o">)</span>
</code></pre></div>



<a name="229808165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229808165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229808165">(Mar 11 2021 at 07:52)</a>:</h4>
<p>Yes, you would also need to change int multiplication. What matters is that it is defeq to <a href="https://leanprover-community.github.io/mathlib_docs/find/gsmul">docs#gsmul</a> (in the sense that you can modify the definition of <a href="https://leanprover-community.github.io/mathlib_docs/find/gsmul">docs#gsmul</a> if you like, to have two matching definitions). In particular, I don't think the int multiplication should case on the second variable: first, one should have the nat action on int, as on any semigroup, and then construct int multiplication from this.</p>



<a name="229808400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229808400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229808400">(Mar 11 2021 at 07:55)</a>:</h4>
<p>You need a monoid for a nat action. Semigroups just have a pnat action, as observed by Damiano Testa recently.</p>



<a name="229808473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229808473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229808473">(Mar 11 2021 at 07:56)</a>:</h4>
<p>I think nat should be renamed pnat_with_zero</p>



<a name="229808491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229808491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229808491">(Mar 11 2021 at 07:56)</a>:</h4>
<p>You're right. I am using semigroup and monoid interchangeably in my head!</p>



<a name="229808507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229808507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229808507">(Mar 11 2021 at 07:57)</a>:</h4>
<p>(I was saying "you're right" to your first line, not to the second one :-)</p>



<a name="229811839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229811839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229811839">(Mar 11 2021 at 08:27)</a>:</h4>
<p>The fundamental object is pnat, proved by Euclid to be a free monoid on an infinite generating set. Then you make nat by adding a zero and defining a pathological <code>+</code> operation</p>



<a name="229811952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229811952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229811952">(Mar 11 2021 at 08:28)</a>:</h4>
<p>You can tell it's pathological because Goldbach and twin primes are still open</p>



<a name="229811993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229811993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229811993">(Mar 11 2021 at 08:28)</a>:</h4>
<p>Then shouldn't \N be notation for pnat? <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="229812023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229812023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229812023">(Mar 11 2021 at 08:29)</a>:</h4>
<p>Sure! That's how I used the notation for 30 years</p>



<a name="229819812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229819812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229819812">(Mar 11 2021 at 09:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/diamond/near/229811952">said</a>:</p>
<blockquote>
<p>You can tell it's pathological because Goldbach and twin primes are still open</p>
</blockquote>
<p>I can't resist: <a href="https://themoreyouknow.github.io/div/">https://themoreyouknow.github.io/div/</a></p>



<a name="229858106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229858106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229858106">(Mar 11 2021 at 14:37)</a>:</h4>
<p>Here's one of the problems (thanks Eric for explaining). Why doesn't <code>rfl</code> work here?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>

<span class="c1">-- dev branch</span>
<span class="k">#reduce</span> <span class="bp">λ</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">nat.mul</span> <span class="mi">5</span> <span class="n">k</span> <span class="c1">-- λ (k : ℕ), ((((0.add k).add k).add k).add k).add k</span>

<span class="kn">protected</span> <span class="kd">def</span> <span class="n">nat.mul'</span> <span class="o">:</span> <span class="n">nat</span> <span class="bp">→</span> <span class="n">nat</span> <span class="bp">→</span> <span class="n">nat</span>
<span class="bp">|</span> <span class="mi">0</span>     <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">a</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">nat.mul'</span> <span class="n">a</span> <span class="n">b</span>

<span class="k">#reduce</span> <span class="bp">λ</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">nsmul</span> <span class="mi">5</span> <span class="n">k</span>    <span class="c1">-- λ (k : ℕ), k.add (k.add (k.add (k.add k)))</span>
<span class="k">#reduce</span> <span class="bp">λ</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">nat.mul'</span> <span class="mi">5</span> <span class="n">k</span> <span class="c1">-- λ (k : ℕ), k.add (k.add (k.add (k.add k)))</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">nsmul</span> <span class="n">n</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">n.mul'</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">rfl</span> <span class="c1">-- does not work??</span>
</code></pre></div>



<a name="229860934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229860934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229860934">(Mar 11 2021 at 14:52)</a>:</h4>
<p>Is that on master or on your branch?</p>



<a name="229861038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229861038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229861038">(Mar 11 2021 at 14:53)</a>:</h4>
<p>(or is that irrelevant)?</p>



<a name="229861519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229861519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229861519">(Mar 11 2021 at 14:56)</a>:</h4>
<p>For the <code>mul'</code> and <code>nsmul</code>, it is irrelevant. Here is that regular old <code>nat.mul</code> does on 3.27:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- 3.27 branch</span>
<span class="k">#reduce</span> <span class="bp">λ</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">nat.mul</span> <span class="mi">5</span> <span class="n">k</span> <span class="c1">-- λ (k : ℕ), 5.mul k</span>
</code></pre></div>



<a name="229861602"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229861602" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229861602">(Mar 11 2021 at 14:56)</a>:</h4>
<p>It's not relevant for <code>mul'</code> and <code>nsmul</code> because both are defined via addition on the left</p>



<a name="229861826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229861826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229861826">(Mar 11 2021 at 14:58)</a>:</h4>
<p>Even better (or worse?):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">protected</span> <span class="kd">def</span> <span class="n">nat.mul'</span> <span class="o">:</span> <span class="n">nat</span> <span class="bp">→</span> <span class="n">nat</span> <span class="bp">→</span> <span class="n">nat</span>
<span class="bp">|</span> <span class="mi">0</span>     <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">a</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">nat.mul'</span> <span class="n">a</span> <span class="n">b</span>

<span class="kd">def</span> <span class="n">nsmul'</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">A</span> <span class="bp">→</span> <span class="n">A</span>
<span class="bp">|</span> <span class="mi">0</span>     <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">a</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">nsmul'</span> <span class="n">a</span> <span class="n">b</span>

<span class="k">#reduce</span> <span class="bp">λ</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">nsmul</span> <span class="mi">5</span> <span class="n">k</span>    <span class="c1">-- λ (k : ℕ), k.add (k.add (k.add (k.add k)))</span>
<span class="k">#reduce</span> <span class="bp">λ</span> <span class="n">k</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="n">nat.mul'</span> <span class="mi">5</span> <span class="n">k</span> <span class="c1">-- λ (k : ℕ), k.add (k.add (k.add (k.add k)))</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">nsmul'</span> <span class="n">n</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">nat.mul'</span> <span class="n">n</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">rfl</span> <span class="c1">-- does not work??</span>
</code></pre></div>



<a name="229863411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229863411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229863411">(Mar 11 2021 at 15:06)</a>:</h4>
<p>A way out is to avoid the equation compiler, which is just not good here, and use instead</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">protected</span> <span class="kd">def</span> <span class="n">nat.mul'</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="o">:=</span>
<span class="n">nat.rec_on</span> <span class="n">n</span> <span class="mi">0</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b</span> <span class="n">rec</span><span class="o">,</span> <span class="n">rec</span> <span class="bp">+</span> <span class="n">a</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">nsmul'</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">A</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">A</span><span class="o">)</span> <span class="o">:</span> <span class="n">A</span> <span class="o">:=</span>
<span class="n">nat.rec_on</span> <span class="n">n</span> <span class="mi">0</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b</span> <span class="n">rec</span><span class="o">,</span> <span class="n">rec</span> <span class="bp">+</span> <span class="n">a</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">nsmul'</span> <span class="n">n</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">nat.mul'</span> <span class="n">n</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">rfl</span> <span class="c1">-- works</span>
<span class="kd">example</span> <span class="o">(</span><span class="n">n</span> <span class="n">m</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">nsmul'</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">2</span><span class="o">)</span> <span class="n">m</span> <span class="bp">=</span> <span class="n">nat.mul'</span> <span class="n">n</span> <span class="n">m</span> <span class="bp">+</span> <span class="n">m</span> <span class="bp">+</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">rfl</span> <span class="c1">-- works</span>
</code></pre></div>



<a name="229984363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/229984363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#229984363">(Mar 12 2021 at 06:43)</a>:</h4>
<p>I would have thought that the way to define (a+1)b was ab+b rather than b+ab?</p>



<a name="230085188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230085188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230085188">(Mar 12 2021 at 19:34)</a>:</h4>
<p>Okay, wow, I have the following working on dev lean:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">add_comm_group.int_module.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">_</span> <span class="n">int.ring</span><span class="o">)</span> <span class="bp">=</span>
  <span class="bp">@</span><span class="n">semiring.to_semimodule.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">comm_semiring.to_semiring.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring.to_comm_semiring.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="n">int.comm_ring</span><span class="o">))</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="230085224"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230085224" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230085224">(Mar 12 2021 at 19:35)</a>:</h4>
<p>But -- is it worth it? Check out the <a href="https://github.com/leanprover-community/mathlib/tree/pechersky/mul-on-left">branch#pechersky/mul-on-left</a></p>



<a name="230085506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230085506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230085506">(Mar 12 2021 at 19:37)</a>:</h4>
<p>I removed many <code>multiplicative</code> proofs that (ab)used(?) defeq(?) I got lazy at the end and fell back to <code>convert multiplicative; try { ... }</code>.</p>



<a name="230085734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230085734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230085734">(Mar 12 2021 at 19:38)</a>:</h4>
<p>What branch of lean are you working from?</p>



<a name="230085781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230085781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230085781">(Mar 12 2021 at 19:39)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean/issues/551">lean#551</a> sorry, typo</p>



<a name="230086239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086239">(Mar 12 2021 at 19:42)</a>:</h4>
<p>My confusion is the same as CI's: <a href="https://github.com/leanprover-community/mathlib/compare/pechersky/mul-on-left#diff-037522102a2edcd0b33801a2dc6dc56ea0eacefd5bd58c17402eec520dff4fffR52">https://github.com/leanprover-community/mathlib/compare/pechersky/mul-on-left#diff-037522102a2edcd0b33801a2dc6dc56ea0eacefd5bd58c17402eec520dff4fffR52</a>. Where is <code>nat.smul</code> defined?</p>



<a name="230086280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086280">(Mar 12 2021 at 19:43)</a>:</h4>
<p>(I think you can edit the <code>leanproject.yml</code> to point at your branch somehow, also)</p>



<a name="230086328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086328">(Mar 12 2021 at 19:43)</a>:</h4>
<p>Nice! Finally, you didn't need to change int multiplication?</p>



<a name="230086508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086508">(Mar 12 2021 at 19:45)</a>:</h4>
<p>No, I did:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">protected</span> <span class="kd">def</span> <span class="n">smul</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span>
<span class="bp">|</span> <span class="mi">0</span>       <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="mi">0</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">b</span><span class="o">,</span> <span class="n">b</span> <span class="bp">+</span> <span class="n">smul</span> <span class="n">n</span> <span class="n">b</span>

<span class="kn">protected</span> <span class="kd">def</span> <span class="n">mul</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">ℕ</span> <span class="o">:=</span>
<span class="n">nat.smul</span>

<span class="kn">protected</span> <span class="kd">def</span> <span class="n">smul</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_add</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_neg</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">of_nat</span> <span class="n">m</span><span class="o">)</span> <span class="o">:=</span> <span class="n">m.smul</span>
<span class="bp">|</span> <span class="bp">-</span><span class="o">[</span><span class="mi">1</span><span class="bp">+</span> <span class="n">m</span><span class="o">]</span>    <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="bp">-</span> <span class="o">(</span><span class="n">m.succ.smul</span> <span class="n">x</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">has_neg</span> <span class="n">ℤ</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">int.neg</span><span class="o">⟩</span>
<span class="kd">instance</span> <span class="o">:</span> <span class="n">has_add</span> <span class="n">ℤ</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">int.add</span><span class="o">⟩</span>

<span class="kn">protected</span> <span class="kd">def</span> <span class="n">mul</span> <span class="o">:</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℤ</span> <span class="bp">→</span> <span class="n">ℤ</span> <span class="o">:=</span>
<span class="n">int.smul</span>
</code></pre></div>



<a name="230086681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086681">(Mar 12 2021 at 19:46)</a>:</h4>
<p>Testing now with your <code>nat.rec</code> style instead of eq compiler style.</p>



<a name="230086744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086744">(Mar 12 2021 at 19:46)</a>:</h4>
<p>So that I can have a branch of mathlib that compiles in both dev and 3.27 contexts.</p>



<a name="230086773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086773">(Mar 12 2021 at 19:47)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span>  what's the syntax to change the toml to a lean branch?</p>



<a name="230086792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086792">(Mar 12 2021 at 19:47)</a>:</h4>
<p>Wouldn't <code>smul n b + b</code> be closed to the current definition? I think swapping the order of that plus is making things hard for you.</p>



<a name="230086824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086824">(Mar 12 2021 at 19:47)</a>:</h4>
<p>I think you have to push a tag to your fork</p>



<a name="230086843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086843">(Mar 12 2021 at 19:47)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> would know more</p>



<a name="230086926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230086926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230086926">(Mar 12 2021 at 19:48)</a>:</h4>
<p>I did addition on left to style after the <code>pow</code> preference.</p>



<a name="230087099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230087099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230087099">(Mar 12 2021 at 19:49)</a>:</h4>
<p>Perhaps pow should be defined as <code>nat.smul n (opposite.op (additive.of_mul x))</code></p>



<a name="230087143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230087143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230087143">(Mar 12 2021 at 19:50)</a>:</h4>
<p>And then nsmul / pow can have different conventions</p>



<a name="230087252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230087252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230087252">(Mar 12 2021 at 19:50)</a>:</h4>
<p>I guess my argument is more that you're changing two things at once, and it makes it hard to tell how much fallout each change is responsible for</p>



<a name="230088625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230088625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230088625">(Mar 12 2021 at 20:00)</a>:</h4>
<p>I can't see the new definition of <code>int.mul</code> on the branch of <a href="https://github.com/leanprover-community/lean/issues/551">lean#551</a>. I am probably not looking at the right branch.</p>



<a name="230088843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230088843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230088843">(Mar 12 2021 at 20:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/diamond/near/230086824">said</a>:</p>
<blockquote>
<p>I think you have to push a tag to your fork</p>
</blockquote>
<p>Exactly. Once you've pushed a tag, github actions will automatically build and upload a release.  You can then refer to this release in the leanpkg.toml:</p>
<div class="codehilite" data-code-language="TOML"><pre><span></span><code><span class="n">lean_version</span> <span class="o">=</span> <span class="s">"pechersky/lean:mytagname"</span>
</code></pre></div>



<a name="230089157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230089157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230089157">(Mar 12 2021 at 20:04)</a>:</h4>
<p>Ah apologies. OK I've pushed to the lean branch.</p>



<a name="230093240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230093240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230093240">(Mar 12 2021 at 20:32)</a>:</h4>
<p>Thanks for pushing.</p>
<p>I agree that <code>(n + 1) * a = n * a + a</code> is more natural that <code>(n + 1) * a = a + n * a</code>.</p>



<a name="230093531"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230093531" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230093531">(Mar 12 2021 at 20:34)</a>:</h4>
<p>OK I'll test that instead. I realized recently that I had been checking for the module typeclass <code>rfl</code> proof via</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">convert</span> <span class="n">rfl</span>
</code></pre></div>
<p>and that can fail even when <code>:= rfl</code> works. So perhaps not as many changes needed to happen as I made. But still, more proofs avoid defeq now so they'll work in either case. I'll see how brittle it is to switching the mul direction.</p>



<a name="230093703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230093703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230093703">(Mar 12 2021 at 20:35)</a>:</h4>
<p><code>convert rfl</code> is extremely close to <code>congr'</code> which is better because it takes an optional numeral argument.</p>



<a name="230093814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230093814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230093814">(Mar 12 2021 at 20:36)</a>:</h4>
<p>But why would <code>convert rfl</code> leave with me with a <code>module Z Z</code> goal when <code> := rfl</code> just works?</p>



<a name="230095600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230095600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230095600">(Mar 12 2021 at 20:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110050">Sebastien Gouezel</span> <a href="#narrow/stream/113488-general/topic/diamond/near/230093240">said</a>:</p>
<blockquote>
<p>I agree that <code>(n + 1) * a = n * a + a</code> is more natural that <code>(n + 1) * a = a + n * a</code>.</p>
</blockquote>
<p>But that means that <code>1 * a</code> is not defeq to <code>a</code></p>



<a name="230095863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230095863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230095863">(Mar 12 2021 at 20:54)</a>:</h4>
<p>and, as more detail, with that definition, neither is <code>a * 1</code> defeq to <code>a</code></p>



<a name="230097092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230097092" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230097092">(Mar 12 2021 at 21:02)</a>:</h4>
<p>but we already have that neither a * 1 nor 1 * a are equal to a.</p>



<a name="230097111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230097111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230097111">(Mar 12 2021 at 21:02)</a>:</h4>
<p><code>a * 1 = 0 + a</code> IIRC</p>



<a name="230097146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230097146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230097146">(Mar 12 2021 at 21:02)</a>:</h4>
<p>That's a very good point. Then I agree that <code>(n + 1) * a = a + n * a</code> is better!</p>



<a name="230097233"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230097233" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230097233">(Mar 12 2021 at 21:03)</a>:</h4>
<p>who says <code>succ n</code> isn't <code>1 + n</code> anyway? :-)</p>



<a name="230097323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230097323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230097323">(Mar 12 2021 at 21:04)</a>:</h4>
<p>I have a dev lean build with the mul-on-right working, where I've fixed defeq proofs to be robust to both versions. Now I'm polishing away mathlib proofs that use that defeq. That will allow us to test one vs the other more easily.</p>



<a name="230097822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230097822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230097822">(Mar 12 2021 at 21:08)</a>:</h4>
<p>It's true that currently neither of <code>1 * a</code> and <code>a * 1</code> are defeq to <code>a</code>. Having <code>1 * a = a</code> by defeq (and even <code>1 • a = a</code> in a monoid) looks like it couldn't hurt!</p>



<a name="230119019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/230119019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#230119019">(Mar 13 2021 at 00:10)</a>:</h4>
<p>It might lead some computer scientists astray, they might abuse definitional equality</p>



<a name="236170586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236170586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236170586">(Apr 26 2021 at 13:12)</a>:</h4>
<p>What is the situation here? </p>
<p>After Sebastien's heroic efforts we now have a new definition of <code>group</code> and <code>monoid</code>. Is there now still an argument for changing the definition of <code>int.mul</code>?</p>



<a name="236179416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236179416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236179416">(Apr 26 2021 at 14:05)</a>:</h4>
<p>I think the argument was to make <a href="https://leanprover-community.github.io/mathlib_docs/find/smul_eq_mul">docs#smul_eq_mul</a> true by <code>rfl</code> for <code>nat</code> and <code>int</code></p>



<a name="236179460"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236179460" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236179460">(Apr 26 2021 at 14:05)</a>:</h4>
<p><del>But I don't think there is a diamond any more to motivate this</del>. Edit: Hmm, that's already true by rfl, so I must be missing something.</p>



<a name="236179703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236179703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236179703">(Apr 26 2021 at 14:07)</a>:</h4>
<p>My understanding is that my dev rebuilds and mathlib refactors were coming from the point of view of "we can't change nsmul or gsmul, so let's change nat mul and int mul instead". While Sebastien then said "hey, why the restricted assumption that we can't change how we work with nsmul and gsmul"?</p>



<a name="236182871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236182871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236182871">(Apr 26 2021 at 14:26)</a>:</h4>
<p>Is the diamond behind <code>semiring.to_semimodule</code> and <code>add_comm_monoid.nat_semimodule</code> now defeq?</p>



<a name="236183452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236183452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236183452">(Apr 26 2021 at 14:30)</a>:</h4>
<p>No, this is not <code>rfl</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>

<span class="kd">example</span> <span class="o">:</span> <span class="bp">@</span><span class="n">add_comm_group.int_module.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_add_comm_group</span> <span class="n">_</span> <span class="n">int.ring</span><span class="o">)</span> <span class="bp">=</span>
  <span class="bp">@</span><span class="n">semiring.to_module.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">comm_semiring.to_semiring.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring.to_comm_semiring.</span><span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="n">int</span> <span class="n">int.comm_ring</span><span class="o">))</span> <span class="o">:=</span> <span class="n">rfl</span> <span class="c1">-- nope</span>
</code></pre></div>



<a name="236184753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236184753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236184753">(Apr 26 2021 at 14:37)</a>:</h4>
<p>Then the problem is still there. The diamond problem that Sebastien solved was one that came up with composite types like <code>prod</code> and <code>tensor_product</code> where <code>add_comm_monoid.nat_semimodule</code> would form a diamond with itself, rather than a niche one that only really comes up when working heavily with nat.</p>



<a name="236185085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236185085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236185085">(Apr 26 2021 at 14:39)</a>:</h4>
<p>(or int)</p>



<a name="236185331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236185331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236185331">(Apr 26 2021 at 14:41)</a>:</h4>
<p>Perhaps though this raises that the <code>subsingleton (module nat N)</code> instance needs to come back (it's now a <code>lemma</code>), since the problem isn't fully gone yet</p>



<a name="236196420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236196420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236196420">(Apr 26 2021 at 15:35)</a>:</h4>
<p>This works for me (on master). Are you up to date?</p>



<a name="236196586"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236196586" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236196586">(Apr 26 2021 at 15:36)</a>:</h4>
<p>Maybe I was using an outdated master</p>



<a name="236197154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236197154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236197154">(Apr 26 2021 at 15:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/diamond/near/236170586">said</a>:</p>
<blockquote>
<p>What is the situation here? </p>
<p>After Sebastien's heroic efforts we now have a new definition of <code>group</code> and <code>monoid</code>. Is there now still an argument for changing the definition of <code>int.mul</code>?</p>
</blockquote>
<p>There could still be an argument, if we wanted to refactor <code>nat.cast</code> and <code>int.cast</code>, replacing them with <code>n • 1</code> to get nice definitional behavior on most types. With this definition, if you want the cast from nat to itself to be equal to the identity definitionally, you would need to have <code>n * 1 = n</code>, which requires swapping multiplication. But this is way less important than before, since we got rid of all of our diamonds and this thing I mentioned would just require one additional rewrite in a few places.</p>



<a name="236199824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236199824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236199824">(Apr 26 2021 at 15:58)</a>:</h4>
<p><a href="https://olive-caribou-rfe62wpk.ws-us03.gitpod.io/#/workspace/mathlib">https://olive-caribou-rfe62wpk.ws-us03.gitpod.io/#/workspace/mathlib</a> indicates that yes, it is <code>rfl</code></p>



<a name="236201773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236201773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236201773">(Apr 26 2021 at 16:11)</a>:</h4>
<p>I think you have to share a gitpod workspace by doing "Gitpod: share workspace snapshot" in the control+shift+p menu for us to see what you see, that link is private</p>



<a name="236206598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236206598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236206598">(Apr 26 2021 at 16:47)</a>:</h4>
<p>I see. In any case, it's just the example from above copied, and no errors.</p>



<a name="236223437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/diamond/near/236223437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/diamond.html#236223437">(Apr 26 2021 at 18:41)</a>:</h4>
<p><a href="https://leanprover-community.github.io/lean-web-editor/#code=import%20algebra.module.basic%0A%0Aexample%20%3A%20%40add_comm_group.int_module.%7B0%7D%20int%20(%40ring.to_add_comm_group%20_%20int.ring)%20%3D%0A%20%20%40semiring.to_module.%7B0%7D%20int%0A%20%20%20%20(%40comm_semiring.to_semiring.%7B0%7D%20int%20(%40comm_ring.to_comm_semiring.%7B0%7D%20int%20int.comm_ring))%20%3A%3D%20rfl%20--%20yep%0A">who needs gitpod</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>