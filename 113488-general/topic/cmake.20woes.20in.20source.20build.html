---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/cmake.20woes.20in.20source.20build.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html">cmake woes in source build</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="199223547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199223547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199223547">(May 29 2020 at 23:19)</a>:</h4>
<p>Hello!<br>
I am trying to build a binary distribution of lean from source so that I can call Lean from the Julia programming language.<br>
I am just trying to set this up inside a sandbox linux environment which has GMP 5 and GCC 5, but I keep getting this error:</p>
<div class="codehilite"><pre><span></span><code><span class="o">[</span> <span class="mi">98</span><span class="err">%</span><span class="o">]</span> <span class="n">Linking</span> <span class="n">C</span> <span class="n">executable</span> <span class="n">c_name_test</span>
<span class="n">cd</span> <span class="bp">/</span><span class="n">workspace</span><span class="bp">/</span><span class="n">srcdir</span><span class="bp">/</span><span class="n">lean</span><span class="bp">/</span><span class="n">build</span><span class="bp">/</span><span class="n">release</span><span class="bp">/</span><span class="n">tests</span><span class="bp">/</span><span class="n">shared</span> <span class="bp">&amp;&amp;</span> <span class="bp">/</span><span class="n">usr</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">cmake</span> <span class="bp">-</span><span class="n">E</span> <span class="n">cmake_link_script</span> <span class="n">CMakeFiles</span><span class="bp">/</span><span class="n">c_name_test</span><span class="bp">.</span><span class="n">dir</span><span class="bp">/</span><span class="n">link</span><span class="bp">.</span><span class="n">txt</span> <span class="c1">--verbose=false</span>
<span class="bp">/</span><span class="n">opt</span><span class="bp">/</span><span class="n">x86_64</span><span class="bp">-</span><span class="n">linux</span><span class="bp">-</span><span class="n">gnu</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/../</span><span class="n">lib</span><span class="bp">/</span><span class="n">gcc</span><span class="bp">/</span><span class="n">x86_64</span><span class="bp">-</span><span class="n">linux</span><span class="bp">-</span><span class="n">gnu</span><span class="bp">/</span><span class="mi">5</span><span class="bp">.</span><span class="mi">2</span><span class="bp">.</span><span class="mi">0</span><span class="bp">/../../../../</span><span class="n">x86_64</span><span class="bp">-</span><span class="n">linux</span><span class="bp">-</span><span class="n">gnu</span><span class="bp">/</span><span class="n">bin</span><span class="bp">/</span><span class="n">ld</span><span class="o">:</span> <span class="n">warning</span><span class="o">:</span> <span class="n">libstdc</span><span class="bp">++.</span><span class="n">so</span><span class="bp">.</span><span class="mi">6</span><span class="o">,</span> <span class="n">needed</span> <span class="k">by</span> <span class="bp">../../</span><span class="n">libleanshared</span><span class="bp">.</span><span class="n">so</span><span class="o">,</span> <span class="n">not</span> <span class="n">found</span> <span class="o">(</span><span class="n">try</span> <span class="kn">using</span> <span class="bp">-</span><span class="n">rpath</span> <span class="n">or</span> <span class="bp">-</span><span class="n">rpath</span><span class="bp">-</span><span class="n">link</span><span class="o">)</span>
<span class="bp">../../</span><span class="n">libleanshared</span><span class="bp">.</span><span class="n">so</span><span class="o">:</span> <span class="n">undefined</span> <span class="n">reference</span> <span class="n">to</span> <span class="bp">`</span><span class="n">typeinfo</span> <span class="n">for</span> <span class="n">std</span><span class="bp">::</span><span class="n">invalid_argument</span><span class="bp">@</span><span class="n">GLIBCXX_3</span><span class="bp">.</span><span class="mi">4</span><span class="err">&#39;</span>
<span class="bp">../../</span><span class="n">libleanshared</span><span class="bp">.</span><span class="n">so</span><span class="o">:</span> <span class="n">undefined</span> <span class="n">reference</span> <span class="n">to</span> <span class="bp">`</span><span class="n">VTT</span> <span class="n">for</span> <span class="n">std</span><span class="bp">::__</span><span class="n">cxx11</span><span class="bp">::</span><span class="n">basic_stringstream</span><span class="bp">&lt;</span><span class="n">char</span><span class="o">,</span> <span class="n">std</span><span class="bp">::</span><span class="n">char_traits</span><span class="bp">&lt;</span><span class="n">char</span><span class="bp">&gt;</span><span class="o">,</span> <span class="n">std</span><span class="bp">::</span><span class="n">allocator</span><span class="bp">&lt;</span><span class="n">char</span><span class="bp">&gt;</span> <span class="bp">&gt;@</span><span class="n">GLIBCXX_3</span><span class="bp">.</span><span class="mi">4</span><span class="bp">.</span><span class="mi">21</span><span class="err">&#39;</span>
</code></pre></div>


<p>Any ideas how I can solve this?</p>



<a name="199223708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199223708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199223708">(May 29 2020 at 23:21)</a>:</h4>
<p>TLDR: <code>libstdc++.so.6 not found</code>, at 98% of the compilation :(((</p>



<a name="199224004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199224004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199224004">(May 29 2020 at 23:26)</a>:</h4>
<p>Which version of lean are you trying to make?</p>



<a name="199225149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199225149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199225149">(May 29 2020 at 23:42)</a>:</h4>
<p>version 3.15.0 of the leanprover-community</p>



<a name="199225338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199225338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199225338">(May 29 2020 at 23:44)</a>:</h4>
<p>From the pathnames it looks like you have some kind of custom setup that we won't guess.</p>



<a name="199225369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199225369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199225369">(May 29 2020 at 23:45)</a>:</h4>
<p>I mean most Linux users probably have <code>g++</code> installed at <code>/usr/bin/g++</code> and not under <code>/opt</code>.</p>



<a name="199225501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199225501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199225501">(May 29 2020 at 23:47)</a>:</h4>
<p>I guess maybe that's what "sandbox" means.</p>



<a name="199225504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199225504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199225504">(May 29 2020 at 23:47)</a>:</h4>
<p>Anyways, I think your g++ installation is just broken.</p>



<a name="199226177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226177">(May 29 2020 at 23:56)</a>:</h4>
<p>Don't know what you mean by broken, but myself and others have used this succesfully to build many projects.</p>



<a name="199226193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226193">(May 29 2020 at 23:56)</a>:</h4>
<p>Could be it's not linked to properly, sure.</p>



<a name="199226244"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226244" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226244">(May 29 2020 at 23:57)</a>:</h4>
<p>In any case, it doesn't look like a Lean-related error</p>



<a name="199226347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226347">(May 29 2020 at 23:59)</a>:</h4>
<p><span class="user-mention" data-user-id="243947">@Miguel Raz Guzmán Macedo</span> can you try <code>ldd ../../libleanshared.so</code> ?</p>



<a name="199226356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226356">(May 29 2020 at 23:59)</a>:</h4>
<p>or wherever is the libleanshared</p>



<a name="199226359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226359">(May 29 2020 at 23:59)</a>:</h4>
<p>and post the output</p>



<a name="199226379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226379">(May 29 2020 at 23:59)</a>:</h4>
<p>ah, at linktime, I guess it's not working</p>



<a name="199226427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226427">(May 30 2020 at 00:00)</a>:</h4>
<p>are you even sure you have libstdc++6 ?</p>



<a name="199226457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226457">(May 30 2020 at 00:00)</a>:</h4>
<p>yup, lemme try. the <code>libleanshared.so</code> is produces after a <code>make</code>,  and even a <code>make bin_lean</code>, but lemme see.</p>



<a name="199226498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226498">(May 30 2020 at 00:00)</a>:</h4>
<p>like if you do <code>ldd</code> on some C++-linked executable, can you see it being linked to libstdc++ ?</p>



<a name="199226578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226578">(May 30 2020 at 00:01)</a>:</h4>
<p>honestly, though, if I were you and wanted to build a very specific version of Lean in a sandbox</p>



<a name="199226588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226588">(May 30 2020 at 00:01)</a>:</h4>
<p>I'd just use Nix or Guile for this usecase</p>



<a name="199226594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226594">(May 30 2020 at 00:01)</a>:</h4>
<p>and reuse Nix's derivations for example</p>



<a name="199226677"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226677" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226677">(May 30 2020 at 00:02)</a>:</h4>
<p><a href="https://github.com/NixOS/nixpkgs/blob/master/pkgs/applications/science/logic/lean/default.nix">https://github.com/NixOS/nixpkgs/blob/master/pkgs/applications/science/logic/lean/default.nix</a></p>



<a name="199226684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226684">(May 30 2020 at 00:02)</a>:</h4>
<p>It's a specific sandbox that users can then build on Windows/Mac/Linux within Julia.</p>



<a name="199226724"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226724" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226724">(May 30 2020 at 00:03)</a>:</h4>
<p>I don't understand, do you do cross compilation to arbitrary arch/ABI targets?</p>



<a name="199226778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226778">(May 30 2020 at 00:04)</a>:</h4>
<p>I guess what you're doing is creating a xxx.jl to wrap Lean's shared lib in Julia, right?</p>



<a name="199226787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226787">(May 30 2020 at 00:04)</a>:</h4>
<p>So you just want some derivation which spits jl + so, Nix/Guile seems to be perfect for this use-case</p>



<a name="199226828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226828">(May 30 2020 at 00:05)</a>:</h4>
<p>It's also a build sandbox, using cgroups &amp; stuff</p>



<a name="199226868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226868">(May 30 2020 at 00:05)</a>:</h4>
<p>Anyway, we can try to debug your issue, but in the end, like <span class="user-mention" data-user-id="110032">@Reid Barton</span> want to say more or less, it's infinitely easier to reuse "known working environments"</p>



<a name="199226922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226922">(May 30 2020 at 00:06)</a>:</h4>
<p>Yes, the idea is to do cross compilation to arbitrary targets.<br>
Yes, I want to later build a Lean.jl to wrap Leans shared lib in Julia.<br>
I want to use this particular workflow (BinaryBuilder.jl) because if users do <code>using Lean</code> within a Julia script it auto downloads and build Lean and puts everyting into the appropriate place.<br>
And this only needs to be done once for the entire Julia ecosystem.</p>



<a name="199226927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226927">(May 30 2020 at 00:06)</a>:</h4>
<p>it needs to be done each time you want to change the Lean version AFAIK</p>



<a name="199226936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226936">(May 30 2020 at 00:07)</a>:</h4>
<p>That's fine - other tarballs can be fixed up for subsequent versions.</p>



<a name="199226937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226937">(May 30 2020 at 00:07)</a>:</h4>
<p>except if you automated some script, then makes sense</p>



<a name="199226944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199226944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199226944">(May 30 2020 at 00:07)</a>:</h4>
<p>Yes, an automated script gets produced from this too which can later get tweaked.</p>



<a name="199227033"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199227033" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199227033">(May 30 2020 at 00:09)</a>:</h4>
<p>I will try to just build the <code>bin_lean</code> and see what goes from there.</p>



<a name="199227042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199227042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199227042">(May 30 2020 at 00:09)</a>:</h4>
<p>Anyway, we need information on the set of libstdc++ libs you have currently, their path and more logs</p>



<a name="199227053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199227053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199227053">(May 30 2020 at 00:09)</a>:</h4>
<p><code>ldd</code> can give you most of this stuff, then we can try to see why CMake/GCC don't find what you want</p>



<a name="199227160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199227160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199227160">(May 30 2020 at 00:11)</a>:</h4>
<p>The culprit might be also that you don't have this lib at all</p>



<a name="199227162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199227162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199227162">(May 30 2020 at 00:11)</a>:</h4>
<p>So you need to look for it</p>



<a name="199231454"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199231454" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199231454">(May 30 2020 at 01:42)</a>:</h4>
<p><span class="user-mention" data-user-id="262143">@Ryan Lahfa</span> managed a workaround - you can enjoy it being built for like 12 archs here <a href="https://dev.azure.com/JuliaPackaging/Yggdrasil/_build/results?buildId=3914&amp;view=results">https://dev.azure.com/JuliaPackaging/Yggdrasil/_build/results?buildId=3914&amp;view=results</a></p>



<a name="199232494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199232494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199232494">(May 30 2020 at 02:06)</a>:</h4>
<p>What was the workaround?</p>



<a name="199232968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199232968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199232968">(May 30 2020 at 02:17)</a>:</h4>
<p>copying the <code>make bin_lean</code> executable into a proper directory.</p>



<a name="199232973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199232973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199232973">(May 30 2020 at 02:17)</a>:</h4>
<p>and then it worked. <span aria-label="shrug" class="emoji emoji-1f937" role="img" title="shrug">:shrug:</span></p>



<a name="199288072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288072">(May 31 2020 at 03:31)</a>:</h4>
<p>OK, I have my executable made.<br>
If I have a file that has a simple Lean example, how can I run that from the comandline?<br>
ie, I have </p>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">ℕ</span><span class="o">)</span> <span class="o">:</span> <span class="n">m</span> <span class="bp">+</span> <span class="n">n</span> <span class="bp">=</span> <span class="n">n</span> <span class="bp">+</span> <span class="n">m</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp</span>
</code></pre></div>


<p>In a <code>hello_world.txt</code><br>
And I want to run <br>
<code>lean hello_world.txt</code> but it currently says</p>
<p><code>/home/mrg/lean.txt:2:3: error: simplify tactic failed to simplify</code><br>
(I ripped the example of the web live demo, so I might be missing some imports)</p>



<a name="199288112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288112">(May 31 2020 at 03:32)</a>:</h4>
<p><span class="user-mention" data-user-id="262143">@Ryan Lahfa</span> we are this <em>so</em> close to having Julia -&gt; Lean interop</p>



<a name="199288120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288120">(May 31 2020 at 03:33)</a>:</h4>
<p>The old web demo uses an older version of Lean where <code>nat.add_comm</code> is a simp-lemma.</p>
<p>So simply change <code>by simp</code> to <code>by simp [nat.add_comm]</code>.</p>



<a name="199288123"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288123" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288123">(May 31 2020 at 03:33)</a>:</h4>
<p>See <a href="https://leanprover-community.github.io/lean-web-editor">#webeditor</a> for the more up-to-date community web editor.</p>



<a name="199288190"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288190" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288190">(May 31 2020 at 03:35)</a>:</h4>
<p>Note that if <code>lean hello_world.txt</code> succeeds, Lean won't return any output.</p>



<a name="199288237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288237">(May 31 2020 at 03:37)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="123965">@Bryan Gin-ge Chen</span> ! It works! Muahahaha!</p>



<a name="199288346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288346">(May 31 2020 at 03:41)</a>:</h4>
<p>Ok wait - is there way to not feed a file to <code>lean foo.txt</code>, but rather a string ?</p>



<a name="199288435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288435">(May 31 2020 at 03:44)</a>:</h4>
<p>There's the server mode, which <span class="user-mention" data-user-id="115715">@Jason Rute</span> explained <a href="#narrow/stream/113488-general/topic/Examples.20of.20communicating.20with.20Lean/near/199253728">here</a>.</p>



<a name="199288568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288568">(May 31 2020 at 03:49)</a>:</h4>
<p>Awesome!<br>
And what is <code>leanchecker</code> for?</p>



<a name="199288616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288616">(May 31 2020 at 03:51)</a>:</h4>
<p>I think it is an "external" typechecker that reuses the lean kernel</p>



<a name="199288796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199288796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199288796">(May 31 2020 at 03:57)</a>:</h4>
<p>See <a href="https://github.com/leanprover-community/lean/blob/master/doc/export_format.md">https://github.com/leanprover-community/lean/blob/master/doc/export_format.md</a></p>



<a name="199290226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/cmake%20woes%20in%20source%20build/near/199290226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Miguel Raz Guzmán Macedo <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/cmake.20woes.20in.20source.20build.html#199290226">(May 31 2020 at 04:42)</a>:</h4>
<p>Oh, wow, I missed that because I don't know how to Zulip. Thanks a lot <span class="user-mention" data-user-id="269735">@Brian Jiang</span> !</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>