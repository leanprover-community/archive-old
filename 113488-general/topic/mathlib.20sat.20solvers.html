---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/mathlib.20sat.20solvers.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html">mathlib sat solvers</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="264750384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264750384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264750384">(Dec 13 2021 at 18:32)</a>:</h4>
<p>With <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> 's <a href="https://github.com/leanprover-community/mathlib/pull/10744">#10744</a> there are at least 3 SAT+ tactics in mathlib.</p>
<ul>
<li><code>itauto</code> is intuitionistic; <code>itauto!</code> is complete for classical prop logic</li>
<li><code>tauto</code> and <code>tauto!</code> both exist. I think it's been claimed that <code>tauto!</code> is complete for classical prop logic. <code>tauto</code> is not intuitionistic but is weaker than <code>tauto!</code>. It seems to have some support for equality, and perhaps some basic first order reasoning/heuristic instantiation? There's no module doc and the tactic doc doesn't seem complete.</li>
<li><code>finish</code> and friends are classical. <del>I think (but am not sure) that <code>finish</code> is complete.</del> <code>finish</code> is not complete. At a high level they claim to do the same as what <code>tauto</code> does, but explicitly say that they use the SMT state for e-matching and congruence closure.</li>
</ul>



<a name="264750392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264750392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264750392">(Dec 13 2021 at 18:32)</a>:</h4>
<p>I think this is a confusing zoo of options. One move that I think is a strict improvement: kill <code>tauto</code> and rename <code>tauto!</code> to <code>tauto</code>.</p>



<a name="264750497"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264750497" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264750497">(Dec 13 2021 at 18:33)</a>:</h4>
<p><code>itauto!</code> is a doubly confusing name, since it's neither <code>i</code> nor <code>tauto</code> (if we keep <code>tauto(!)</code> around).</p>



<a name="264750779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264750779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264750779">(Dec 13 2021 at 18:35)</a>:</h4>
<p>Depending on what <code>tauto</code> actually does beyond prop logic, we could delete it and rename <code>itauto!</code> to <code>tauto</code>. (We should check performance of course.) But I suspect it does enough extra, whether intentionally or as a side effect, that this isn't an easy drop-in replacement.</p>



<a name="264750983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264750983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264750983">(Dec 13 2021 at 18:37)</a>:</h4>
<p><code>itauto</code> looks like the cleanest implementation and should be the easiest to port to Lean 4.</p>



<a name="264751899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264751899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264751899">(Dec 13 2021 at 18:44)</a>:</h4>
<p>Correction, <code>finish</code> is not complete:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic.finish</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">q</span> <span class="bp">∧</span> <span class="n">r</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">p</span> <span class="bp">∨</span> <span class="n">q</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">p</span> <span class="bp">∨</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">finish</span>
</code></pre></div>



<a name="264752254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264752254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264752254">(Dec 13 2021 at 18:48)</a>:</h4>
<p><code>finish</code> has better first-order support than <code>tauto</code>, although both do some:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">p</span> <span class="n">x</span> <span class="bp">→</span> <span class="n">q</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span><span class="o">,</span> <span class="n">p</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span> <span class="n">q</span> <span class="n">a</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">tauto</span><span class="bp">!</span> <span class="c1">-- both work</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">h₁</span> <span class="o">:</span> <span class="n">p</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="n">h₂</span> <span class="o">:</span> <span class="n">p</span> <span class="n">b</span><span class="o">)</span> <span class="o">(</span><span class="n">h₃</span> <span class="o">:</span> <span class="n">q</span> <span class="n">b</span><span class="o">)</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="n">p</span> <span class="n">x</span> <span class="bp">∧</span> <span class="n">q</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="n">tauto</span><span class="bp">!</span> <span class="c1">-- only finish works</span>
</code></pre></div>



<a name="264752347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264752347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264752347">(Dec 13 2021 at 18:48)</a>:</h4>
<p>In my experience <code>tauto</code> is a <em>lot</em> faster than <code>finish</code>.</p>



<a name="264760077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264760077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264760077">(Dec 13 2021 at 19:49)</a>:</h4>
<p><code>finish</code> should be complete for classical propositional logic, but for equality and quantifier instantiation, it is only heuristic.</p>



<a name="264761004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264761004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264761004">(Dec 13 2021 at 19:56)</a>:</h4>
<p>Oops, I take it back. I think the issue is with the <code>iff</code>: by default, it is not expanded. I think adding <code>iff_def</code> should work. Hold on, I'll check.</p>



<a name="264761374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264761374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264761374">(Dec 13 2021 at 19:58)</a>:</h4>
<p>This works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic.finish</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">∨</span> <span class="o">(</span><span class="n">q</span> <span class="bp">∧</span> <span class="n">r</span><span class="o">)</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">p</span> <span class="bp">∨</span> <span class="n">q</span><span class="o">)</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">p</span> <span class="bp">∨</span> <span class="n">r</span><span class="o">)</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">finish</span> <span class="o">[</span><span class="n">iff_def</span><span class="o">]</span>
</code></pre></div>
<p>My vague memory is that <code>finish</code> doesn't expand <code>iff</code> because that could blow up goals painfully, but if you do expand them, it should be complete for propositional formulas that use it.</p>



<a name="264766162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264766162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264766162">(Dec 13 2021 at 20:33)</a>:</h4>
<p>Indeed, <code>finish</code> with <code>[iff_def]</code> added when needed solves every goal in the <code>tauto</code> test suite except <code>example (p q r : Prop) (h : ¬ p = q) (h' : r = q) : p ↔ ¬ r</code>, where there seems to be a <code>simp</code> loop but <code>simp [iff_def]; finish</code> works.</p>



<a name="264766581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264766581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264766581">(Dec 13 2021 at 20:37)</a>:</h4>
<p>I suspect that most of the slowdown from <code>finish</code> is in ematching. In the <code>tauto</code> test suite, setting <code>max_ematch_rounds = 0</code>, <code>finish</code> still solves everything except one, which it solves with <code>max_ematch_rounds = 1</code>.</p>



<a name="264766817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264766817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264766817">(Dec 13 2021 at 20:39)</a>:</h4>
<p>In fact, on the <code>tauto</code> tests, <code>finish</code> is faster even without changing <code>max_ematch_rounds</code>.</p>



<a name="264767352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264767352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264767352">(Dec 13 2021 at 20:44)</a>:</h4>
<p>I'm harping on this for a few reasons. One, it's confusing right now which tactics do what with what performance profile. Two, some of this will need to get ported, and we should avoid duplicated effort.</p>



<a name="264767462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264767462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264767462">(Dec 13 2021 at 20:45)</a>:</h4>
<p>I think that if you're porting you get to choose your favorite tactic.</p>



<a name="264767606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264767606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264767606">(Dec 13 2021 at 20:46)</a>:</h4>
<p>Is there real hope for porting <code>finish</code>? If it's sat + cc/e-matching, it can't be ported until (unless) cc/e-matching is. And then it might be better re-implemented on top of <code>itauto!</code> instead of its own sat solver</p>



<a name="264767749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264767749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264767749">(Dec 13 2021 at 20:47)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/264767462">said</a>:</p>
<blockquote>
<p>I think that if you're porting you get to choose your favorite tactic.</p>
</blockquote>
<p>But if all are used on mathlib now, it would be nice to have drop in Lean 4 replacements. Alternatively (what I'm getting at) we should eliminate usages of some variants in mathlib.</p>



<a name="264768159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264768159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264768159">(Dec 13 2021 at 20:50)</a>:</h4>
<p>I'm pretty sure we could remove uses of <code>finish</code> rather easily</p>



<a name="264771074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264771074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264771074">(Dec 13 2021 at 21:16)</a>:</h4>
<p>At a very rough count I see ~100 uses of <code>finish</code> in mathlib and spot-checking them, <code>tauto!</code> isn't a drop-in replacement. My two reasons for harping on this conflict here. It would be easier to eliminate <code>tauto</code> with <code>itauto!</code> and <code>finish</code> than it would be to eliminate <code>finish</code>. But <code>finish</code> is the hardest one to port.</p>



<a name="264773126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264773126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264773126">(Dec 13 2021 at 21:34)</a>:</h4>
<p>Personally, I'd rather not port finish if we can avoid it.  Certainly not as a propositional prover (where you don't want to do anything beyond propositional logic so that you get good error messages).  Jannis' aesop prover (<a href="https://github.com/JLimperg/aesop">https://github.com/JLimperg/aesop</a>) aims to do what auto does in Isabelle, which is much more useful for general automation in my eyes.</p>



<a name="264773294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264773294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264773294">(Dec 13 2021 at 21:36)</a>:</h4>
<p>I'm sure we can run a "finish <code>finish</code> challenge" and remove <code>finish</code> from mathlib in a couple of days at most. And I don't think Jeremy will complains at all, <code>finish</code> was explicitly an experiment.</p>



<a name="264773366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264773366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264773366">(Dec 13 2021 at 21:37)</a>:</h4>
<p>I hadn't seen Jannis' repo yet! That's great</p>



<a name="264773457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264773457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264773457">(Dec 13 2021 at 21:38)</a>:</h4>
<p>I suspect that would be close to a drop-in replacement for both <code>finish</code> and <code>tauto</code> in Lean 4.</p>



<a name="264773966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264773966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264773966">(Dec 13 2021 at 21:42)</a>:</h4>
<p>I also just poked around some of the mathlib <code>tauto</code> uses, and while <code>finish {use_simp := ff, max_ematch_rounds := 0}</code> is a drop-in replacement, it's still much slower -- the bottleneck seems to be creating the SMT state in the first place.</p>



<a name="264774697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264774697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264774697">(Dec 13 2021 at 21:49)</a>:</h4>
<p>Which makes my proposal the following:</p>
<ul>
<li>merge <a href="https://github.com/leanprover-community/mathlib/pull/10744">#10744</a></li>
<li>replace all non-first-order uses of old <code>tauto(!)</code> with <code>itauto(!)</code>, pending a comparison of the performance</li>
<li>replace all non-first-order uses of <code>finish</code> with <code>itauto!</code></li>
<li>replace all remaining uses of <code>finish</code> however possible</li>
<li>delete <code>tauto</code>; rename <code>tauto!</code> to something else that makes the first-orderness explicit</li>
<li>rename <code>itauto!</code> to <code>tauto</code></li>
</ul>



<a name="264774997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264774997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264774997">(Dec 13 2021 at 21:51)</a>:</h4>
<p>Porting <code>itauto</code> should be easy. We can figure out what to do with the remaining <code>tauto-fo</code> calls later, depending on how Jannis' work progresses</p>



<a name="264775050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264775050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264775050">(Dec 13 2021 at 21:51)</a>:</h4>
<p>What does that mean for <a href="https://github.com/leanprover-community/mathlib/pull/1083">#1083</a>?</p>



<a name="264775271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264775271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264775271">(Dec 13 2021 at 21:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/264775050">said</a>:</p>
<blockquote>
<p>What does that mean for <a href="https://github.com/leanprover-community/mathlib/pull/1083">#1083</a>?</p>
</blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/pull/1083">#1083</a> is long dead. Anyone is welcome to revive this kind of work in Lean 4, but given the dependence on external tools, I don't think it's relevant here.</p>



<a name="264776892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264776892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264776892">(Dec 13 2021 at 22:04)</a>:</h4>
<p><code>itauto</code> is epsilon slower than <code>tauto</code> on the <code>tauto</code> tests solved by both, and significantly faster on the <code>itauto</code> tests solved by both.</p>



<a name="264776932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264776932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264776932">(Dec 13 2021 at 22:04)</a>:</h4>
<p>But the <code>tauto</code> test suite isn't large.</p>



<a name="264776936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264776936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264776936">(Dec 13 2021 at 22:04)</a>:</h4>
<p>for the last few lines of the proposal, I guess you mean we now want <code>itauto!</code> = <code>tauto</code>, and <code>itauto</code> stays the same, instead of keeping <code>tauto!</code> too?</p>



<a name="264777004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264777004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264777004">(Dec 13 2021 at 22:05)</a>:</h4>
<p>otherwise I totally agree in general. <code>finish</code> also always had the disadvantage of being a black box, so if it needed speeding up it couldn't be aided like <code>tidy</code> did</p>



<a name="264777254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264777254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264777254">(Dec 13 2021 at 22:07)</a>:</h4>
<p>I want:<br>
<code>tauto</code> -&gt; nothing<br>
<code>tauto!</code> -&gt; <code>first_order_something</code><br>
<code>itauto</code> -&gt; <code>itauto</code><br>
<code>itauto!</code> -&gt; <code>tauto</code></p>



<a name="264777290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264777290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264777290">(Dec 13 2021 at 22:07)</a>:</h4>
<p>Current <code>tauto!</code> is stronger than <code>itauto!</code>, so I don't want to remove it.</p>



<a name="264777527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264777527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264777527">(Dec 13 2021 at 22:09)</a>:</h4>
<p>I also don't want to delete the <code>finish</code> tactic, just remove/ban its use in mathlib</p>



<a name="264777703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264777703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264777703">(Dec 13 2021 at 22:10)</a>:</h4>
<p>Where as <code>tauto</code> (non-<code>!</code>) can be deleted. It's neither intuitionistic nor complete, I think it has no advantage over <code>tauto!</code></p>



<a name="264778245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264778245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264778245">(Dec 13 2021 at 22:14)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/264775271">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/264775050">said</a>:</p>
<blockquote>
<p>What does that mean for <a href="https://github.com/leanprover-community/mathlib/pull/1083">#1083</a>?</p>
</blockquote>
<p><a href="https://github.com/leanprover-community/mathlib/pull/1083">#1083</a> is long dead. Anyone is welcome to revive this kind of work in Lean 4, but given the dependence on external tools, I don't think it's relevant here.</p>
</blockquote>
<p>Wow, I think that an interface with Vampire would make for a cool Lean 4 package, at the very least</p>



<a name="264779025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264779025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264779025">(Dec 13 2021 at 22:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110865">@Jeremy Avigad</span> and <span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> (and others?) have done the hookup in one direction, although I don't think they reconstruct Vampire proofs in Lean? <a href="https://arxiv.org/abs/2112.02142">https://arxiv.org/abs/2112.02142</a></p>



<a name="264779234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264779234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264779234">(Dec 13 2021 at 22:20)</a>:</h4>
<p>(To be fair, most of the work in <a href="https://github.com/leanprover-community/mathlib/pull/1083">#1083</a> was in the reconstruction)</p>



<a name="264779347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264779347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264779347">(Dec 13 2021 at 22:21)</a>:</h4>
<p>We have a simple language of propositional formulas which can be sent to Vampire, but yes, unfortunately reconstructing proofs is the hard part which we do not do. We also don't have a connection to <code>Expr</code>.</p>



<a name="264780449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264780449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264780449">(Dec 13 2021 at 22:31)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/1083">#1083</a> has ~5k lines added (idk how many of them were automatically generated). But it would be a bit sad to lose so much work</p>



<a name="264781696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264781696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264781696">(Dec 13 2021 at 22:44)</a>:</h4>
<p>It's entirely undocumented. I have no objection to merging it once it's mathlib-ready. But it doesn't sound like Seul is interested in returning to it.</p>



<a name="264781793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264781793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264781793">(Dec 13 2021 at 22:45)</a>:</h4>
<p>I had a tiny bit of <code>finish</code>-removal in an old branch, so I pushed it to <a href="https://github.com/leanprover-community/mathlib/compare/finish-finish">https://github.com/leanprover-community/mathlib/compare/finish-finish</a> in case it ends up being useful</p>



<a name="264836481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264836481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Siddhartha Gadgil <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264836481">(Dec 14 2021 at 10:24)</a>:</h4>
<p>This may have been discussed before - are there attempts to interface (in Lean 4) with the TPTP language for FOL and SMT-lib for SMT problems to then call external solvers (such an interface avoids committing to a specific solver)?</p>
<p>Thanks</p>



<a name="264836809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264836809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264836809">(Dec 14 2021 at 10:27)</a>:</h4>
<p>I was working on something like that for Lean 3: <a href="https://gebner.org/pdfs/2020-01-08_fomm20_leanhammer.pdf">https://gebner.org/pdfs/2020-01-08_fomm20_leanhammer.pdf</a>  I hope I'll get back to it at some point.</p>



<a name="264941421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264941421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264941421">(Dec 14 2021 at 23:11)</a>:</h4>
<p>Sorry to be slow to respond. I just got back from a few days visiting my mother in NY. <code>finish</code> was an attempt to do something like Isabelle's <code>auto</code>, and most of the uses in mathlib date back to the very early days, when I was testing it out to see how far it would get. I gave up on it when I decided that it was too limited and there wasn't a way to do what I wanted without having write a lot of code in C++. I am pleased that people have found it useful over the years, but I won't be sorry to see it go. I am counting on Jannis to do it right in Lean 4!</p>



<a name="264942220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264942220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264942220">(Dec 14 2021 at 23:15)</a>:</h4>
<p>The Vampire connection is fun to play with, but it's not used to construct Lean theorems. I also very much hope that Gabriel will work on this at some point. It will be great to have Isabelle-like automation in Lean.</p>



<a name="264998118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/264998118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jannis Limperg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#264998118">(Dec 15 2021 at 11:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/264773457">said</a>:</p>
<blockquote>
<p>I suspect [Aesop] would be close to a drop-in replacement for both <code>finish</code> and <code>tauto</code> in Lean 4.</p>
</blockquote>
<p>Parity with <code>tauto</code> should be no big problem. In fact, Aesop already does most of the things that <code>tauto</code> does (judging by the doc string and modulo Aesop bugs). For parity with <code>finish</code>, I still need to decide what to do with equations that aren't naturally handled by <code>simp</code>. But that's definitely happening at some point.</p>



<a name="265017407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265017407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265017407">(Dec 15 2021 at 14:28)</a>:</h4>
<p>I've made a start on finishing <code>finish</code> by finding and replacing it in <code>computability/regular_expressions</code> <a href="https://github.com/leanprover-community/mathlib/pull/10811">#10811</a></p>



<a name="265020081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265020081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Filippo A. E. Nuccio <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265020081">(Dec 15 2021 at 14:48)</a>:</h4>
<p>+1 for the "start on finishing" <span aria-label="big smile" class="emoji emoji-1f604" role="img" title="big smile">:big_smile:</span></p>



<a name="265029044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265029044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265029044">(Dec 15 2021 at 15:48)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/264774697">said</a>:</p>
<blockquote>
<p>Which makes my proposal the following:</p>
<ul>
<li>merge <a href="https://github.com/leanprover-community/mathlib/pull/10744">#10744</a></li>
<li>replace all non-first-order uses of old <code>tauto(!)</code> with <code>itauto(!)</code>, pending a comparison of the performance</li>
<li>replace all non-first-order uses of <code>finish</code> with <code>itauto!</code></li>
<li>replace all remaining uses of <code>finish</code> however possible</li>
<li>delete <code>tauto</code>; rename <code>tauto!</code> to something else that makes the first-orderness explicit</li>
<li>rename <code>itauto!</code> to <code>tauto</code></li>
</ul>
</blockquote>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> and any others who might have opinions here: do you agree with this plan?</p>



<a name="265029078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265029078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265029078">(Dec 15 2021 at 15:48)</a>:</h4>
<p>And what should we rename <code>tauto!</code> to?</p>



<a name="265029879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265029879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265029879">(Dec 15 2021 at 15:53)</a>:</h4>
<p>(deleted)</p>



<a name="265030017"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030017" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030017">(Dec 15 2021 at 15:54)</a>:</h4>
<p><code>itauto!</code> has more in common with <code>itauto</code> than <code>tauto</code> though</p>



<a name="265030255"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030255" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030255">(Dec 15 2021 at 15:55)</a>:</h4>
<p>But <code>itauto!</code> is a classical solver, so the <code>i</code> is misleading</p>



<a name="265030431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030431">(Dec 15 2021 at 15:56)</a>:</h4>
<p>I'm aware of that, but I'd rather rename <code>itauto</code> in both forms for that</p>



<a name="265030505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030505">(Dec 15 2021 at 15:56)</a>:</h4>
<p>It is still basically an intuitionistic prover, it's not a classical sat solver even with the <code>!</code></p>



<a name="265030571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030571">(Dec 15 2021 at 15:57)</a>:</h4>
<p>But it proves all classical tautologies, right?  So <code>tauto</code> is a good name.</p>



<a name="265030706"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030706" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030706">(Dec 15 2021 at 15:58)</a>:</h4>
<p>Suppose we added a more standard sat solver that also proves all classical tautologies. What would you call it?</p>



<a name="265030775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030775">(Dec 15 2021 at 15:58)</a>:</h4>
<p>Probably <code>cdcl</code>.</p>



<a name="265030808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030808">(Dec 15 2021 at 15:58)</a>:</h4>
<p>then maybe we should call this one <code>ljt</code></p>



<a name="265030816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030816">(Dec 15 2021 at 15:58)</a>:</h4>
<p>Or <code>sat</code>.</p>



<a name="265030902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265030902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265030902">(Dec 15 2021 at 15:59)</a>:</h4>
<p>I'm not against <code>ljt</code>, but we should mention "tautology" in the docstring.</p>



<a name="265031084"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265031084" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265031084">(Dec 15 2021 at 16:00)</a>:</h4>
<blockquote>
<p>And what should we rename <code>tauto!</code> to?</p>
</blockquote>
<p>Do you know what <code>tauto!</code> does exactly (in addition to classical tautologies)?</p>



<a name="265031540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265031540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265031540">(Dec 15 2021 at 16:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/265031084">said</a>:</p>
<blockquote>
<blockquote>
<p>And what should we rename <code>tauto!</code> to?</p>
</blockquote>
<p>Do you know what <code>tauto!</code> does exactly (in addition to classical tautologies)?</p>
</blockquote>
<p>Nope. The <code>tauto</code> docs aren't very detailed and it definitely does things that aren't described.</p>



<a name="265031550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265031550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265031550">(Dec 15 2021 at 16:03)</a>:</h4>
<p>I just noticed that <code>itauto</code> lacks a key feature of <code>tauto</code>: countermodels.  So that's a significant regression if we replace <code>tauto</code> by <code>itauto</code>.  When <code>itauto</code> fails, it gives you zero information on why.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic.tauto</span> <span class="n">tactic.itauto</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">∧</span> <span class="n">b</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">tauto</span> <span class="c1">-- tells you that h : a ⊢ b is not provable</span>
<span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">→</span> <span class="n">a</span> <span class="bp">∧</span> <span class="n">b</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">itauto</span>
</code></pre></div>



<a name="265031733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265031733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265031733">(Dec 15 2021 at 16:04)</a>:</h4>
<p>not least because intuitionistic countermodels are hard</p>



<a name="265031845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265031845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265031845">(Dec 15 2021 at 16:04)</a>:</h4>
<p>but if you think it will be useful, I can make the failure case more informative</p>



<a name="265031856"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265031856" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265031856">(Dec 15 2021 at 16:05)</a>:</h4>
<p>In intuitionistic logic, you can still return an unprovable sequent.</p>



<a name="265031934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265031934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265031934">(Dec 15 2021 at 16:05)</a>:</h4>
<p>in general there are a bunch of failed searches that contribute to the failure, the easy thing will only report the last failure</p>



<a name="265031962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265031962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265031962">(Dec 15 2021 at 16:05)</a>:</h4>
<p>And I think <code>tauto</code>'s countermodels are only vaguely present. Like, you could interpret this as a countermodel but it's really not clear.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">a</span> <span class="n">b</span> <span class="o">:</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∧</span> <span class="bp">¬</span> <span class="n">a</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">tauto</span>
</code></pre></div>



<a name="265032153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265032153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265032153">(Dec 15 2021 at 16:07)</a>:</h4>
<p>It tells you that it can't prove <code>⊢ a</code>, so <code>{a ↦ false}</code> is a countermodel.</p>



<a name="265032407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265032407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265032407">(Dec 15 2021 at 16:08)</a>:</h4>
<blockquote>
<p>Mario Carneiro: in general there are a bunch of failed searches that contribute to the failure, the easy thing will only report the last failure</p>
</blockquote>
<p>What I meant is that you can return the last sequent after applying the invertible rules.  This sequent won't contain any top-level connectives except implication/not on the left, if that makes it clearer.</p>



<a name="265032787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265032787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265032787">(Dec 15 2021 at 16:11)</a>:</h4>
<p><code>cdcl</code> and <code>ljt</code> are mysterioglyphs to me. I would much prefer <code>tauto</code>.</p>



<a name="265033058"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265033058" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265033058">(Dec 15 2021 at 16:13)</a>:</h4>
<p>Would it be better to have <code>itauto {classical := tt}</code>?</p>



<a name="265033232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265033232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265033232">(Dec 15 2021 at 16:14)</a>:</h4>
<p>I strongly prefer <code>tauto</code> over that.</p>



<a name="265033280"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265033280" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265033280">(Dec 15 2021 at 16:14)</a>:</h4>
<p>Either name it by the calculus, or by the class of goals it solves.</p>



<a name="265033288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265033288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265033288">(Dec 15 2021 at 16:14)</a>:</h4>
<p>The fact that <code>ljt</code> doesn't "mean anything" isn't necessarily an issue; tactics are really just "names" that you have to learn</p>



<a name="265033715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265033715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265033715">(Dec 15 2021 at 16:16)</a>:</h4>
<p>like, you would be just as hard pressed to guess what <code>lia</code> or <code>micromega</code> do</p>



<a name="265034054"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265034054" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265034054">(Dec 15 2021 at 16:18)</a>:</h4>
<p>on second thought, I think that <code>classical; itauto</code> ends up doing essentially the same thing as <code>itauto!</code>, so maybe it's not needed</p>



<a name="265034160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265034160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265034160">(Dec 15 2021 at 16:19)</a>:</h4>
<p>Even if it does the same, we should have a <code>tauto</code> alias for it.</p>



<a name="265034366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265034366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265034366">(Dec 15 2021 at 16:20)</a>:</h4>
<p>assuming that we can find the existing name-squatter a better home</p>



<a name="265034452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265034452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265034452">(Dec 15 2021 at 16:21)</a>:</h4>
<p>My general understanding of <code>tauto</code> is that it does <code>solve_by_elim</code> and <code>casesm [/\, \/]</code></p>



<a name="265035545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265035545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265035545">(Dec 15 2021 at 16:28)</a>:</h4>
<p>From my cursory reading of the <code>tauto</code> source code it does tautology + exists.intro + exists.cases_on + @[symm].</p>



<a name="265035585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265035585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265035585">(Dec 15 2021 at 16:28)</a>:</h4>
<p>With some kind of handling of equality too</p>



<a name="265036002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265036002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265036002">(Dec 15 2021 at 16:31)</a>:</h4>
<p>Mmmh, apparently it also applies @[symm] lemmas in some way that I don't understand.</p>



<a name="265041292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041292">(Dec 15 2021 at 17:06)</a>:</h4>
<p>What about <code>tauto!</code> -&gt; <code>auto</code>? Isabelle's <code>auto</code> is much different, but the general idea (logic + heuristics) is similar, and it's only a one character change</p>



<a name="265041412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041412">(Dec 15 2021 at 17:07)</a>:</h4>
<p>It's hard to name it by the calculus or class of goals it solves if neither is specified</p>



<a name="265041430"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041430" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041430">(Dec 15 2021 at 17:07)</a>:</h4>
<p>No no no.</p>



<a name="265041475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041475">(Dec 15 2021 at 17:07)</a>:</h4>
<p>Isabelle's auto is something completely different.</p>



<a name="265041627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041627">(Dec 15 2021 at 17:08)</a>:</h4>
<p>How about <code>tauto+</code> or <code>tauto_plus</code>?</p>



<a name="265041783"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041783" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041783">(Dec 15 2021 at 17:09)</a>:</h4>
<p>I don't like the idea of <code>tauto</code> and <code>tauto+</code> having completely different implementations</p>



<a name="265041802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041802">(Dec 15 2021 at 17:09)</a>:</h4>
<p><code>tauto_plus</code> feels slightly better</p>



<a name="265041812"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041812" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041812">(Dec 15 2021 at 17:09)</a>:</h4>
<p>I prefer <code>tauto_plus</code>; I would reserve character sigils for option changes rather than implementation changes</p>



<a name="265041942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265041942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265041942">(Dec 15 2021 at 17:10)</a>:</h4>
<p>(same reason I'm kind of okay with <code>itauto!</code> even though two of the characters are in direct conflict with each other)</p>



<a name="265042109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265042109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265042109">(Dec 15 2021 at 17:11)</a>:</h4>
<p><code>etauto</code> for extended?</p>



<a name="265042279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265042279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265042279">(Dec 15 2021 at 17:12)</a>:</h4>
<p>Not sure how confusing it is that the <code>e</code> prefix is used already in <code>eapply</code>...</p>



<a name="265042553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265042553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265042553">(Dec 15 2021 at 17:14)</a>:</h4>
<p>Is there any problem that might arise from this recycling of names, having some of the tactics shift “one chair to the left”? In the very short term it might be tricky to remember what does what, if you’re used to the old names. Are there other problems that might arise (e.g. documentation pertaining to previous versions of mathlib become more confusing)? Is there an argument for just choosing brand new names that don’t collide with the names currently in use?</p>



<a name="265043301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265043301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265043301">(Dec 15 2021 at 17:20)</a>:</h4>
<p>mathlib has zero backward compatibility, so that's not really a concern. If it was difficult to change all existing uses it might be an issue, but for name changes like this it is not difficult.</p>



<a name="265043605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265043605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265043605">(Dec 15 2021 at 17:22)</a>:</h4>
<p>I think for the most part people just try to speak the magic words and see if it solves the goal, in which case it doesn't matter even if the names switch around if your goal is still solved</p>



<a name="265050344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265050344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265050344">(Dec 15 2021 at 18:06)</a>:</h4>
<p>If it's a big worry we could acknowledge the change in the error messages for a bit</p>



<a name="265300739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265300739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265300739">(Dec 17 2021 at 14:18)</a>:</h4>
<p>There are 100 uses of <code>tauto</code> that can be replaced with <code>itauto</code>, 3 with <code>itauto!</code>, and 122 that can't be replaced with either. Unfortunately this experiment pointed out that <code>itauto</code> doesn't scale as well as <code>tauto</code>. The diff shows a handful of places where <code>tauto</code> worked but <code>itauto</code> times out, generally (always?) because there's too much in the context. <a href="https://github.com/leanprover-community/mathlib/compare/tauto-to-itauto">https://github.com/leanprover-community/mathlib/compare/tauto-to-itauto</a></p>



<a name="265354286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/265354286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#265354286">(Dec 17 2021 at 20:08)</a>:</h4>
<p>Could you extract some stress tests?</p>



<a name="266372372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266372372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266372372">(Dec 29 2021 at 19:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="422543">Stuart Presnell</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/265017407">said</a>:</p>
<blockquote>
<p>I've made a start on finishing <code>finish</code> by finding and replacing it in <code>computability/regular_expressions</code> <a href="https://github.com/leanprover-community/mathlib/pull/10811">#10811</a></p>
</blockquote>
<p>I think my most recent PR (<a href="https://github.com/leanprover-community/mathlib/pull/11136">#11136</a>) eliminates the last few instances of <code>finish</code> in the main body of mathlib.  The only remaining (non-commented) instances of the string "finish" that I could find are in the <code>scripts</code>, <code>test</code>, <code>tactic</code>, and <code>archive</code> folders, which I haven't touched.</p>
<p>I have five other open PRs (<a href="https://github.com/leanprover-community/mathlib/pull/11099">#11099</a>, <a href="https://github.com/leanprover-community/mathlib/pull/11103">#11103</a>, <a href="https://github.com/leanprover-community/mathlib/pull/11126">#11126</a>, <a href="https://github.com/leanprover-community/mathlib/pull/11130">#11130</a>, and <a href="https://github.com/leanprover-community/mathlib/pull/11133">#11133</a>), if anyone's interested in hastening the finish of the "finish <code>finish</code>" project. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="266373990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266373990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266373990">(Dec 29 2021 at 19:56)</a>:</h4>
<p>Thanks for all your efforts!</p>



<a name="266375098"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266375098" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266375098">(Dec 29 2021 at 20:14)</a>:</h4>
<p>It's been a really rewarding random tour of the library!  I've worked on a lot of files that I might never have looked at otherwise.</p>



<a name="266376128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266376128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266376128">(Dec 29 2021 at 20:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="422543">Stuart Presnell</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/265017407">said</a>:</p>
<blockquote>
<p>I have five other open PRs (<a href="https://github.com/leanprover-community/mathlib/pull/11099">#11099</a>, <a href="https://github.com/leanprover-community/mathlib/pull/11103">#11103</a>, <a href="https://github.com/leanprover-community/mathlib/pull/11126">#11126</a>, <a href="https://github.com/leanprover-community/mathlib/pull/11130">#11130</a>, and <a href="https://github.com/leanprover-community/mathlib/pull/11133">#11133</a>), if anyone's interested in hastening the finish of the "finish <code>finish</code>" project. <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>
</blockquote>
<p>I'm on it.</p>



<a name="266380185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266380185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266380185">(Dec 29 2021 at 21:26)</a>:</h4>
<p>All 5 PRs are now in bors's queue.</p>



<a name="266380238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266380238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266380238">(Dec 29 2021 at 21:28)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> have you seen that?</p>



<a name="266381108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266381108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266381108">(Dec 29 2021 at 21:41)</a>:</h4>
<p>Fantastic, thank you!</p>



<a name="266381465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266381465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266381465">(Dec 29 2021 at 21:47)</a>:</h4>
<p>Stuart, if you are curious you can have a look at how I simplified many cases. It's not the most interesting part of Lean, but you often learn stuff by seeing code simplification.</p>



<a name="266382773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266382773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266382773">(Dec 29 2021 at 22:07)</a>:</h4>
<p>Thanks very much, I've just skimmed through the changes you've made and already seen that you've made a lot of improvements that I should learn from.  I'll take a proper look over them tomorrow.</p>



<a name="266402999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266402999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266402999">(Dec 30 2021 at 05:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/265354286">said</a>:</p>
<blockquote>
<p>Could you extract some stress tests?</p>
</blockquote>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> sorry I missed this question before. Here are a few tests chopped from that experiment. They don't have minimal imports but at least the first one should be relatively low. All of these time out for me without clearing variables first.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.big_operators.basic</span>
<span class="kn">import</span> <span class="n">number_theory.quadratic_reciprocity</span>



<span class="kd">example</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">}</span> <span class="o">(</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="n">ℤ</span><span class="o">)</span>
  <span class="c1">-- (h : pythagorean_triple x y z)</span>
  <span class="o">(</span><span class="n">hzpos</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">z</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h2</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∧</span> <span class="n">y</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hc</span> <span class="o">:</span> <span class="n">y.gcd</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="o">(</span><span class="n">y</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">∨</span>
            <span class="n">y</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">∧</span>
         <span class="n">m.gcd</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∧</span>
           <span class="o">(</span><span class="n">m</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">m</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">))</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">x</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">∧</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">∨</span>
       <span class="n">x</span> <span class="bp">=</span> <span class="mi">2</span> <span class="bp">*</span> <span class="n">m</span> <span class="bp">*</span> <span class="n">n</span> <span class="bp">∧</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">m</span> <span class="bp">^</span> <span class="mi">2</span> <span class="bp">-</span> <span class="n">n</span> <span class="bp">^</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">∧</span>
    <span class="n">m.gcd</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∧</span> <span class="o">(</span><span class="n">m</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∨</span> <span class="n">m</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">∧</span> <span class="n">n</span> <span class="bp">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- itauto,</span>
<span class="kd">end</span>


<span class="n">open_locale</span> <span class="n">big_operators</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">β</span> <span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span>
  <span class="o">[</span><span class="n">comm_monoid</span> <span class="n">β</span><span class="o">]</span>
  <span class="o">{</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">}</span>
  <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span>
  <span class="o">(</span><span class="n">_inst</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">_inst_2</span> <span class="o">:</span> <span class="n">decidable_eq</span> <span class="n">β</span><span class="o">)</span>
  <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ih</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">),</span>
          <span class="n">t</span> <span class="bp">⊂</span> <span class="n">s</span> <span class="bp">→</span>
          <span class="bp">∀</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">t</span> <span class="bp">→</span> <span class="n">α</span><span class="o">),</span>
            <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">t</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">f</span> <span class="o">(</span><span class="n">g</span> <span class="n">a</span> <span class="n">ha</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="bp">→</span>
            <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">t</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">1</span> <span class="bp">→</span> <span class="n">g</span> <span class="n">a</span> <span class="n">ha</span> <span class="bp">≠</span> <span class="n">a</span><span class="o">)</span> <span class="bp">→</span>
            <span class="bp">∀</span> <span class="o">(</span><span class="n">g_mem</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">t</span><span class="o">),</span> <span class="n">g</span> <span class="n">a</span> <span class="n">ha</span> <span class="bp">∈</span> <span class="n">t</span><span class="o">),</span>
              <span class="o">(</span><span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">t</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="n">g</span> <span class="n">a</span> <span class="n">ha</span><span class="o">)</span> <span class="gr">sorry</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span> <span class="bp">→</span>
              <span class="bp">∏</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="k">in</span> <span class="n">t</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">*</span> <span class="n">f</span> <span class="o">(</span><span class="n">g</span> <span class="n">a</span> <span class="n">ha</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">g_ne</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">),</span> <span class="n">f</span> <span class="n">a</span> <span class="bp">≠</span> <span class="mi">1</span> <span class="bp">→</span> <span class="n">g</span> <span class="n">a</span> <span class="n">ha</span> <span class="bp">≠</span> <span class="n">a</span><span class="o">)</span>
  <span class="o">(</span><span class="n">g_mem</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">),</span> <span class="n">g</span> <span class="n">a</span> <span class="n">ha</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span>
  <span class="o">(</span><span class="n">g_inv</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span> <span class="o">:</span> <span class="n">a</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">),</span> <span class="n">g</span> <span class="o">(</span><span class="n">g</span> <span class="n">a</span> <span class="n">ha</span><span class="o">)</span> <span class="gr">sorry</span> <span class="bp">=</span> <span class="n">a</span><span class="o">)</span>
  <span class="o">(</span><span class="n">_x</span> <span class="o">:</span> <span class="n">s.nonempty</span><span class="o">)</span>
  <span class="o">(</span><span class="n">_fun_match</span> <span class="o">:</span> <span class="n">s.nonempty</span> <span class="bp">→</span> <span class="bp">∏</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="k">in</span> <span class="n">s</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hmem</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">),</span> <span class="n">y</span> <span class="bp">∈</span> <span class="o">(</span><span class="n">s.erase</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">erase</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span> <span class="n">hx</span><span class="o">)</span> <span class="bp">→</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span>
  <span class="o">(</span><span class="n">g_inj</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">hx</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">}</span> <span class="o">{</span><span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">}</span> <span class="o">{</span><span class="n">hy</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">},</span>
             <span class="n">g</span> <span class="n">x</span> <span class="n">hx</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">y</span> <span class="n">hy</span> <span class="bp">→</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">y</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ih'</span> <span class="o">:</span> <span class="bp">∏</span> <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="k">in</span> <span class="o">(</span><span class="n">s.erase</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">erase</span> <span class="o">(</span><span class="n">g</span> <span class="n">x</span> <span class="n">hx</span><span class="o">),</span> <span class="n">f</span> <span class="n">y</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hx1</span> <span class="o">:</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span>
  <span class="o">(</span><span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hy</span> <span class="o">:</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">s</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hy₁</span> <span class="o">:</span> <span class="bp">¬</span><span class="n">y</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="n">hx</span> <span class="bp">→</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">x</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">y</span> <span class="bp">=</span> <span class="n">x</span> <span class="bp">∨</span> <span class="n">y</span> <span class="bp">=</span> <span class="n">g</span> <span class="n">x</span> <span class="n">hx</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">clear</span> <span class="n">ih</span> <span class="n">_fun_match</span> <span class="n">g_inj</span> <span class="n">ih'</span><span class="o">,</span> <span class="c1">-- comment this and it's slow</span>
  <span class="n">itauto</span><span class="o">,</span>
<span class="kd">end</span>


<span class="kn">open</span> <span class="n">function</span> <span class="n">finset</span> <span class="n">nat</span> <span class="n">finite_field</span> <span class="n">zmod</span>


<span class="kd">example</span> <span class="o">(</span><span class="n">p</span> <span class="n">q</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">×</span> <span class="n">ℕ</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hq0</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">q</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hswap</span> <span class="o">:</span> <span class="o">(</span><span class="n">filter</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">×</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">x.snd</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">≤</span> <span class="n">x.fst</span> <span class="bp">*</span> <span class="n">p</span><span class="o">)</span>
                <span class="o">((</span><span class="n">Ico</span> <span class="mi">1</span> <span class="o">(</span><span class="n">q</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span><span class="bp">.</span><span class="n">product</span> <span class="o">(</span><span class="n">Ico</span> <span class="mi">1</span> <span class="o">(</span><span class="n">p</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)))</span><span class="bp">.</span><span class="n">card</span> <span class="bp">=</span>
             <span class="o">(</span><span class="n">filter</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">×</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">x.fst</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">≤</span> <span class="n">x.snd</span> <span class="bp">*</span> <span class="n">p</span><span class="o">)</span>
                <span class="o">((</span><span class="n">Ico</span> <span class="mi">1</span> <span class="o">(</span><span class="n">p</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span><span class="bp">.</span><span class="n">product</span> <span class="o">(</span><span class="n">Ico</span> <span class="mi">1</span> <span class="o">(</span><span class="n">q</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)))</span><span class="bp">.</span><span class="n">card</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hdisj</span> <span class="o">:</span> <span class="n">disjoint</span>
             <span class="o">(</span><span class="n">filter</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">×</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">x.snd</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">≤</span> <span class="n">x.fst</span> <span class="bp">*</span> <span class="n">q</span><span class="o">)</span>
                <span class="o">((</span><span class="n">Ico</span> <span class="mi">1</span> <span class="o">(</span><span class="n">p</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span><span class="bp">.</span><span class="n">product</span> <span class="o">(</span><span class="n">Ico</span> <span class="mi">1</span> <span class="o">(</span><span class="n">q</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)))</span>
             <span class="o">(</span><span class="n">filter</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">×</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">x.fst</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">≤</span> <span class="n">x.snd</span> <span class="bp">*</span> <span class="n">p</span><span class="o">)</span>
                <span class="o">((</span><span class="n">Ico</span> <span class="mi">1</span> <span class="o">(</span><span class="n">p</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span><span class="bp">.</span><span class="n">product</span> <span class="o">(</span><span class="n">Ico</span> <span class="mi">1</span> <span class="o">(</span><span class="n">q</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">))))</span>
  <span class="o">(</span><span class="n">this</span> <span class="o">:</span> <span class="n">x.snd</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">≤</span> <span class="n">x.fst</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">∨</span> <span class="n">x.fst</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">≤</span> <span class="n">x.snd</span> <span class="bp">*</span> <span class="n">p</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">((</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">x.fst</span> <span class="bp">∧</span> <span class="n">x.fst</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">p</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="bp">∧</span>
           <span class="mi">1</span> <span class="bp">≤</span> <span class="n">x.snd</span> <span class="bp">∧</span> <span class="n">x.snd</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">q</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="bp">∧</span>
        <span class="n">x.snd</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">≤</span> <span class="n">x.fst</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">∨</span>
      <span class="o">((</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">x.fst</span> <span class="bp">∧</span> <span class="n">x.fst</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">p</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="bp">∧</span>
           <span class="mi">1</span> <span class="bp">≤</span> <span class="n">x.snd</span> <span class="bp">∧</span> <span class="n">x.snd</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">q</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="bp">∧</span>
        <span class="n">x.fst</span> <span class="bp">*</span> <span class="n">q</span> <span class="bp">≤</span> <span class="n">x.snd</span> <span class="bp">*</span> <span class="n">p</span> <span class="bp">↔</span>
    <span class="o">(</span><span class="mi">1</span> <span class="bp">≤</span> <span class="n">x.fst</span> <span class="bp">∧</span> <span class="n">x.fst</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">p</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span><span class="o">)</span> <span class="bp">∧</span>
      <span class="mi">1</span> <span class="bp">≤</span> <span class="n">x.snd</span> <span class="bp">∧</span> <span class="n">x.snd</span> <span class="bp">&lt;</span> <span class="o">(</span><span class="n">q</span> <span class="bp">/</span> <span class="mi">2</span><span class="o">)</span><span class="bp">.</span><span class="n">succ</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">-- itauto,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="266403075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403075">(Dec 30 2021 at 05:04)</a>:</h4>
<p>Old <code>tauto</code> isn't instant, but the worst is 1.2 seconds on the first one.</p>



<a name="266403119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403119">(Dec 30 2021 at 05:05)</a>:</h4>
<p>The first one is instant for me</p>



<a name="266403168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403168">(Dec 30 2021 at 05:06)</a>:</h4>
<p>profiler says 38 ms</p>



<a name="266403180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403180">(Dec 30 2021 at 05:07)</a>:</h4>
<p>this is on master as of a few days ago</p>



<a name="266403309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403309">(Dec 30 2021 at 05:10)</a>:</h4>
<p>updated to master, seems the same. Example 1 in 30 ms, example 2 fails (in 10 ms), example 3 in 16 ms</p>



<a name="266403366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403366">(Dec 30 2021 at 05:11)</a>:</h4>
<p>Ah, <a href="https://github.com/leanprover-community/mathlib/pull/10744">#10744</a> never got merged?</p>



<a name="266403406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403406">(Dec 30 2021 at 05:12)</a>:</h4>
<p>I don't think the discussion about naming should block that PR</p>



<a name="266403429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403429">(Dec 30 2021 at 05:13)</a>:</h4>
<p>The problem is with <a href="https://github.com/leanprover-community/mathlib/pull/10744">#10744</a> then</p>



<a name="266403481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403481">(Dec 30 2021 at 05:14)</a>:</h4>
<p>I was running these tests on top of that. With that change they time out for me</p>



<a name="266403486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403486">(Dec 30 2021 at 05:14)</a>:</h4>
<p>You're right that they're fast on master</p>



<a name="266403493"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403493" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403493">(Dec 30 2021 at 05:14)</a>:</h4>
<p>Didn't check that, I wasn't expecting a regression in plain <code>itauto</code> from that change</p>



<a name="266403569"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403569" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403569">(Dec 30 2021 at 05:16)</a>:</h4>
<p>I think I know the issue behind example 1: Everything there is a decidable proposition so the preprocessor adds a whole bunch of potential applications of <code>em</code> and the main solver gets lost</p>



<a name="266403650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266403650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266403650">(Dec 30 2021 at 05:18)</a>:</h4>
<p>maybe there should be a tactic option to turn off decidability checking</p>



<a name="266404016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266404016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266404016">(Dec 30 2021 at 05:27)</a>:</h4>
<p><code>itauto-</code>?</p>



<a name="266404083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266404083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266404083">(Dec 30 2021 at 05:29)</a>:</h4>
<p>In any case, with this performance I don't think it should be used to replace <code>tauto</code> in mathlib3. Maybe this is reason to write a dedicated classical sat tactic for mathlib4</p>



<a name="266410658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20sat%20solvers/near/266410658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20sat.20solvers.html#266410658">(Dec 30 2021 at 08:08)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> I've pushed some changes on <a href="https://github.com/leanprover-community/mathlib/pull/10744">#10744</a> that should address the issues. <code>itauto</code> now acts like it does on master, ignoring decidable instances, while <code>itauto*</code> will add all decidable instances and <code>itauto [p]</code> will add selected decidable instances. Also I incorporated <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> 's <a href="#narrow/stream/113488-general/topic/mathlib.20sat.20solvers/near/265031550">suggestion</a> to show partial proofs in the case where the proof search fails.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>