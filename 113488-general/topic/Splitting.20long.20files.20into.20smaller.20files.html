---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html">Splitting long files into smaller files</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="206004527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206004527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206004527">(Aug 05 2020 at 09:47)</a>:</h4>
<p>What's mathlib's stance on how many different things should be in a single file? For instance, would it be reasonable to separate <code>semimodule</code> and <code>submodule</code>(currently in <code>algebra/module/basic.lean</code>  into separate files (<code>basic.lean</code> and <code>submodule.lean</code>)?</p>



<a name="206004972"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206004972" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206004972">(Aug 05 2020 at 09:53)</a>:</h4>
<p>I'm generally in favour of splitting, and I would say that splitting <code>module</code> and <code>submodule</code> is also a good idea if there are no obvious breakages in the files themselves. You can even <code>import algebra.module.submodule</code> in <code>src/algebra/module/default.lean</code>, and (almost) no code should break.</p>



<a name="206005100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206005100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206005100">(Aug 05 2020 at 09:55)</a>:</h4>
<p>Am I right in thinking that <code>default</code> is special, and <code>import a.b</code> will import <code>a.b.default</code> if found?</p>



<a name="206005123"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206005123" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206005123">(Aug 05 2020 at 09:55)</a>:</h4>
<p>I believe so.</p>



<a name="206005139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206005139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206005139">(Aug 05 2020 at 09:55)</a>:</h4>
<p>At least, it worked like that when splitting <code>ring_theory.polynomial</code>.</p>



<a name="206005142"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206005142" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206005142">(Aug 05 2020 at 09:55)</a>:</h4>
<p>I'll take a crack at that split once my two trivial open PRs against <code>basic.lean</code> (<a href="https://github.com/leanprover-community/mathlib/issues/3631">#3631</a>, <a href="https://github.com/leanprover-community/mathlib/issues/3690">#3690</a>)  are merged, thanks</p>



<a name="206005219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206005219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206005219">(Aug 05 2020 at 09:56)</a>:</h4>
<p>Thanks! I will take a look at the new PR.</p>



<a name="206008617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206008617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206008617">(Aug 05 2020 at 10:53)</a>:</h4>
<p>While it's great to provide <code>.default</code> files for users of mathlib, files in mathlib should use the minimised imports, rather than grabbing <code>.default</code>s, for the sake of minimising the compilation dependency graph.</p>



<a name="206008628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206008628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206008628">(Aug 05 2020 at 10:53)</a>:</h4>
<p>And yes, effort into splitting files is generally good.</p>



<a name="206008682"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206008682" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206008682">(Aug 05 2020 at 10:54)</a>:</h4>
<p>The one thing to think about is that it potentially degrades "findability", because it breaks the strategy "guess the right file, then scroll through it".</p>



<a name="206008697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206008697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206008697">(Aug 05 2020 at 10:54)</a>:</h4>
<p>And so appropriate documentation in the module doc-strings (XYZ can be found in files ABC) is important!</p>



<a name="206008855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206008855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206008855">(Aug 05 2020 at 10:57)</a>:</h4>
<p>Hopefully that strategy naturally leads into "guess the right directory, scroll through the handful of files in it"</p>



<a name="206008874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206008874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206008874">(Aug 05 2020 at 10:58)</a>:</h4>
<p>Does the html doc generator have a mechanism to link to types and declarations elsewhere like sphinx's <code>:func:`name` </code>?</p>



<a name="206009314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206009314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206009314">(Aug 05 2020 at 11:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files/near/206008682">said</a>:</p>
<blockquote>
<p>The one thing to think about is that it potentially degrades "findability", because it breaks the strategy "guess the right file, then scroll through it".</p>
</blockquote>
<p>I've definitely noticed this aspect. I'm the one responsible for most of the massive files in mathlib, because I have high file size tolerance due to my <a href="http://set.mm">set.mm</a> background (all of ZFC in one file of 600000 lines), and I employ this tactic all the time for finding things in mathlib, but I have noticed it being less effective of late. Especially if I forget that a splitting PR has landed, my mental model will say "what is in this file is all there is about topic X" and so if the file is suddenly shrunk then I get lots of false negatives when searching</p>



<a name="206009589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206009589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206009589">(Aug 05 2020 at 11:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files/near/206008874">said</a>:</p>
<blockquote>
<p>Does the html doc generator have a mechanism to link to types and declarations elsewhere like sphinx's <code>:func:`name` </code>?</p>
</blockquote>
<p>Any full declaration name that you type in backticks will be linked. See e.g. <code>with_top</code> in the first para of  <a href="https://leanprover-community.github.io/mathlib_docs/geometry/manifold/smooth_manifold_with_corners.html">https://leanprover-community.github.io/mathlib_docs/geometry/manifold/smooth_manifold_with_corners.html</a></p>



<a name="206009600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206009600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206009600">(Aug 05 2020 at 11:07)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files/near/206008855">said</a>:</p>
<blockquote>
<p>Hopefully that strategy naturally leads into "guess the right directory, scroll through the handful of files in it"</p>
</blockquote>
<p>I don't know any editor that makes this convenient. This starts to remind me of big java programs where there are thousands of 10 line files and you are constantly searching for where the actual stuff gets done</p>



<a name="206015480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206015480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206015480">(Aug 05 2020 at 12:22)</a>:</h4>
<p>The other downside to many files is that <code>library_search</code> (and <code>simp</code>, for that matter) becomes weaker, because it can only see what is currently imported.</p>



<a name="206015509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206015509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206015509">(Aug 05 2020 at 12:23)</a>:</h4>
<p>On the gripping hand, <code>library_search</code> and <code>simp</code> become faster when you don't have unnecessary material imported...</p>



<a name="206015818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206015818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206015818">(Aug 05 2020 at 12:27)</a>:</h4>
<p>Findability via <code>library_search</code> / <code>simp</code> should not get worse if we move definitions (and their associated lemmas), right? Because you need to import those definitions anyway to talk about the thing we want to find.</p>



<a name="206027090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Splitting%20long%20files%20into%20smaller%20files/near/206027090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files.html#206027090">(Aug 05 2020 at 14:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="238446">Anne Baanen</span> <a href="#narrow/stream/113488-general/topic/Splitting.20long.20files.20into.20smaller.20files/near/206004972">said</a>:</p>
<blockquote>
<p>I would say that splitting <code>module</code> and <code>submodule</code> is also a good idea if there are no obvious breakages in the files themselves.</p>
</blockquote>
<p>PR'd as <a href="https://github.com/leanprover-community/mathlib/issues/3696">#3696</a> with no complications. Will remove the draft status once <a href="https://github.com/leanprover-community/mathlib/issues/3631">#3631</a> is resolved.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>