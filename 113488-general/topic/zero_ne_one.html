---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/zero_ne_one.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html">zero_ne_one</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="198998320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198998320" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198998320">(May 28 2020 at 09:06)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">opposite</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">variable</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span>

<span class="n">class</span> <span class="n">nonzero</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">zero_ne_one</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">α</span><span class="o">))</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span>
<span class="kn">lemma</span> <span class="n">zero_ne_one</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">nonzero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">nonzero</span><span class="bp">.</span><span class="n">zero_ne_one</span>

<span class="kn">namespace</span> <span class="n">opposite</span>

<span class="kn">instance</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero</span> <span class="o">:=</span> <span class="n">op</span> <span class="mi">0</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_one</span> <span class="o">(</span><span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">one</span> <span class="o">:=</span> <span class="n">op</span> <span class="mi">1</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">nonzero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">nonzero</span> <span class="o">(</span><span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero_ne_one</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="bp">@</span><span class="n">zero_ne_one</span> <span class="n">α</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_</span> <span class="err">$</span> <span class="n">op_inj</span> <span class="n">h</span> <span class="o">}</span>

<span class="kn">end</span> <span class="n">opposite</span>
</code></pre></div>



<a name="198998353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198998353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198998353">(May 28 2020 at 09:07)</a>:</h4>
<p>why does it throw an error when I replace <code>@zero_ne_one α</code> with <code>@zero_ne_one _</code>?</p>



<a name="198998366"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198998366" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198998366">(May 28 2020 at 09:07)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">op_inj</span> <span class="n">h</span>
<span class="n">term</span>
  <span class="n">h</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="mi">0</span> <span class="bp">=</span> <span class="mi">1</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">op</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">op</span> <span class="mi">1</span>
</code></pre></div>



<a name="198998593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198998593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198998593">(May 28 2020 at 09:10)</a>:</h4>
<p>does that mean I should make that parameter explicit?</p>



<a name="198999229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999229">(May 28 2020 at 09:18)</a>:</h4>
<p>I think this is a <a href="https://github.com/leanprover-community/lean/issues/282">lean#282</a> issue</p>



<a name="198999242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999242">(May 28 2020 at 09:18)</a>:</h4>
<p>I think this is expected behavior</p>



<a name="198999256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999256">(May 28 2020 at 09:18)</a>:</h4>
<p>I think you should not make the type explicit</p>



<a name="198999257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999257">(May 28 2020 at 09:18)</a>:</h4>
<p>because it didn't exist when <code>nonzero</code> was bundled</p>



<a name="198999313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999313">(May 28 2020 at 09:19)</a>:</h4>
<p>I can also write <code>λ h, zero_ne_one (op_inj h : (0:α) = 1)</code></p>



<a name="198999319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999319">(May 28 2020 at 09:19)</a>:</h4>
<p>The type of the goal is <code>op 0 != op 1</code>, right? Since these have type <code>opposite A</code>, when you apply <code>zero_ne_one</code> lean will guess to fill the type with <code>opposite A</code> instead of <code>A</code></p>



<a name="198999374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999374">(May 28 2020 at 09:20)</a>:</h4>
<p>no, the goal is <code>false</code> because of the <code>fun h</code></p>



<a name="198999434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999434">(May 28 2020 at 09:20)</a>:</h4>
<p>what type does <code>op_inj h</code> have?</p>



<a name="198999452"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999452" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999452">(May 28 2020 at 09:21)</a>:</h4>
<p>it should say (0:\a) = 1</p>



<a name="198999471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999471">(May 28 2020 at 09:21)</a>:</h4>
<p>it seems from the error message that lean still managed to work it out top down</p>



<a name="198999476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999476">(May 28 2020 at 09:21)</a>:</h4>
<p>but the 0 and 1 in <code>h</code> didn't unfold to <code>op 0 = op 1</code></p>



<a name="198999484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999484">(May 28 2020 at 09:21)</a>:</h4>
<p><code>h</code> has type <code>(0 : opposite \a) = 1</code></p>



<a name="198999498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999498">(May 28 2020 at 09:21)</a>:</h4>
<p>which can be unfolded to <code>op 0 = op 1</code></p>



<a name="198999502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999502">(May 28 2020 at 09:21)</a>:</h4>
<p>theoretically</p>



<a name="198999546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999546">(May 28 2020 at 09:22)</a>:</h4>
<p>but somehow Lean got confused in <code>zero_ne_one</code></p>



<a name="198999547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999547">(May 28 2020 at 09:22)</a>:</h4>
<p>does it work if you put the type ascription on <code>h</code> instead of <code>op_inj h</code>?</p>



<a name="198999568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999568">(May 28 2020 at 09:22)</a>:</h4>
<p>aha</p>



<a name="198999598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999598">(May 28 2020 at 09:22)</a>:</h4>
<p>you might even be able to change the type of <code>h</code> at the source, in the lambda</p>



<a name="198999608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999608">(May 28 2020 at 09:22)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">nonzero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">nonzero</span> <span class="o">(</span><span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero_ne_one</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="n">zero_ne_one</span> <span class="o">(</span><span class="n">op_inj</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="n">op</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="n">op</span> <span class="mi">1</span><span class="o">))</span> <span class="o">}</span>
</code></pre></div>



<a name="198999613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999613">(May 28 2020 at 09:23)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">op_inj</span> <span class="n">h</span>
<span class="n">term</span>
  <span class="n">h</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="mi">0</span> <span class="bp">=</span> <span class="mi">1</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">op</span> <span class="mi">0</span> <span class="bp">=</span> <span class="n">op</span> <span class="mi">1</span>
</code></pre></div>



<a name="198999633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999633">(May 28 2020 at 09:23)</a>:</h4>
<p>this works:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">instance</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">nonzero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">nonzero</span> <span class="o">(</span><span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero_ne_one</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">h</span> <span class="o">:</span> <span class="n">op</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="n">op</span> <span class="mi">1</span><span class="o">,</span> <span class="n">zero_ne_one</span> <span class="o">(</span><span class="n">op_inj</span> <span class="n">h</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>



<a name="198999638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999638">(May 28 2020 at 09:23)</a>:</h4>
<p>so what's going wrong with the elaboration?</p>



<a name="198999654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999654">(May 28 2020 at 09:23)</a>:</h4>
<p>well type ascription doesn't actually change the type</p>



<a name="198999707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999707">(May 28 2020 at 09:24)</a>:</h4>
<p>if you used <code>show op (0 : α) = op 1, from h</code> it would also work</p>



<a name="198999725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999725">(May 28 2020 at 09:24)</a>:</h4>
<p>yeah but why can't Lean do this for me?</p>



<a name="198999734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999734">(May 28 2020 at 09:24)</a>:</h4>
<p>Do it again with pp.all</p>



<a name="198999808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999808">(May 28 2020 at 09:25)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op_inj</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_3</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_4</span><span class="o">)</span> <span class="n">h</span>
<span class="n">term</span>
  <span class="n">h</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_3</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_4</span><span class="o">))</span>
</code></pre></div>



<a name="198999966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/198999966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#198999966">(May 28 2020 at 09:27)</a>:</h4>
<p>does <code>by exact h</code> work?</p>



<a name="199000075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000075">(May 28 2020 at 09:28)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">Tactic</span> <span class="n">State</span>
<span class="mi">1</span> <span class="n">goal</span>
<span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">))</span>
<span class="err">⊢</span> <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_3</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_4</span><span class="o">))</span>
</code></pre></div>


<p>opposites.lean:114:42: error</p>
<div class="codehilite"><pre><span></span><code><span class="n">don&#39;t</span> <span class="n">know</span> <span class="n">how</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">placeholder</span>
<span class="kn">context</span><span class="o">:</span>
<span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">has_zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_2</span> <span class="o">:</span> <span class="n">has_one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_3</span> <span class="o">:</span> <span class="bp">@</span><span class="n">nonzero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">))</span>
<span class="err">⊢</span> <span class="kt">Type</span> <span class="err">?</span><span class="n">l_1</span>
</code></pre></div>


<p>opposites.lean:114:53: error</p>
<div class="codehilite"><pre><span></span><code><span class="n">invalid</span> <span class="n">type</span> <span class="n">ascription</span><span class="o">,</span> <span class="n">term</span> <span class="n">has</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">))</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_3</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_4</span><span class="o">))</span>
<span class="n">state</span><span class="o">:</span>
<span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">has_zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_2</span> <span class="o">:</span> <span class="n">has_one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span><span class="o">,</span>
<span class="bp">_</span><span class="n">inst_3</span> <span class="o">:</span> <span class="bp">@</span><span class="n">nonzero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">,</span>
<span class="n">h</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="n">α</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_one</span><span class="bp">.</span><span class="o">{</span><span class="n">u</span><span class="o">}</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_2</span><span class="o">))</span>
<span class="err">⊢</span> <span class="bp">@</span><span class="n">eq</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="o">(</span><span class="n">opposite</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_3</span><span class="o">))</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">op</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="bp">+</span><span class="mi">1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_one</span><span class="bp">.</span><span class="n">one</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="n">l_1</span><span class="o">}</span> <span class="err">?</span><span class="n">m_2</span> <span class="err">?</span><span class="n">m_4</span><span class="o">))</span>
</code></pre></div>



<a name="199000146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000146">(May 28 2020 at 09:29)</a>:</h4>
<p>I think Lean cannot unify <code>(@opposite.op.{u+1} ?m_1 (@has_zero.zero.{u} ?m_1 ?m_2))</code> to <code>(@has_zero.zero.{u} (opposite.{u+1} α) (@opposite.has_zero.{u} α _inst_1))</code></p>



<a name="199000151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000151">(May 28 2020 at 09:29)</a>:</h4>
<p>or is it the other way round</p>



<a name="199000175"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000175" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000175">(May 28 2020 at 09:29)</a>:</h4>
<p>well unify is symmetric</p>



<a name="199000182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000182">(May 28 2020 at 09:29)</a>:</h4>
<p>oh is it</p>



<a name="199000265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000265">(May 28 2020 at 09:30)</a>:</h4>
<p>sure, there could in general be metavariables on both sides</p>



<a name="199000289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000289">(May 28 2020 at 09:30)</a>:</h4>
<p>so what's going on here?</p>



<a name="199000314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000314">(May 28 2020 at 09:31)</a>:</h4>
<p>I assume that <code>opposite.has_zero</code> is defined as <code>&lt;op 0&gt;</code>?</p>



<a name="199000318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000318">(May 28 2020 at 09:31)</a>:</h4>
<p>right</p>



<a name="199000327"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000327" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000327">(May 28 2020 at 09:31)</a>:</h4>
<p>as demonstrated in my <a href="https://leanprover-community.github.io/mwe.html">#mwe</a></p>



<a name="199000636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000636">(May 28 2020 at 09:34)</a>:</h4>
<p>and for some reason when it's bundled it says <code>op 0 = op 1</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">opposite</span>

<span class="kn">universe</span> <span class="n">u</span>

<span class="kn">variable</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span>

<span class="n">class</span> <span class="n">zero_ne_one_class</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">has_zero</span> <span class="n">α</span><span class="o">,</span> <span class="n">has_one</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">zero_ne_one</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">α</span><span class="o">))</span>

<span class="bp">@</span><span class="o">[</span><span class="n">simp</span><span class="o">]</span>
<span class="kn">lemma</span> <span class="n">zero_ne_one</span> <span class="o">[</span><span class="n">zero_ne_one_class</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">≠</span> <span class="o">(</span><span class="mi">1</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">zero_ne_one_class</span><span class="bp">.</span><span class="n">zero_ne_one</span>

<span class="kn">namespace</span> <span class="n">opposite</span>

<span class="kn">instance</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero</span> <span class="o">:=</span> <span class="n">op</span> <span class="mi">0</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_one</span> <span class="o">(</span><span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">one</span> <span class="o">:=</span> <span class="n">op</span> <span class="mi">1</span> <span class="o">}</span>

<span class="kn">instance</span> <span class="o">[</span><span class="n">zero_ne_one_class</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">zero_ne_one_class</span> <span class="o">(</span><span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero_ne_one</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">h</span><span class="o">,</span> <span class="bp">_</span><span class="o">,</span> <span class="c1">-- h : op 0 = op 1</span>
  <span class="bp">..</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span><span class="o">,</span>
  <span class="bp">..</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_one</span> <span class="o">}</span>

<span class="kn">end</span> <span class="n">opposite</span>
</code></pre></div>



<a name="199000659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000659">(May 28 2020 at 09:35)</a>:</h4>
<p>this is a <a href="https://github.com/leanprover-community/lean/issues/282">lean#282</a> issue afterall methinks</p>



<a name="199000897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000897">(May 28 2020 at 09:38)</a>:</h4>
<p>I can get the error without using structure literals though</p>



<a name="199000944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199000944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199000944">(May 28 2020 at 09:38)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">example</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="bp">→</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">op_inj</span> <span class="bp">_</span> <span class="mi">0</span> <span class="mi">1</span>
</code></pre></div>



<a name="199001505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199001505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199001505">(May 28 2020 at 09:44)</a>:</h4>
<p>Aha:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">implicit</span> <span class="n">true</span>
<span class="kn">set_option</span> <span class="n">pp</span><span class="bp">.</span><span class="n">numerals</span> <span class="n">false</span>
<span class="kn">set_option</span> <span class="n">trace</span><span class="bp">.</span><span class="n">type_context</span><span class="bp">.</span><span class="n">is_def_eq_detail</span> <span class="n">true</span>
<span class="kn">example</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">has_one</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">opposite</span> <span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="n">α</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">op_inj</span> <span class="bp">_</span> <span class="mi">0</span> <span class="mi">1</span> <span class="n">h</span>
</code></pre></div>


<div class="codehilite"><pre><span></span><code><span class="bp">...</span>
<span class="o">[</span><span class="n">type_context</span><span class="bp">.</span><span class="n">is_def_eq_detail</span><span class="o">]</span> <span class="o">[</span><span class="mi">2</span><span class="o">]:</span> <span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="n">α</span><span class="err">ᵒᵖ</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span> <span class="bp">=</span><span class="err">?</span><span class="bp">=</span> <span class="bp">@</span><span class="n">op</span> <span class="err">?</span><span class="n">m_1</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="err">?</span><span class="n">m_1</span> <span class="err">?</span><span class="n">m_2</span><span class="o">)</span>
<span class="o">[</span><span class="n">type_context</span><span class="bp">.</span><span class="n">is_def_eq_detail</span><span class="o">]</span> <span class="n">unfold</span> <span class="n">right</span><span class="o">:</span> <span class="n">opposite</span><span class="bp">.</span><span class="n">op</span>
<span class="o">[</span><span class="n">type_context</span><span class="bp">.</span><span class="n">is_def_eq_detail</span><span class="o">]</span> <span class="o">[</span><span class="mi">3</span><span class="o">]:</span> <span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="n">α</span><span class="err">ᵒᵖ</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span> <span class="bp">=</span><span class="err">?</span><span class="bp">=</span> <span class="bp">@</span><span class="n">id</span> <span class="err">?</span><span class="n">m_1</span> <span class="o">(</span><span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="err">?</span><span class="n">m_1</span> <span class="err">?</span><span class="n">m_2</span><span class="o">)</span>
<span class="o">[</span><span class="n">type_context</span><span class="bp">.</span><span class="n">is_def_eq_detail</span><span class="o">]</span> <span class="n">unfold</span> <span class="n">right</span><span class="o">:</span> <span class="n">id</span>
<span class="o">[</span><span class="n">type_context</span><span class="bp">.</span><span class="n">is_def_eq_detail</span><span class="o">]</span> <span class="o">[</span><span class="mi">4</span><span class="o">]:</span> <span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="n">α</span><span class="err">ᵒᵖ</span> <span class="o">(</span><span class="bp">@</span><span class="n">opposite</span><span class="bp">.</span><span class="n">has_zero</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span><span class="o">)</span> <span class="bp">=</span><span class="err">?</span><span class="bp">=</span> <span class="bp">@</span><span class="n">has_zero</span><span class="bp">.</span><span class="n">zero</span> <span class="err">?</span><span class="n">m_1</span> <span class="err">?</span><span class="n">m_2</span>
<span class="o">[</span><span class="n">type_context</span><span class="bp">.</span><span class="n">is_def_eq_detail</span><span class="o">]</span> <span class="n">process_assignment</span> <span class="err">?</span><span class="n">m_1</span> <span class="o">:=</span> <span class="n">α</span><span class="err">ᵒᵖ</span>
<span class="bp">...</span>
</code></pre></div>



<a name="199001546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199001546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199001546">(May 28 2020 at 09:45)</a>:</h4>
<p>It decided that it was more worthwhile to unfold <code>op</code> than <code>has_zero.zero</code></p>



<a name="199001572"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199001572" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199001572">(May 28 2020 at 09:45)</a>:</h4>
<p>resulting in the incorrect assignment <code>?m_1 := αᵒᵖ</code></p>



<a name="199002004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199002004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199002004">(May 28 2020 at 09:51)</a>:</h4>
<p>oh well</p>



<a name="199002009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199002009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199002009">(May 28 2020 at 09:51)</a>:</h4>
<p>what to do</p>



<a name="199002354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199002354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199002354">(May 28 2020 at 09:55)</a>:</h4>
<p>I think this kind of problem can in theory be addressed by adjusting definitional heights, but that's a black magic I don't want to start peddling</p>



<a name="199002404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199002404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199002404">(May 28 2020 at 09:55)</a>:</h4>
<p>it seems like the kind of problem that should happen all the time though, so I must be missing some heuristic</p>



<a name="199002468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/zero_ne_one/near/199002468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/zero_ne_one.html#199002468">(May 28 2020 at 09:56)</a>:</h4>
<p>The short term fix is obvious though: use <code>@</code> or a type ascription</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>