---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/import.20graph.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html">import graph</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="152167877"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/152167877" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#152167877">(Dec 19 2018 at 08:46)</a>:</h4>
<p>could someone kindly create a graph of imports?</p>



<a name="198992419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/198992419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#198992419">(May 28 2020 at 07:55)</a>:</h4>
<p>do we have an import graph online?</p>



<a name="198992693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/198992693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#198992693">(May 28 2020 at 07:59)</a>:</h4>
<p>Not yet, I think. It's WIP</p>



<a name="198992727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/198992727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#198992727">(May 28 2020 at 07:59)</a>:</h4>
<p>Also... now you have to update the title and first post of your PR <span aria-label="rofl" class="emoji emoji-1f923" role="img" title="rofl">:rofl:</span></p>



<a name="198993044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/198993044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#198993044">(May 28 2020 at 08:03)</a>:</h4>
<p>what do you mean?</p>



<a name="198993141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/198993141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#198993141">(May 28 2020 at 08:04)</a>:</h4>
<p>Well... you're now attacking <code>nonzero_divisors</code> as well, right?</p>



<a name="198993160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/198993160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#198993160">(May 28 2020 at 08:04)</a>:</h4>
<p>It's less drastic, but it would be nice to mention it.</p>



<a name="217609059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609059">(Nov 23 2020 at 10:08)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> Here are some bash functions that will build the import graph for you within seconds:</p>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code><span class="k">function</span> file_to_import <span class="o">{</span>
        sed -e <span class="s1">'s/src\///;s/.lean//;s/\//./g'</span>
<span class="o">}</span>

<span class="k">function</span> import_to_file <span class="o">{</span>
        sed -e <span class="s1">'s/[.]/\//g;s/.*/src\/&amp;.lean/'</span>
<span class="o">}</span>

<span class="k">function</span> list_deps <span class="o">{</span>
        find src/ -name <span class="s1">'*.lean'</span> <span class="se">\</span>
                <span class="p">|</span> xargs grep <span class="s2">"^import "</span> <span class="se">\</span>
                <span class="p">|</span> sed -e <span class="s1">'s/src\///;s/.lean:import//;s/\//./g;s/ --.*//'</span> <span class="se">\</span>
                <span class="p">|</span> grep -v <span class="s2">"tactic.norm_num data.real.basic"</span> <span class="se">\</span>
                <span class="p">|</span> grep -v <span class="s2">"tactic.find tactic.find"</span>
<span class="o">}</span>
</code></pre></div>



<a name="217609092"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609092" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609092">(Nov 23 2020 at 10:08)</a>:</h4>
<p>Where does the code live for <code>leanproject import-graph</code>?</p>



<a name="217609120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609120">(Nov 23 2020 at 10:09)</a>:</h4>
<p>Output is in <code>tsort</code> format, in other words: one edge per line</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">A</span> <span class="n">B</span>
<span class="n">C</span> <span class="n">D</span>
<span class="n">E</span> <span class="n">F</span>
<span class="n">A</span> <span class="n">D</span>
<span class="n">A</span> <span class="n">F</span>
</code></pre></div>
<p>etc...</p>



<a name="217609130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609130">(Nov 23 2020 at 10:09)</a>:</h4>
<p>Searching <code>mathlib-tools</code> for <code>import-graph</code> <a href="https://github.com/leanprover-community/mathlib-tools/search?q=import-graph">finds only one match in a changelog</a></p>



<a name="217609245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609245">(Nov 23 2020 at 10:10)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib-tools/search?q=ImportGraph"><code>ImportGraph</code></a> finds a slightly better match, but only an unused definition.</p>



<a name="217609341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609341">(Nov 23 2020 at 10:11)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> it really depends on what you want to do. I guess the rendering is what is taking a long time.</p>



<a name="217609364"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609364" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609364">(Nov 23 2020 at 10:11)</a>:</h4>
<p>But if you just want the data, I guess the functions I gave above are a good first start.</p>



<a name="217609367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609367">(Nov 23 2020 at 10:11)</a>:</h4>
<p>The default is <code>.dot</code> though right, which should be trivial to render</p>



<a name="217609377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609377">(Nov 23 2020 at 10:11)</a>:</h4>
<p>Yeah, thanks for the above</p>



<a name="217609449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609449">(Nov 23 2020 at 10:12)</a>:</h4>
<p>Not sure if rendering dot files the size of mathlibs import graph is trivial.</p>



<a name="217609457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609457">(Nov 23 2020 at 10:12)</a>:</h4>
<p>I've never studied graph rendering algorithms</p>



<a name="217609465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609465">(Nov 23 2020 at 10:12)</a>:</h4>
<p>.dot is a text format</p>



<a name="217609478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609478">(Nov 23 2020 at 10:12)</a>:</h4>
<p>I'm not asking it to render the dot</p>



<a name="217609479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609479">(Nov 23 2020 at 10:12)</a>:</h4>
<p>Just write it</p>



<a name="217609502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609502">(Nov 23 2020 at 10:12)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">list_deps</span> <span class="bp">|</span> <span class="n">wc</span> <span class="bp">-</span><span class="n">l</span>
<span class="mi">2779</span>
</code></pre></div>



<a name="217609528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609528">(Nov 23 2020 at 10:13)</a>:</h4>
<p>Although I suppose it might be running the layout engine in advance.</p>



<a name="217609557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609557">(Nov 23 2020 at 10:13)</a>:</h4>
<p>Ooh, so you just want a <code>-&gt;</code> between the source and target, basically. And then a <code>digraph FOOBAR {</code> at the start of  the file, and a <code>}</code> at the end.</p>



<a name="217609579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609579">(Nov 23 2020 at 10:13)</a>:</h4>
<p>Anyway, feel free to improve those bash functions</p>



<a name="217609585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609585">(Nov 23 2020 at 10:13)</a>:</h4>
<p>Not sure I'd go as far as saying that's what I want, but that's what I imagine <code>import-graph</code> already does</p>



<a name="217609643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609643">(Nov 23 2020 at 10:14)</a>:</h4>
<p>I just don't know what it actually does because I've never managed to invoke it successfully</p>



<a name="217609656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609656">(Nov 23 2020 at 10:14)</a>:</h4>
<p>Hence the request for the source</p>



<a name="217609660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609660">(Nov 23 2020 at 10:14)</a>:</h4>
<p><code>leanproject</code> is producing a dot file with layout instructions, not just the raw graph data.</p>



<a name="217609684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217609684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217609684">(Nov 23 2020 at 10:14)</a>:</h4>
<p>Found: <a href="https://github.com/leanprover-community/mathlib-tools/blob/ae9119ced054eb6bec43893b73f832268e495747/mathlibtools/lib.py#L660-L681">https://github.com/leanprover-community/mathlib-tools/blob/ae9119ced054eb6bec43893b73f832268e495747/mathlibtools/lib.py#L660-L681</a></p>



<a name="217621135"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217621135" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217621135">(Nov 23 2020 at 12:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/import.20graph/near/217609130">said</a>:</p>
<blockquote>
<p>Searching <code>mathlib-tools</code> for <code>import-graph</code> <a href="https://github.com/leanprover-community/mathlib-tools/search?q=import-graph">finds only one match in a changelog</a></p>
</blockquote>
<p>What about actually reading that page instead of complaining about GitHub? It says it found two relevant commits.</p>



<a name="217621272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217621272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217621272">(Nov 23 2020 at 12:24)</a>:</h4>
<p>You'll then see that this command runs <code>lean --deps</code> to get reliable import information that regex will never give you. However we are pretty strict in mathlib about import lines formatting so ideally the regex based version should almost give the same information (much much faster).</p>



<a name="217621321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217621321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217621321">(Nov 23 2020 at 12:25)</a>:</h4>
<p>Of course running the full thing on uncompiled mathlib is a very bad idea. But on a compiled mathlib it should take less than 30 seconds.</p>



<a name="217621530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217621530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217621530">(Nov 23 2020 at 12:28)</a>:</h4>
<p>Yeah, the key takeaway here was that <code>.dot</code> output is also doing graph layout, which I wasn't expecting. Using <code>graphml</code> output was much faster</p>



<a name="217621557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217621557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217621557">(Nov 23 2020 at 12:28)</a>:</h4>
<p>Perhaps a compromise regarding docs would be to add an "imports" and "imported by" section to each page?</p>



<a name="217621567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217621567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217621567">(Nov 23 2020 at 12:28)</a>:</h4>
<p>That might help with discovering related lemmas</p>



<a name="217621612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/217621612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#217621612">(Nov 23 2020 at 12:29)</a>:</h4>
<p>I'll have a go at that once a decision is made about <a href="https://github.com/leanprover-community/doc-gen/issues/102">leanprover-community/doc-gen#102</a>, since they'll interact quite a bit and the <code>ImportName</code> object there will help resolve the paths.</p>



<a name="218281703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/218281703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#218281703">(Nov 30 2020 at 12:46)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/import.20graph/near/217621557">said</a>:</p>
<blockquote>
<p>Perhaps a compromise regarding docs would be to add an "imports" and "imported by" section to each page?</p>
</blockquote>
<p>Done in <a href="https://github.com/leanprover-community/doc-gen/issues/103">leanprover-community/doc-gen#103</a></p>



<a name="218309355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/218309355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#218309355">(Nov 30 2020 at 16:23)</a>:</h4>
<p><a href="/user_uploads/3121/Z68oFcIeE7gKTZbpHm492XM9/image.png">image.png</a> </p>
<div class="message_inline_image"><a href="/user_uploads/3121/Z68oFcIeE7gKTZbpHm492XM9/image.png" title="image.png"><img src="/user_uploads/3121/Z68oFcIeE7gKTZbpHm492XM9/image.png"></a></div><p>With thanks to <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> for putting it somewhere sensible on the page</p>



<a name="218309457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/218309457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#218309457">(Nov 30 2020 at 16:24)</a>:</h4>
<p>bit of a funny name</p>



<a name="218309473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/218309473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#218309473">(Nov 30 2020 at 16:24)</a>:</h4>
<p>good name for a band.</p>



<a name="218409397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/218409397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#218409397">(Dec 01 2020 at 11:32)</a>:</h4>
<p>I had a go at building an interactive import graph for my lean project:</p>
<p><a href="https://observablehq.com/@eric-wieser/lean-ga-imports">https://observablehq.com/@eric-wieser/lean-ga-imports</a></p>
<p>I don't know how well this would perform with a full mathlib graph...</p>



<a name="242982970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242982970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242982970">(Jun 17 2021 at 07:41)</a>:</h4>
<p>This visualisation is great! I want to see the full mathlib.</p>



<a name="242983262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242983262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242983262">(Jun 17 2021 at 07:45)</a>:</h4>
<p>But I was having a more pragmatic question: Could we have somewhere in the docs a list of import leaves? I keep encountering files that are never imported and sometimes there's some code that's duplication of a more popular file. So I think that having such a list of orphan files will reduce this accidental duplication, and also provide instantaneous insight so as to where the mathlib frontier is.</p>



<a name="242983358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242983358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242983358">(Jun 17 2021 at 07:46)</a>:</h4>
<p>I think this could fit into a bigger idea of making a list of all <code>src</code> files with a few stats about them (in the same style as the contributors page):</p>
<ul>
<li>number of imports</li>
<li>max depth of import</li>
<li>number of files importing it</li>
<li>max depth of subsequent import</li>
<li>number of lines</li>
<li>number of declarations<br>
...</li>
</ul>



<a name="242983475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242983475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242983475">(Jun 17 2021 at 07:47)</a>:</h4>
<p>Accidental duplication is best addressed by putting content where it is supposed to go, instead of at the top of the file you are working on like some kind of mini <code>for_mathlib</code></p>



<a name="242983629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242983629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242983629">(Jun 17 2021 at 07:49)</a>:</h4>
<p>Yeah of course, but I'm speaking about a retroactive change. Some duplication has already been done and I want to find it out without roaming through all files.</p>



<a name="242983712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242983712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242983712">(Jun 17 2021 at 07:50)</a>:</h4>
<p>if there is any content that is out of place, we should fix that first. Code duplication will become obvious at that point</p>



<a name="242983774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242983774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242983774">(Jun 17 2021 at 07:51)</a>:</h4>
<p>If content is out of place there is no guarantee that it will be in a leaf file, unless you subscribe to the thesis that orphan files are new files and review quality has been decreasing over time</p>



<a name="242983903"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242983903" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242983903">(Jun 17 2021 at 07:53)</a>:</h4>
<p>No, I think orphan files are either new and simply yet to be used anywhere (which is fine) or somewhat old with a drift of interest that means nobody is aware of that file anymore, to the risk of redoing the work.</p>



<a name="242983935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242983935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242983935">(Jun 17 2021 at 07:53)</a>:</h4>
<p>I'm just trying to have an awareness-raising page.</p>



<a name="242984043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984043">(Jun 17 2021 at 07:54)</a>:</h4>
<p>I'm still confused as to how this can happen. If you have the theory of foobars it should be in the <code>algebra.foobar</code> file, and then the next person who wants to do the theory of foobars will write their code, put it in the <code>algebra.foobar</code> file and then notice that it already exists</p>



<a name="242984112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984112">(Jun 17 2021 at 07:55)</a>:</h4>
<p>I have on several occasions proved a theorem only to discover that it already exists because lean tells me there is a name clash</p>



<a name="242984195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984195">(Jun 17 2021 at 07:56)</a>:</h4>
<p>Yeah, but mathematics is the art of giving different names to the same thing <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="242984227"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984227" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984227">(Jun 17 2021 at 07:56)</a>:</h4>
<p>I thought it was the other way around?</p>



<a name="242984281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984281" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984281">(Jun 17 2021 at 07:57)</a>:</h4>
<p>Typically, <code>nat.xgcd</code> and <code>pnat.xgcd</code> are basically the same thing. But they still both exist. <code>nat.xgcd</code> is well incorporated in the import graph. <code>pnat.xgcd</code> is long forgotten.</p>



<a name="242984362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984362">(Jun 17 2021 at 07:58)</a>:</h4>
<p>In those cases, there is a reason for both to exist</p>



<a name="242984395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984395">(Jun 17 2021 at 07:59)</a>:</h4>
<p>and in any case, when you want <code>nat.xgcd</code> you will look for <code>nat.xgcd</code> and find it, similarly for <code>pnat</code></p>



<a name="242984407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984407">(Jun 17 2021 at 07:59)</a>:</h4>
<p>whether or not you knew it existed before you went looking</p>



<a name="242984408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984408">(Jun 17 2021 at 07:59)</a>:</h4>
<p>Well maybe but I have a hard believing that given that in two years nobody has ever used <code>pnat.xgcd</code></p>



<a name="242984448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984448">(Jun 17 2021 at 07:59)</a>:</h4>
<p>I can believe it... both <code>pnat</code> and <code>xgcd</code> are individually rare, so the combination is even more so</p>



<a name="242984606"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984606" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984606">(Jun 17 2021 at 08:01)</a>:</h4>
<p>but it's not like constants are competing to be the most used thing. You use what you need for the task in front of you. If that is <code>pnat.xgcd</code> then nothing else will substitute</p>



<a name="242984608"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984608" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984608">(Jun 17 2021 at 08:01)</a>:</h4>
<p>This for me underlines what the problem with this file is: It's not really about <code>pnat</code>. The use of <code>pnat</code> here is artificial.</p>



<a name="242984739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984739">(Jun 17 2021 at 08:02)</a>:</h4>
<p>And I still don't see why that's an incentive against having a list of orphan files.</p>



<a name="242984793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984793">(Jun 17 2021 at 08:03)</a>:</h4>
<p>what is the putative duplication in this example? Do you think <code>pnat.xgcd</code> does too much work itself instead of delegating to <code>nat.xgcd</code>?</p>



<a name="242984816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984816">(Jun 17 2021 at 08:03)</a>:</h4>
<p>Yes. Or the other way around.</p>



<a name="242984823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984823">(Jun 17 2021 at 08:03)</a>:</h4>
<p>I don't mean to suggest that a list of orphan files isn't useful. I was just responding to the claim about how this relates to code duplication</p>



<a name="242984840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984840">(Jun 17 2021 at 08:03)</a>:</h4>
<p>Okay <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="242984926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984926">(Jun 17 2021 at 08:04)</a>:</h4>
<p>graph depictions of mathlib always end up kind of useless for actual consultation</p>



<a name="242984953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984953">(Jun 17 2021 at 08:05)</a>:</h4>
<p>but a simple database would be easier to work with</p>



<a name="242984960"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242984960" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242984960">(Jun 17 2021 at 08:05)</a>:</h4>
<p>To be fair, I think there's not much code duplication. Mayb some definitions and a few individual lemmas.</p>



<a name="242985006"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242985006" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242985006">(Jun 17 2021 at 08:05)</a>:</h4>
<p>Could one incorporate such a database into a webpage?</p>



<a name="242985080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242985080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242985080">(Jun 17 2021 at 08:06)</a>:</h4>
<p>The <a href="https://leanprover-community.github.io/mathlib_stats.html">contributor table</a> looks pretty nice and databasy</p>



<a name="242985109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242985109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242985109">(Jun 17 2021 at 08:06)</a>:</h4>
<p>Yeah okay. That's exactly what I want!</p>



<a name="242985172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242985172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242985172">(Jun 17 2021 at 08:07)</a>:</h4>
<p>If anybody were to direct me to the relevant resources, I could do my import statistics table myself.</p>



<a name="242985302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242985302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242985302">(Jun 17 2021 at 08:08)</a>:</h4>
<p>I guess you just need the same data set that leancrawler uses (cc: <span class="user-mention" data-user-id="110031">@Patrick Massot</span> )</p>



<a name="242985376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242985376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242985376">(Jun 17 2021 at 08:09)</a>:</h4>
<p>Yeah most probably. But that means we can't update it regularly? Unless we let <code>leanprover_bot</code> do it?</p>



<a name="242985458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242985458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242985458">(Jun 17 2021 at 08:10)</a>:</h4>
<p>it could be incorporated into the community web page and/or docgen</p>



<a name="242987152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242987152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242987152">(Jun 17 2021 at 08:30)</a>:</h4>
<p>Perhaps doc-gen should publish its intermediate export json (which I used in the visualization up thread) to make it easier to perform an analysis of import graphs</p>



<a name="242987178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/242987178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#242987178">(Jun 17 2021 at 08:30)</a>:</h4>
<p>It's probably as easy as adding a <code>cp</code> to the CI script somewhere</p>



<a name="259753421"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259753421" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259753421">(Oct 30 2021 at 21:54)</a>:</h4>
<p>I had a go at making a full mathlib import graph visualization here:</p>
<p><a href="https://eric-wieser.github.io/doc-gen/import-graph.html">https://eric-wieser.github.io/doc-gen/import-graph.html</a></p>
<p>Should this be part of the mathlib docs? Or should doc-gen just host the data file?</p>



<a name="259753725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259753725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259753725">(Oct 30 2021 at 22:00)</a>:</h4>
<p>Okay this is scary. Not sure I want to work on a monster...</p>



<a name="259753813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259753813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259753813">(Oct 30 2021 at 22:01)</a>:</h4>
<p>Did you remove the transitive imports? It might clutter quite a lot.</p>



<a name="259753826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259753826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259753826">(Oct 30 2021 at 22:01)</a>:</h4>
<p>All I removed was <code>core:init.default</code> because that node is stupid</p>



<a name="259753981"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259753981" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259753981">(Oct 30 2021 at 22:04)</a>:</h4>
<p>Fun fact; <code>complete_lattice</code> imports <code>field</code>: <a href="/user_uploads/3121/kLLfy-ub3DXGSoMGVFc9vmco/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/kLLfy-ub3DXGSoMGVFc9vmco/image.png" title="image.png"><img src="/user_uploads/3121/kLLfy-ub3DXGSoMGVFc9vmco/image.png"></a></div>



<a name="259756933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259756933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259756933">(Oct 30 2021 at 23:11)</a>:</h4>
<p>This is a really nice visualization. It's really hard to make any kind of dependency graph visualization that doesn't look like a ball of yarn, but the interactivity helps a lot here</p>



<a name="259757066"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259757066" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259757066">(Oct 30 2021 at 23:14)</a>:</h4>
<p>There's a reasonable amount of power to tweak the cost function along edges with the library I'm using, which helps a little with untangling the ball of yarn. The heuristic is mainly "edges strengths between files are exponential in the number of prefix components they share", which keeps the colors together (but also induces nasty oscillations in the really deep parts of mathlib!)</p>



<a name="259757361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259757361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259757361">(Oct 30 2021 at 23:21)</a>:</h4>
<p>This is very well done, thanks! </p>
<p>I don't have a strong preference regarding where the graph itself should be hosted, but the <a href="https://leanprover-community.github.io/mathlib_stats.html">mathlib stats</a> page should definitely link to the graph.</p>
<blockquote>
<p>Should this be part of the mathlib docs? Or should doc-gen just host the data file?</p>
</blockquote>
<p>I'd just go with whatever is more convenient.</p>



<a name="259757384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259757384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259757384">(Oct 30 2021 at 23:21)</a>:</h4>
<p>I am once again asking you to get bored more often.</p>



<a name="259757875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259757875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259757875">(Oct 30 2021 at 23:33)</a>:</h4>
<p>Let's just do the latter for now: <a href="https://github.com/leanprover-community/doc-gen/issues/142">leanprover-community/doc-gen#142</a></p>



<a name="259830200"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259830200" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259830200">(Nov 01 2021 at 06:09)</a>:</h4>
<p>One idea might be to have a fish-eye lens (en/dis-abled via some checkbox) that can follow the mouse. Does <code>sigma.js</code> support that out of the box?</p>



<a name="259842553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259842553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259842553">(Nov 01 2021 at 09:31)</a>:</h4>
<p>That would be cool, but I highly doubt it is built in, and writing custom GLSL shaders to achieve it is outside the scope of what seems worthwhile</p>



<a name="259849350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259849350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259849350">(Nov 01 2021 at 10:48)</a>:</h4>
<p>I've moved the graph to a standalone repo at <a href="https://github.com/eric-wieser/mathlib-import-graph">https://github.com/eric-wieser/mathlib-import-graph</a> (now live at <a href="https://eric-wieser.github.io/mathlib-import-graph/">https://eric-wieser.github.io/mathlib-import-graph/</a>).</p>
<p>This version now shows some information about how many files are selected, and node sizes reflect file sizes.</p>



<a name="259852936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/259852936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#259852936">(Nov 01 2021 at 11:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="123965">Bryan Gin-ge Chen</span> <a href="#narrow/stream/113488-general/topic/import.20graph/near/259757361">said</a>:</p>
<blockquote>
<p>but the <a href="https://leanprover-community.github.io/mathlib_stats.html">mathlib stats</a> page should definitely link to the graph.</p>
</blockquote>
<p>I made a PR at <a href="https://github.com/leanprover-community/leanprover-community.github.io/issues/218">leanprover-community/leanprover-community.github.io#218</a>. Feel free to adjust.</p>



<a name="294939319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/294939319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#294939319">(Aug 23 2022 at 20:10)</a>:</h4>
<p>So, the import graph is awesome, but there are a few features I think it would be really nice to have. I find that as I have become more accustomed to the library, I have a vague sense of (parts of) the import graph in my head, but sometimes it would be nice to have more specific information. For example, it would be nice to have easy access to each of the following bits of information:</p>
<ol>
<li>which files are direct children or parents of a given file, what about grandchildren and grandparents (i.e., transitive import distance = 2), etc.? I know that the first question can be answered by the docs, and therefore the second also, but the clicking and page loads can be tedious sometimes.</li>
<li>the (transitive) import subgraph of all ancestors, what about all descendents? I know you can see the former in the current import graph, but it would be cool if it could be re-displayed as its own subgraph, perhaps as a DAG.</li>
<li>The subgraph between a node and one of its descendents (again represented as a DAG). This would be especially handy for knowing whether I should try to compile locally, or just push it to the CI runners and wait for the oleans.</li>
</ol>
<p>I have no idea how much work it would be to implement any of these things.</p>



<a name="294939589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/294939589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#294939589">(Aug 23 2022 at 20:13)</a>:</h4>
<p>Are you familiar with the output of <code>leanproject  import-graph --help</code>?</p>



<a name="294939598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/294939598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#294939598">(Aug 23 2022 at 20:13)</a>:</h4>
<p>For 1., you <a href="/user_uploads/3121/sBmyRqWr7faiqb-0FLN9K-7n/image.png">already have it</a>  in the mathlib docs.</p>
<div class="message_inline_image"><a href="/user_uploads/3121/sBmyRqWr7faiqb-0FLN9K-7n/image.png" title="already have it"><img src="/user_uploads/3121/sBmyRqWr7faiqb-0FLN9K-7n/image.png"></a></div>



<a name="294939759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/294939759" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#294939759">(Aug 23 2022 at 20:14)</a>:</h4>
<p>Adding more functionalities to <code>leanproject import-graph</code> is very easy, you can use anything you fancy from <a href="https://networkx.org/">https://networkx.org/</a></p>



<a name="294940507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/294940507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#294940507">(Aug 23 2022 at 20:21)</a>:</h4>
<p>I had no idea <code>leanproject import-graph</code> existed, thanks!</p>



<a name="294949261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/import%20graph/near/294949261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/import.20graph.html#294949261">(Aug 23 2022 at 21:29)</a>:</h4>
<p>Note that there is a gexf file hosted alongside the mathlib docs that contains the graph in a form importable by networkx; which is much faster than building it yourself if you just care about master</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>