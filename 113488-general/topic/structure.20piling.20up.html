---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/structure.20piling.20up.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html">structure piling up</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="204930966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204930966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204930966">(Jul 24 2020 at 15:35)</a>:</h4>
<p>From the beginning, we've known that the current type-class + structure inheritance setup would get out of control when moving to sophisticated mathematics. This is mentioned in Tom's famous blog post for instance. Today I see both a series of Lean4 commits mentioning structures and <a href="https://github.com/leanprover-community/mathlib/pull/3529/files#diff-d27e5e7de2f15fa157a39a865bfec3eaR140-R146">this PR</a> featuring five lines of arguments to a <code>structure</code> command. <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> could you tell us if Lean 4 will make it easier to have abbreviations or other mechanisms that will keep this proliferation under control?</p>



<a name="204932444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204932444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204932444">(Jul 24 2020 at 15:49)</a>:</h4>
<p>It's not clear to me whether you're asking for mere syntactic shortcuts for managing the current approach, or for alternative approaches to hierarchy encoding that avoid the explosion to begin with. Though I guess your answer will be "either of them as long as it works" :) .</p>



<a name="204932584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204932584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204932584">(Jul 24 2020 at 15:50)</a>:</h4>
<p>Either of them, as long as it works.</p>



<a name="204932643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204932643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204932643">(Jul 24 2020 at 15:51)</a>:</h4>
<p>I was thinking about shortcuts here. Alternative approaches could be nice but that's a very different scale.</p>



<a name="204933016"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204933016" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204933016">(Jul 24 2020 at 15:54)</a>:</h4>
<p>Just to bring the code reference out from behind the link, this is the very long <code>structure</code> invocation</p>
<div class="codehilite"><pre><span></span><code><span class="kn">structure</span> <span class="n">Lie_add_group_morphism</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">model_with_corners</span> <span class="err">ùïú</span> <span class="n">E</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="n">I&#39;</span> <span class="o">:</span> <span class="n">model_with_corners</span> <span class="err">ùïú</span> <span class="n">E&#39;</span> <span class="n">E&#39;</span><span class="o">)</span>
<span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">charted_space</span> <span class="n">E</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">smooth_manifold_with_corners</span> <span class="n">I</span> <span class="n">G</span><span class="o">]</span>
<span class="o">[</span><span class="n">add_group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_add_group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">Lie_add_group</span> <span class="n">I</span> <span class="n">G</span><span class="o">]</span>
<span class="o">(</span><span class="n">G&#39;</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">G&#39;</span><span class="o">]</span> <span class="o">[</span><span class="n">charted_space</span> <span class="n">E&#39;</span> <span class="n">G&#39;</span><span class="o">]</span> <span class="o">[</span><span class="n">smooth_manifold_with_corners</span> <span class="n">I&#39;</span> <span class="n">G&#39;</span><span class="o">]</span>
<span class="o">[</span><span class="n">add_group</span> <span class="n">G&#39;</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_add_group</span> <span class="n">G&#39;</span><span class="o">]</span> <span class="o">[</span><span class="n">Lie_add_group</span> <span class="n">I&#39;</span> <span class="n">G&#39;</span><span class="o">]</span> <span class="kn">extends</span> <span class="n">add_monoid_hom</span> <span class="n">G</span> <span class="n">G&#39;</span> <span class="o">:=</span>
  <span class="o">(</span><span class="n">smooth_to_fun</span> <span class="o">:</span> <span class="n">smooth</span> <span class="n">I</span> <span class="n">I&#39;</span> <span class="n">to_fun</span><span class="o">)</span>
</code></pre></div>



<a name="204933099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204933099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204933099">(Jul 24 2020 at 15:55)</a>:</h4>
<p>It should come as no surprise that we are only implementing the "new" structure command in Lean 4, so if mathlib wants to keep the current encoding, someone else would have to implement that alternative command. But before someone starts working on that, I would really like to have a discussion on whether that approach is still the way to go. For example, I'm not sure if there has been any consensus on whether <span class="user-mention" data-user-id="110193">@Cyril Cohen</span>'s work on forgetful inheritance could be a better way forward for mathlib - especially when code has to be adapted to Lean 4 anyway.</p>



<a name="204933435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204933435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204933435">(Jul 24 2020 at 15:58)</a>:</h4>
<p>What work by Cyril are you referring to?</p>



<a name="204934051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204934051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204934051">(Jul 24 2020 at 16:04)</a>:</h4>
<p>He talked about it at Lean Together, but the most recent revision should be <a href="https://math-comp.github.io/competing-inheritance-paths-in-dependent-type-theory/">https://math-comp.github.io/competing-inheritance-paths-in-dependent-type-theory/</a></p>



<a name="204934083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204934083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204934083">(Jul 24 2020 at 16:04)</a>:</h4>
<p>Ok, then I don't understand why you say mathlib doesn't do that.</p>



<a name="204934088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204934088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204934088">(Jul 24 2020 at 16:04)</a>:</h4>
<p>Are you thinking of the (related but different) hierarchy builder tool? <a href="https://hal.inria.fr/hal-02478907/file/hb.pdf">https://hal.inria.fr/hal-02478907/file/hb.pdf</a></p>



<a name="204934637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204934637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204934637">(Jul 24 2020 at 16:09)</a>:</h4>
<p>That would make more sense.</p>



<a name="204934764"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204934764" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204934764">(Jul 24 2020 at 16:10)</a>:</h4>
<p>I have no idea which one is more relevant and applicable at this point, haha. I haven't read the papers yet and hoped someone else would do that and tell us what they think...</p>



<a name="204935293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204935293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204935293">(Jul 24 2020 at 16:15)</a>:</h4>
<p>I'd love to see something like their hierarchy builder used in Lean, and indeed this kind of layer should make the difference between old and new structure irrelevant. But I guess the adaptation wouldn't be straightforward, if only because of unification hint vs type class.</p>



<a name="204936514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204936514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204936514">(Jul 24 2020 at 16:26)</a>:</h4>
<p>The conclusion is very optimistic about adapting their work to different targets.</p>



<a name="204939040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204939040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204939040">(Jul 24 2020 at 16:47)</a>:</h4>
<p>Coming back to syntactic shortcuts, there is a nice GHC extension that lets you define typeclass constraint synonyms such as</p>
<div class="codehilite"><pre><span></span><code><span class="kr">type</span> <span class="kt">Stringy</span> <span class="n">a</span> <span class="ow">=</span> <span class="p">(</span><span class="kt">Read</span> <span class="n">a</span><span class="p">,</span> <span class="kt">Show</span> <span class="n">a</span><span class="p">)</span>
<span class="nf">foo</span> <span class="ow">::</span> <span class="kt">Stringy</span> <span class="n">a</span> <span class="ow">=&gt;</span> <span class="o">...</span>
<span class="nf">foo</span> <span class="o">...</span>  <span class="c1">-- can use both `Read a` and `Show a`</span>
</code></pre></div>


<p>It's kind of like a macro (it doesn't declare an actual new typeclass), but not quite. I'm not sure how it should be implemented in Lean 4, or even what the syntax should be.</p>



<a name="204939173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204939173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204939173">(Jul 24 2020 at 16:48)</a>:</h4>
<p>I sounds like what I had in mind (and of course I have no opinion on implementation).</p>



<a name="204939376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204939376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204939376">(Jul 24 2020 at 16:50)</a>:</h4>
<p>The following was very noticeable in Sebastien's talk: he had a field k, a topological space X, and three or so other mathematical objects, and then for many of the subsets of his collection of objects he had another typeclass (like M being an R-module etc) and somehow the statement of the result took a long time coming. But on the other hand I'm assuming a lot of this is being done with variables if you actually look at the source code</p>



<a name="204939718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204939718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204939718">(Jul 24 2020 at 16:53)</a>:</h4>
<blockquote>
<p>typeclass constraint synonyms</p>
</blockquote>
<p>We can already do this in Lean 4 because TC synthesis has loop checking, right?</p>
<div class="codehilite"><pre><span></span><code><span class="n">class</span> <span class="n">Stringy</span> <span class="o">(</span><span class="n">A</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">Read</span> <span class="n">A</span><span class="o">,</span> <span class="n">Show</span> <span class="n">A</span><span class="bp">.</span>
<span class="kn">instance</span> <span class="o">{</span><span class="n">A</span><span class="o">}</span> <span class="o">[</span><span class="n">Read</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">Show</span> <span class="n">A</span><span class="o">]</span> <span class="o">:</span> <span class="n">Stringy</span> <span class="n">A</span> <span class="o">:=</span> <span class="bp">‚ü®_</span><span class="o">,</span> <span class="bp">_‚ü©</span>
</code></pre></div>



<a name="204940367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204940367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204940367">(Jul 24 2020 at 16:59)</a>:</h4>
<p>But this kind of synonyms don't really help for the issues we have in mathlib.  For example, if you want two vector spaces over the same field, then <code>[VectorSpace V1] [VectorSpace V2]</code> does not help you.  You need to be able to say that they have the same field structure:</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">foo</span> <span class="o">{</span><span class="n">K</span> <span class="n">V1</span> <span class="n">V2</span><span class="o">}</span> <span class="o">[</span><span class="n">Field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">VectorSpace</span> <span class="n">K</span> <span class="n">V1</span><span class="o">]</span> <span class="o">[</span><span class="n">VectorSpace</span> <span class="n">K</span> <span class="n">V2</span><span class="o">]</span> <span class="o">:=</span> <span class="bp">...</span>
</code></pre></div>



<a name="204940511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204940511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204940511">(Jul 24 2020 at 17:00)</a>:</h4>
<p>(deleted)</p>



<a name="204940628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204940628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204940628">(Jul 24 2020 at 17:01)</a>:</h4>
<p>But will it help for <code>[topological_ring R]</code>?<br>
Currently that is: <code>{R : Type*} [ring R] [topological_space R] [topological_ring R]</code></p>



<a name="204940832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204940832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204940832">(Jul 24 2020 at 17:03)</a>:</h4>
<p>Maybe we should say this explicitly: <code>topological_ring R</code> is actually <code>@topological_ring R _inst_1 _inst_2</code>.<br>
Similarly vector spaces also have the field as an instance argument.</p>



<a name="204943179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204943179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204943179">(Jul 24 2020 at 17:25)</a>:</h4>
<p>Right, but actually in your vector space example, it's similar. <code>vector_space K V</code> should only introduce the <code>K</code> if it isn't known yet. (Note that the <code>K</code> is an explicit argument right now, in mathlib.)</p>



<a name="204951021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204951021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204951021">(Jul 24 2020 at 18:31)</a>:</h4>
<p>How should the basic algebraic hierarchy work with the new structure cmd?</p>



<a name="204951113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204951113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204951113">(Jul 24 2020 at 18:32)</a>:</h4>
<p>E.g., currently <a href="https://leanprover-community.github.io/mathlib_docs/find/comm_group/src">src#comm_group</a> extends <a href="https://leanprover-community.github.io/mathlib_docs/find/group/src">src#group</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/comm_monoid/src">src#comm_monoid</a></p>



<a name="204953313"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204953313" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204953313">(Jul 24 2020 at 18:54)</a>:</h4>
<p>How about?</p>
<div class="codehilite"><pre><span></span><code><span class="n">class</span> <span class="n">monoid</span> <span class="o">(</span><span class="n">Œ±</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">has_mul</span> <span class="n">Œ±</span>
<span class="n">class</span> <span class="n">group</span> <span class="o">(</span><span class="n">Œ±</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">monoid</span> <span class="n">Œ±</span>
<span class="n">class</span> <span class="n">commutative</span> <span class="o">(</span><span class="n">Œ±</span><span class="o">)</span> <span class="o">[</span><span class="n">has_mul</span> <span class="n">Œ±</span><span class="o">]</span>

<span class="n">class</span> <span class="n">comm_monoid</span> <span class="o">(</span><span class="n">Œ±</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">monoid</span> <span class="n">Œ±</span><span class="o">,</span> <span class="n">commutative</span> <span class="n">Œ±</span>
<span class="kn">instance</span> <span class="o">[</span><span class="n">monoid</span> <span class="n">Œ±</span><span class="o">]</span> <span class="o">[</span><span class="n">commutative</span> <span class="n">Œ±</span><span class="o">]</span> <span class="o">:</span> <span class="n">comm_monoid</span> <span class="n">Œ±</span>

<span class="n">class</span> <span class="n">comm_group</span> <span class="o">(</span><span class="n">Œ±</span><span class="o">)</span> <span class="kn">extends</span> <span class="n">group</span> <span class="n">Œ±</span><span class="o">,</span> <span class="n">commutative</span> <span class="n">Œ±</span>
<span class="kn">instance</span> <span class="o">[</span><span class="n">group</span> <span class="n">Œ±</span><span class="o">]</span> <span class="o">[</span><span class="n">commutative</span> <span class="n">Œ±</span><span class="o">]</span> <span class="o">:</span> <span class="n">comm_group</span> <span class="n">Œ±</span>
</code></pre></div>



<a name="204967004"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204967004" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204967004">(Jul 24 2020 at 21:07)</a>:</h4>
<p>And how does topological ring look?</p>



<a name="204991489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204991489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204991489">(Jul 25 2020 at 06:45)</a>:</h4>
<p>A possibility would be to have the following:</p>
<ul>
<li>We have syntatic classes <code>[has_zero Œ±]</code>, <code>[has_one Œ±]</code>, <code>[has_add Œ±]</code> and so on</li>
<li>No class extends these, they take them as instance parameters. In other words, other algebraic classes only have Prop in them</li>
<li>This would mean that to declare a ring <code>R</code>, we would need <code>[has_zero R] [has_one R] [has_add R] [has_mul R] [ring R]</code>, which is unbearable. Introduce a new kind of instance declaration <code>[[ring R]]</code> (or with beautiful unicode) that adds missing instances to the context (but only missing instances, i.e., if there is already a <code>[has_zero R]</code> it wouldn't add it). </li>
</ul>
<p>This would solve the old type/new type structure, as the problem with new type structures is only with shared data field, that would be (shared) instance parameters now. And it would be a progress over what we have even now: to define a topological group <code>G</code>, one needs currently to write <code>[group G] [topological_space G] [topological_group G]</code>, and it could be replaced with <code>[[topological_group G]]</code>. The gain for Lie groups, as <span class="user-mention" data-user-id="110031">@Patrick Massot</span>  was mentioning, would be even bigger.</p>
<p>Of course, I have no idea how hard it would be to implement this, but it doesn't seem crazy: Lean can already can tell us which instances are missing.</p>



<a name="204991647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204991647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204991647">(Jul 25 2020 at 06:50)</a>:</h4>
<p>I guess one can try to write the new kind of instance declaration already, without refactoring things into syntax and props</p>



<a name="204991700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204991700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204991700">(Jul 25 2020 at 06:52)</a>:</h4>
<p>My 2c: let's not radically change the entire algebraic hierarchy during the port</p>



<a name="204991754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204991754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204991754">(Jul 25 2020 at 06:54)</a>:</h4>
<p>see also <a href="#narrow/stream/113488-general/topic/XenaProject.20blog.20posts/near/204514809">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/XenaProject.20blog.20posts/near/204514809</a></p>



<a name="204991766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204991766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204991766">(Jul 25 2020 at 06:55)</a>:</h4>
<p>I think we should just try to recreate <code>old_structure_cmd</code>, either manually (writing all the fields out) or via a tactic or attribute</p>



<a name="204991827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204991827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204991827">(Jul 25 2020 at 06:57)</a>:</h4>
<p>I don't think it deserved to get deprecated in the first place, much less removed</p>



<a name="204995594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204995594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204995594">(Jul 25 2020 at 08:59)</a>:</h4>
<p>We could radically change the entire algebraic hierarchy _before_ the port. :-)</p>



<a name="204995598"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/204995598" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#204995598">(Jul 25 2020 at 09:00)</a>:</h4>
<p>But let's finish the current bundled/unbundled project first.</p>



<a name="205005562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205005562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205005562">(Jul 25 2020 at 14:14)</a>:</h4>
<p>Wouldn't this also solve many problems with diamonds for which Lean has a hard time figuring out that they're defeq, as Prop diamonds are obviously defeq without unfolding anything?</p>



<a name="205011805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205011805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205011805">(Jul 25 2020 at 16:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/structure.20piling.20up/near/204991766">said</a>:</p>
<blockquote>
<p>I think we should just try to recreate <code>old_structure_cmd</code>, either manually (writing all the fields out) or via a tactic or attribute</p>
</blockquote>
<p>Oh I agree completely; it might be sufficient to build a slighty more rudimentary version when switching away from it is planned anyway, but porting must be as automated as possible to succeed.</p>



<a name="205012082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012082">(Jul 25 2020 at 17:02)</a>:</h4>
<p>I remain unconvinced that something much different than the current structure is going to solve mathlib's problems better than what we already have. Any alternatives need to be tested on at least medium scale (involving class definitions, generic theorems, instance constructions and applications of general theorems to specific instances) and quantitatively compared to the status quo. There are just too many ideas to try and a high switching cost, so I don't want to move in another direction until we have concrete evidence it's going to be better when we get there</p>



<a name="205012358"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012358" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012358">(Jul 25 2020 at 17:09)</a>:</h4>
<p>Mario, did you read Cyril's paper (the hierarchy builder one, not the forgetful inheritance one)? I only had a very quick look at the pdf on my phone in addition to attending his Pittsburgh talk, but it seems very sensible. It really sounds right to me that we need an abstraction layer here, hiding the actual implementation as much as possible, and putting alternate constructors on the same footing as the constructors coming from the actual implementation. Going beyond that paper, I think all this tricky business of deciding what should be a parameter and what should be extended should be completely hidden from users. We should have some meta-program reading a mathematical description of structures and doing all the tricky stuff, including defining bundled versions, morphisms and subobjects.</p>



<a name="205012412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012412">(Jul 25 2020 at 17:10)</a>:</h4>
<p>Such a think is necessarily part of the future of proof assistants, together with the proof automation tools, if proofs assistants want to ever become a common and useful tool for mathematics.</p>



<a name="205012494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012494">(Jul 25 2020 at 17:12)</a>:</h4>
<p>I think that ideas are cheap and effective implementation in the context of a real library is much more expensive</p>



<a name="205012506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012506">(Jul 25 2020 at 17:12)</a>:</h4>
<p>Do you really intended to write publicly that mathcomp is not a real library?</p>



<a name="205012508"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012508" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012508">(Jul 25 2020 at 17:12)</a>:</h4>
<p>A good idea is only the first stage. Compare it to a drug trial</p>



<a name="205012524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012524">(Jul 25 2020 at 17:13)</a>:</h4>
<p>Because it seems that Cyril's stuff has already been tested at this scale (or maybe I read too quickly).</p>



<a name="205012555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012555">(Jul 25 2020 at 17:14)</a>:</h4>
<p>And I never wrote this was easy. I wrote this is necessary. Maybe it will never happen, and then proof assistants will never be usable.</p>



<a name="205012582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012582">(Jul 25 2020 at 17:14)</a>:</h4>
<p>Also keep in mind that these decisions are very sensitive to details of the underlying architecture. The fact that typeclass inference in lean 4 is going to be cheaper will already significantly change the calculus, and we may find some other approach, using more typeclasses, performing better</p>



<a name="205012629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012629">(Jul 25 2020 at 17:15)</a>:</h4>
<p>Cyril and his coauthors claim that there stuff is not even sensitive to whether you use unification hints or type classes (although their implementation is obviously full unification hints).</p>



<a name="205012632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012632">(Jul 25 2020 at 17:15)</a>:</h4>
<p>That means that you might choose a different implementation that translates the abstract description of the hierarchy to Lean 4 code</p>



<a name="205012647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012647">(Jul 25 2020 at 17:15)</a>:</h4>
<p>I don't think the hierarchy builder is used in mathcomp releases yet (which I don't say to make any claim about its effectiveness!).</p>



<a name="205012728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012728">(Jul 25 2020 at 17:17)</a>:</h4>
<p>I certainly don't expect such a tool to reach the mathcomp release stage in less than a couple of years. That's not really the mathcomp speed I think.</p>



<a name="205012774"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012774" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012774">(Jul 25 2020 at 17:18)</a>:</h4>
<p>It doesn't mean they didn't recreate the full mathcomp hierarchy using it.</p>



<a name="205012781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012781">(Jul 25 2020 at 17:18)</a>:</h4>
<p>Even if it gets deployed in mathcomp, that doesn't say much about whether it will do well in lean 3 mathlib, or lean 4 mathlib. These are different environments and need separate testing</p>



<a name="205012796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012796">(Jul 25 2020 at 17:19)</a>:</h4>
<p>To emphasize, I'm not making any judgment of the effectiveness of the idea. I'm saying that we will not know whether it works in lean until we try it in lean</p>



<a name="205012904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205012904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205012904">(Jul 25 2020 at 17:22)</a>:</h4>
<p>I agree that alternate constructors should not be second class citizens. I see this as a flaw in lean 3 that can hopefully be addressed in lean 4, but it doesn't require any hierarchy changes</p>



<a name="205013095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205013095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205013095">(Jul 25 2020 at 17:28)</a>:</h4>
<p>Just having <code>[[topological_group G]]</code> mean "introduce all the instances that are missing to make sense of <code>[topological_group G]</code>" (here <code>[group G]</code> and <code>[topological_space G]</code>) would make things way less verbose, and it doesn't require any change to the current hierarchy.</p>



<a name="205013173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205013173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205013173">(Jul 25 2020 at 17:31)</a>:</h4>
<p>There was an old lean PR about this</p>



<a name="205013219"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205013219" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205013219">(Jul 25 2020 at 17:32)</a>:</h4>
<p><a href="https://github.com/leanprover/lean/issues/1522">leanprover/lean#1522</a></p>



<a name="205013403"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205013403" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205013403">(Jul 25 2020 at 17:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/structure.20piling.20up/near/205012494">said</a>:</p>
<blockquote>
<p>I think that ideas are cheap and effective implementation in the context of a real library is much more expensive</p>
</blockquote>
<p>Mario, just in case Cyril or his coauthors ever read this thread, could you clarify whether this is a comment on my general assertion that something like their work is needed or your assessment of their published paper on this topic?</p>



<a name="205013536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205013536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205013536">(Jul 25 2020 at 17:40)</a>:</h4>
<p>Neither, it's even more general than that. Any idea at all that has aspirations to replace mathlib's algebraic hierarchy requires evidence that it is going to work beforehand because it's a huge project</p>



<a name="205013562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205013562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205013562">(Jul 25 2020 at 17:41)</a>:</h4>
<p>and evidence that it works in Coq doesn't suffice here because Coq is not lean, it differs in many technical details that matter for the determination</p>



<a name="205014078"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014078" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014078">(Jul 25 2020 at 17:55)</a>:</h4>
<p>Looking at Cyril et al's hierarchy builder paper, it looks like a boilerplate elimination tactic for declaring a mathcomp style hierarchy. We could certainly have a boilerplate elimination tactic for declaring a mathlib style hierarchy, but this seems to have a large overlap with what lean's native <code>structure</code> command already does, and I don't think that the mathlib hierarchy actually has all that much boilerplate to eliminate</p>



<a name="205014181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014181">(Jul 25 2020 at 17:57)</a>:</h4>
<p>If we start writing flat structures by hand because leo doesn't want to support them anymore, well that will be some boilerplate that we will want to eliminate (although actually we already know that it's not as simple as this because subclasses can often prove fields of superclasses)</p>



<a name="205014256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014256">(Jul 25 2020 at 17:59)</a>:</h4>
<p>It would be nice to have some meta program generating <code>sub*</code> structures, or at least boilerplate theory (<code>complete_lattice</code>, <code>map</code>, <code>comap</code>).</p>



<a name="205014350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014350">(Jul 25 2020 at 18:01)</a>:</h4>
<p>I think there is a general theory of such structures (universal algebra? varieties?) that can be put into a tactic to do this kind of thing</p>



<a name="205014457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014457">(Jul 25 2020 at 18:03)</a>:</h4>
<p>It might be good to define the general theory even if it's a little hard to instantiate (for example, you provide a signature for the language and a family of equations) so that we can apply it manually and then eventually with tactics</p>



<a name="205014476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014476">(Jul 25 2020 at 18:03)</a>:</h4>
<p>Note that <span class="user-mention" data-user-id="210057">@Fabian Gl√∂ckle</span> wrote a large part of such a meta program already</p>



<a name="205014487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014487">(Jul 25 2020 at 18:04)</a>:</h4>
<p>It can generate bundled homs and concrete category instances as well.</p>



<a name="205014523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014523">(Jul 25 2020 at 18:04)</a>:</h4>
<p>Note that we want to reuse our bundled homs for groups.</p>



<a name="205014537"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014537" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014537">(Jul 25 2020 at 18:05)</a>:</h4>
<p>it's little things like that that make me dubious about boilerplate eliminating tactics in general</p>



<a name="205014541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014541">(Jul 25 2020 at 18:05)</a>:</h4>
<p>because when you look carefully, it's not actually boilerplate, it's just slightly lower entropy text</p>



<a name="205014599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205014599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205014599">(Jul 25 2020 at 18:06)</a>:</h4>
<p>and capturing the patterns while allowing all the variations can be much more complicated than the original boilerplate</p>



<a name="205077666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205077666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Utensil Song <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205077666">(Jul 27 2020 at 02:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/113488-general/topic/structure.20piling.20up/near/204995598">said</a>:</p>
<blockquote>
<p>But let's finish the current bundled/unbundled project first.</p>
</blockquote>
<p>Where can I learn more about "the current bundled/unbundled project"?</p>



<a name="205077735"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205077735" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jalex Stark <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205077735">(Jul 27 2020 at 02:39)</a>:</h4>
<p>see e.g. <a href="https://github.com/leanprover-community/mathlib/issues/3321">#3321</a></p>



<a name="205078232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205078232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205078232">(Jul 27 2020 at 02:57)</a>:</h4>
<p>The basic goal is to delete the files under <code>src/deprecated/</code>. That's too much to do all in one go, so that idea is to find places where we can reduce dependencies on these files.</p>



<a name="205078242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205078242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205078242">(Jul 27 2020 at 02:57)</a>:</h4>
<p>Additionally, someone still needs to write <code>subring</code>, folllowing the model of <code>subsemiring</code>, and move the current file about <code>is_subring</code> into <code>deprecated/</code>.</p>



<a name="205081221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205081221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205081221">(Jul 27 2020 at 04:36)</a>:</h4>
<p>And <code>subfield</code>!</p>



<a name="205087800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205087800" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205087800">(Jul 27 2020 at 07:25)</a>:</h4>
<p>I might have a student working on <code>subring</code> -- I'll report back today</p>



<a name="205094031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/205094031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#205094031">(Jul 27 2020 at 09:01)</a>:</h4>
<p>I haven't been paying attention to this bundling fashion. Is there any place to read about the goals of all this? In particular, how does the bundled subgroup perform in the third isomorphism grand challenge?</p>



<a name="206049558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/structure%20piling%20up/near/206049558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/structure.20piling.20up.html#206049558">(Aug 05 2020 at 17:07)</a>:</h4>
<p>If the challenge is just to formalise the 3rd isom theorem, we have it now (using bundled subgroups and bundled normal subgroups) in the group theory game (which is not a game at all right now, it's just an independent formalisation of the basics of group theory in Lean). It's <a href="https://github.com/ImperialCollegeLondon/group-theory-game/blob/7d6392ba1a66d9f9c26f025edde8768479d2e432/src/hom/theorems.lean#L674-L682">here</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>