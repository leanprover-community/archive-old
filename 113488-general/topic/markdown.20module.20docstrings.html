---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/markdown.20module.20docstrings.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html">markdown module docstrings</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="179874075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179874075">(Nov 04 2019 at 20:41)</a>:</h4>
<p>Noob question. </p>
<p>Since we're writing all these docstrings at the top of <code>.lean</code> files in mathlib in markdown, presumably there's an easy way to see the markdown? What does <code>/-! -/</code> do?</p>



<a name="179874450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179874450">(Nov 04 2019 at 20:45)</a>:</h4>
<p>Nothing useful with Lean 3.4.2 -- I think there's something missing from the API that's either fixed or fixable in the community fork. They're docstrings associated with the file instead of a particular declaration, and metaprograms can in principle access them.</p>



<a name="179874510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179874510">(Nov 04 2019 at 20:46)</a>:</h4>
<p>IIRC in 3.4.2 you can only get the docstring for the current file.</p>



<a name="179874558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179874558">(Nov 04 2019 at 20:46)</a>:</h4>
<p>It's more of a future-proofing thing. At some point we'll want to generate HTML docs for the library, and having the comments already in markdown will be convenient then.</p>



<a name="179874689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179874689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179874689">(Nov 04 2019 at 20:48)</a>:</h4>
<p>It might actually be a useful VSCode plugin to format and display the module doc for the current file when you press a button.</p>



<a name="179909843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179909843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179909843">(Nov 05 2019 at 08:10)</a>:</h4>
<p>You can see lean 3.4.2's tests <a href="https://github.com/leanprover/lean/blob/ceacfa7445953cbc8860ddabc55407430a9ca5c3/tests/lean/run/doc_string3.lean" target="_blank" title="https://github.com/leanprover/lean/blob/ceacfa7445953cbc8860ddabc55407430a9ca5c3/tests/lean/run/doc_string3.lean">doc_string3.lean</a> for the extent of the non-community edition support e.g. there are some tactics for printing out the doc_strings.</p>
<p>I haven't tested if lumpy-leandoc does the right thing for <code>/-! -/</code> yet (edit: it should work)... but it'd be very easy to add something which extracts the .md file to it in addition to the limited html/pdf stuff it currently does.</p>



<a name="179972494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179972494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179972494">(Nov 05 2019 at 20:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span>  I fixed up lumpy so it could build mathlib again, <a href="https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip" target="_blank" title="https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip">mathlib-docs.zip</a></p>
<p>Rob Lewis seems correct in that it's not useful with 3.4.2 in lumpy at least, the <code>/-! -/</code> comments never make it to the output, so <code>/-! -/</code> only shows up when the lean files were built with the community edition.</p>
<p>The way lumpy treats <code>/-! -/</code> is to include it verbatim, i.e. It doesn't prepend it with the name of the definition to which the doc_string is associated, because it's generally just associated with the section that corresponds to the file.<br>
Hopefully that helps.</p>



<a name="179973162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179973162">(Nov 05 2019 at 20:25)</a>:</h4>
<p>That's actually closer to real doc generation than I realized we were.</p>



<a name="179973228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179973228">(Nov 05 2019 at 20:26)</a>:</h4>
<p>It seems to be treating the sections of module docs as sections of the document, which is very confusing.</p>



<a name="179973242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179973242">(Nov 05 2019 at 20:26)</a>:</h4>
<p>But the core structure is there.</p>



<a name="179973394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179973394">(Nov 05 2019 at 20:28)</a>:</h4>
<blockquote>
<p>It seems to be treating the sections of module docs as sections of the document, which is very confusing.</p>
</blockquote>
<p>In the PDF, that is. The HTML looks better, except it doesn't print the def names? Which do appear in the PDF?</p>



<a name="179973423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179973423">(Nov 05 2019 at 20:28)</a>:</h4>
<p>Yeah, it's because I was following the html -&gt; tex convention that e.g. &lt;h1&gt; corresponds to \chapter &lt;h2&gt; \section etc, and the docs aren't really built with that in mind</p>



<a name="179973712"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973712" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179973712">(Nov 05 2019 at 20:29)</a>:</h4>
<p>Yeah, this was the forseeable problem with creating the doc standards before we could generate docs.</p>



<a name="179973891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179973891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179973891">(Nov 05 2019 at 20:31)</a>:</h4>
<p>Yup, I haven't done a lot of work on the html generation (or in fact looked at it today), it should in theory be easy to add unless i have forgotten why it is missing, I will try and look at it again tomorrow and fix that if I can.</p>



<a name="179974669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179974669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179974669">(Nov 05 2019 at 20:37)</a>:</h4>
<p>Cool. What are the prospects for linking? Something like this: "if an identifier appears between backticks, and we've seen a declaration with that name, turn it into a link." I'm guessing that's way more work?</p>



<a name="179975772"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179975772" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179975772">(Nov 05 2019 at 20:48)</a>:</h4>
<p>Something like that, It'll need some thought, as it parses all lean files in parallel currently, so i'll probably have to do a pass over declarations build a table of declarations first before generating links (I'm guessing we want to link across files, which means we also need to mirror the import behavior I suppose)... <span aria-label="octopus" class="emoji emoji-1f419" role="img" title="octopus">:octopus:</span></p>



<a name="179976376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179976376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179976376">(Nov 05 2019 at 20:54)</a>:</h4>
<p>With two passes I think you could ignore the import tree. Generate a table the first pass, and note which html file each declaration will live in. Then fill in the info in the second pass. Namespacing means this will be impossible to get exactly right though. There's no way doc strings will be consistent about referring to declarations with full namespaces, and there will be ambiguous cases.</p>



<a name="179976846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179976846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179976846">(Nov 05 2019 at 20:58)</a>:</h4>
<p>yeah, shall see if we can get away with that, anyhow i must get going.</p>



<a name="179977349"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/179977349" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#179977349">(Nov 05 2019 at 21:02)</a>:</h4>
<p>Thanks for looking into this! It would be great to generate HTML docs for the website and this isn't so far off.</p>



<a name="180013747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180013747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180013747">(Nov 06 2019 at 09:10)</a>:</h4>
<p>Well, i updated it (and the zip file) to add the names of declarations, and a horizontal rule separating the header.</p>
<p>I think i will look at making TeX rendering optional, because the output isn't ready for consumption and it makes integrating into CI difficult since it needs lots of font stuff compiled in a specific way... With that it'll hopefully be easier to integrate into the website...</p>



<a name="180015725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180015725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180015725">(Nov 06 2019 at 09:41)</a>:</h4>
<p>Nice! I just checked out a couple of the better documented files. It looks great. <a href="https://leanprover-community.github.io/doc_demo/manifold.html" target="_blank" title="https://leanprover-community.github.io/doc_demo/manifold.html">https://leanprover-community.github.io/doc_demo/manifold.html</a></p>



<a name="180015788"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180015788" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180015788">(Nov 06 2019 at 09:42)</a>:</h4>
<p>What about printing the type of the declaration along with the name?</p>



<a name="180015988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180015988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180015988">(Nov 06 2019 at 09:45)</a>:</h4>
<p>Right now it only prints declarations that have docstrings, right? Our doc guidelines don't require them for theorems, since in principle all you need to know about a theorem is its statement. Complicated/big/important theorems should have docstrings anyway, but we probably want more than just those in the doc output.</p>



<a name="180016062"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016062" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180016062">(Nov 06 2019 at 09:46)</a>:</h4>
<p>Is it overkill to print everything in the html docs? It feels to me like it should describe a "public" API, and there are plenty of things in the library that don't need to show up there. But I'm not sure.</p>



<a name="180016089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180016089">(Nov 06 2019 at 09:47)</a>:</h4>
<p><span class="user-mention" data-user-id="143402">@matt rice</span> Wow, that looks really good</p>



<a name="180016121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180016121">(Nov 06 2019 at 09:47)</a>:</h4>
<p>The <code>&lt;div&gt;</code>s containing the declarations should have a class so we can style it better, but that's easy.</p>



<a name="180016221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180016221">(Nov 06 2019 at 09:48)</a>:</h4>
<p>Also we need index pages. Also easy, I hope :)</p>



<a name="180016492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180016492">(Nov 06 2019 at 09:53)</a>:</h4>
<p>Once this is up and running, it gives another argument for a mathlib release schedule. We could update the docs daily. But it would probably be clearer to have fixed versions.</p>



<a name="180016758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180016758">(Nov 06 2019 at 09:57)</a>:</h4>
<p>I will look at printing the type declaration, it's been on my list of things to do, but I have been scared that it's just going to give me the thing that the type is definitionally equal to, since i'm pulling it out of the bytecode :D</p>
<p>I don't know anything about html really, i'll try and figure out the div's class, I assume i need to declare some empty style e.g. decl and then give it the class decl?</p>
<p>I also wish I could style the syntax highlighting rather than hard coded colors, but that is going to take some work.</p>



<a name="180016968"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180016968" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180016968">(Nov 06 2019 at 10:00)</a>:</h4>
<p>For the div classes, the easy part is printing <code>&lt;div class="decl"&gt;</code> instead of just <code>&lt;div&gt;</code>. Then someone needs to add a css file that styles them properly, which we probably want to integrate with the rest of the website.</p>



<a name="180017067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180017067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180017067">(Nov 06 2019 at 10:01)</a>:</h4>
<p>I suspect you'll get a presentable type, but I don't know.</p>



<a name="180017119"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180017119" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180017119">(Nov 06 2019 at 10:02)</a>:</h4>
<p>index should be easy it's already in a big table just need to enumerate the keys of.</p>



<a name="180017183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180017183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180017183">(Nov 06 2019 at 10:03)</a>:</h4>
<p>Can you use pygments to generate highlighted code?</p>



<a name="180017397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180017397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180017397">(Nov 06 2019 at 10:06)</a>:</h4>
<p>it's currently using <a href="https://docs.rs/syntect/3.3.0/syntect/" target="_blank" title="https://docs.rs/syntect/3.3.0/syntect/">syntect</a> with a conversion of the vscode syntax highlighting, I haven't really compared to how vscode gets highlighted yet to see if that conversion is accurate though.</p>
<p>Using pygments would be a big change.  Part of the reason i chose syntect is so i can compile the whole thing to web assembly eventually and not shell out to stuff.</p>



<a name="180017547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180017547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180017547">(Nov 06 2019 at 10:09)</a>:</h4>
<p>Aha... <code>pandoc</code> uses pygments, and so does Zulip. I don't know syntect.</p>



<a name="180017786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180017786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180017786">(Nov 06 2019 at 10:13)</a>:</h4>
<p>For the syntax highlighting, we could at least move the style definition to a separate css file, so the colors are specified once instead of every time code is displayed.</p>



<a name="180017864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180017864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180017864">(Nov 06 2019 at 10:14)</a>:</h4>
<p>The Zulip archive lets Zulip do the structuring (with pygments, I think?) and then copies the Zulip CSS to display it.</p>



<a name="180018014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018014">(Nov 06 2019 at 10:17)</a>:</h4>
<p>I don't know how different the syntect structuring is, presumably it's not compatible. But we should be able to manually match the colors for analogous items.</p>



<a name="180018089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018089">(Nov 06 2019 at 10:18)</a>:</h4>
<p>Yeah, the problem is the syntax highlighter hard coding the colors, the current solution to this is to hard code the colors for each thing to a specific unique value and then sniff the colors and turn them into the appropriate CSS.  Ideally I would like to just get it to emit CSS directly.</p>



<a name="180018120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018120">(Nov 06 2019 at 10:19)</a>:</h4>
<p>Oh, I see. That's kind of annoying.</p>



<a name="180018230"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018230" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018230">(Nov 06 2019 at 10:20)</a>:</h4>
<p>Yeah, there should be a way to do it, but this was easy to add as a placeholder for now.</p>



<a name="180018365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018365">(Nov 06 2019 at 10:22)</a>:</h4>
<p>It's maybe not ideal, but it looks fine as-is. I wouldn't worry about it too much.</p>



<a name="180018411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018411">(Nov 06 2019 at 10:23)</a>:</h4>
<blockquote>
<p>Nice! I just checked out a couple of the better documented files. It looks great. <a href="https://leanprover-community.github.io/doc_demo/manifold.html" target="_blank" title="https://leanprover-community.github.io/doc_demo/manifold.html">https://leanprover-community.github.io/doc_demo/manifold.html</a></p>
</blockquote>
<p>Updated to apply the default stylesheet. Not bad, hmm?</p>



<a name="180018511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018511">(Nov 06 2019 at 10:24)</a>:</h4>
<p>The main thing that had me tearing my hair out with pygments was that each backend has different supported rendering options, like line numbers, and things So like html may support line-numbers and latex ignore them and what not.  Eventually i would like to be able to attach footnotes to lines-numbers and for that I need some fairly custom syntax highlighting anyways.</p>



<a name="180018670"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018670" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018670">(Nov 06 2019 at 10:27)</a>:</h4>
<p>Speaking of line numbers, does the Lean byte code let you access the line number of a declaration? Linking declarations to their statement on GitHub would be really nice.</p>



<a name="180018907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180018907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180018907">(Nov 06 2019 at 10:31)</a>:</h4>
<blockquote>
<p>Right now it only prints declarations that have docstrings, right? Our doc guidelines don't require them for theorems, since in principle all you need to know about a theorem is its statement. Complicated/big/important theorems should have docstrings anyway, but we probably want more than just those in the doc output.</p>
</blockquote>
<p>I think that maybe we should only print things that do have a docstring. Otherwise it becomes close to replicating the source. These pages could be a good intermediate step that extracts the "juicy" bits.</p>



<a name="180019039"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180019039" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180019039">(Nov 06 2019 at 10:34)</a>:</h4>
<p>Then I think we need to raise the percentage of theorems that get documented. The Python docs wouldn't be very helpful if they only told you the juicy parts about manipulating strings.</p>



<a name="180019130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180019130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180019130">(Nov 06 2019 at 10:34)</a>:</h4>
<p>In principle the module docs at the top should point to the juicy bits.</p>



<a name="180019159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180019159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180019159">(Nov 06 2019 at 10:35)</a>:</h4>
<p>So what is the purpose of these documents over the github source (besides typesetting the markdown)?</p>



<a name="180019177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180019177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180019177">(Nov 06 2019 at 10:35)</a>:</h4>
<p>Omitting declaration bodies gets you pretty far from the source.</p>



<a name="180019249"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180019249" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180019249">(Nov 06 2019 at 10:36)</a>:</h4>
<p>Imagine if the Python docs showed you the implementation of every function.</p>



<a name="180019260"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180019260" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180019260">(Nov 06 2019 at 10:36)</a>:</h4>
<p>Yeah, you can extract line numbers, olean-rs/types.rs PosInfo structure.  We should be able to make links revision-stable as well if we can pull the sha out of git.</p>



<a name="180019513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180019513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180019513">(Nov 06 2019 at 10:40)</a>:</h4>
<p>But again, I'm not sure that <em>every</em> theorem deserves to show up in the HTML. Maybe we could use a <code>@[nodoc]</code> attribute to make it opt-out instead of opt-in. We should have access to attributes from the byte code, right?</p>



<a name="180020075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180020075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180020075">(Nov 06 2019 at 10:49)</a>:</h4>
<p>I believe so looks like either Modification::UserAttribute or Modification::Attr. let me know what you guys decide, currently I just ignore undocumented things.</p>



<a name="180020186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180020186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180020186">(Nov 06 2019 at 10:50)</a>:</h4>
<p>Anyhow, going go try and implement some of the things discussed.</p>



<a name="180020253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180020253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180020253">(Nov 06 2019 at 10:51)</a>:</h4>
<p>Hmm, a tougher one, can you identify when declarations are builtin or user-defined? We have a tactic to do this. But that might not be contained in the byte code.</p>



<a name="180020290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180020290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180020290">(Nov 06 2019 at 10:51)</a>:</h4>
<p>We don't want to include random recursors and aux definitions in the docs.</p>



<a name="180020408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180020408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180020408">(Nov 06 2019 at 10:52)</a>:</h4>
<p>I'm not sure, there has been plenty to do without getting too in depth with the bytecode so far :)</p>



<a name="180020458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180020458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180020458">(Nov 06 2019 at 10:53)</a>:</h4>
<p>Hah, fair enough!</p>



<a name="180021238"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180021238" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180021238">(Nov 06 2019 at 11:03)</a>:</h4>
<p>It seems that most (all?) Lean-generated definitions have a name starting with an underscore at some point in the namespace - <code>_main</code>, <code>_sunfold</code>, <code>_eqn_n</code>. In addition, Lean rejects identifiers starting with the underscore, since these are reserved for the system, so it might suffice to just look for those in the name.</p>



<a name="180021490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180021490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180021490">(Nov 06 2019 at 11:06)</a>:</h4>
<p>The things that come along with an inductive type don't. <code>rec_on</code>, <code>no_confusion</code>, etc.</p>



<a name="180021530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180021530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180021530">(Nov 06 2019 at 11:07)</a>:</h4>
<p>Of course, it's easy enough to blacklist those.</p>



<a name="180021627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180021627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180021627">(Nov 06 2019 at 11:08)</a>:</h4>
<p>There is a pretty comprehensive autogenerated definition check in the linter</p>



<a name="180021658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180021658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180021658">(Nov 06 2019 at 11:09)</a>:</h4>
<p>But if we're extracting things with olean-rs we can't run that check.</p>



<a name="180021684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180021684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180021684">(Nov 06 2019 at 11:09)</a>:</h4>
<p>Maybe the check could be reimplemented.</p>



<a name="180124204"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180124204" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180124204">(Nov 07 2019 at 11:48)</a>:</h4>
<p>An issue with printing types is that olean files seem to contain them in raw form. Unless I'm missing something, pretty-printing would then require processing all notation and pretty much reimplementing the pretty-printer. As an alternative, we could query the Lean server for types of things from lumpy. This might be quite slow unfortunately.</p>



<a name="180176504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180176504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180176504">(Nov 07 2019 at 21:12)</a>:</h4>
<p>updated the docs again, to include index and the css stuff. <a href="https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip" target="_blank" title="https://gist.github.com/ratmice/00072c2695d335dfade2db54f18ae333#file-mathlib-docs-zip">mathlib-docs.zip</a>, I find the alphabetical order on directory/file mix bothersome, but it functions.</p>



<a name="180239967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180239967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180239967">(Nov 08 2019 at 15:30)</a>:</h4>
<p>Maybe there's a better approach to this. Instead of extracting info directly from the oleans, should we do a first pass with a Lean metaprogram? That way we can use the existing autogenerated check, pretty-print types, etc.</p>



<a name="180240144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180240144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180240144">(Nov 08 2019 at 15:31)</a>:</h4>
<p>We'd just fold over the environment and for each declaration export the name, type, file location, docstring, and any attributes we want to display. The export can be in whatever format is convenient for the formatter to parse.</p>



<a name="180240407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180240407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180240407">(Nov 08 2019 at 15:34)</a>:</h4>
<p>One thing you can't get from this approach is info about file imports. I guess we'd want to print that at some point.</p>



<a name="180240447"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180240447" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180240447">(Nov 08 2019 at 15:34)</a>:</h4>
<p>Yes, that is the approach I think we should take. Instead of a metaprogram though, I've hacked on Lean a bit to make it produce the list of declarations in each .lean file, as well as the top-level docstrings for it. Re. file imports, I'm not sure about tactic mode, but they should be obtainable from <code>module_info</code> in the c++.</p>



<a name="180240740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180240740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180240740">(Nov 08 2019 at 15:38)</a>:</h4>
<p>Ah, cool. Does it produce the list at the time the file is compiled, or after the whole build is done? If we want to print attributes, it's important to generate this at the end. If a declaration gets tagged as a simp lemma in a later file than where it's declared, we need to catch that.</p>



<a name="180333229"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180333229" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180333229">(Nov 09 2019 at 21:45)</a>:</h4>
<p>It produces the list using the environment that exists at the last line of the file being compiled. Note that we cannot know a priori all places where a lemma is tagged as simp, just as we cannot know a priori all instances of a type class. For this reason, I would say that such tags should be documented <em>in the module in which they exist</em> rather than at the point where the to-be-tagged-simp lemma is declared. Same goes for typeclass instances. We could aggregate them after processing all of mathlib and then retroactively add forward-links, but that wouldn't extend to a general notion of package and would be more of a hack.</p>



<a name="180333312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180333312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180333312">(Nov 09 2019 at 21:47)</a>:</h4>
<p>By the way, while for typeclasses this makes perfect sense, the design choice of allowing lemmas to be tagged as <code>simp</code> after they are declared seems to only make sense if a lemma can be locally-simp, i.e. a useful simplification in the context of some theory, but maybe not generally. I'm not sure if this happens in mathlib but it seems plausible.</p>



<a name="180334499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180334499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180334499">(Nov 09 2019 at 22:18)</a>:</h4>
<p>Oh, and because the signature of <code>module_doc_strings : tactic (list (option name × string))</code> is weird, I am considering deleting it and replacing with <code>module_doc_string : string -&gt; string</code>, which returns the module doc string for the module identified by hopefully same scheme as in <code>import</code>, e.g. <code>module_doc_string ".mymod"</code> should return the doc for <code>./import.lean</code>. The declaration docs are still retrievable by folding over the environment, so no expressivity is lost.</p>



<a name="180363429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180363429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180363429">(Nov 10 2019 at 13:25)</a>:</h4>
<p>I think, in general, we add attributes as soon as they're available. But this isn't always in the file where the declaration is defined: see e.g. the bottom of <code>norm_cast</code>. It intuitively seems useful to document that <code>int.coe_nat_succ</code> is a <code>move_cast</code> lemma. That is indeed some kind of forward reference, but I'm not sure that's a problem for this kind of documentation. It's documenting the library as a whole, forward references aren't necessarily wrong. But it does seem wrong when an attribute is added deep in the file hierarchy. Declaring <code>nat.prime</code> as a class in the p-adics files is an example of this, but there are also other reasons this shouldn't happen and WIP to change it.</p>



<a name="180363484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180363484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180363484">(Nov 10 2019 at 13:27)</a>:</h4>
<p>Besides tactic attributes like <code>move_cast</code>, <code>ext</code>, etc, there aren't many cases where global attributes are added long after the declarations are defined. There are some reducibility level changes I think.</p>



<a name="180435374"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180435374" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180435374">(Nov 11 2019 at 16:02)</a>:</h4>
<blockquote>
<p>Oh, and because the signature of <code>module_doc_strings : tactic (list (option name × string))</code> is weird, I am considering deleting it and replacing with <code>module_doc_string : string -&gt; string</code>, which returns the module doc string for the module identified by hopefully same scheme as in <code>import</code>, e.g. <code>module_doc_string ".mymod"</code> should return the doc for <code>./import.lean</code>. The declaration docs are still retrievable by folding over the environment, so no expressivity is lost.</p>
</blockquote>
<p>Coming back to this: what would be best (for me) is a function that returns a list of pairs <code>(file, docs)</code>, where <code>file</code> is a string that identifies a Lean file and <code>docs</code> is the list of module doc strings for that file. (By module doc strings, I mean the file-level ones, not the ones associated with a declaration.)</p>



<a name="180435480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180435480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180435480">(Nov 11 2019 at 16:03)</a>:</h4>
<p>As far as I can tell, there's still no way within Lean to get a module doc string from outside the current file. You're storing it in the oleans now, but it's not accessible by a metaprogram yet, right?</p>



<a name="180447867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180447867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180447867">(Nov 11 2019 at 18:35)</a>:</h4>
<p>I spent a little too long doing this this afternoon, and it's clearly still rough. Here are mathlib docs generated by a combination of metaprogramming and Python: <a href="http://robertylewis.com/mathlib_docs/" target="_blank" title="http://robertylewis.com/mathlib_docs/">http://robertylewis.com/mathlib_docs/</a></p>



<a name="180448038"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180448038" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180448038">(Nov 11 2019 at 18:37)</a>:</h4>
<p>Essentially, it folds through the environment and writes a json file with the info needed to display. A Python script formats it and tries to link identifiers that it finds in code blocks. Right now, the Python script scrapes module docs from the Lean source files. This will be cleaner if/when they're accessible with a metaprogram.</p>



<a name="180448163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180448163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180448163">(Nov 11 2019 at 18:39)</a>:</h4>
<p>The formatting is modular. If it's better to produce the data from C++ or olean-rs or whatever, that works too.</p>



<a name="180448381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180448381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180448381">(Nov 11 2019 at 18:42)</a>:</h4>
<p>This is completely awesome!</p>



<a name="180458021"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458021" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458021">(Nov 11 2019 at 20:39)</a>:</h4>
<p>Rob, did you put the code somewhere? How can we help? We definitely need some CSS work.</p>



<a name="180458283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458283">(Nov 11 2019 at 20:43)</a>:</h4>
<p>I left the office without pushing it anywhere, but I'll make it available tomorrow. If you want to work on the CSS, you could work on a single file as an example.</p>



<a name="180458346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458346">(Nov 11 2019 at 20:44)</a>:</h4>
<p>The code is almost certainly not Windows friendly.</p>



<a name="180458359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458359">(Nov 11 2019 at 20:44)</a>:</h4>
<p>Who cares?</p>



<a name="180458362"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458362" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458362">(Nov 11 2019 at 20:44)</a>:</h4>
<p>And scraping the module docs from source is really ugly. It will be more portable if we can avoid that.</p>



<a name="180458365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458365">(Nov 11 2019 at 20:44)</a>:</h4>
<p>Well, me when I'm at home working on my laptop...</p>



<a name="180458563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458563">(Nov 11 2019 at 20:47)</a>:</h4>
<p>You could also try to think of a way to linkify notation. There's not a general solution, since notation can reference more than one declaration, so there's no unique place to link it to. But it looks wrong to have <code>ℕ</code> not be a link.</p>



<a name="180458657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458657">(Nov 11 2019 at 20:48)</a>:</h4>
<p>The first easy thing to do is to filter out <code>_inst_. : </code>.</p>



<a name="180458658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458658">(Nov 11 2019 at 20:48)</a>:</h4>
<p>That's hopeless if we're using a metaprogram to generate the data, but <span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> or <span class="user-mention" data-user-id="143402">@matt rice</span> 's approaches might be able to do more.</p>



<a name="180458660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458660">(Nov 11 2019 at 20:48)</a>:</h4>
<p>We really need Lean to cooperate here</p>



<a name="180458675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458675">(Nov 11 2019 at 20:49)</a>:</h4>
<p>Could all of this be easier as an extension of Lean 3.5.c?</p>



<a name="180458785"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458785" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458785">(Nov 11 2019 at 20:50)</a>:</h4>
<p>With small changes to 3.5 I think we could avoid scraping the module docs from the source, at least.</p>



<a name="180458834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458834">(Nov 11 2019 at 20:50)</a>:</h4>
<p>Even if we don't switch mathlib over to lean 3.5.c, we could still use 3.5.c to generate the docs</p>



<a name="180458846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458846">(Nov 11 2019 at 20:51)</a>:</h4>
<p>Lean 3.5 can already build mathlib, right? So adding stuff that would make documentation easier seems like a very good idea.</p>



<a name="180458923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180458923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180458923">(Nov 11 2019 at 20:52)</a>:</h4>
<p>Yeah, of course. Wojciech has already been working on the module doc API there.</p>



<a name="180459089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180459089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180459089">(Nov 11 2019 at 20:54)</a>:</h4>
<blockquote>
<p>As far as I can tell, there's still no way within Lean to get a module doc string from outside the current file. You're storing it in the oleans now, but it's not accessible by a metaprogram yet, right?</p>
</blockquote>
<p>This is correct. I have a local branch in which they're accessible from C++ - I could add a tactic that exposes this storage.</p>



<a name="180459482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180459482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180459482">(Nov 11 2019 at 21:00)</a>:</h4>
<p>The generated html is not well-formed and lacks classes, so working on CSS is not yet possible (but there is no hurry of course).</p>



<a name="180459563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180459563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180459563">(Nov 11 2019 at 21:00)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> Just wanted to note that there is a branch on lumpy json-input for trying out Wojciech's approach in lumpy, I haven't got it using any of the additional information accessible yet, but i'll probably migrate to that if it works out.</p>



<a name="180459573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180459573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180459573">(Nov 11 2019 at 21:01)</a>:</h4>
<p>Another formatting thing that might be nice: instead of printing the name above and the full type below, we could bind variables with the name. So instead of</p>
<div class="codehilite"><pre><span></span>iff_of_eq
∀ {a b : Prop}, a = b → (a ↔ b)
</pre></div>


<p>we'd have</p>
<div class="codehilite"><pre><span></span>iff_of_eq {a b : Prop} (h : a = b)
(a ↔ b)
</pre></div>


<p>This would take some experimenting to get the formatting right. The identifier needs to stand out.</p>



<a name="180459690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180459690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180459690">(Nov 11 2019 at 21:02)</a>:</h4>
<p>In fact, I also have something that sounds like your JSON generation. <a href="/user_uploads/3121/OvxPkFcVrOqwxxzgaeskCnQf/hensel.json" target="_blank" title="hensel.json">hensel.json</a> is an example. It kind of works but performance is really bad as of now, so I'd like to fix that before PRing to lean 3.5. There is also all the internally-generated noise (<code>_private.1428265847.newton_seq_dist_tendsto'</code>) which I didn't try to do anything about just yet.<br>
<span class="user-mention" data-user-id="110596">@Rob Lewis</span> does this JSON look similar to what you were exporting?<br>
<span class="user-mention" data-user-id="143402">@matt rice</span> also has a <a href="https://github.com/ratmice/lumpy-leandoc/tree/json_input" target="_blank" title="https://github.com/ratmice/lumpy-leandoc/tree/json_input">branch</a> of lumpy-leandoc which can parse the JSON</p>



<a name="180459801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180459801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180459801">(Nov 11 2019 at 21:04)</a>:</h4>
<p>Yeah, same idea, slightly different structure, but it would be easy to convert.</p>



<a name="180459851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180459851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180459851">(Nov 11 2019 at 21:05)</a>:</h4>
<p>For the internal stuff, there are some meta defs that filter it that we use in the linter.</p>



<a name="180459909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180459909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180459909">(Nov 11 2019 at 21:06)</a>:</h4>
<p>They could probably be replicated in C++.</p>



<a name="180462503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180462503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180462503">(Nov 11 2019 at 21:40)</a>:</h4>
<p>Because I don't know anything about this black magic going on in this thread I've only half been paying attention. But several people have been in touch with me (because of natnumgame) asking me what maths Lean now has, what maths it needs etc. I am currently pouring all my Lean time into constructing a challenging inequality world for nng but once that's done I was thinking of a blog post of the form "hey, here's what we have now [list of stuff] and here's what we would like [list of other stuff]. I thought I'd mention this here because I was wondering if I could somehow integrate this list into the story somehow, e.g. "for more about groups, see this link here". </p>
<p>Puny initial attempt of "what we need" is here: <a href="https://github.com/kbuzzard/xena/blob/795563bfab087fc8cd8e23107fae43dc78b7b46e/100mathchallenges.txt" target="_blank" title="https://github.com/kbuzzard/xena/blob/795563bfab087fc8cd8e23107fae43dc78b7b46e/100mathchallenges.txt">https://github.com/kbuzzard/xena/blob/795563bfab087fc8cd8e23107fae43dc78b7b46e/100mathchallenges.txt</a> (completely unfinished, the result of a number theoretic brain-dump).</p>



<a name="180462841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180462841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180462841">(Nov 11 2019 at 21:44)</a>:</h4>
<p>Maybe the <a href="https://github.com/leanprover-community/mathlib/blob/master/docs/theories.md" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/docs/theories.md">"theories" docs</a> could be updated / reworked as well?</p>



<a name="180463410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180463410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180463410">(Nov 11 2019 at 21:53)</a>:</h4>
<p>Of course it should be updated. And maybe the we should bring it closer to the Lean file, and put it on the same website, with links to the "per Lean file webpages".</p>



<a name="180463475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180463475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180463475">(Nov 11 2019 at 21:54)</a>:</h4>
<p>I'm not sure we should rush to make the html docs public. This kind of thing works better with fixed releases of mathlib. Having it constantly update makes it harder to link to and harder for Google to index.</p>



<a name="180463504"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180463504" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180463504">(Nov 11 2019 at 21:54)</a>:</h4>
<p>That said, it's not a huge deal if we put up a draft version soon-ish.</p>



<a name="180463528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180463528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180463528">(Nov 11 2019 at 21:55)</a>:</h4>
<p>A lot of the md files in mathlib would be better converted to html and put on the community webpage.</p>



<a name="180463546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180463546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180463546">(Nov 11 2019 at 21:55)</a>:</h4>
<p>Kevin's list would fit there too, if he wants it to be less Kevin and more mathlib.</p>



<a name="180463638"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180463638" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180463638">(Nov 11 2019 at 21:56)</a>:</h4>
<p>I could easily allow lumpy to read .md as well as lean and just do a straight html conversion</p>



<a name="180463743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180463743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180463743">(Nov 11 2019 at 21:58)</a>:</h4>
<blockquote>
<p>I could easily allow lumpy to read .md as well as lean and just do a straight html conversion</p>
</blockquote>
<p>For static pages (that aren't generated from the library), it's not necessary. We already use Jekyll to generate the site. Stick the right header on the md file and it will fit right in, styled and everything.</p>



<a name="180463790"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180463790" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180463790">(Nov 11 2019 at 21:59)</a>:</h4>
<p>For things like the tactic docs that change a lot, maybe incorporating them into the doc generation would be good.</p>



<a name="180471263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180471263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180471263">(Nov 12 2019 at 00:19)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean/pull/81" target="_blank" title="https://github.com/leanprover-community/lean/pull/81">81</a> should do what you need.</p>



<a name="180503882"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180503882" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180503882">(Nov 12 2019 at 10:58)</a>:</h4>
<blockquote>
<p>Rob, did you put the code somewhere? How can we help? We definitely need some CSS work.</p>
</blockquote>
<p><a href="https://github.com/robertylewis/doc_gen/" target="_blank" title="https://github.com/robertylewis/doc_gen/">https://github.com/robertylewis/doc_gen/</a></p>



<a name="180503920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180503920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180503920">(Nov 12 2019 at 10:59)</a>:</h4>
<p>It generates valid html now, and colors declarations based on whether they're theorems, defs, etc.</p>



<a name="180514776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180514776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180514776">(Nov 12 2019 at 13:20)</a>:</h4>
<p>One more update for now. I should stop wasting time on this.</p>



<a name="180514824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180514824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180514824">(Nov 12 2019 at 13:20)</a>:</h4>
<p><a href="http://robertylewis.com/mathlib_docs/linear_algebra/basis.html" target="_blank" title="http://robertylewis.com/mathlib_docs/linear_algebra/basis.html">http://robertylewis.com/mathlib_docs/linear_algebra/basis.html</a></p>



<a name="180521855"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180521855" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180521855">(Nov 12 2019 at 14:33)</a>:</h4>
<p>It looks like we'll have to be careful now about making sure that module docs and docstrings render well. The second wikipedia URL at the top of <a href="http://robertylewis.com/mathlib_docs/ring_theory/maps.html" target="_blank" title="http://robertylewis.com/mathlib_docs/ring_theory/maps.html">ring_theory/maps</a> has underscores which are interpreted as markdown.</p>



<a name="180523235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180523235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180523235">(Nov 12 2019 at 14:48)</a>:</h4>
<p>Yeah, there are tons of problems. It's hard to get it correct without seeing the end results. A lot more needs to be enclosed in backticks.</p>



<a name="180562529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180562529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180562529">(Nov 12 2019 at 21:13)</a>:</h4>
<blockquote>
<p>It looks like we'll have to be careful now about making sure that module docs and docstrings render well. The second wikipedia URL at the top of <a href="http://robertylewis.com/mathlib_docs/ring_theory/maps.html" target="_blank" title="http://robertylewis.com/mathlib_docs/ring_theory/maps.html">ring_theory/maps</a> has underscores which are interpreted as markdown.</p>
</blockquote>
<p>I managed to fix this and some mangled lists by passing the right options to the markdown formatter.</p>



<a name="180562594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180562594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180562594">(Nov 12 2019 at 21:14)</a>:</h4>
<p>Unfortunately there doesn't seem to be an option to turn the urls into links.</p>



<a name="180562655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180562655" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180562655">(Nov 12 2019 at 21:15)</a>:</h4>
<p>Would it be unreasonnable to write markdown urls in Lean file?</p>



<a name="180562694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180562694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180562694">(Nov 12 2019 at 21:15)</a>:</h4>
<p>That seems totally reasonable.</p>



<a name="180562713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180562713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180562713">(Nov 12 2019 at 21:15)</a>:</h4>
<p>I'm pretty sure there are currently very few of them, and they are very easy to find.</p>



<a name="180562725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180562725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180562725">(Nov 12 2019 at 21:16)</a>:</h4>
<p>So we could easily switch.</p>



<a name="180563291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180563291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180563291">(Nov 12 2019 at 21:21)</a>:</h4>
<p>Yeah. I think we're going to find tons of things that need to be fixed. The mistakes become obvious once you actually parse the markdown.</p>



<a name="180621579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621579">(Nov 13 2019 at 12:50)</a>:</h4>
<p>So, I'm reaching a point where I'm kind of happy with the layout/CSS. Comments are welcome. <a href="https://robertylewis.com/mathlib_docs//geometry/manifold/smooth_manifold_with_corners.html" target="_blank" title="https://robertylewis.com/mathlib_docs//geometry/manifold/smooth_manifold_with_corners.html">https://robertylewis.com/mathlib_docs//geometry/manifold/smooth_manifold_with_corners.html</a></p>



<a name="180621625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621625">(Nov 13 2019 at 12:51)</a>:</h4>
<p>Declaration names link to the corresponding line on GitHub.</p>



<a name="180621646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621646">(Nov 13 2019 at 12:51)</a>:</h4>
<p>Are you color-blind? I'm asking out of curiosity.</p>



<a name="180621692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621692">(Nov 13 2019 at 12:51)</a>:</h4>
<p>What? No, it's a random color palette some website gave me.</p>



<a name="180621779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621779">(Nov 13 2019 at 12:52)</a>:</h4>
<p>We need a web designer.</p>



<a name="180621781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621781">(Nov 13 2019 at 12:52)</a>:</h4>
<p>The pink does jump out a little too much.</p>



<a name="180621798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621798">(Nov 13 2019 at 12:52)</a>:</h4>
<p>Yes, the pink in particular.</p>



<a name="180621804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621804">(Nov 13 2019 at 12:52)</a>:</h4>
<p>And it does feel old too.</p>



<a name="180621845"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621845" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621845">(Nov 13 2019 at 12:53)</a>:</h4>
<p>And I think keeping the keywords <code>def</code>, <code>lemma</code> etc. would help.</p>



<a name="180621911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621911">(Nov 13 2019 at 12:54)</a>:</h4>
<p>I should have first written that the current result is already amazing!</p>



<a name="180621913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621913">(Nov 13 2019 at 12:54)</a>:</h4>
<p>You're welcome to suggest alternate colors!</p>



<a name="180621943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621943">(Nov 13 2019 at 12:54)</a>:</h4>
<blockquote>
<p>And I think keeping the keywords <code>def</code>, <code>lemma</code> etc. would help.</p>
</blockquote>
<p>Oh, yeah, I meant to do this. I don't think there's any way to distinguish lemma/theorem, so we'd need to pick one.</p>



<a name="180621996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180621996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180621996">(Nov 13 2019 at 12:55)</a>:</h4>
<p>It gets a little complicated with structures and inductives, because those are "constants" in the environment. But it should be possible to identify that.</p>



<a name="180622057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622057">(Nov 13 2019 at 12:55)</a>:</h4>
<p>It would be nice to use LaTeX in module docstrings when not quoting Lean code.</p>



<a name="180622158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622158">(Nov 13 2019 at 12:56)</a>:</h4>
<p>It's easy enough to support MathJax.</p>



<a name="180622168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622168">(Nov 13 2019 at 12:56)</a>:</h4>
<p>Is there a link to the GitHub page of the file somewhere? (I know there are links to individual declarations, although they come as a surprise).</p>



<a name="180622179"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622179" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622179">(Nov 13 2019 at 12:56)</a>:</h4>
<p>It's kind of a minefield though</p>



<a name="180622222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622222">(Nov 13 2019 at 12:57)</a>:</h4>
<p>We should also think about having a responsive layout, for small screen browsing.</p>



<a name="180622231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622231">(Nov 13 2019 at 12:57)</a>:</h4>
<blockquote>
<p>Is there a link to the GitHub page of the file somewhere? (I know there are links to individual declarations, although they come as a surprise).</p>
</blockquote>
<p>No, where would you suggest adding it?</p>



<a name="180622283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622283">(Nov 13 2019 at 12:57)</a>:</h4>
<p>Somewhere at the top probably.</p>



<a name="180622312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622312">(Nov 13 2019 at 12:57)</a>:</h4>
<p>Maybe even h1 could be a link.</p>



<a name="180622330"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622330" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622330">(Nov 13 2019 at 12:58)</a>:</h4>
<p>I've been leaning towards something like dvisvgm in lumpy which can convert pretty much any old tex to svg</p>



<a name="180622371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622371">(Nov 13 2019 at 12:58)</a>:</h4>
<p>What I did for my masters thesis was to basically rip off <a href="https://doc.rust-lang.org/std/primitive.i32.html" target="_blank" title="https://doc.rust-lang.org/std/primitive.i32.html">Rust</a>'s CSS, which gave me a nice basic layout without any effort on my side...</p>



<a name="180622424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622424">(Nov 13 2019 at 12:58)</a>:</h4>
<blockquote>
<p>It's kind of a minefield though</p>
</blockquote>
<p>I don't know much about it. We can add hooks in the markdown processing that capture <code>$$ ... $$</code> blocks. That's as far as I got.</p>



<a name="180622458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622458">(Nov 13 2019 at 12:58)</a>:</h4>
<p>But I don't want to distract you from <code>polya</code>, I shouldn't be writing those comments, and try to find time to try something on my side.</p>



<a name="180622484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622484">(Nov 13 2019 at 12:59)</a>:</h4>
<blockquote>
<p>Maybe even h1 could be a link.</p>
</blockquote>
<p>This is slightly tricky actually. The entire top block is the module doc from the Lean file. It's much easier to add things around it than inside it.</p>



<a name="180622488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622488">(Nov 13 2019 at 12:59)</a>:</h4>
<p>Sebastian is right, I'm sure we can steal ideas without hiring a web designer.</p>



<a name="180622720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180622720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180622720">(Nov 13 2019 at 13:01)</a>:</h4>
<p>Yeah, I'm not very interested in making major design changes myself. If someone else wants to reformat I'm very happy to let them.</p>



<a name="180623060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180623060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180623060">(Nov 13 2019 at 13:04)</a>:</h4>
<blockquote>
<blockquote>
<p>It's kind of a minefield though</p>
</blockquote>
<p>I don't know much about it. We can add hooks in the markdown processing that capture <code>$$ ... $$</code> blocks. That's as far as I got.</p>
</blockquote>
<p>Yeah I think the hard part is that each markdown tool supports variations on a similar syntax, but somehow they all manage to be different<br>
and there is no standard to be found anywhere. here is a breakdown someone did <a href="https://github.com/cben/mathdown/wiki/math-in-markdown#appendix-summary-table" target="_blank" title="https://github.com/cben/mathdown/wiki/math-in-markdown#appendix-summary-table">mathdown</a></p>



<a name="180623614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180623614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180623614">(Nov 13 2019 at 13:11)</a>:</h4>
<blockquote>
<p>Maybe even h1 could be a link.</p>
</blockquote>
<p>Oh, most files don't even have an h1 because there's no module doc. I'll add a "View file source" link in the navigation panel instead.</p>



<a name="180623770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180623770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180623770">(Nov 13 2019 at 13:13)</a>:</h4>
<blockquote>
<p>Yeah I think the hard part is that each markdown tool supports variations on a similar syntax, but somehow they all manage to be different</p>
</blockquote>
<p>Right now I'm using the markdown2 library for Python which I don't think supports anything. But I can extract the raw text and feed it somewhere else for processing.</p>



<a name="180623778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180623778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180623778">(Nov 13 2019 at 13:13)</a>:</h4>
<p>Again, in principle, I haven't actually looked into it yet.</p>



<a name="180623813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180623813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180623813">(Nov 13 2019 at 13:13)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span>  about your suggestion in <a href="https://github.com/leanprover-community/lean/pull/81" target="_blank" title="https://github.com/leanprover-community/lean/pull/81">81</a>, If we added h2 to those groupings and had links for those too,</p>



<a name="180623864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180623864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180623864">(Nov 13 2019 at 13:14)</a>:</h4>
<p>And since there's almost no LaTeX in md blocks right now, I don't think it's a priority!</p>



<a name="180623867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180623867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180623867">(Nov 13 2019 at 13:14)</a>:</h4>
<p>With mathjax you only need to make sure LaTeX parts are untouched.</p>



<a name="180624085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180624085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180624085">(Nov 13 2019 at 13:17)</a>:</h4>
<blockquote>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span>  about your suggestion in <a href="https://github.com/leanprover-community/lean/pull/81" target="_blank" title="https://github.com/leanprover-community/lean/pull/81">81</a>, If we added h2 to those groupings and had links for those too,</p>
</blockquote>
<p>Yeah, we could build a TOC and put it after the header block if there are any subsections to link to.</p>



<a name="180624187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180624187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180624187">(Nov 13 2019 at 13:18)</a>:</h4>
<p><em>nod</em> my markdown parser doesn't handle them either (well, it refuses until there is a standard).</p>
<p>i've been using e.g.</p>
<div class="codehilite"><pre><span></span>```latex
```
and
```math
```
</pre></div>



<a name="180624223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180624223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180624223">(Nov 13 2019 at 13:18)</a>:</h4>
<p>a bit verbose...</p>



<a name="180643521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180643521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> matt rice <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180643521">(Nov 13 2019 at 16:21)</a>:</h4>
<p>Anyhow, I know Rob's is a lot nicer, but set up a page with the current index generation here: <a href="https://lumpy-leandoc.github.io/doc_preview/" target="_blank" title="https://lumpy-leandoc.github.io/doc_preview/">doc_preview</a></p>



<a name="180650505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180650505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180650505">(Nov 13 2019 at 17:27)</a>:</h4>
<p>The problem with mathjax/katex is that they both have absolutely zero support for diagrams, so if category theorists wanted to draw something with TikZ, it wouldn't work. Dvisvgm does support that, but requires offline generation of svgs.</p>



<a name="180651818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180651818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180651818">(Nov 13 2019 at 17:39)</a>:</h4>
<p>Alright. Another update, with better support for structures/inductives, printing def/lemma/etc, and a few more tweaks. <a href="https://robertylewis.com/mathlib_docs/geometry/manifold/manifold.html" target="_blank" title="https://robertylewis.com/mathlib_docs/geometry/manifold/manifold.html">https://robertylewis.com/mathlib_docs/geometry/manifold/manifold.html</a></p>



<a name="180651846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180651846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180651846">(Nov 13 2019 at 17:39)</a>:</h4>
<p>The code is now more or less portable. <a href="https://github.com/robertylewis/doc_gen" target="_blank" title="https://github.com/robertylewis/doc_gen">https://github.com/robertylewis/doc_gen</a></p>



<a name="180651985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180651985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180651985">(Nov 13 2019 at 17:41)</a>:</h4>
<p><code>update-mathlib</code> isn't working when I try to do this locally. It says it succeeds, but then Lean wants to compile all of mathlib, even if I touch all the oleans first.</p>



<a name="180652170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180652170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180652170">(Nov 13 2019 at 17:42)</a>:</h4>
<p>So if you try to install it you might need to do a full compile or get the oleans from elsewhere. Or maybe it's an issue on my end.</p>



<a name="180655338"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180655338" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180655338">(Nov 13 2019 at 18:16)</a>:</h4>
<blockquote>
<p>The problem with mathjax/katex is that they both have absolutely zero support for diagrams, so if category theorists wanted to draw something with TikZ, it wouldn't work. Dvisvgm does support that, but requires offline generation of svgs.</p>
</blockquote>
<p>Absolutely zero support for diagrams is a little strong, <a href="https://github.com/sonoisa/XyJax" target="_blank" title="https://github.com/sonoisa/XyJax">https://github.com/sonoisa/XyJax</a> does exist for mathjax and I've used it for many years as has the stacks project (<a href="https://stacks.math.columbia.edu/tag/0BW7" target="_blank" title="https://stacks.math.columbia.edu/tag/0BW7">https://stacks.math.columbia.edu/tag/0BW7</a>), it is basically unsupported officially though and  might even be broken with mathjax 3.0.</p>



<a name="180667952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180667952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180667952">(Nov 13 2019 at 20:24)</a>:</h4>
<p>I don't think we should encourage people to use <code>xypic</code> in 2019. Accepting tikz-cd with server-side rendering seems much wiser.</p>



<a name="180668595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180668595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180668595">(Nov 13 2019 at 20:30)</a>:</h4>
<p>I just found a project to render Tikz in the browser with WebAssembly: <a href="https://github.com/kisonecat/tikzjax" target="_blank" title="https://github.com/kisonecat/tikzjax">https://github.com/kisonecat/tikzjax</a></p>



<a name="180669241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180669241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180669241">(Nov 13 2019 at 20:36)</a>:</h4>
<p>I'm not encouraging, simply stating the facts that it is possible with client-side js</p>



<a name="180669275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180669275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180669275">(Nov 13 2019 at 20:36)</a>:</h4>
<p>This tikz project seems very cool though!</p>



<a name="180675122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180675122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180675122">(Nov 13 2019 at 21:31)</a>:</h4>
<p>Ah sorry, I meant "out-of-the-box support". Tikzjax certainly looks interesting, but I would question its stability - reloading a coredump of the entire TeX compiler in the browser sounds a bit crazy.</p>



<a name="180675299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180675299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180675299">(Nov 13 2019 at 21:33)</a>:</h4>
<p>Server (ie author)-side rendering looks much simpler and faster. You don't want you browser to reflow a commutative diagram anyway.</p>



<a name="180677893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/180677893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#180677893">(Nov 13 2019 at 22:03)</a>:</h4>
<p>How many commutative diagrams do we have in the docstrings right now?</p>



<a name="181202029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202029">(Nov 20 2019 at 12:24)</a>:</h4>
<p>Okay, I found a bit more time to work on this. Here's a refresh. Maybe the colors are more to Patrick's taste. <a href="https://robertylewis.com/mathlib_docs/" target="_blank" title="https://robertylewis.com/mathlib_docs/">https://robertylewis.com/mathlib_docs/</a></p>



<a name="181202207"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202207" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202207">(Nov 20 2019 at 12:26)</a>:</h4>
<p>This builds with <span class="user-mention" data-user-id="128280">@Wojciech Nawrocki</span> 's additions to 3.5c, so it can display module docs used to section a file. I don't think we have any of these in mathlib yet, but here's a demo: <a href="https://robertylewis.com/mathlib_docs/topology/whoa.html" target="_blank" title="https://robertylewis.com/mathlib_docs/topology/whoa.html">https://robertylewis.com/mathlib_docs/topology/whoa.html</a></p>



<a name="181202428"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202428" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202428">(Nov 20 2019 at 12:29)</a>:</h4>
<p>The font for theorem statements is a bit large (being used also as the header). Most statements don't fit on one line, and a decent fraction of them seem to have the line break exactly where things get interesting</p>



<a name="181202558"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202558" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202558">(Nov 20 2019 at 12:30)</a>:</h4>
<p>One possibility is to remove all implicit and instance implicit arguments from the main display, and put them in smaller type afterward</p>



<a name="181202626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202626">(Nov 20 2019 at 12:31)</a>:</h4>
<p>Nice work! Starts to look really good. I agree with Mario's points though.</p>



<a name="181202736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202736">(Nov 20 2019 at 12:32)</a>:</h4>
<p>Also, you might try to detect unnamed hypotheses by type so that you can turn more arguments into arrows (especially arguments named <code>a_1</code>, <code>a_2</code> that were arrows to begin with)</p>



<a name="181202757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202757">(Nov 20 2019 at 12:33)</a>:</h4>
<p>Sure, it's easy enough to change the font sizes. The line breaks will obviously depend on how wide your window is. This can be fiddled with.</p>



<a name="181202824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202824">(Nov 20 2019 at 12:34)</a>:</h4>
<blockquote>
<p>One possibility is to remove all implicit and instance implicit arguments from the main display, and put them in smaller type afterward</p>
</blockquote>
<p>Not sure exactly what you have in mind with "put them in smaller type afterward." Do you mean state the type twice, once without implicits and once with?</p>



<a name="181202932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181202932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181202932">(Nov 20 2019 at 12:35)</a>:</h4>
<blockquote>
<p>Also, you might try to detect unnamed hypotheses by type so that you can turn more arguments into arrows (especially arguments named <code>a_1</code>, <code>a_2</code> that were arrows to begin with)</p>
</blockquote>
<p>What's the robust way to do this? In effect, "intros until the last named argument."</p>



<a name="181203059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203059">(Nov 20 2019 at 12:37)</a>:</h4>
<p>not sure if it's better to quote just the omitted implicits or the full type. I was thinking something like:</p>
<ul>
<li>Line 1 (header): <code>theorem add_monoid.zero_smul (a : β) :</code></li>
<li>Line 2 (main text): <code>add_monoid.smul 0 a = 0</code></li>
<li>Line 3 (footnote size): <code>@[simp]</code>; <code>{β : Type u} [add_monoid β]</code></li>
</ul>



<a name="181203159"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203159" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203159">(Nov 20 2019 at 12:38)</a>:</h4>
<p>If you have expr info, you can check whether a variable appears in the body to determine if it can be "arrowed"</p>



<a name="181203178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203178">(Nov 20 2019 at 12:38)</a>:</h4>
<p>there is an expr function for this</p>



<a name="181203203"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203203" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203203">(Nov 20 2019 at 12:39)</a>:</h4>
<p><code>expr.is_arrow</code></p>



<a name="181203217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203217">(Nov 20 2019 at 12:39)</a>:</h4>
<p>which uses <code>expr.has_var</code></p>



<a name="181203396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203396">(Nov 20 2019 at 12:42)</a>:</h4>
<p>I don't feel strongly about how much lean syntax to use in these displays. I and many others will be used to it, but I would also be happy with something that reimagines the syntax a bit or puts more things in a prose style</p>



<a name="181203502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203502">(Nov 20 2019 at 12:43)</a>:</h4>
<blockquote>
<p>not sure if it's better to quote just the omitted implicits or the full type. I was thinking something like:</p>
<ul>
<li>Line 1 (header): <code>theorem add_monoid.zero_smul (a : β) :</code></li>
<li>Line 2 (main text): <code>add_monoid.smul 0 a = 0</code></li>
<li>Line 3 (footnote size): <code>@[simp]</code>; <code>{β : Type u} [add_monoid β]</code></li>
</ul>
</blockquote>
<p>Hmm. This hides the information about where the implicits appear in the signature. Usually you don't need to know this but sometimes you do, and it limits how useful the docs are if they don't give it. What about a javascript toggle to flip between "all variables" and "explicit only"? "explicit only" could be the default.</p>



<a name="181203564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203564">(Nov 20 2019 at 12:44)</a>:</h4>
<p>I hate to suggest more javascript work for me to do, but it would look nice.</p>



<a name="181203601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203601">(Nov 20 2019 at 12:45)</a>:</h4>
<blockquote>
<p><code>expr.is_arrow</code></p>
</blockquote>
<p>Ah, right. I think I can do this easily.</p>



<a name="181203766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203766">(Nov 20 2019 at 12:47)</a>:</h4>
<p>I know that this makes exact implicit order not visible, but I think that's a tolerable tradeoff. We already have methods like <code>#print</code> or hovers for getting this kind of info from a definition, and we're already not sharing some information that might be relevant, like the definition or proof itself</p>



<a name="181203852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181203852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181203852">(Nov 20 2019 at 12:48)</a>:</h4>
<p>If you want to have a JS toggle for this, I wouldn't mind it though</p>



<a name="181204019"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181204019" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181204019">(Nov 20 2019 at 12:50)</a>:</h4>
<p>For a much harder problem, I would really like to see some proof displays. I have gotten a lot of value out of the metamath web pages that give super detailed proofs of anything you could hope for, and it would be great if lean had anything half as good</p>



<a name="181204693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181204693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181204693">(Nov 20 2019 at 13:00)</a>:</h4>
<p>I think the best kind of proof display we'll have in the near future is the current "click the declaration name to go to the source on GitHub." It doesn't seem helpful to display full proof terms. And adding any sort of interactivity to a displayed proof script seems... challenging.</p>



<a name="181204840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181204840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181204840">(Nov 20 2019 at 13:02)</a>:</h4>
<p>Like I said, it's not an easy problem. I can dream though</p>



<a name="181204890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181204890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181204890">(Nov 20 2019 at 13:03)</a>:</h4>
<p>I actually <em>do</em> want to see full proof terms, just not in the horrible way <code>pp.all</code> does it</p>



<a name="181204956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181204956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181204956">(Nov 20 2019 at 13:04)</a>:</h4>
<p>interactivity opens up a huge number of possibilities here, and the space is certainly not well explored</p>



<a name="181205449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181205449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181205449">(Nov 20 2019 at 13:11)</a>:</h4>
<p>Fair enough. For a really good display I'm not sure even the proof term is enough. My dream interactive browser would note when a proof term was generated by a certain tactic. I agree it's not well explored, but it would take a lot of exploring to get to something really useful.</p>



<a name="181205528"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181205528" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181205528">(Nov 20 2019 at 13:12)</a>:</h4>
<p>You certainly need the types of subterms. There is probably a way to turn such information into something like an evolving tactic state</p>



<a name="181205649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181205649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181205649">(Nov 20 2019 at 13:14)</a>:</h4>
<p>you are right that recovering provenance data is hard to impossible and also pretty valuable (although not the whole story). I always felt cheated when I went through an isabelle tutorial and everything was <code>by auto</code>. I wasn't any closer to understanding why fact X is true, and the computer didn't know how to communicate why</p>



<a name="181205776"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181205776" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181205776">(Nov 20 2019 at 13:16)</a>:</h4>
<blockquote>
<p>Maybe the colors are more to Patrick's taste.</p>
</blockquote>
<p>If they're not then you can tell him to fix it up himself ;-) They look fine to me! (but then again I guess you could question my tastes in colours...)</p>



<a name="181206949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181206949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181206949">(Nov 20 2019 at 13:32)</a>:</h4>
<p>What is doable is to diplay the proof taken from the Lean file, with tactic state as it appears in VScode. This is what is done by format_lean.</p>



<a name="181207064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181207064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181207064">(Nov 20 2019 at 13:34)</a>:</h4>
<p>that doesn't solve the <code>by auto</code> problem though (or <code>by tidy</code> in our case)</p>



<a name="181207081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181207081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181207081">(Nov 20 2019 at 13:34)</a>:</h4>
<p>Sure, but it would already be a huge improvement.</p>



<a name="181207106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181207106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181207106">(Nov 20 2019 at 13:35)</a>:</h4>
<p>true</p>



<a name="181207240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181207240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181207240">(Nov 20 2019 at 13:37)</a>:</h4>
<blockquote>
<p>you are right that recovering provenance data is hard to impossible and also pretty valuable (although not the whole story). I always felt cheated when I went through an isabelle tutorial and everything was <code>by auto</code>. I wasn't any closer to understanding why fact X is true, and the computer didn't know how to communicate why</p>
</blockquote>
<p>The problem is that sometimes the answer to "why" is "by auto," and sometimes the answer is what auto did, so you you need the option to see both.</p>



<a name="181207870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181207870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181207870">(Nov 20 2019 at 13:45)</a>:</h4>
<p>This reminds me of Lamport's structured proofs <a href="https://lamport.azurewebsites.net/pubs/proof.pdf" target="_blank" title="https://lamport.azurewebsites.net/pubs/proof.pdf">https://lamport.azurewebsites.net/pubs/proof.pdf</a></p>



<a name="181214937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181214937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181214937">(Nov 20 2019 at 15:03)</a>:</h4>
<p>Okay. It's updated to print implicit arguments below, and to prefer arrows in the type to named arrows when that makes sense. I still have all the data so it won't be hard to create a JS toggle to show the full type. The hardest thing there will be where to put the button.</p>



<a name="181636998"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181636998" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181636998">(Nov 22 2019 at 13:27)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> pointed out a big benefit of making these docs public, even though they're in an early state: they make it much easier to notice doc strings that are missing, wrong, malformed, etc. So I've put them up at an "official" location. <a href="https://leanprover-community.github.io/mathlib_docs/" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/">https://leanprover-community.github.io/mathlib_docs/</a></p>



<a name="181637018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181637018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181637018">(Nov 22 2019 at 13:27)</a>:</h4>
<p>I don't know how well the search will work. We need to wait for Google to index the docs before it will work at all.</p>



<a name="181637352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181637352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181637352">(Nov 22 2019 at 13:32)</a>:</h4>
<p>At some point we'll want to regenerate them daily. I think it's probably best to do this as part of the Travis build that updates <code>lean-3.4.2</code>, but maybe it's better to use <span class="user-mention" data-user-id="110087">@Scott Morrison</span> 's server?</p>



<a name="181637353"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181637353" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181637353">(Nov 22 2019 at 13:32)</a>:</h4>
<p>I love that the first doc string I looked at was this one: <a href="https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/algebra/associated.lean#L13" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/algebra/associated.lean#L13">https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/algebra/associated.lean#L13</a></p>



<a name="181637443"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181637443" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181637443">(Nov 22 2019 at 13:34)</a>:</h4>
<p>There's, uh, a big range of doc string quality in the library right now...</p>



<a name="181637472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181637472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181637472">(Nov 22 2019 at 13:34)</a>:</h4>
<p>Unfortunately we can't (yet) have a linter for that. The problem is NLP-complete...</p>



<a name="181637667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181637667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181637667">(Nov 22 2019 at 13:37)</a>:</h4>
<p>On the other side of things from <code>is unit</code> are <span class="user-mention" data-user-id="110050">@Sebastien Gouezel</span> 's files. <a href="https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html">https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html</a></p>



<a name="181638565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638565">(Nov 22 2019 at 13:48)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> Here's a little comment: consider <a href="https://leanprover-community.github.io/mathlib_docs/geometry/manifold/smooth_manifold_with_corners.html" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/geometry/manifold/smooth_manifold_with_corners.html">https://leanprover-community.github.io/mathlib_docs/geometry/manifold/smooth_manifold_with_corners.html</a><br>
I think the stuff under main definitions is typeset as a list in the source code. Is there some markdownish reason why that didn't happen here?</p>



<a name="181638628"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638628" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638628">(Nov 22 2019 at 13:49)</a>:</h4>
<p>I guess <a href="https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/geometry/manifold/smooth_manifold_with_corners.lean#L24-L36" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/geometry/manifold/smooth_manifold_with_corners.lean#L24-L36">https://github.com/leanprover-community/mathlib/blob/3f9c4d886493afe2dbaada17d25e486b1872e047/src/geometry/manifold/smooth_manifold_with_corners.lean#L24-L36</a> is not interpreted as a list by markdown</p>



<a name="181638632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638632">(Nov 22 2019 at 13:49)</a>:</h4>
<p>Because it's not actually typeset as a list.</p>



<a name="181638649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638649">(Nov 22 2019 at 13:49)</a>:</h4>
<p>Each item should start with <code>*</code> or <code>-</code> or something.</p>



<a name="181638716"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638716" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638716">(Nov 22 2019 at 13:50)</a>:</h4>
<p>Yes, my mistake, I did not write it using proper markdown (as I was not aware at the time that real markdown would be relevant).</p>



<a name="181638740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638740">(Nov 22 2019 at 13:50)</a>:</h4>
<p>This is why I wanted to publicize the HTML docs. These things are impossible to see in the Lean files, but obvious when you see them in action.</p>



<a name="181638803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638803">(Nov 22 2019 at 13:51)</a>:</h4>
<p>What is the reason that <code>times_cont_diff_groupoid</code> is hyperlinked in that blob of text, but other names are not?</p>



<a name="181638851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638851">(Nov 22 2019 at 13:51)</a>:</h4>
<p>Because that's the full name. The other things have namespaces in front of them.</p>



<a name="181638900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638900">(Nov 22 2019 at 13:52)</a>:</h4>
<p>Ach so</p>



<a name="181638943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181638943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181638943">(Nov 22 2019 at 13:52)</a>:</h4>
<p>I don't think there's any way around this, the name resolution would be ambiguous.</p>



<a name="181639025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181639025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181639025">(Nov 22 2019 at 13:53)</a>:</h4>
<p>Actually -- in this case that might not be the issue, <code>smooth_manifold_with_corners</code> isn't namespaced.</p>



<a name="181639110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181639110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181639110">(Nov 22 2019 at 13:54)</a>:</h4>
<p>Not sure why that's failing to link. I'll look into it soon.</p>



<a name="181701826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/181701826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#181701826">(Nov 23 2019 at 05:59)</a>:</h4>
<p>With the power of Observable, I've written <a href="https://observablehq.com/@bryangingechen/github-lean-doc-preview" target="_blank" title="https://observablehq.com/@bryangingechen/github-lean-doc-preview">a tool</a> that renders all the markdown docstrings in a Lean file on GitHub. You can also paste in the URL to a PR (or even just the number of a PR to mathlib) and all the docstrings in the changed Lean files will be displayed. I hope this will be useful for mathlib PR reviewers or contributors who want to check the markdown in their docstrings. </p>
<p>Note that I'm not able to show the declaration (with the name / type) corresponding to the docstring at the moment. Also, the tool relies on <a href="https://github.com/markedjs/marked" target="_blank" title="https://github.com/markedjs/marked"><code>marked</code></a> so some things may appear slightly different from mathlib_docs, which uses markdown2. Let me know if there's anything I can change to make it easier to use!</p>



<a name="182603503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/182603503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wojciech Nawrocki <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#182603503">(Dec 04 2019 at 21:47)</a>:</h4>
<p>Another example: <a href="http://isarmathlib.org/" target="_blank" title="http://isarmathlib.org/">This presentation</a> of Isabelle/ZF theories is quite nice.</p>



<a name="183642427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/183642427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#183642427">(Dec 17 2019 at 12:13)</a>:</h4>
<p>The docs are updated, thanks largely to <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> ! <a href="https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html">https://leanprover-community.github.io/mathlib_docs/geometry/manifold/manifold.html</a></p>
<p>New features include prettier styling, collapsible display of implicit arguments, linked notation, and lists of class instances (see the collapsible list at <a href="https://leanprover-community.github.io/mathlib_docs/algebra/module.html#module" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/algebra/module.html#module">https://leanprover-community.github.io/mathlib_docs/algebra/module.html#module</a>).</p>



<a name="183645223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/183645223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#183645223">(Dec 17 2019 at 12:56)</a>:</h4>
<p>IMHO, this is absolutely awesome. Clicking around a bit I wonder if it would be worth styling the links to GH source differently from the links to elsewhere in the docs.</p>



<a name="183645237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/183645237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#183645237">(Dec 17 2019 at 12:57)</a>:</h4>
<p>Anyway, great work.</p>



<a name="183949030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/183949030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#183949030">(Dec 20 2019 at 16:11)</a>:</h4>
<p>An early Christmas present for you all: I've added some of the mathlib doc files (<a href="https://github.com/leanprover-community/mathlib/issues/1815" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1815">#1815</a>) to the doc display. <a href="https://leanprover-community.github.io/mathlib_docs/tactic_writing.html" target="_blank" title="https://leanprover-community.github.io/mathlib_docs/tactic_writing.html">https://leanprover-community.github.io/mathlib_docs/tactic_writing.html</a></p>



<a name="183949047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/183949047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#183949047">(Dec 20 2019 at 16:11)</a>:</h4>
<p>This is work in progress, the menus on the left aren't quite right yet.</p>



<a name="183949060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/183949060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#183949060">(Dec 20 2019 at 16:11)</a>:</h4>
<p>And, of course, the doc files themselves need updating.</p>



<a name="183949163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/183949163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#183949163">(Dec 20 2019 at 16:12)</a>:</h4>
<p>But there won't be much progress here for the next few weeks, so it's up for now!</p>



<a name="183951803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/183951803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#183951803">(Dec 20 2019 at 16:44)</a>:</h4>
<p>This is so cool. Our library is growing up :D</p>



<a name="184347341"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/184347341" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#184347341">(Dec 27 2019 at 22:30)</a>:</h4>
<p>I have a small contribution to mathlib docs website effort. I tried to fix CSS so I can use it on my phone. I modified one sample page and put it at <a href="https://www.math.u-psud.fr/~pmassot/test/" target="_blank" title="https://www.math.u-psud.fr/~pmassot/test/">https://www.math.u-psud.fr/~pmassot/test/</a>. Please test on various screen sizes (but beware that clicking any link will bring you to the current website). <span class="user-mention" data-user-id="110596">@Rob Lewis</span> you can diff the html and CSS against the current website, changing the documentation generator should be extremely easy. This is minimal modification that, on screens narrower than 1000px, removes the left side bar and collapse the right one with a menu button on a sticky header.</p>



<a name="184348846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/184348846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#184348846">(Dec 27 2019 at 23:07)</a>:</h4>
<p>Thanks! I don't have time now, but I'll play around with it. The fixed "Lean mathlib docs" header looks a little funny on a wide screen, especially how it pushes the scroll bars and search windows down. It'll take some fiddling.</p>



<a name="184352140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/184352140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#184352140">(Dec 28 2019 at 00:47)</a>:</h4>
<p>This is very easy to fix. I just pushed a version which hides that header on wide screens. I guess we could instead give it a different background color, or put more stuff in it.</p>



<a name="186924871"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/186924871" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#186924871">(Jan 29 2020 at 20:21)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/1927" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1927">#1927</a></p>



<a name="186924965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/186924965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#186924965">(Jan 29 2020 at 20:22)</a>:</h4>
<p>Patrick, I haven't forgotten about your contribution. But the mobile friendly version still looks off on my non-mobile screens and I haven't found the energy to dive back into the CSS yet.</p>



<a name="186935810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/markdown%20module%20docstrings/near/186935810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/markdown.20module.20docstrings.html#186935810">(Jan 29 2020 at 22:30)</a>:</h4>
<p>I hope I'll be able to resume work on this next week (not before Wednesday though). Your recent work should make it easier for me to try things, but it would help to tell me more precisely what "looks off".</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>