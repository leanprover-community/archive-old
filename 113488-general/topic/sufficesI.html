---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/sufficesI.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html">sufficesI</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="281613926"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281613926" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281613926">(May 08 2022 at 19:19)</a>:</h4>
<p>Could we have an "instance version" of <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#suffices">tactic#suffices</a>? This would complete the <code>have</code>, <code>haveI</code>, <code>suffices</code> square.</p>



<a name="281614007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614007">(May 08 2022 at 19:21)</a>:</h4>
<p>Do you have a practical use in mind for it?</p>



<a name="281614097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614097">(May 08 2022 at 19:22)</a>:</h4>
<p>It has the same applications as <code>haveI</code>. For example I have this proof</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">haveI</span> <span class="o">:</span> <span class="n">is_empty</span> <span class="o">{</span><span class="n">a</span> <span class="bp">//</span> <span class="n">b</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">k</span><span class="o">},</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="n">subtype.is_empty_of_false</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">rintro</span> <span class="n">a</span> <span class="n">rfl</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hbk</span> <span class="o">(</span><span class="n">finset.mem_image_of_mem</span> <span class="n">_</span> <span class="bp">$</span> <span class="n">finset.mem_univ</span> <span class="n">_</span><span class="o">)</span> <span class="o">},</span>
  <span class="n">exact</span> <span class="n">det_is_empty</span><span class="o">,</span>
</code></pre></div>
<p>This would read slightly better as</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">sufficesI</span> <span class="o">:</span> <span class="n">is_empty</span> <span class="o">{</span><span class="n">a</span> <span class="bp">//</span> <span class="n">b</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">k</span><span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">det_is_empty</span> <span class="o">},</span>
  <span class="n">refine</span> <span class="n">subtype.is_empty_of_false</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rintro</span> <span class="n">a</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hbk</span> <span class="o">(</span><span class="n">finset.mem_image_of_mem</span> <span class="n">_</span> <span class="bp">$</span> <span class="n">finset.mem_univ</span> <span class="n">_</span><span class="o">),</span>
</code></pre></div>



<a name="281614408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614408">(May 08 2022 at 19:31)</a>:</h4>
<p>Ideally <code>is_empty</code> would not be a class in the first place, and you could just write <code>apply det_is_empty</code> and then the rest.</p>



<a name="281614473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614473">(May 08 2022 at 19:32)</a>:</h4>
<p>Sure, but</p>
<ol>
<li>It should be a class</li>
<li>My specific problem has little to do with the tactic gap that I just uncovered</li>
</ol>



<a name="281614579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614579">(May 08 2022 at 19:35)</a>:</h4>
<p>But I think this is really a representative example--my biggest problem with type class abuse is precisely that it makes these kinds of proofs more awkward. In the best case you make <code>I</code> duplicates of a bunch of tactics but it's still worse than just proving stuff normally; here you had to spell out the exact <code>is_empty</code> statement you need.</p>



<a name="281614629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614629">(May 08 2022 at 19:36)</a>:</h4>
<p>I think what would make the situation more tolerable is something like an <code>apply</code> tactic that turns failed instance searches into new goals</p>



<a name="281614647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614647">(May 08 2022 at 19:37)</a>:</h4>
<p>We should either have both <code>haveI</code> and <code>sufficesI</code> or none of them, because they fulfill the exact same role. Is your solution to delete <code>haveI</code>?</p>



<a name="281614702"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614702" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614702">(May 08 2022 at 19:38)</a>:</h4>
<p>??</p>



<a name="281614713"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614713" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614713">(May 08 2022 at 19:38)</a>:</h4>
<p>There's a mismatch between <code>have</code> and <code>suffices</code>. This mismatch shouldn't exist. What is your solution to it?</p>



<a name="281614728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614728">(May 08 2022 at 19:39)</a>:</h4>
<p>Why do I need a solution?</p>



<a name="281614730"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614730" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614730">(May 08 2022 at 19:39)</a>:</h4>
<p>I think adding <code>sufficesI</code> is okay; but it doesn't address the real issue</p>



<a name="281614773"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614773" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614773">(May 08 2022 at 19:40)</a>:</h4>
<p>Sure, we can also add <code>applyI</code> which does what you say. I think this would be ideal.</p>



<a name="281614780"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614780" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614780">(May 08 2022 at 19:40)</a>:</h4>
<p>We have <code>apply_with</code></p>



<a name="281614789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614789">(May 08 2022 at 19:40)</a>:</h4>
<p>And you can just use <code>suffices : foo, { resetI, bar }</code>.</p>



<a name="281614801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614801">(May 08 2022 at 19:41)</a>:</h4>
<p>How does one use <code>apply_with</code>?</p>



<a name="281614866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614866">(May 08 2022 at 19:42)</a>:</h4>
<p><code>apply_with ... { instances := ff }</code></p>



<a name="281614984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281614984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281614984">(May 08 2022 at 19:45)</a>:</h4>
<p>Does that mean <em>all</em> instance arguments will become new goals? That's probably not ideal either</p>



<a name="281615104"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281615104" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281615104">(May 08 2022 at 19:48)</a>:</h4>
<p>Yeah, that's what it does. When I do it I usually have to do <code>any_goal { apply_instance }</code> right after</p>



<a name="281616904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281616904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281616904">(May 08 2022 at 20:33)</a>:</h4>
<p>It might be that adding a <code>tactic.swap</code> at the end of the <code>haveI</code> tactic would generate the <code>sufficesI</code> tactic.<br>
I'm not at a computer, so cannot check now, though.</p>



<a name="281617787"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281617787" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281617787">(May 08 2022 at 20:54)</a>:</h4>
<p>You could use <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#exactI">tactic#exactI</a> here:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="k">suffices</span> <span class="o">:</span> <span class="n">is_empty</span> <span class="o">{</span><span class="n">a</span> <span class="bp">//</span> <span class="n">b</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">k</span><span class="o">},</span>
  <span class="o">{</span> <span class="n">exactI</span> <span class="n">det_is_empty</span> <span class="o">},</span>
  <span class="n">refine</span> <span class="n">subtype.is_empty_of_false</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rintro</span> <span class="n">a</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hbk</span> <span class="o">(</span><span class="n">finset.mem_image_of_mem</span> <span class="n">_</span> <span class="bp">$</span> <span class="n">finset.mem_univ</span> <span class="n">_</span><span class="o">),</span>
</code></pre></div>
<p>Or there's</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="k">suffices</span> <span class="o">:</span> <span class="n">is_empty</span> <span class="o">{</span><span class="n">a</span> <span class="bp">//</span> <span class="n">b</span> <span class="n">a</span> <span class="bp">=</span> <span class="n">k</span><span class="o">},</span>
  <span class="n">unfreezingI</span> <span class="o">{</span> <span class="n">exact</span> <span class="n">det_is_empty</span> <span class="o">},</span>
  <span class="n">refine</span> <span class="n">subtype.is_empty_of_false</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">rintro</span> <span class="n">a</span> <span class="n">rfl</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hbk</span> <span class="o">(</span><span class="n">finset.mem_image_of_mem</span> <span class="n">_</span> <span class="bp">$</span> <span class="n">finset.mem_univ</span> <span class="n">_</span><span class="o">),</span>
</code></pre></div>
<p>but <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#unfreezingI">tactic#unfreezingI</a> doesn't focus the goal.</p>



<a name="281617931"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/sufficesI/near/281617931" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/sufficesI.html#281617931">(May 08 2022 at 20:58)</a>:</h4>
<p>For longer proofs inside the first <code>suffices</code> goal, you can put <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#resetI">tactic#resetI</a> at the beginning. I think the value-add of <code>haveI</code> is that you don't have to do <code>have : foo, { ...}, resetI, ...</code> with the <code>resetI</code> potentially far away from the <code>have</code>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>