---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Come.20on.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html">Come on</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="226294894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226294894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226294894">(Feb 14 2021 at 09:21)</a>:</h4>
<p>Come on Lean :-)</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="bp">@</span><span class="n">approximates_linear_on.image_mem_nhds.</span><span class="o">{</span><span class="n">u_1</span> <span class="n">u_2</span> <span class="n">u_3</span><span class="o">}</span> <span class="bp">ùïú</span> <span class="n">_inst_1</span> <span class="n">E</span> <span class="n">_inst_2</span> <span class="n">_inst_3</span> <span class="n">F</span> <span class="n">_inst_4</span> <span class="n">_inst_5</span> <span class="n">cs</span> <span class="n">f</span> <span class="n">s</span> <span class="n">c</span> <span class="n">f'</span>
    <span class="n">f'symm</span>
    <span class="n">hf</span>
    <span class="n">x</span>
    <span class="n">hs</span>
<span class="n">term</span>
  <span class="n">hs</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">has_mem.mem.</span><span class="o">{</span><span class="n">u_2</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">(</span><span class="n">set.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="n">filter.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">filter.has_mem.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span><span class="o">)</span> <span class="n">s</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">nhds.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space.to_topological_space.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">metric_space.to_uniform_space'.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span> <span class="o">(</span><span class="bp">@</span><span class="n">normed_group.to_metric_space.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span> <span class="n">_inst_2</span><span class="o">)))</span>
       <span class="n">x</span><span class="o">)</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="bp">@</span><span class="n">has_mem.mem.</span><span class="o">{</span><span class="n">u_2</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">(</span><span class="n">set.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="n">filter.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span><span class="o">)</span> <span class="o">(</span><span class="bp">@</span><span class="n">filter.has_mem.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span><span class="o">)</span> <span class="n">s</span>
    <span class="o">(</span><span class="bp">@</span><span class="n">nhds.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span>
       <span class="o">(</span><span class="bp">@</span><span class="n">uniform_space.to_topological_space.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span>
          <span class="o">(</span><span class="bp">@</span><span class="n">metric_space.to_uniform_space'.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span> <span class="o">(</span><span class="bp">@</span><span class="n">normed_group.to_metric_space.</span><span class="o">{</span><span class="n">u_2</span><span class="o">}</span> <span class="n">E</span> <span class="n">_inst_2</span><span class="o">)))</span>
       <span class="n">x</span><span class="o">)</span>
</code></pre></div>
<p>I'm sure I'll find a way to help Lean, but I am still amazed at how well it works like 99.9% of the time, and how sometimes it chokes for no reason I can spot.</p>



<a name="226295014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226295014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226295014">(Feb 14 2021 at 09:25)</a>:</h4>
<p>There were two things named <code>s</code>. So the stupid one here wasn't Lean ;-)</p>



<a name="226299288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226299288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226299288">(Feb 14 2021 at 11:14)</a>:</h4>
<p>I think, lean (editor integration) should warn users when they have two variables with the same name in tactic context.</p>



<a name="226301348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226301348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226301348">(Feb 14 2021 at 12:07)</a>:</h4>
<p>This occasionally catches me out too. I know there's some technical reason why it's hard to spot duplicate names but there are so many smart people here, there must be a trick. Recently I've started to try and be really principled about variable names, calling things <code>hxS</code> if they say <code>x \in S</code> rather than just h and this was partly the reason. I even try to name all variables after things like <code>split_ifs</code> rather than just getting a bunch of <code>h</code>s. I was rather proud when a student asked me in my class why they could not name a hypothesis <code>h\notP</code> because they even thought that lean demanded such principled choices. I think tactics like <code>split_ifs</code> should arguably fail if the user doesn't give variable names (I know the CS people will disagree but didn't someone say that this will be the default in lean 4?) and I'm wondering whether the system should tell us what to write here and generally try and keep us more honest with variable naming eg by checking for dupes. On a blackboard I can't just say "now introduce this nameless variable" and students and lecturers both get confused if lecturers call two things X. It should be banned!</p>



<a name="226303100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226303100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226303100">(Feb 14 2021 at 12:55)</a>:</h4>
<p>But "now introduce this nameless hypothesis" is reasonably on a blackboard, right?</p>



<a name="226303393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226303393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226303393">(Feb 14 2021 at 13:03)</a>:</h4>
<p>"Let's assume that..."</p>



<a name="226303674"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226303674" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226303674">(Feb 14 2021 at 13:11)</a>:</h4>
<p>If you're going to use it again you call it (*), right?</p>



<a name="226307180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226307180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226307180">(Feb 14 2021 at 14:35)</a>:</h4>
<p>Lean 4 suffixes shadowed variables with a cross<span aria-label="cross" class="emoji emoji-271d" role="img" title="cross">:cross:</span> to show It's Dead, Jim</p>
<blockquote>
<p>I think tactics like split_ifs should arguably fail if the user doesn't give variable names (I know the CS people will disagree but didn't someone say that this will be the default in lean 4?)</p>
</blockquote>
<p><em>By default</em>, anonymously introduced hypotheses are inaccessible in Lean 4. They also get a cross (out of the door, line on the left).</p>



<a name="226308246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226308246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226308246">(Feb 14 2021 at 15:00)</a>:</h4>
<p>There have been times with some tactics (<code>rcases</code>?) when I have been literally unable to name the variables it spits out :-/</p>



<a name="226309733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Come%20on/near/226309733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Come.20on.html#226309733">(Feb 14 2021 at 15:30)</a>:</h4>
<p>For hypotheses spit out by things like split cases, french quotes have been useful in the cases where I don't want to worry about name tracking, or where restructuring of goals would have changed the auto-generated names anyway. So like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- The second simplicial identity -/</span>
<span class="kd">lemma</span> <span class="n">Œ¥_comp_œÉ_of_le</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">{</span><span class="n">i</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">2</span><span class="o">)}</span> <span class="o">{</span><span class="n">j</span> <span class="o">:</span> <span class="n">fin</span> <span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)}</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">‚â§</span> <span class="n">j.cast_succ</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">Œ¥</span> <span class="n">i.cast_succ</span> <span class="bp">‚â´</span> <span class="n">œÉ</span> <span class="n">j.succ</span> <span class="bp">=</span> <span class="n">œÉ</span> <span class="n">j</span> <span class="bp">‚â´</span> <span class="n">Œ¥</span> <span class="n">i</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">ext</span> <span class="n">k</span><span class="o">,</span>
  <span class="n">dsimp</span> <span class="o">[</span><span class="n">Œ¥</span><span class="o">,</span> <span class="n">œÉ</span><span class="o">,</span> <span class="n">fin.succ_above</span><span class="o">,</span> <span class="n">fin.pred_above</span><span class="o">],</span>
  <span class="n">rcases</span> <span class="n">i</span> <span class="k">with</span> <span class="o">‚ü®</span><span class="n">i</span><span class="o">,</span> <span class="n">_</span><span class="o">‚ü©,</span>
  <span class="n">rcases</span> <span class="n">j</span> <span class="k">with</span> <span class="o">‚ü®</span><span class="n">j</span><span class="o">,</span> <span class="n">_</span><span class="o">‚ü©,</span>
  <span class="n">rcases</span> <span class="n">k</span> <span class="k">with</span> <span class="o">‚ü®</span><span class="n">k</span><span class="o">,</span> <span class="n">_</span><span class="o">‚ü©,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">subtype.mk_le_mk</span><span class="o">,</span> <span class="n">fin.cast_succ_mk</span><span class="o">]</span> <span class="n">at</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">simp</span> <span class="k">with</span> <span class="n">push_cast</span><span class="o">,</span> <span class="c1">-- `simp?` doesn't work here</span>
  <span class="n">split_ifs</span><span class="o">,</span>
  <span class="c1">-- Hope for the best from `linarith`:</span>
  <span class="n">all_goals</span> <span class="o">{</span> <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span> <span class="n">try</span> <span class="o">{</span> <span class="n">linarith</span> <span class="o">},</span> <span class="o">},</span>
  <span class="c1">-- Two of the goals need special handling:</span>
  <span class="o">{</span> <span class="k">have</span> <span class="o">:=</span> <span class="n">nat.le_of_pred_lt</span> <span class="o">‚Äπ</span><span class="n">fin.cast_succ</span> <span class="o">(</span><span class="n">fin.pred</span> <span class="o">‚ü®</span><span class="n">k</span><span class="o">,</span> <span class="n">k_property</span><span class="o">‚ü©</span> <span class="n">_</span><span class="o">)</span> <span class="bp">&lt;</span> <span class="o">‚ü®</span><span class="n">i</span><span class="o">,</span> <span class="n">i_property</span><span class="o">‚ü©‚Ä∫,</span>
    <span class="n">change</span> <span class="n">k</span> <span class="bp">‚â§</span> <span class="n">i</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">linarith</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="o">(</span><span class="n">nat.succ_pred_eq_of_pos</span> <span class="o">(</span><span class="n">lt_of_le_of_lt</span> <span class="o">(</span><span class="n">zero_le</span> <span class="n">_</span><span class="o">)</span> <span class="o">‚Äπ</span><span class="n">j</span> <span class="bp">&lt;</span> <span class="n">k</span><span class="o">‚Ä∫))</span><span class="bp">.</span><span class="n">symm</span><span class="o">,</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>