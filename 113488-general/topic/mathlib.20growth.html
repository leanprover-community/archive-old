---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/mathlib.20growth.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html">mathlib growth</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="264852297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264852297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264852297">(Dec 14 2021 at 12:52)</a>:</h4>
<p>Over at <a href="#narrow/stream/113488-general/topic/lines.20per.20commit/near/264120072">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lines.20per.20commit/near/264120072</a> I asked about the trend for lines per commit to mathlib master. I received some helpful replies.</p>
<p>I'm trying to understand mathlib growth better. The graphs at <a href="https://leanprover-community.github.io/mathlib_stats.html">https://leanprover-community.github.io/mathlib_stats.html</a> suggest a pretty stable linear growth rate, with a singular increase in derivate around the start of the covid pandemic (correlation?).</p>
<p>The number of contributors is growing, but the number of lines added per month isn't. One explanation is that the number of contributors per month is quite stable. For every new contributor, an old one stops contributing.</p>
<ul>
<li>Does the data support that hypothesis?</li>
<li>What is the average number of commits per contributor? How is this distributed?</li>
<li>Other interesting metrics?</li>
</ul>
<p>I have no skills at all in the data science department. If someone can help me out, that would be great.</p>



<a name="264853385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264853385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264853385">(Dec 14 2021 at 13:00)</a>:</h4>
<p>It would be interesting to know how much work is devoted to refactoring and how much to prove new theorem. But I don't know how to measure it.</p>



<a name="264853416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264853416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264853416">(Dec 14 2021 at 13:00)</a>:</h4>
<p>Number of lines added - number of lines removed?</p>



<a name="264853636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264853636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264853636">(Dec 14 2021 at 13:02)</a>:</h4>
<p>This is an interesting idea!</p>



<a name="264853707"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264853707" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264853707">(Dec 14 2021 at 13:03)</a>:</h4>
<p>My net total usually goes down when I refactor, for example.</p>



<a name="264853833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264853833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264853833">(Dec 14 2021 at 13:04)</a>:</h4>
<p>Right. All the golfing attempts fight against the growth trend. If mathlib grows 25K lines in a month, it actually grew a bit more, probably. But I have no idea by how much.</p>



<a name="264853838"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264853838" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264853838">(Dec 14 2021 at 13:04)</a>:</h4>
<p>I am thinking about stuff like changing the definition of a group (I don't find the PR). Does someone has the PR number?</p>



<a name="264853985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264853985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264853985">(Dec 14 2021 at 13:05)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/7255">#7255</a></p>



<a name="264854974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264854974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264854974">(Dec 14 2021 at 13:14)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span> Another hypothesis is that space for contribution saturates as the lib grows. And people do get involved in refactoring and/or simplification. That is, the lib can also evolve with line removals</p>



<a name="264863308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264863308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264863308">(Dec 14 2021 at 14:17)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/7255">#7255</a> had 634 lines added and 465 removed. Added - removed gives 169, that is surely not a lot considering the work done, so this seems a reasonable thing to consider if we want to ignore refactoring</p>



<a name="264882758"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264882758" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264882758">(Dec 14 2021 at 16:20)</a>:</h4>
<p>If I look at the <code>commits per month</code> graph, the growth definitely seems to be increasing (even when ignoring all data before March 2020). The lowest months of 2021 (May and July) are about or above average when compared to the period 2020-03 till 2020-12.</p>



<a name="264882919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264882919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264882919">(Dec 14 2021 at 16:22)</a>:</h4>
<p>So I'm not sure if "linear growth rate" is accurate. But it's possible that the number of commits has increased, but the size of commits has decreased.</p>



<a name="264885876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264885876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264885876">(Dec 14 2021 at 16:40)</a>:</h4>
<p>If you do want a growth metric that includes refactoring, lines added + lines removed might be interesting. On our stats page, an increase here would only show up in the commit graph, where it could be obscured by other things.</p>



<a name="264891328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264891328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264891328">(Dec 14 2021 at 17:12)</a>:</h4>
<p>Backwards moving average (20-sized windows) of the metric Rob mentioned (using the data mentioned <a href="#narrow/stream/113488-general/topic/lines.20per.20commit/near/264130359">here</a>):<br>
<a href="/user_uploads/3121/qlktqEp8TLD1oFFMZsK8emCp/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/qlktqEp8TLD1oFFMZsK8emCp/image.png" title="image.png"><img src="/user_uploads/3121/qlktqEp8TLD1oFFMZsK8emCp/image.png"></a></div>



<a name="264891557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264891557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264891557">(Dec 14 2021 at 17:14)</a>:</h4>
<p>Can you make the window time-based rather than commit based?</p>



<a name="264892185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264892185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264892185">(Dec 14 2021 at 17:17)</a>:</h4>
<p>The data doesn't have that info :/</p>



<a name="264893323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264893323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264893323">(Dec 14 2021 at 17:24)</a>:</h4>
<p>I also wanted to check the "average journey of a mathlib contributor", motivated by the hypothesis that Johan raised. I thought about plotting contribution metrics by tenure (after the first contribution), normalized by the average size of the contributions (attempting to mitigate the bias that person A contributes more than person B in volume). I'd expect to see the contribution volume decreasing after the first contribution</p>



<a name="264894503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264894503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264894503">(Dec 14 2021 at 17:31)</a>:</h4>
<p>I think to get useful graphs, it will be very helpful to have data that contains commit timestamps. Is that hard to get?</p>



<a name="264894854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264894854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264894854">(Dec 14 2021 at 17:33)</a>:</h4>
<p>There's a git API in Python that you could use to extract the data pretty easily</p>



<a name="264895377"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264895377" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264895377">(Dec 14 2021 at 17:36)</a>:</h4>
<p>That would make things easier. I glanced through the GitHub API and I couldn't find it. It's a big API</p>



<a name="264895766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264895766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264895766">(Dec 14 2021 at 17:39)</a>:</h4>
<p>The GitHub API is different, although if you want to associate contributors to GitHub user accounts you'd have to use it too. I was talking about <a href="https://gitpython.readthedocs.io/en/stable/">https://gitpython.readthedocs.io/en/stable/</a></p>



<a name="264896818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264896818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264896818">(Dec 14 2021 at 17:46)</a>:</h4>
<p>Nice! I might take a loot at it later</p>



<a name="264959197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264959197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264959197">(Dec 15 2021 at 02:57)</a>:</h4>
<p>Okay, I finally had some time to take a look at it. Turns out GitHub blocked me from using the API because I made too many requests (<code>mathlib</code> has too many commits).</p>
<p>So I created a Python script that parses the returns from terminal calls and processes everything locally. Here's the <a href="https://gist.github.com/arthurpaulino/f9d270d39872f42ca31cc6ad6dd76b5c">gist</a> if anyone wants to use it.</p>
<p>And here is the <a href="/user_uploads/3121/qyD5FbjWZgzLDN76vRLlMBIG/git_stats.zip">extracted data</a> <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="264960031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264960031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264960031">(Dec 15 2021 at 03:13)</a>:</h4>
<p>And here's the graph with line changes per day (smoothed) across time:<br>
<a href="/user_uploads/3121/sUjhisJq5pC8z8-U1tQEk8nY/image.png">image.png</a></p>
<div class="message_inline_image"><a href="/user_uploads/3121/sUjhisJq5pC8z8-U1tQEk8nY/image.png" title="image.png"><img src="/user_uploads/3121/sUjhisJq5pC8z8-U1tQEk8nY/image.png"></a></div>



<a name="264960459"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264960459" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264960459">(Dec 15 2021 at 03:21)</a>:</h4>
<p>Looks like a good moment to buy <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></p>



<a name="264966784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264966784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264966784">(Dec 15 2021 at 05:14)</a>:</h4>
<p><span class="user-mention" data-user-id="451983">@Arthur Paulino</span> Great! Thanks for doing this</p>



<a name="264976312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264976312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264976312">(Dec 15 2021 at 08:10)</a>:</h4>
<p>Your <code>get_commit_hashes</code> is secretly <code>git log --pretty='format:%H'</code>, by the way</p>



<a name="264976657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264976657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264976657">(Dec 15 2021 at 08:16)</a>:</h4>
<p>Probably simpler to parse what you want from <code>git log --pretty='format:%H%x00%an%x00%ai' --numstat</code></p>



<a name="264976781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264976781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264976781">(Dec 15 2021 at 08:17)</a>:</h4>
<p>which outputs the complete list of commits in the form:<br>
<code>long-hash</code> null-byte <code>author name</code> null-byte <code>author date in ISO format</code> newline<br>
followed by a list of files changed in the form <code>lines-added</code> whitespace <code>lines-deleted</code> whitespace filename</p>



<a name="264976866"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264976866" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264976866">(Dec 15 2021 at 08:18)</a>:</h4>
<p>(just saves the multiple calls to <code>git</code> really)</p>



<a name="264978463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264978463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264978463">(Dec 15 2021 at 08:37)</a>:</h4>
<ul>
<li>
<p>Is it possible to count the number of characters rather than just lines?</p>
</li>
<li>
<p>Is there any usable information in the content of commit or PR descriptions — for example, what fraction of commits contain "golf"?</p>
</li>
<li>
<p>Can we count the growth rate of the number of <code>lemma</code>s, <code>theorem</code>s, <code>def</code>s, <code>class</code>es etc?</p>
</li>
</ul>



<a name="264983068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983068">(Dec 15 2021 at 09:25)</a>:</h4>
<p>Thanks <span class="user-mention" data-user-id="117987">@Patrick Stevens</span> !<br>
Any other format option to extract the info Stuart asked for?</p>



<a name="264983489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983489">(Dec 15 2021 at 09:29)</a>:</h4>
<p>Actually I will check the documentation for <code>--pretty</code> later <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span> <br>
This is very useful knowledge</p>



<a name="264983500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983500">(Dec 15 2021 at 09:29)</a>:</h4>
<p>Have you considered using gitpython as Rob suggested?</p>



<a name="264983630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983630">(Dec 15 2021 at 09:30)</a>:</h4>
<p>Yes but I got blocked. Unless I did something wrong (totally possible)</p>



<a name="264983658"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983658" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983658">(Dec 15 2021 at 09:31)</a>:</h4>
<p>By what?</p>



<a name="264983661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983661">(Dec 15 2021 at 09:31)</a>:</h4>
<p>Gitpython works offline</p>



<a name="264983665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983665">(Dec 15 2021 at 09:31)</a>:</h4>
<p>By GitHub</p>



<a name="264983710"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983710" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983710">(Dec 15 2021 at 09:31)</a>:</h4>
<p>You should be able to use gitpython on a local clone</p>



<a name="264983753"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983753" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983753">(Dec 15 2021 at 09:32)</a>:</h4>
<p>There. I misused it <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="264983795"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264983795" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264983795">(Dec 15 2021 at 09:32)</a>:</h4>
<p>I didn't even know that it supported any part of the github api</p>



<a name="264984147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264984147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264984147">(Dec 15 2021 at 09:36)</a>:</h4>
<p>I still want to learn about --pretty tho, so I might as well do both</p>



<a name="264991675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264991675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264991675">(Dec 15 2021 at 10:51)</a>:</h4>
<p><span class="user-mention" data-user-id="451983">@Arthur Paulino</span> Thanks for doing this. I think it's great to get some insight into this data.</p>



<a name="264997399"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/264997399" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#264997399">(Dec 15 2021 at 11:43)</a>:</h4>
<p>Peeking at commit diffs content is a bit more expensive, but should be feasible</p>



<a name="265011891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265011891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265011891">(Dec 15 2021 at 13:49)</a>:</h4>
<p><a href="https://gist.github.com/arthurpaulino/f9d270d39872f42ca31cc6ad6dd76b5c">Gist</a> updated with Patrick's tips. It's waaaay shorter and faster <span aria-label="pray" class="emoji emoji-1f64f" role="img" title="pray">:pray:</span></p>



<a name="265011913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265011913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265011913">(Dec 15 2021 at 13:49)</a>:</h4>
<p>I also got slightly curious, so here's a notebook you may also find very slightly useful if you didn't poke at gitpython too much yet: <a href="https://gist.github.com/Julian/3cb202d9461e73b6c06dd564683f5118">https://gist.github.com/Julian/3cb202d9461e73b6c06dd564683f5118</a></p>
<p>I was on my way to trying to train some simple model but got tied up grading finals womp womp so probably no more for me till later.</p>



<a name="265012344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265012344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265012344">(Dec 15 2021 at 13:52)</a>:</h4>
<p>I'm gonna use gitpython to get more details about the commit and the diffs (I suppose it's possible to look at diffs in gitpython)</p>



<a name="265012467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265012467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265012467">(Dec 15 2021 at 13:53)</a>:</h4>
<p>About <code>"area": file.split("/")[1] if "/" in file else None,</code>: I thought about doing something similar, but a commit might tweak more than 1 area so I left it for later</p>



<a name="265012491"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265012491" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265012491">(Dec 15 2021 at 13:53)</a>:</h4>
<p>yes you can look at diffs in gitpython</p>



<a name="265012509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265012509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265012509">(Dec 15 2021 at 13:54)</a>:</h4>
<p>right in that dataset above one row is not a commit</p>



<a name="265012549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265012549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Julian Berman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265012549">(Dec 15 2021 at 13:54)</a>:</h4>
<p>it's a single file in a single commit</p>



<a name="265012592"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265012592" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265012592">(Dec 15 2021 at 13:54)</a>:</h4>
<p>Got it</p>



<a name="265012725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265012725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265012725">(Dec 15 2021 at 13:55)</a>:</h4>
<p>Right, I'm blind <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span> </p>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="k">for</span> <span class="n">commit</span> <span class="ow">in</span> <span class="n">repo</span><span class="o">.</span><span class="n">iter_commits</span><span class="p">()</span>
<span class="k">for</span> <span class="n">file</span><span class="p">,</span> <span class="n">stats</span> <span class="ow">in</span> <span class="n">commit</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">files</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</code></pre></div>



<a name="265013736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265013736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265013736">(Dec 15 2021 at 14:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="422543">Stuart Presnell</span> <a href="#narrow/stream/113488-general/topic/mathlib.20growth/near/264978463">said</a>:</p>
<blockquote>
<ul>
<li>
<p>Is it possible to count the number of characters rather than just lines?</p>
</li>
<li>
<p>Is there any usable information in the content of commit or PR descriptions — for example, what fraction of commits contain "golf"?</p>
</li>
<li>
<p>Can we count the growth rate of the number of <code>lemma</code>s, <code>theorem</code>s, <code>def</code>s, <code>class</code>es etc?</p>
</li>
</ul>
</blockquote>
<p>Counting declarations (properly) goes beyond git. You can't get an accurate number without a compiled mathlib, which even if you wanted to get Azure caches, we don't have for every commit. So this data would take weeks to collect. You'd have to approximate it by counting occurences of <code>lemma</code>/<code>theorem</code>/<code>inductive</code> etc in the text.</p>



<a name="265013809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265013809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265013809">(Dec 15 2021 at 14:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/113488-general/topic/mathlib.20growth/near/264960031">said</a>:</p>
<blockquote>
<p>And here's the graph with line changes per day (smoothed) across time:<br>
<a href="/user_uploads/3121/sUjhisJq5pC8z8-U1tQEk8nY/image.png">image.png</a></p>
</blockquote>
<p>Sorry if I'm missing something, what are MA_25/50/100?</p>



<a name="265014057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265014057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265014057">(Dec 15 2021 at 14:03)</a>:</h4>
<p><span class="user-mention" data-user-id="110596">@Rob Lewis</span> those are backward moving averages of 25/50/100 days (ago)</p>



<a name="265014577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265014577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265014577">(Dec 15 2021 at 14:07)</a>:</h4>
<p>And yeah, counting declarations is a bit noisy because if a declaration is renamed or moved around, there will be a "removed" declaration and a "created" one</p>



<a name="265095429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265095429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265095429">(Dec 16 2021 at 00:08)</a>:</h4>
<p>Found some extra time to play around with mathlib3 git data. This time using part of <span class="user-mention" data-user-id="321696">@Julian Berman</span>'s logic to extract it.</p>
<p><a href="https://gist.github.com/arthurpaulino/42b45382463ec6832f947f766e42a0f8">Here's the notebook!</a></p>



<a name="265097261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265097261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265097261">(Dec 16 2021 at 00:31)</a>:</h4>
<p>I was able to learn some interesting details about mathlib.</p>
<ul>
<li>Before humans existed, mathlib didn't have a <code>src</code> folder and every field of study had a folder in the root directory of the repository</li>
<li>Mathlib has a reasonably high rate of line removals per commit, which reflects the community's concern about modularity/organization (actually, let me add this one graph)</li>
<li>Not only the number of cumulative contributors is growing across time, which is obviously expected, but also the number of <em>distinct</em> contributors by month. I believe this is a very healthy sign of success</li>
<li>I was rather surprised by the fact that the ratio of <code>k-stayers</code> is roughly stable since the beginnings of time</li>
</ul>



<a name="265116434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathlib%20growth/near/265116434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathlib.20growth.html#265116434">(Dec 16 2021 at 06:19)</a>:</h4>
<p><span class="user-mention" data-user-id="451983">@Arthur Paulino</span> Great! These are exactly the kind of insights that I was hoping for. (I distinctly remember the moment in time when humans appeared, and all top-level folder were moved into <code>src/</code>.)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>