---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html">Lean 4 as a general programming language</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="218904221"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218904221" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218904221">(Dec 04 2020 at 23:27)</a>:</h4>
<p>Hello, I'm new to Lean and I find it a very interesting project. My question is if Lean 4 is meant to be able to be used as a general application programming language in the same sense as Rust, Haskell, Scala, Idris etc? Will you be able to write efficient desktop/server/JavaScript applications in Lean?</p>
<p>If so, is there (planned) support for C-like primitives like unboxed fixed sized primitive types, structs and arrays? I suppose so since there seem to be a foreign C function interface and there are many compiler optimization for memory handling etc.</p>



<a name="218904365"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218904365" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218904365">(Dec 04 2020 at 23:29)</a>:</h4>
<p>Basically no, it may be possible to write a general application in Lean 4 but it will not really be a good idea. Things you need for general programming like encryption or networking libraries are extremely low priority or perhaps never-to-be-implemented for lean</p>



<a name="218904750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218904750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218904750">(Dec 04 2020 at 23:33)</a>:</h4>
<p>Can those not be provided using FFI calls? Though t<br>
hat probably requires that the Lean compiler has support for C-like primitives the same way Rust (and Haskell to a certain extent) has for example</p>



<a name="218904881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218904881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218904881">(Dec 04 2020 at 23:34)</a>:</h4>
<p>I just think you will have a miserable time doing it. It might technically be possible. It's like writing an ssh client in redstone in minecraft, sure it's probably possible in theory, but it's really not what the tool is designed for</p>



<a name="218904953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218904953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218904953">(Dec 04 2020 at 23:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="238605">Kevin Lacker</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218904881">said</a>:</p>
<blockquote>
<p>I just think you will have a miserable time doing it. It might technically be possible. It's like writing an ssh client in redstone in minecraft, sure it's probably possible in theory, but it's really not what the tool is designed for</p>
</blockquote>
<p>i mean, lean 4 is implemented in lean 4. i don't see why using lean 4 as a general purpose programming language is so outlandish.</p>



<a name="218904983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218904983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218904983">(Dec 04 2020 at 23:35)</a>:</h4>
<p>for libraries you can use the FFI, yup.</p>



<a name="218905068"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905068" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905068">(Dec 04 2020 at 23:36)</a>:</h4>
<p>My impression was that Leo wanted Lean 4 to compete with Haskell, but I don't know what they are competing over, perhaps the scope is less broad. Someone on the Discord made a Sudoku game in Lean 3 :-)</p>



<a name="218905202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905202">(Dec 04 2020 at 23:38)</a>:</h4>
<p>I just read the paper about the RC implementation in Lean 4 and it definitely seems to be generally applicable to general functional programming languages (I believe it even says so in the paper), but maybe the optimizations in there were primarily to make theorem proving faster.</p>



<a name="218905210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905210">(Dec 04 2020 at 23:38)</a>:</h4>
<p>the majority of programming primitives in lean 4 already have an efficient C backend. e.g. <a href="https://github.com/leanprover/lean4/blob/master/src/Init/Data/Array/Basic.lean#L19">arrays</a> or <a href="https://github.com/leanprover/lean4/blob/master/src/Init/Data/Int/Basic.lean#L35">integers</a>.</p>



<a name="218905320"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905320" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905320">(Dec 04 2020 at 23:40)</a>:</h4>
<p><span class="user-mention silent" data-user-id="221921">Marc Huisinga</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218905210">said</a>:</p>
<blockquote>
<p>the majority of programming primitives in lean 4 already have an efficient C backend. e.g. <a href="https://github.com/leanprover/lean4/blob/master/src/Init/Data/Array/Basic.lean#L19">arrays</a> or <a href="https://github.com/leanprover/lean4/blob/master/src/Init/Data/Int/Basic.lean#L35">integers</a>.</p>
</blockquote>
<p>Is there support for 32- and 64-bit fixed width integers for example? And "flat" arrays?</p>



<a name="218905345"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905345" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905345">(Dec 04 2020 at 23:41)</a>:</h4>
<p>let me put it this way... if you are looking to write "efficient desktop/server/JavaScript applications in Lean", then you should first think of the libraries that such applications would need. in particular, you'll need an HTTP library and some way to deal with the system's UI. you either have to write those yourself, or someone has already made some for Lean. writing those yourself is probably a bad idea, or at least it will take a while.</p>



<a name="218905367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905367">(Dec 04 2020 at 23:41)</a>:</h4>
<p>maybe someday those things will exist in Lean. Lean 4 is certainly progress in that direction. however, this set of features isn't on the horizon, so, i wouldn't hold my breath</p>



<a name="218905444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905444">(Dec 04 2020 at 23:43)</a>:</h4>
<p>You might enjoy <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span>'s demo as part of Lean 4 @ PLDI 2020 if you haven't seen it<br>
<a href="https://www.youtube.com/watch?v=TgHISG-81wM">https://www.youtube.com/watch?v=TgHISG-81wM</a> (47:41 in), and of course the talk itself is very informative about what the developers want lean 4 to be.</p>
<div class="youtube-video message_inline_image"><a data-id="TgHISG-81wM" href="https://www.youtube.com/watch?v=TgHISG-81wM"><img src="https://i.ytimg.com/vi/TgHISG-81wM/default.jpg"></a></div>



<a name="218905546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905546">(Dec 04 2020 at 23:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="369607">Jesper Nordenberg</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218905320">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="221921">Marc Huisinga</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218905210">said</a>:</p>
<blockquote>
<p>the majority of programming primitives in lean 4 already have an efficient C backend. e.g. <a href="https://github.com/leanprover/lean4/blob/master/src/Init/Data/Array/Basic.lean#L19">arrays</a> or <a href="https://github.com/leanprover/lean4/blob/master/src/Init/Data/Int/Basic.lean#L35">integers</a>.</p>
</blockquote>
<p>Is there support for 32- and 64-bit fixed width integers for example? And "flat" arrays?</p>
</blockquote>
<p>i'm not sure if fixed-width integers in particular exist yet, but there are uint* types: <a href="https://github.com/leanprover/lean4/blob/master/src/Init/Data/UInt.lean">https://github.com/leanprover/lean4/blob/master/src/Init/Data/UInt.lean</a></p>



<a name="218905557"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905557" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905557">(Dec 04 2020 at 23:45)</a>:</h4>
<p><span class="user-mention" data-user-id="238605">@Kevin Lacker</span> Depends, if you for example have a JavaScript backend you can quite easily write web application with some FFI to the browser API's</p>
<p>And a basic web server doesn't require that many system libraries</p>



<a name="218905699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905699">(Dec 04 2020 at 23:47)</a>:</h4>
<p><span class="user-mention" data-user-id="221921">@Marc Huisinga</span> Interesting, ByteArray and FloatArray seem to be available as well</p>



<a name="218905802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905802">(Dec 04 2020 at 23:49)</a>:</h4>
<p><span class="user-mention" data-user-id="127136">@Alex J. Best</span> Yes, I watched that video, very informative</p>



<a name="218905809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218905809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218905809">(Dec 04 2020 at 23:50)</a>:</h4>
<p>I guess it depends on the application you're thinking of... why would you want to use lean for a web application? if you wanted to do something like, a user enters some mathematical formula, and lean tries to prove it, then it might make sense. but you'd probably be better off making the bulk of the web app in something else, and keeping the lean process separate. easier to just interact between the processes in one spot rather than FFIing a bunch of stuff with a web server</p>



<a name="218906003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218906003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218906003">(Dec 04 2020 at 23:53)</a>:</h4>
<p><span class="user-mention" data-user-id="238605">@Kevin Lacker</span> Well, I want to use a powerful functional programming language to write efficient applications with. There's not a lot of choices available, Scala is nice but not as powerful as Lean and Idris (at least in some ways), Rust is very efficient but also low level and quite restricted, Haskell is tricky to write efficient code in etc.</p>



<a name="218906108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218906108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218906108">(Dec 04 2020 at 23:55)</a>:</h4>
<p>To me it seems like Lean has the potential to be both very powerful and efficient considering the memory management optimizations and FFI possibilities</p>



<a name="218906109"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218906109" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218906109">(Dec 04 2020 at 23:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="238605">Kevin Lacker</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218905809">said</a>:</p>
<blockquote>
<p>why would you want to use lean for a web application?</p>
</blockquote>
<p>perhaps because you like it as a functional language :)<br>
in my experience, disregarding the fact that we don't have a language server with all the bells and whistles yet, lean 4 is already quite nice to use as a functional programming language. <br>
not all of the cool stuff is documented yet, but there's some stuff: <a href="https://leanprover.github.io/lean4/doc">https://leanprover.github.io/lean4/doc</a></p>



<a name="218906131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218906131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218906131">(Dec 04 2020 at 23:55)</a>:</h4>
<p>(i think lean 4 being a good functional programming language is also very good for theorem proving :))</p>



<a name="218906507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218906507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218906507">(Dec 05 2020 at 00:02)</a>:</h4>
<p>I’m curious what you mean by Scala is not powerful enough.  I don’t mean to get into a flame war, but I think more production applications are written in Scala than most other functional programming languages.  Maybe by power you mean something about functional/type-theoretic power?</p>



<a name="218906554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218906554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218906554">(Dec 05 2020 at 00:03)</a>:</h4>
<p>I’m referring to <span class="user-mention" data-user-id="369607">@Jesper Nordenberg</span>‘s comment above.</p>



<a name="218906852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218906852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218906852">(Dec 05 2020 at 00:08)</a>:</h4>
<p><span class="user-mention" data-user-id="115715">@Jason Rute</span> Scala 3 is definitely more powerful than most common languages and I like it a lot, but it's not a dependently typed pure functional language like Idris and Lean. It's also not as runtime efficient as for example Rust (there are no unboxed structs and arrays, dependent on GC etc.).</p>



<a name="218907051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218907051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218907051">(Dec 05 2020 at 00:12)</a>:</h4>
<p>It seems Lean has @[specialize] and @[inline] annotations, are those similar to what's found in Rust?</p>



<a name="218907423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218907423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218907423">(Dec 05 2020 at 00:19)</a>:</h4>
<p>this is best answered by <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> when he's online <span aria-label="sweat smile" class="emoji emoji-1f605" role="img" title="sweat smile">:sweat_smile:</span></p>



<a name="218907548"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218907548" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218907548">(Dec 05 2020 at 00:21)</a>:</h4>
<p>Ok, I will try to have a chat with him, thanks!</p>



<a name="218915120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218915120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218915120">(Dec 05 2020 at 03:23)</a>:</h4>
<p>By the way, since we are talking about Lean as a fast to execute language, will tail recursion be optimized in Lean 4?</p>



<a name="218922057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218922057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218922057">(Dec 05 2020 at 06:45)</a>:</h4>
<p>isn't that a requirement? After all there are no for loops</p>



<a name="218922165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218922165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218922165">(Dec 05 2020 at 06:49)</a>:</h4>
<p><a href="https://github.com/leanprover/lean4/blob/f649f2401493866961e54fbd6a970baef0a514e0/src/library/compiler/ir_interpreter.cpp#L542-L561">Here</a> is evidence that the interpreter does tail recursion. However this is the "slow path", in practice we care more about the performance of lean 4 code after it's been compiled to LLVM, and my understanding is that tail recursion is not guaranteed by LLVM.</p>



<a name="218926633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218926633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Marc Huisinga <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218926633">(Dec 05 2020 at 09:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218922057">said</a>:</p>
<blockquote>
<p>After all there are no for loops</p>
</blockquote>
<p>well, in some sense ... <a href="https://leanprover.github.io/lean4/doc/do.html#iteration">https://leanprover.github.io/lean4/doc/do.html#iteration</a> <span aria-label="grinning" class="emoji emoji-1f600" role="img" title="grinning">:grinning:</span></p>



<a name="218928566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218928566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218928566">(Dec 05 2020 at 10:09)</a>:</h4>
<p>well it's still a DSL, it gets elaborated into maps and folds</p>



<a name="218929927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218929927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218929927">(Dec 05 2020 at 10:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="115715">Jason Rute</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218915120">said</a>:</p>
<blockquote>
<p>By the way, since we are talking about Lean as a fast to execute language, will tail recursion be optimized in Lean 4?</p>
</blockquote>
<p>Yes, they mention "join points" in their paper. They are never partially applied and calls are translated to a simple jump instructtion.</p>



<a name="218945322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218945322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218945322">(Dec 05 2020 at 17:53)</a>:</h4>
<p><span class="user-mention" data-user-id="238605">@Kevin Lacker</span> I'd appreciate it if you didn't assert the goals of a project you're not involved in. The first paragraph of <a href="https://leanprover.github.io/lean4/doc/">https://leanprover.github.io/lean4/doc/</a> plainly states what Lean 4 is intended to be: both a general-purpose programming language and an interactive theorem prover. Of course there's no web server when the language hasn't even seen its first release yet! It's true that those things are not exactly on our to-do list, but they are not part of the stdlib in many other languages (Haskell, Rust, ...) but have been implemented by third parties instead.</p>
<p>FWIW, I have high hopes for exploring integration with Rust's vast ecosystem. Rust is quite similar to Lean 4 in a few regards that make integration more feasible: safe, high-level and functional-ish APIs (no OOP, avoids mutable aliasing), yet no tracing GC. And thanks to reference counting, we can at least check for linearity at run time if not statically. Not sure when I'll get to working on that though... :) .</p>



<a name="218945382"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218945382" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218945382">(Dec 05 2020 at 17:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="369607">Jesper Nordenberg</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218904221">said</a>:</p>
<blockquote>
<p>If so, is there (planned) support for C-like primitives like unboxed fixed sized primitive types, structs and arrays? I suppose so since there seem to be a foreign C function interface and there are many compiler optimization for memory handling etc.</p>
</blockquote>
<p>Unboxed primitive types and arrays of those has already been mentioned here, but there is no support for unboxed product types yet.</p>



<a name="218945483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218945483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218945483">(Dec 05 2020 at 17:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="369607">Jesper Nordenberg</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218907051">said</a>:</p>
<blockquote>
<p>It seems Lean has @[specialize] and @[inline] annotations, are those similar to what's found in Rust?</p>
</blockquote>
<p>Our inlining is comparable to that in any other optimized language, I suppose. Specialization is more of a hint like in Haskell than the pervasive, obligatory specialization automatically done in Rust, which they need to support zero-cost passing of unboxed types.</p>



<a name="218945637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218945637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218945637">(Dec 05 2020 at 18:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="369607">Jesper Nordenberg</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218929927">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="115715">Jason Rute</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218915120">said</a>:</p>
<blockquote>
<p>By the way, since we are talking about Lean as a fast to execute language, will tail recursion be optimized in Lean 4?</p>
</blockquote>
<p>Yes, they mention "join points" in their paper. They are never partially applied and calls are translated to a simple jump instructtion.</p>
</blockquote>
<p>Our join points are not recursive, but the C backend eliminates direct tail recursion instead. It's definitely feasible to implement more general TCO, but there was no need so far.</p>



<a name="218946211"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218946211" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218946211">(Dec 05 2020 at 18:14)</a>:</h4>
<p>Thanks for the info, really interesting project.</p>



<a name="218946283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218946283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218946283">(Dec 05 2020 at 18:16)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218945322">said</a>:</p>
<blockquote>
<p>FWIW, I have high hopes for exploring integration with Rust's vast ecosystem. Rust is quite similar to Lean 4 in a few regards that make integration more feasible: safe, high-level and functional-ish APIs (no OOP, avoids mutable aliasing), yet no tracing GC. And thanks to reference counting, we can at least check for linearity at run time if not statically. Not sure when I'll get to working on that though... :) .</p>
</blockquote>
<p>Oh, do you plan to be able to call Rust functions and use Rust types directly in Lean? That sounds pretty awesome. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>



<a name="218946363"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218946363" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218946363">(Dec 05 2020 at 18:18)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218945483">said</a>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">Our</span> <span class="n">inlining</span> <span class="n">is</span> <span class="n">comparable</span> <span class="n">to</span> <span class="n">that</span> <span class="k">in</span> <span class="n">any</span> <span class="n">other</span> <span class="n">optimized</span> <span class="n">language</span><span class="o">,</span> <span class="n">I</span> <span class="n">suppose.</span> <span class="n">Specialization</span> <span class="n">is</span> <span class="n">more</span> <span class="n">of</span> <span class="n">a</span> <span class="n">hint</span> <span class="n">like</span> <span class="k">in</span> <span class="n">Haskell</span> <span class="n">than</span> <span class="n">the</span> <span class="n">pervasive</span><span class="o">,</span> <span class="n">obligatory</span> <span class="n">specialization</span> <span class="n">automatically</span> <span class="n">done</span> <span class="k">in</span> <span class="n">Rust</span><span class="o">,</span> <span class="n">which</span> <span class="n">they</span> <span class="n">need</span> <span class="n">to</span> <span class="n">support</span> <span class="n">zero</span><span class="bp">-</span><span class="n">cost</span> <span class="n">passing</span> <span class="n">of</span> <span class="n">unboxed</span> <span class="n">types.</span>
</code></pre></div>
<p>Is there some heuristic in the compiler for when to apply specialization? I think specialization is crucial to get the same level of performance for abstractions as in Rust and C++.</p>



<a name="218946723"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218946723" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218946723">(Dec 05 2020 at 18:28)</a>:</h4>
<p>Btw, Swift has a really interesting approach to monomorphization and specialization that avoid the code bloat of C++ and Rust</p>



<a name="218946843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218946843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218946843">(Dec 05 2020 at 18:31)</a>:</h4>
<p>You mean dictionary passing with size information? I would rather call that avoidance of specialization :) . And it will only become relevant when we have unboxed types above the pointer size.</p>



<a name="218946910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218946910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218946910">(Dec 05 2020 at 18:33)</a>:</h4>
<p><span class="user-mention silent" data-user-id="369607">Jesper Nordenberg</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218946283">said</a>:</p>
<blockquote>
<p>Oh, do you plan to be able to call Rust functions and use Rust types directly in Lean? That sounds pretty awesome. <span aria-label="smile" class="emoji emoji-1f642" role="img" title="smile">:smile:</span></p>
</blockquote>
<p>We have to do <em>something</em> with our arbitrary code-executing macros after all! Such as calling foreign compilers on the fly...</p>



<a name="218947085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218947085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218947085">(Dec 05 2020 at 18:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="369607">Jesper Nordenberg</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218946363">said</a>:</p>
<blockquote>
<p>Is there some heuristic in the compiler for when to apply specialization? I think specialization is crucial to get the same level of performance for abstractions as in Rust and C++.</p>
</blockquote>
<p>Some heuristics are necessary to avoid unnecessary specialization of e.g. <code>Nat</code> parameters. But this is part of the C++ part of the compiler that will be rewritten in Lean anyway, so it might change during that.</p>



<a name="218947748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218947748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jesper Nordenberg <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218947748">(Dec 05 2020 at 18:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110024">Sebastian Ullrich</span> <a href="#narrow/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language/near/218946843">said</a>:</p>
<blockquote>
<p>You mean dictionary passing with size information? I would rather call that avoidance of specialization :) . And it will only become relevant when we have unboxed types above the pointer size.</p>
</blockquote>
<p>Yes, that's what mean. They can avoid boxing without doing monomorphization.</p>



<a name="218953684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/218953684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Lacker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#218953684">(Dec 05 2020 at 21:08)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span>  I certainly wish you luck in making lean 4 a good general programming language! I would be interested in helping out, for example while using Lean 3 I have often wanted libraries that exist in other programming languages, like different data structures. I hope there is eventually some process for the community to contribute to Lean 4.</p>



<a name="219583063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/219583063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe Hendrix <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#219583063">(Dec 11 2020 at 09:48)</a>:</h4>
<p>I've been using Lean 4 for a while as a programming language.  It's not "general purpose" since we are building a <a href="https://github.com/GaloisInc/reopt-vcg">verification tool</a>, but as part of that we have an x86 semantics, bindings to LLVM, SMTLIB generation, and an Elf parsing library.<br>
I don't really see any reason you can't use Lean 4 as a general purpose language if you want to build native binaries (as opposed to webapps, etc).  It's also relatively easy to write bindings to C libraries.  The language is still in development, and I'd still recommend the vast majority of people use Lean 3 or a more mature language for now.<br>
Performance has generally been quite good.   I sometimes have to be careful about inadvertently blowing up the stack in code that would be fine in Haskell, but that can be fixed by refactoring.  The compiled code is generally quite efficient otherwise. <br>
I think the community will develop when Lean 4 is released; I haven't yet used this myself, but it certainly seems like the metaprogramming facilities will allow the community to extend Lean in many different ways without needing to contribute to the Lean 4 core.</p>



<a name="219583206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/219583206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#219583206">(Dec 11 2020 at 09:50)</a>:</h4>
<p>Oh, I had no idea the galois code was public</p>



<a name="219636032"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/219636032" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joe Hendrix <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#219636032">(Dec 11 2020 at 17:35)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> I don't think it's actually useful to others, but it's all currently public. :)</p>



<a name="219679439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/219679439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#219679439">(Dec 12 2020 at 00:42)</a>:</h4>
<p>I was just saying to <span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> elsewhere that I couldn't believe my interests were intersecting.</p>



<a name="219679446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/219679446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#219679446">(Dec 12 2020 at 00:42)</a>:</h4>
<p>Having spent half this year learning Cryptol, here's someone from Galois!</p>



<a name="220362720"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/220362720" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#220362720">(Dec 18 2020 at 11:48)</a>:</h4>
<p>How can we test lean 4 without breaking the current installation ? Elan can manage both versions, right ?</p>



<a name="220365285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%204%20as%20a%20general%20programming%20language/near/220365285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.204.20as.20a.20general.20programming.20language.html#220365285">(Dec 18 2020 at 12:20)</a>:</h4>
<p>There are installation instructions here: <a href="https://leanprover.github.io/lean4/doc/make/index.html">https://leanprover.github.io/lean4/doc/make/index.html</a>. You have to compile from the source.  (It also gives some elan linking instructions, but I have just been running it directly from the command line using the full path to the binary.  But that means I’m not using any language server support.). For my setup at least, there is no issue with having both installed.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>