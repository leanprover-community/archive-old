---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/widget.20v.20long.20term.20names.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html">widget v long term names</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="215329661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215329661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215329661">(Nov 02 2020 at 15:03)</a>:</h4>
<p>It's taken me a while, but I finally figured out how to close a textbox coming from the widgets when it is so big that the "close" icon is way off the screen.</p>
<p><a href="user_uploads/3121/KaYuaZtJy-YyYsldDzhj-ksU/catlong.gif">catlong.gif</a></p>
<div class="message_inline_image"><a href="user_uploads/3121/KaYuaZtJy-YyYsldDzhj-ksU/catlong.gif" title="catlong.gif"><img src="user_uploads/3121/KaYuaZtJy-YyYsldDzhj-ksU/catlong.gif"></a></div><p>Am I missing a trick here? I could have not expanded the right hand window I guess.</p>



<a name="215329952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215329952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215329952">(Nov 02 2020 at 15:05)</a>:</h4>
<p>cc: <span class="user-mention" data-user-id="121918">@Edward Ayers</span></p>



<a name="215332513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215332513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Edward Ayers <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215332513">(Nov 02 2020 at 15:22)</a>:</h4>
<p>oof</p>



<a name="215332554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215332554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Edward Ayers <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215332554">(Nov 02 2020 at 15:22)</a>:</h4>
<p>that's horrible I'm sorry</p>



<a name="215332779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215332779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Edward Ayers <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215332779">(Nov 02 2020 at 15:24)</a>:</h4>
<p>A max-width needs to be set somewhere.</p>



<a name="215332833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215332833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Edward Ayers <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215332833">(Nov 02 2020 at 15:24)</a>:</h4>
<p>Is the file you are editing availbs on a mathlib branch somewhere?</p>



<a name="215333879"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215333879" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215333879">(Nov 02 2020 at 15:31)</a>:</h4>
<p>I don't know how to make screenshot gifs like this, but I think you can toggle this textbox by clicking the same text you clicked to open it.</p>



<a name="215334564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215334564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215334564">(Nov 02 2020 at 15:36)</a>:</h4>
<p>That's true, but what happens with horizontal scrolling in the screenshot is still rather unintuitive.</p>



<a name="215334989"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215334989" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215334989">(Nov 02 2020 at 15:39)</a>:</h4>
<p>Of course, I agree.</p>



<a name="215335015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215335015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215335015">(Nov 02 2020 at 15:39)</a>:</h4>
<p>But it's a trick that works in the meantime :)</p>



<a name="215337091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215337091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215337091">(Nov 02 2020 at 15:53)</a>:</h4>
<p><span class="user-mention" data-user-id="121918">@Edward Ayers</span> if you replace src/topology/sheaves/sheafify.lean with</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c">/-</span><span class="cm"></span>
<span class="cm">Copyright (c) 2020 Scott Morrison. All rights reserved.</span>
<span class="cm">Released under Apache 2.0 license as described in the file LICENSE.</span>
<span class="cm">Authors: Scott Morrison</span>
<span class="cm">-/</span>
<span class="kn">import</span> <span class="n">topology.sheaves.local_predicate</span>
<span class="kn">import</span> <span class="n">topology.sheaves.stalks</span>

<span class="c">/-</span><span class="cm">!</span>
<span class="cm"># Sheafification of `Type` valued presheaves</span>

<span class="cm">We construct the sheafification of a `Type` valued presheaf,</span>
<span class="cm">as the subsheaf of dependent functions into the stalks</span>
<span class="cm">consisting of functions which are locally germs.</span>

<span class="cm">We show that the stalks of the sheafification are isomorphic to the original stalks,</span>
<span class="cm">via `stalk_to_fiber` which evaluates a germ of a dependent function at a point.</span>

<span class="cm">We construct a morphism `to_sheafify` from a presheaf to (the underlying presheaf of)</span>
<span class="cm">its sheafification, given by sending a section to its collection of germs.</span>

<span class="cm">## Future work</span>
<span class="cm">Show that the map induced on stalks by `to_sheafify` is the inverse of `stalk_to_fiber`.</span>

<span class="cm">Show sheafification is a functor from presheaves to sheaves,</span>
<span class="cm">and that it is the left adjoint of the forgetful functor,</span>
<span class="cm">following https://stacks.math.columbia.edu/tag/007X.</span>
<span class="cm">-/</span>

<span class="kd">universes</span> <span class="n">v</span>

<span class="kd">noncomputable theory</span>

<span class="kn">open</span> <span class="n">Top</span>
<span class="kn">open</span> <span class="n">opposite</span>
<span class="kn">open</span> <span class="n">topological_space</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="n">Top.</span><span class="o">{</span><span class="n">v</span><span class="o">}}</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">presheaf</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">Top.presheaf</span>

<span class="kn">namespace</span> <span class="n">sheafify</span>

<span class="sd">/--</span>
<span class="sd">The prelocal predicate on functions into the stalks, asserting that the function is equal to a germ.</span>
<span class="sd">-/</span>
<span class="kd">def</span> <span class="n">is_germ</span> <span class="o">:</span> <span class="n">prelocal_predicate</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">F.stalk</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">pred</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">f</span><span class="o">,</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">F.obj</span> <span class="o">(</span><span class="n">op</span> <span class="n">U</span><span class="o">)),</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">U</span><span class="o">,</span> <span class="n">f</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">F.germ</span> <span class="n">x</span> <span class="n">g</span><span class="o">,</span>
  <span class="n">res</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">V</span> <span class="n">U</span> <span class="n">i</span> <span class="n">f</span> <span class="o">⟨</span><span class="n">g</span><span class="o">,</span> <span class="n">p</span><span class="o">⟩,</span> <span class="o">⟨</span><span class="n">F.map</span> <span class="n">i.op</span> <span class="n">g</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="o">(</span><span class="n">p</span> <span class="o">(</span><span class="n">i</span> <span class="n">x</span><span class="o">))</span><span class="bp">.</span><span class="n">trans</span> <span class="o">(</span><span class="n">F.germ_res_apply</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">⟩,</span> <span class="o">}</span>

<span class="sd">/--</span>
<span class="sd">The local predicate on functions into the stalks,</span>
<span class="sd">asserting that the function is locally equal to a germ.</span>
<span class="sd">-/</span>
<span class="kd">def</span> <span class="n">is_locally_germ</span> <span class="o">:</span> <span class="n">local_predicate</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">F.stalk</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span> <span class="o">(</span><span class="n">is_germ</span> <span class="n">F</span><span class="o">)</span><span class="bp">.</span><span class="n">sheafify</span>

<span class="kd">end</span> <span class="n">sheafify</span>

<span class="sd">/--</span>
<span class="sd">The sheafification of a `Type` valued presheaf, defined as the functions into the stalks which</span>
<span class="sd">are locally equal to germs.</span>
<span class="sd">-/</span>
<span class="kd">def</span> <span class="n">sheafify</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="n">X</span> <span class="o">:=</span>
<span class="n">subsheaf_to_Types</span> <span class="o">(</span><span class="n">sheafify.is_locally_germ</span> <span class="n">F</span><span class="o">)</span>

<span class="sd">/--</span>
<span class="sd">The morphism from a presheaf to its sheafification,</span>
<span class="sd">sending each section to its germs.</span>
<span class="sd">(This forms the unit of the adjunction.)</span>
<span class="sd">-/</span>
<span class="kd">def</span> <span class="n">to_sheafify</span> <span class="o">:</span> <span class="n">F</span> <span class="bp">⟶</span> <span class="n">F.sheafify.presheaf</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">app</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">f</span><span class="o">,</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">F.germ</span> <span class="n">x</span> <span class="n">f</span><span class="o">,</span> <span class="n">prelocal_predicate.sheafify_of</span> <span class="o">⟨</span><span class="n">f</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩⟩,</span>
  <span class="n">naturality'</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span> <span class="n">U'</span> <span class="n">f</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">ext</span> <span class="n">x</span> <span class="o">⟨</span><span class="n">u</span><span class="o">,</span> <span class="n">m</span><span class="o">⟩,</span> <span class="n">apply</span> <span class="n">germ_res_apply'</span><span class="o">,</span> <span class="o">},</span> <span class="o">}</span>

<span class="sd">/--</span>
<span class="sd">The natural morphism from the stalk of the sheafification to the original stalk.</span>
<span class="sd">In `sheafify_stalk_iso` we show this is an isomorphism.</span>
<span class="sd">-/</span>
<span class="kd">def</span> <span class="n">stalk_to_fiber</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">F.sheafify.presheaf.stalk</span> <span class="n">x</span> <span class="bp">⟶</span> <span class="n">F.stalk</span> <span class="n">x</span> <span class="o">:=</span>
<span class="n">stalk_to_fiber</span> <span class="o">(</span><span class="n">sheafify.is_locally_germ</span> <span class="n">F</span><span class="o">)</span> <span class="n">x</span>

<span class="c1">-- TODO typo in surjective docstring</span>
<span class="kd">lemma</span> <span class="n">stalk_to_fiber_surjective</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">function.surjective</span> <span class="o">(</span><span class="n">F.stalk_to_fiber</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">stalk_to_fiber_surjective</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">t</span><span class="o">,</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">U</span><span class="o">,</span> <span class="n">m</span><span class="o">,</span> <span class="n">s</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">F.germ_exist</span> <span class="n">_</span> <span class="n">t</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">use</span> <span class="o">⟨</span><span class="n">U</span><span class="o">,</span> <span class="n">m</span><span class="o">⟩,</span>
    <span class="n">fsplit</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="bp">λ</span> <span class="n">y</span><span class="o">,</span> <span class="n">F.germ</span> <span class="n">y</span> <span class="n">s</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">exact</span> <span class="o">⟨</span><span class="n">prelocal_predicate.sheafify_of</span> <span class="o">⟨</span><span class="n">s</span><span class="o">,</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">rfl</span><span class="o">)⟩,</span> <span class="n">rfl</span><span class="o">⟩,</span> <span class="o">},</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">stalk_to_fiber_injective</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">F.stalk_to_fiber</span> <span class="n">x</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">stalk_to_fiber_injective</span><span class="o">,</span>
  <span class="n">intros</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">hU</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">U.2</span><span class="o">⟩</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">U'</span><span class="o">,</span> <span class="n">mU</span><span class="o">,</span> <span class="n">iU</span><span class="o">,</span> <span class="n">gU</span><span class="o">,</span> <span class="n">wU</span><span class="o">⟩,</span>
  <span class="n">rcases</span> <span class="n">hV</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">V.2</span><span class="o">⟩</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">V'</span><span class="o">,</span> <span class="n">mV</span><span class="o">,</span> <span class="n">iV</span><span class="o">,</span> <span class="n">gV</span><span class="o">,</span> <span class="n">wV</span><span class="o">⟩,</span>
  <span class="k">have</span> <span class="n">wUx</span> <span class="o">:=</span> <span class="n">wU</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mU</span><span class="o">⟩,</span>
  <span class="n">dsimp</span> <span class="n">at</span> <span class="n">wUx</span><span class="o">,</span> <span class="n">erw</span> <span class="n">wUx</span> <span class="n">at</span> <span class="n">e</span><span class="o">,</span> <span class="n">clear</span> <span class="n">wUx</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">wVx</span> <span class="o">:=</span> <span class="n">wV</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">mV</span><span class="o">⟩,</span>
  <span class="n">dsimp</span> <span class="n">at</span> <span class="n">wVx</span><span class="o">,</span> <span class="n">erw</span> <span class="n">wVx</span> <span class="n">at</span> <span class="n">e</span><span class="o">,</span> <span class="n">clear</span> <span class="n">wVx</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">F.germ_eq</span> <span class="n">x</span> <span class="n">mU</span> <span class="n">mV</span> <span class="n">gU</span> <span class="n">gV</span> <span class="n">e</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">W</span><span class="o">,</span> <span class="n">mW</span><span class="o">,</span> <span class="n">iU'</span><span class="o">,</span> <span class="n">iV'</span><span class="o">,</span> <span class="n">e'</span><span class="o">⟩,</span>
  <span class="n">use</span> <span class="o">⟨</span><span class="n">W</span> <span class="bp">⊓</span> <span class="o">(</span><span class="n">U'</span> <span class="bp">⊓</span> <span class="n">V'</span><span class="o">),</span> <span class="o">⟨</span><span class="n">mW</span><span class="o">,</span> <span class="n">mU</span><span class="o">,</span> <span class="n">mV</span><span class="o">⟩⟩,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
  <span class="o">{</span> <span class="n">change</span> <span class="n">W</span> <span class="bp">⊓</span> <span class="o">(</span><span class="n">U'</span> <span class="bp">⊓</span> <span class="n">V'</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">U.val</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">opens.inf_le_right</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="bp">≫</span> <span class="o">(</span><span class="n">opens.inf_le_left</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="bp">≫</span> <span class="n">iU</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">change</span> <span class="n">W</span> <span class="bp">⊓</span> <span class="o">(</span><span class="n">U'</span> <span class="bp">⊓</span> <span class="n">V'</span><span class="o">)</span> <span class="bp">⟶</span> <span class="n">V.val</span><span class="o">,</span>
    <span class="n">exact</span> <span class="o">(</span><span class="n">opens.inf_le_right</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="bp">≫</span> <span class="o">(</span><span class="n">opens.inf_le_right</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="bp">≫</span> <span class="n">iV</span><span class="o">,</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">w</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="n">only</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">wU</span> <span class="o">⟨</span><span class="n">w.1</span><span class="o">,</span> <span class="n">w.2.2.1</span><span class="o">⟩,</span>
    <span class="n">dsimp</span> <span class="n">only</span> <span class="n">at</span> <span class="n">wU</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">wV</span> <span class="o">⟨</span><span class="n">w.1</span><span class="o">,</span> <span class="n">w.2.2.2</span><span class="o">⟩,</span>
    <span class="n">dsimp</span> <span class="n">only</span> <span class="n">at</span> <span class="n">wV</span><span class="o">,</span>
    <span class="n">erw</span> <span class="o">[</span><span class="n">wU</span><span class="o">,</span> <span class="bp">←</span><span class="n">F.germ_res_apply</span> <span class="n">iU'</span> <span class="o">⟨</span><span class="n">w</span><span class="o">,</span> <span class="n">w.2.1</span><span class="o">⟩</span> <span class="n">gU</span><span class="o">,</span> <span class="n">e'</span><span class="o">,</span> <span class="n">F.germ_res_apply</span><span class="o">,</span> <span class="bp">←</span><span class="n">wV</span><span class="o">],</span>
    <span class="n">refl</span><span class="o">,</span> <span class="o">},</span>
<span class="kd">end</span>

<span class="sd">/--</span>
<span class="sd">The isomorphism betweeen a stalk of the sheafification and the original stalk.</span>
<span class="sd">-/</span>
<span class="kd">def</span> <span class="n">sheafify_stalk_iso</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">X</span><span class="o">)</span> <span class="o">:</span> <span class="n">F.sheafify.presheaf.stalk</span> <span class="n">x</span> <span class="bp">≅</span> <span class="n">F.stalk</span> <span class="n">x</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">equiv.of_bijective</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">stalk_to_fiber_injective</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">stalk_to_fiber_surjective</span> <span class="n">_</span> <span class="n">_</span><span class="o">⟩)</span><span class="bp">.</span><span class="n">to_iso</span>

<span class="c">/-</span><span class="cm">! # Functoriality -/</span>

<span class="c1">-- If F is a presheaf and G is a sheaf on X,</span>
<span class="c1">-- and F → G.presheaf, then F.sheafify → G</span>

<span class="kd">def</span> <span class="n">adjoint</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">presheaf</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="n">sheaf</span> <span class="o">(</span><span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="n">X</span><span class="o">)</span>
  <span class="o">(</span><span class="n">φ</span> <span class="o">:</span> <span class="n">F</span> <span class="bp">⟶</span> <span class="n">G.presheaf</span><span class="o">)</span> <span class="o">:</span> <span class="n">F.sheafify</span> <span class="bp">⟶</span> <span class="n">G</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">app</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">U</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="kd">begin</span>
    <span class="n">cases</span> <span class="n">s</span> <span class="k">with</span> <span class="n">stalk_fun</span> <span class="n">hs</span><span class="o">,</span>
    <span class="n">dsimp</span> <span class="n">only</span> <span class="n">at</span> <span class="n">stalk_fun</span><span class="o">,</span>
<span class="c1">--    unfold sheafify.is_locally_germ at hs,</span>
<span class="c1">--    unfold sheafify.is_germ at hs,</span>
<span class="c1">--    unfold prelocal_predicate.sheafify at hs,</span>
<span class="c1">--    dsimp at hs,</span>
    <span class="k">have</span> <span class="n">hG</span> <span class="o">:=</span> <span class="n">G.sheaf_condition</span><span class="o">,</span>
<span class="c1">--    unfold sheaf_condition at hG,</span>
    <span class="n">choose</span> <span class="n">cover</span> <span class="n">hcover1</span> <span class="n">hcover2</span> <span class="n">sections</span> <span class="n">hcover4</span> <span class="n">using</span> <span class="n">hs</span><span class="o">,</span>
    <span class="n">specialize</span> <span class="n">hG</span> <span class="n">cover</span><span class="o">,</span>
    <span class="c1">-- hG is the sheaf condition</span>
    <span class="c1">-- so it says G(union of cover) = limit of fork Prod_i G(U_i) -&gt; -&gt; Prod_{i,j} G(U_i ∩ U_j)</span>
    <span class="c1">-- let's define this section!</span>
    <span class="c1">-- let's first define the local sections</span>
    <span class="k">let</span> <span class="n">ti</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="o">:</span> <span class="n">unop</span> <span class="n">U</span><span class="o">,</span> <span class="n">G.presheaf.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">(</span><span class="n">cover</span> <span class="n">x</span><span class="o">))</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">φ.app</span> <span class="n">_</span> <span class="o">(</span><span class="n">sections</span> <span class="n">x</span><span class="o">),</span>
    <span class="n">cases</span> <span class="n">hG</span><span class="o">,</span>
    <span class="n">unfold</span> <span class="n">auto_param</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span>
    <span class="c1">-- BIG BOX : click on "category_theory.limits.cone"</span>
    <span class="c1">-- in term hG_lift</span>
    <span class="n">sorry</span><span class="o">,</span>
    <span class="kd">end</span><span class="o">,</span>
  <span class="n">naturality'</span> <span class="o">:=</span> <span class="n">sorry</span> <span class="o">}</span>

<span class="k">#exit</span>
</code></pre></div>
<p>then you can click on the term which I describe a few lines from the bottom</p>



<a name="215389177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/widget%20v%20long%20term%20names/near/215389177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Edward Ayers <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/widget.20v.20long.20term.20names.html#215389177">(Nov 02 2020 at 22:40)</a>:</h4>
<p>tracking PR: <a href="https://github.com/leanprover-community/mathlib/issues/4882">#4882</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>