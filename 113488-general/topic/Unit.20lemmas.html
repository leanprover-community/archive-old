---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Unit.20lemmas.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html">Unit lemmas</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="280805901"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280805901" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280805901">(May 01 2022 at 17:43)</a>:</h4>
<p>Why is there no lemma of the form <code>u * u^-1 = 1</code>, <code>(a * u^-1) * u</code>, etc... where <code>is_unit u</code>? All I can find is lemmas about <code>\u u</code> where <code>u : units \a</code>.</p>



<a name="280806046"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806046" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806046">(May 01 2022 at 17:46)</a>:</h4>
<p>Can you even write <code>u^-1</code>? The type of <code>u</code> doesn't necessarily <code>has_inv</code>.</p>



<a name="280806048"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806048" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806048">(May 01 2022 at 17:46)</a>:</h4>
<p>I gather that currently the only time we have a pseudo-inverse is with <code>group_with_zero</code> and <code>matrix</code> (and the latter rather uses <a href="https://leanprover-community.github.io/mathlib_docs/find/ring.inverse">docs#ring.inverse</a>), but this will change after <a href="https://github.com/leanprover-community/mathlib/pull/13860">#13860</a>.</p>



<a name="280806061"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806061" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806061">(May 01 2022 at 17:47)</a>:</h4>
<p>My use case is that <code>{u} : set \a</code> is a unit when <code>u</code> is, and additive combinatorics uses that fact all over the place.</p>



<a name="280806121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806121">(May 01 2022 at 17:48)</a>:</h4>
<p>but we do have <a href="https://leanprover-community.github.io/mathlib_docs/find/is_unit.coe_inv_mul">docs#is_unit.coe_inv_mul</a></p>



<a name="280806274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806274">(May 01 2022 at 17:52)</a>:</h4>
<p>Yes exactly. This is about the coercion of the inverse of the unit corresponding to <code>u</code>, rather than the inverse of <code>u</code> itself</p>



<a name="280806339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806339" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806339">(May 01 2022 at 17:54)</a>:</h4>
<p>My use case is precisely when my type already has an inverse, so that I don't have to resort to calculations in the units.</p>



<a name="280806547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806547">(May 01 2022 at 17:59)</a>:</h4>
<p>In <code>group_with_zero</code> (in particular <code>field</code>) the inverse isn't well behaved though, because 0 * 0^-1 is not 0.</p>



<a name="280806595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806595">(May 01 2022 at 18:00)</a>:</h4>
<p>... which is why you assume <code>is_unit u</code> and call <code>^-1</code> a <em>pseudo</em>-inverse</p>



<a name="280806660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806660">(May 01 2022 at 18:01)</a>:</h4>
<p>Is <a href="https://leanprover-community.github.io/mathlib_docs/find/ring.inverse_mul_cancel">docs#ring.inverse_mul_cancel</a> what you're looking for?</p>



<a name="280806800"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806800" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806800">(May 01 2022 at 18:04)</a>:</h4>
<p>Yes! except that I want the <code>^-1</code> spelling because <code>ring.inverse</code> does not behave well for additive combinatorics.</p>



<a name="280806808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806808">(May 01 2022 at 18:04)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/group_with_zero.mul_inv_cancel">docs#group_with_zero.mul_inv_cancel</a> has the form you require.</p>



<a name="280806827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806827">(May 01 2022 at 18:05)</a>:</h4>
<p>Yes, except that <code>set \a</code> is not a <code>group_with_zero</code> so it doesn't apply.</p>



<a name="280806897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806897">(May 01 2022 at 18:06)</a>:</h4>
<p>Your question doesn't make sense because there is no typeclass that forces has_inv to mean anything in the context that isn't group_with_zero</p>



<a name="280806923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806923">(May 01 2022 at 18:07)</a>:</h4>
<p>Yes but <a href="https://github.com/leanprover-community/mathlib/pull/13860">#13860</a> changes this</p>



<a name="280806932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806932">(May 01 2022 at 18:07)</a>:</h4>
<p>Sorry I shouldn't have asked a question I knew the answer to <span aria-label="stuck out tongue" class="emoji emoji-1f61b" role="img" title="stuck out tongue">:stuck_out_tongue:</span></p>



<a name="280806985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806985">(May 01 2022 at 18:08)</a>:</h4>
<p>Well then your answer to "why is there no lemma of the form ..." is "because such a lemma would require a generalization elsewhere"</p>



<a name="280806991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280806991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280806991">(May 01 2022 at 18:08)</a>:</h4>
<p>I believe that what I can do is take the <code>group_with_zero</code> lemmas, and generalize them to my new <code>division_monoid</code> by changing <code>a \ne 0</code> with <code>is_unit a</code>.</p>



<a name="280807000"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807000" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807000">(May 01 2022 at 18:08)</a>:</h4>
<p>We already do have the lemmas for the spellings that are possible today; I assume there's one for matrix.has_inv too</p>



<a name="280807007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807007">(May 01 2022 at 18:08)</a>:</h4>
<p>I wanted to make sure there was no other reason.</p>



<a name="280807107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807107">(May 01 2022 at 18:11)</a>:</h4>
<blockquote>
<p>I believe that what I can do is take the <code>group_with_zero</code> lemmas, and generalize them to my new <code>division_monoid</code> by changing <code>a \ne 0</code> with <code>is_unit a</code>.</p>
</blockquote>
<p>Would you be happy if I were to actually <em>replace</em> the <code>group_with_zero</code> lemmas and add a very easy way to convert <code>a \ne 0</code> into <code>is_unit a</code> (something like <code>ne.is_unit</code>)?</p>



<a name="280807112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807112">(May 01 2022 at 18:12)</a>:</h4>
<p>That just sounds annoying</p>



<a name="280807164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807164">(May 01 2022 at 18:12)</a>:</h4>
<p>I'd put the new lemmas you're describing in the <code>is_unit</code> namespace</p>



<a name="280807171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807171">(May 01 2022 at 18:12)</a>:</h4>
<p>This might even be an improvement because dot notation will make that seamless: <code>h.is_unit.the_generalized_lemma</code></p>



<a name="280807193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807193">(May 01 2022 at 18:13)</a>:</h4>
<p>In my experience you don't normally have <code>h</code> lying around, and it's more convenient to let lean work out you need it after a rewrite</p>



<a name="280807197"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807197" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807197">(May 01 2022 at 18:13)</a>:</h4>
<p>So dot notation isn't going to be relevant</p>



<a name="280807269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807269">(May 01 2022 at 18:14)</a>:</h4>
<p>Eh okay, I have a different experience.</p>



<a name="280807434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807434">(May 01 2022 at 18:19)</a>:</h4>
<p>At any rate, it will quickly become annoying to provide <code>is_unit</code> obligations when working in a <code>group</code></p>



<a name="280807489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Unit%20lemmas/near/280807489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Unit.20lemmas.html#280807489">(May 01 2022 at 18:20)</a>:</h4>
<p>If you have convenience wrappers for the group lemmas, then let's just have them for group_with_zero too</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>