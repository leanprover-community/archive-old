---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/leanproject.20get-cache.20--force.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html">leanproject get-cache --force</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="252013962"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20get-cache%20--force/near/252013962" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html#252013962">(Sep 04 2021 at 17:17)</a>:</h4>
<p>The behaviour of <code>leanproject get-cache --force</code> surprised me a little. It undid all my changes since the last commit, whereas the behaviour I expected would be to get oleans that matched my last commit while keeping the lean files the same. Maybe the help file should include a warning that it will overwrite uncommitted changes.</p>



<a name="252014057"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20get-cache%20--force/near/252014057" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html#252014057">(Sep 04 2021 at 17:19)</a>:</h4>
<p>Would it make sense that <code>leanproject</code> does a <code>git stash ... git stash pop</code> if it detects a dirty directory?</p>



<a name="252015777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20get-cache%20--force/near/252015777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html#252015777">(Sep 04 2021 at 17:52)</a>:</h4>
<p>This happened to me ages ago and IIRC I then PR’d the feature that a dirty repo requires <code>—force</code>.</p>
<p>I think one could argue that the behaviour is fine but the user deserves a stronger hint to be sure they know what they’re doing. e.g., rename <code>—force</code> to <code>—dangerous</code> and move on?</p>



<a name="252015990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20get-cache%20--force/near/252015990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html#252015990">(Sep 04 2021 at 17:56)</a>:</h4>
<p>Or just <code>--destroy-my-changes</code>? :)</p>



<a name="252020661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20get-cache%20--force/near/252020661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html#252020661">(Sep 04 2021 at 19:24)</a>:</h4>
<p>I have a PR that fixes this</p>



<a name="252020684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20get-cache%20--force/near/252020684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html#252020684">(Sep 04 2021 at 19:25)</a>:</h4>
<p>IMO leanproject get-cache has no right to touch the working tree; it should get the cache and only the cache</p>



<a name="252020698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20get-cache%20--force/near/252020698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html#252020698">(Sep 04 2021 at 19:25)</a>:</h4>
<p>If you want the working tree, use git to get it first, then get the cache for that</p>



<a name="252020802"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject%20get-cache%20--force/near/252020802" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.20get-cache.20--force.html#252020802">(Sep 04 2021 at 19:27)</a>:</h4>
<p>Relatedly, <code>mk-cache --force</code> poisons the cache for future cache requests</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>