---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html">simplifying in `monoid_algebra`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="272444292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272444292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272444292">(Feb 18 2022 at 19:13)</a>:</h4>
<p>I'm helping <span class="user-mention" data-user-id="263407">@Laurent Bartholdi</span> with a Lean course. <span class="user-mention" data-user-id="452637">@Cedric Holle</span> is one of the students at this course and he tries to formalize some equality in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi><mo stretchy="false">[</mo><mi>G</mi><msub><mi>L</mi><mn>4</mn></msub><mo stretchy="false">(</mo><mi mathvariant="double-struck">Q</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb Q[GL_4(\mathbb Q)]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Q</span><span class="mopen">[</span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbb">Q</span><span class="mclose">)]</span></span></span></span> (actually, in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">Q</mi><mo stretchy="false">[</mo><mi>G</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb Q[G]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathbb">Q</span><span class="mopen">[</span><span class="mord mathnormal">G</span><span class="mclose">]</span></span></span></span>, where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi></mrow><annotation encoding="application/x-tex">G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">G</span></span></span></span> is a subgroup of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><msub><mi>L</mi><mn>4</mn></msub><mo stretchy="false">(</mo><mi mathvariant="double-struck">Q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">GL_4(\mathbb Q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbb">Q</span><span class="mclose">)</span></span></span></span> but this shouldn't be too important). The equality is rather long and I hope that Cedric will copy+paste relevant definitions below.<br>
Once we unfold the definitions, we get a linear combination of <code>finsupp.single (some_matrix) 1 1</code>. In order to simplify this, we need to decide whether <code>some_matrix</code> is equal to one or no. Can some tactic do this for us?</p>



<a name="272444398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272444398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272444398">(Feb 18 2022 at 19:14)</a>:</h4>
<p>Please tell me that <code>GL_4(G)</code> is a typo for <code>G</code> :-)</p>



<a name="272444654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272444654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272444654">(Feb 18 2022 at 19:16)</a>:</h4>
<p>Thanks! Fixed.</p>



<a name="272444656"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272444656" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272444656">(Feb 18 2022 at 19:16)</a>:</h4>
<p>Is <code>some_matrix</code> literally a 4x4 matrix with explicit rational coefficients? Does <code>norm_num</code> work?</p>



<a name="272444833"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272444833" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272444833">(Feb 18 2022 at 19:17)</a>:</h4>
<p>Yes, <code>some_matrix</code> is an explicit 4x4 matrix. It is obtained using arithmetic operations from matrices in <code>![...]</code> notation.</p>



<a name="272444934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272444934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272444934">(Feb 18 2022 at 19:18)</a>:</h4>
<p>The problem is to make <code>norm_num</code> decide whether this matrix is equal to <code>1</code> or not.</p>



<a name="272445043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445043">(Feb 18 2022 at 19:19)</a>:</h4>
<p>And feed the result to one of 2 lemmas about <code>finsupp.single</code>.</p>



<a name="272445141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445141">(Feb 18 2022 at 19:20)</a>:</h4>
<p>More generally, we may have <code>finsupp.single a b c</code>, where <code>a = c</code> is decidable.</p>



<a name="272445193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445193">(Feb 18 2022 at 19:21)</a>:</h4>
<p>I don't remember if <code>norm_num</code> can tell whether <code>(1 : matrix (fin 2) (fin 2) R) = ![[1, 0], [0, 1]]</code> or not.</p>



<a name="272445213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445213">(Feb 18 2022 at 19:21)</a>:</h4>
<p>I see, and this is why you wanted <code>dec_trivial</code>!</p>



<a name="272445237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445237">(Feb 18 2022 at 19:21)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">have</span> <span class="o">:</span> <span class="n">some_matrix</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">),</span>
<span class="o">{</span> <span class="n">ext</span> <span class="n">i</span> <span class="n">j</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">i</span><span class="bp">;</span> <span class="n">fin_cases</span> <span class="n">j</span><span class="bp">;</span> <span class="n">norm_num</span> <span class="o">}</span>
</code></pre></div>



<a name="272445276"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445276" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445276">(Feb 18 2022 at 19:21)</a>:</h4>
<p>The problem with that is that it only proves that things are equal to 1, not that they're not equal to 1</p>



<a name="272445278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445278">(Feb 18 2022 at 19:21)</a>:</h4>
<p>And now you have 20-30 terms of this form.</p>



<a name="272445412"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445412" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445412">(Feb 18 2022 at 19:22)</a>:</h4>
<p>The question is how to avoid 20-30 explicitly written lemmas "this is not equal to one".</p>



<a name="272445468"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445468" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445468">(Feb 18 2022 at 19:23)</a>:</h4>
<p>The best I could do for similar problems can be found in this file: <a href="https://github.com/pechersky/e222/blob/master/src/problems02.lean#L49-L58">https://github.com/pechersky/e222/blob/master/src/problems02.lean#L49-L58</a></p>



<a name="272445483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445483">(Feb 18 2022 at 19:23)</a>:</h4>
<p>If you write a proof for "not equal" manually, then you can just tell Lean which elements are not equal.</p>



<a name="272445911"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445911" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445911">(Feb 18 2022 at 19:27)</a>:</h4>
<p>I guess, one can write a tactic that goes over elements of <code>fin 4</code> and evaluates LHS and RHS</p>



<a name="272445932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272445932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272445932">(Feb 18 2022 at 19:27)</a>:</h4>
<p>But I'm not good at writing tactics.</p>



<a name="272446070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272446070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272446070">(Feb 18 2022 at 19:28)</a>:</h4>
<p>Is that not fin_cases?</p>



<a name="272446807"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272446807" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272446807">(Feb 18 2022 at 19:34)</a>:</h4>
<blockquote>
<p>I guess, one can write a tactic that goes over elements of fin 4 and evaluates LHS and RHS<br>
But I'm not good at writing tactics.</p>
</blockquote>
<p>A simple approach is to write a lemma <code>matrix22_ext_iff : (![![a,b], ![c,d]] = ![![e,f], ![g,h]]) ↔ a=e ∧ b = f ∧ c = g ∧ d = h</code> and then call <code>simp [matrix22_ext_iff]</code> (we might have such a lemma already, didn't check).</p>



<a name="272447908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272447908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272447908">(Feb 18 2022 at 19:44)</a>:</h4>
<p>Am I right that in this case <code>simp</code> will simplify each equality even if one of them already says <code>false</code>?</p>



<a name="272448052"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272448052" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272448052">(Feb 18 2022 at 19:46)</a>:</h4>
<p>Right.</p>



<a name="272448271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272448271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272448271">(Feb 18 2022 at 19:48)</a>:</h4>
<p>So, a specialized tactic can be more effective but requires some meta programming skills. Let's wait for the students to come here, read the backlog, and decide what they're going to do.</p>



<a name="272452503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272452503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272452503">(Feb 18 2022 at 20:21)</a>:</h4>
<p>Rewriting backwards by <a href="https://leanprover-community.github.io/mathlib_docs/find/matrix.one_fin_three">docs#matrix.one_fin_three</a> (but for <code>four</code>) might put you in a place where dec_trivial is easy</p>



<a name="272452675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272452675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272452675">(Feb 18 2022 at 20:23)</a>:</h4>
<p><code>dec_trivial</code> can't solve <code>(5 : rat) = 1</code></p>



<a name="272452697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272452697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272452697">(Feb 18 2022 at 20:23)</a>:</h4>
<p>And the matrices have half-integer elements.</p>



<a name="272452715"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272452715" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272452715">(Feb 18 2022 at 20:23)</a>:</h4>
<p>So, we can't just deal with matrices over <code>int</code>.</p>



<a name="272460422"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/simplifying%20in%20%60monoid_algebra%60/near/272460422" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/simplifying.20in.20.60monoid_algebra.60.html#272460422">(Feb 18 2022 at 21:33)</a>:</h4>
<p>You could write an ext lemma which clears the denominators and reduces to <code>int</code> :-)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>