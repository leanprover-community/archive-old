---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/leanproject.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html">leanproject</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="197414333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/197414333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#197414333">(May 13 2020 at 13:44)</a>:</h4>
<p>How do I download a specific version of mathlib (and Lean)?</p>



<a name="197417910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/197417910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#197417910">(May 13 2020 at 14:10)</a>:</h4>
<p>currently I just created a new project using <code>leanproject new</code>and then changed the <code>leanpkg.toml</code>manually (by copying from another repo and changing the commit to what I need) and then using <code>leanproject get-mathlib-cache</code></p>



<a name="197417941"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/197417941" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#197417941">(May 13 2020 at 14:10)</a>:</h4>
<p>do I need to do this every time?</p>



<a name="197851544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/197851544" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#197851544">(May 17 2020 at 14:19)</a>:</h4>
<p>what would you want to see in terms of workflow?</p>



<a name="197851588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/197851588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ryan Lahfa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#197851588">(May 17 2020 at 14:20)</a>:</h4>
<p>it could be possible I guess to have leanproject new --leanversion XXX, but for mathlib, I don't know if there's any proper tagging or versioning beyond the commit SHA256</p>



<a name="221511733"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/221511733" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#221511733">(Jan 04 2021 at 11:07)</a>:</h4>
<div class="codehilite" data-code-language="Bash"><pre><span></span><code>kc_ke@LAPTOP-DBUNR5U5 MINGW64 /c/mathlib <span class="o">(</span>master<span class="o">)</span>
$ leanproject get-cache
 ** On entry to DGEBAL parameter number  <span class="m">3</span> had an illegal value
 ** On entry to DGEHRD  parameter number  <span class="m">2</span> had an illegal value
 ** On entry to DORGHR DORGQR parameter number  <span class="m">2</span> had an illegal value
 ** On entry to DHSEQR parameter number  <span class="m">4</span> had an illegal value
 ** On entry to DGEBAL parameter number  <span class="m">3</span> had an illegal value
 ** On entry to DGEHRD  parameter number  <span class="m">2</span> had an illegal value
 ** On entry to DORGHR DORGQR parameter number  <span class="m">2</span> had an illegal value
 ** On entry to DHSEQR parameter number  <span class="m">4</span> had an illegal value
Traceback <span class="o">(</span>most recent call last<span class="o">)</span>:
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\runpy.py"</span>, line <span class="m">197</span>, in _run_module_as_main
    <span class="k">return</span> _run_code<span class="o">(</span>code, main_globals, None,
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\runpy.py"</span>, line <span class="m">87</span>, in _run_code
    exec<span class="o">(</span>code, run_globals<span class="o">)</span>
  File <span class="s2">"C:\Users\kc_ke\AppData\Local\Programs\Python\Python39\Scripts\leanproject.exe\__main__.py"</span>, line <span class="m">4</span>, in &lt;module&gt;
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\site-packages\mathlibtools\leanproject.py"</span>, line <span class="m">11</span>, in &lt;module&gt;
    from mathlibtools.lib import <span class="o">(</span>LeanProject, log, LeanDirtyRepo,
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\site-packages\mathlibtools\lib.py"</span>, line <span class="m">17</span>, in &lt;module&gt;
    import networkx as nx <span class="c1"># type: ignore</span>
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\site-packages\networkx\__init__.py"</span>, line <span class="m">64</span>, in &lt;module&gt;
    import networkx.readwrite
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\site-packages\networkx\readwrite\__init__.py"</span>, line <span class="m">16</span>, in &lt;module&gt;
    from networkx.readwrite.gexf import *
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\site-packages\networkx\readwrite\gexf.py"</span>, line <span class="m">173</span>, in &lt;module&gt;
    class GEXF:
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\site-packages\networkx\readwrite\gexf.py"</span>, line <span class="m">211</span>, in GEXF
    import numpy as np
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\site-packages\numpy\__init__.py"</span>, line <span class="m">305</span>, in &lt;module&gt;
    _win_os_check<span class="o">()</span>
  File <span class="s2">"c:\users\kc_ke\appdata\local\programs\python\python39\lib\site-packages\numpy\__init__.py"</span>, line <span class="m">302</span>, in _win_os_check
    raise RuntimeError<span class="o">(</span>msg.format<span class="o">(</span>__file__<span class="o">))</span> from None
RuntimeError: The current Numpy installation <span class="o">(</span><span class="s1">'c:\\users\\kc_ke\\appdata\\local\\programs\\python\\python39\\lib\\site-packages\\numpy\\__init__.py'</span><span class="o">)</span> fails to pass a sanity check due to a bug in the windows runtime. See this issue <span class="k">for</span> more information: https://tinyurl.com/y3dm3h86
</code></pre></div>



<a name="221511839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/221511839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#221511839">(Jan 04 2021 at 11:09)</a>:</h4>
<p><a href="https://github.com/twintproject/twint/issues/1030">https://github.com/twintproject/twint/issues/1030</a> ?</p>



<a name="221511951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/221511951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#221511951">(Jan 04 2021 at 11:10)</a>:</h4>
<p>Don't forget to add a "Thanks a lot!" message at the bottom.</p>



<a name="221511997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/221511997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#221511997">(Jan 04 2021 at 11:10)</a>:</h4>
<p>Thanks, that worked</p>



<a name="221512072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/221512072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#221512072">(Jan 04 2021 at 11:11)</a>:</h4>
<p>I think this came up elsewhere - leanproject should not even attempt to import numpy /networkx until asked for the import graph</p>



<a name="221512120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/221512120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#221512120">(Jan 04 2021 at 11:12)</a>:</h4>
<p>Doing so just makes leanproject slow and fragile</p>



<a name="277339131"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277339131" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277339131">(Mar 31 2022 at 20:59)</a>:</h4>
<p>I just set up a repo for the formalization of Con(NF) that will happen this summer and people seem unable to get it using leanproject. Namely, running <code>leanproject get con-nf</code> (the repository is <a href="https://github.com/leanprover-community/con-nf">https://github.com/leanprover-community/con-nf</a>) returns</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">&gt;</span> <span class="n">git</span> <span class="n">checkout</span> <span class="c1">--detach de5038953210a6ffb013340c7bf82243be226f1c    # in directory _target/deps/mathlib</span>
<span class="n">fatal</span><span class="o">:</span> <span class="n">reference</span> <span class="n">is</span> <span class="n">not</span> <span class="n">a</span> <span class="n">tree</span><span class="o">:</span> <span class="n">de5038953210a6ffb013340c7bf82243be226f1c</span>
<span class="n">external</span> <span class="n">command</span> <span class="n">exited</span> <span class="k">with</span> <span class="n">status</span> <span class="mi">128</span>
<span class="n">Command</span> <span class="sc">'['</span><span class="n">leanpkg'</span><span class="o">,</span> <span class="bp">'</span><span class="n">configure'</span><span class="o">]</span><span class="bp">'</span> <span class="n">returned</span> <span class="n">non</span><span class="bp">-</span><span class="n">zero</span> <span class="n">exit</span> <span class="n">status</span> <span class="mi">1</span><span class="bp">.</span>
</code></pre></div>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span>, did I miss something obvious by any chance?</p>



<a name="277339886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277339886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277339886">(Mar 31 2022 at 21:04)</a>:</h4>
<p>(This likely isn't related to your issue, but you should add <code>/_target</code> and <code>leanpkg.path</code> to a <code>.gitignore</code> file. See e.g. <a href="https://github.com/leanprover-community/mathlib/blob/master/.gitignore">mathlib's</a>.)</p>



<a name="277340361"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277340361" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277340361">(Mar 31 2022 at 21:06)</a>:</h4>
<p>I independently came to the conclusion that this <strong>was</strong> my issue, because deleting <code>_target</code> and <code>leanpkg.path</code> and running <code>leanproject get-m</code> fixed the install.</p>



<a name="277340444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277340444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277340444">(Mar 31 2022 at 21:07)</a>:</h4>
<p>Ah, I see. You had mathlib set up as a submodule in <code>_target/deps</code>, which I don't think <code>leanproject</code> supports.</p>



<a name="277340507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277340507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277340507">(Mar 31 2022 at 21:08)</a>:</h4>
<p>Do you mean my error is deeper?</p>



<a name="277340584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277340584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277340584">(Mar 31 2022 at 21:09)</a>:</h4>
<p>If you make a new commit with a <code>.gitignore</code> like I suggested and <code>git</code> doesn't complain then you've probably fixed it.</p>



<a name="277340626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277340626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277340626">(Mar 31 2022 at 21:09)</a>:</h4>
<p>I'm not sure how you created mathlib as a submodule, so I can't be sure if there's a deeper issue.</p>



<a name="277340796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277340796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277340796">(Mar 31 2022 at 21:11)</a>:</h4>
<p>I ran <code>leanproject get-m</code></p>



<a name="277340841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277340841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277340841">(Mar 31 2022 at 21:11)</a>:</h4>
<p>(the reference at the bottom of the readme refers to LTE still btw)</p>



<a name="277341213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/leanproject/near/277341213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/leanproject.html#277341213">(Mar 31 2022 at 21:15)</a>:</h4>
<p>Someone with more git knowledge should probably jump in, but it looks like creating a commit which contains the mathlib git repo as a subdirectory tells git to treat it like a submodule. Anyways, adding a proper <code>.gitignore</code> file and removing <code>_target</code> from the repo if necessary should hopefully fix things.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>