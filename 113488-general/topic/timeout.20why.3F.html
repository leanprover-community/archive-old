---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/timeout.20why.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html">timeout why?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="227306483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227306483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227306483">(Feb 22 2021 at 17:38)</a>:</h4>
<p><a href="/user_uploads/3121/wIzTywbodH_AVuTH7cpl6Fs7/timeout.lean">timeout.lean</a><br>
I get a timeout for this toy compiler on a small expression? Why?</p>



<a name="227307630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227307630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227307630">(Feb 22 2021 at 17:45)</a>:</h4>
<p>Please paste your example in a code block.</p>



<a name="227307750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227307750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227307750">(Feb 22 2021 at 17:46)</a>:</h4>
<p>or a github gist... if it's too long</p>



<a name="227308106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308106">(Feb 22 2021 at 17:48)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">inductive</span> <span class="n">Expr</span> <span class="o">:</span> <span class="kt">Type</span>
<span class="bp">|</span> <span class="n">const</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">Expr</span>
<span class="bp">|</span> <span class="n">var</span> <span class="o">:</span> <span class="n">string</span> <span class="bp">→</span> <span class="n">Expr</span>
<span class="bp">|</span> <span class="n">plus</span> <span class="o">:</span> <span class="n">Expr</span> <span class="bp">→</span> <span class="n">Expr</span> <span class="bp">→</span> <span class="n">Expr</span>
<span class="bp">|</span> <span class="n">times</span> <span class="o">:</span> <span class="n">Expr</span> <span class="bp">→</span> <span class="n">Expr</span> <span class="bp">→</span> <span class="n">Expr</span>

<span class="kn">open</span> <span class="n">Expr</span>

<span class="kd">inductive</span> <span class="n">Instr</span> <span class="o">:</span> <span class="kt">Type</span>
<span class="bp">|</span> <span class="n">pushC</span> <span class="o">:</span> <span class="n">ℕ</span> <span class="bp">→</span> <span class="n">Instr</span>
<span class="bp">|</span> <span class="n">pushV</span> <span class="o">:</span> <span class="n">string</span> <span class="bp">→</span> <span class="n">Instr</span>
<span class="bp">|</span> <span class="n">add</span> <span class="o">:</span> <span class="n">Instr</span>
<span class="bp">|</span> <span class="n">mult</span> <span class="o">:</span> <span class="n">Instr</span>

<span class="kn">open</span> <span class="n">Instr</span>

<span class="kd">def</span> <span class="n">Code</span> <span class="o">:</span> <span class="kt">Type</span>
  <span class="o">:=</span> <span class="n">list</span> <span class="n">Instr</span>

<span class="kd">def</span> <span class="n">Stack</span> <span class="o">:</span> <span class="kt">Type</span>
  <span class="o">:=</span> <span class="n">list</span> <span class="n">ℕ</span>

<span class="kd">def</span> <span class="n">comp_aux</span> <span class="o">:</span> <span class="n">Expr</span> <span class="bp">→</span> <span class="n">Code</span> <span class="bp">→</span> <span class="n">Code</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">const</span> <span class="n">n</span><span class="o">)</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">pushC</span> <span class="n">n</span> <span class="o">::</span> <span class="n">c</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">var</span> <span class="n">x</span><span class="o">)</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">pushV</span> <span class="n">x</span> <span class="o">::</span> <span class="n">c</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">plus</span> <span class="n">l</span> <span class="n">r</span><span class="o">)</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">comp_aux</span> <span class="n">l</span> <span class="o">(</span><span class="n">comp_aux</span> <span class="n">r</span> <span class="o">(</span><span class="n">add</span> <span class="o">::</span> <span class="n">c</span><span class="o">))</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">times</span> <span class="n">l</span> <span class="n">r</span><span class="o">)</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">comp_aux</span> <span class="n">l</span> <span class="o">(</span><span class="n">comp_aux</span> <span class="n">r</span> <span class="o">(</span><span class="n">mult</span> <span class="o">::</span> <span class="n">c</span><span class="o">))</span>

<span class="kd">def</span> <span class="n">comp</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span><span class="n">Expr</span><span class="o">)</span> <span class="o">:</span> <span class="n">Code</span>
  <span class="o">:=</span> <span class="n">comp_aux</span> <span class="n">e</span> <span class="o">[]</span>

<span class="kd">def</span> <span class="n">e1</span> <span class="o">:</span> <span class="n">Expr</span>
  <span class="o">:=</span> <span class="n">times</span> <span class="o">(</span><span class="n">var</span> <span class="s2">"x"</span><span class="o">)</span> <span class="o">(</span><span class="n">plus</span> <span class="o">(</span><span class="n">var</span> <span class="s2">"y"</span><span class="o">)</span> <span class="o">(</span><span class="n">const</span> <span class="mi">2</span><span class="o">))</span>

<span class="k">#reduce</span> <span class="o">(</span><span class="n">comp</span> <span class="n">e1</span><span class="o">)</span>
</code></pre></div>



<a name="227308108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308108">(Feb 22 2021 at 17:48)</a>:</h4>
<p>maybe it's the <code>string</code> bug</p>



<a name="227308140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308140">(Feb 22 2021 at 17:48)</a>:</h4>
<p>I remember there was a bug with evaluating strings because of some <code>"undefined"</code> string</p>



<a name="227308181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308181">(Feb 22 2021 at 17:48)</a>:</h4>
<p>You should use <code>#eval</code> instead of <code>#reduce</code>.</p>



<a name="227308183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308183">(Feb 22 2021 at 17:48)</a>:</h4>
<p>It is related to strings, but it's not a bug. This comes up pretty often. <a href="#narrow/stream/113489-new-members/topic/deep.20recursion.20error.20reducing.20strings">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/deep.20recursion.20error.20reducing.20strings</a></p>



<a name="227308278"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308278" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308278">(Feb 22 2021 at 17:49)</a>:</h4>
<p>We need to work on SEO for the Zulip archive. It's too bad that googling "lean prover string reduce" doesn't turn up one of the relevant threads.</p>



<a name="227308407"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308407" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308407">(Feb 22 2021 at 17:50)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/113488-general/topic/timeout.20why.3F/near/227308181">said</a>:</p>
<blockquote>
<p>You should use <code>#eval</code> instead of <code>#reduce</code>.</p>
</blockquote>
<p>I see but then I have a different problem: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">35</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span> <span class="n">result</span> <span class="n">type</span> <span class="n">does</span> <span class="n">not</span> <span class="k">have</span> <span class="n">an</span> <span class="kd">instance</span> <span class="n">of</span> <span class="n">type</span> <span class="kd">class</span> <span class="bp">'</span><span class="n">has_repr'</span><span class="o">,</span> <span class="n">dumping</span> <span class="n">internal</span> <span class="n">representation</span>
</code></pre></div>



<a name="227308577"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308577" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308577">(Feb 22 2021 at 17:51)</a>:</h4>
<p>So I guess you need to provide an</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="o">:</span> <span class="n">has_repr</span> <span class="n">Code</span> <span class="o">:=</span>
<span class="bp">...</span>
</code></pre></div>



<a name="227308679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308679">(Feb 22 2021 at 17:52)</a>:</h4>
<p>Are there derive handlers for <code>has_repr</code>? If so you can put <code>@[derive has_repr]</code> before most of your defs.</p>



<a name="227308818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227308818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227308818">(Feb 22 2021 at 17:52)</a>:</h4>
<p>Unfortunately not.  But they would be pretty useful.</p>



<a name="227309182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309182">(Feb 22 2021 at 17:55)</a>:</h4>
<p><a href="https://github.com/gebner/mathlib/blob/e66976e99d5e1b7811e80bb7ca41421a5e31a322/src/tactic/derive_to_string.lean">https://github.com/gebner/mathlib/blob/e66976e99d5e1b7811e80bb7ca41421a5e31a322/src/tactic/derive_to_string.lean</a></p>



<a name="227309391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309391">(Feb 22 2021 at 17:56)</a>:</h4>
<p>But the automatically generated instances are not particularly nice.  (It's hard to know if you should parenthesize or not.  That is, <code>var 5</code> or <code>var (5)</code>.)</p>



<a name="227309416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309416">(Feb 22 2021 at 17:56)</a>:</h4>
<p>I am not sure what is going on. Surely lean knows how to evaluate this expression? Or not? And it should also know how to print a list. And Instr which is just a sum???</p>



<a name="227309523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309523">(Feb 22 2021 at 17:57)</a>:</h4>
<p>It doesn't unfold <code>Code</code> when trying to figure out how to print things, afaik.</p>



<a name="227309627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309627">(Feb 22 2021 at 17:57)</a>:</h4>
<p>You can write <code>@[derive has_repr]</code> above <code>def Code</code>, but apparently for <code>Instr</code> you will have to write the instance by hand.</p>



<a name="227309636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309636">(Feb 22 2021 at 17:57)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113488-general/topic/timeout.20why.3F/near/227309523">said</a>:</p>
<blockquote>
<p>It doesn't unfold <code>Code</code> when trying to figure out how to print things, afaik.</p>
</blockquote>
<p>It's not this - I tried substitute Code by list Instr.</p>



<a name="227309759"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309759" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309759">(Feb 22 2021 at 17:58)</a>:</h4>
<p>I guess it got stuck on <code>Instr</code> at that point</p>



<a name="227309858"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309858" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309858">(Feb 22 2021 at 17:59)</a>:</h4>
<p>Actually I also have a related problem. How do I use ++ on Code (which is defined as list Instr)?</p>



<a name="227309938"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227309938" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227309938">(Feb 22 2021 at 17:59)</a>:</h4>
<p>Is there a way to just have a type synonym, without indroducing a new type?</p>



<a name="227310505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227310505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227310505">(Feb 22 2021 at 18:03)</a>:</h4>
<p>You could use <code>@[reducible] def</code> instead.</p>



<a name="227310570"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227310570" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227310570">(Feb 22 2021 at 18:03)</a>:</h4>
<p>Or you could use <code>@[deriv has_append, deriv has_repr] def</code> to copy the instances explicitly.</p>



<a name="227310610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227310610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227310610">(Feb 22 2021 at 18:03)</a>:</h4>
<p>Type-class inference can see through reducible definitions, so you get all instances from list automatically.</p>



<a name="227311051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227311051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227311051">(Feb 22 2021 at 18:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/113488-general/topic/timeout.20why.3F/near/227310505">said</a>:</p>
<blockquote>
<p>You could use <code>@[reducible] def</code> instead.</p>
</blockquote>
<p>Thank you - this does the trick.</p>



<a name="227311697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227311697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227311697">(Feb 22 2021 at 18:11)</a>:</h4>
<p>I still don't understand why #reduce hangs. Btw all I wanted is a nice example for the code without having to create it by hand... :-(</p>



<a name="227311935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227311935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227311935">(Feb 22 2021 at 18:12)</a>:</h4>
<p>Please read the link that Rob posted earlier, it explains the issue.</p>



<a name="227313168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227313168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thorsten Altenkirch <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227313168">(Feb 22 2021 at 18:21)</a>:</h4>
<p>Ah I sort of ignored this because I couldn't imagine it had anything to do with strings. I see. Weird.</p>



<a name="227314546"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227314546" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227314546">(Feb 22 2021 at 18:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/113488-general/topic/timeout.20why.3F/near/227309391">said</a>:</p>
<blockquote>
<p>But the automatically generated instances are not particularly nice.  (It's hard to know if you should parenthesize or not.  That is, <code>var 5</code> or <code>var (5)</code>.)</p>
</blockquote>
<p>Is the heuristic "does the argument contain a space" good enough?</p>



<a name="227314810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227314810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227314810">(Feb 22 2021 at 18:32)</a>:</h4>
<p>It will still use unnecessary parens, but not all the time</p>



<a name="227314969"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227314969" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227314969">(Feb 22 2021 at 18:33)</a>:</h4>
<p>(I think we should add this derive handler, I've missed it before too)</p>



<a name="227329543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227329543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227329543">(Feb 22 2021 at 20:09)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110596">Rob Lewis</span> <a href="#narrow/stream/113488-general/topic/timeout.20why.3F/near/227314546">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110043">Gabriel Ebner</span> <a href="#narrow/stream/113488-general/topic/timeout.20why.3F/near/227309391">said</a>:</p>
<blockquote>
<p>But the automatically generated instances are not particularly nice.  (It's hard to know if you should parenthesize or not.  That is, <code>var 5</code> or <code>var (5)</code>.)</p>
</blockquote>
<p>Is the heuristic "does the argument contain a space" good enough?</p>
</blockquote>
<p>That seems slow.  I would rather go for a typeclass/attribute <code>class does_not_require_parens (α : Sort*) : Prop</code>.  The proper way is of course to add four classes <code>has_to_{repr,string,format,tactic_format}_parens</code> which return tuples consisting of (left-binding power, string, right-binding power).</p>



<a name="227337225"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227337225" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227337225">(Feb 22 2021 at 21:06)</a>:</h4>
<p>That still seems trickier than I care to waste my time on. What if we just add the dumb version? People can still implement their own <code>has_repr</code>s if they don't like the ugly derived one.</p>



<a name="227339631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/227339631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#227339631">(Feb 22 2021 at 21:23)</a>:</h4>
<p>I won't complain about a "bad" version.  I think any derive handler is better than none, and we can improve it afterwards.</p>



<a name="232277217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232277217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232277217">(Mar 29 2021 at 14:30)</a>:</h4>
<p>Most of the discussion so far seems to blame <code>string</code>, right? I have a similar problem using <code>nat</code>. Following the idea from <a href="https://github.com/leanprover/lean/blob/72a965986fa5aeae54062e98efb3140b2c4e79fd/tests/lean/run/soundness.lean">https://github.com/leanprover/lean/blob/72a965986fa5aeae54062e98efb3140b2c4e79fd/tests/lean/run/soundness.lean</a>, we are defining atomic symbols in our logic with nat. Everything looks fine until we need to implement a function to convert between representations.</p>



<a name="232277699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232277699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232277699">(Mar 29 2021 at 14:33)</a>:</h4>
<p>Do you have a <a href="https://leanprover-community.github.io/mwe.html">#mwe</a>? <code>nat</code> should be fine for small numbers</p>



<a name="232277846"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232277846" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232277846">(Mar 29 2021 at 14:34)</a>:</h4>
<p><code>num</code> may perform better if you have larger numbers and still need kernel computation</p>



<a name="232277925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232277925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232277925">(Mar 29 2021 at 14:34)</a>:</h4>
<p>Sorry, yes, I didn't complete my post. The relevant part is <a href="https://github.com/arademaker/alc-lean/blob/atomics/src/alc.lean#L21-L39">https://github.com/arademaker/alc-lean/blob/atomics/src/alc.lean#L21-L39</a>. and <a href="https://github.com/arademaker/alc-lean/blob/atomics/src/sequent.lean#L7-L40">https://github.com/arademaker/alc-lean/blob/atomics/src/sequent.lean#L7-L40</a>. Line 40 is the problem... reduce produces a timeout.</p>



<a name="232278293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232278293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232278293">(Mar 29 2021 at 14:37)</a>:</h4>
<p>The function <code>sigma'</code> is a recursive function to transform the <code>lconcept</code> (labeled concepts) into regular concepts of the logic. The idea is that labeled concepts are concepts were the quantifier prefix were separated into a list.  The reduce is to test if the function definition is right, I can't understand why it doesn't work.</p>



<a name="232279748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232279748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232279748">(Mar 29 2021 at 14:45)</a>:</h4>
<p>The reduction of lconcept and concept terms works. The non-standard facts about <code>sigma'</code> is the pattern match over the structure and the way the recursion calls are constructed. the recursive call is done inside the term being produced.</p>



<a name="232283201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232283201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232283201">(Mar 29 2021 at 15:05)</a>:</h4>
<p>The issue is that <code>sigma'</code> is written in a way that is not straightforwardly structural recursive, so lean is falling back on well founded recursion and this performs poorly in the kernel. There is an easy fix:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">sigma'_aux</span> <span class="o">:</span> <span class="n">list</span> <span class="n">Label</span> <span class="bp">→</span> <span class="n">Concept</span> <span class="bp">→</span> <span class="n">Concept</span>
<span class="bp">|</span> <span class="o">[]</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">c</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">Forall</span> <span class="n">r</span> <span class="o">::</span> <span class="n">ls</span><span class="o">)</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">Every</span> <span class="n">r</span> <span class="o">(</span><span class="n">sigma'_aux</span> <span class="n">ls</span> <span class="n">c</span><span class="o">)</span>
<span class="bp">|</span> <span class="o">(</span><span class="n">Exists</span> <span class="n">r</span> <span class="o">::</span> <span class="n">ls</span><span class="o">)</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">Some</span> <span class="n">r</span> <span class="o">(</span><span class="n">sigma'_aux</span> <span class="n">ls</span> <span class="n">c</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">sigma'</span> <span class="o">:</span> <span class="n">LConcept</span> <span class="bp">→</span> <span class="n">Concept</span>
<span class="bp">|</span> <span class="o">⟨</span><span class="n">roles</span><span class="o">,</span> <span class="n">c</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">sigma'_aux</span> <span class="n">roles</span> <span class="n">c</span>
</code></pre></div>



<a name="232283480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232283480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232283480">(Mar 29 2021 at 15:07)</a>:</h4>
<p>Hi @mario, indeed, I ended up with the same approach that I was about to post. Thank you...</p>



<a name="232283603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232283603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232283603">(Mar 29 2021 at 15:08)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">aux</span> <span class="o">:</span> <span class="n">list</span> <span class="n">Label</span> <span class="bp">-&gt;</span> <span class="n">Concept</span> <span class="bp">-&gt;</span> <span class="n">Concept</span>
 <span class="bp">|</span> <span class="o">[]</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">c</span>
 <span class="bp">|</span> <span class="o">((</span><span class="n">Forall</span> <span class="n">r</span><span class="o">)</span> <span class="o">::</span> <span class="n">ls</span><span class="o">)</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">Every</span> <span class="n">r</span> <span class="o">(</span><span class="n">aux</span> <span class="n">ls</span> <span class="n">c</span><span class="o">)</span>
 <span class="bp">|</span> <span class="o">((</span><span class="n">Exists</span> <span class="n">r</span><span class="o">)</span> <span class="o">::</span> <span class="n">ls</span><span class="o">)</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">Some</span> <span class="n">r</span> <span class="o">(</span><span class="n">aux</span> <span class="n">ls</span> <span class="n">c</span><span class="o">)</span>

<span class="kd">def</span> <span class="n">sigma2</span> <span class="o">(</span><span class="n">lc</span> <span class="o">:</span> <span class="n">LConcept</span><span class="o">)</span> <span class="o">:</span> <span class="n">Concept</span> <span class="o">:=</span> <span class="n">aux</span> <span class="n">lc.roles</span> <span class="n">lc.concept</span>

<span class="k">#reduce</span> <span class="n">sigma2</span> <span class="o">(</span><span class="n">LConcept.mk</span> <span class="o">[</span><span class="n">Forall</span> <span class="n">R</span><span class="bp">#</span><span class="mi">0</span><span class="o">,</span> <span class="n">Exists</span> <span class="n">R</span><span class="bp">#</span><span class="mi">1</span><span class="o">]</span> <span class="o">(</span><span class="n">Concept.Bot</span><span class="o">))</span>
</code></pre></div>
<p>Can we see this as a Lean bug? So maybe we can expect better behaviour in Lean 4?</p>



<a name="232283690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232283690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232283690">(Mar 29 2021 at 15:09)</a>:</h4>
<p>What would the bug be exactly? This is an interaction of components that are all working as designed</p>



<a name="232284105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232284105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232284105">(Mar 29 2021 at 15:11)</a>:</h4>
<p>Also, I think the days of hoping that everything will magically be better in lean 4 are over, because the real thing is out. Many things are better, many other things can be made better in user space, and some things aren't any different. Right now I think well founded recursion isn't completely supported yet but I don't think the overall structure of how the equation compiler picks a compilation strategy will change much if at all</p>



<a name="232284209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232284209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232284209">(Mar 29 2021 at 15:12)</a>:</h4>
<p>well, the pattern matching was used as expected. The syntax for the definition is right. So why the reduction is not working? You said that it is not  <code>straightforwardly structural recursive</code> but it is a recursive definition. Can we provide any hint to Lean? Maybe?!</p>



<a name="232284279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232284279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232284279">(Mar 29 2021 at 15:12)</a>:</h4>
<p>I see.</p>



<a name="232284292"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232284292" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232284292">(Mar 29 2021 at 15:13)</a>:</h4>
<p>Structural recursion means it has to be written in a certain form. You pattern match on an inductive type and call the function on subterms</p>



<a name="232284389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232284389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232284389">(Mar 29 2021 at 15:13)</a>:</h4>
<p><code>sigma'</code> isn't written like that because <code>(LConcept.mk ls c)</code> is not a subterm of <code>{ LConcept . roles := (Forall r :: ls) , concept := c}</code></p>



<a name="232284507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232284507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232284507">(Mar 29 2021 at 15:14)</a>:</h4>
<p>I'm not saying it can't be better, I'm saying there is a nontrivial design question that has to be resolved to improve the situation</p>



<a name="232284813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232284813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232284813">(Mar 29 2021 at 15:16)</a>:</h4>
<p>well founded recursion is much more flexible, you can call the function on anything with a smaller "size", where size is a natural number defined automatically on inductive types. <code>sizeof (LConcept.mk ls c) &lt; sizeof { LConcept . roles := (Forall r :: ls) , concept := c}</code> which is why the wf recursion compilation strategy succeeds</p>



<a name="232285097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232285097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232285097">(Mar 29 2021 at 15:17)</a>:</h4>
<p>I see, thank you for the explanation.</p>



<a name="232285116"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232285116" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232285116">(Mar 29 2021 at 15:17)</a>:</h4>
<p>However, the issue with well founded recursion is that it requires unfolding proofs in order for the definition to definitionally reduce in the kernel (which is what <code>#reduce</code> does), and lean / mathlib generally make no effort to write proofs that can be computed well (indeed, most proofs use axioms and those block computation entirely)</p>



<a name="232285354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232285354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232285354">(Mar 29 2021 at 15:18)</a>:</h4>
<p>The real answer is "don't use <code>#reduce</code>" though</p>



<a name="232285410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232285410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232285410">(Mar 29 2021 at 15:18)</a>:</h4>
<p>It is slow and mostly useless</p>



<a name="232285515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232285515" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232285515">(Mar 29 2021 at 15:19)</a>:</h4>
<p><code>#eval</code> works fine on the wf definition</p>



<a name="232285654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232285654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232285654">(Mar 29 2021 at 15:19)</a>:</h4>
<p>But for using eval I will need to understand how to provide the has_repr instance to may structures and inductive types..</p>



<a name="232296228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232296228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232296228">(Mar 29 2021 at 16:31)</a>:</h4>
<p><span class="user-mention" data-user-id="121542">@Alexandre Rademaker</span> If the only reason you aren't using <code>#eval</code> is because <code>#reduce</code> gets better printing, here's a life hack for you</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">meta</span> <span class="kd">def</span> <span class="n">print</span> <span class="o">{</span><span class="n">α</span><span class="o">}</span> <span class="o">[</span><span class="n">has_reflect</span> <span class="n">α</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">tactic.pp</span> <span class="o">(</span><span class="n">reflect</span> <span class="n">e</span><span class="o">)</span> <span class="bp">&gt;&gt;=</span> <span class="n">tactic.trace</span>

<span class="k">#eval</span> <span class="n">print</span> <span class="bp">$</span> <span class="n">sigma'</span> <span class="o">(</span><span class="n">LConcept.mk</span> <span class="o">[</span><span class="n">Forall</span> <span class="n">R</span><span class="bp">#</span><span class="mi">0</span><span class="o">,</span> <span class="n">Exists</span> <span class="n">R</span><span class="bp">#</span><span class="mi">1</span><span class="o">]</span> <span class="o">(</span><span class="n">Concept.Bot</span><span class="o">))</span>
<span class="c1">-- Ax R#0:Ex R#1:Bot</span>
</code></pre></div>
<p>That way you just need <code>@[derive has_reflect]</code> on all your inductive types, and you get the same printing as lean will normally do, meaning that notations and things work as normal</p>



<a name="232298568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232298568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232298568">(Mar 29 2021 at 16:48)</a>:</h4>
<p>Thank you, I should have missed someting, I spread the <code>@[derive has_reflect]</code> all over the places but now eval does not produce anything</p>
<p><a href="https://github.com/arademaker/alc-lean/blob/atomics/src/sequent.lean">https://github.com/arademaker/alc-lean/blob/atomics/src/sequent.lean</a></p>



<a name="232298740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232298740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alexandre Rademaker <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232298740">(Mar 29 2021 at 16:50)</a>:</h4>
<p>Oh, no. Sorry. It is working, the Emacs mode is not showing it with the <code>C-c C-b</code> (Toogle message boxes).</p>



<a name="232298912"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/timeout%20why%3F/near/232298912" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/timeout.20why.3F.html#232298912">(Mar 29 2021 at 16:50)</a>:</h4>
<p>you might also try using <code>run_cmd</code> instead of <code>#eval</code>; it should look the same but maybe emacs shows it differently</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>