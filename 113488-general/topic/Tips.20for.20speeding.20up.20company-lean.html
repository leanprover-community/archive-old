---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html">Tips for speeding up company-lean</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="278218834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278218834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278218834">(Apr 07 2022 at 20:02)</a>:</h4>
<p>I still have this dream of using emacs for Lean(3). Today I had some OS upgrading issues and had to remove electron (and thus also vscode), so I tried emacs again, and I was immediately reminded of why I switched to vscode -- writing lean in emacs is tediously slow!<br>
One of the main culprits is <code>company-lean</code> which is automatically trigerred in my setup (I'm using doom emacs, and <code>lean</code> is available as one of the built in packages). When it's triggered, all typing seems to stop, and things become unusable for several seconds.<br>
Does anyone have any hints for speeding up <code>company-lean</code>? Does anyone have any hints for speeing up lean development in emacs in general?</p>



<a name="278224993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278224993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278224993">(Apr 07 2022 at 20:56)</a>:</h4>
<p>I don't remember ever seeing this behavior so maybe it is caused by the doom emacs configuration somehow?</p>



<a name="278225271"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278225271" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278225271">(Apr 07 2022 at 20:59)</a>:</h4>
<p>The usual stuff I do to prevent my company auto complete to lag is to limit the word length at which it triggers (t's 3 rn) and the maximum count of suggestions it provides, maybe that helps?</p>



<a name="278225573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278225573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278225573">(Apr 07 2022 at 21:01)</a>:</h4>
<p>I'm a bit confused by the company-mode documentation, is autocompletion supposed to be getting triggered automatically?</p>



<a name="278225623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278225623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278225623">(Apr 07 2022 at 21:01)</a>:</h4>
<p>I see there is stuff like what Henrik mentioned, but it doesn't seem to do anything for me (luckily!)</p>



<a name="278225878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278225878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278225878">(Apr 07 2022 at 21:03)</a>:</h4>
<p>Yes, company has a concept of so callled "backends" that essentially act as suggestion providers which it goes through whenever the preconditions for company to trigger (that is, the idle timeout as well as the minimum word length) is triggered, if any of the backends provide something its shown.</p>



<a name="278225932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278225932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278225932">(Apr 07 2022 at 21:04)</a>:</h4>
<p>I have it set to automatically trigger after 1 idle second, but once it's triggered, the lag is crazy</p>



<a name="278225955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278225955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278225955">(Apr 07 2022 at 21:04)</a>:</h4>
<p>I do for example have this setup: <a href="https://github.com/hargoniX/dotfiles/blob/master/dotfiles/init.el#L383-L400">https://github.com/hargoniX/dotfiles/blob/master/dotfiles/init.el#L383-L400</a> and manually add a yasnippet backend here so I can see them in autocomplete: <a href="https://github.com/hargoniX/dotfiles/blob/master/dotfiles/init.el#L402-L409">https://github.com/hargoniX/dotfiles/blob/master/dotfiles/init.el#L402-L409</a></p>



<a name="278226125"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226125" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226125">(Apr 07 2022 at 21:05)</a>:</h4>
<p>So just to check, you mean the selection menu pops up automatically after a short delay whenever it has suggestions?</p>



<a name="278226151"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226151" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226151">(Apr 07 2022 at 21:05)</a>:</h4>
<p>I just have <code>M-n</code> bound to <code>company-complete</code> and press it manually</p>



<a name="278226183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226183">(Apr 07 2022 at 21:05)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean/near/278226125">said</a>:</p>
<blockquote>
<p>So just to check, you mean the selection menu pops up automatically after a short delay whenever it has suggestions?</p>
</blockquote>
<p>yes, that's right</p>



<a name="278226188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226188">(Apr 07 2022 at 21:05)</a>:</h4>
<p>Are you on emacs 28 already? That one could also provide a huge speedup if the slowdown is inside emacs itself since it can compile the lisp stuff to C</p>



<a name="278226259"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226259" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226259">(Apr 07 2022 at 21:06)</a>:</h4>
<p>I am! 28.1</p>



<a name="278226343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226343">(Apr 07 2022 at 21:07)</a>:</h4>
<p>Well it looks like you can set <code>company-idle-delay</code> to <code>nil</code> to prevent that from happening, though I'm still confused why it doesn't happen to me (probably I am on an old version of something)</p>



<a name="278226505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226505">(Apr 07 2022 at 21:08)</a>:</h4>
<p>I should say that I want it to pop up automatically.</p>



<a name="278226555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226555">(Apr 07 2022 at 21:09)</a>:</h4>
<p>I'll try out some of Henrik's configurations later and see if they help! Thanks!</p>



<a name="278226597"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226597" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226597">(Apr 07 2022 at 21:09)</a>:</h4>
<p>I know this is very <a href="https://xkcd.com/1172/">https://xkcd.com/1172/</a> but having the menu pop up automatically sounds awful, IMHO</p>



<a name="278226719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278226719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278226719">(Apr 07 2022 at 21:10)</a>:</h4>
<p>Why did I know precisely which xkcd that was <span aria-label="laughing" class="emoji emoji-1f606" role="img" title="laughing">:laughing:</span></p>



<a name="278227284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Tips%20for%20speeding%20up%20company-lean/near/278227284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Henrik Böving <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Tips.20for.20speeding.20up.20company-lean.html#278227284">(Apr 07 2022 at 21:15)</a>:</h4>
<p>Thats the reason I set it to 0.5, if im still in the same spot in insert mode after 0.5 seconds i probably want the menu to pop up anyways^^</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>