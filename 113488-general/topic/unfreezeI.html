---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/unfreezeI.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html">unfreezeI</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="195285944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfreezeI/near/195285944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html#195285944">(Apr 25 2020 at 13:53)</a>:</h4>
<p>I've never understood what <code>unfreezeI</code> was for. But I know that we needed it because of "core". Now that "core" is no longer a reason... can we get rid of <code>unfreezeI</code>?</p>



<a name="195286505"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfreezeI/near/195286505" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html#195286505">(Apr 25 2020 at 14:10)</a>:</h4>
<p>The "core" reason is deeply buried in type class resolution.  IIRC, calling <code>unfreezeI</code> (partly) disables caching for type class resolution.  <span class="user-mention" data-user-id="238446">@Anne Baanen</span> tried to remove this caching mechanism, but apparently it's not entirely trivial.</p>



<a name="195295594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfreezeI/near/195295594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html#195295594">(Apr 25 2020 at 17:56)</a>:</h4>
<p>But the caching was actually broken for the longest time in such a way that <code>unfreezeI</code> etc wasn't necessary, until Leo fixed it. Can't that fix just be reverted? I don't remember anyone noticing any actual benefits such as better performance from the fix.</p>



<a name="195296042"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfreezeI/near/195296042" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html#195296042">(Apr 25 2020 at 18:07)</a>:</h4>
<p>I have a more relevant question (I think). Do we know what will be the situation in Lean 4? We don't want to unlearn our instance cache management habits in Lean 3 only to relearn them when we'll switch to Lean 4? I don't expect Leo will change his mind on this question, but maybe the question itself will become irrelevant in Lean 4.</p>



<a name="195296501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfreezeI/near/195296501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html#195296501">(Apr 25 2020 at 18:18)</a>:</h4>
<p>I believe the plan is that all surface-level binders automatically reset the cache. Only tactics introducing instances internally have to worry about it.</p>



<a name="195296585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfreezeI/near/195296585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html#195296585">(Apr 25 2020 at 18:21)</a>:</h4>
<p>I'm afraid I don't understand this whole story well enough to parse this answer.</p>



<a name="195296591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfreezeI/near/195296591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html#195296591">(Apr 25 2020 at 18:21)</a>:</h4>
<p>Does it mean we won't need <code>haveI</code> and <code>letI</code>?</p>



<a name="195296852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfreezeI/near/195296852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfreezeI.html#195296852">(Apr 25 2020 at 18:28)</a>:</h4>
<p>Yes, unless you're a tactic writer and care about that level of optimization.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>