---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/map_map.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html">map_map</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="162761390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/162761390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#162761390">(Apr 07 2019 at 16:05)</a>:</h4>
<p>Could we get <a href="https://github.com/leanprover-community/mathlib/blob/master/src/category/basic.lean#L19" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/category/basic.lean#L19">https://github.com/leanprover-community/mathlib/blob/master/src/category/basic.lean#L19</a> out of the root namespace? <code>map_map</code> is a really generic name, so it's real a pain.</p>



<a name="162761536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/162761536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#162761536">(Apr 07 2019 at 16:08)</a>:</h4>
<p>How about <code>is_lawful_functor</code>?</p>



<a name="162761667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/162761667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#162761667">(Apr 07 2019 at 16:11)</a>:</h4>
<p>I don't understand your question</p>



<a name="162761850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/162761850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#162761850">(Apr 07 2019 at 16:14)</a>:</h4>
<p>What does <code>protected</code> even mean for a function in the root namespace?</p>



<a name="162761890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/162761890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#162761890">(Apr 07 2019 at 16:15)</a>:</h4>
<p>I think there was a time when this line was indeed inside a name space</p>



<a name="162773854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/162773854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#162773854">(Apr 07 2019 at 21:34)</a>:</h4>
<p>getting <code>functor.map_id</code> and <code>functor.map_comp</code> out of the root namespace would also be nice; these often get in the way of <code>category_theory.functor.map_id</code> and co.</p>



<a name="162775277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/162775277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#162775277">(Apr 07 2019 at 22:12)</a>:</h4>
<blockquote>
<p>getting <code>functor.map_id</code> and <code>functor.map_comp</code> out of the root namespace would also be nice; these often get in the way of <code>category_theory.functor.map_id</code> and co.</p>
</blockquote>
<p>Could these just be protected?</p>



<a name="203138852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203138852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203138852">(Jul 07 2020 at 18:10)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> , would you mind if we get <code>map_map</code>out of the root namespace? It's a really generic name (and I always want <code>filter.map_map</code> instead, but that's a different topic). TBH, <a href="https://github.com/leanprover-community/mathlib/blob/master/src/control/basic.lean#L20">https://github.com/leanprover-community/mathlib/blob/master/src/control/basic.lean#L20</a> looks like it was meant to be name-spaced anyway.</p>



<a name="203138957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203138957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203138957">(Jul 07 2020 at 18:11)</a>:</h4>
<p>I'm all for <span aria-label="+1" class="emoji emoji-1f44d" role="img" title="+1">:+1:</span></p>



<a name="203139081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203139081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203139081">(Jul 07 2020 at 18:12)</a>:</h4>
<p><code>functor.map_map</code> then?</p>



<a name="203139298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203139298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203139298">(Jul 07 2020 at 18:14)</a>:</h4>
<p>Anyone against taking the opportunity to rename <code>filter.comap_comap_comp</code> to <code>filter.comap_comap</code> for consistency?</p>



<a name="203139427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203139427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203139427">(Jul 07 2020 at 18:15)</a>:</h4>
<p>And while Simon is here: any idea why the <code>mono</code> attribute doesn't like <code>filter.map_mono</code> and <code>filter.comap_mono</code>?</p>



<a name="203139756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203139756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203139756">(Jul 07 2020 at 18:18)</a>:</h4>
<p>Note that</p>
<div class="codehilite"><pre><span></span><code><span class="kn">lemma</span> <span class="n">comap_mono&#39;</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">m</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">}</span> <span class="o">:</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">filter</span> <span class="n">β</span><span class="o">},</span> <span class="n">f</span> <span class="bp">≤</span> <span class="n">g</span> <span class="bp">→</span> <span class="n">comap</span> <span class="n">m</span> <span class="n">f</span> <span class="bp">≤</span> <span class="n">comap</span> <span class="n">m</span> <span class="n">g</span> <span class="o">:=</span>
<span class="n">comap_mono</span>

<span class="n">attribute</span> <span class="o">[</span><span class="n">mono</span><span class="o">]</span> <span class="n">comap_mono&#39;</span>
</code></pre></div>


<p>works.</p>



<a name="203141637"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203141637" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203141637">(Jul 07 2020 at 18:34)</a>:</h4>
<p>Can you show me <code>comap_mono</code>?</p>



<a name="203141665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203141665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203141665">(Jul 07 2020 at 18:35)</a>:</h4>
<p>Also the error message</p>



<a name="203145708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203145708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203145708">(Jul 07 2020 at 19:04)</a>:</h4>
<p><code>comap_mono : ∀ {α : Type u_1} {β : Type u_2} {m : α → β}, monotone (comap m)</code></p>



<a name="203145739"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203145739" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203145739">(Jul 07 2020 at 19:05)</a>:</h4>
<p>The error message is "failed".</p>



<a name="203145752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203145752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203145752">(Jul 07 2020 at 19:05)</a>:</h4>
<p>I think it's just that it doesn't unfold <code>monotone</code></p>



<a name="203145789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203145789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203145789">(Jul 07 2020 at 19:05)</a>:</h4>
<p>That's pretty clear isn't it? Why do you need my help? :P</p>



<a name="203146216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203146216" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203146216">(Jul 07 2020 at 19:08)</a>:</h4>
<p>I think the reason for not unfolding definitions, is that subset is defined as a forall that <code>mono</code> would mistake for introducing relevant assumptions if we unfolded it. I just decided not to unfold anything. I could unfold specifically <code>monotone</code>. I wonder if there's a less intertwined mechanism that would work as well</p>



<a name="203147360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203147360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203147360">(Jul 07 2020 at 19:16)</a>:</h4>
<p>Having a special case for <code>monotone</code> seems fair for a monotonicity tactic.</p>



<a name="203147868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203147868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203147868">(Jul 07 2020 at 19:21)</a>:</h4>
<p>What I worry about is that there could be ways to have a different formulation (e.g. more adapted to category theory or more general) of <code>monotone</code> and we'd have to list all the variations in the tactic. Alternatively, we can just tag all the definitions with an attribute</p>



<a name="203147891"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203147891" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203147891">(Jul 07 2020 at 19:21)</a>:</h4>
<p>Simon, do you actually want <code>functor.map_map</code> to be protected?</p>



<a name="203148476"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203148476" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203148476">(Jul 07 2020 at 19:25)</a>:</h4>
<p>I'm not sure. Do you ever use it with <code>filter.map_map</code>?</p>



<a name="203148961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203148961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203148961">(Jul 07 2020 at 19:29)</a>:</h4>
<p>I never use it, period.</p>



<a name="203149139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203149139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203149139">(Jul 07 2020 at 19:30)</a>:</h4>
<p>I don't think it needs to be protected</p>



<a name="203149199"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203149199" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203149199">(Jul 07 2020 at 19:31)</a>:</h4>
<p>About <code>mono</code>, I'd like to have something simple that unfold <code>monotone</code> and nothing else. Category people can complain later.</p>



<a name="203149703"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203149703" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203149703">(Jul 07 2020 at 19:35)</a>:</h4>
<p>I can see you're not the one they come after with their sharp arrows</p>



<a name="203149796"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203149796" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203149796">(Jul 07 2020 at 19:36)</a>:</h4>
<p>But seriously, what file is it defined in and does that file import fancy tactics?</p>



<a name="203149976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203149976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203149976">(Jul 07 2020 at 19:37)</a>:</h4>
<p>order/basic</p>



<a name="203150155"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203150155" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203150155">(Jul 07 2020 at 19:39)</a>:</h4>
<p>which import only data.set.basic</p>



<a name="203150482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203150482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203150482">(Jul 07 2020 at 19:42)</a>:</h4>
<p>Cool, so that can be made to work. And it can be left as an exercise to the reader</p>



<a name="203150506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203150506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203150506">(Jul 07 2020 at 19:42)</a>:</h4>
<p><a href="/user_uploads/3121/OAR976lOUO8Ok7G6GExwsYU5/gr.pdf">gr.pdf</a></p>



<a name="203150579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203150579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203150579">(Jul 07 2020 at 19:43)</a>:</h4>
<p>That's <code> leanproject import-graph --to order.basic gr.pdf</code></p>



<a name="203150746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203150746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203150746">(Jul 07 2020 at 19:45)</a>:</h4>
<p>That is really a cool idea! I've never used it</p>



<a name="203197983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203197983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203197983">(Jul 07 2020 at 20:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110026">Simon Hudon</span> <a href="#narrow/stream/113488-general/topic/map_map/near/203150482">said</a>:</p>
<blockquote>
<p>Cool, so that can be made to work. And it can be left as an exercise to the reader</p>
</blockquote>
<p>If this is serious then I'll need hints. For instance a docstring on each def of <a href="https://github.com/leanprover-community/mathlib/blob/master/src/tactic/monotonicity/basic.lean">https://github.com/leanprover-community/mathlib/blob/master/src/tactic/monotonicity/basic.lean</a></p>



<a name="203198801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203198801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203198801">(Jul 07 2020 at 20:29)</a>:</h4>
<p>Ok first step, I believe this is where the error message comes from: </p>
<p><a href="https://github.com/leanprover-community/mathlib/blob/master/src/tactic/monotonicity/basic.lean#L84">https://github.com/leanprover-community/mathlib/blob/master/src/tactic/monotonicity/basic.lean#L84</a></p>
<p>Let's make a more helpful message</p>



<a name="203199047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203199047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203199047">(Jul 07 2020 at 20:31)</a>:</h4>
<p>I think you could write <code>fail!"Cannot find relation in {h}"</code></p>



<a name="203199478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203199478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203199478">(Jul 07 2020 at 20:35)</a>:</h4>
<p>What you care about is mostly <code>monotonicity.attr</code> and <code>monotonicity.check</code>. <code>monotonicity.check</code> finds a relation in the type of the lemma and constructs a key to look it up in an index. That's where I would unfold <code>monotone</code>. Another reasonable approach would be to use an application of <code>monotone</code> as a way of determining what is the monotonic function and the relation it preserves</p>



<a name="203199992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203199992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203199992">(Jul 07 2020 at 20:40)</a>:</h4>
<p>I'm struggling to minimize the map_mono issue</p>



<a name="203200009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203200009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203200009">(Jul 07 2020 at 20:40)</a>:</h4>
<p>I get a different error message.</p>



<a name="203200103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203200103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203200103">(Jul 07 2020 at 20:41)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">order</span><span class="bp">.</span><span class="n">basic</span>
<span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">monotonicity</span>

<span class="bp">@</span><span class="o">[</span><span class="n">mono</span><span class="o">]</span>
<span class="kn">lemma</span> <span class="n">test</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">preorder</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">x</span> <span class="n">y</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">id</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">id</span> <span class="n">y</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="n">h</span>

<span class="bp">@</span><span class="o">[</span><span class="n">mono</span><span class="o">]</span>
<span class="kn">lemma</span> <span class="n">test&#39;</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">preorder</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">monotone</span> <span class="o">(</span><span class="n">id</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="n">h</span>
</code></pre></div>


<p>The first lemma works fine, the second one says:</p>
<div class="codehilite"><pre><span></span><code><span class="n">oh</span><span class="err">?</span> <span class="k">Pi</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="bp">_</span><span class="n">mlocal</span><span class="bp">._</span><span class="n">fresh</span><span class="bp">.</span><span class="mi">1264</span><span class="bp">.</span><span class="mi">227</span><span class="o">}}</span> <span class="o">[</span><span class="bp">_</span><span class="n">inst_1</span> <span class="o">:</span> <span class="n">preorder</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="bp">_</span><span class="n">mlocal</span><span class="bp">._</span><span class="n">fresh</span><span class="bp">.</span><span class="mi">1264</span><span class="bp">.</span><span class="mi">227</span><span class="o">}</span> <span class="n">α</span><span class="o">],</span> <span class="o">(</span><span class="n">monotone</span><span class="bp">.</span><span class="o">{</span><span class="err">?</span><span class="bp">_</span><span class="n">mlocal</span><span class="bp">._</span><span class="n">fresh</span><span class="bp">.</span><span class="mi">1264</span><span class="bp">.</span><span class="mi">227</span> <span class="err">?</span><span class="bp">_</span><span class="n">mlocal</span><span class="bp">._</span><span class="n">fresh</span><span class="bp">.</span><span class="mi">1264</span><span class="bp">.</span><span class="mi">227</span><span class="o">}</span> <span class="n">α</span> <span class="n">α</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="bp">_</span><span class="n">inst_1</span> <span class="o">(</span><span class="n">id</span><span class="bp">.</span><span class="o">{</span><span class="n">succ</span> <span class="err">?</span><span class="bp">_</span><span class="n">mlocal</span><span class="bp">._</span><span class="n">fresh</span><span class="bp">.</span><span class="mi">1264</span><span class="bp">.</span><span class="mi">227</span><span class="o">}</span> <span class="n">α</span><span class="o">))</span>
</code></pre></div>



<a name="203200472"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203200472" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203200472">(Jul 07 2020 at 20:44)</a>:</h4>
<p>before line 100, trace <code>xs</code> and <code>h</code></p>



<a name="203200549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203200549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203200549">(Jul 07 2020 at 20:45)</a>:</h4>
<p>Nothing</p>



<a name="203200591"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203200591" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203200591">(Jul 07 2020 at 20:45)</a>:</h4>
<p>wait</p>



<a name="203200642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203200642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203200642">(Jul 07 2020 at 20:46)</a>:</h4>
<p>I didn't have my cursor right</p>



<a name="203200689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203200689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203200689">(Jul 07 2020 at 20:46)</a>:</h4>
<p>It says <code>([α, _inst_1], monotone id)</code> twice</p>



<a name="203200897"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203200897" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203200897">(Jul 07 2020 at 20:49)</a>:</h4>
<p>I see</p>



<a name="203201107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203201107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203201107">(Jul 07 2020 at 20:50)</a>:</h4>
<p><code>mono_head_candidates 3 xs.reverse h</code> is considering the head of the type (after all the <code>-&gt;</code> and <code>Pi</code>) and at most three variables (in case we're considering the monotonicity of implication)</p>



<a name="203201324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203201324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203201324">(Jul 07 2020 at 20:52)</a>:</h4>
<p>But <code>monotone</code> is not a relation. So before calling <code>mono_head_candidates</code>, you should use <code>dsimp</code> to unfold <code>monotone</code> on the type of the lemma</p>



<a name="203201550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203201550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203201550">(Jul 07 2020 at 20:54)</a>:</h4>
<p><code>dsimp</code> at what?  <code>lm_n</code>?</p>



<a name="203201560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203201560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203201560">(Jul 07 2020 at 20:54)</a>:</h4>
<p>you can call it as <code>lm_t &lt;- expr.dsimp lm_t { fail_if_unchanged := ff } tt [] [simp_arg_type.expr ``(monotone)],</code></p>
<p>(editted)</p>



<a name="203201973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203201973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203201973">(Jul 07 2020 at 20:57)</a>:</h4>
<p>That seems to work!</p>



<a name="203201994"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203201994" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203201994">(Jul 07 2020 at 20:58)</a>:</h4>
<p>I mean for the identity is monotone lemma.</p>



<a name="203202121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202121">(Jul 07 2020 at 20:58)</a>:</h4>
<p>And with the one that does not mention <code>monotone</code>, that works as well?</p>



<a name="203202434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202434">(Jul 07 2020 at 21:01)</a>:</h4>
<p>Yes, but it doesn't work with filters <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span> It accepts to add the attribute but doesn't use the lemma.</p>



<a name="203202543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202543">(Jul 07 2020 at 21:02)</a>:</h4>
<p>The trace for that lemma is <code>([α, β, m, a, b, a], filter.map m a ≤ filter.map m b)</code></p>



<a name="203202627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202627">(Jul 07 2020 at 21:03)</a>:</h4>
<p>Ok</p>



<a name="203202768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202768">(Jul 07 2020 at 21:04)</a>:</h4>
<p>Go to line 147. This is where we query the monotonicity cache.</p>



<a name="203202791"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202791" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202791">(Jul 07 2020 at 21:04)</a>:</h4>
<p>The function is called <code>get_monotonicity_lemmas</code></p>



<a name="203202821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202821">(Jul 07 2020 at 21:04)</a>:</h4>
<p>yes, I see it</p>



<a name="203202868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202868">(Jul 07 2020 at 21:05)</a>:</h4>
<p>A little lower, we search it and assign to <code>ns</code> a list of candidates. Print it</p>



<a name="203202984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203202984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203202984">(Jul 07 2020 at 21:06)</a>:</h4>
<p>We're going to make sure that the lemma makes it to the list of candidates. After, we're going to see how it gets removed (if it does)</p>



<a name="203203007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203007">(Jul 07 2020 at 21:06)</a>:</h4>
<p>It's in the list</p>



<a name="203203034"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203034" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203034">(Jul 07 2020 at 21:06)</a>:</h4>
<p>but <code>no good match</code></p>



<a name="203203053"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203053" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203053">(Jul 07 2020 at 21:06)</a>:</h4>
<p>What about the contents of <code>ns'</code>?</p>



<a name="203203132"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203132" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203132">(Jul 07 2020 at 21:07)</a>:</h4>
<p>same list with only one element</p>



<a name="203203356"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203356" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203356">(Jul 07 2020 at 21:09)</a>:</h4>
<p>In a different file <a href="https://github.com/leanprover-community/mathlib/blob/master/src/tactic/monotonicity/interactive.lean#L470">https://github.com/leanprover-community/mathlib/blob/master/src/tactic/monotonicity/interactive.lean#L470</a> we have <code>mono_aux</code> that does more filtering and then makes several attempts at applying candidates</p>



<a name="203203824"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203824" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203824">(Jul 07 2020 at 21:13)</a>:</h4>
<p>First, print <code>rs</code></p>



<a name="203203886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203886">(Jul 07 2020 at 21:14)</a>:</h4>
<p>It's thinking about it</p>



<a name="203203907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203907">(Jul 07 2020 at 21:14)</a>:</h4>
<p>Time to make some tea</p>



<a name="203203920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203203920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203203920">(Jul 07 2020 at 21:14)</a>:</h4>
<p>It's in ns but not rs</p>



<a name="203204291"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203204291" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203204291">(Jul 07 2020 at 21:18)</a>:</h4>
<p>Ok so it probably happens in <code>find_lemma</code></p>



<a name="203204331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203204331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203204331">(Jul 07 2020 at 21:19)</a>:</h4>
<p>And looking at <code>find_lemma</code>, <code>match_rule</code> and <code>match_rule_head</code> are probably relevant</p>



<a name="203204357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203204357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203204357">(Jul 07 2020 at 21:19)</a>:</h4>
<p>Yes, this I was able to tell</p>



<a name="203204449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203204449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203204449">(Jul 07 2020 at 21:20)</a>:</h4>
<p>What I would try is put the same <code>dsimp</code> line here: <a href="https://github.com/leanprover-community/mathlib/blob/master/src/tactic/monotonicity/interactive.lean#L355">https://github.com/leanprover-community/mathlib/blob/master/src/tactic/monotonicity/interactive.lean#L355</a></p>



<a name="203204457"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203204457" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203204457">(Jul 07 2020 at 21:20)</a>:</h4>
<p>And clearly whatever unfolding was done when putting the attribute is now lost</p>



<a name="203204484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203204484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203204484">(Jul 07 2020 at 21:20)</a>:</h4>
<p>with a small adjustment</p>



<a name="203204565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203204565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203204565">(Jul 07 2020 at 21:20)</a>:</h4>
<p>Exactly because only the name of the lemma is put in the cache</p>



<a name="203204588"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203204588" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203204588">(Jul 07 2020 at 21:20)</a>:</h4>
<p>Yes</p>



<a name="203207822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203207822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203207822">(Jul 07 2020 at 21:50)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/3310">https://github.com/leanprover-community/mathlib/pull/3310</a></p>



<a name="203321318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203321318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203321318">(Jul 08 2020 at 20:50)</a>:</h4>
<p><span class="user-mention" data-user-id="110026">@Simon Hudon</span> Could you review the above PR? I think Scott, Rob and I sufficiently messed up with your work to ensure you can go from author to reviewer.</p>



<a name="203321805"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203321805" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203321805">(Jul 08 2020 at 20:55)</a>:</h4>
<p>I approve. Should I post <code>bors r+</code> to get it merged?</p>



<a name="203321943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203321943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203321943">(Jul 08 2020 at 20:56)</a>:</h4>
<p>Yes, please.</p>



<a name="203321953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203321953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203321953">(Jul 08 2020 at 20:56)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/3310/files#diff-46d8fb7fe470316c30396976c88b30a9R99">This</a> is the only actual change, right? The rest is tracing or removing unused arguments. I think it should be uncontroversial!</p>



<a name="203321979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203321979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203321979">(Jul 08 2020 at 20:56)</a>:</h4>
<p>Simon, do you understand how we ended up with all those unused argument?</p>



<a name="203322014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203322014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203322014">(Jul 08 2020 at 20:56)</a>:</h4>
<p>Rob, you missed <a href="https://github.com/leanprover-community/mathlib/pull/3310/files#diff-54c5eab6d816f396b485233519d628acR356">https://github.com/leanprover-community/mathlib/pull/3310/files#diff-54c5eab6d816f396b485233519d628acR356</a></p>



<a name="203322040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203322040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203322040">(Jul 08 2020 at 20:57)</a>:</h4>
<p>I think I did some refactoring lazily and didn't bother making sure that the arguments were needed</p>



<a name="203322099"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203322099" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203322099">(Jul 08 2020 at 20:57)</a>:</h4>
<p>Btw, what's the difference between <code>bors r+</code> and <code>bors r-</code>?</p>



<a name="203322136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/map_map/near/203322136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/map_map.html#203322136">(Jul 08 2020 at 20:57)</a>:</h4>
<p>I think they are opposite moves.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>