---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/mathport.20and.20git.20history.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html">mathport and git history</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="265815478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265815478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265815478">(Dec 22 2021 at 15:14)</a>:</h4>
<p>I don't think this is a goal in this process.  Things are difficult enough.</p>



<a name="265815792"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265815792" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265815792">(Dec 22 2021 at 15:17)</a>:</h4>
<p>Would it be at all within the realm of possibility to run <code>git filter-branch --tree-filter 'synport **/*.lean'</code> on the entirety of mathlib history? I might look into that if I suddenly find myself with too much free time :)</p>



<a name="265815993"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265815993" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265815993">(Dec 22 2021 at 15:19)</a>:</h4>
<p>On the other hand, it requires zero Lean skills so the chance of executing this in parallel (by finding a different set of volunteers to do the repo surgery) is much higher. But it requires a few executive decisions first so the mathlib3 and mathlib4 GitHub Issues don't end up in different repositories if the history surgery is eventually done.</p>



<a name="265816521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265816521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265816521">(Dec 22 2021 at 15:24)</a>:</h4>
<p>The easiest way to do that would be to probably <em>copy</em> the git /mathlib repo to /mathlib3 when the day comes (instead of renaming through GitHub) and push a big commit to /mathlib with the migration. This preserves history and issues, and also allows someone to do work in the future to improve git blame support across versions.</p>



<a name="265818120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265818120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265818120">(Dec 22 2021 at 15:39)</a>:</h4>
<p>I like this approach. Another way to think of it is starting a fresh repository with precisely the current <code>mathlib</code> files and git history and then do a big commit replacing everything by the migrated version.</p>



<a name="265818717"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265818717" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265818717">(Dec 22 2021 at 15:44)</a>:</h4>
<p>This depends on whether people decide keeping old issues/PRs in the same repo as new ones is desirable, because those don't live in-repo. It has its pros and cons.</p>



<a name="265819282"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265819282" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265819282">(Dec 22 2021 at 15:49)</a>:</h4>
<p>(deleted)</p>



<a name="265820176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265820176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265820176">(Dec 22 2021 at 15:56)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/113488-general/topic/Community.20blog/near/265818120">said</a>:</p>
<blockquote>
<p>I like this approach. Another way to think of it is starting a fresh repository with precisely the current <code>mathlib</code> files and git history and then do a big commit replacing everything by the migrated version.</p>
</blockquote>
<p>This is the approach I would lean towards. In particular, it means that git-savvy users can:</p>
<ul>
<li>Run synport on the new files in some stale lean3 PR</li>
<li>merge mathlib4/master into the PR, and have things mostly just work</li>
</ul>



<a name="265820388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265820388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265820388">(Dec 22 2021 at 15:58)</a>:</h4>
<p>Wouldn't that be easier if mathlib was the Lean 4 repo post-migration? You could even update stale lean3 PRs in-place.</p>



<a name="265820740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265820740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265820740">(Dec 22 2021 at 16:00)</a>:</h4>
<p>(Note: this discussion originated as reply to a community blogpost. See <a href="#narrow/stream/113488-general/topic/Community.20blog/near/265810799">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Community.20blog/near/265810799</a>)</p>



<a name="265820750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265820750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265820750">(Dec 22 2021 at 16:01)</a>:</h4>
<p>Keeping it separate has the advantages of:</p>
<ul>
<li>A clean slate for Prs in mathlib4</li>
<li>Leaving behind an easily viewable snapshot of working lean3 PRs, that don't end up being wrecked by a half-baked attempt at a lean4 port before users abandon them again</li>
</ul>



<a name="265820927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265820927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265820927">(Dec 22 2021 at 16:02)</a>:</h4>
<p>In principle we can decide what to do about where to keep old mathlib3 PRs later, we can always swap around the git repos under the hood if we change our mind (as long as we have no mathlib4 PRs yet)<br>
!</p>



<a name="265820996"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265820996" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265820996">(Dec 22 2021 at 16:02)</a>:</h4>
<p>Maybe the best argument for <em>keeping</em> the same PRs (as you suggest, <span class="user-mention" data-user-id="325367">@Mauricio Collares</span>) is that PR references in commit messages will continue to point to the right thing.</p>



<a name="265821031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265821031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265821031">(Dec 22 2021 at 16:03)</a>:</h4>
<p>That is, preserving the closed PRs is more important than the open ones</p>



<a name="265822252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265822252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265822252">(Dec 22 2021 at 16:13)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/mathport.20and.20git.20history/near/265820750">said</a>:</p>
<blockquote>
<p>Keeping it separate has the advantages of:</p>
<ul>
<li>A clean slate for Prs in mathlib4</li>
<li>Leaving behind an easily viewable snapshot of working lean3 PRs, that don't end up being wrecked by a half-baked attempt at a lean4 port before users abandon them again</li>
</ul>
</blockquote>
<p>For the second point, there would still be a snapshot of branches  in a read-only, archived /mathlib3 repository, so people could go to the mathlib PR, copy the branch name and look it up in /mathlib3 in case of wreckage. It's a bit more work but it sounds like an exceptional case.</p>
<p>I don't know enough about mathlib to opine on the first point (and maybe the right choice will depend on the usability of synport on flag day), but in general "clean slate" doesn't sound like a good thing when it comes to version control. If that is desired, though, it can be "emulated" by closing all PRs on flag day.</p>



<a name="265850766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265850766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265850766">(Dec 22 2021 at 20:45)</a>:</h4>
<p>Note that there are separate repos for <a href="https://github.com/leanprover/lean2/">https://github.com/leanprover/lean2/</a>, <a href="https://github.com/leanprover/lean/">https://github.com/leanprover/lean/</a> and <a href="https://github.com/leanprover/lean4/">https://github.com/leanprover/lean4/</a>, so I think I know the strategy that Leo prefers: a clean break in a new repository. Similarly mathlib is in a separate repository from the lean 2 library (well, they were not separated into core + mathlib at the time so this is no surprise). So I would suggest keeping the new mathlib4 repository separate forever, although we might change the repo names around at some point.</p>



<a name="265850944"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265850944" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265850944">(Dec 22 2021 at 20:47)</a>:</h4>
<p>If you want to do git archaeology, it's really not that bad to switch over to the other repo if you hit the bottom and want to keep digging</p>



<a name="265851277"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851277" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851277">(Dec 22 2021 at 20:51)</a>:</h4>
<p>If we did concatenate the histories in some way, I don't think the git diff would be useful at all. Early mathlib4 history will show entire files being ported from somewhere, and then the initial commit will show deletion of a bunch of stuff that is not restored until way later. Much simpler just to acknowledge that they have completely separate edits. If every mathlib change had a corresponding mathlib4 change it might be a different story, but the port isn't going to work like that except possibly in the very late stage</p>



<a name="265851283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851283">(Dec 22 2021 at 20:51)</a>:</h4>
<p>What are the benefits of keeping the git history? Is the main one <code>git blame</code>?</p>



<a name="265851511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851511">(Dec 22 2021 at 20:53)</a>:</h4>
<p>And the ability to merge old mathlib3 branches with git trying to help</p>



<a name="265851535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851535">(Dec 22 2021 at 20:53)</a>:</h4>
<p>git can't help...</p>



<a name="265851539"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851539" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851539">(Dec 22 2021 at 20:53)</a>:</h4>
<p>I'd counter with "what would be the benefit of <em>not</em> keeping the history?"</p>



<a name="265851649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851649">(Dec 22 2021 at 20:55)</a>:</h4>
<p>It amounts to providing the fiction that mathlib4 was somehow produced by editing mathlib, which is not the case and would be very hard to present well</p>



<a name="265851711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851711">(Dec 22 2021 at 20:55)</a>:</h4>
<p>But that's not fiction, is it? The "editing" is performed by synport</p>



<a name="265851808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851808">(Dec 22 2021 at 20:56)</a>:</h4>
<p>The process that produces files that appear in mathlib4 is complex, involving automatic translation of a mathlib file plus a bunch of human touchup. There is no way git will have a good time trying to understand this relationship</p>



<a name="265851915"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265851915" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265851915">(Dec 22 2021 at 20:58)</a>:</h4>
<p>Knowing "who did this" might be helpful, but one can just ask here on Zulip.<br>
Another advantage of git history is keeping growth data. But it's a bit strange to mix mathlib3 and 4 contribution data</p>



<a name="265852041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265852041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265852041">(Dec 22 2021 at 20:58)</a>:</h4>
<p>Plus, there will be a long period of co-evolution (which we are currently in), where mathlib3 still receives commits while mathlib4 is doing its own thing. Appending histories implies that there is a "last" commit of mathlib3, and I don't think we ever need to make a hard break on this</p>



<a name="265852107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265852107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265852107">(Dec 22 2021 at 20:59)</a>:</h4>
<p>It's not like we're going to delete the mathlib3 repo, so calling it "not keeping the history" is disingenuous</p>



<a name="265852216"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265852216" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265852216">(Dec 22 2021 at 21:00)</a>:</h4>
<p>I'm not even sure we need to archive it</p>



<a name="265852296"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265852296" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265852296">(Dec 22 2021 at 21:00)</a>:</h4>
<p>You can still contribute to lean 2 if you want</p>



<a name="265852523"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265852523" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265852523">(Dec 22 2021 at 21:02)</a>:</h4>
<p>It's a very personal thing but maybe others resonate: I like enclosing cycles and doing things in a way that help me build the feeling of starting fresh and wiser <span aria-label="smiley" class="emoji emoji-1f603" role="img" title="smiley">:smiley:</span></p>



<a name="265852530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265852530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265852530">(Dec 22 2021 at 21:02)</a>:</h4>
<p>If I were plotting growth data, I would put mathlib3 and mathlib4 on different lines / colors and let readers connect the dots themselves</p>



<a name="265853274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265853274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265853274">(Dec 22 2021 at 21:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/mathport.20and.20git.20history/near/265850766">said</a>:</p>
<blockquote>
<p>Note that there are separate repos for <a href="https://github.com/leanprover/lean2/">https://github.com/leanprover/lean2/</a>, <a href="https://github.com/leanprover/lean/">https://github.com/leanprover/lean/</a> and <a href="https://github.com/leanprover/lean4/">https://github.com/leanprover/lean4/</a>, so I think I know the strategy that Leo prefers: a clean break in a new repository. Similarly mathlib is in a separate repository from the lean 2 library (well, they were not separated into core + mathlib at the time so this is no surprise). So I would suggest keeping the new mathlib4 repository separate forever, although we might change the repo names around at some point.</p>
</blockquote>
<p>The lean4 repo started as a copy of the lean repo (history starts in 2013 and the least common ancestor is <code>d36b859c6579ce1b86f257a494bb99417c7cdac1</code>, from 2018). But, as you said, this may be an apples to oranges comparison.</p>



<a name="265857160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265857160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265857160">(Dec 22 2021 at 21:49)</a>:</h4>
<p>Also, mathlib derives from an earlier repository via manual porting, which will probably look similar to the mathlib4 port. The repo can now be found at <a href="https://github.com/avigad/library_dev">https://github.com/avigad/library_dev</a></p>



<a name="265857279"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265857279" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265857279">(Dec 22 2021 at 21:50)</a>:</h4>
<p>It does not have any common commits with mathlib, but many files are copied from it in the first few commits</p>



<a name="265908893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265908893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mac <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265908893">(Dec 23 2021 at 11:39)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span> is the intention to add synported files to the current mathlib4 repository or to start a new fresh respository with the whole synported merged with state of mathlib4 at that time? If it is the former, keeping them separate is almost a necessity as mathlib4 already has its own PRs and issues that one would probably not want to smash.</p>



<a name="265910462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/265910462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#265910462">(Dec 23 2021 at 12:04)</a>:</h4>
<p>Right now, it's the former. We might revisit this question when we are ready to start the large scale port, but there are files that need to be ported before that because they are used in tactics, and those are all going into mathlib4 as is. I expect somewhere around 5-10% of mathlib to be "pre-ported" in this way before we can do the rest of it.</p>



<a name="275406549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/275406549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#275406549">(Mar 15 2022 at 17:24)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/mathport.20and.20git.20history/near/265851808">said</a>:</p>
<blockquote>
<p>The process that produces files that appear in mathlib4 is complex, involving automatic translation of a mathlib file plus a bunch of human touchup. There is no way git will have a good time trying to understand this relationship</p>
</blockquote>
<p>Now that <a href="https://github.com/github/feedback/discussions/5033#discussioncomment-2318478">GitHub supports ignoring commits in the blame view</a>, I did a simplistic experiment to see how well Git would handle blame data if we simply replaced every file by its mathported version. It's at my mathlib fork (for example, look at <a href="https://github.com/collares/mathlib/blame/master/src/LinearAlgebra/Basic.lean">https://github.com/collares/mathlib/blame/master/src/LinearAlgebra/Basic.lean</a>, <a href="https://github.com/collares/mathlib/blame/master/src/GroupTheory/Sylow.lean">https://github.com/collares/mathlib/blame/master/src/GroupTheory/Sylow.lean</a> or <a href="https://github.com/collares/mathlib/blame/master/src/Algebra/Group/Freiman.lean">https://github.com/collares/mathlib/blame/master/src/Algebra/Group/Freiman.lean</a>).</p>



<a name="275408165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/275408165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#275408165">(Mar 15 2022 at 17:37)</a>:</h4>
<p>Wow, that third file is really well written!</p>



<a name="275414894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/275414894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#275414894">(Mar 15 2022 at 18:19)</a>:</h4>
<p>I suspect we want to do that, but also merge in the Mathlib4 history at the same time, so that we don't lose the non-mathportable tactic history there. Either way, thanks for the experiment!</p>



<a name="275415130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/275415130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mauricio Collares <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#275415130">(Mar 15 2022 at 18:21)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/mathport.20and.20git.20history/near/275414894">said</a>:</p>
<blockquote>
<p>I suspect we want to do that, but also merge in the Mathlib4 history at the same time, so that we don't lose the non-mathportable tactic history there. Either way, thanks for the experiment!</p>
</blockquote>
<p>Right! That seems doable with <code>git subtree split</code>.</p>



<a name="275417470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/mathport%20and%20git%20history/near/275417470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/mathport.20and.20git.20history.html#275417470">(Mar 15 2022 at 18:36)</a>:</h4>
<p><code>git merge --allow-unrelated-histories</code> ought to be enough</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>