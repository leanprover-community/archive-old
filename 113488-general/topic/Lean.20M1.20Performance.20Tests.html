---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html">Lean M1 Performance Tests</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="264584827"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264584827" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264584827">(Dec 11 2021 at 21:08)</a>:</h4>
<p>I just installed lean on my Mom's new 2021 Macbook Pro with Apple M1 Pro chip. For us Mac users thinking of a hardware upgrade, I intend to run some lean code on both this and my own 2017 Macbook Pro with 2.9 GHz Quad-Core Intel Core i7 to see the performance difference.</p>



<a name="264584841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264584841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264584841">(Dec 11 2021 at 21:08)</a>:</h4>
<p>Building the tutorials project with <code>leanproject clean ; time lean --make src/</code> a few times each, I get on the M1:<br>
<code>lean --make src/  107.44s user 1.18s system 564% cpu 19.250 total</code><br>
<code>lean --make src/  108.29s user 1.21s system 559% cpu 19.572 total</code><br>
<code>lean --make src/  107.44s user 1.34s system 549% cpu 19.795 total</code><br>
And on the Intel<br>
<code>lean --make src/  143.49s user 3.61s system 497% cpu 29.572 total</code><br>
<code>lean --make src/  164.34s user 4.24s system 527% cpu 31.966 total</code><br>
<code>lean --make src/  167.17s user 4.24s system 520% cpu 32.922 total</code></p>



<a name="264584865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264584865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264584865">(Dec 11 2021 at 21:09)</a>:</h4>
<p>I'll try building some bigger projects later when I have more time.</p>



<a name="264584988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264584988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264584988">(Dec 11 2021 at 21:11)</a>:</h4>
<p>is this the m1 or m1 pro?</p>



<a name="264585015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264585015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264585015">(Dec 11 2021 at 21:12)</a>:</h4>
<p>"Apple M1 Pro" is what the About This Mac infobox said.</p>



<a name="264586304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264586304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264586304">(Dec 11 2021 at 21:38)</a>:</h4>
<p>Is your mom on the Zulip? Does she need some good first projects?</p>



<a name="264586431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264586431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264586431">(Dec 11 2021 at 21:41)</a>:</h4>
<p>More seriously I guess you could pull a project like the liquid tensor experiment and compile that, that takes about 20 minutes to compile on a good machine IIRC (get a mathlib cache first)</p>



<a name="264586511"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264586511" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264586511">(Dec 11 2021 at 21:42)</a>:</h4>
<p>Maybe the tutorials project doesn't have enough files to force all your cores to work at the same time?</p>



<a name="264591355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264591355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264591355">(Dec 11 2021 at 23:24)</a>:</h4>
<p>For me, M1 Max 16-inch with <code>lean</code> built from source targeting darwin-aarch64 (version 3.35.1, commit 4887d8a30621, Release ), <code>leanproject clean</code> then <code>leanproject get-mathlib-cache</code> then <code>lean --make src</code> in lean-liquid 890de421fb successfully maxes out the CPU and is making the machine noticeably warmer, which is unusual; will report timings when I wake up tomorrow unless it's <em>really</em> fast</p>



<a name="264591801"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264591801" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Stevens <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264591801">(Dec 11 2021 at 23:36)</a>:</h4>
<p>A big chunk in the middle of compilation where CPU usage dropped down as low as 50% - there's definitely some bottlenecks here. Final output (on battery power, which I guess might make a difference):<br>
<code>~/.elan/toolchains/stable/bin/lean --make src  7786.48s user 31.84s system 733% cpu 17:46.21 total</code></p>



<a name="264594301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264594301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264594301">(Dec 12 2021 at 00:39)</a>:</h4>
<p>I get a similar<br>
<code>lean --make src/  6135.28s user 18.85s system 632% cpu 16:12.31 total</code><br>
For lean-liquid on M1, with<br>
<code>lean --make src  10643.33s user 159.04s system 604% cpu 29:47.20 total</code><br>
For intel.</p>



<a name="264594433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%20M1%20Performance%20Tests/near/264594433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean.20M1.20Performance.20Tests.html#264594433">(Dec 12 2021 at 00:42)</a>:</h4>
<p>These macbooks don't seem to care about being on battery power, they're impressive...</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>