---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/calc.20for.20linear.20equivs.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html">calc for linear equivs</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="240337990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240337990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240337990">(May 26 2021 at 14:59)</a>:</h4>
<p>Should I be able to use <code>calc</code> to construct  a <code>linear_equiv</code>?</p>



<a name="240338118"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240338118" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240338118">(May 26 2021 at 14:59)</a>:</h4>
<p>For example, should <code>calc_linear_equiv</code> work in the following:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.linear_map</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="n">M</span> <span class="n">N</span> <span class="n">P</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">N</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">N</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">P</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">R</span> <span class="n">P</span><span class="o">]</span>

<span class="sd">/-- Works. -/</span>
<span class="kd">def</span> <span class="n">calc_equiv</span> <span class="o">(</span><span class="n">e₁</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">≃</span> <span class="n">N</span><span class="o">)</span> <span class="o">(</span><span class="n">e₂</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">≃</span> <span class="n">P</span><span class="o">)</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">≃</span> <span class="n">P</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="n">M</span> <span class="bp">≃</span> <span class="n">N</span> <span class="o">:</span> <span class="n">e₁</span>
   <span class="bp">...</span> <span class="bp">≃</span> <span class="n">P</span> <span class="o">:</span> <span class="n">e₂</span>

<span class="c">/-</span><span class="cm"> Fails with error:</span>
<span class="cm">type mismatch at application</span>
<span class="cm">  linear_equiv.trans</span>
<span class="cm">term</span>
<span class="cm">  M</span>
<span class="cm">has type</span>
<span class="cm">  Type u_2 : Type (u_2+1)</span>
<span class="cm">but is expected to have type</span>
<span class="cm">  module ?m_1 ?m_2 : Type (max ? ?)</span>
<span class="cm">-/</span>
<span class="kd">def</span> <span class="n">calc_linear_equiv</span> <span class="o">(</span><span class="n">e₁</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">≃ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">N</span><span class="o">)</span> <span class="o">(</span><span class="n">e₂</span> <span class="o">:</span> <span class="n">N</span> <span class="bp">≃ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">P</span><span class="o">)</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">≃ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">P</span> <span class="o">:=</span>
<span class="k">calc</span> <span class="n">M</span> <span class="bp">≃ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">N</span> <span class="o">:</span> <span class="n">e₁</span>
   <span class="bp">...</span> <span class="bp">≃ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="n">P</span> <span class="o">:</span> <span class="n">e₂</span>
</code></pre></div>



<a name="240338518"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240338518" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240338518">(May 26 2021 at 15:01)</a>:</h4>
<p><code>@[trans]</code> only works on types with two arguments, I think. <a href="https://leanprover-community.github.io/mathlib_docs/find/equiv">docs#equiv</a> is therefore fine, but <a href="https://leanprover-community.github.io/mathlib_docs/find/linear_equiv">docs#linear_equiv</a> has way too many. I imagine even <code>mul_equiv</code> is not an option here. Maybe comparing <a href="https://leanprover-community.github.io/mathlib_docs/find/equiv.trans">docs#equiv.trans</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/linear_equiv.trans">docs#linear_equiv.trans</a> can help.</p>



<a name="240338653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240338653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240338653">(May 26 2021 at 15:02)</a>:</h4>
<p>I see!</p>



<a name="240338789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240338789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240338789">(May 26 2021 at 15:03)</a>:</h4>
<p>Does <code>@[trans]</code> do anything else or are many such decorators basically pointless then?</p>



<a name="240338874"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240338874" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240338874">(May 26 2021 at 15:03)</a>:</h4>
<p>(Also, if anyone has a reference for this "two arguments" rule, I'd be grateful to receive it.)</p>



<a name="240339147"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240339147" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240339147">(May 26 2021 at 15:05)</a>:</h4>
<p>My hunch is it's pointless...</p>



<a name="240339254"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240339254" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240339254">(May 26 2021 at 15:05)</a>:</h4>
<p>The attribute also works for <a href="https://leanprover-community.github.io/mathlib_docs/tactics.html#transitivity">tactic#transitivity</a> I think</p>



<a name="240339268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240339268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240339268">(May 26 2021 at 15:05)</a>:</h4>
<p>But I expect it to fail in the same way</p>



<a name="240339494"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240339494" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240339494">(May 26 2021 at 15:07)</a>:</h4>
<p>Right, thanks.</p>



<a name="240339582"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240339582" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240339582">(May 26 2021 at 15:07)</a>:</h4>
<p>Here's a possible fix - replace the weird <code>{module}</code> binders with <code>[module]</code> in <code>linear_equiv.trans</code></p>



<a name="240340008"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240340008" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240340008">(May 26 2021 at 15:10)</a>:</h4>
<p>The supposition being that implicit, but not typeclass, arguments contribute to the magical "two arguments" count?</p>



<a name="240343919"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240343919" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240343919">(May 26 2021 at 15:32)</a>:</h4>
<p>Well, or that my previous rationale was nonsense.</p>



<a name="240352288"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/calc%20for%20linear%20equivs/near/240352288" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/calc.20for.20linear.20equivs.html#240352288">(May 26 2021 at 16:29)</a>:</h4>
<p>Very unlikely! I'm going to leave this alone though, I don't want this badly enough.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>