---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/semilattice_sup.20to.20directed_order.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html">semilattice_sup to directed_order</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="253237627"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253237627" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253237627">(Sep 14 2021 at 11:59)</a>:</h4>
<p>Is there any reason we don't have this instance?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">semilattice_sup.to_directed_order</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">h</span> <span class="o">:</span> <span class="n">semilattice_sup</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
  <span class="n">directed_order</span> <span class="n">α</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">directed</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">a</span> <span class="n">b</span><span class="o">,</span>  <span class="o">⟨</span><span class="n">a</span> <span class="bp">⊔</span> <span class="n">b</span><span class="o">,</span> <span class="n">le_sup_left</span><span class="o">,</span> <span class="n">le_sup_right</span><span class="o">⟩,</span>
  <span class="bp">..</span><span class="n">h</span> <span class="o">}</span>
</code></pre></div>



<a name="253238180"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253238180" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253238180">(Sep 14 2021 at 12:03)</a>:</h4>
<p>Supposedly it's strictly more general than <code>linear_order.to_directed_order</code>. Maybe that causes defeqness problems with <code>lattice_of_linear_order</code>?</p>



<a name="253239069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253239069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253239069">(Sep 14 2021 at 12:09)</a>:</h4>
<p>I don't know the answer to your question, but you can check if there are defeqness problems just by testing if <code>rfl</code> proves that the two instances you are talking about are equal.</p>



<a name="253239550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253239550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253239550">(Sep 14 2021 at 12:13)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">h</span> <span class="o">:</span> <span class="n">linear_order</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
 <span class="bp">@</span><span class="n">semilattice_sup.to_directed_order</span> <span class="n">α</span> <span class="o">(</span><span class="bp">@</span><span class="n">lattice.to_semilattice_sup</span> <span class="n">α</span> <span class="o">(</span><span class="bp">@</span><span class="n">lattice_of_linear_order</span> <span class="n">α</span> <span class="n">h</span><span class="o">))</span>
 <span class="bp">=</span> <span class="bp">@</span><span class="n">linear_order.to_directed_order</span> <span class="n">α</span> <span class="n">h</span> <span class="o">:=</span>
<span class="n">rfl</span>
</code></pre></div>
<p><span aria-label="tada" class="emoji emoji-1f389" role="img" title="tada">:tada:</span></p>



<a name="253249023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253249023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253249023">(Sep 14 2021 at 13:22)</a>:</h4>
<p>It has been tried see <a href="https://github.com/leanprover-community/mathlib/issues/7980">#7980</a> <br>
Maybe the semilattice sup case only wouldn't cause such problems.. feel free to try it!</p>



<a name="253249798"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253249798" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253249798">(Sep 14 2021 at 13:27)</a>:</h4>
<p>Oooh, nice.</p>



<a name="253249842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253249842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253249842">(Sep 14 2021 at 13:27)</a>:</h4>
<p>I opened <a href="https://github.com/leanprover-community/mathlib/issues/9200">#9200</a>. Let's see what happens.</p>



<a name="253860725"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253860725" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253860725">(Sep 18 2021 at 11:12)</a>:</h4>
<p>So I think that creates a problematic diamond?</p>



<a name="253860949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253860949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253860949">(Sep 18 2021 at 11:16)</a>:</h4>
<p>The current build fails because I have a <code>lower_adjoint</code> lemma that takes in <code>preorder</code>s of the form <code>partial_order.to_preorder</code>, but the <code>lower_adjoint coe</code> I'm trying to apply it to has <code>preorders</code> of the form <code>directed_order.to_preorder</code>. Is that possibly the problem?</p>



<a name="253861049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253861049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253861049">(Sep 18 2021 at 11:18)</a>:</h4>
<p>It's quite unclear to me whether having derived instances (eg <code>partial_order.to_preorder</code>) appearing in definitions is bad. Will a derived instance only match the same derived instance? I'd assume it happens all the time, so probably that's fine?</p>



<a name="253861187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253861187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253861187">(Sep 18 2021 at 11:20)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113488-general/topic/semilattice_sup.20to.20directed_order/near/253860725">said</a>:</p>
<blockquote>
<p>So I think that creates a problematic diamond?</p>
</blockquote>
<p>The diamond in question is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">h</span> <span class="o">:</span> <span class="n">semilattice_sup</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span>
  <span class="bp">@</span><span class="n">partial_order.to_preorder</span> <span class="n">α</span> <span class="o">(</span><span class="bp">@</span><span class="n">semilattice_sup.to_partial_order</span> <span class="n">α</span> <span class="n">h</span><span class="o">)</span> <span class="bp">=</span>
  <span class="bp">@</span><span class="n">directed_order.to_preorder</span> <span class="n">α</span> <span class="o">(</span><span class="bp">@</span><span class="n">semilattice_sup.to_directed_order</span> <span class="n">α</span> <span class="n">h</span><span class="o">)</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="253861198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253861198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253861198">(Sep 18 2021 at 11:20)</a>:</h4>
<p>But it <em>is</em> defeq <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="253861892"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253861892" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253861892">(Sep 18 2021 at 11:33)</a>:</h4>
<p>Ahah! <span class="user-mention" data-user-id="302826">@Aaron Anderson</span>, you used the wrong <code>lower_adjoint</code> lemma. I don't know how it still worked though. Probably some defeq abuse.<br>
You did</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">closure_le</span> <span class="o">:</span> <span class="n">closure</span> <span class="n">L</span> <span class="n">s</span> <span class="bp">≤</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">s</span> <span class="bp">⊆</span> <span class="n">S</span> <span class="o">:=</span> <span class="o">(</span><span class="n">closure</span> <span class="n">L</span><span class="o">)</span><span class="bp">.</span><span class="n">closure_le_closed_iff_le</span> <span class="n">s</span> <span class="n">S.closed</span>
</code></pre></div>
<p>but the goal type is <code>⇑(closure L) s ≤ S ↔ s ⊆ ↑S</code> while <code>lower_adjoint.closure_le_closed_iff_le s S.closed</code> has type <code>↑(⇑(closure L) s) ≤ ↑S ↔ s ≤ ↑S</code>. The correct thing here was</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">closure_le</span> <span class="o">:</span> <span class="n">closure</span> <span class="n">L</span> <span class="n">s</span> <span class="bp">≤</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">s</span> <span class="bp">⊆</span> <span class="n">S</span> <span class="o">:=</span> <span class="o">(</span><span class="n">closure</span> <span class="n">L</span><span class="o">)</span><span class="bp">.</span><span class="n">le_iff_subset</span> <span class="n">s</span> <span class="n">S</span>
</code></pre></div>



<a name="253877177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/semilattice_sup%20to%20directed_order/near/253877177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/semilattice_sup.20to.20directed_order.html#253877177">(Sep 18 2021 at 15:58)</a>:</h4>
<p>Everything that fails here is because <code>directed_order.to_preorder</code> doesn't match with <code>partial_order.to_preorder</code> (even though they are defeq) when applying lemmas. Adding <code>semilattice_sup.to_directed_order</code> doesn't cause the problem. It just makes one path more direct.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>