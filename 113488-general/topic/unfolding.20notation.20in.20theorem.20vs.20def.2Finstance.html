---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html">unfolding notation in theorem vs def/instance</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="127341302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127341302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127341302">(May 31 2018 at 02:35)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">instance</span> <span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring_i</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">semigroup</span> <span class="err">$</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">semigroup</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">⊢ ∀ (a b c : Π (i : I), f i),</span>
<span class="cm">    (λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i))</span>
<span class="cm">        ((λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) a b)</span>
<span class="cm">        c =</span>
<span class="cm">      (λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) a</span>
<span class="cm">        ((λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) b c)</span>
<span class="cm">-/</span>

<span class="kn">theorem</span> <span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring_t</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">semigroup</span> <span class="err">$</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">semigroup</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">⊢ ∀ (a b c : Π (i : I), f i), a * b * c = a * (b * c)</span>
<span class="cm">-/</span>
</pre></div>



<a name="127341307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127341307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127341307">(May 31 2018 at 02:35)</a>:</h4>
<p>The extra unfolding in <code>def</code> and <code>instance</code> is making things harder (I did not include example of <code>def</code>)</p>



<a name="127341309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127341309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127341309">(May 31 2018 at 02:35)</a>:</h4>
<p>i.e. the <code>*</code> becoming <code>semigroup.mul</code></p>



<a name="127341354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127341354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127341354">(May 31 2018 at 02:37)</a>:</h4>
<p>how can I avoid this? is this a bug?</p>



<a name="127341357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127341357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127341357">(May 31 2018 at 02:37)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>



<a name="127341402"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127341402" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127341402">(May 31 2018 at 02:39)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span></p>



<a name="127341404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127341404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127341404">(May 31 2018 at 02:39)</a>:</h4>
<p>thanks</p>



<a name="127341411"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127341411" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127341411">(May 31 2018 at 02:39)</a>:</h4>
<p>temporary workaround: change it to <code>theorem</code> where it doesn't unfold, copy the goal, use <code>change</code>/<code>show</code>, and then switch back to <code>def</code></p>



<a name="127348395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127348395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127348395">(May 31 2018 at 06:49)</a>:</h4>
<p>I'm not sure what is happening just by looking at it... but I'll leave for a short trip until Sunday soon</p>



<a name="127348933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/127348933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#127348933">(May 31 2018 at 07:04)</a>:</h4>
<p>I see that all the time. It's indeed a bit annoying</p>



<a name="128009463"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128009463" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128009463">(Jun 13 2018 at 13:52)</a>:</h4>
<p><span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span></p>



<a name="128094754"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128094754" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128094754">(Jun 15 2018 at 00:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110049">@Mario Carneiro</span></p>



<a name="128110837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128110837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128110837">(Jun 15 2018 at 09:11)</a>:</h4>
<p>I'd have to go back to a debug build of Lean 3 to diagnose this, but it won't be fixed for Lean 3 anyway...</p>



<a name="128111464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128111464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128111464">(Jun 15 2018 at 09:30)</a>:</h4>
<p>So just to be clear -- there is no point noting this down as an issue anywhere on github, because we all know it won't be fixed in Lean 3, and because Lean 4 is a complete rewrite it's very unlikely that the issue will remain in Lean 4? Or could it be the case that when Lean 4 comes, exactly the same issue will be there because chunks of code were basically copied from Lean 3, and then this issue should be marked as something which should be fixed in the future. What I'm trying to establish is whether this trickle of minor Lean 3 points which will not be fixed in Lean 3 should be recorded somewhere anyway, just to check Lean 4 does not suffer from the same problems. If the chances of Lean 4 suffering from the same problem is 0% then in this case there is no point recording anything formally.</p>



<a name="128113301"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128113301" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128113301">(Jun 15 2018 at 10:27)</a>:</h4>
<p>It's hard to say in general. There seems to be some bug somewhere in the elaborator here, which may very well survive into Lean 4 if we don't fix it specifically. _However_, Kenny's example will likely work because Lean 4 will elaborate the type and body of a <code>def/instance</code> separately if the former is given explicitly - so just like for <code>theorem</code>.</p>



<a name="128167974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128167974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128167974">(Jun 16 2018 at 12:48)</a>:</h4>
<p>holy mother I found a workaround</p>



<a name="128167975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128167975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128167975">(Jun 16 2018 at 12:48)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">instance</span> <span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring_i</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">semigroup</span> <span class="err">$</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">semigroup</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">⊢ ∀ (a b c : Π (i : I), f i),</span>
<span class="cm">    (λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i))</span>
<span class="cm">        ((λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) a b)</span>
<span class="cm">        c =</span>
<span class="cm">      (λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) a</span>
<span class="cm">        ((λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) b c)</span>
<span class="cm">-/</span>

<span class="kn">instance</span> <span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring_i_uv</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">semigroup</span> <span class="err">$</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">semigroup</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">⊢ ∀ (a b c : Π (i : I), f i), a * b * c = a * (b * c)</span>
<span class="cm">-/</span>

<span class="kn">theorem</span> <span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring_t</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">semigroup</span> <span class="err">$</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">semigroup</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">⊢ ∀ (a b c : Π (i : I), f i), a * b * c = a * (b * c)</span>
<span class="cm">-/</span>
</pre></div>



<a name="128167978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128167978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128167978">(Jun 16 2018 at 12:48)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> <span class="user-mention" data-user-id="110024">@Sebastian Ullrich</span> <span class="user-mention" data-user-id="110049">@Mario Carneiro</span> it can be avoided by using universes instead of <code>Type*</code></p>



<a name="128168239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128168239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128168239">(Jun 16 2018 at 12:59)</a>:</h4>
<p>Wow, nice find. Then I can probably explain it - there is some tricky code in the structure notation elaborator that needs to unfold terms that contain metavariables - apparently it also does that for universe mvars, which it probably shouldn't do. As I said above, when you use <code>theorem</code>, the body is elaborated separately from the type, so the mvars have already been solved.</p>



<a name="128169386"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128169386" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128169386">(Jun 16 2018 at 13:45)</a>:</h4>
<p>well, that was unexpected</p>



<a name="128169426"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128169426" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128169426">(Jun 16 2018 at 13:46)</a>:</h4>
<p>finally something unexpected :P</p>



<a name="128171397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128171397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128171397">(Jun 16 2018 at 15:00)</a>:</h4>
<p>I'm going to check if this will also simplify my code, and if it removes some of the issues that I've been have lately.</p>



<a name="128171404"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128171404" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128171404">(Jun 16 2018 at 15:01)</a>:</h4>
<p>But it will have to wait till Monday before I get back to Lean.</p>



<a name="128178398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/128178398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#128178398">(Jun 16 2018 at 19:32)</a>:</h4>
<p>I write all my code just using Type. I believe in ZFC!</p>



<a name="196715538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/196715538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#196715538">(May 07 2020 at 00:39)</a>:</h4>
<p>Can we solve this 2-year-old problem now by changing the C++ code?</p>



<a name="196715616"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/196715616" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#196715616">(May 07 2020 at 00:40)</a>:</h4>
<p>recap:</p>
<div class="codehilite"><pre><span></span><code><span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">instance</span> <span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring_i</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">semigroup</span> <span class="err">$</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">semigroup</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">I : Type ?,</span>
<span class="cm">f : I → Type ?,</span>
<span class="cm">_inst_1 : Π (i : I), semigroup (f i)</span>
<span class="cm">⊢ ∀ (a b c : Π (i : I), f i),</span>
<span class="cm">    (λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i))</span>
<span class="cm">        ((λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) a b)</span>
<span class="cm">        c =</span>
<span class="cm">      (λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) a</span>
<span class="cm">        ((λ (x y : Π (i : I), f i) (i : I), semigroup.mul (x i) (y i)) b c)</span>
<span class="cm">-/</span>

<span class="kn">instance</span> <span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring_i_uv</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">semigroup</span> <span class="err">$</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">semigroup</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">I : Type u,</span>
<span class="cm">f : I → Type v,</span>
<span class="cm">_inst_1 : Π (i : I), semigroup (f i)</span>
<span class="cm">⊢ ∀ (a b c : Π (i : I), f i), a * b * c = a * (b * c)</span>
<span class="cm">-/</span>

<span class="kn">theorem</span> <span class="n">pi</span><span class="bp">.</span><span class="n">comm_ring_t</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">{</span><span class="n">f</span> <span class="o">:</span> <span class="n">I</span> <span class="bp">→</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="bp">∀</span> <span class="n">i</span><span class="o">,</span> <span class="n">semigroup</span> <span class="err">$</span> <span class="n">f</span> <span class="n">i</span><span class="o">]</span> <span class="o">:</span> <span class="n">semigroup</span> <span class="o">(</span><span class="bp">Π</span> <span class="n">i</span> <span class="o">:</span> <span class="n">I</span><span class="o">,</span> <span class="n">f</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span> <span class="n">x</span> <span class="n">i</span> <span class="bp">*</span> <span class="n">y</span> <span class="n">i</span><span class="o">,</span>
  <span class="n">mul_assoc</span> <span class="o">:=</span> <span class="bp">_</span><span class="o">,</span> <span class="o">}</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">I : Type u_1,</span>
<span class="cm">f : I → Type u_2,</span>
<span class="cm">_inst_1 : Π (i : I), semigroup (f i)</span>
<span class="cm">⊢ ∀ (a b c : Π (i : I), f i), a * b * c = a * (b * c)</span>
<span class="cm">-/</span>
</code></pre></div>



<a name="196715755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/196715755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#196715755">(May 07 2020 at 00:43)</a>:</h4>
<p>Open an issue in the forked Lean repo.</p>



<a name="196715961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/196715961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#196715961">(May 07 2020 at 00:46)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean/issues/214" title="https://github.com/leanprover-community/lean/issues/214">https://github.com/leanprover-community/lean/issues/214</a></p>



<a name="198864686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/unfolding%20notation%20in%20theorem%20vs%20def/instance/near/198864686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/unfolding.20notation.20in.20theorem.20vs.20def.2Finstance.html#198864686">(May 27 2020 at 08:45)</a>:</h4>
<p>push</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>