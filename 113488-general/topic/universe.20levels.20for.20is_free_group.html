---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/universe.20levels.20for.20is_free_group.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html">universe levels for is_free_group</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="276129633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276129633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276129633">(Mar 22 2022 at 00:06)</a>:</h4>
<p>I’m a bit stuck with <a href="https://leanprover-community.github.io/mathlib_docs/find/is_free_group.of_mul_equiv">docs#is_free_group.of_mul_equiv</a> restricting the two groups to the same universe. How would I go about generalizing that?<br>
Is it important that <code>is_free_group.generators</code> is a type, and not just a <code>set G</code>?<br>
Or is it important that this index type lives in the same universe as <code>G</code>? (Can we bundle universes? Probably not)</p>



<a name="276129699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276129699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276129699">(Mar 22 2022 at 00:07)</a>:</h4>
<p>Don't we have the lemma that lifts the universe?</p>



<a name="276129817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276129817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276129817">(Mar 22 2022 at 00:09)</a>:</h4>
<p>I guess that doesn't help you much here</p>



<a name="276129902"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276129902" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276129902">(Mar 22 2022 at 00:10)</a>:</h4>
<p>Maybe I’ll work around it by constructing the instance directly, instead of going via <code>≃* multiplicative ℤ</code>. Might be easier.</p>



<a name="276129937"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276129937" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276129937">(Mar 22 2022 at 00:11)</a>:</h4>
<p>Is something like <code>h ⁻¹' set.range (generators G)</code> in the right universe to use as the generators?</p>



<a name="276129956"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276129956" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276129956">(Mar 22 2022 at 00:11)</a>:</h4>
<p>Certainly that lemma should be universe polymorphic</p>



<a name="276130480"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276130480" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276130480">(Mar 22 2022 at 00:20)</a>:</h4>
<p>I tried, but <code>h</code> doesn’t apply to <code>generators G</code>, as it is its own type; the only thing I can do with the generators is use <code>of</code>. well, more tomorrow I guess …</p>



<a name="276130746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276130746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276130746">(Mar 22 2022 at 00:24)</a>:</h4>
<p>Ah sorry, I meant to say <code>set.range of</code></p>



<a name="276143307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276143307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276143307">(Mar 22 2022 at 04:45)</a>:</h4>
<p>Shouldn't <a href="https://leanprover-community.github.io/mathlib_docs/find/is_free_group.of_mul_equiv">docs#is_free_group.of_mul_equiv</a> generalize to injective homomorphisms?</p>



<a name="276143697"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276143697" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276143697">(Mar 22 2022 at 04:55)</a>:</h4>
<p>Ah, but the mathlib proof of this just talks about subgroups, and sticks to the same universe.</p>



<a name="276153501"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276153501" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276153501">(Mar 22 2022 at 08:02)</a>:</h4>
<p>There's a number of small things to prove:</p>
<ul>
<li>we need to now that <code>of : generators G -&gt; G</code> is injective (there's an abstract proof of this, as in <a href="https://leanprover-community.github.io/mathlib_docs/find/free_product.of_injective">docs#free_product.of_injective</a>)</li>
<li>from this you can deduce that if <code>G ≃* H</code> with <code>H : Type u</code> then <code>generators G</code> is <code>u</code>-small (it is equivalent to <code>set.range (h ∘ of)</code>).</li>
<li>now one should be able to prove the universe-polymorphic version of <code>of_mul_equiv</code>: <code>H</code> is freely generated by the <code>u</code>-small resizing of <code>generators G</code> (we have already the universe-polymorphic <a href="https://leanprover-community.github.io/mathlib_docs/find/is_free_group.unique_lift">docs#is_free_group.unique_lift</a>)</li>
<li>finally one can prove a universe-polymorphic <code>of_injective</code> by combining <code>of_equiv</code> with <a href="https://leanprover-community.github.io/mathlib_docs/find/subgroup_is_free_of_is_free">docs#subgroup_is_free_of_is_free</a></li>
</ul>



<a name="276154029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276154029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276154029">(Mar 22 2022 at 08:07)</a>:</h4>
<p>It might be easier to do all of this if we first introduce some predicate like <code>is_freely_generated_by</code> where <code>generators</code> is unbundled and can have a different universe level from <code>G</code>. Then you can state (and prove!) that <code>is_freely_generated_by</code> transports across equivs in <code>generators</code> across different universe levels, and that <code>generators</code> is <code>u</code>-small iff <code>G</code> is.</p>



<a name="276154655"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276154655" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276154655">(Mar 22 2022 at 08:15)</a>:</h4>
<p>I think unbundling the generators is a good idea</p>



<a name="276161623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276161623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276161623">(Mar 22 2022 at 09:31)</a>:</h4>
<p>Yay, even more ways to state that a group is freely generates (<code>is_free_group</code>, <code>free_group X</code>, and, a bit remote, <code>free_product</code>) :-)</p>



<a name="276162375"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276162375" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276162375">(Mar 22 2022 at 09:39)</a>:</h4>
<p>Or having _only_ the unbundled one? Seems very reasonable to me, and I believe what I am working on right now would be much more natural that way. Should I give it a shot?</p>



<a name="276162446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276162446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276162446">(Mar 22 2022 at 09:40)</a>:</h4>
<p>If nothing breaks when unbundling, go for it</p>



<a name="276163007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276163007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276163007">(Mar 22 2022 at 09:46)</a>:</h4>
<p>should the <code>of</code> be still bundled in <code>is_freely_generated_by</code>? Or not (in which case it becomes simply a name for the universal property)?</p>



<a name="276163165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276163165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276163165">(Mar 22 2022 at 09:48)</a>:</h4>
<p>The only reason the generators are bundled at the moment is that saying "G is freely generated by (some complicated type of generators)" is less elegant than saying "G is free" (in particular the Nielsen-Schreier file will look less pretty in the unbundled way). But it's not a very strong reason, and there are good reasons to unbundle the generators</p>



<a name="276163510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276163510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> David Wärn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276163510">(Mar 22 2022 at 09:52)</a>:</h4>
<p><span class="user-mention silent" data-user-id="470149">Joachim Breitner</span> <a href="#narrow/stream/113488-general/topic/universe.20levels.20for.20is_free_group/near/276163007">said</a>:</p>
<blockquote>
<p>should the <code>of</code> be still bundled in <code>is_freely_generated_by</code>? Or not (in which case it becomes simply a name for the universal property)?</p>
</blockquote>
<p>I would say we can still bundle <code>of</code>, in line with <a href="https://leanprover-community.github.io/mathlib_docs/find/basis">docs#basis</a>. It may also be a good idea to change the definition to match up with <code>basis</code>, i.e. to say a group is free when it is isomorphic to a <code>free_group</code> (and have a lemma saying a group is free when it has the right universal property). This would certainly alleviate universe polymorphism headache</p>



<a name="276179527"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276179527" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276179527">(Mar 22 2022 at 12:19)</a>:</h4>
<p>Ah, I think I understand now: using the universal property as or in the definition is appealing from a mathematical point of view, but the quantifier over the “other” type only quantities over types of the same universe level as the definition itself, so it's not really the full universal property, and that's why the existing API has to jump through hoops to get the more general one. If the definition is just the equivalence to “the” free group, and the universal property a separate lemma, this issue is avoided. Is that roughly correct?</p>



<a name="276184631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/276184631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#276184631">(Mar 22 2022 at 13:02)</a>:</h4>
<p>In that light I'm in favor of <code>is_freely_generated_by</code> like <code>basis</code> to replace our <code>is_free_group</code>, as suggested above. Can probably easily live in <code>free_group.lean</code> then. Maybe I'll give it a shot. Or maybe after I finish the ping pong lemma (phrased using equivalence to <code>free_group</code> to be compatible with that then)</p>



<a name="279369339"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279369339" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279369339">(Apr 19 2022 at 06:44)</a>:</h4>
<p>I experimented with</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">class</span> <span class="n">is_freely_generated_by</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">(</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:=</span>
  <span class="o">(</span> <span class="n">mul_equiv</span> <span class="o">:</span> <span class="n">free_group</span> <span class="n">X</span> <span class="bp">≃*</span> <span class="n">G</span> <span class="o">)</span>
</code></pre></div>
<p>but it has its downsides over <code>is_free_group</code>, which has the generators bundled. In particular, the ext-lemma doesn't apply automatically when equating monoid-homs from <code>G</code> (because the lemma search wouldn’t know which <code>X</code>s to use).</p>
<p>Maybe I’ll first refactor <code>is_free_group</code> to use <code>free_group X ≃* G</code> internally, instead of the universal property, to avoid the universe level issues, but otherwise keeping that API.</p>



<a name="279369529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279369529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279369529">(Apr 19 2022 at 06:46)</a>:</h4>
<p><span class="user-mention" data-user-id="470149">@Joachim Breitner</span> You could try to make <code>X</code> an <code>out_param</code>.</p>



<a name="279369556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279369556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279369556">(Apr 19 2022 at 06:46)</a>:</h4>
<p>That might solve those issues.</p>



<a name="279369589"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279369589" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279369589">(Apr 19 2022 at 06:47)</a>:</h4>
<p>And I think it is unlikely that we'll often want <code>is_freely_generated_by G X</code> for two different values of <code>X</code>.</p>



<a name="279369905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279369905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279369905">(Apr 19 2022 at 06:52)</a>:</h4>
<p>I can try. Will this just guide the lemma/instance search? Or does it actually forbid instances with different generators?</p>



<a name="279370023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279370023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279370023">(Apr 19 2022 at 06:54)</a>:</h4>
<p>It only guides.</p>



<a name="279370129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279370129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279370129">(Apr 19 2022 at 06:56)</a>:</h4>
<p>Lean never forbids multiple instances of the same class. But in the case of <code>out_param</code>s this can certainly cause Lean to be mightily confused.</p>



<a name="279370873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279370873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279370873">(Apr 19 2022 at 07:07)</a>:</h4>
<p>Hmm, it seems that regresses instance search in one case that went through without <code>out_param</code>:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">failed</span> <span class="n">to</span> <span class="n">synthesize</span> <span class="n">type</span> <span class="kd">class</span> <span class="kd">instance</span> <span class="n">for</span>
<span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span><span class="o">,</span>
<span class="n">G</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="bp">?</span><span class="o">,</span>
<span class="n">_inst_3</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">group</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">),</span>
<span class="n">X</span> <span class="o">:</span> <span class="n">ι</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="bp">?</span><span class="o">,</span>
<span class="n">hG</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">is_freely_generated_by</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="n">i</span><span class="o">),</span>
<span class="n">x</span> <span class="o">:</span> <span class="bp">Σ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">X</span> <span class="n">i</span>
<span class="bp">⊢</span> <span class="n">is_freely_generated_by</span> <span class="o">(</span><span class="n">G</span> <span class="n">x.fst</span><span class="o">)</span> <span class="bp">?</span><span class="n">m_1</span>
</code></pre></div>
<p>Note that <code>hG</code> should provide that instance here easily.</p>



<a name="279372201"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279372201" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279372201">(Apr 19 2022 at 07:23)</a>:</h4>
<p>Hmm, no idea why that fails <span aria-label="cry" class="emoji emoji-1f622" role="img" title="cry">:cry:</span></p>



<a name="279373026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279373026" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279373026">(Apr 19 2022 at 07:32)</a>:</h4>
<p>This is what <code>trace.class_instance</code> says about this instance:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">class_instances</span><span class="o">]</span>  <span class="kd">class</span><span class="bp">-</span><span class="kd">instance</span> <span class="n">resolution</span> <span class="n">trace</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_1</span> <span class="o">:</span> <span class="bp">@</span><span class="n">is_freely_generated_by</span> <span class="o">(</span><span class="n">G</span> <span class="n">x.fst</span><span class="o">)</span> <span class="o">(</span><span class="n">_inst_3</span> <span class="n">x.fst</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_0</span> <span class="o">:=</span> <span class="n">hG</span> <span class="bp">?</span><span class="n">x_2</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
</code></pre></div>
<p>I have no idea why it tries to put <code>_inst_3</code> here, which is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">_inst_3</span> <span class="o">:</span> <span class="bp">Π</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">group</span> <span class="o">(</span><span class="n">G</span> <span class="n">i</span><span class="o">),</span>
</code></pre></div>
<p>Maybe an <code>out_param</code> of type <code>Type*</code> is too unrestricted, and the solver sees <code>_inst_3</code> and thinks “oh, let’s try that for <code>X</code>”?</p>



<a name="279375760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279375760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279375760">(Apr 19 2022 at 08:02)</a>:</h4>
<p>Is this on a branch somewhere I can play with?</p>



<a name="279514718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279514718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279514718">(Apr 20 2022 at 08:49)</a>:</h4>
<p>sorry for the delay; it is now: <code>joachim/is_freely_generated_by</code>, commit <code>881f96934a</code>, failure in <code>src/group_theory/free_product.lean</code>. Note how code fails that worked before that commit.</p>



<a name="279529955"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279529955" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279529955">(Apr 20 2022 at 11:33)</a>:</h4>
<p><code>@is_freely_generated_by.of _ _ _ _ x.2</code> works fine there even though <code>is_freely_generated_by.of x.2</code> doesn't</p>



<a name="279530041"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279530041" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279530041">(Apr 20 2022 at 11:34)</a>:</h4>
<p><code>attribute [elab_simple] is_freely_generated_by.of</code> also seems to work</p>



<a name="279553317"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279553317" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279553317">(Apr 20 2022 at 14:50)</a>:</h4>
<p>Thanks, indeed! What does that tell us? I guess I can proceed with this API design and use <code>[elab_simple]</code> on <code>of</code> and see how far that gets us?</p>



<a name="279564799"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279564799" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279564799">(Apr 20 2022 at 16:06)</a>:</h4>
<p>There's probably something to lean about how <code>out_param</code>s work there, but ultimately lean is just elaborating things in a bad order</p>



<a name="279657441"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279657441" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279657441">(Apr 21 2022 at 09:46)</a>:</h4>
<p>Here's the relevant part of the trace with <code>type_context.is_def_eq_detail</code> and <code>pp.all</code> on:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">class_instances</span><span class="o">]</span>  <span class="kd">class</span><span class="bp">-</span><span class="kd">instance</span> <span class="n">resolution</span> <span class="n">trace</span>
<span class="o">[</span><span class="n">class_instances</span><span class="o">]</span> <span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="bp">?</span><span class="n">x_1</span> <span class="o">:</span> <span class="bp">@</span><span class="n">is_freely_generated_by.</span><span class="o">{</span><span class="bp">?</span><span class="n">u_0</span> <span class="mi">0</span><span class="o">}</span> <span class="o">(</span><span class="n">G</span> <span class="o">(</span><span class="bp">@</span><span class="n">sigma.fst.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.284190</span> <span class="bp">?</span><span class="n">l__fresh.172.284191</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">X</span> <span class="n">i</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span>
  <span class="o">(</span><span class="n">_inst_3</span> <span class="o">(</span><span class="bp">@</span><span class="n">sigma.fst.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.284190</span> <span class="bp">?</span><span class="n">l__fresh.172.284191</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">X</span> <span class="n">i</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span>
  <span class="bp">?</span><span class="n">x_0</span> <span class="o">:=</span> <span class="n">hG</span> <span class="bp">?</span><span class="n">x_2</span>
<span class="o">[</span><span class="n">type_context.is_def_eq_detail</span><span class="o">]</span> <span class="o">[</span><span class="mi">1</span><span class="o">]:</span> <span class="bp">@</span><span class="n">is_freely_generated_by.</span><span class="o">{</span><span class="bp">?</span><span class="n">u_0</span> <span class="mi">0</span><span class="o">}</span> <span class="o">(</span><span class="n">G</span> <span class="o">(</span><span class="bp">@</span><span class="n">sigma.fst.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.284190</span> <span class="bp">?</span><span class="n">l__fresh.172.284191</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">X</span> <span class="n">i</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span>
  <span class="o">(</span><span class="n">_inst_3</span> <span class="o">(</span><span class="bp">@</span><span class="n">sigma.fst.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.284190</span> <span class="bp">?</span><span class="n">l__fresh.172.284191</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">X</span> <span class="n">i</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span>
  <span class="bp">?</span><span class="n">x_0</span> <span class="bp">=?=</span> <span class="bp">@</span><span class="n">is_freely_generated_by.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.3587</span> <span class="bp">?</span><span class="n">l__fresh.172.3588</span><span class="o">}</span> <span class="o">(</span><span class="n">G</span> <span class="bp">?</span><span class="n">x_2</span><span class="o">)</span> <span class="o">(</span><span class="n">_inst_3</span> <span class="bp">?</span><span class="n">x_2</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="bp">?</span><span class="n">x_2</span><span class="o">)</span>
<span class="o">[</span><span class="n">type_context.is_def_eq_detail</span><span class="o">]</span> <span class="o">[</span><span class="mi">2</span><span class="o">]:</span> <span class="n">is_freely_generated_by.</span><span class="o">{</span><span class="bp">?</span><span class="n">u_0</span> <span class="mi">0</span><span class="o">}</span> <span class="bp">=?=</span> <span class="n">is_freely_generated_by.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.3587</span> <span class="bp">?</span><span class="n">l__fresh.172.3588</span><span class="o">}</span>
<span class="o">[</span><span class="n">type_context.is_def_eq_detail</span><span class="o">]</span> <span class="n">on</span> <span class="n">failure</span><span class="o">:</span> <span class="bp">@</span><span class="n">is_freely_generated_by.</span><span class="o">{</span><span class="bp">?</span><span class="n">u_0</span> <span class="mi">0</span><span class="o">}</span> <span class="o">(</span><span class="n">G</span> <span class="o">(</span><span class="bp">@</span><span class="n">sigma.fst.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.284190</span> <span class="bp">?</span><span class="n">l__fresh.172.284191</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">X</span> <span class="n">i</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span>
  <span class="o">(</span><span class="n">_inst_3</span> <span class="o">(</span><span class="bp">@</span><span class="n">sigma.fst.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.284190</span> <span class="bp">?</span><span class="n">l__fresh.172.284191</span><span class="o">}</span> <span class="n">ι</span> <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">),</span> <span class="n">X</span> <span class="n">i</span><span class="o">)</span> <span class="n">x</span><span class="o">))</span>
  <span class="bp">?</span><span class="n">x_0</span> <span class="bp">=?=</span> <span class="bp">@</span><span class="n">is_freely_generated_by.</span><span class="o">{</span><span class="bp">?</span><span class="n">l__fresh.172.3587</span> <span class="bp">?</span><span class="n">l__fresh.172.3588</span><span class="o">}</span> <span class="o">(</span><span class="n">G</span> <span class="bp">?</span><span class="n">x_2</span><span class="o">)</span> <span class="o">(</span><span class="n">_inst_3</span> <span class="bp">?</span><span class="n">x_2</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="bp">?</span><span class="n">x_2</span><span class="o">)</span>
<span class="n">failed</span> <span class="n">is_def_eq</span>
</code></pre></div>



<a name="279658195"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279658195" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279658195">(Apr 21 2022 at 09:55)</a>:</h4>
<p>As I understand it, to produce the <code>on failure:</code> message, either the universe levels in <code>is_freely_generated_by.{?u_0 0} =?= is_freely_generated_by.{?l__fresh.172.3587 ?l__fresh.172.3588}</code> could not be unified, or one of the arguments failed the <code>quick_is_def_eq</code> check.</p>



<a name="279658503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279658503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279658503">(Apr 21 2022 at 09:58)</a>:</h4>
<p>Yup, <code>set_option trace.type_context.univ_is_def_eq true</code> gives the answer:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">type_context.univ_is_def_eq</span><span class="o">]</span> <span class="mi">0</span> <span class="bp">=?=</span> <span class="bp">?</span><span class="n">_mlocal._fresh.297.3563</span> <span class="bp">...</span> <span class="n">failed</span>
</code></pre></div>



<a name="279659076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279659076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279659076">(Apr 21 2022 at 10:04)</a>:</h4>
<p>Since the non-temporary metavariable <code>?u_0</code> can be assigned, the conclusion seems to be something like: there are some temporary universe metavariables on the right hand side that Lean tries to unify in a non-temporary context, so they are unable to be assigned and unification fails.</p>



<a name="279659091"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279659091" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279659091">(Apr 21 2022 at 10:04)</a>:</h4>
<p>Why we got to this place is unclear to me, though.</p>



<a name="279853825"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279853825" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279853825">(Apr 22 2022 at 17:20)</a>:</h4>
<p>Ah I noticed I had</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">}</span> <span class="o">[</span><span class="n">is_freely_generated_by</span> <span class="n">G</span> <span class="n">X</span><span class="o">]</span>
</code></pre></div>
<p>instead of</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">{</span><span class="n">X</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">is_freely_generated_by</span> <span class="n">G</span> <span class="n">X</span><span class="o">]</span>
</code></pre></div>
<p>in scope when defining <code>of</code>. And with that fixed I don’t <code>[elab_simple]</code> it seem.</p>



<a name="279855161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279855161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279855161">(Apr 22 2022 at 17:31)</a>:</h4>
<p>Hmm, looking at how <code>is_free_group</code> is used in <code>nielson-schreier.lean</code>, in particular</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">subgroup_is_free_of_is_free</span> <span class="o">{</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span> <span class="o">[</span><span class="n">is_free_group</span> <span class="n">G</span><span class="o">]</span>  <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="n">subgroup</span> <span class="n">G</span><span class="o">)</span> <span class="o">:</span> <span class="n">is_free_group</span> <span class="n">H</span>
</code></pre></div>
<p>I doubt that an unbundled  <code>is_freely_generated_by G X</code> will look nice here, given that this theorem doesn't tell us what the generators of <code>H</code> are.<br>
I could write  <code>Σ Y. is_freely_generated_by H Y</code>.<br>
Or I could  keep <code>is_free_group</code> with bundled <code>generators</code> (but defined via an equivalence to the <code>free_group</code>, not the universal property, to avoid universe issues), in which case we have three APIs to maintain – <code>free_group X</code>, <code>is_freely_generated_by G X</code> and <code>is_free_group G</code>.<br>
WDYT?</p>



<a name="279858251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279858251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279858251">(Apr 22 2022 at 17:57)</a>:</h4>
<p>Hmm, probably the latter  - <code>is_free_group</code> is a class, and type class inference just works better without the type of generator being around explicitly.</p>



<a name="279861841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279861841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279861841">(Apr 22 2022 at 18:27)</a>:</h4>
<p>I think the sigma type is ok</p>



<a name="279861951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279861951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279861951">(Apr 22 2022 at 18:28)</a>:</h4>
<p>Or more specifically, use the sigma as an auxiliary construction, then create the instance on its first entry</p>



<a name="279862182"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279862182" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279862182">(Apr 22 2022 at 18:30)</a>:</h4>
<p>(<a href="https://leanprover-community.github.io/mathlib_docs/find/subgroup_is_free_of_is_free">docs#subgroup_is_free_of_is_free</a>)</p>



<a name="279863619"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279863619" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279863619">(Apr 22 2022 at 18:41)</a>:</h4>
<p>“create the instance on its first entry” – for that we still need a <code>is_free_group G</code> class, and can’t get rid of it, correct?</p>



<a name="279868646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279868646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279868646">(Apr 22 2022 at 19:30)</a>:</h4>
<p>I was thinking of something like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">aux</span> <span class="o">:</span> <span class="bp">Σ</span> <span class="n">I</span><span class="o">,</span> <span class="n">is_freely_generated_by</span> <span class="n">H</span> <span class="n">I</span> <span class="o">:=</span> <span class="bp">...</span>

<span class="kd">def</span> <span class="n">generators</span> <span class="o">:=</span> <span class="n">aux.1</span>

<span class="kd">instance</span> <span class="o">:</span> <span class="n">is_freely_generated_by</span> <span class="n">H</span> <span class="n">generators</span> <span class="o">:=</span> <span class="n">aux.2</span>
</code></pre></div>



<a name="279878474"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/universe%20levels%20for%20is_free_group/near/279878474" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/universe.20levels.20for.20is_free_group.html#279878474">(Apr 22 2022 at 21:07)</a>:</h4>
<p>For now, I did the change where <code>is_free_group</code> is now defined via isomorphism to the free group, but other the API is mostly left alone: &lt;<a href="https://github.com/leanprover-community/mathlib/pull/13633">https://github.com/leanprover-community/mathlib/pull/13633</a>&gt;</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>