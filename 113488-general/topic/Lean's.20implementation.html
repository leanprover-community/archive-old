---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Lean's.20implementation.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html">Lean's implementation</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="268085005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085005">(Jan 14 2022 at 22:59)</a>:</h4>
<p>also, what language was lean originally implemented in?</p>



<a name="268085010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085010">(Jan 14 2022 at 22:59)</a>:</h4>
<p>C++</p>



<a name="268085083"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085083" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085083">(Jan 14 2022 at 22:59)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/is.20lean.20here.3F/near/268085010">said</a>:</p>
<blockquote>
<p>C++</p>
</blockquote>
<p>why tho lol</p>



<a name="268085144"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085144" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085144">(Jan 14 2022 at 23:00)</a>:</h4>
<p>because leo knows C++ really well</p>



<a name="268085193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085193">(Jan 14 2022 at 23:00)</a>:</h4>
<p>i would think that it was implementedin haskell or some functional lang</p>



<a name="268085256"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085256" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085256">(Jan 14 2022 at 23:00)</a>:</h4>
<p>They certainly felt the pain, that's why they rewrote it in some functional lang</p>



<a name="268085267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085267">(Jan 14 2022 at 23:00)</a>:</h4>
<p>namely lean</p>



<a name="268085270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085270">(Jan 14 2022 at 23:00)</a>:</h4>
<p>lean lol</p>



<a name="268085319"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085319" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085319">(Jan 14 2022 at 23:01)</a>:</h4>
<p>but it's hard to get the performance characteristics you want with functional languages</p>



<a name="268085424"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085424" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085424">(Jan 14 2022 at 23:02)</a>:</h4>
<p>i thought it is said that the programming language you use to make the compiler in doesnt really affect the speed</p>



<a name="268085429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085429">(Jan 14 2022 at 23:02)</a>:</h4>
<p>lean 3 is being used in a very computationally heavy way, I can't imagine how many more CPU hours we would have burned on mathlib if the elaborator was less efficient</p>



<a name="268085439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085439">(Jan 14 2022 at 23:02)</a>:</h4>
<p>i feel like rust is going to take over c++ for lang dev imo</p>



<a name="268085469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085469">(Jan 14 2022 at 23:02)</a>:</h4>
<p>The programming language you use to make the compiler certainly affects the speed of the compiler</p>



<a name="268085471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085471">(Jan 14 2022 at 23:03)</a>:</h4>
<p>c++ doesnt even have pattern matching</p>



<a name="268085490"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085490" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085490">(Jan 14 2022 at 23:03)</a>:</h4>
<p>and in theorem proving you spend all your time in "compilation"</p>



<a name="268085696"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085696" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085696">(Jan 14 2022 at 23:05)</a>:</h4>
<p>(I split this thread in case anyone has something to add to the logo conversation which we seem to have diverted from)</p>



<a name="268085819"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085819" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085819">(Jan 14 2022 at 23:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/Lean's.20implementation/near/268085469">said</a>:</p>
<blockquote>
<p>The programming language you use to make the compiler certainly affects the speed of the compiler</p>
</blockquote>
<p>well, maybe the first implementation. for instance, rust was originally written in ocaml, but then rewritten in rust, and is now one of the fastest langs</p>



<a name="268085822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085822">(Jan 14 2022 at 23:07)</a>:</h4>
<p>explain that</p>



<a name="268085936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268085936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268085936">(Jan 14 2022 at 23:08)</a>:</h4>
<p>Well, lean hasn't been self hosting prior to lean 4</p>



<a name="268086165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086165">(Jan 14 2022 at 23:10)</a>:</h4>
<p>plus, that's only a good strategy for improving the compiler if your programming language is actually faster than the original language. Rust can definitely beat OCaml in some domains. I think it will be hard for Lean to compete with C++ on speed, but certainly there are some aspects that were being done inefficiently in C++ just because the setup is so much boilerplate work (e.g. everything was an <code>expr</code> because making inductive types in C++ is incredibly painful)</p>



<a name="268086418"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086418" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086418">(Jan 14 2022 at 23:13)</a>:</h4>
<p>im just showing</p>



<a name="268086479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086479">(Jan 14 2022 at 23:14)</a>:</h4>
<p>that the programing lang you use doesnt affect the speed of the compiler nessacerily</p>



<a name="268086544"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086544" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086544">(Jan 14 2022 at 23:14)</a>:</h4>
<p>For a self hosting compiler, the speed of the compiler depends on <em>how good it is</em>. Good compilers are a ton of work</p>



<a name="268086562"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086562" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086562">(Jan 14 2022 at 23:15)</a>:</h4>
<p>right</p>



<a name="268086568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086568">(Jan 14 2022 at 23:15)</a>:</h4>
<p>that is what matters</p>



<a name="268086578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086578">(Jan 14 2022 at 23:15)</a>:</h4>
<p>rust was a good compiler</p>



<a name="268086600"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086600" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086600">(Jan 14 2022 at 23:15)</a>:</h4>
<p>Rust eventually became a good compiler after a ton of work</p>



<a name="268086617"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086617" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086617">(Jan 14 2022 at 23:15)</a>:</h4>
<p>Every compiler is born crappy</p>



<a name="268086718"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086718" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086718">(Jan 14 2022 at 23:16)</a>:</h4>
<p>and it's really hard to compete with e.g. LLVM, which is why even rust doesn't go there</p>



<a name="268086821"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086821" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086821">(Jan 14 2022 at 23:17)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/Lean's.20implementation/near/268086617">said</a>:</p>
<blockquote>
<p>Every compiler is born crappy</p>
</blockquote>
<p>im gonna be honest, when rust first started, it was shitty like hell</p>



<a name="268086913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086913">(Jan 14 2022 at 23:18)</a>:</h4>
<p>You realize that there is 1 or 2 orders of magnitude between the rust community and the lean community, right?</p>



<a name="268086978"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086978" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086978">(Jan 14 2022 at 23:18)</a>:</h4>
<p>im not saying lean is shitty</p>



<a name="268086992"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268086992" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268086992">(Jan 14 2022 at 23:19)</a>:</h4>
<p>We're doing our best to scale up but all theorem prover langs are in the rounding error compared to regular programming languages</p>



<a name="268087171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268087171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> crab <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268087171">(Jan 14 2022 at 23:21)</a>:</h4>
<p>tbh, the rust community is really huge</p>



<a name="268087307"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268087307" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268087307">(Jan 14 2022 at 23:22)</a>:</h4>
<p>I don't think that speed is the main reason for self-hosting lean 4. It's more about the expressiveness and enabling user code to interact directly with the elaborator</p>



<a name="268087560"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268087560" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268087560">(Jan 14 2022 at 23:25)</a>:</h4>
<p>It's going to hugely speed up mathlib compilation, but that's because we're able to compile tactics now. It was too much work and too organizationally complicated to write tactics in C++, so most tactics were written in lean and interpreted. So Lean 4 is competing with (and beating the pants off) the lean 3 interpreter, not C++</p>



<a name="268087665"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268087665" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268087665">(Jan 14 2022 at 23:26)</a>:</h4>
<p>It also opens up being able to give Lean proofs that different parts of Lean written in Lean operate correctly, which is cool (at least in theory -- don't know if anyone is planning on doing this).</p>



<a name="268087834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268087834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268087834">(Jan 14 2022 at 23:29)</a>:</h4>
<p>I think there are still a number of challenges to solve before that becomes theoretically possible. Most of the elaborator is in a lifted IO monad</p>



<a name="268087873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268087873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268087873">(Jan 14 2022 at 23:29)</a>:</h4>
<p>and <code>partial</code> and <code>extern</code> make everything interesting</p>



<a name="268088112"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268088112" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268088112">(Jan 14 2022 at 23:31)</a>:</h4>
<p>but hats off to the lean team for making almost everything be non-<code>unsafe</code>, so at least it's logically consistent for those functions to exist</p>



<a name="268088172"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Lean%27s%20implementation/near/268088172" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Lean's.20implementation.html#268088172">(Jan 14 2022 at 23:32)</a>:</h4>
<p>by contrast to lean 3 where everything is <code>meta</code> (= <code>unsafe</code>)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>