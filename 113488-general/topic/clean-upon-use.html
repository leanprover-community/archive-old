---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/clean-upon-use.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/clean-upon-use.html">clean-upon-use</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="274516369"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/clean-upon-use/near/274516369" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Joachim Breitner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/clean-upon-use.html#274516369">(Mar 08 2022 at 09:41)</a>:</h4>
<p>Often when proving I am referring to some local hypothes, knowing that this is the last, or even only, use of this fact in this proof. I can make that explicit writing <code>clean foo</code> as the next tactic, and I think this is good style: it communicates that further down, this fact should not be used, makes the proof goal easier to read, and automatic tactics that look at the context might be faster.</p>
<p>But repeating the the name in a separate tactic is kinda verbose and extra work.</p>
<p>I wonder if it would be possible to have a convenient syntax to mark a use of a hypothesis as final (maybe something like <code>foo-</code> or <code>-foo</code>), causing that hypothesis to be cleared at the end of the current tactic.</p>
<p>Is it just me who would use such a device? Is that implementable? And is there some good space left in the always tight space of possible syntaxes?</p>



<a name="274516970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/clean-upon-use/near/274516970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/clean-upon-use.html#274516970">(Mar 08 2022 at 09:46)</a>:</h4>
<p><code>-h</code> is already syntax in <code>simp</code>. Namely, it explicitly disables <code>h</code> as a simp lemma (so <code>h</code> wil often be a lemma rather than a local hypothesis, but still).</p>



<a name="274517136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/clean-upon-use/near/274517136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/clean-upon-use.html#274517136">(Mar 08 2022 at 09:48)</a>:</h4>
<p>It might be a nice educational tool but I wouldn't want this to become the standard for mathlib because it's more bookkeeping and syntax to learn with virtually no benefit.</p>



<a name="274517218"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/clean-upon-use/near/274517218" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/clean-upon-use.html#274517218">(Mar 08 2022 at 09:49)</a>:</h4>
<p>Another thing to take into account is that we value tactic modularity. We don't like overloading tactics (except <code>tauto</code> and other kitchen sink tactics because that's what they do).</p>



<a name="274517240"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/clean-upon-use/near/274517240" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/clean-upon-use.html#274517240">(Mar 08 2022 at 09:49)</a>:</h4>
<p>I do tend to clear hypotheses and I typically put the <code>clear</code> tactic on the same line as the other tactic.</p>



<a name="274540484"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/clean-upon-use/near/274540484" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/clean-upon-use.html#274540484">(Mar 08 2022 at 13:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="470149">Joachim Breitner</span> <a href="#narrow/stream/113488-general/topic/clean-upon-use/near/274516369">said</a>:</p>
<blockquote>
<p>Is it just me who would use such a device?</p>
</blockquote>
<p>I've pondered basically the same feature before fwiw, especially in involved program verification proofs. Implementing it could be a bit tricky, but should be possible (in Lean 4, more realistically) by adjusting the tactic interpreter. More problematic in tactics that contain other tactics though.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>