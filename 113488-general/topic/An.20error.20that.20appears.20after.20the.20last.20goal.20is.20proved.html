---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html">An error that appears after the last goal is proved</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="262303699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262303699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262303699">(Nov 22 2021 at 10:51)</a>:</h4>
<p>I am proving the following lemma</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.adjoin.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span>

<span class="kn">open</span> <span class="n">algebra</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">b</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
  <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hb</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b₁</span> <span class="n">hb₁</span><span class="o">,</span> <span class="n">subset_adjoin</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span>
    <span class="o">((</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span> <span class="n">_</span><span class="o">)),</span>
  <span class="o">{</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">hn</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hb₁</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">←</span> <span class="n">subalgebra.coe_eq_one</span><span class="o">,</span> <span class="n">subalgebra.coe_pow</span><span class="o">],</span>
    <span class="n">convert</span> <span class="n">hn</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">convert</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">a</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">subtype.ext</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="n">only</span> <span class="o">[</span><span class="n">subalgebra.coe_algebra_map</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">convert</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">subtype.ext</span><span class="o">,</span>
    <span class="n">simpa</span> <span class="n">only</span> <span class="o">[</span><span class="n">subalgebra.coe_add</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">convert</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">apply</span> <span class="n">subtype.ext</span><span class="o">,</span>
    <span class="c1">--the goal is ↑⟨x * y, hb⟩ = ↑(⟨x, hb⟩ * ⟨y, hb⟩), that can be proved by simpa only [subalgebra.coe_mul]</span>
    <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>
<p>The infoview shows me the last goal normally, but if I prove it, I get the error</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="o">⟨</span><span class="n">_x</span><span class="o">,</span> <span class="n">hb</span><span class="o">⟩</span>
<span class="n">term</span>
  <span class="n">hb</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">b</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">B</span><span class="o">),</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="n">_x</span>
</code></pre></div>
<p>The infoview says the error is happening in line 7, that is the line with the statement (that was fine before the last goal was proved). Note that the same happens with any of the four goals produced by <code>adjoin_induction</code>: when I prove the last one I get the error. The same happens if I put <code>sorry</code> as proof of all the goals.</p>
<p>I've never seen such a behavior, so I don't really know what to do.</p>
<p>I agree that the statement of the lemma is weird, so let me add some context before people say "replace <code>b : ↥(adjoin A {b : B | ∃ (n : ℕ), b ^ n = 1})</code> in the statement with <code>(b : B) (hb : b ∈ (adjoin A {b : B | ∃ (n : ℕ), b ^ n = 1}))</code>". What I really want to prove is that if <code>B</code> is the cyclotomic extension of <code>A</code> given by roots of unity of order <code>T : set ℕ+</code> and <code>S ⊆ T</code>, then <code>adjoin A { b : B | ∃ a : ℕ+, a ∈ S ∧ b ^ (a : ℕ) = 1 }</code> is a cyclotomic extension of <code>A</code> given by roots of order <code>S</code>, so <a href="https://github.com/leanprover-community/flt-regular/blob/3001f96dcaf0aa1231cea1d151976ccdc3dbce82/src/number_theory/cyclotomic/basic.lean#L112">this</a> is the real proof that doesn't work.</p>



<a name="262304213"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262304213" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262304213">(Nov 22 2021 at 10:56)</a>:</h4>
<p>Yeah I've never seen that before. I wondered whether you had too many b's (i.e. you weren't proving what you thought you were proving, or something?) but I've changed a few and the error remains.</p>



<a name="262304431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262304431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262304431">(Nov 22 2021 at 10:58)</a>:</h4>
<p>Maybe you've found a bug in a tactic?</p>



<a name="262304626"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262304626" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262304626">(Nov 22 2021 at 11:00)</a>:</h4>
<p>This is typically the result of a buggy tactic.  See for example <a href="https://github.com/leanprover-community/mathlib/issues/9805">https://github.com/leanprover-community/mathlib/issues/9805</a> for another interesting example.  What happens is that the tactic produces a buggy proof term and Lean only notices this at the end when the kernel goes over the proof again.</p>



<a name="262305011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262305011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262305011">(Nov 22 2021 at 11:05)</a>:</h4>
<p>Thank's. Using <code>@adjoin_induction...</code> the proof doesn't work anymore, so maybe I can just fix it. Let me see.</p>



<a name="262305757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262305757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262305757">(Nov 22 2021 at 11:14)</a>:</h4>
<p>I think the problem comes from <code>adjoin_induction</code>: the initial goal, after <code>cases b with b hb</code>, is <code>⟨b, hb⟩ ∈ ...</code> and so it's not exactly a goal about <code>b</code>. I don't know which <code>p : B → Prop</code> Lean decides to use in <code>adjoin_induction</code> (since there is no <code>hb</code> for a general <code>b : B</code>) but the bug (if there is one) is just the fact that it doesn't say immediately that there is a problem.</p>



<a name="262307393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262307393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262307393">(Nov 22 2021 at 11:33)</a>:</h4>
<p>Here's a more minimised example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.adjoin.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span>

<span class="kn">open</span> <span class="n">algebra</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">b</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
  <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hb</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b₁</span> <span class="n">hb₁</span><span class="o">,</span> <span class="n">subset_adjoin</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span>
    <span class="o">((</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span> <span class="n">_</span><span class="o">)),</span>
  <span class="gr">sorry</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262308228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262308228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262308228">(Nov 22 2021 at 11:44)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">b</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">adjoin_induction</span> <span class="n">hb</span> <span class="gr">sorry</span> <span class="gr">sorry</span> <span class="gr">sorry</span> <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262308669"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262308669" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262308669">(Nov 22 2021 at 11:50)</a>:</h4>
<p>Dunno if this helps. <span class="user-mention" data-user-id="130384">@Riccardo Brasca</span> is this the proof you expect to work? I tried to rephrase it (changing the lean but not the maths) and I broke a <code>convert</code>.  The goal doesn't look true :-/</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">b</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">foo</span> <span class="o">:=</span> <span class="o">(⟨</span><span class="n">b</span><span class="o">,</span> <span class="n">hb</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})),</span>
  <span class="n">convert</span> <span class="o">(</span><span class="n">adjoin_induction</span> <span class="n">hb</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b₁</span> <span class="n">hb₁</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">((</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span> <span class="n">_</span><span class="o">))</span> <span class="o">:</span>
    <span class="n">foo</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}),</span>
  <span class="o">{</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">hn</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hb₁</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">subset_adjoin</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">←</span> <span class="n">subalgebra.coe_eq_one</span><span class="o">,</span> <span class="n">subalgebra.coe_pow</span><span class="o">],</span>
    <span class="n">convert</span> <span class="n">hn</span><span class="o">,</span> <span class="c1">-- this closes the goal in the original proof</span>
    <span class="gr">sorry</span> <span class="o">},</span>
  <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>
  <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>
  <span class="o">{</span> <span class="gr">sorry</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262308894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262308894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262308894">(Nov 22 2021 at 11:53)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">b</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="c1">--cases b with b hb,</span>
  <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">b.2</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b₁</span> <span class="n">hb₁</span><span class="o">,</span> <span class="n">subset_adjoin</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span>
    <span class="o">((</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hx</span> <span class="n">hy</span><span class="o">,</span> <span class="n">_</span><span class="o">)),</span>
  <span class="o">{</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">hn</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hb₁</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="bp">←</span> <span class="n">subalgebra.coe_eq_one</span><span class="o">,</span> <span class="n">subalgebra.coe_pow</span><span class="o">],</span>
    <span class="n">convert</span> <span class="n">hn</span><span class="o">,</span> <span class="c1">-- no longer works</span>
    <span class="gr">sorry</span> <span class="o">},</span>
<span class="bp">...</span>
</code></pre></div>



<a name="262308991"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262308991" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262308991">(Nov 22 2021 at 11:54)</a>:</h4>
<p>If you don't do the <code>cases</code> but just use <code>b.1</code> and <code>b.2</code>, the proof breaks earlier. Is there a mathematical problem with the proof?</p>



<a name="262309209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262309209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262309209">(Nov 22 2021 at 11:57)</a>:</h4>
<p>I now think that <code>adjoin_induction</code> is not the right strategy to prove the result, at least not directly: after <code>cases</code> we have <code>b: B</code> and <code>hb : b ∈ adjoin A {b : B | ∃ (n : ℕ), b ^ n = 1}</code> and the goal concerns both <code>b</code> and <code>hb</code>. Now, <code>adjoin_induction</code> acts on <code>b</code>, but keep the original <code>hb</code>, so it doesn't work.</p>



<a name="262309234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262309234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262309234">(Nov 22 2021 at 11:58)</a>:</h4>
<p>I am not sure what is the best solution: find a different proof or make <code>adjoin_induction</code> act on <code>hb</code> too somehow.</p>



<a name="262309432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262309432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262309432">(Nov 22 2021 at 12:00)</a>:</h4>
<p>What does the b on the RHS of the condition in the set builder in the starting goal refer to? I don't mean mathematically, but to Lean? The mwe might be clearer if there are more variable names and fewer possible name shadowing.</p>



<a name="262309541"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262309541" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262309541">(Nov 22 2021 at 12:01)</a>:</h4>
<p>Voilà.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.adjoin.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span>

<span class="kn">open</span> <span class="n">algebra</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₁</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₂</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₂</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₁</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">b</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span> <span class="c1">--goal is ⟨b, hb⟩ ∈ adjoin A {β₁ : ↥(adjoin A {β₂ : B | ∃ (n : ℕ), β₂ ^ n = 1}) | ∃ (n : ℕ), β₁ ^ n = 1}</span>
  <span class="n">exact</span> <span class="n">adjoin_induction</span> <span class="n">hb</span> <span class="gr">sorry</span> <span class="gr">sorry</span> <span class="gr">sorry</span> <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262309605"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262309605" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262309605">(Nov 22 2021 at 12:01)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/algebra.adjoin_induction">docs#algebra.adjoin_induction</a></p>



<a name="262310044"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262310044" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262310044">(Nov 22 2021 at 12:06)</a>:</h4>
<p>When I was looking at this I wondered if maybe we should prove that <code>adjoin</code> is "idempotent" i.e. <code>adjoin (adjoin A S)  S = adjoin A  S</code> , but this isn't true as written  as the algebra structures get messed up. But it felt like something like this is what we want.  That said, this is probably just as annoying to prove</p>



<a name="262310467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262310467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262310467">(Nov 22 2021 at 12:11)</a>:</h4>
<p>One issue is that the induction is proving something solely about b (inferring from hb) but the goal is about a subtype whose value is b. Do you have lemmas that simplify or change goals that are about being mem of adjoin of a subtype?</p>



<a name="262310547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262310547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262310547">(Nov 22 2021 at 12:12)</a>:</h4>
<p>I am looking for them since 30 minutes. Is the following true?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.set.basic</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="n">set</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">hi</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">∈</span> <span class="n">T</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hti</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">t</span> <span class="bp">=</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">S</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">T</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="262310646"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262310646" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262310646">(Nov 22 2021 at 12:13)</a>:</h4>
<p>I don't even care about <code>adjoin</code> (at least, not now), I don't know how to work with members of set of a subtype.</p>



<a name="262310804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262310804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262310804">(Nov 22 2021 at 12:15)</a>:</h4>
<p><code>rw [← hti],</code> says <code>rewrite tactic failed, motive is not type correct λ (_a : ι), ⟨i, hi⟩ ∈ T = (⟨_a, hi⟩ ∈ T)</code>. That usually means I am missing something.</p>



<a name="262310910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262310910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262310910">(Nov 22 2021 at 12:16)</a>:</h4>
<p>Mmm, <code>simp [← hti, ht],</code> proves it.</p>



<a name="262311355"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262311355" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262311355">(Nov 22 2021 at 12:22)</a>:</h4>
<p>The point is that in the following</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">hi</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="n">set</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">H</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">t</span> <span class="bp">∈</span> <span class="n">T</span><span class="o">,</span> <span class="bp">↑</span><span class="n">t</span> <span class="bp">=</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">S</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">T</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">t</span><span class="o">,</span> <span class="n">ht</span><span class="o">,</span> <span class="n">hti</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">H</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span> <span class="n">hti</span><span class="o">,</span> <span class="n">ht</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>
<p>in <code>H</code> there is no mention of <code>hi</code>, so it can (maybe) proved using <code>adjoin_induction</code>. I am trying.</p>



<a name="262311419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262311419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262311419">(Nov 22 2021 at 12:23)</a>:</h4>
<p>Indeed no errors in</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₁</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₂</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₂</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₁</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">b</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
  <span class="k">suffices</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₁</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₂</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₂</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span>
    <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₁</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">},</span> <span class="bp">↑</span><span class="n">x</span> <span class="bp">=</span> <span class="n">b</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">,</span> <span class="n">hxb</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span> <span class="n">hxb</span><span class="o">,</span> <span class="n">hx</span><span class="o">]</span> <span class="o">},</span>
  <span class="n">exact</span> <span class="n">adjoin_induction</span> <span class="n">hb</span> <span class="gr">sorry</span> <span class="gr">sorry</span> <span class="gr">sorry</span> <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>But still four <code>sorry</code> :)</p>



<a name="262311634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262311634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262311634">(Nov 22 2021 at 12:25)</a>:</h4>
<p>Oh nice! This feels like progress. With your earlier question, <code>⟨i, hi⟩</code> and <code>t</code> are equal because all proofs of a proposition are defeq. This works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="n">set</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">hi</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">∈</span> <span class="n">T</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hti</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">t</span> <span class="bp">=</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">S</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">T</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">t</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">ht</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">hti.symm</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262311731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262311731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262311731">(Nov 22 2021 at 12:26)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/subtype.eq">docs#subtype.eq</a></p>



<a name="262311822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262311822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262311822">(Nov 22 2021 at 12:27)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">ι</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">T</span> <span class="o">:</span> <span class="n">set</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ι</span><span class="o">)</span> <span class="o">(</span><span class="n">hi</span> <span class="o">:</span> <span class="n">i</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">t</span> <span class="o">:</span> <span class="n">S</span><span class="o">)</span> <span class="o">(</span><span class="n">ht</span> <span class="o">:</span> <span class="n">t</span> <span class="bp">∈</span> <span class="n">T</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hti</span> <span class="o">:</span> <span class="bp">↑</span><span class="n">t</span> <span class="bp">=</span> <span class="n">i</span><span class="o">)</span> <span class="o">:</span> <span class="o">(⟨</span><span class="n">i</span><span class="o">,</span> <span class="n">hi</span><span class="o">⟩</span> <span class="o">:</span> <span class="n">S</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">T</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">t</span><span class="o">,</span>
  <span class="n">subst</span> <span class="n">hti</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">ht</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p><code>subst</code> is a really cool tactic.</p>



<a name="262314769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262314769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262314769">(Nov 22 2021 at 12:57)</a>:</h4>
<p>This works</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.adjoin.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span>

<span class="kn">open</span> <span class="n">algebra</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₁</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₂</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₂</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₁</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">cases</span> <span class="n">b</span> <span class="k">with</span> <span class="n">b</span> <span class="n">hb</span><span class="o">,</span>
  <span class="k">suffices</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₁</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₂</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₂</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span>
    <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₁</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">},</span> <span class="bp">↑</span><span class="n">x</span> <span class="bp">=</span> <span class="n">b</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x</span><span class="o">,</span> <span class="n">hx</span><span class="o">,</span> <span class="n">hxb</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">this</span><span class="o">,</span>
    <span class="n">simp</span> <span class="o">[</span><span class="bp">←</span> <span class="n">hxb</span><span class="o">,</span> <span class="n">hx</span><span class="o">]</span> <span class="o">},</span>
  <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hb</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b₁</span> <span class="n">hb₁</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b₁</span> <span class="n">b₂</span><span class="o">,</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">b₁</span> <span class="n">b₂</span><span class="o">,</span> <span class="n">_</span><span class="o">),</span>
  <span class="o">{</span> <span class="n">obtain</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">hb₁</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hb₁</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨⟨</span><span class="n">b₁</span><span class="o">,</span> <span class="n">subset_adjoin</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">hb₁</span><span class="o">⟩⟩,</span> <span class="n">_</span><span class="o">⟩,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">and_true</span><span class="o">,</span> <span class="n">eq_self_iff_true</span><span class="o">,</span> <span class="n">subtype.coe_mk</span><span class="o">],</span>
    <span class="n">refine</span> <span class="n">subset_adjoin</span> <span class="o">⟨</span><span class="n">n</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">subalgebra.coe_eq_one</span><span class="o">,</span> <span class="n">subalgebra.coe_pow</span><span class="o">],</span>
    <span class="n">convert</span> <span class="n">hb₁</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">refine</span> <span class="o">⟨⟨</span><span class="n">algebra_map</span> <span class="n">A</span> <span class="n">B</span> <span class="n">a</span><span class="o">,</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">_</span><span class="o">⟩,</span> <span class="n">_</span><span class="o">⟩,</span>
    <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">exists_prop</span><span class="o">,</span> <span class="n">set_like.coe_mk</span><span class="o">,</span> <span class="n">and_true</span><span class="o">,</span> <span class="n">eq_self_iff_true</span><span class="o">],</span>
    <span class="n">convert</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">a</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">and_imp</span><span class="o">,</span> <span class="n">exists_prop</span><span class="o">,</span> <span class="n">forall_exists_index</span><span class="o">],</span>
    <span class="n">intros</span> <span class="n">x</span> <span class="n">hxmem</span> <span class="n">hxb</span> <span class="n">y</span> <span class="n">hymem</span> <span class="n">hyb</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨⟨</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">,</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)⟩,</span> <span class="o">⟨</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩⟩,</span>
    <span class="o">{</span> <span class="n">simp_rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">subalgebra.coe_add</span><span class="o">],</span>
      <span class="n">exact</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="n">hxmem</span> <span class="n">hymem</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">simp_rw</span> <span class="o">[</span><span class="n">hxb</span><span class="o">,</span> <span class="n">hyb</span><span class="o">],</span>
      <span class="n">refl</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">and_imp</span><span class="o">,</span> <span class="n">exists_prop</span><span class="o">,</span> <span class="n">forall_exists_index</span><span class="o">],</span>
    <span class="n">intros</span> <span class="n">x</span> <span class="n">hxmem</span> <span class="n">hxb</span> <span class="n">y</span> <span class="n">hymem</span> <span class="n">hyb</span><span class="o">,</span>
    <span class="n">refine</span> <span class="o">⟨⟨</span><span class="n">x</span> <span class="bp">*</span> <span class="n">y</span><span class="o">,</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)⟩,</span> <span class="o">⟨</span><span class="n">_</span><span class="o">,</span> <span class="n">_</span><span class="o">⟩⟩,</span>
    <span class="o">{</span> <span class="n">simp_rw</span> <span class="o">[</span><span class="bp">←</span> <span class="n">subalgebra.coe_mul</span><span class="o">],</span>
      <span class="n">exact</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="n">hxmem</span> <span class="n">hymem</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">simp_rw</span> <span class="o">[</span><span class="n">hxb</span><span class="o">,</span> <span class="n">hyb</span><span class="o">],</span>
      <span class="n">refl</span> <span class="o">}</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262314899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262314899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262314899">(Nov 22 2021 at 12:58)</a>:</h4>
<p><span class="user-mention" data-user-id="389019">@Chris Birkbeck</span> if you find a reasonable way to state that <code>adjoin</code> is idempotent I think that a similar proof should work too.</p>



<a name="262314959"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262314959" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262314959">(Nov 22 2021 at 12:59)</a>:</h4>
<p>Yeah let me think about how to state it properly.</p>



<a name="262315126"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262315126" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262315126">(Nov 22 2021 at 13:00)</a>:</h4>
<p>But I agree that it is a pain</p>



<a name="262324813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262324813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262324813">(Nov 22 2021 at 14:23)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.adjoin.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">A</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">A</span><span class="o">}</span>

<span class="kn">open</span> <span class="n">algebra</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">A</span><span class="o">}</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span><span class="o">)</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">r</span><span class="o">,</span> <span class="n">hr</span><span class="o">⟩,</span>
      <span class="n">exact</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
      <span class="k">let</span> <span class="n">y'</span> <span class="o">:</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">y</span><span class="o">,</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">_</span><span class="o">⟩,</span>
      <span class="n">exact</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">y'</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">r</span><span class="o">,</span>
      <span class="k">let</span> <span class="n">r'</span> <span class="o">:</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">r</span><span class="o">,</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">_</span><span class="o">⟩,</span>
      <span class="n">exact</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">r'</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="o">}</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262324853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262324853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262324853">(Nov 22 2021 at 14:23)</a>:</h4>
<p>If I understood the desiratum correctly</p>



<a name="262325425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262325425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262325425">(Nov 22 2021 at 14:28)</a>:</h4>
<p>Ah, it needs to be:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">B</span><span class="o">}</span>

<span class="kn">open</span> <span class="n">algebra</span>

<span class="kd">lemma</span> <span class="n">adjoin_idem</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">B</span><span class="o">}</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span><span class="o">)</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="o">:=</span>
</code></pre></div>



<a name="262325500"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262325500" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262325500">(Nov 22 2021 at 14:28)</a>:</h4>
<p>Right?</p>



<a name="262326487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262326487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262326487">(Nov 22 2021 at 14:35)</a>:</h4>
<p>Ah yes that would work! I was trying to figure out how to state it as an equality of subalgebras, but element-wise would be enough</p>



<a name="262330640"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262330640" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262330640">(Nov 22 2021 at 15:05)</a>:</h4>
<p>Here is a proof (I cheated and used some <code>tidy</code>'s as you'll see):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variables</span> <span class="o">{</span><span class="n">A</span> <span class="n">B</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">A</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">B</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">A</span> <span class="n">B</span><span class="o">]</span> <span class="o">{</span><span class="n">S</span> <span class="o">:</span> <span class="n">set</span> <span class="n">B</span><span class="o">}</span>

<span class="kn">open</span> <span class="n">algebra</span>

<span class="kd">lemma</span> <span class="n">adjoin_idem</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">B</span><span class="o">}</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span><span class="o">)</span> <span class="n">S</span> <span class="bp">↔</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
      <span class="n">intros</span> <span class="n">t</span> <span class="n">H</span><span class="o">,</span> <span class="n">cases</span> <span class="n">H</span><span class="o">,</span> <span class="n">induction</span> <span class="n">H_h</span><span class="o">,</span> <span class="n">intros</span> <span class="n">t_1</span> <span class="n">H</span><span class="o">,</span> <span class="n">cases</span> <span class="n">H</span><span class="o">,</span> <span class="n">induction</span> <span class="n">H_h</span><span class="o">,</span> <span class="n">dsimp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span> <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span> <span class="n">cases</span> <span class="n">H_w_1</span><span class="o">,</span> <span class="n">solve_by_elim</span><span class="o">,},</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="o">⟨</span><span class="n">r</span><span class="o">,</span> <span class="n">hr</span><span class="o">⟩,</span>
      <span class="n">assumption</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span>
    <span class="n">intros</span> <span class="n">t</span> <span class="n">H</span><span class="o">,</span> <span class="n">cases</span> <span class="n">H</span><span class="o">,</span> <span class="n">induction</span> <span class="n">H_h</span><span class="o">,</span> <span class="n">intros</span> <span class="n">t_1</span> <span class="n">H</span><span class="o">,</span> <span class="n">cases</span> <span class="n">H</span><span class="o">,</span> <span class="n">induction</span> <span class="n">H_h</span><span class="o">,</span> <span class="n">dsimp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span> <span class="n">simp</span> <span class="n">at</span> <span class="bp">*</span><span class="o">,</span> <span class="n">cases</span> <span class="n">H_w_1</span><span class="o">,</span> <span class="n">solve_by_elim</span><span class="o">,</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">r</span><span class="o">,</span>
     <span class="k">let</span> <span class="n">r'</span> <span class="o">:=</span> <span class="n">algebra_map</span> <span class="n">A</span> <span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="n">s</span><span class="o">)</span> <span class="n">r</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.algebra_map_mem</span> <span class="n">_</span> <span class="n">r'</span><span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="o">}</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262333594"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262333594" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262333594">(Nov 22 2021 at 15:27)</a>:</h4>
<p>Ah actually maybe this isn't enough (at least no immediately), since its not the same S in both cases for this goal.</p>



<a name="262333636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262333636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262333636">(Nov 22 2021 at 15:27)</a>:</h4>
<p>Something like this?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">adjoin_idem'</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="bp">|</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">}</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">B</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="o">:=</span>
</code></pre></div>



<a name="262333868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262333868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262333868">(Nov 22 2021 at 15:28)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">adjoin_idem'</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="bp">|</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">}</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">B</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="n">y</span> <span class="n">hy</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">R</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
      <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">hR</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">set.union_subset_iff</span><span class="o">,</span> <span class="n">set.mem_set_of_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">hR</span><span class="o">,</span>
      <span class="n">simpa</span> <span class="n">using</span> <span class="n">hR.right</span> <span class="n">hy</span> <span class="o">},</span>
    <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="n">y</span> <span class="n">hy</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">R</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
      <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">hR</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">set.union_subset_iff</span><span class="o">,</span> <span class="n">set.mem_set_of_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">hR</span><span class="o">,</span>
      <span class="gr">sorry</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">r</span><span class="o">,</span>
      <span class="gr">sorry</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">}</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₁</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₂</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₂</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₁</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">convert</span> <span class="n">adjoin_idem'.mpr</span> <span class="n">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">subtype.ext_iff</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">b.prop</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div>



<a name="262334479"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262334479" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262334479">(Nov 22 2021 at 15:32)</a>:</h4>
<p>If you want to play with the real life theorem, it is <a href="https://github.com/leanprover-community/flt-regular/blob/c813f0fdc091c844a2e88520c108831984e0b5e4/src/number_theory/cyclotomic/basic.lean#L125">here</a>.</p>



<a name="262334503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262334503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262334503">(Nov 22 2021 at 15:32)</a>:</h4>
<p>It is sorry free, but it can surely be golfed.</p>



<a name="262347721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262347721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262347721">(Nov 22 2021 at 17:02)</a>:</h4>
<p><span class="user-mention silent" data-user-id="308899">Yakov Pechersky</span> <a href="#narrow/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved/near/262333868">said</a>:</p>
<blockquote>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">adjoin_idem'</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span><span class="o">}</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">b</span> <span class="o">:</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="bp">|</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="n">B</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">S</span><span class="o">}</span> <span class="bp">↔</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">B</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">adjoin</span> <span class="n">A</span> <span class="n">S</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">split</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="n">y</span> <span class="n">hy</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">R</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
      <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">hR</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">set.union_subset_iff</span><span class="o">,</span> <span class="n">set.mem_set_of_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">hR</span><span class="o">,</span>
      <span class="n">simpa</span> <span class="n">using</span> <span class="n">hR.right</span> <span class="n">hy</span> <span class="o">},</span>
    <span class="o">{</span> <span class="gr">sorry</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.add_mem</span> <span class="n">_</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">exact</span> <span class="n">subalgebra.mul_mem</span> <span class="n">_</span> <span class="o">}</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">intro</span> <span class="n">hx</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">adjoin_induction</span> <span class="n">hx</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="o">{</span> <span class="n">rintro</span> <span class="n">y</span> <span class="n">hy</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">R</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
      <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">hR</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
      <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">set.union_subset_iff</span><span class="o">,</span> <span class="n">set.mem_set_of_eq</span><span class="o">]</span> <span class="n">at</span> <span class="n">hR</span><span class="o">,</span>
      <span class="gr">sorry</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intro</span> <span class="n">r</span><span class="o">,</span>
      <span class="gr">sorry</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">intros</span> <span class="n">x</span> <span class="n">y</span><span class="o">,</span>
      <span class="n">simp</span> <span class="o">}</span> <span class="o">}</span>
<span class="kd">end</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">b</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}))</span> <span class="o">:</span>  <span class="n">b</span> <span class="bp">∈</span>
  <span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₁</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">adjoin</span> <span class="n">A</span> <span class="o">{</span><span class="n">β₂</span> <span class="o">:</span> <span class="n">B</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₂</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">})</span> <span class="bp">|</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="n">β₁</span> <span class="bp">^</span> <span class="n">n</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">}</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">convert</span> <span class="n">adjoin_idem'.mpr</span> <span class="n">_</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">subtype.ext_iff</span><span class="o">]</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="n">b.prop</span> <span class="o">}</span>
<span class="kd">end</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Ok this works, so I just need to make it sorry-free...</p>



<a name="262348817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262348817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262348817">(Nov 22 2021 at 17:11)</a>:</h4>
<p>Isn't this all some Galois insertion thing? (According to the docstring, <code>adjoin A S</code> is the smallest <code>A</code>-algebra containing <code>S</code>, so an <code>A</code>-algebra contains <code>adjoin A S</code> iff it contains <code>S</code> and therefore <code>adjoin A (adjoin A S) = adjoin A S</code>)<br>
If you want to prove it manually, seems a better strategy is <a href="https://leanprover-community.github.io/mathlib_docs/find/algebra.adjoin_le_iff">docs#algebra.adjoin_le_iff</a> not induction</p>



<a name="262349090"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262349090" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262349090">(Nov 22 2021 at 17:12)</a>:</h4>
<p>The issue is that <code>adjoin (adjoin A S)  S= adjoin A S</code> isnt quite true as the algebra structures dont match. One is an <code>A</code>-algebra while the other is an <code>adjoin A S</code>-algebra.</p>



<a name="262349394"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262349394" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262349394">(Nov 22 2021 at 17:15)</a>:</h4>
<p>Ah but maybe what you wrote is different to what I'm thinking of.</p>



<a name="262349578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262349578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262349578">(Nov 22 2021 at 17:16)</a>:</h4>
<p>Aha I didn't notice you were talking about a different thing</p>



<a name="262349746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262349746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262349746">(Nov 22 2021 at 17:17)</a>:</h4>
<p>Hm  yeah, but can't figure out if what you're suggesting would work.</p>



<a name="262349777"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262349777" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262349777">(Nov 22 2021 at 17:18)</a>:</h4>
<p>Maybe it does and I'm just being slow</p>



<a name="262349907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262349907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262349907">(Nov 22 2021 at 17:18)</a>:</h4>
<p>The original question only contains things of the form <code>adjoin A _</code></p>



<a name="262350121"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262350121" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262350121">(Nov 22 2021 at 17:20)</a>:</h4>
<p>Good point! let me see if this works</p>



<a name="262368188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262368188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262368188">(Nov 22 2021 at 19:42)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved/near/262334479">said</a>:</p>
<blockquote>
<p>If you want to play with the real life theorem, it is <a href="https://github.com/leanprover-community/flt-regular/blob/c813f0fdc091c844a2e88520c108831984e0b5e4/src/number_theory/cyclotomic/basic.lean#L125">here</a>.</p>
</blockquote>
<p>Ok so I got the other version working. But its more like I anti-golfed it (at least its a bit more general now).</p>



<a name="262413005"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262413005" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262413005">(Nov 23 2021 at 04:55)</a>:</h4>
<p>Is it possible you're after an induction principle like the primed <a href="https://leanprover-community.github.io/mathlib_docs/find/submonoid.closure_induction'">docs#submonoid.closure_induction'</a>?</p>



<a name="262434784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262434784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262434784">(Nov 23 2021 at 10:09)</a>:</h4>
<p>Ah, that's exactly what we need</p>



<a name="262434933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262434933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262434933">(Nov 23 2021 at 10:10)</a>:</h4>
<p>I'll PR a version for <code>adjoin</code> later today</p>



<a name="262441881"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262441881" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262441881">(Nov 23 2021 at 11:16)</a>:</h4>
<p>Looking at the proof of <a href="https://leanprover-community.github.io/mathlib_docs/find/closure_induction'">docs#closure_induction'</a> it seems they used the same trick I proposed here (replace the statement by some <code>∃...</code>) <span aria-label="sunglasses" class="emoji emoji-1f60e" role="img" title="sunglasses">:sunglasses:</span></p>



<a name="262443014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262443014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262443014">(Nov 23 2021 at 11:28)</a>:</h4>
<p>Yeah its a good trick, I tried for ages yesterday to do it without it, but in the end just gave up.</p>



<a name="262447510"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262447510" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262447510">(Nov 23 2021 at 12:16)</a>:</h4>
<p><span class="user-mention" data-user-id="389019">@Chris Birkbeck</span> I've golfed your <code>adjoin_idem</code> <a href="https://github.com/leanprover-community/flt-regular/blob/master/src/ready_for_mathlib/adjoin.lean">here</a>. If you agree I am going to PR it, it can be in same PR as <code>adjoin_induction'</code>.</p>



<a name="262447654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262447654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262447654">(Nov 23 2021 at 12:18)</a>:</h4>
<p>Oh great, it looks much better now! I'm happy for this to be PR'd</p>



<a name="262448273"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262448273" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262448273">(Nov 23 2021 at 12:24)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/10427">#10427</a></p>



<a name="262449192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262449192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262449192">(Nov 23 2021 at 12:34)</a>:</h4>
<p>BTW the RHS of the iff is not necessary. It's just x.prop</p>



<a name="262449246"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262449246" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262449246">(Nov 23 2021 at 12:35)</a>:</h4>
<p>So if you have "x : adjoin R s" then you can just directly prove the LHS</p>



<a name="262453089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/An%20error%20that%20appears%20after%20the%20last%20goal%20is%20proved/near/262453089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/An.20error.20that.20appears.20after.20the.20last.20goal.20is.20proved.html#262453089">(Nov 23 2021 at 13:13)</a>:</h4>
<p>Thank's, I've golfed the proof.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>