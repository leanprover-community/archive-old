---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html">gpow on  `matrix n n K`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="246042721"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246042721" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246042721">(Jul 15 2021 at 01:46)</a>:</h4>
<p>Thanks to <code>linear_algebra.matrix.nonsingular_inverse</code>, we have a <code>has_inv (matrix n n K)</code>. However, that does not provide a <code>has_pow (matrix n n K) int</code>. What is the right way to provide that? Directly? What's the correct algebraic structure to give here?</p>



<a name="246043722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246043722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246043722">(Jul 15 2021 at 02:02)</a>:</h4>
<p>I think that instance requires a group</p>



<a name="246043742"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246043742" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246043742">(Jul 15 2021 at 02:02)</a>:</h4>
<p>There's also fpow instead of gpow which requires a group_with_zero</p>



<a name="246043930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246043930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246043930">(Jul 15 2021 at 02:05)</a>:</h4>
<p>You can define it by casing on the int, and for things that are truly invertible, <code>(units.coe_hom _).map_pow</code> will work on the two cases. But it <code>monoid_hom.map_gpow</code> won't work, of course, due to the restriction to groups...</p>



<a name="246044025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246044025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246044025">(Jul 15 2021 at 02:06)</a>:</h4>
<p>Can one give <code>matrix n n K</code> <code>group_with_zero</code> then?</p>



<a name="246044143"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246044143" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246044143">(Jul 15 2021 at 02:08)</a>:</h4>
<p>Only when n=unit</p>



<a name="246044178"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246044178" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246044178">(Jul 15 2021 at 02:09)</a>:</h4>
<p>There are non-invertible non-zero matrices</p>



<a name="246045206"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246045206" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246045206">(Jul 15 2021 at 02:27)</a>:</h4>
<p>I see -- the issue is evident below</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>

<span class="n">open_locale</span> <span class="n">matrix</span>
<span class="kn">open</span> <span class="n">matrix</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">n</span> <span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">α</span><span class="o">]</span>

<span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">:</span> <span class="n">div_inv_monoid</span> <span class="o">(</span><span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="bp">..</span><span class="n">matrix.has_inv</span><span class="o">,</span>
  <span class="bp">..</span><span class="o">(</span><span class="k">show</span> <span class="n">monoid</span> <span class="o">(</span><span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">),</span> <span class="kd">by</span> <span class="n">apply_instance</span><span class="o">)</span> <span class="o">}</span>

<span class="kd">lemma</span> <span class="n">matrix.inv_def</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">M</span><span class="bp">⁻¹</span> <span class="bp">=</span> <span class="n">nonsing_inv</span> <span class="n">M</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">lemma</span> <span class="n">matrix.nonsing_inv_of_not_is_unit</span> <span class="o">{</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">}</span> <span class="o">(</span><span class="n">h</span> <span class="o">:</span> <span class="bp">¬</span> <span class="n">is_unit</span> <span class="n">M</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">M</span><span class="bp">⁻¹</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">rw</span> <span class="n">is_unit_iff_is_unit_det</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
  <span class="n">simp</span> <span class="o">[</span><span class="n">matrix.inv_def</span><span class="o">,</span> <span class="n">nonsing_inv</span><span class="o">,</span> <span class="n">h</span><span class="o">]</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">matrix.inv_zero</span> <span class="o">[</span><span class="n">nontrivial</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">nontrivial</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="n">matrix.nonsing_inv_of_not_is_unit</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simp</span><span class="o">)</span>

<span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">[</span><span class="n">nontrivial</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">nontrivial</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">group_with_zero</span> <span class="o">(</span><span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">zero_mul</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">matrix.zero_mul</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">mul_zero</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">_</span><span class="o">,</span> <span class="n">matrix.mul_zero</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">inv_zero</span> <span class="o">:=</span> <span class="n">matrix.inv_zero</span><span class="o">,</span>
  <span class="n">mul_inv_cancel</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">M</span> <span class="n">hM</span><span class="o">,</span> <span class="gr">sorry</span><span class="o">,</span> <span class="c1">-- if `¬ is_unit M` then `0 = 1`</span>
  <span class="bp">..</span><span class="o">(</span><span class="k">show</span> <span class="n">has_zero</span> <span class="o">(</span><span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">),</span> <span class="kd">by</span> <span class="n">apply_instance</span><span class="o">),</span>
  <span class="bp">..</span><span class="o">(</span><span class="k">show</span> <span class="n">nontrivial</span> <span class="o">(</span><span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">),</span> <span class="kd">by</span> <span class="n">apply_instance</span><span class="o">),</span>
  <span class="bp">..</span><span class="o">(</span><span class="k">show</span> <span class="n">div_inv_monoid</span> <span class="o">(</span><span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">α</span><span class="o">),</span> <span class="kd">by</span> <span class="n">apply_instance</span><span class="o">)</span> <span class="o">}</span>
</code></pre></div>



<a name="246054623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246054623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246054623">(Jul 15 2021 at 05:53)</a>:</h4>
<p>Square matrices over a semiring are a monoid with zero</p>



<a name="246057370"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246057370" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246057370">(Jul 15 2021 at 06:45)</a>:</h4>
<p>You can try to generalize the <code>gpow</code> instance to a <code>monoid</code>+<code>has_inv</code> but it won't have many nice properties.</p>



<a name="246057446"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246057446" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246057446">(Jul 15 2021 at 06:46)</a>:</h4>
<p>So, it might be better to copy definition from <code>fpow</code> or <code>gpow</code>, then prove lemmas that are true for matrices (or operators).</p>



<a name="246057673"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246057673" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246057673">(Jul 15 2021 at 06:50)</a>:</h4>
<p>Square matrices over a field shouldn't really have an <code>inv</code>, because of matrices like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><mtable rowspacing="0.1600em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>01</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>00</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\begin{pmatrix}01\\00\end{pmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">01</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">00</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span>.</p>



<a name="246058286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246058286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246058286">(Jul 15 2021 at 07:00)</a>:</h4>
<p>My proposal was to define <code>has_inv</code> as (some choice of) pseudoinverse, which would give sensible results for a few more matrices. But that might actually have less nice properties than the nonsingular inverse.</p>



<a name="246088397"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246088397" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246088397">(Jul 15 2021 at 12:48)</a>:</h4>
<p>Are there any lemmas about monoid_with_zero that are worth having for matrices? I can do the specialized  fpow approach for matrices.</p>



<a name="246088450"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246088450" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246088450">(Jul 15 2021 at 12:49)</a>:</h4>
<p>I assume you mean <code>group_with_zero</code>, <code>monoid_with_zero</code> is already true for matrices</p>



<a name="246088607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246088607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246088607">(Jul 15 2021 at 12:50)</a>:</h4>
<p>Sorry, I was trying to parse Kevin's statement</p>



<a name="246100700"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/gpow%20on%20%20%60matrix%20n%20n%20K%60/near/246100700" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/gpow.20on.20.20.60matrix.20n.20n.20K.60.html#246100700">(Jul 15 2021 at 14:19)</a>:</h4>
<p>"Monoids with zero shouldn't have an inv"</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>