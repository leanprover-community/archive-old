---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/lean.20solver.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html">lean solver</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="174148625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174148625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174148625">(Aug 26 2019 at 14:55)</a>:</h4>
<p>hello I am trying to solve an induction problem but I am getting an error message</p>
<p>theorem test_ind (n : nat) : (3^n -1) % 2 = 0 := <br>
nat.rec_on n rfl (Î» n ih, by simp only [add_succ, ih])</p>
<p>error:<br>
simplify tactic failed to simplify</p>
<p>can someone tell me what I am doing wrong and how to fix it</p>



<a name="174148853"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174148853" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174148853">(Aug 26 2019 at 14:58)</a>:</h4>
<p>Why would that work?</p>



<a name="174148890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174148890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174148890">(Aug 26 2019 at 14:59)</a>:</h4>
<p>Do you mean <code>pow_succ</code> instead of <code>add_succ</code>?</p>



<a name="174149074"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149074" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149074">(Aug 26 2019 at 15:00)</a>:</h4>
<p>I am completely new to lean and I am trying to prove that (3^n-1) is divisible by 2 for all natural numbers and I am not really sure of the syntax to write</p>



<a name="174149183"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149183" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149183">(Aug 26 2019 at 15:02)</a>:</h4>
<p>there is a red line under the keyword simp and I am getting the error simplify tactic failed to simplify</p>



<a name="174149311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149311">(Aug 26 2019 at 15:03)</a>:</h4>
<p>i tried pow_succ and now it is saying tactic failed, there are unsolved goals</p>



<a name="174149384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149384">(Aug 26 2019 at 15:04)</a>:</h4>
<p>I'm afraid you are overoptimistic about what can be proven automatically here</p>



<a name="174149456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149456">(Aug 26 2019 at 15:05)</a>:</h4>
<p>so youre saying that this is not possible</p>



<a name="174149583"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149583" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149583">(Aug 26 2019 at 15:06)</a>:</h4>
<p>It's possible, but you'll have to help Lean a bit</p>



<a name="174149599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149599">(Aug 26 2019 at 15:07)</a>:</h4>
<p>Do you have the maths library mathlib at hand?</p>



<a name="174149654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149654">(Aug 26 2019 at 15:07)</a>:</h4>
<p>i don't think so, i am totally new to lean</p>



<a name="174149737"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149737" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149737">(Aug 26 2019 at 15:08)</a>:</h4>
<p>You should have a look at the installation instructions at <a href="https://github.com/leanprover-community/mathlib/blob/master/README.md" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/README.md">https://github.com/leanprover-community/mathlib/blob/master/README.md</a></p>



<a name="174149738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174149738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174149738">(Aug 26 2019 at 15:08)</a>:</h4>
<p>im using vscode</p>



<a name="174150509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174150509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174150509">(Aug 26 2019 at 15:17)</a>:</h4>
<p>ok i think that it is working because i can #eval things, but how do i go about solving this proof with mathlib?</p>



<a name="174150535"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174150535" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174150535">(Aug 26 2019 at 15:17)</a>:</h4>
<p>Did you install everything?</p>



<a name="174150686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174150686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174150686">(Aug 26 2019 at 15:18)</a>:</h4>
<p>i didn't do anything, i just read through the installation page and it said run #eval 1+1 and it should be working and it worked</p>



<a name="174150850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174150850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174150850">(Aug 26 2019 at 15:20)</a>:</h4>
<p>Each OS specific install page ends with a link to <a href="https://github.com/leanprover-community/mathlib/blob/master/docs/install/project.md" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/docs/install/project.md">https://github.com/leanprover-community/mathlib/blob/master/docs/install/project.md</a> which is OS-independent. Did you make sure that also works?</p>



<a name="174150924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174150924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174150924">(Aug 26 2019 at 15:21)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">theorem</span> <span class="n">test_ind</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="err">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">apply</span> <span class="n">nat</span><span class="bp">.</span><span class="n">mod_eq_zero_of_dvd</span><span class="o">,</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span><span class="o">,</span> <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">nat</span><span class="bp">.</span><span class="n">pow_succ</span><span class="o">],</span>
  <span class="n">rw</span> <span class="k">show</span> <span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">*</span> <span class="mi">3</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">=</span> <span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span> <span class="bp">+</span> <span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">*</span> <span class="mi">2</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">add_comm</span><span class="o">,</span> <span class="err">â</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_sub_assoc</span><span class="o">],</span>
    <span class="o">{</span> <span class="n">refl</span> <span class="o">},</span>
    <span class="o">{</span> <span class="n">apply</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow_pos</span><span class="o">,</span> <span class="n">exact</span> <span class="n">dec_trivial</span> <span class="o">}</span> <span class="o">},</span>
  <span class="n">apply</span> <span class="n">dvd_add</span> <span class="n">ih</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">dvd_mul_left</span>
<span class="kn">end</span>
</pre></div>



<a name="174150952"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174150952" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174150952">(Aug 26 2019 at 15:21)</a>:</h4>
<p>The first thing I do is get rid of the ugly <code>%</code>... I don't know how to deal with it <span aria-label="stuck out tongue wink" class="emoji emoji-1f61c" role="img" title="stuck out tongue wink">:stuck_out_tongue_wink:</span></p>



<a name="174151524"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174151524" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174151524">(Aug 26 2019 at 15:28)</a>:</h4>
<p>this only problem now is that there is a red squiggly line under apply here { apply nat.pow_pos, exact dec_trivial } but there is no error message</p>



<a name="174151571"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174151571" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174151571">(Aug 26 2019 at 15:28)</a>:</h4>
<p>actually there is an error because of it, unknown identifier 'nat.pow_pos'</p>



<a name="174151603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174151603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174151603">(Aug 26 2019 at 15:29)</a>:</h4>
<p>That lemma is probably from mathlib that you don't want to install...</p>



<a name="174153222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174153222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174153222">(Aug 26 2019 at 15:48)</a>:</h4>
<p>Am I missing somewhere to look for</p>
<div class="codehilite"><pre><span></span><span class="kn">lemma</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_mod</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">â</span><span class="o">)</span> <span class="o">:</span> <span class="o">((</span><span class="n">x</span> <span class="err">%</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="err">%</span> <span class="n">n</span><span class="o">))</span> <span class="err">%</span> <span class="n">n</span> <span class="bp">=</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span> <span class="err">%</span> <span class="n">n</span> <span class="o">:=</span>
<span class="n">modeq_add</span> <span class="o">(</span><span class="n">mod_modeq</span> <span class="n">x</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">mod_modeq</span> <span class="n">y</span> <span class="n">n</span><span class="o">)</span>
</pre></div>



<a name="174153272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174153272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174153272">(Aug 26 2019 at 15:48)</a>:</h4>
<p>I can't find it in mathlib. Of course the proof is very short, but the statement is pretty natural for people who, unlike Johan and I, like <code>%</code></p>



<a name="174153643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174153643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174153643">(Aug 26 2019 at 15:52)</a>:</h4>
<p>i definetly just installed the mathlib and i am still getting an error at apply unknown identifier 'nat.pow_pos' do i have to import something?</p>



<a name="174153769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174153769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174153769">(Aug 26 2019 at 15:54)</a>:</h4>
<p>Anyway, I had a break from Huber rings and wrote:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">modeq</span>

<span class="kn">open</span> <span class="n">nat</span><span class="bp">.</span><span class="n">modeq</span>

<span class="kn">lemma</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_mod</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">â</span><span class="o">)</span> <span class="o">:</span> <span class="o">((</span><span class="n">x</span> <span class="err">%</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="err">%</span> <span class="n">n</span><span class="o">))</span> <span class="err">%</span> <span class="n">n</span> <span class="bp">=</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span> <span class="err">%</span> <span class="n">n</span> <span class="o">:=</span>
<span class="n">modeq_add</span> <span class="o">(</span><span class="n">mod_modeq</span> <span class="n">x</span> <span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">mod_modeq</span> <span class="n">y</span> <span class="n">n</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">test_ind</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="err">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="n">nat</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">n</span> <span class="n">rfl</span> <span class="err">$</span> <span class="bp">Î»</span> <span class="n">n</span> <span class="n">ih</span><span class="o">,</span>
<span class="k">calc</span> <span class="o">(</span><span class="mi">3</span><span class="err">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="err">%</span> <span class="mi">2</span>
     <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">+</span> <span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="err">%</span> <span class="mi">2</span>               <span class="o">:</span> <span class="k">by</span> <span class="o">{</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow_succ</span><span class="o">,</span> <span class="n">ring</span> <span class="o">}</span>
 <span class="bp">...</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">2</span><span class="bp">*</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">+</span> <span class="o">(</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">))</span> <span class="err">%</span> <span class="mi">2</span>             <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_sub_assoc</span> <span class="o">(</span><span class="n">nat</span><span class="bp">.</span><span class="n">pow_pos</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">)</span> <span class="bp">;</span> <span class="n">norm_num</span>
 <span class="bp">...</span> <span class="bp">=</span> <span class="o">((</span><span class="mi">2</span><span class="bp">*</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="err">%</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">+</span> <span class="o">((</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="err">%</span> <span class="mi">2</span><span class="o">))</span> <span class="err">%</span> <span class="mi">2</span> <span class="o">:</span> <span class="k">by</span> <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_mod</span>
 <span class="bp">...</span> <span class="bp">=</span> <span class="mi">0</span>                                   <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">ih</span><span class="o">]</span>
</pre></div>


<p>Of course this is not really the dream proof. Good automation should take as input only the hint to prove <code>(3^(n+1) - 1) % 2 = ((2*3^n % 2) + ((3^n - 1) % 2)) % 2</code>, prove it automatically, and then take the hint <code>simp [ih]</code>. I'm pretty sure there are proof assistants which can already do that, but this still is a weak point of Lean.</p>



<a name="174153980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174153980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174153980">(Aug 26 2019 at 15:56)</a>:</h4>
<p>In order to get <code>nat.pow_pos</code> you need to import <code>data.nat.basic</code></p>



<a name="174154018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174154018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174154018">(Aug 26 2019 at 15:57)</a>:</h4>
<p>(in my snippet this is imported by transitivity from <code>data.nat.modeq</code>)</p>



<a name="174154367"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174154367" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174154367">(Aug 26 2019 at 16:01)</a>:</h4>
<p>ahh thanks both of your code snippets work on my lean now, ill just have to study them a while, try to get the hang of lean and mathlib</p>



<a name="174154465"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174154465" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174154465">(Aug 26 2019 at 16:02)</a>:</h4>
<p>Did you use the <code>update-mathlib</code> script to make sure you're acting nicely to your computer by having a compiled mathlib?</p>



<a name="174154542"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174154542" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174154542">(Aug 26 2019 at 16:02)</a>:</h4>
<p>i tried to do that and i got the command not found error in bash</p>



<a name="174154686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174154686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174154686">(Aug 26 2019 at 16:04)</a>:</h4>
<p>I should also say that the playground  you chose (easy property of natural numbers) is actually a tricky one. That's because computer are picky about inclusions of sets of numbers. They make it much harder to ignore the fact that <code>â</code> isn't actually contained in <code>â¤</code>. Playing with more abstract objects is actually less frustrating</p>



<a name="174154690"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174154690" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174154690">(Aug 26 2019 at 16:04)</a>:</h4>
<p>What OS are you using?</p>



<a name="174154828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174154828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> John Rowan <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174154828">(Aug 26 2019 at 16:06)</a>:</h4>
<p>windows</p>



<a name="174155049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174155049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174155049">(Aug 26 2019 at 16:09)</a>:</h4>
<p>sigh...</p>



<a name="174155150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174155150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174155150">(Aug 26 2019 at 16:10)</a>:</h4>
<p>Maybe you can find some help in the conversation at <a href="#narrow/stream/113489-new-members/topic/How.20to.20use.20VSCode.20Extension.3F" title="#narrow/stream/113489-new-members/topic/How.20to.20use.20VSCode.20Extension.3F">https://leanprover.zulipchat.com/#narrow/stream/113489-new-members/topic/How.20to.20use.20VSCode.20Extension.3F</a></p>



<a name="174171970"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174171970" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174171970">(Aug 26 2019 at 19:59)</a>:</h4>
<p>For the record, here a nicer proof:</p>
<div class="codehilite"><pre><span></span>import data.nat.parity tactic.norm_num

theorem test_ind (n : nat) : (3^n -1) % 2 = 0 :=
have 3^n â¥ 1, by { apply nat.succ_le_of_lt, apply nat.pow_pos, norm_num },
by { rw [ânat.even_iff], simp * with parity_simps }
</pre></div>


<p>The <code>rw</code> command changes the goal to <code>even (3^n-1)</code>. The simplifier should have been able to show <code>3^n â¥ 1</code>, in which case it would have been an easy one-liner. (The sticking point is that it can't show <code>3 &gt; 0</code>.) In fact, <code>parity_simps</code> should include <code>ânat.even_iff</code>, so the proof <em>should</em> have been <code>simp with parity_simps</code>.</p>



<a name="174186862"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174186862" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174186862">(Aug 27 2019 at 00:21)</a>:</h4>
<p>Can we use this as an opportunity to make <code>simp with parity_simps</code> work?</p>



<a name="174186932"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174186932" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174186932">(Aug 27 2019 at 00:23)</a>:</h4>
<p>Iâm not near a copy of Lean yet, but does <code>@[simp] lemma foo (n k : nat) : (n+1)^k \ge 1 \iff true := sorry</code> handle the first <code>have</code>?</p>



<a name="174188269"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174188269" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174188269">(Aug 27 2019 at 00:54)</a>:</h4>
<p>(Found a copy of Lean) It does work. We should definitely add it. It is so much nicer if crap like this could be solved with <code>simp with parity_simps</code>. And indeed even nicer if <code>simp</code>, or a friend, could look at the goal and realize for itself that it should clearly be using <code>parity_simps</code>.</p>



<a name="174188318"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174188318" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174188318">(Aug 27 2019 at 00:56)</a>:</h4>
<p>Does someone want to do this? Weâd need:</p>



<a name="174188464"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174188464" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174188464">(Aug 27 2019 at 00:59)</a>:</h4>
<p>1. Prove the lemma <code>foo</code> I wrote above, give it a name, and a home in <code>data.nat.basic</code>.<br>
2. In <code>data.nat.parity</code>, add a lemma which is just the reverse of the existing nat.even_iff, and mark it as @[parity_simps].<br>
3. Add an example somewhere <code>example (n : nat) : (3^n - 1) % 2 = 0 := by simp with parity_simps</code> to verify it works.<br>
4. Make your first PR to mathlib. :-)</p>



<a name="174188536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174188536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174188536">(Aug 27 2019 at 01:00)</a>:</h4>
<p><span class="user-mention" data-user-id="236802">@John Rowan</span> , <span class="user-mention" data-user-id="232317">@Ainsley Pahljina</span>, <span class="user-mention" data-user-id="232998">@Eamon Barrett</span>?</p>



<a name="174212079"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174212079" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174212079">(Aug 27 2019 at 09:43)</a>:</h4>
<p>This is all very cute, but would fail with more complicated examples, or the same kind of result with <code>% 3</code> instead of <code>%2</code>. I think we must keep in mind the larger goal of making calculations more convenient, especially with natural numbers. We really need more tactics to escape nat subtraction hell. Note that </p>
<div class="codehilite"><pre><span></span><span class="kn">example</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">â</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span><span class="err">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">-</span> <span class="mi">1</span> <span class="o">:</span> <span class="bp">â¤</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">2</span><span class="bp">*</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">+</span> <span class="o">(</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">ring</span>
</pre></div>


<p>works. So we only need a tactic to turn the nat version into that version, with side conditions like <code>1 &lt;= 3^n</code>Â (and tactics discharging as many such goals as possible). I know Floris has some preliminary work in the direction. This would allow writing the exact same proof we would write on paper.</p>



<a name="174231223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174231223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174231223">(Aug 27 2019 at 13:55)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> I didn't think of the <code>n+1</code> trick. That is a good solution. It will let the simpilfier solve some trivial &lt;= goals.<br>
There is another annoyance with the &lt;= / &gt;= notation:</p>
<div class="codehilite"><pre><span></span>@[simp] lemma foo (n k : nat) : (n+1)^k â¥ 1 â true := sorry

example (n : nat) : 3^n â¥ 1 := by simp

-- fails
example (n : nat) : 1 â¤ 3^n := by simp
</pre></div>


<p>We should probably have the simplifier replace &gt;= by &lt;=. Also, the simplifier doesn't need the "iff true" part.</p>
<div class="codehilite"><pre><span></span>@[simp] lemma bar (m n : nat) : m â¥ n â n â¤ m :=
iff.rfl

@[simp] lemma foo (n k : nat) : 1 â¤ (n+1)^k :=
by { apply nat.succ_le_of_lt, apply nat.pow_pos, apply nat.succ_pos }

example (n : nat) : 3^n â¥ 1 := by simp

example (n : nat) : 1 â¤ 3^n := by simp
</pre></div>


<p>Also, we should probably have the corresponding theorems for the version of <code>pow</code> in <code>algebra.group_power</code>.</p>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> The point is well taken. We need better support for calculation on <code>nat</code>.</p>



<a name="174241534"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174241534" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174241534">(Aug 27 2019 at 15:44)</a>:</h4>
<p>Agreed, <code>gt_iff_lt</code> and <code>ge_iff_le</code> should become simp lemmas.</p>



<a name="174244063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174244063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174244063">(Aug 27 2019 at 16:09)</a>:</h4>
<p>Patrick Massot referred to some preliminary code I wrote for this. The idea (that Patrick had) is to move the problem to <code>int</code> and then use <code>ring</code>. The code is below. I use a limited list of simp lemmas to push all casts inside the expression. Does <code>norm_cast</code> provide a tactic/simp-set to do this? I tried to make a simp set from the <code>move_cast</code> cache, or from all <code>move_cast</code> instances, and neither really moves all casts inside.</p>



<a name="174244077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174244077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174244077">(Aug 27 2019 at 16:09)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">ring</span>
<span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">nat</span><span class="bp">.</span><span class="n">modeq</span>

<span class="kn">section</span>
<span class="n">local</span> <span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">,</span> <span class="n">priority</span> <span class="mi">0</span><span class="o">]</span> <span class="n">int</span><span class="bp">.</span><span class="n">has_coe</span>
<span class="n">local</span> <span class="n">attribute</span> <span class="o">[</span><span class="kn">instance</span><span class="o">,</span> <span class="n">priority</span> <span class="mi">99</span><span class="o">]</span> <span class="n">nat</span><span class="bp">.</span><span class="n">cast_coe</span>
<span class="kn">theorem</span> <span class="n">int</span><span class="bp">.</span><span class="n">nat_cast_mod</span> <span class="o">{</span><span class="n">m</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">â</span><span class="o">}</span> <span class="o">:</span> <span class="o">((</span><span class="n">m</span> <span class="err">%</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">â</span><span class="o">)</span> <span class="o">:</span> <span class="bp">â¤</span><span class="o">)</span> <span class="bp">=</span> <span class="o">(</span><span class="n">m</span> <span class="o">:</span> <span class="bp">â¤</span><span class="o">)</span> <span class="err">%</span> <span class="n">n</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp</span>
<span class="kn">end</span>

<span class="kn">lemma</span> <span class="n">int</span><span class="bp">.</span><span class="n">add_mod</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">n</span> <span class="o">:</span> <span class="bp">â¤</span><span class="o">)</span> <span class="o">:</span> <span class="o">((</span><span class="n">x</span> <span class="err">%</span> <span class="n">n</span><span class="o">)</span> <span class="bp">+</span> <span class="o">(</span><span class="n">y</span> <span class="err">%</span> <span class="n">n</span><span class="o">))</span> <span class="err">%</span> <span class="n">n</span> <span class="bp">=</span> <span class="o">(</span><span class="n">x</span> <span class="bp">+</span> <span class="n">y</span><span class="o">)</span> <span class="err">%</span> <span class="n">n</span> <span class="o">:=</span>
<span class="n">sorry</span>

<span class="kn">open</span> <span class="n">tactic</span> <span class="n">interactive</span>
<span class="n">meta</span> <span class="n">def</span> <span class="n">my_simp_list</span> <span class="o">:</span> <span class="n">tactic</span> <span class="o">(</span><span class="n">list</span> <span class="n">simp_arg_type</span><span class="o">)</span> <span class="o">:=</span>
<span class="o">[</span><span class="bp">`</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_bit0</span><span class="o">,</span> <span class="bp">`</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_bit1</span><span class="o">,</span> <span class="bp">`</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_add</span><span class="o">,</span> <span class="bp">`</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_one</span><span class="o">,</span> <span class="bp">`</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_mul</span><span class="o">,</span>
  <span class="bp">`</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_pow</span><span class="o">,</span> <span class="bp">`</span><span class="n">int</span><span class="bp">.</span><span class="n">nat_cast_mod</span><span class="o">,</span> <span class="bp">`</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_zero</span><span class="o">]</span><span class="bp">.</span><span class="n">mmap</span> <span class="err">$</span> <span class="bp">Î»</span> <span class="n">n</span><span class="o">,</span> <span class="n">simp_arg_type</span><span class="bp">.</span><span class="n">expr</span> <span class="bp">&lt;</span><span class="err">$</span><span class="bp">&gt;</span> <span class="n">pexpr</span><span class="bp">.</span><span class="n">of_expr</span> <span class="bp">&lt;</span><span class="err">$</span><span class="bp">&gt;</span> <span class="n">mk_const</span> <span class="n">n</span>

<span class="n">meta</span> <span class="n">def</span> <span class="n">move_to_int</span> <span class="o">:</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">do</span> <span class="n">apply</span> <span class="bp">`</span><span class="o">(</span><span class="bp">@</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_injective</span> <span class="bp">â¤</span> <span class="bp">_</span> <span class="bp">_</span><span class="o">),</span>
  <span class="n">repeat</span>
    <span class="o">(</span><span class="n">my_simp_list</span> <span class="bp">&gt;&gt;=</span> <span class="bp">Î»</span> <span class="n">l</span><span class="o">,</span> <span class="n">interactive</span><span class="bp">.</span><span class="n">simp</span> <span class="n">none</span> <span class="n">tt</span> <span class="n">l</span> <span class="o">[]</span> <span class="o">(</span><span class="n">loc</span><span class="bp">.</span><span class="n">ns</span> <span class="o">[</span><span class="n">none</span><span class="o">])</span> <span class="bp">&gt;&gt;</span> <span class="n">repeat</span> <span class="o">(</span><span class="n">mk_const</span> <span class="bp">`</span><span class="n">nat</span><span class="bp">.</span><span class="n">cast_sub</span> <span class="bp">&gt;&gt;=</span> <span class="n">rewrite_target</span><span class="o">))</span>


<span class="kn">theorem</span> <span class="n">test_ind</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">nat</span><span class="o">)</span> <span class="o">:</span> <span class="o">(</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span><span class="mi">1</span><span class="o">)</span> <span class="err">%</span> <span class="mi">2</span> <span class="bp">=</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">move_to_int</span><span class="o">,</span>
  <span class="n">induction</span> <span class="n">n</span> <span class="k">with</span> <span class="n">n</span> <span class="n">ih</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">exact</span> <span class="k">calc</span> <span class="o">((</span><span class="mi">3</span><span class="o">:</span><span class="bp">â¤</span><span class="o">)</span><span class="err">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="err">%</span> <span class="mi">2</span>
      <span class="bp">=</span> <span class="o">((</span><span class="mi">2</span><span class="bp">*</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="err">%</span> <span class="mi">2</span><span class="o">)</span> <span class="bp">+</span> <span class="o">((</span><span class="mi">3</span><span class="err">^</span><span class="n">n</span> <span class="bp">-</span> <span class="mi">1</span><span class="o">)</span> <span class="err">%</span> <span class="mi">2</span><span class="o">))</span> <span class="err">%</span> <span class="mi">2</span> <span class="o">:</span> <span class="k">by</span> <span class="o">{</span> <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">int</span><span class="bp">.</span><span class="n">add_mod</span><span class="o">],</span> <span class="n">ring</span> <span class="o">}</span>
  <span class="bp">...</span> <span class="bp">=</span> <span class="o">(</span><span class="mi">0</span><span class="o">:</span><span class="bp">â¤</span><span class="o">)</span>    <span class="o">:</span> <span class="k">by</span> <span class="n">simp</span> <span class="o">[</span><span class="bp">-</span><span class="n">sub_eq_add_neg</span><span class="o">,</span> <span class="n">ih</span><span class="o">]</span> <span class="o">},</span>
  <span class="n">apply</span> <span class="n">nat</span><span class="bp">.</span><span class="n">succ_le_of_lt</span><span class="o">,</span> <span class="n">apply</span> <span class="n">nat</span><span class="bp">.</span><span class="n">pow_pos</span><span class="o">,</span> <span class="n">norm_num</span>
<span class="kn">end</span>
</pre></div>



<a name="174244314"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174244314" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174244314">(Aug 27 2019 at 16:11)</a>:</h4>
<p>There are two instances of <code>has_coe nat int</code>. The one which we use everywhere is <code>int.has_coe</code>instead of the more general <code>nat.cast_coe</code>. Is the reason for this for performance? Because otherwise it would be nicer to always use the general coercion (now we have to prove all coercion-lemmas twice).</p>



<a name="174267816"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174267816" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174267816">(Aug 27 2019 at 20:24)</a>:</h4>
<p>Two reasons: (1) It's faster: it is O(1) where the general cast is exponential; (2) it is forced on us by core - <code>int.has_coe</code> is declared in core and you get it whenever you write the <code>\u</code> without additional adornment. Thinking about it now, we should be able to solve this with a priority setting.</p>



<a name="174368549"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174368549" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174368549">(Aug 28 2019 at 14:38)</a>:</h4>
<p>Yes, I was thinking about a priority setting (and reordering <code>nat_cast_eq_coe_nat</code>). When you say it is faster, do you mean computation in the VM or type-class inference search? If it's computation in the VM then we should keep the status quo. Proving all lemmas twice isn't that bad.</p>



<a name="174383864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/174383864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#174383864">(Aug 28 2019 at 17:25)</a>:</h4>
<p>it is a faster function for the VM</p>



<a name="175213453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/175213453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#175213453">(Sep 09 2019 at 04:21)</a>:</h4>
<blockquote>
<p>We should probably have the simplifier replace &gt;= by &lt;=.</p>
</blockquote>
<p><span class="user-mention" data-user-id="110865">@Jeremy Avigad</span>, I just made <a href="https://github.com/leanprover-community/mathlib/issues/1418" target="_blank" title="https://github.com/leanprover-community/mathlib/issues/1418">#1418</a>, which does this. I think it will open the way to making <code>simp</code> much stronger at inequalities.</p>



<a name="175248545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/lean%20solver/near/175248545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/lean.20solver.html#175248545">(Sep 09 2019 at 14:49)</a>:</h4>
<p>Thanks for doing that. I think it is the right way to go. I'll merge in a day or two if nobody objects.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>