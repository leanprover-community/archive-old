---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html">dfinsupp vs finsupp implementation</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="215322547"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dfinsupp%20vs%20finsupp%20implementation/near/215322547" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html#215322547">(Nov 02 2020 at 14:09)</a>:</h4>
<p>Does anyone know why <code>dfinsupp</code> is implemented as a quotient over a struct with a multiset but <code>finsupp</code> uses a <code>finset</code>? Did they originally use the same implementation at some point in the past? It would be great to capture the reason in an "implementation notes" section</p>



<a name="215356100"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dfinsupp%20vs%20finsupp%20implementation/near/215356100" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html#215356100">(Nov 02 2020 at 18:05)</a>:</h4>
<p>Nothing more than the tastes of the people who defined them I think. It shouldn't make much difference because the implementation should be invisible. They never used the same implementation, <code>finsupp</code> came first and had to be generalised.</p>



<a name="215407101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dfinsupp%20vs%20finsupp%20implementation/near/215407101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html#215407101">(Nov 03 2020 at 02:32)</a>:</h4>
<p>With the quotient you don't need <code>decidable_eq</code> in many cases.</p>



<a name="215407257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dfinsupp%20vs%20finsupp%20implementation/near/215407257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html#215407257">(Nov 03 2020 at 02:35)</a>:</h4>
<p>BTW, it is possible to define <code>dfinsupp</code> without any <code>finset</code>s as the quotient of <code>free_add_monoid (Σ i, β i)</code> by the <a href="https://leanprover-community.github.io/mathlib_docs/find/add_con">docs#add_con</a> <code>Inf {c | (∀ (i : α) (b₁ b₂ : β i), c [⟨i, b₁⟩, ⟨i, b₂⟩] [⟨i, b₁ + b₂⟩]) ∧ ∀ i, c [⟨i, 0⟩] 0}</code></p>



<a name="215407303"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dfinsupp%20vs%20finsupp%20implementation/near/215407303" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html#215407303">(Nov 03 2020 at 02:36)</a>:</h4>
<p>This way we get the universal property for free.</p>



<a name="215431177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dfinsupp%20vs%20finsupp%20implementation/near/215431177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html#215431177">(Nov 03 2020 at 09:50)</a>:</h4>
<p>Right, I thought this might be motivated by decidable equality</p>



<a name="290248507"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/dfinsupp%20vs%20finsupp%20implementation/near/290248507" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/dfinsupp.20vs.20finsupp.20implementation.html#290248507">(Jul 20 2022 at 15:10)</a>:</h4>
<p>I added some implementation notes about this in <a href="https://github.com/leanprover-community/mathlib/pull/15554">#15554</a> (although the definition has changed slightly since this thread was created)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>