---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html">`finite_dimensional` dependency cleanup</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="309257526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309257526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309257526">(Nov 11 2022 at 20:35)</a>:</h4>
<p>I think we're better off thinking that "X is incomparable to Y" is the default answer, rather than trying to decide whether "X is more basic than Y" or vice versa.</p>



<a name="309257545"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309257545" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309257545">(Nov 11 2022 at 20:35)</a>:</h4>
<p>This requires making new files more often, of course.</p>



<a name="309257943"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309257943" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309257943">(Nov 11 2022 at 20:39)</a>:</h4>
<p>Regarding Mario's suggestion: it would be amazing to have a flag for <code>leanproject import-graph</code> that did this! i.e. highlights all files whose theorems are not used in any of the theorems in the <code>--to</code> target. Of course this isn't something you can do from python.</p>



<a name="309258346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309258346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309258346">(Nov 11 2022 at 20:43)</a>:</h4>
<p>does leanproject have the setup to run custom lean programs? It wouldn't be too hard to write a lean program that calculates this set and spits the result on standard out</p>



<a name="309258561"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309258561" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309258561">(Nov 11 2022 at 20:45)</a>:</h4>
<p><span class="user-mention" data-user-id="238446">@Anne Baanen</span>, I've merged your two PRs mentioned above. Great start!</p>



<a name="309258949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309258949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309258949">(Nov 11 2022 at 20:49)</a>:</h4>
<p>I don't think leanproject currently runs Lean programs (besides of course leanpkg) but I don't see why not. It already processes yaml files for the port status.</p>



<a name="309260381"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309260381" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309260381">(Nov 11 2022 at 21:05)</a>:</h4>
<p>It also runs lean to list declarations.</p>



<a name="309260419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309260419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309260419">(Nov 11 2022 at 21:05)</a>:</h4>
<p>See <a href="https://github.com/leanprover-community/mathlib-tools/blob/master/mathlibtools/decls.lean">https://github.com/leanprover-community/mathlib-tools/blob/master/mathlibtools/decls.lean</a></p>



<a name="309260482"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309260482" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309260482">(Nov 11 2022 at 21:06)</a>:</h4>
<p>and <a href="https://github.com/leanprover-community/mathlib-tools/blob/master/mathlibtools/lib.py#L898">https://github.com/leanprover-community/mathlib-tools/blob/master/mathlibtools/lib.py#L898</a></p>



<a name="309261578"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309261578" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309261578">(Nov 11 2022 at 21:17)</a>:</h4>
<p>Here's a lean program that does the core functionality:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">meta</span> <span class="kd">def</span> <span class="n">tactic.get_decls_used</span> <span class="o">(</span><span class="n">env</span> <span class="o">:</span> <span class="n">environment</span><span class="o">)</span> <span class="o">:</span> <span class="n">name</span> <span class="bp">→</span> <span class="n">name_set</span> <span class="bp">→</span> <span class="n">tactic</span> <span class="n">name_set</span>
<span class="bp">|</span> <span class="n">n</span> <span class="n">ns</span> <span class="o">:=</span> <span class="k">if</span> <span class="n">ns.contains</span> <span class="n">n</span> <span class="k">then</span> <span class="n">pure</span> <span class="n">ns</span> <span class="k">else</span> <span class="k">do</span>
  <span class="n">d</span> <span class="bp">←</span> <span class="n">env.get</span> <span class="n">n</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">ns</span> <span class="o">:=</span> <span class="n">ns.insert</span> <span class="n">n</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">process</span> <span class="o">(</span><span class="n">v</span> <span class="o">:</span> <span class="n">expr</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="o">(</span><span class="n">name_set</span><span class="o">)</span> <span class="o">:=</span>
    <span class="n">v.fold</span> <span class="o">(</span><span class="n">pure</span> <span class="n">ns</span><span class="o">)</span> <span class="bp">$</span> <span class="bp">λ</span> <span class="n">e</span> <span class="n">_</span> <span class="n">r</span><span class="o">,</span> <span class="n">r</span> <span class="bp">&gt;&gt;=</span> <span class="bp">λ</span> <span class="n">ns</span><span class="o">,</span>
      <span class="k">if</span> <span class="n">e.is_constant</span> <span class="k">then</span> <span class="n">tactic.get_decls_used</span> <span class="n">e.const_name</span> <span class="n">ns</span> <span class="k">else</span> <span class="n">pure</span> <span class="n">ns</span><span class="o">,</span>
  <span class="k">match</span> <span class="n">d</span> <span class="k">with</span>
  <span class="bp">|</span> <span class="o">(</span><span class="n">declaration.defn</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">v</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span> <span class="o">:=</span> <span class="n">process</span> <span class="n">v</span>
  <span class="bp">|</span> <span class="o">(</span><span class="n">declaration.thm</span> <span class="n">_</span> <span class="n">_</span> <span class="n">_</span> <span class="n">v</span><span class="o">)</span>      <span class="o">:=</span> <span class="n">process</span> <span class="n">v.get</span>
  <span class="bp">|</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">pure</span> <span class="n">ns</span>
  <span class="kd">end</span>

<span class="kd">meta</span> <span class="kd">def</span> <span class="n">tactic.get_modules_used_by_theorems_in</span> <span class="o">(</span><span class="n">tgt</span> <span class="o">:</span> <span class="n">string</span><span class="o">)</span> <span class="o">:</span> <span class="n">tactic</span> <span class="o">(</span><span class="n">list</span> <span class="n">string</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">do</span> <span class="n">env</span> <span class="bp">←</span> <span class="n">tactic.get_env</span><span class="o">,</span>
  <span class="n">ns</span> <span class="bp">←</span> <span class="n">env.fold</span> <span class="o">(</span><span class="n">pure</span> <span class="n">mk_name_set</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">d</span> <span class="n">r</span><span class="o">,</span>
    <span class="k">if</span> <span class="n">env.decl_olean</span> <span class="n">d.to_name</span> <span class="bp">=</span> <span class="n">some</span> <span class="n">tgt</span> <span class="k">then</span>
      <span class="n">r</span> <span class="bp">&gt;&gt;=</span> <span class="n">tactic.get_decls_used</span> <span class="n">env</span> <span class="n">d.to_name</span>
    <span class="k">else</span> <span class="n">r</span><span class="o">),</span>
  <span class="k">let</span> <span class="n">mods</span> <span class="o">:=</span> <span class="n">ns.fold</span> <span class="n">native.mk_rb_set</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">n</span> <span class="n">mods</span><span class="o">,</span>
    <span class="k">match</span> <span class="n">env.decl_olean</span> <span class="n">n</span> <span class="k">with</span>
    <span class="bp">|</span> <span class="n">some</span> <span class="n">mod</span> <span class="o">:=</span> <span class="n">mods.insert</span> <span class="n">mod</span>
    <span class="bp">|</span> <span class="n">none</span> <span class="o">:=</span> <span class="n">mods</span>
    <span class="kd">end</span><span class="o">),</span>
  <span class="n">pure</span> <span class="n">mods.to_list</span>

<span class="kd">run_cmd</span> <span class="k">do</span>
  <span class="k">let</span> <span class="n">tgt'</span> <span class="o">:=</span> <span class="bp">`</span><span class="n">init.data.int.bitwise</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">tgt</span> <span class="o">:=</span> <span class="n">module_info.resolve_module_name</span> <span class="n">tgt'</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">home_len</span> <span class="o">:=</span> <span class="n">tgt.length</span> <span class="bp">-</span> <span class="o">(</span><span class="n">tgt'.to_string.length</span> <span class="bp">+</span> <span class="mi">5</span><span class="o">),</span>
  <span class="n">files</span> <span class="bp">←</span> <span class="n">tactic.get_modules_used_by_theorems_in</span> <span class="n">tgt</span><span class="o">,</span>
  <span class="n">tactic.trace</span> <span class="bp">$</span> <span class="n">files.map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">s</span><span class="o">,</span> <span class="o">(</span><span class="n">s.mk_iterator.nextn</span> <span class="n">home_len</span><span class="o">)</span><span class="bp">.</span><span class="n">next_to_string</span><span class="o">)</span>
<span class="c1">-- [init/wf.lean,</span>
<span class="c1">--  init/util.lean,</span>
<span class="c1">--  init/propext.lean,</span>
<span class="c1">--  init/meta/simp_tactic.lean,</span>
<span class="c1">--  init/meta/rewrite_tactic.lean,</span>
<span class="c1">--  init/meta/interactive.lean,</span>
<span class="c1">--  init/logic.lean,</span>
<span class="c1">--  init/data/nat/lemmas.lean,</span>
<span class="c1">--  init/data/nat/div.lean,</span>
<span class="c1">--  init/data/nat/bitwise.lean,</span>
<span class="c1">--  init/data/nat/basic.lean,</span>
<span class="c1">--  init/data/int/bitwise.lean,</span>
<span class="c1">--  init/data/int/basic.lean,</span>
<span class="c1">--  init/data/bool/basic.lean,</span>
<span class="c1">--  init/core.lean,</span>
<span class="c1">--  init/coe.lean,</span>
<span class="c1">--  init/algebra/order.lean]</span>
</code></pre></div>
<p>This prints all modules that contain theorems that are transitively used by some theorem in <code>init.data.int.bitwise</code>. A drawback of this implementation is that the modules are identified by file names because the file name -&gt; module name mapping is not stored, and the list of all modules is not exposed by lean 3 AFAICT</p>



<a name="309268920"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309268920" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309268920">(Nov 11 2022 at 22:34)</a>:</h4>
<p>Okay, I'll see if I can hook this up to <code>import-graph</code> later.</p>



<a name="309269015"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309269015" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309269015">(Nov 11 2022 at 22:35)</a>:</h4>
<p>Also, regarding the <code>finite_dimensional</code> dependency cleanup (or dependency cleanups generally) --- I am <em>extremely</em> sympathetic to people frustrated by delays in CI and PR reviewing when doing refactoring, so please feel free to PM me to ask for a <code>bors d+</code> on dependency refactoring PRs, even before CI finishes. I don't want these to languish on the <a href="https://bit.ly/3AZk1Qk">#queue</a>.</p>



<a name="309270051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309270051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309270051">(Nov 11 2022 at 22:48)</a>:</h4>
<p>I loaded up <code>borel_cantelli</code> and ran the code on Johan's list:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="bp">*</span> <span class="n">data.rbtree.init</span>
<span class="bp">*</span> <span class="n">data.rbmap.basic</span>
  <span class="n">data.list.defs</span>
<span class="bp">*</span> <span class="n">data.string.defs</span>
<span class="bp">*</span> <span class="kd">meta</span><span class="bp">.</span><span class="n">expr</span>
<span class="bp">*</span> <span class="n">tactic.binder_matching</span>
<span class="bp">*</span> <span class="n">tactic.core</span>
<span class="bp">*</span> <span class="n">tactic.algebra</span>
<span class="bp">*</span> <span class="n">tactic.to_additive</span>
<span class="bp">*</span> <span class="n">tactic.lint.default</span>
<span class="bp">*</span> <span class="n">tactic.interactive</span>
<span class="bp">*</span> <span class="n">tactic.hint</span>
  <span class="n">tactic.norm_cast</span>
<span class="bp">*</span> <span class="n">tactic.tidy</span>
<span class="bp">*</span> <span class="n">tactic.obviously</span>
<span class="bp">*</span> <span class="n">tactic.basic</span>
  <span class="n">logic.unique</span>
  <span class="n">logic.equiv.defs</span>
  <span class="n">order.synonym</span>
  <span class="n">order.compare</span>
  <span class="n">order.monotone</span>
  <span class="n">order.lattice</span>
  <span class="n">order.bounded_order</span>
  <span class="n">order.heyting.basic</span>
  <span class="n">order.boolean_algebra</span>
<span class="bp">*</span> <span class="n">order.symm_diff</span>
  <span class="n">data.set.basic</span>
  <span class="n">data.set.prod</span>
  <span class="n">data.set.function</span>
  <span class="n">logic.equiv.set</span>
<span class="bp">*</span> <span class="n">order.rel_iso</span>
  <span class="n">order.hom.basic</span>
  <span class="n">algebra.order.group.defs</span>
<span class="bp">*</span> <span class="n">algebra.order.group.type_tags</span>
  <span class="n">algebra.order.with_zero</span>
<span class="bp">*</span> <span class="n">data.nat.order</span>
  <span class="n">algebra.group_power.ring</span>
  <span class="n">algebra.group_power.order</span>
  <span class="n">data.nat.pow</span>
  <span class="n">algebra.group_power.lemmas</span>
<span class="bp">*</span> <span class="n">algebra.group_power.default</span>
  <span class="n">data.list.big_operators</span>
  <span class="n">data.list.count</span>
  <span class="n">data.list.pairwise</span>
  <span class="n">data.list.chain</span>
  <span class="n">data.list.range</span>
  <span class="n">data.list.perm</span>
  <span class="n">data.multiset.basic</span>
  <span class="n">algebra.big_operators.multiset</span>
  <span class="n">data.multiset.bind</span>
<span class="bp">*</span> <span class="n">data.multiset.powerset</span>
  <span class="n">data.multiset.nodup</span>
  <span class="n">data.multiset.dedup</span>
  <span class="n">data.multiset.finset_ops</span>
  <span class="n">data.finset.basic</span>
  <span class="n">data.finset.card</span>
  <span class="n">data.finset.option</span>
  <span class="n">data.finset.lattice</span>
<span class="bp">*</span> <span class="n">data.finset.powerset</span>
  <span class="n">data.fintype.basic</span>
  <span class="n">algebra.char_zero</span>
  <span class="n">data.int.char_zero</span>
  <span class="n">data.rat.cast</span>
  <span class="n">tactic.norm_num</span>
  <span class="n">tactic.abel</span>
  <span class="n">algebra.module.basic</span>
  <span class="n">data.set.pointwise.basic</span>
<span class="bp">*</span> <span class="n">group_theory.submonoid.pointwise</span>
  <span class="n">group_theory.subgroup.basic</span>
<span class="bp">*</span> <span class="n">ring_theory.subring.basic</span>
<span class="bp">*</span> <span class="n">algebra.group_ring_action</span>
  <span class="n">algebra.ring.aut</span>
  <span class="n">algebra.star.basic</span>
  <span class="n">algebra.module.linear_map</span>
  <span class="n">algebra.module.equiv</span>
  <span class="n">algebra.module.submodule.basic</span>
  <span class="n">algebra.module.submodule.lattice</span>
  <span class="n">linear_algebra.basic</span>
  <span class="n">linear_algebra.span</span>
  <span class="n">algebra.algebra.basic</span>
  <span class="n">linear_algebra.prod</span>
  <span class="n">linear_algebra.linear_independent</span>
  <span class="n">linear_algebra.basis</span>
  <span class="n">linear_algebra.bilinear_map</span>
<span class="bp">*</span> <span class="n">algebra.module.submodule.bilinear</span>
<span class="bp">*</span> <span class="n">linear_algebra.tensor_product</span>
  <span class="n">algebra.algebra.bilinear</span>
<span class="bp">*</span> <span class="n">algebra.algebra.operations</span>
<span class="bp">*</span> <span class="n">ring_theory.ideal.operations</span>
<span class="bp">*</span> <span class="n">algebra.algebra.subalgebra.basic</span>
  <span class="n">algebra.algebra.tower</span>
<span class="bp">*</span> <span class="n">ring_theory.adjoin.basic</span>
<span class="bp">*</span> <span class="n">data.mv_polynomial.basic</span>
<span class="bp">*</span> <span class="n">data.mv_polynomial.rename</span>
<span class="bp">*</span> <span class="n">data.mv_polynomial.monad</span>
<span class="bp">*</span> <span class="n">data.mv_polynomial.variables</span>
<span class="bp">*</span> <span class="n">data.mv_polynomial.equiv</span>
<span class="bp">*</span> <span class="n">ring_theory.polynomial.basic</span>
<span class="bp">*</span> <span class="n">ring_theory.adjoin.fg</span>
<span class="bp">*</span> <span class="n">ring_theory.algebra_tower</span>
  <span class="n">ring_theory.finiteness</span>
  <span class="n">field_theory.finiteness</span>
  <span class="n">linear_algebra.finite_dimensional</span>
<span class="bp">*</span> <span class="n">linear_algebra.matrix.finite_dimensional</span>
<span class="bp">*</span> <span class="n">linear_algebra.matrix.to_lin</span>
<span class="bp">*</span> <span class="n">linear_algebra.matrix.basis</span>
<span class="bp">*</span> <span class="n">linear_algebra.determinant</span>
  <span class="n">topology.algebra.module.basic</span>
  <span class="n">analysis.normed.field.basic</span>
  <span class="n">analysis.normed_space.basic</span>
<span class="bp">*</span> <span class="n">analysis.normed.order.basic</span>
  <span class="n">analysis.locally_convex.basic</span>
  <span class="n">analysis.locally_convex.balanced_core_hull</span>
  <span class="n">topology.algebra.module.finite_dimension</span>
  <span class="n">analysis.convex.topology</span>
<span class="bp">*</span> <span class="n">topology.algebra.module.locally_convex</span>
  <span class="n">analysis.seminorm</span>
  <span class="n">analysis.locally_convex.bounded</span>
  <span class="n">topology.algebra.uniform_convergence</span>
  <span class="n">topology.algebra.module.strong_topology</span>
  <span class="n">analysis.normed_space.operator_norm</span>
  <span class="n">analysis.normed_space.multilinear</span>
  <span class="n">analysis.normed_space.bounded_linear_maps</span>
  <span class="n">analysis.calculus.fderiv</span>
  <span class="n">analysis.calculus.deriv</span>
  <span class="n">analysis.calculus.local_extr</span>
  <span class="n">analysis.calculus.mean_value</span>
  <span class="n">analysis.calculus.cont_diff</span>
  <span class="n">analysis.complex.real_deriv</span>
  <span class="n">analysis.special_functions.exp_deriv</span>
  <span class="n">analysis.special_functions.log.deriv</span>
  <span class="n">analysis.special_functions.pow_deriv</span>
  <span class="n">analysis.convex.specific_functions</span>
<span class="bp">*</span> <span class="n">analysis.special_functions.trigonometric.complex</span>
<span class="bp">*</span> <span class="n">analysis.special_functions.trigonometric.arctan</span>
  <span class="n">measure_theory.function.special_functions</span>
  <span class="n">measure_theory.integral.mean_inequalities</span>
  <span class="n">measure_theory.function.simple_func_dense</span>
  <span class="n">measure_theory.function.strongly_measurable</span>
  <span class="n">measure_theory.function.ae_eq_fun</span>
  <span class="n">measure_theory.function.lp_space</span>
  <span class="n">measure_theory.function.lp_order</span>
  <span class="n">measure_theory.function.l1_space</span>
  <span class="n">measure_theory.function.simple_func_dense_lp</span>
  <span class="n">measure_theory.integral.set_to_l1</span>
  <span class="n">measure_theory.integral.bochner</span>
  <span class="n">measure_theory.integral.set_integral</span>
  <span class="n">measure_theory.function.ae_eq_of_integral</span>
<span class="bp">*</span> <span class="n">measure_theory.measure.with_density_vector_measure</span>
<span class="bp">*</span> <span class="n">measure_theory.decomposition.lebesgue</span>
<span class="bp">*</span> <span class="n">measure_theory.decomposition.radon_nikodym</span>
  <span class="n">measure_theory.function.conditional_expectation.basic</span>
  <span class="n">measure_theory.function.conditional_expectation.indicator</span>
  <span class="n">measure_theory.function.conditional_expectation.real</span>
  <span class="n">probability.process.filtration</span>
  <span class="n">probability.process.adapted</span>
  <span class="n">probability.process.stopping</span>
  <span class="n">probability.process.hitting_time</span>
  <span class="n">probability.martingale.basic</span>
  <span class="n">probability.martingale.upcrossing</span>
  <span class="n">probability.martingale.convergence</span>
  <span class="n">probability.martingale.borel_cantelli</span>
  <span class="n">probability.borel_cantelli</span>
</code></pre></div>



<a name="309270257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309270257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309270257">(Nov 11 2022 at 22:51)</a>:</h4>
<p>The ones marked with a <code>*</code> contain no theorems transitively referenced by stuff in <code>borel_cantelli</code>. There are 49 unused modules listed out of a total 163</p>



<a name="309270864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309270864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309270864">(Nov 11 2022 at 22:57)</a>:</h4>
<p>So the suspicious modules are the unstarred ones coming right after a starred group, like <code>measure_theory.decomposition.radon_nikodym -&gt; measure_theory.function.conditional_expectation.basic</code></p>



<a name="309271158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309271158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309271158">(Nov 11 2022 at 23:00)</a>:</h4>
<p><code>algebra.group_power.default</code> is a false positive given that it contains <em>no</em> theorem.</p>



<a name="309271205"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309271205" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309271205">(Nov 11 2022 at 23:00)</a>:</h4>
<p>yes, <code>*.default</code> and <code>tactic.*</code> modules are generally false positives</p>



<a name="309271252"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309271252" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309271252">(Nov 11 2022 at 23:01)</a>:</h4>
<p>On the other hand, we increasingly rarely use <code>.default</code> files, and perhaps should plan to use them even less.</p>



<a name="309271272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309271272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309271272">(Nov 11 2022 at 23:01)</a>:</h4>
<p><code>group_theory.subgroup.basic</code> can easily be made not to import <code>group_theory.submonoid.pointwise</code>. I can do that.</p>



<a name="309271299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309271299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309271299">(Nov 11 2022 at 23:01)</a>:</h4>
<p>the whole <code>mv_polynomial</code> import looks pretty suspicious</p>



<a name="309271333"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309271333" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309271333">(Nov 11 2022 at 23:02)</a>:</h4>
<p>Anne is working on that.</p>



<a name="309271357"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309271357" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309271357">(Nov 11 2022 at 23:02)</a>:</h4>
<p>(This thread!)</p>



<a name="309272059"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309272059" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309272059">(Nov 11 2022 at 23:10)</a>:</h4>
<p>While I'm at it, let me say that <a href="https://tqft.net/mathlib/algebra/algebra/basic">file#algebra/algebra/basic</a> introduces unnecessary imports in many places.</p>



<a name="309272096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309272096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309272096">(Nov 11 2022 at 23:11)</a>:</h4>
<p>I added some more info to the list above: the ones marked with <code>-</code> are used by <code>borel_cantelli</code> but not used by anything in <code>analysis.calculus.mean_value</code>, another nice endpoint theorem about 2/3 of the way down</p>



<a name="309273193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309273193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309273193">(Nov 11 2022 at 23:25)</a>:</h4>
<p>This is not all dodgy imports, right? Only those that are on the longest path.</p>



<a name="309273433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309273433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309273433">(Nov 11 2022 at 23:29)</a>:</h4>
<p>yes</p>



<a name="309273610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309273610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309273610">(Nov 11 2022 at 23:30)</a>:</h4>
<p>it's a bit harder to visualize if it's not a path... here you know that each thing in the list directly imports the previous one so it's easier to pinpoint the dodgy import</p>



<a name="309274344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309274344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309274344">(Nov 11 2022 at 23:41)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/17491">#17491</a> for <code>data.set.pointwise → group_theory.group_action.basic</code></p>



<a name="309283161"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309283161" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309283161">(Nov 12 2022 at 01:59)</a>:</h4>
<p>Jason was at Xena and he seemed very proud to have made the deepest part of mathlib</p>



<a name="309283622"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309283622" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309283622">(Nov 12 2022 at 02:06)</a>:</h4>
<p>A slightly dubious honour. :-)</p>



<a name="309899287"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/%60finite_dimensional%60%20dependency%20cleanup/near/309899287" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/.60finite_dimensional.60.20dependency.20cleanup.html#309899287">(Nov 14 2022 at 16:28)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/17541">#17541</a> flips the import order between <code>ring_theory.noetherian</code> and <code>ring_theory.finiteness</code> by moving <code>submodule.fg</code> and <code>ideal.fg</code> to <code>finiteness</code>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>