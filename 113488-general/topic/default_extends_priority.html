---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/default_extends_priority.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/default_extends_priority.html">default_extends_priority</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="206814398"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/default_extends_priority/near/206814398" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/default_extends_priority.html#206814398">(Aug 13 2020 at 13:29)</a>:</h4>
<p>Various instances like <code>ring_hom.monoid : monoid (α →+* α)</code> have the wrong priority (100) because they are defined in files with <code>set_option default_priority 100</code> at the top and don't specifically override the priority back to 1000.<br>
Rather than go through and try to fix these all or add a linter to try to catch it, what if we add an option to Lean controlling the default priority used for instances generated by <code>extends</code>, since this seems to be the main usage of setting <code>default_priority</code>?</p>



<a name="206814736"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/default_extends_priority/near/206814736" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/default_extends_priority.html#206814736">(Aug 13 2020 at 13:32)</a>:</h4>
<p>These instances having the wrong priority is not such a big deal, but it partially defeats the purpose of lowering the instance priority of overlapping instances in the first place.<br>
But the bigger reason for the change would be to reduce the amount of priority-related noise and especially to avoid semi-global effects like <code>set_option default_priority</code>--the remaining cases where a lowered priority is needed can be handled on a per-<code>instance</code> basis using <code>@[priority 100] instance ...</code>.</p>



<a name="206814839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/default_extends_priority/near/206814839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/default_extends_priority.html#206814839">(Aug 13 2020 at 13:33)</a>:</h4>
<p>The purpose of adding the option wouldn't be to modify it, rather to just make the default value 100.</p>



<a name="206815632"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/default_extends_priority/near/206815632" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/default_extends_priority.html#206815632">(Aug 13 2020 at 13:40)</a>:</h4>
<p>As a dumb check right now one can look for all occurences of <code>default_priority</code> in mathlib which don't have <code>section</code> in the line directly above -- these are the worrisome ones</p>



<a name="206819769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/default_extends_priority/near/206819769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/default_extends_priority.html#206819769">(Aug 13 2020 at 14:15)</a>:</h4>
<p>minor quibble: it's not really <code>default_extends_priority</code> but rather <code>extends_priority</code> because there isn't a way to set the priority directly except after the fact AFAIK</p>



<a name="206819909"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/default_extends_priority/near/206819909" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/default_extends_priority.html#206819909">(Aug 13 2020 at 14:16)</a>:</h4>
<p>I see what you mean</p>



<a name="206846173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/default_extends_priority/near/206846173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/default_extends_priority.html#206846173">(Aug 13 2020 at 17:41)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean/issues/440">lean#440</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>