---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html">Leanproject in another git repository</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="288737766"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/288737766" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#288737766">(Jul 06 2022 at 22:13)</a>:</h4>
<p><code>leanproject new</code> adds git tracking to the project it creates. But what if I want to create a lean project in a subdirectory within another preexisting git-tracked directory. Can I create a lean project with mathlib without this git being added?</p>



<a name="288738359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/288738359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#288738359">(Jul 06 2022 at 22:20)</a>:</h4>
<p>git tracking is really just a <code>.git</code> folder with a bunch of files in it. I see no problems with making a <code>leanproject new</code> and then simply deleting the <code>.git</code> folder.</p>



<a name="302525274"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302525274" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302525274">(Oct 05 2022 at 19:03)</a>:</h4>
<p>What if I want to create a lean project in the root of an existing git repository?  <code>leanproject new</code> fails with <code>fatal: A branch named 'master' already exists.</code></p>



<a name="302525427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302525427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302525427">(Oct 05 2022 at 19:04)</a>:</h4>
<p>Also, if there is no problem with deleting the <code>.git</code> folder after creating a new lean project, why does <code>leanproject</code> initialize a git repository at all?</p>



<a name="302526492"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302526492" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302526492">(Oct 05 2022 at 19:11)</a>:</h4>
<p>I think <code>leanpkg</code> is the more low level tool.  <code>leanproject</code> I think was designed as a higher level tool to accommodate the needs of most lean community users including automatically making git repos, downloading mathlib, etc.</p>



<a name="302526963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302526963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302526963">(Oct 05 2022 at 19:13)</a>:</h4>
<p>I think that if you want to make a new project you need to type <code>leanproject new name-of-project</code>. It will then create a directory with that name and you should be fine.</p>



<a name="302527265"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302527265" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302527265">(Oct 05 2022 at 19:15)</a>:</h4>
<p>I don't want it in a new directory, I want it in the current directory, which already has a git repository.  <code>leanproject new</code> without another argument creates a project in the current directory, but it also tries to create a new git repository.</p>



<a name="302527423"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302527423" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302527423">(Oct 05 2022 at 19:16)</a>:</h4>
<p>How do I use <code>leanpkg</code> to do everything that <code>leanproject new</code> does except create a git repository?</p>



<a name="302527470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302527470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302527470">(Oct 05 2022 at 19:16)</a>:</h4>
<p>I could be wrong, but I don’t think leanproject or the files it creates uses any global paths, so a simple workaround is to make a project elsewhere and move it to where you want.  I haven’t tested though.</p>



<a name="302527635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302527635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302527635">(Oct 05 2022 at 19:17)</a>:</h4>
<p>yeah, leanproject probably needs a parameter to turn git off if it is going to complain like this.</p>



<a name="302528980"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302528980" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302528980">(Oct 05 2022 at 19:25)</a>:</h4>
<p>For what it is worth, I think, besides convenience to most users, this is the reason for making each lean project a git repo: <a href="https://leanprover-community.github.io/leanproject.html#git-hooks">https://leanprover-community.github.io/leanproject.html#git-hooks</a></p>



<a name="302529031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302529031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302529031">(Oct 05 2022 at 19:25)</a>:</h4>
<p>But I don’t know the motivation for sure.</p>



<a name="302533420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302533420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302533420">(Oct 05 2022 at 19:53)</a>:</h4>
<p>Each project needs to be its own git repo because <code>leanpkg.toml</code> refers to projects by their git urls. So nothing can depend on your project if it's not at the root of the repo.</p>



<a name="302533747"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302533747" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302533747">(Oct 05 2022 at 19:55)</a>:</h4>
<p>I'm referring to lines like:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">dependencies</span><span class="o">]</span>
<span class="n">mathlib</span> <span class="bp">=</span> <span class="o">{</span><span class="n">git</span> <span class="bp">=</span> <span class="s2">"https://github.com/leanprover-community/mathlib"</span><span class="o">,</span> <span class="n">rev</span> <span class="bp">=</span> <span class="s2">"de62604b58cf61aad9188a41aa7d9f51cfe73245"</span><span class="o">}</span>
</code></pre></div>
<p>This syntax only works if the repo has <code>leanpkg.toml</code> in the root, and there can obviously be only one such toml file</p>



<a name="302533995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302533995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302533995">(Oct 05 2022 at 19:56)</a>:</h4>
<p>You can of course ignore this advice if you don't intend to ever list your package as a dependency of something else (or expect anyone else to ever want to do so)</p>



<a name="302536120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302536120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302536120">(Oct 05 2022 at 20:09)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> I assume even if the project needs to be a repo, there shouldn’t in theory be a problem putting a lean project (with a git repo at the root of the lean project) inside a larger git repo, right?  (I’m not sure the <a href="https://en.wikipedia.org/wiki/XY_problem">#xy</a> of doing that, but that seems to be what the OP wants.)  I assume the current <code>leanproject new</code> is just being too cautious, right?</p>



<a name="302536214"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302536214" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302536214">(Oct 05 2022 at 20:09)</a>:</h4>
<p>That would be a git submodule if you have a repo within a repo</p>



<a name="302536312"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302536312" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302536312">(Oct 05 2022 at 20:10)</a>:</h4>
<p>Which would be fine, but is unlikely to be what the OP wants</p>



<a name="302536360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302536360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jason Rute <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302536360">(Oct 05 2022 at 20:10)</a>:</h4>
<p>Yeah, I didn’t think that through.  I agree this isn’t what the OP wants.</p>



<a name="302536584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302536584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302536584">(Oct 05 2022 at 20:12)</a>:</h4>
<p>But yes, <code>leanproject new</code> is just being cautious. You can totally copy its generated files to wherever you want them</p>



<a name="302536653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302536653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302536653">(Oct 05 2022 at 20:12)</a>:</h4>
<p>Just make sure to put the lean project.toml into the root of the new repo if you want dependencies to work</p>



<a name="302539002"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302539002" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mike Shulman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302539002">(Oct 05 2022 at 20:26)</a>:</h4>
<p>Thanks everyone!  I do think it would be useful to be able to separate the setup necessary for <em>using</em> Lean locally in a given directory from the setup necessary for <em>sharing</em> that code to other projects.</p>



<a name="302543683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Leanproject%20in%20another%20git%20repository/near/302543683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Leanproject.20in.20another.20git.20repository.html#302543683">(Oct 05 2022 at 20:59)</a>:</h4>
<p>It's likely not really worth the effort of making the change since Lean4 has a different package structure. Note that even <code>leanpkg init</code>assumes you want a git respository.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>