---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Extremely.20slow.20simp.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html">Extremely slow simp</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="189266974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/189266974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#189266974">(Feb 27 2020 at 23:02)</a>:</h4>
<p>The following example takes more than one minute on my machine:</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">all</span>
<span class="kn">set_option</span> <span class="n">trace</span><span class="bp">.</span><span class="n">simplify</span> <span class="n">true</span>
<span class="kn">set_option</span> <span class="n">profiler</span> <span class="n">true</span>

<span class="n">open_locale</span> <span class="n">nnreal</span>
<span class="kn">example</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="o">(</span><span class="n">ha</span><span class="o">)</span> <span class="o">:</span> <span class="o">((</span><span class="bp">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="bp">⟩</span> <span class="o">:</span> <span class="n">ℝ</span><span class="bp">≥</span><span class="mi">0</span><span class="o">)</span> <span class="o">:</span> <span class="n">ℝ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">simp</span>
</pre></div>


<p>The simplifier rewrites once.  However it seems to spend a huge time trying to match <code>add_con.coe_add</code> (20s), <code>con.coe_mul</code> (19s), <code>filter.filter_product.of_one</code> (9s), <code>filter.filter_product.of_neg</code> (4s), and <code>filter.filter_product.of_zero</code> (15s).  Does anybody have any idea what's going on here?</p>



<a name="189267136"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/189267136" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#189267136">(Feb 27 2020 at 23:04)</a>:</h4>
<p>What are the imports?</p>



<a name="189267186"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/189267186" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#189267186">(Feb 27 2020 at 23:05)</a>:</h4>
<p><code>import all</code></p>



<a name="189267844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/189267844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#189267844">(Feb 27 2020 at 23:14)</a>:</h4>
<p>You should have used <code>squeeze_simp</code>, then you would only have to do it once</p>



<a name="189269664"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/189269664" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#189269664">(Feb 27 2020 at 23:42)</a>:</h4>
<p>Past my bedtime now, but the (or a) culprit seems to be an instance search for <code>example : has_mul {r : ℝ // 0 ≤ r} := by apply_instance</code>. <code>nnreal</code> gets unfolded somewhere it shouldn't.</p>



<a name="189270031"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/189270031" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#189270031">(Feb 27 2020 at 23:48)</a>:</h4>
<p>Ah, <code>(⟨a, ha⟩ : ℝ≥0)</code> doesn't actually have type <code>nnreal</code>, it has type <code>{r : real // 0 &lt;= r}</code>. Nothing's getting unfolded, it isn't even folded to start with.</p>



<a name="284240009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284240009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284240009">(May 28 2022 at 17:41)</a>:</h4>
<p>The following proof takes around 2 min 30 to compile. Any idea why it is so slow and how to speed it up? (it requires adding <code>@[simps]</code> to <a href="https://leanprover-community.github.io/mathlib_docs/find/category_theory.monoidal_category.full_monoidal_subcategory">docs#category_theory.monoidal_category.full_monoidal_subcategory</a> to work).</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">representation_theory.basic</span>
<span class="kn">import</span> <span class="n">representation_theory.fdRep</span>

<span class="kd">universes</span> <span class="n">u</span>
<span class="kn">open</span> <span class="n">representation</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">k</span> <span class="n">G</span> <span class="n">V</span> <span class="n">W</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">k</span><span class="o">]</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">W</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">W</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">finite_dimensional</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">finite_dimensional</span> <span class="n">k</span> <span class="n">W</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">ρV</span> <span class="o">:</span> <span class="n">representation</span> <span class="n">k</span> <span class="n">G</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">ρW</span> <span class="o">:</span> <span class="n">representation</span> <span class="n">k</span> <span class="n">G</span> <span class="n">W</span><span class="o">)</span>

<span class="kn">local</span> <span class="kn">attribute</span> <span class="n">tensor_product.ext</span>

<span class="kd">@[simps]</span> <span class="kd">def</span> <span class="n">linear_equiv.to_FinVect_iso</span>
  <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">V</span> <span class="bp">≃ₗ</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="n">W</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">FinVect.of</span> <span class="n">k</span> <span class="n">V</span> <span class="bp">≅</span> <span class="n">FinVect.of</span> <span class="n">k</span> <span class="n">W</span> <span class="o">:=</span>
<span class="o">{</span> <span class="n">hom</span> <span class="o">:=</span> <span class="n">e.to_linear_map</span><span class="o">,</span>
  <span class="n">inv</span> <span class="o">:=</span> <span class="n">e.symm.to_linear_map</span><span class="o">,</span>
  <span class="n">hom_inv_id'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span><span class="n">ext</span><span class="o">,</span> <span class="n">exact</span> <span class="n">e.left_inv</span> <span class="n">x</span><span class="o">},</span>
  <span class="n">inv_hom_id'</span> <span class="o">:=</span> <span class="kd">by</span> <span class="o">{</span><span class="n">ext</span><span class="o">,</span> <span class="n">exact</span> <span class="n">e.right_inv</span> <span class="n">x</span><span class="o">}</span> <span class="o">}</span>

<span class="kd">noncomputable</span>
<span class="kd">def</span> <span class="n">dual_tensor_iso_lin_hom</span> <span class="o">:</span> <span class="o">(</span><span class="n">fdRep.of</span> <span class="n">ρV.dual</span><span class="o">)</span> <span class="bp">⊗</span> <span class="o">(</span><span class="n">fdRep.of</span> <span class="n">ρW</span><span class="o">)</span> <span class="bp">≅</span> <span class="n">fdRep.of</span> <span class="o">(</span><span class="n">lin_hom</span> <span class="n">ρV</span> <span class="n">ρW</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">Action.mk_iso</span> <span class="o">(</span><span class="n">dual_tensor_hom_equiv</span> <span class="n">k</span> <span class="n">V</span> <span class="n">W</span><span class="o">)</span><span class="bp">.</span><span class="n">to_FinVect_iso</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">g</span><span class="o">,</span> <span class="n">ext</span> <span class="n">f</span> <span class="n">w</span> <span class="n">v</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">module.dual.transpose_apply</span><span class="o">],</span>
<span class="kd">end</span>
</code></pre></div>



<a name="284240668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284240668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284240668">(May 28 2022 at 17:54)</a>:</h4>
<p>I get an unknown <code>lin_hom</code>. Is this <code>representation.lin_hom</code>?</p>



<a name="284240684"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284240684" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284240684">(May 28 2022 at 17:55)</a>:</h4>
<p>Then I get a type mismatch. I'm on today's <code>master</code>.</p>



<a name="284240705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284240705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284240705">(May 28 2022 at 17:55)</a>:</h4>
<p>Where do you get a type mismatch?</p>



<a name="284240748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284240748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284240748">(May 28 2022 at 17:56)</a>:</h4>
<p>Why not add the <code>simps</code> attribute in the mwe?</p>



<a name="284240765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284240765" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284240765">(May 28 2022 at 17:56)</a>:</h4>
<p>If you're on today's master and you cut and paste, you'll be able to see exactly what I'm seeing :-)</p>



<a name="284240864"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284240864" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284240864">(May 28 2022 at 17:58)</a>:</h4>
<p>Am I supposed to be adding <code>attribute [simps] category_theory.monoidal_category.full_monoidal_subcategory</code> to this mwe? I get it on <code>Action.mk_iso</code>, a type mismatch.</p>



<a name="284241011"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284241011" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284241011">(May 28 2022 at 18:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/Extremely.20slow.20simp/near/284240748">said</a>:</p>
<blockquote>
<p>Why not add the <code>simps</code> attribute in the mwe?</p>
</blockquote>
<p>Oh I forgot that you can add the simps attribute locally and not just before the definition. So yes I think the mwe requires <code>attribute [simps] category_theory.monoidal_category.full_monoidal_subcategory</code>.</p>



<a name="284241173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284241173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284241173">(May 28 2022 at 18:05)</a>:</h4>
<p>Let me try to figure out why there's a type mismatch.</p>



<a name="284297719"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284297719" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284297719">(May 29 2022 at 18:03)</a>:</h4>
<p>Ok, I haven't been able to figure out why the MWE didn't work (if someone understands why let me know!)  but I PR'd the branch in which the proof works : <a href="https://github.com/leanprover-community/mathlib/pull/14453">#14453</a></p>



<a name="284297797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284297797" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284297797">(May 29 2022 at 18:04)</a>:</h4>
<p>(The proof in question is at the end of <code>representation_theory/basic</code>).</p>



<a name="284301525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284301525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284301525">(May 29 2022 at 19:29)</a>:</h4>
<p>Hmm, so the proof is so slow that CI gives a deterministic timeout even though it works locally for me. I tried <code>squeeze_simp</code> but my computer start lagging before <code>squeeze_simp</code> succeed... Does <code>squeeze_simp</code> work for anyone else?</p>



<a name="284301681"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284301681" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284301681">(May 29 2022 at 19:33)</a>:</h4>
<p><code>squeeze_simp</code> can be quite slow as it basically just tries simp over and over again to do the squeezing, you might be able to adjust the timeout locally (see <a href="https://leanprover-community.github.io/tips_and_tricks.html#memory-and-deterministic-timeout">https://leanprover-community.github.io/tips_and_tricks.html#memory-and-deterministic-timeout</a>) then wait a few minutes for squeeze simp and get a version that works on CI</p>



<a name="284301942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284301942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284301942">(May 29 2022 at 19:40)</a>:</h4>
<p>Or try <code>simp?</code> rather than <code>squeeze_simp</code> - it's a little less reliable, but tends to be faster</p>



<a name="284302813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284302813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284302813">(May 29 2022 at 20:02)</a>:</h4>
<p><code>simp?</code> worked but even after changing to <code>simp_only</code> it takes almost 2 minutes to compile and CI fails with deterministic timeout.</p>



<a name="284308513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284308513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284308513">(May 29 2022 at 22:22)</a>:</h4>
<p>What did <code>simp?</code> suggest? Is there anything you can pull out of the <code>simp_only</code> to use directly in, for example, a <code>rw</code> or <code>refine</code>?</p>



<a name="284308728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284308728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284308728">(May 29 2022 at 22:29)</a>:</h4>
<p>Even this is very slow (with or without <code>noncomputable!</code>):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">dual_tensor_iso_lin_hom</span> <span class="o">:</span> <span class="o">(</span><span class="n">fdRep.of</span> <span class="n">ρV.dual</span><span class="o">)</span> <span class="bp">⊗</span> <span class="o">(</span><span class="n">fdRep.of</span> <span class="n">ρW</span><span class="o">)</span> <span class="bp">≅</span> <span class="n">fdRep.of</span> <span class="o">(</span><span class="n">lin_hom</span> <span class="n">ρV</span> <span class="n">ρW</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="284308740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284308740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284308740">(May 29 2022 at 22:29)</a>:</h4>
<p>It takes a bit more than 11 seconds for me.</p>



<a name="284308946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284308946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284308946">(May 29 2022 at 22:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="306601">Kyle Miller</span> <a href="#narrow/stream/113488-general/topic/Extremely.20slow.20simp/near/284308728">said</a>:</p>
<blockquote>
<p>Even this is very slow (with or without <code>noncomputable!</code>):</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">dual_tensor_iso_lin_hom</span> <span class="o">:</span> <span class="o">(</span><span class="n">fdRep.of</span> <span class="n">ρV.dual</span><span class="o">)</span> <span class="bp">⊗</span> <span class="o">(</span><span class="n">fdRep.of</span> <span class="n">ρW</span><span class="o">)</span> <span class="bp">≅</span> <span class="n">fdRep.of</span> <span class="o">(</span><span class="n">lin_hom</span> <span class="n">ρV</span> <span class="n">ρW</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Indeed that's pretty weird. I wonder what takes so much time.</p>



<a name="284312893"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284312893" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284312893">(May 30 2022 at 00:22)</a>:</h4>
<p>And changing the <code>simp only</code> to a bunch of rewrites won't be enough for CI, since just the following gives a deterministic timeout with a time limit of 100 000.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">dual_tensor_iso_lin_hom</span> <span class="o">:</span> <span class="o">(</span><span class="n">fdRep.of</span> <span class="n">ρV.dual</span><span class="o">)</span> <span class="bp">⊗</span> <span class="o">(</span><span class="n">fdRep.of</span> <span class="n">ρW</span><span class="o">)</span> <span class="bp">≅</span> <span class="n">fdRep.of</span> <span class="o">(</span><span class="n">lin_hom</span> <span class="n">ρV</span> <span class="n">ρW</span><span class="o">)</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">refine</span> <span class="n">Action.mk_iso</span> <span class="o">(</span><span class="n">dual_tensor_hom_equiv</span> <span class="n">k</span> <span class="n">V</span> <span class="n">W</span><span class="o">)</span><span class="bp">.</span><span class="n">to_FinVect_iso</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">intro</span> <span class="n">g</span><span class="o">,</span> <span class="n">ext</span> <span class="n">f</span> <span class="n">w</span> <span class="n">v</span><span class="o">,</span>
  <span class="gr">sorry</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="284346106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284346106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284346106">(May 30 2022 at 09:52)</a>:</h4>
<p>On my (admittedly rather old) computer this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">representation_theory.basic</span>
<span class="kn">import</span> <span class="n">representation_theory.fdRep</span>

<span class="kd">universes</span> <span class="n">u</span>
<span class="kn">open</span> <span class="n">representation</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">k</span> <span class="n">G</span> <span class="n">V</span> <span class="n">W</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">k</span><span class="o">]</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">W</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">W</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">finite_dimensional</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">finite_dimensional</span> <span class="n">k</span> <span class="n">W</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">ρV</span> <span class="o">:</span> <span class="n">representation</span> <span class="n">k</span> <span class="n">G</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">ρW</span> <span class="o">:</span> <span class="n">representation</span> <span class="n">k</span> <span class="n">G</span> <span class="n">W</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">test1</span> <span class="o">:</span> <span class="n">fdRep.of</span> <span class="n">ρV.dual</span> <span class="bp">=</span> <span class="n">fdRep.of</span> <span class="n">ρV.dual</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>
<p>takes 33 seconds, but then the profiler can't account for that time:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">parsing</span> <span class="n">took</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">341</span><span class="n">ms</span>
<span class="n">type</span> <span class="n">checking</span> <span class="n">of</span> <span class="n">test1</span> <span class="n">took</span> <span class="mi">26</span><span class="bp">.</span><span class="mi">1</span><span class="n">ms</span>
<span class="n">decl</span> <span class="n">post</span><span class="bp">-</span><span class="n">processing</span> <span class="n">of</span> <span class="n">test1</span> <span class="n">took</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">0402</span><span class="n">ms</span>
<span class="n">elaboration</span> <span class="n">of</span> <span class="n">test1</span> <span class="n">took</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">587</span><span class="n">ms</span>
</code></pre></div>



<a name="284347704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284347704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284347704">(May 30 2022 at 10:07)</a>:</h4>
<p>For comparison, this takes 20 seconds:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">test2</span> <span class="o">:</span> <span class="n">fdRep.of</span> <span class="n">ρV.dual</span> <span class="bp">=</span> <span class="n">fdRep.of</span> <span class="n">ρV</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>while this is immediate:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">test3</span> <span class="o">:</span> <span class="n">ρV.dual</span> <span class="bp">=</span> <span class="n">ρV.dual</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>
<p>and this takes 7 seconds:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">test4</span> <span class="o">:</span> <span class="n">fdRep.of</span> <span class="n">ρV</span> <span class="bp">=</span> <span class="n">fdRep.of</span> <span class="n">ρV</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="284348585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284348585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284348585">(May 30 2022 at 10:16)</a>:</h4>
<p>and just this takes 15 seconds:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#check</span> <span class="n">fdRep.of</span> <span class="n">ρV.dual</span>
</code></pre></div>



<a name="284348661"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284348661" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284348661">(May 30 2022 at 10:17)</a>:</h4>
<p>Something to do with <a href="https://leanprover-community.github.io/mathlib_docs/find/fdRep.of">docs#fdRep.of</a>, then?</p>



<a name="284348789"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284348789" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284348789">(May 30 2022 at 10:19)</a>:</h4>
<p>What happens if you put <code>noncomputable!</code> in front of the lemmas?</p>



<a name="284348817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284348817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284348817">(May 30 2022 at 10:19)</a>:</h4>
<p><code>#check fdRep.of ρV</code> takes 3 seconds</p>



<a name="284349285"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284349285" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284349285">(May 30 2022 at 10:24)</a>:</h4>
<p>Adding <code>noncomputable!</code> hasn't changed the timings</p>



<a name="284349610"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284349610" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284349610">(May 30 2022 at 10:28)</a>:</h4>
<p>These are all wall-clock timings, by the way.  If I add <code>set_option profiler true</code> then the output of the profiler only adds up to a few milliseconds.</p>



<a name="284350513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284350513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ben Toner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284350513">(May 30 2022 at 10:39)</a>:</h4>
<p>You can probably assume that the time missing from the profiler is spent on type checking: see <a href="https://github.com/leanprover-community/lean/issues/58">https://github.com/leanprover-community/lean/issues/58</a></p>



<a name="284643304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284643304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284643304">(Jun 01 2022 at 17:26)</a>:</h4>
<p><span class="user-mention silent" data-user-id="422543">Stuart Presnell</span> <a href="#narrow/stream/113488-general/topic/Extremely.20slow.20simp/near/284346106">said</a>:</p>
<blockquote>
<p>On my (admittedly rather old) computer this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">representation_theory.basic</span>
<span class="kn">import</span> <span class="n">representation_theory.fdRep</span>

<span class="kd">universes</span> <span class="n">u</span>
<span class="kn">open</span> <span class="n">representation</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">k</span> <span class="n">G</span> <span class="n">V</span> <span class="n">W</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">field</span> <span class="n">k</span><span class="o">]</span> <span class="o">[</span><span class="n">group</span> <span class="n">G</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">W</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="n">k</span> <span class="n">W</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">[</span><span class="n">finite_dimensional</span> <span class="n">k</span> <span class="n">V</span><span class="o">]</span> <span class="o">[</span><span class="n">finite_dimensional</span> <span class="n">k</span> <span class="n">W</span><span class="o">]</span>
<span class="kd">variables</span> <span class="o">(</span><span class="n">ρV</span> <span class="o">:</span> <span class="n">representation</span> <span class="n">k</span> <span class="n">G</span> <span class="n">V</span><span class="o">)</span> <span class="o">(</span><span class="n">ρW</span> <span class="o">:</span> <span class="n">representation</span> <span class="n">k</span> <span class="n">G</span> <span class="n">W</span><span class="o">)</span>

<span class="kd">lemma</span> <span class="n">test1</span> <span class="o">:</span> <span class="n">fdRep.of</span> <span class="n">ρV.dual</span> <span class="bp">=</span> <span class="n">fdRep.of</span> <span class="n">ρV.dual</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>
<p>takes 33 seconds, but then the profiler can't account for that time:</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">parsing</span> <span class="n">took</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">341</span><span class="n">ms</span>
<span class="n">type</span> <span class="n">checking</span> <span class="n">of</span> <span class="n">test1</span> <span class="n">took</span> <span class="mi">26</span><span class="bp">.</span><span class="mi">1</span><span class="n">ms</span>
<span class="n">decl</span> <span class="n">post</span><span class="bp">-</span><span class="n">processing</span> <span class="n">of</span> <span class="n">test1</span> <span class="n">took</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">0402</span><span class="n">ms</span>
<span class="n">elaboration</span> <span class="n">of</span> <span class="n">test1</span> <span class="n">took</span> <span class="mi">0</span><span class="bp">.</span><span class="mi">587</span><span class="n">ms</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Note that we get equally slow results with <a href="https://leanprover-community.github.io/mathlib_docs/find/Rep.of">docs#Rep.of</a> instead of <code>fdRep.of</code>, so it's not a problem with the finite dimensionality instance. So the thing that takes a lot of time must be the conversion of <code>ρ : G →* (V →ₗ[k] V)</code> to <code>ρ :  G ⟶ Mon.of (category_theory.End (Module.of V))</code> in the definition of <code>Rep.of</code>, especially when <code>ρ</code> is defined as <code>representation.dual</code>. Is there a modification of the definition of <code>Rep.of</code> that would make this faster?</p>



<a name="284646997"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/284646997" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Stuart Presnell <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#284646997">(Jun 01 2022 at 17:55)</a>:</h4>
<p><span class="user-mention silent" data-user-id="329754">Antoine Labelle</span> <a href="#narrow/stream/113488-general/topic/Extremely.20slow.20simp/near/284643304">said</a>:</p>
<blockquote>
<p>Note that we get equally slow results with <a href="https://leanprover-community.github.io/mathlib_docs/find/Rep.of">docs#Rep.of</a> instead of <code>fdRep.of</code></p>
</blockquote>
<p>As another data point, this takes 13 seconds:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="k">#check</span> <span class="n">Rep.of</span> <span class="n">ρV.dual</span>
</code></pre></div>



<a name="285041667"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285041667" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285041667">(Jun 05 2022 at 15:33)</a>:</h4>
<p>It took some time, but I think I finally found the culprit here: it seems to be the coercion from <code>representation k G</code> to <code>G →* (V →ₗ[k] V)</code>. Indeed, the following is immediate</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">representation.to_monoid_hom</span> <span class="o">:</span> <span class="n">G</span> <span class="bp">→*</span> <span class="o">(</span><span class="n">V</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="n">V</span><span class="o">)</span> <span class="o">:=</span> <span class="n">ρV</span>
<span class="k">#check</span> <span class="n">Rep.of</span> <span class="n">ρV.dual.to_monoid_hom</span>
</code></pre></div>
<p>whereas without <code>to_monoid_hom</code> it takes 13 seconds as mentioned by Stuart.</p>



<a name="285041914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285041914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285041914">(Jun 05 2022 at 15:38)</a>:</h4>
<p>This makes me wonder if the definition of <code>representation</code> is ok. It is currently defined as </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">abbreviation</span> <span class="n">representation</span> <span class="o">:=</span> <span class="n">G</span> <span class="bp">→*</span> <span class="o">(</span><span class="n">V</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="n">k</span><span class="o">]</span> <span class="n">V</span><span class="o">)</span>
</code></pre></div>
<p>I don't know much about how <code>abbreviation</code> works, is it the same as <code>def</code> or does it have a different behavior?</p>



<a name="285042257"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285042257" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285042257">(Jun 05 2022 at 15:45)</a>:</h4>
<p>If we keep <code>representation</code> as it is, we have two options. Either we change the argument of <code>Rep.of</code> to be of type <code>representation k G</code> instead of <code>G →* (V →ₗ[k] V)</code>, or we don't touch <code>Rep.of</code> but we put <code>to_monoid_hom</code> everytime we want use <code>Rep.of</code> on something of type <code>representation k G</code>. <span class="user-mention" data-user-id="110087">@Scott Morrison</span> maybe you have an opinion on that since you're the author of <code>Rep</code>?</p>



<a name="285042332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285042332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285042332">(Jun 05 2022 at 15:47)</a>:</h4>
<p>(One issue with the first option is that it requires <code>representation_theory.Rep</code> to import <code>representation_theory.basic</code> whereas in <a href="https://github.com/leanprover-community/mathlib/pull/14453">#14453</a> I have the opposite import.)</p>



<a name="285042601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285042601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285042601">(Jun 05 2022 at 15:52)</a>:</h4>
<p><code>abbreviation</code> is pretty much <code>@[reducible, inline] def</code> (though unlike <code>def</code> it doesn't generate equation lemmas, which impacts how you unfold it.)</p>



<a name="285042689"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285042689" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285042689">(Jun 05 2022 at 15:54)</a>:</h4>
<p>The presence of <code>V</code> twice in that abbreviation is worrisome to me. There's a chance it's causing exponential behavior since <code>reducible</code> means Lean is happy to unfold it when doing typeclass inference.</p>



<a name="285042756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285042756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285042756">(Jun 05 2022 at 15:56)</a>:</h4>
<p><code>inline</code> only has an effect on VM compilation and the noncomputability checker, but still it doesn't strike me as being a good idea to inline code that refers to variables more than once.</p>



<a name="285325050"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285325050" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Antoine Labelle <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285325050">(Jun 07 2022 at 23:01)</a>:</h4>
<p><span class="user-mention" data-user-id="306601">@Kyle Miller</span> Do you think that <code>representation</code> should be a <code>def</code> and not an <code>abbreviation</code> in this case? <br>
Also the problem is really due to presence of <code>V</code> twice, wouldn't <a href="https://leanprover-community.github.io/mathlib_docs/find/module.End">docs#module.End</a> have the same problems? Has anyone noticed any issue with <code>module.End</code>?</p>



<a name="285349680"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285349680" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285349680">(Jun 08 2022 at 06:20)</a>:</h4>
<p>Surely <code>V</code> appearing twice is not quite the criterion, else we would have had troubles ages ago with <a href="https://leanprover-community.github.io/mathlib_docs/find/equiv.perm">docs#equiv.perm</a>.</p>



<a name="285381158"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Extremely%20slow%20simp/near/285381158" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Extremely.20slow.20simp.html#285381158">(Jun 08 2022 at 12:11)</a>:</h4>
<p>I've had problems with module.End and <code>@[simps]</code> before</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>