---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html">Computability and finsupp and finite</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="306294128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306294128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306294128">(Oct 26 2022 at 17:37)</a>:</h4>
<p>I'm sure this has been raised in a thread somewhere, but I can't find it.</p>
<p>Is there a good reason we can't consider redefining <code>finsupp</code> like so?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">finsupp</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">has_zero</span> <span class="n">M</span><span class="o">]</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">to_fun</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">M</span><span class="o">)</span>
<span class="o">(</span><span class="n">finite_support'</span> <span class="o">:</span> <span class="n">to_fun.support.finite</span><span class="o">)</span>
</code></pre></div>
<p>Some experimentation with using it suggests that it's perfectly workable. <a href="https://gist.github.com/linesthatinterlace/6d3fcc10df7ea2716a82a2a260a47c9f">https://gist.github.com/linesthatinterlace/6d3fcc10df7ea2716a82a2a260a47c9f</a></p>
<p>But I don't see why you require the current construction where it is a finset and a function along with a proof that the finset is the support of that function. It seems like that instantly makes computable definitions of operations on it a headache.</p>
<p>Obviously the <code>set.finite</code> predicate is relatively new. But this feels so obvious that I'm sure there's some good reason why it hasn't happened. But is that reason "it is not technically desirable" or "it would be a lot of work" or something else? Currently I'm always a little wary of using finsupp, precisely because it's this big noncomputable theory and so anything you build from it is also noncomputable.</p>



<a name="306310875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306310875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306310875">(Oct 26 2022 at 19:04)</a>:</h4>
<p>The change you're suggesting makes summing over the support noncomputable</p>



<a name="306311029"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306311029" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306311029">(Oct 26 2022 at 19:05)</a>:</h4>
<p>Right now that's computable, but addition isn't (for silly reasons not related to the definition of finsupp)</p>



<a name="306311372"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306311372" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306311372">(Oct 26 2022 at 19:07)</a>:</h4>
<p>Pretty much all the "finsupp operations are not computable" cases are actually "finsupp chose to use classical.decidable instead of taking the necessary instance as an argument", which was done to make some things less painful</p>



<a name="306312077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306312077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306312077">(Oct 26 2022 at 19:11)</a>:</h4>
<p>Does it make it noncomputable even when you sum over a set with decidable mem (such as a coerced finset)?</p>



<a name="306345685"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306345685" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306345685">(Oct 26 2022 at 22:43)</a>:</h4>
<p>Like if you have a way of constructing finsupps from finsets.</p>



<a name="306346188"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306346188" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306346188">(Oct 26 2022 at 22:48)</a>:</h4>
<p>There's no way to write <a href="https://leanprover-community.github.io/mathlib_docs/find/finsupp.sum">docs#finsupp.sum</a> in a computable way under your proposal, because you're removing the data it needs</p>



<a name="306388863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306388863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306388863">(Oct 27 2022 at 07:19)</a>:</h4>
<p>Right right</p>



<a name="306388975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306388975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306388975">(Oct 27 2022 at 07:20)</a>:</h4>
<p>That does make sense - and I can see why we want that to be computable. It just feels so weird that there's no way to make both of them so.</p>



<a name="306389236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306389236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306389236">(Oct 27 2022 at 07:22)</a>:</h4>
<p>It's not that "there's no way". It's just that keeping things computable requires additional plumbing, getting decidability instances to the correct places (and uniformly, i.e. so we don't have defeq problems with instances preventing lemma firing). And since mathlib is classical, we decided not to do this plumbing.</p>



<a name="306389389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306389389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306389389">(Oct 27 2022 at 07:23)</a>:</h4>
<p>Right, so there's no theoretical barrier.</p>



<a name="306389865"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306389865" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306389865">(Oct 27 2022 at 07:27)</a>:</h4>
<p>I understand that - I do think it makes it a bit hard to build certain things which feel like they ought to be computable, and to a degree I don't then see why it's then something you bother caring about at all (if it is intended to be a classical library).</p>



<a name="306402095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306402095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306402095">(Oct 27 2022 at 08:48)</a>:</h4>
<p>My understanding is that the decision is stronger than "we didn't want to do the plumbing"; it's "we didn't want mathematicians to have to think about connecting to the plumbing"</p>



<a name="306402223"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306402223" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306402223">(Oct 27 2022 at 08:49)</a>:</h4>
<p>Having worked with concrete polynomials a bit I now believe this was the wrong decision, and being able to evaluate coeffs/degrees by refl would be more useful.</p>



<a name="306403128"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306403128" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306403128">(Oct 27 2022 at 08:55)</a>:</h4>
<p>A big problem here is that there are many different reasonable representations of "computable polynomials", and different representations are better for different purposes. Our plan has been to do all the theory with classical polynomials, but without this necessarily obstructing (much) narrower developments of computational representations for particular purposes.</p>
<p>It's tempting to imagine we might have in parallel a development of computable polynomials with all the (highly infectious?) plumbing that requires, and also a development of classical polynomials with all that plumbing removed. But we can't realistically redevelop everything for all the different relevant representations; it wouldn't be one parallel development but many.</p>



<a name="306405328"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306405328" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306405328">(Oct 27 2022 at 09:09)</a>:</h4>
<p>I may as well make plain where I was thinking about this - I've been reading some of Brett Jacob's probability work as a result of this thread. <a href="#narrow/stream/113488-general/topic/elementary.20probability.20advice">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/elementary.20probability.20advice</a> and I was thinking that if we wanted to build a formalization of his "structured probablistic reasoning" one would probably end up doing it off of finsupp, but then you lose much of the nice computability that should otherwise be inherent in the theory.</p>



<a name="306405509"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306405509" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306405509">(Oct 27 2022 at 09:10)</a>:</h4>
<p>It seems this tension might exist in multiple places, really - between computable representations and classical ones, where the latter are much easier/better for developing abstract theory on.</p>



<a name="306405601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306405601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306405601">(Oct 27 2022 at 09:10)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span> does that imply that you'd also like to see some form of computable finsupp, or rather implement polynomials in a different way?</p>



<a name="306406653"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306406653" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306406653">(Oct 27 2022 at 09:17)</a>:</h4>
<p>I think this also depends on what we mean by "compute."</p>
<ul>
<li>There's Lean-computable, which means <code>rfl</code> might work (well-founded recursion or different <code>eq.rec</code>s can inhibit this though)</li>
<li>There's the same Lean-computable, which means the VM compiler ought to work (modulo bugs), but this is for writing programs and the results are not formally verified.</li>
<li>There's computable in the symbolic sense, where for example <code>norm_num</code> or <code>simp</code> can take a symbolic expression and put it into (ideally) a normal form.</li>
</ul>
<p>For the third, there's no need for the backing type to have any nice computability properties.</p>
<p>When it comes to polynomials and computation, don't we mostly mean "take this symbolic expression and put it into a normal form"? One could write "data structures" that are special constructors for polynomials (for example dense representations, or sparse representations) and have tactics that efficiently operate on these constructors.</p>



<a name="306407208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306407208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306407208">(Oct 27 2022 at 09:20)</a>:</h4>
<p>I wrote some implementations of computable polynomials over Int in Lean 4, but that was because I was just using it as a programming language to get some large unverified computations done. I'm not sure how useful these implementations would be for computing inside proofs.</p>



<a name="306407237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306407237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306407237">(Oct 27 2022 at 09:21)</a>:</h4>
<p>I suppose for something like finsupp, what I mean is that if I have f and g finsupps, I should be able to evaluate (f + g) at any point. Perhaps that's already possible, but then I don't understand what noncomputable actually means, perhaps.</p>



<a name="306407405"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306407405" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306407405">(Oct 27 2022 at 09:22)</a>:</h4>
<p>and indeed, I suppose, find (f + g).support, though I appreciate that is harder/the sticking point.</p>



<a name="306407485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306407485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306407485">(Oct 27 2022 at 09:22)</a>:</h4>
<p>I guess a pertinent question is what you specifically mean by having f and g finsupps and what output you'd want from evaluating (f + g).</p>



<a name="306407692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306407692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306407692">(Oct 27 2022 at 09:24)</a>:</h4>
<p>Do you think that <code>finsupp.sum</code> should be computable? Folds over a finsupp are important to a lot of applications that use them, for example you take the sum of a finsupp to calculate the degree of a monomial</p>



<a name="306407806"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306407806" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306407806">(Oct 27 2022 at 09:24)</a>:</h4>
<p>and that means that <code>finsupp.support</code> needs to be data, not just an assertion of finiteness</p>



<a name="306408251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408251">(Oct 27 2022 at 09:27)</a>:</h4>
<p>I definitely agree - as Eric pointed out to me above - that it is <em>more</em> important that <code>finsupp.sum</code> is computable for exactly the reason you say.</p>



<a name="306408297"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408297" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408297">(Oct 27 2022 at 09:27)</a>:</h4>
<p>And I hadn't appreciated that that would of course need the support to be data.</p>



<a name="306408475"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408475" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408475">(Oct 27 2022 at 09:28)</a>:</h4>
<p>Evaluating (f + g) at a point is already possible using the function part</p>



<a name="306408566"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408566" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408566">(Oct 27 2022 at 09:29)</a>:</h4>
<p>but calculating the support requires decidable equality of the codomain so that you can remove all the zeroes</p>



<a name="306408584"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408584" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408584">(Oct 27 2022 at 09:29)</a>:</h4>
<p>Right.</p>



<a name="306408779"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408779" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408779">(Oct 27 2022 at 09:30)</a>:</h4>
<p>Alternatively, you could relax that by saying that the provided list doesn't have to be the real support but only some superset of it, and then take a quotient</p>



<a name="306408834"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408834" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408834">(Oct 27 2022 at 09:31)</a>:</h4>
<p>Yes, superset is I think the obvious "next idea". But that surely runs into other issues.</p>



<a name="306408900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408900">(Oct 27 2022 at 09:31)</a>:</h4>
<p>I think it comes back to "what do you actually want from the type"</p>



<a name="306408933"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408933" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408933">(Oct 27 2022 at 09:31)</a>:</h4>
<p>Yeah. And that might be quite different depending on the type.</p>



<a name="306408995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306408995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306408995">(Oct 27 2022 at 09:32)</a>:</h4>
<p>for computational purposes a closure + a linked list is really not a good representation at all</p>



<a name="306409106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306409106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306409106">(Oct 27 2022 at 09:32)</a>:</h4>
<p>(Or rather, on the thing you are building from the type.)</p>



<a name="306409668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306409668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306409668">(Oct 27 2022 at 09:36)</a>:</h4>
<p>I think something that I might want is for the following to output "3"</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">a</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="n">polynomial.C</span> <span class="mi">1</span>
<span class="kd">def</span> <span class="n">b</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="n">polynomial.C</span> <span class="mi">2</span>
<span class="kd">def</span> <span class="n">c</span> <span class="o">:=</span> <span class="n">a</span> <span class="bp">+</span> <span class="n">b</span>

<span class="k">#eval</span> <span class="n">c.eval</span> <span class="mi">17</span>
</code></pre></div>
<p>Does the quotient way of doing this allow both for this as well as keeping <code>finsupp.sum</code> computable?</p>



<a name="306409836"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306409836" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306409836">(Oct 27 2022 at 09:37)</a>:</h4>
<p>To check, when you say you want to <code>#eval</code> this, is it because you just want the number and you are OK with it being unproved?</p>



<a name="306409889"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306409889" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306409889">(Oct 27 2022 at 09:38)</a>:</h4>
<p>Would you also be happy with <code>#simp c.eval 17</code> returning <code>3</code>?</p>



<a name="306410022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306410022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306410022">(Oct 27 2022 at 09:38)</a>:</h4>
<p>or <code>#norm_num c.eval 17</code></p>



<a name="306410234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306410234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306410234">(Oct 27 2022 at 09:40)</a>:</h4>
<p>Hmm, let me think</p>



<a name="306411290"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306411290" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bolton Bailey <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306411290">(Oct 27 2022 at 09:47)</a>:</h4>
<p>I was trying to produce a simple example of what I wanted but in actuality I might want to be doing more complicated operations than just adding two known polynomials. The cryptographic algorithm is a bit complicated but what it does is to take as input a polynomial like <code>a + b X + c X^3 + d X^4</code> and "split" it into two polynomials <code>a + c X</code> and <code>b + d X</code>, make a linear combination those two polynomials <code>(a + cX) + k(b + dX)</code>, and then evaluate that and return an output.</p>



<a name="306412030"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412030" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412030">(Oct 27 2022 at 09:52)</a>:</h4>
<p>I suppose what the "noncomputable <code>finsupp.sum</code>" would look like under my original proposal is "shockingly and suspiciously similar to the already-existing <code>finsum</code>".</p>



<a name="306412154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412154">(Oct 27 2022 at 09:53)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110049">Mario Carneiro</span> <a href="#narrow/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite/near/306408779">said</a>:</p>
<blockquote>
<p>Alternatively, you could relax that by saying that the provided list doesn't have to be the real support but only some superset of it, and then take a quotient</p>
</blockquote>
<p><span class="user-mention silent" data-user-id="330967">Wrenna Robson</span> <a href="#narrow/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite/near/306408834">said</a>:</p>
<blockquote>
<p>Yes, superset is I think the obvious "next idea". But that surely runs into other issues.</p>
</blockquote>
<p>Note this approach to computability already exists in mathlib, it's <a href="https://leanprover-community.github.io/mathlib_docs/find/dfinsupp">docs#dfinsupp</a></p>



<a name="306412235"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412235" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412235">(Oct 27 2022 at 09:53)</a>:</h4>
<p>"finsupp takes an altogether different approach here; it uses classical.decidable and declares finsupp.has_add as noncomputable. This design difference is independent of the fact that dfinsupp is dependently-typed and finsupp is not; in future, we may want to align these two definitions, or introduce two more definitions for the other combinations of decisions."</p>



<a name="306412286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412286">(Oct 27 2022 at 09:54)</a>:</h4>
<p>Well that's uh.</p>



<a name="306412359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412359">(Oct 27 2022 at 09:54)</a>:</h4>
<p>I did not realise this. So <code>finsupp</code> and <code>dfinsupp</code> are different in ways other than the fact that one is dependent. I didn't realise this (you would not know it from the name).</p>



<a name="306412467"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412467" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412467">(Oct 27 2022 at 09:55)</a>:</h4>
<p>I have a branch somewhere that redefined <code>finsupp</code> as a special case of <code>dfinsupp</code></p>



<a name="306412473"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412473" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412473">(Oct 27 2022 at 09:55)</a>:</h4>
<p>I mean it <em>looks</em> like the approach of <code>dfinsupp</code> is very clever and nice.</p>



<a name="306412478"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412478" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412478">(Oct 27 2022 at 09:55)</a>:</h4>
<p>So - right. Yes, that sounds good.</p>



<a name="306412559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412559">(Oct 27 2022 at 09:56)</a>:</h4>
<p>Like, call me silly but that's what I'd do.</p>



<a name="306412727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412727">(Oct 27 2022 at 09:57)</a>:</h4>
<p>That does mean I can increment my "number of ways to do finite sums in mathlib" counter by one.</p>



<a name="306412852"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412852" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412852">(Oct 27 2022 at 09:58)</a>:</h4>
<p>Because it sounds like <code>dfinsupp.sum</code>, <code>finsupp.sum</code>, <code>finsum</code>, <code>finset.sum</code> and <code>tsum</code> are all different.</p>



<a name="306412910"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306412910" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306412910">(Oct 27 2022 at 09:58)</a>:</h4>
<p><em>slaps \Sigma</em> this bad boy can contain so many different notions of summation</p>



<a name="306416554"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306416554" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306416554">(Oct 27 2022 at 10:20)</a>:</h4>
<p>See also <a href="https://leanprover-community.github.io/mathlib_docs/find/dfinsupp.sum_add_hom">docs#dfinsupp.sum_add_hom</a> which removes the decidability requirement in exchange for a proof that it's not needed</p>



<a name="306417063"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306417063" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306417063">(Oct 27 2022 at 10:23)</a>:</h4>
<p>Oh true, I should count that too ;P</p>



<a name="306417095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306417095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306417095">(Oct 27 2022 at 10:23)</a>:</h4>
<p>That is really nice, honestly.</p>



<a name="306417284"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306417284" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306417284">(Oct 27 2022 at 10:24)</a>:</h4>
<p>Was there any particular issue with replacing finsupp with a special case of dfinsupp?</p>



<a name="306421095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306421095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306421095">(Oct 27 2022 at 10:51)</a>:</h4>
<p>Refactors are hard</p>



<a name="306422376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Computability%20and%20finsupp%20and%20finite/near/306422376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Computability.20and.20finsupp.20and.20finite.html#306422376">(Oct 27 2022 at 10:59)</a>:</h4>
<p><em>looks sadly at my floor_order refactor</em> yes</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>