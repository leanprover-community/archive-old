---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/New.20lean.20release.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html">New lean release?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="259440122"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259440122" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259440122">(Oct 28 2021 at 19:30)</a>:</h4>
<p>It would be nice to have a new Lean release. I want to review <a href="https://leanprover-community.github.io/mathlib_docs/find/stream">docs#stream</a> API, and the first step is moving it to <code>mathlib</code>, see <a href="https://github.com/leanprover-community/mathlib/issues/9988">#9988</a>.</p>



<a name="259440434"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259440434" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259440434">(Oct 28 2021 at 19:33)</a>:</h4>
<p>cc <span class="user-mention" data-user-id="110043">@Gabriel Ebner</span></p>



<a name="259443108"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259443108" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259443108">(Oct 28 2021 at 19:54)</a>:</h4>
<p>I can also make a release later tonight if Gabriel isn't already working on one.</p>



<a name="259463020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259463020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259463020">(Oct 28 2021 at 22:57)</a>:</h4>
<p>I'm starting to put together Lean 3.35.0c now...</p>



<a name="259467925"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259467925" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259467925">(Oct 28 2021 at 23:59)</a>:</h4>
<p><span class="user-mention" data-user-id="214703">@Yury G. Kudryashov</span> The linux build of Lean 3.35.0c just appeared, so you should be able to use it in mathlib CI now. (The other binaries should appear shortly.)</p>



<a name="259468946"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259468946" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259468946">(Oct 29 2021 at 00:13)</a>:</h4>
<p>Should I resurrect <code>rbtree</code>/<code>rbmap</code> files in <code>mathlib</code>?</p>



<a name="259469076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259469076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259469076">(Oct 29 2021 at 00:15)</a>:</h4>
<p><span class="user-mention" data-user-id="110087">@Scott Morrison</span> <span aria-label="up" class="emoji emoji-2b06" role="img" title="up">:up:</span></p>



<a name="259476869"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259476869" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259476869">(Oct 29 2021 at 02:43)</a>:</h4>
<p>(in progress)</p>



<a name="259487975"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259487975" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259487975">(Oct 29 2021 at 06:41)</a>:</h4>
<p>Sorry, I was away from the computer today. I can help with the mathlib PR for the next release starting in +13 hours.</p>



<a name="259496140"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259496140" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259496140">(Oct 29 2021 at 08:34)</a>:</h4>
<p>It builds but there are many lint errors. I think that we should just add lines to <code>nolints</code> and fix new lint errors later. E.g., this way the changes will be visible in the git history.</p>



<a name="259539963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259539963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259539963">(Oct 29 2021 at 15:23)</a>:</h4>
<p>I've opened <a href="https://github.com/leanprover-community/mathlib/issues/10036">#10036</a> for lint fixes.</p>



<a name="259540127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259540127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259540127">(Oct 29 2021 at 15:24)</a>:</h4>
<p>Feel free to fix more lint issues. Please don't make larger changes in the same branch.</p>



<a name="259544579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259544579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259544579">(Oct 29 2021 at 15:55)</a>:</h4>
<p>DO you still intend to just <code>nolints.txt</code> everything in <a href="https://github.com/leanprover-community/mathlib/issues/9988">#9988</a> so that we can merge it?</p>



<a name="259544841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259544841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259544841">(Oct 29 2021 at 15:57)</a>:</h4>
<p>Yes. I started <code>lean --run scripts/lint_mathlib.lean</code> locally. It is silent for more than an hour. Is it OK or I'm doing something wrong?</p>



<a name="259544979"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259544979" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259544979">(Oct 29 2021 at 15:58)</a>:</h4>
<p>I would just copy the lint output in manually, probably</p>



<a name="259545153"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259545153" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259545153">(Oct 29 2021 at 15:59)</a>:</h4>
<p><code>htop</code> says that this process uses 370% CPU, so let's wait.</p>



<a name="259545809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259545809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259545809">(Oct 29 2021 at 16:02)</a>:</h4>
<p>Perhaps github CI should upload the nolints file on failure?</p>



<a name="259547419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259547419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259547419">(Oct 29 2021 at 16:12)</a>:</h4>
<p>Not a bad idea!</p>



<a name="259552961"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259552961" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259552961">(Oct 29 2021 at 16:54)</a>:</h4>
<p><span class="user-mention" data-user-id="111080">@Floris van Doorn</span> needed to do this a little while back and posted directions in the maintainer stream. Here's his post, slightly cropped:</p>
<blockquote>
<p>The CI already generates the <code>nolints.txt</code> file, so you only have to tell it to upload the result. To do this, in the file <code>.github/workflows/build.yml.in</code> add the following:</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>      - name: upload nolints.txt
        if: always()
        uses: actions/upload-artifact@v2
        with:
          name: nolints.txt
          path: nolints.txt
</code></pre></div>
<p>Add this under the following existing lines (on line 130, currently):</p>
<div class="codehilite" data-code-language="Text only"><pre><span></span><code>      - name: lint
        run: |
          ./scripts/mk_all.sh
          lean --run scripts/lint_mathlib.lean
</code></pre></div>
<p>Then run <code>.github/workflows/mk_build_yml.sh</code> and commit &amp; push the result.<br>
After CI is done, you can download the file from the CI summary page (e.g. <a href="https://github.com/leanprover-community/mathlib/actions/runs/1142305734">https://github.com/leanprover-community/mathlib/actions/runs/1142305734</a>)</p>
</blockquote>



<a name="259554983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259554983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259554983">(Oct 29 2021 at 17:10)</a>:</h4>
<p>You can do slightly better than <code>always()</code> and only do it if the linting fails; I think I did something like that on the <code>highlightjs-lean</code> repo.</p>



<a name="259562967"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259562967" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259562967">(Oct 29 2021 at 18:09)</a>:</h4>
<p>I think it makes sense to permanently change the CI so that it always uploads the <code>nolints.txt</code> if the linter has run but fails, as Eric said.</p>



<a name="259576304"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259576304" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259576304">(Oct 29 2021 at 20:04)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/9988">#9988</a> is ready for review (most of it is a code copied from lean core).</p>



<a name="259579695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259579695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259579695">(Oct 29 2021 at 20:31)</a>:</h4>
<p>And CI is happy (since I've added all new errors to <code>nolints</code>).</p>



<a name="259587848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259587848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259587848">(Oct 29 2021 at 21:56)</a>:</h4>
<p>LGTM, would just like to see some comment about the choice of <code>init.lean</code> as a filename</p>



<a name="259588045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259588045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259588045">(Oct 29 2021 at 21:59)</a>:</h4>
<p>Oh yeah I don't like the filenames.</p>



<a name="259588133"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259588133" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259588133">(Oct 29 2021 at 22:00)</a>:</h4>
<p>I think they're fine if associated with a TODO or explanation</p>



<a name="259588157"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259588157" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259588157">(Oct 29 2021 at 22:00)</a>:</h4>
<p>Just in order to get lean bumped</p>



<a name="259588217"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259588217" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259588217">(Oct 29 2021 at 22:00)</a>:</h4>
<p>YEah sure, I'm just gonna dump my ideas here and you do whatever you want with it.</p>



<a name="259588324"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259588324" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259588324">(Oct 29 2021 at 22:01)</a>:</h4>
<p>I would rename <code>data.rbmap.default</code>, <code>data.rbtree.init</code>,<code>data.rbtree.main</code> and <code>data.stream.init</code> because they are very non descriptive names and <code>.default</code> is reserved to contentless files.</p>



<a name="259588593"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259588593" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259588593">(Oct 29 2021 at 22:04)</a>:</h4>
<p>And I think we could merge <code>data.rbtree.default_lt</code> with any basic order file or something</p>



<a name="259588666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259588666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259588666">(Oct 29 2021 at 22:05)</a>:</h4>
<p>Also sad that <code>style_exceptions</code> is getting back up <span aria-label="sad" class="emoji emoji-2639" role="img" title="sad">:sad:</span></p>



<a name="259703837"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259703837" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259703837">(Oct 30 2021 at 02:00)</a>:</h4>
<p>I'm fixing most of <code>lint</code> issues (all but "docs missing") in another PR.</p>



<a name="259703851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/New%20lean%20release%3F/near/259703851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/New.20lean.20release.3F.html#259703851">(Oct 30 2021 at 02:01)</a>:</h4>
<p>About file renames and merges: I think that we should do it in separate PRs after we move files to mathlib.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>