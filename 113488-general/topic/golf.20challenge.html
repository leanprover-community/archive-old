---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/golf.20challenge.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html">golf challenge</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="157091599"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157091599" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157091599">(Jan 29 2019 at 09:15)</a>:</h4>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">equiv</span><span class="bp">.</span><span class="n">basic</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">multivariate_polynomial</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span> <span class="n">w</span>

<span class="kn">namespace</span> <span class="n">mv_polynomial</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">(</span><span class="n">β</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">)</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">β</span><span class="o">]</span>

<span class="n">def</span> <span class="n">option_ring_equiv_aux11</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">polynomial</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="n">β</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">polynomial</span><span class="bp">.</span><span class="n">C</span> <span class="err">∘</span> <span class="n">C</span>

<span class="kn">instance</span> <span class="n">option_ring_equiv_aux12</span> <span class="o">:</span> <span class="n">ring</span> <span class="o">(</span><span class="n">polynomial</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="n">β</span> <span class="n">α</span><span class="o">))</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">comm_ring</span><span class="bp">.</span><span class="n">to_ring</span> <span class="bp">_</span> <span class="err">$</span> <span class="n">polynomial</span><span class="bp">.</span><span class="n">comm_ring</span>

<span class="kn">instance</span> <span class="n">option_ring_equiv_aux13</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">polynomial</span><span class="bp">.</span><span class="n">C</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">β</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">polynomial</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="n">β</span> <span class="n">α</span><span class="o">))</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">apply</span> <span class="n">polynomial</span><span class="bp">.</span><span class="n">C</span><span class="bp">.</span><span class="n">is_ring_hom</span>

<span class="kn">instance</span> <span class="n">option_ring_equiv_aux14</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">option_ring_equiv_aux11</span> <span class="n">α</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">comp</span> <span class="bp">_</span> <span class="bp">_</span>

<span class="kn">instance</span> <span class="n">option_ring_equiv_aux15</span> <span class="o">:</span> <span class="n">is_semiring_hom</span> <span class="o">(</span><span class="n">option_ring_equiv_aux11</span> <span class="n">α</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">is_semiring_hom</span> <span class="bp">_</span>

<span class="n">def</span> <span class="n">option_ring_equiv_aux1</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">option</span> <span class="n">β</span><span class="o">)</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">polynomial</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="n">β</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">eval₂</span> <span class="o">(</span><span class="n">option_ring_equiv_aux11</span> <span class="n">α</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">option</span><span class="bp">.</span><span class="n">rec_on</span> <span class="n">x</span> <span class="n">polynomial</span><span class="bp">.</span><span class="n">X</span> <span class="o">(</span><span class="n">polynomial</span><span class="bp">.</span><span class="n">C</span> <span class="err">∘</span> <span class="n">X</span><span class="o">))</span>

<span class="n">def</span> <span class="n">option_ring_equiv_aux21</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">β</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">option</span> <span class="n">β</span><span class="o">)</span> <span class="n">α</span> <span class="o">:=</span>
<span class="n">eval₂</span> <span class="n">C</span> <span class="o">(</span><span class="n">X</span> <span class="err">∘</span> <span class="n">some</span><span class="o">)</span>

<span class="kn">instance</span> <span class="n">option_ring_equiv_aux22</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">option_ring_equiv_aux21</span> <span class="n">α</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="k">by</span> <span class="n">convert</span> <span class="n">eval₂</span><span class="bp">.</span><span class="n">is_ring_hom</span> <span class="bp">_</span> <span class="bp">_;</span> <span class="n">apply_instance</span>

<span class="kn">instance</span> <span class="n">option_ring_equiv_aux23</span> <span class="o">:</span> <span class="n">is_semiring_hom</span> <span class="o">(</span><span class="n">option_ring_equiv_aux21</span> <span class="n">α</span> <span class="n">β</span><span class="o">)</span> <span class="o">:=</span>
<span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">is_semiring_hom</span> <span class="bp">_</span>

<span class="n">def</span> <span class="n">option_ring_equiv_aux2</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="o">(</span><span class="n">mv_polynomial</span> <span class="n">β</span> <span class="n">α</span><span class="o">)</span> <span class="bp">→</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">option</span> <span class="n">β</span><span class="o">)</span> <span class="n">α</span> <span class="o">:=</span>
<span class="n">polynomial</span><span class="bp">.</span><span class="n">eval₂</span> <span class="o">(</span><span class="n">option_ring_equiv_aux21</span> <span class="n">α</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">X</span> <span class="n">none</span><span class="o">)</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span><span class="o">}</span>
<span class="kn">set_option</span> <span class="n">class</span><span class="bp">.</span><span class="n">instance_max_depth</span> <span class="mi">5</span>
<span class="kn">theorem</span> <span class="n">option_ring_equiv_aux3</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">option</span> <span class="n">β</span><span class="o">)</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="n">option_ring_equiv_aux2</span> <span class="n">α</span> <span class="n">β</span> <span class="o">(</span><span class="n">option_ring_equiv_aux1</span> <span class="n">α</span> <span class="n">β</span> <span class="n">f</span><span class="o">)</span> <span class="bp">=</span> <span class="n">f</span> <span class="o">:=</span>
<span class="n">induction_on</span> <span class="n">f</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">r</span><span class="o">,</span> <span class="k">calc</span> <span class="n">option_ring_equiv_aux2</span> <span class="n">α</span> <span class="n">β</span> <span class="o">(</span><span class="n">option_ring_equiv_aux1</span> <span class="n">α</span> <span class="n">β</span> <span class="o">(</span><span class="n">C</span> <span class="n">r</span><span class="o">))</span>
           <span class="bp">=</span> <span class="n">option_ring_equiv_aux2</span> <span class="n">α</span> <span class="n">β</span> <span class="o">(</span><span class="n">option_ring_equiv_aux11</span> <span class="n">α</span> <span class="n">β</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">congr&#39;</span> <span class="mi">1</span><span class="bp">;</span> <span class="n">convert</span> <span class="n">eval₂_C</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_;</span> <span class="n">convert</span> <span class="n">mv_polynomial</span><span class="bp">.</span><span class="n">option_ring_equiv_aux15</span> <span class="n">α</span> <span class="n">β</span>
       <span class="bp">...</span> <span class="bp">=</span> <span class="n">option_ring_equiv_aux21</span> <span class="n">α</span> <span class="n">β</span> <span class="o">(</span><span class="n">C</span> <span class="n">r</span><span class="o">)</span> <span class="o">:</span> <span class="k">by</span> <span class="n">convert</span> <span class="n">polynomial</span><span class="bp">.</span><span class="n">eval₂_C</span> <span class="bp">_</span> <span class="bp">_;</span> <span class="n">apply_instance</span>
       <span class="bp">...</span> <span class="bp">=</span> <span class="n">C</span> <span class="n">r</span> <span class="o">:</span> <span class="k">by</span> <span class="n">convert</span> <span class="n">eval₂_C</span> <span class="bp">_</span> <span class="bp">_</span> <span class="bp">_;</span> <span class="n">apply_instance</span><span class="o">)</span>
  <span class="n">sorry</span>
  <span class="n">sorry</span>

<span class="kn">end</span> <span class="n">mv_polynomial</span>
</pre></div>



<a name="157091612"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157091612" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157091612">(Jan 29 2019 at 09:15)</a>:</h4>
<p>challenge: shorten this code, but keep the compiling time low</p>



<a name="157091663"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157091663" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157091663">(Jan 29 2019 at 09:16)</a>:</h4>
<p>(yes, the <code>set_option class.instance_max_depth 5</code> line is there to keep the compiling time low)</p>



<a name="157091668"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157091668" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157091668">(Jan 29 2019 at 09:16)</a>:</h4>
<p><span class="user-mention" data-user-id="110294">@Johannes Hölzl</span></p>



<a name="157101129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157101129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157101129">(Jan 29 2019 at 12:31)</a>:</h4>
<p><span class="user-mention" data-user-id="110044">@Chris Hughes</span></p>



<a name="157194471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157194471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johannes Hölzl <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157194471">(Jan 30 2019 at 15:18)</a>:</h4>
<p><span class="user-mention" data-user-id="110064">@Kenny Lau</span>  I think we have a problem either with the ring homomorphisms, or some of the mv_polynomial instances... I changed the proof to <code>mv_polynomial (β ⊕ γ) α ≃r mv_polynomial β (mv_polynomial γ α)</code>, allowing also the symmetric variant.</p>



<a name="157194503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157194503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157194503">(Jan 30 2019 at 15:19)</a>:</h4>
<p>are you planning to put this into mathlib? I'm about to prove the same theorem</p>



<a name="157194621"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157194621" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johannes Hölzl <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157194621">(Jan 30 2019 at 15:20)</a>:</h4>
<p>its already in master</p>



<a name="157194636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157194636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johannes Hölzl <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157194636">(Jan 30 2019 at 15:20)</a>:</h4>
<p><a href="https://github.com/leanprover/mathlib/commit/f7b9d6b43e478661eb87fef36c75e8e4ffc08499" target="_blank" title="https://github.com/leanprover/mathlib/commit/f7b9d6b43e478661eb87fef36c75e8e4ffc08499">https://github.com/leanprover/mathlib/commit/f7b9d6b43e478661eb87fef36c75e8e4ffc08499</a></p>



<a name="157194647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157194647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157194647">(Jan 30 2019 at 15:20)</a>:</h4>
<p>oh nice!</p>



<a name="157194863"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/157194863" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#157194863">(Jan 30 2019 at 15:23)</a>:</h4>
<p>Aah, using <code>rename</code> we might be able to slightly cleanup the <code>mv_polynomial</code> adjunction that I PR'd a while ago.</p>



<a name="202664453"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/202664453" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#202664453">(Jul 02 2020 at 08:59)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">polynomial</span>

<span class="n">universes</span> <span class="n">u</span>

<span class="kn">open</span> <span class="n">polynomial</span>
<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kn">lemma</span> <span class="n">nat_degree_le_nat_degree</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">{</span><span class="n">f</span> <span class="n">g</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hfg</span> <span class="o">:</span> <span class="n">f</span><span class="bp">.</span><span class="n">degree</span> <span class="bp">≤</span> <span class="n">g</span><span class="bp">.</span><span class="n">degree</span><span class="o">)</span> <span class="o">:</span> <span class="n">f</span><span class="bp">.</span><span class="n">nat_degree</span> <span class="bp">≤</span> <span class="n">g</span><span class="bp">.</span><span class="n">nat_degree</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">by_cases</span> <span class="n">hf</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hf</span><span class="o">,</span> <span class="n">nat_degree_zero</span><span class="o">],</span> <span class="n">exact</span> <span class="n">zero_le</span> <span class="bp">_</span> <span class="o">},</span>
  <span class="n">by_cases</span> <span class="n">hg</span> <span class="o">:</span> <span class="n">g</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hg</span><span class="o">,</span> <span class="n">degree_zero</span><span class="o">,</span> <span class="n">le_bot_iff</span><span class="o">,</span> <span class="n">degree_eq_bot</span><span class="o">]</span> <span class="n">at</span> <span class="n">hfg</span><span class="o">,</span> <span class="n">cc</span> <span class="o">},</span>
  <span class="n">rwa</span> <span class="o">[</span><span class="n">degree_eq_nat_degree</span> <span class="n">hf</span><span class="o">,</span> <span class="n">degree_eq_nat_degree</span> <span class="n">hg</span><span class="o">,</span> <span class="n">with_bot</span><span class="bp">.</span><span class="n">coe_le_coe</span><span class="o">]</span> <span class="n">at</span> <span class="n">hfg</span>
<span class="kn">end</span>

<span class="kn">theorem</span> <span class="n">nat_degree_div_by_monic</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="o">{</span><span class="n">g</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hg</span> <span class="o">:</span> <span class="n">g</span><span class="bp">.</span><span class="n">monic</span><span class="o">)</span> <span class="o">:</span> <span class="n">nat_degree</span> <span class="o">(</span><span class="n">f</span> <span class="bp">/</span><span class="err">ₘ</span> <span class="n">g</span><span class="o">)</span> <span class="bp">=</span> <span class="n">nat_degree</span> <span class="n">f</span> <span class="bp">-</span> <span class="n">nat_degree</span> <span class="n">g</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">by_cases</span> <span class="n">h01</span> <span class="o">:</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">R</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">haveI</span> <span class="o">:=</span> <span class="n">subsingleton_of_zero_eq_one</span> <span class="n">h01</span><span class="o">,</span>
    <span class="n">rw</span> <span class="o">[</span><span class="n">subsingleton</span><span class="bp">.</span><span class="n">elim</span> <span class="o">(</span><span class="n">f</span> <span class="bp">/</span><span class="err">ₘ</span> <span class="n">g</span><span class="o">)</span> <span class="mi">0</span><span class="o">,</span> <span class="n">subsingleton</span><span class="bp">.</span><span class="n">elim</span> <span class="n">f</span> <span class="mi">0</span><span class="o">,</span> <span class="n">subsingleton</span><span class="bp">.</span><span class="n">elim</span> <span class="n">g</span> <span class="mi">0</span><span class="o">,</span>
        <span class="n">nat_degree_zero</span><span class="o">]</span> <span class="o">},</span>
  <span class="n">haveI</span> <span class="o">:</span> <span class="n">nonzero</span> <span class="n">R</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">h01</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">by_cases</span> <span class="n">hfg</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">/</span><span class="err">ₘ</span> <span class="n">g</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hfg</span><span class="o">,</span> <span class="n">nat_degree_zero</span><span class="o">],</span> <span class="n">rw</span> <span class="n">div_by_monic_eq_zero_iff</span> <span class="n">hg</span> <span class="n">hg</span><span class="bp">.</span><span class="n">ne_zero</span> <span class="n">at</span> <span class="n">hfg</span><span class="o">,</span>
    <span class="n">rw</span> <span class="n">nat</span><span class="bp">.</span><span class="n">sub_eq_zero_of_le</span> <span class="o">(</span><span class="n">nat_degree_le_nat_degree</span> <span class="err">$</span> <span class="n">le_of_lt</span> <span class="n">hfg</span><span class="o">)</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">hgf</span> <span class="o">:=</span> <span class="n">hfg</span><span class="o">,</span> <span class="n">rw</span> <span class="n">div_by_monic_eq_zero_iff</span> <span class="n">hg</span> <span class="n">hg</span><span class="bp">.</span><span class="n">ne_zero</span> <span class="n">at</span> <span class="n">hgf</span><span class="o">,</span> <span class="n">push_neg</span> <span class="n">at</span> <span class="n">hgf</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="n">degree_add_div_by_monic</span> <span class="n">hg</span> <span class="n">hgf</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">hf</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span> <span class="o">{</span> <span class="n">intro</span> <span class="n">hf</span><span class="o">,</span> <span class="n">apply</span> <span class="n">hfg</span><span class="o">,</span> <span class="n">rw</span> <span class="o">[</span><span class="n">hf</span><span class="o">,</span> <span class="n">zero_div_by_monic</span><span class="o">]</span> <span class="o">},</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">degree_eq_nat_degree</span> <span class="n">hf</span><span class="o">,</span> <span class="n">degree_eq_nat_degree</span> <span class="n">hg</span><span class="bp">.</span><span class="n">ne_zero</span><span class="o">,</span> <span class="n">degree_eq_nat_degree</span> <span class="n">hfg</span><span class="o">,</span>
      <span class="err">←</span> <span class="n">with_bot</span><span class="bp">.</span><span class="n">coe_add</span><span class="o">,</span> <span class="n">with_bot</span><span class="bp">.</span><span class="n">coe_eq_coe</span><span class="o">]</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="err">←</span> <span class="n">this</span><span class="o">,</span> <span class="n">nat</span><span class="bp">.</span><span class="n">add_sub_cancel_left</span><span class="o">]</span>
<span class="kn">end</span>
</code></pre></div>



<a name="203496360"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203496360" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203496360">(Jul 10 2020 at 11:39)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">mv_polynomial</span>
<span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">determinant</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">n</span><span class="o">]</span>

<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">det_poly</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">n</span> <span class="bp">×</span> <span class="n">n</span><span class="o">)</span> <span class="bp">ℤ</span> <span class="o">:=</span>
<span class="n">matrix</span><span class="bp">.</span><span class="n">det</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">mv_polynomial</span><span class="bp">.</span><span class="n">X</span> <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">R</span><span class="o">)</span>

<span class="kn">theorem</span> <span class="n">eval_det_poly</span> <span class="o">:</span> <span class="o">(</span><span class="n">det_poly</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">eval₂</span> <span class="n">coe</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="n">M</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span> <span class="n">p</span><span class="bp">.</span><span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">M</span><span class="bp">.</span><span class="n">det</span> <span class="o">:=</span>
<span class="n">sorry</span>
</code></pre></div>



<a name="203496406"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203496406" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203496406">(Jul 10 2020 at 11:40)</a>:</h4>
<p>golf challenge</p>



<a name="203496456"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203496456" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203496456">(Jul 10 2020 at 11:41)</a>:</h4>
<p><a href="https://github.com/rwbarton/swan/blob/lean-3.4.2/src/for_mathlib/determinant.lean">https://github.com/rwbarton/swan/blob/lean-3.4.2/src/for_mathlib/determinant.lean</a></p>



<a name="203496470"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203496470" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203496470">(Jul 10 2020 at 11:41)</a>:</h4>
<p>lol</p>



<a name="203496614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203496614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203496614">(Jul 10 2020 at 11:43)</a>:</h4>
<p>It might use simp lemmas that weren't in mathlib at the time</p>



<a name="203498007"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203498007" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203498007">(Jul 10 2020 at 12:01)</a>:</h4>
<p>my solution:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="n">data</span><span class="bp">.</span><span class="n">mv_polynomial</span>
<span class="kn">import</span> <span class="n">linear_algebra</span><span class="bp">.</span><span class="n">determinant</span>

<span class="n">universes</span> <span class="n">u</span> <span class="n">v</span>

<span class="kn">variables</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">fintype</span> <span class="n">n</span><span class="o">]</span> <span class="o">[</span><span class="n">decidable_eq</span> <span class="n">n</span><span class="o">]</span>

<span class="n">noncomputable</span> <span class="n">def</span> <span class="n">det_poly</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="o">(</span><span class="n">n</span> <span class="bp">×</span> <span class="n">n</span><span class="o">)</span> <span class="bp">ℤ</span> <span class="o">:=</span>
<span class="n">matrix</span><span class="bp">.</span><span class="n">det</span> <span class="err">$</span> <span class="bp">λ</span> <span class="n">i</span> <span class="n">j</span> <span class="o">:</span> <span class="n">n</span><span class="o">,</span> <span class="n">mv_polynomial</span><span class="bp">.</span><span class="n">X</span> <span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">j</span><span class="o">)</span>

<span class="kn">variables</span> <span class="o">{</span><span class="n">n</span><span class="o">}</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">v</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="n">matrix</span> <span class="n">n</span> <span class="n">n</span> <span class="n">R</span><span class="o">)</span>

<span class="kn">namespace</span> <span class="n">mv_polynomial</span>

<span class="kn">theorem</span> <span class="n">eval₂_int_cast</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span> <span class="n">σ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">α</span><span class="o">]</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">β</span><span class="o">]</span>
  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">(</span><span class="n">g</span> <span class="o">:</span> <span class="n">σ</span> <span class="bp">→</span> <span class="n">β</span><span class="o">)</span> <span class="o">[</span><span class="n">is_ring_hom</span> <span class="n">f</span><span class="o">]</span> <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="bp">ℤ</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">n</span> <span class="o">:</span> <span class="n">mv_polynomial</span> <span class="n">σ</span> <span class="n">α</span><span class="o">)</span><span class="bp">.</span><span class="n">eval₂</span> <span class="n">f</span> <span class="n">g</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="n">int</span><span class="bp">.</span><span class="n">induction_on</span> <span class="n">n</span> <span class="o">(</span><span class="n">eval₂_zero</span> <span class="n">f</span> <span class="n">g</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">ih</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">int</span><span class="bp">.</span><span class="n">cast_add</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_add</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_one</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_one</span><span class="o">,</span> <span class="n">eval₂_add</span><span class="o">,</span> <span class="n">ih</span><span class="o">,</span> <span class="n">eval₂_one</span><span class="o">])</span>
  <span class="o">(</span><span class="bp">λ</span> <span class="n">i</span> <span class="n">ih</span><span class="o">,</span> <span class="k">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">int</span><span class="bp">.</span><span class="n">cast_sub</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_sub</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_one</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_one</span><span class="o">,</span> <span class="n">eval₂_sub</span><span class="o">,</span> <span class="n">ih</span><span class="o">,</span> <span class="n">eval₂_one</span><span class="o">])</span>

<span class="kn">end</span> <span class="n">mv_polynomial</span>

<span class="kn">open</span> <span class="n">mv_polynomial</span>

<span class="kn">theorem</span> <span class="n">eval_det_poly</span> <span class="o">:</span> <span class="o">(</span><span class="n">det_poly</span> <span class="n">n</span><span class="o">)</span><span class="bp">.</span><span class="n">eval₂</span> <span class="n">coe</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">p</span><span class="o">,</span> <span class="n">M</span> <span class="n">p</span><span class="bp">.</span><span class="mi">1</span> <span class="n">p</span><span class="bp">.</span><span class="mi">2</span><span class="o">)</span> <span class="bp">=</span> <span class="n">M</span><span class="bp">.</span><span class="n">det</span> <span class="o">:=</span>
<span class="k">begin</span>
  <span class="n">unfold</span> <span class="n">det_poly</span> <span class="n">matrix</span><span class="bp">.</span><span class="n">det</span><span class="o">,</span>
  <span class="n">haveI</span> <span class="o">:</span> <span class="n">is_semiring_hom</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="bp">ℤ</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="bp">⟨</span><span class="n">int</span><span class="bp">.</span><span class="n">cast_zero</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_one</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_add</span><span class="o">,</span> <span class="n">int</span><span class="bp">.</span><span class="n">cast_mul</span><span class="bp">⟩</span><span class="o">,</span>
  <span class="n">haveI</span> <span class="o">:</span> <span class="n">is_ring_hom</span> <span class="o">(</span><span class="n">coe</span> <span class="o">:</span> <span class="bp">ℤ</span> <span class="bp">→</span> <span class="n">R</span><span class="o">)</span> <span class="o">:=</span> <span class="n">is_ring_hom</span><span class="bp">.</span><span class="n">of_semiring</span> <span class="bp">_</span><span class="o">,</span>
  <span class="n">simp_rw</span> <span class="o">[</span><span class="n">eval₂_sum</span><span class="o">,</span> <span class="n">eval₂_mul</span><span class="o">,</span> <span class="n">eval₂_int_cast</span><span class="o">,</span> <span class="n">eval₂_prod</span><span class="o">,</span> <span class="n">eval₂_X</span><span class="o">]</span>
<span class="kn">end</span>
</code></pre></div>



<a name="203498127"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203498127" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203498127">(Jul 10 2020 at 12:02)</a>:</h4>
<p>Dont we know that eval2 is a ring hom?</p>



<a name="203498393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203498393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203498393">(Jul 10 2020 at 12:06)</a>:</h4>
<p>I would expect something like <code>(eval2_hom f g).map_int_cast n</code> as proof term.</p>



<a name="203498458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203498458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203498458">(Jul 10 2020 at 12:06)</a>:</h4>
<p>like this? <a href="https://github.com/rwbarton/swan/blob/lean-3.4.2/src/for_mathlib/ring_hom_coe.lean">https://github.com/rwbarton/swan/blob/lean-3.4.2/src/for_mathlib/ring_hom_coe.lean</a></p>



<a name="203498486"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203498486" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203498486">(Jul 10 2020 at 12:06)</a>:</h4>
<p>but this is from ye olden days of 2019</p>



<a name="203499064"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203499064" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203499064">(Jul 10 2020 at 12:13)</a>:</h4>
<p>Is it planned to get this stuff into mathlib?</p>



<a name="203499103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203499103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203499103">(Jul 10 2020 at 12:13)</a>:</h4>
<p>Zulip lacks <code>:swan:</code>...</p>



<a name="203499173"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203499173" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203499173">(Jul 10 2020 at 12:14)</a>:</h4>
<p>this is about all the stuff there is here</p>



<a name="203506620"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203506620" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203506620">(Jul 10 2020 at 13:33)</a>:</h4>
<p>if only mv_polynomial were computable</p>



<a name="203506647"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203506647" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203506647">(Jul 10 2020 at 13:33)</a>:</h4>
<p>then we can have explicit formulas of determinants easily</p>



<a name="203506699"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/golf%20challenge/near/203506699" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/golf.20challenge.html#203506699">(Jul 10 2020 at 13:33)</a>:</h4>
<p><code>simp</code> should be able to make it easy nonetheless.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>