---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html">Simp normal form: coe_norm_subgroup, submodule.norm_coe</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="267851114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267851114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267851114">(Jan 13 2022 at 10:45)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/coe_norm_subgroup">docs#coe_norm_subgroup</a> and <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.norm_coe">docs#submodule.norm_coe</a> are two <code>simp</code> lemmas pointing in opposite directions. Is there a reason for this discrepancy?</p>
<p>The reason I ask is that I'm defining subobject classes in the same style as morphism classes. The instance <a href="https://leanprover-community.github.io/mathlib_docs/find/add_subgroup.semi_normed_group">docs#add_subgroup.semi_normed_group</a> can be easily generalized to <code>add_subgroup_class</code>, but that would lead to a cycle in the <code>simp</code> set since submodule is also an <code>add_subgroup_class</code>.</p>



<a name="267851631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267851631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267851631">(Jan 13 2022 at 10:50)</a>:</h4>
<p>Outside of implicit use by <code>simp</code> or <code>norm_cast</code>, I see only one use for each (in a forward <code>rw</code>)</p>



<a name="267851765"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267851765" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267851765">(Jan 13 2022 at 10:51)</a>:</h4>
<p>I think <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.norm_mk">docs#submodule.norm_mk</a> is perfectly fine: morally <code>x=⟨x, hx⟩</code>, so if <code>simp</code> throws <code>hx</code> away I don't see how one cannot be happy.</p>



<a name="267851857"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267851857" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267851857">(Jan 13 2022 at 10:52)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/coe_norm_subgroup">docs#coe_norm_subgroup</a> is probably rarely used, we don't have <code>x : ↥s</code> very often</p>



<a name="267852012"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267852012" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267852012">(Jan 13 2022 at 10:53)</a>:</h4>
<p>That was my impression too, without any real experience of this part of the library. I'll see what breaks if I turn <code>coe_norm_subgroup</code> the other way (in preparation for removing it entirely).</p>



<a name="267852023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267852023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267852023">(Jan 13 2022 at 10:53)</a>:</h4>
<p>Sorry, for some reason my browser pointed at <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.norm_mk">docs#submodule.norm_mk</a> instead of <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.norm_coe">docs#submodule.norm_coe</a>  so I misunderstood your question</p>



<a name="267853896"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267853896" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267853896">(Jan 13 2022 at 11:09)</a>:</h4>
<p><code>∥x∥ = ∥↑x∥</code> seems like the better direction to me - most of the <code>coe_*</code> lemmas are about pushing <code>coe</code> to the innermost position</p>



<a name="267853986"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267853986" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267853986">(Jan 13 2022 at 11:10)</a>:</h4>
<p>In this case it just so happens there is no outermost coe, but it still turns an operation on the subtype into an operation on the underlying type.</p>



<a name="267855435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267855435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267855435">(Jan 13 2022 at 11:25)</a>:</h4>
<p>On the other hand, <code>norm_cast</code> wants <code>coe_norm_subgroup</code> to be reversed since it introduces a cast as-is.</p>



<a name="267855880"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267855880" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267855880">(Jan 13 2022 at 11:29)</a>:</h4>
<p>Is there any documentation on the rules for annotating things with <code>norm_cast</code> or <code>norm_cast move</code> or ...?</p>



<a name="267856077"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267856077" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267856077">(Jan 13 2022 at 11:31)</a>:</h4>
<p>The <a href="https://leanprover-community.github.io/mathlib_docs/attributes.html#norm_cast%20attributes">attribute docs</a> for <code>norm_cast</code> explain it a bit.</p>



<a name="267856210"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267856210" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267856210">(Jan 13 2022 at 11:32)</a>:</h4>
<p>As I understand it, the LHS generally should have more casts.</p>



<a name="267858533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267858533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267858533">(Jan 13 2022 at 11:57)</a>:</h4>
<p>I created two branches, both seem to work fine on the basic files: <a href="https://github.com/leanprover-community/mathlib/tree/reverse-coe_norm_subgroup">branch#reverse-coe_norm_subgroup</a> and <a href="https://github.com/leanprover-community/mathlib/tree/reverse-submodule_norm_coe">branch#reverse-submodule_norm_coe</a></p>



<a name="267859343"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267859343" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267859343">(Jan 13 2022 at 12:04)</a>:</h4>
<p>/poll <code>∥(↑x : E)∥ = ∥(x : s)∥</code> or <code>∥(x : s)∥ = ∥(↑x : E)∥</code><br>
<code>∥(↑x : E)∥ = ∥(x : s)∥</code> (<a href="https://github.com/leanprover-community/mathlib/tree/reverse-coe_norm_subgroup">branch#reverse-coe_norm_subgroup</a>)<br>
<code>∥(x : s)∥ = ∥(↑x : E)∥</code> (<a href="https://github.com/leanprover-community/mathlib/tree/reverse-submodule_norm_coe">branch#reverse-submodule_norm_coe</a>)</p>



<a name="267861410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267861410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267861410">(Jan 13 2022 at 12:25)</a>:</h4>
<p>It's just a fact that sometimes mathematicians want to push coercions in and sometimes pull them out, so it's difficult to know what "the right direction" is.</p>



<a name="267878839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Simp%20normal%20form%3A%20coe_norm_subgroup%2C%20submodule.norm_coe/near/267878839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Simp.20normal.20form.3A.20coe_norm_subgroup.2C.20submodule.2Enorm_coe.html#267878839">(Jan 13 2022 at 14:49)</a>:</h4>
<p>Since consensus points toward inserting the coercion: <a href="https://github.com/leanprover-community/mathlib/pull/11427">#11427</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>