---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/fact.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html">fact</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="196959849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196959849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196959849">(May 08 2020 at 22:57)</a>:</h4>
<p>I just learned that <code>fact</code> doesn't mean factorial in Lean, and if <code>nat</code> is open, <code>#check fact</code> is ambiguous. Doesn't that seem unfortunate?</p>



<a name="196969679"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196969679" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196969679">(May 09 2020 at 02:46)</a>:</h4>
<p>It's a new design in mathlib. It's actually not a shorthand for anything but it helps us have propositions as type classes. We could put it in its own namespace to minimize this kind of surprise</p>



<a name="196970148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196970148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196970148">(May 09 2020 at 03:00)</a>:</h4>
<p>I agree that it is a bit unfortunate. <span class="user-mention" data-user-id="110865">@Jeremy Avigad</span> I usually write <code>n.fact</code> to get around this, and it also reads nice. Even better would be to add</p>
<div class="codehilite"><pre><span></span><code><span class="n">localized</span> <span class="s2">&quot;postfix `!` := nat.fact&quot;</span> <span class="k">in</span> <span class="n">nat</span>
</code></pre></div>


<p>To the <code>data/nat/fact</code> file. (Modulo trivial typos). Then we can simply write <code>n!</code> after <code>open_locale nat</code>.</p>



<a name="196970163"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196970163" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196970163">(May 09 2020 at 03:02)</a>:</h4>
<p>We could also rename <code>nat.fact</code> to <code>nat.factorial</code></p>



<a name="196970347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196970347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196970347">(May 09 2020 at 03:06)</a>:</h4>
<p>I think we should do all of those (-;</p>



<a name="196977775"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196977775" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196977775">(May 09 2020 at 07:08)</a>:</h4>
<p>I'm fine with <code>factorial</code>, it's unambiguous. Mathematicians have this great notation <code>!</code> for it though :-) How about getting that working then nobody needs to worry about the name :-)</p>



<a name="196979306"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196979306" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Hughes <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196979306">(May 09 2020 at 07:57)</a>:</h4>
<p>The lemmas still use the name.</p>



<a name="196981671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196981671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196981671">(May 09 2020 at 09:03)</a>:</h4>
<p>I think it makes sense that <code>fact</code> is the abbreviation of the word fact instead of the abbreviation of the word factorial.</p>



<a name="196981784"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196981784" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196981784">(May 09 2020 at 09:07)</a>:</h4>
<p>There are other reasonable synonyms for <code>fact</code>: <code>given</code> or <code>assuming</code> come to mind quickly.  But there aren't that many other names for <code>factorial</code>, and <code>n.factorial</code> is quite a bit longer than <code>n.fact</code>.  Though the postfix notation also looks nice.</p>



<a name="196982149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196982149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196982149">(May 09 2020 at 09:19)</a>:</h4>
<p>In fact, <code>fact</code> is one of those "filler" words that conveys little meaning here. Why not something like <code>to_typeclass</code> that says something more informative?</p>



<a name="196986649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/196986649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#196986649">(May 09 2020 at 11:18)</a>:</h4>
<p><code>[witness P]</code>?</p>



<a name="208493782"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/208493782" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#208493782">(Aug 30 2020 at 16:52)</a>:</h4>
<p>What's the story with global instances of <code>fact</code>? I was under the vague impression that there weren't supposed to be any, but some do exist.</p>



<a name="208499442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/208499442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#208499442">(Aug 30 2020 at 19:05)</a>:</h4>
<p>My understanding was "don't make too many", rather than "don't many any at all"</p>



<a name="208505069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/208505069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#208505069">(Aug 30 2020 at 21:28)</a>:</h4>
<p>I prefer to only have local(ized) instances, but I'm also fine with the looser "don't have many"</p>



<a name="208512555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/208512555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#208512555">(Aug 31 2020 at 01:06)</a>:</h4>
<p>I feel like this is something we could easily regret later. I'd vote for "none, unless they come with a detailed doc-string explaining exactly why <code>local attribute [instance]</code> won't cut it".</p>



<a name="208512564"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/208512564" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#208512564">(Aug 31 2020 at 01:06)</a>:</h4>
<p>Ideally enforced by the linter! :-)</p>



<a name="275015750"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/275015750" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#275015750">(Mar 11 2022 at 18:43)</a>:</h4>
<p>Hi! I'm wondering why this lemma doesn't see <code>hp</code> and fails to synthesize a type class instance of <code>fact p.prime</code>.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.field</span>
<span class="kn">import</span> <span class="n">algebra.char_p</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">fact</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">char_p</span> <span class="n">F</span> <span class="n">p</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">test</span> <span class="o">:</span> <span class="o">(</span><span class="n">frobenius</span> <span class="n">F</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="gr">sorry</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>



<a name="275015949"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/275015949" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#275015949">(Mar 11 2022 at 18:45)</a>:</h4>
<p>Oh nevermind this seems to work.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.field</span>
<span class="kn">import</span> <span class="n">algebra.char_p</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">[</span><span class="n">fact</span> <span class="n">p.prime</span><span class="o">]</span> <span class="o">[</span><span class="n">field</span> <span class="n">F</span><span class="o">]</span> <span class="o">[</span><span class="n">char_p</span> <span class="n">F</span> <span class="n">p</span><span class="o">]</span>

<span class="kd">lemma</span> <span class="n">test</span> <span class="o">:</span> <span class="o">(</span><span class="n">frobenius</span> <span class="n">F</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="gr">sorry</span> <span class="o">:=</span>
<span class="gr">sorry</span>
</code></pre></div>
<p>Why is it that naming the fact <code>hp</code> suddenly makes it fail?</p>



<a name="275016154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/275016154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#275016154">(Mar 11 2022 at 18:47)</a>:</h4>
<p>If you name an instance then it doesn't get included automatically in the local context unless the name is mentioned in the statement of the lemma. You can see just clicking before the final <code>sorry</code> that the instance is not present in the first situation and is there in the second.</p>



<a name="275016585"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/275016585" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#275016585">(Mar 11 2022 at 18:50)</a>:</h4>
<p>(also, in your first example you didn't even have it in instance brackets!)</p>



<a name="275016590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/275016590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#275016590">(Mar 11 2022 at 18:51)</a>:</h4>
<p>The first one also is using parentheses instead of square brackets, which is another reason it fails. I keep rediscovering and forgetting the rule Kevin's mentioned, that even if it were <code>[hp : fact p.prime]</code> it wouldn't be included.</p>



<a name="275016835"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/275016835" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ashwin Iyengar <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#275016835">(Mar 11 2022 at 18:52)</a>:</h4>
<p>thanks all! that makes sense.</p>



<a name="275022431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/fact/near/275022431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/fact.html#275022431">(Mar 11 2022 at 19:28)</a>:</h4>
<p>One thing that clarified this stuff for me is that Lean doesn't really care much about what kind of brackets you use before the colon when elaborating:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.char_p</span>

<span class="c1">-- works even though we use round brackets</span>
<span class="kd">lemma</span> <span class="n">test</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">)</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">(</span><span class="n">h0</span> <span class="o">:</span> <span class="n">fact</span> <span class="n">p.prime</span><span class="o">)</span> <span class="o">(</span><span class="n">hF</span> <span class="o">:</span> <span class="n">field</span> <span class="n">F</span><span class="o">)</span> <span class="o">(</span><span class="n">hp</span> <span class="o">:</span> <span class="n">char_p</span> <span class="n">F</span> <span class="n">p</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">frobenius</span> <span class="n">F</span> <span class="n">p</span><span class="o">)</span> <span class="bp">=</span> <span class="gr">sorry</span> <span class="o">:=</span>
<span class="gr">sorry</span>

<span class="c">/-</span><span class="cm"></span>
<span class="cm">frobenius : Π (R : Type u) [_inst_1 : comm_semiring R] (p : ℕ)</span>
<span class="cm">[_inst_3 : fact (nat.prime p)] [_inst_4 : char_p R p], R →+* R</span>
<span class="cm">-/</span>
</code></pre></div>
<p>My mental model a while ago was that this would fail because type class inference won't find <code>comm_semiring F</code> or <code>fact p.prime</code> -- but it finds them just fine. With a revised mental model it's easy to understand the labelling thing: I wouldn't expect <code>variable (Y : Type)</code> to be included in a lemma statement if it didn't mention <code>Y</code>, so similarly I wouldn't expect <code>variable [hp : fact p.prime]</code> to be included in a statement if it doesn't mention <code>hp</code>.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>