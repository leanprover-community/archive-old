---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Guide.20to.20writing.20tactics.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html">Guide to writing tactics</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="268056692"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268056692" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268056692">(Jan 14 2022 at 18:57)</a>:</h4>
<p>I've spent the last few weeks learning to write tactics.  I learned a lot by trial and error, and decided to write up what I've learned in a Guide to Writing Tactics.  I'd welcome feedback on this, especially corrections of any errors I've made.<br>
  -Dan Velleman<br>
<a href="/user_uploads/3121/mqEJI5ZdyytcJnb1L3wWGhQD/TacticGuide.pdf">TacticGuide.pdf</a></p>



<a name="268057243"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268057243" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268057243">(Jan 14 2022 at 19:01)</a>:</h4>
<p>First remark without reading any word: it would be much nicer with syntax highlighting.</p>



<a name="268057302"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268057302" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268057302">(Jan 14 2022 at 19:01)</a>:</h4>
<p>In section 1, it is not true that <code>let</code> cannot stand on its own, but the syntax is slightly different. In a <code>do</code> block it has the syntax <code>let x : T := e,</code> and outside a <code>do</code> block it is <code>let x : T := e in e'</code></p>



<a name="268057645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268057645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268057645">(Jan 14 2022 at 19:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113488-general/topic/Guide.20to.20writing.20tactics/near/268057243">said</a>:</p>
<blockquote>
<p>First remark without reading any word: it would be much nicer with syntax highlighting.</p>
</blockquote>
<p>I've wondered it before, how to get proper Lean syntax highlight in LaTex?</p>



<a name="268057814"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268057814" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268057814">(Jan 14 2022 at 19:04)</a>:</h4>
<p><a href="https://github.com/leanprover-community/lean/blob/master/extras/latex/lstlean.md">https://github.com/leanprover-community/lean/blob/master/extras/latex/lstlean.md</a></p>



<a name="268057930"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268057930" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268057930">(Jan 14 2022 at 19:05)</a>:</h4>
<p>What I meant by "cannot stand on its own" is that it has to be followed by either ", e'" or "in e'".  The example I give with if-then-else illustrates the point I was trying to make, but perhaps it isn't clear enough.</p>



<a name="268058073"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268058073" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Taucher <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268058073">(Jan 14 2022 at 19:06)</a>:</h4>
<p>Could this be the start of a new book?</p>



<a name="268058268"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268058268" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268058268">(Jan 14 2022 at 19:08)</a>:</h4>
<blockquote>
<p>Think of a tactic string as a box that contains a string, together with all of the other information needed to deal with the complications described earlier that arise when one tactic calls another. </p>
</blockquote>
<p>This should somehow be adjusted to reflect that <code>tactic string</code> is a function that can be called, not a value to be unwrapped. You can call a tactic multiple times and get different results</p>



<a name="268058565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268058565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268058565">(Jan 14 2022 at 19:10)</a>:</h4>
<p><span class="user-mention silent" data-user-id="366057">Eric Taucher</span> <a href="#narrow/stream/113488-general/topic/Guide.20to.20writing.20tactics/near/268058073">said</a>:</p>
<blockquote>
<p>Could this be the start of a new book?</p>
</blockquote>
<p>There's always the old book: <a href="https://leanprover.github.io/programming_in_lean/programming_in_lean.pdf">https://leanprover.github.io/programming_in_lean/programming_in_lean.pdf</a></p>
<p>There's also Rob Lewis' videos at <a href="https://www.youtube.com/watch?v=o6oUjcE6Nz4&amp;list=PLlF-CfQhukNlxexiNJErGJd2dte_J1t1N&amp;index=19">https://www.youtube.com/watch?v=o6oUjcE6Nz4&amp;list=PLlF-CfQhukNlxexiNJErGJd2dte_J1t1N&amp;index=19</a> (and see other links in the description)</p>
<div class="youtube-video message_inline_image"><a data-id="o6oUjcE6Nz4" href="https://www.youtube.com/watch?v=o6oUjcE6Nz4&amp;list=PLlF-CfQhukNlxexiNJErGJd2dte_J1t1N&amp;index=19"><img src="https://uploads.zulipusercontent.net/91bdd8086a19f2547ba6eb478268759aecf3a000/68747470733a2f2f692e7974696d672e636f6d2f76692f6f366f556a6345364e7a342f64656661756c742e6a7067"></a></div>



<a name="268058810"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268058810" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268058810">(Jan 14 2022 at 19:13)</a>:</h4>
<p>The discussion about backtick names reminds me of a recent run-in I had with the computer modern backtick character, which looks way too much like an apostrophe. I suggest changing the font to something that makes this more visually distinctive</p>



<a name="268058823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268058823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268058823">(Jan 14 2022 at 19:13)</a>:</h4>
<p>I'm not sure I understand the comment about <code>tactic string</code>.  The tactic itself is a function that can be called multiple times with different results.  But what it returns is like a box with a string (and other stuff) inside, isn't it?  Isn't <code>tactic string</code> specifying the type of what is returned?</p>



<a name="268058904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268058904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268058904">(Jan 14 2022 at 19:13)</a>:</h4>
<p>the "box containing a string" is actually <code>interaction_monad.result tactic_state string</code>, and <code>tactic string</code> is defined as <code>tactic_state -&gt; interaction_monad.result tactic_state string</code></p>



<a name="268059022"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268059022" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268059022">(Jan 14 2022 at 19:14)</a>:</h4>
<p>That is, <code>tactic string</code> is literally a function taking an opaque object of type <code>tactic_state</code> into some kind of box containing a new <code>tactic_state</code> and a <code>string</code></p>



<a name="268059070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268059070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268059070">(Jan 14 2022 at 19:15)</a>:</h4>
<p>This is relevant in the implementation of functions like <a href="https://leanprover-community.github.io/mathlib_docs/find/tactic.try/src">src#tactic.try</a></p>



<a name="268059088"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268059088" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268059088">(Jan 14 2022 at 19:15)</a>:</h4>
<p>I've quickly read the whole thing. It's nice but I don't see much that isn't covered in our standard tutorial <a href="https://leanprover-community.github.io/extras/tactic_writing.html">https://leanprover-community.github.io/extras/tactic_writing.html</a></p>



<a name="268059419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268059419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268059419">(Jan 14 2022 at 19:18)</a>:</h4>
<p>Thanks Mario.  That makes sense.</p>



<a name="268061103"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268061103" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268061103">(Jan 14 2022 at 19:32)</a>:</h4>
<p>Lots of great material on this thread. Thanks everyone!<br>
And Thanks Dan, I love reading/learning the same subject from various perspectives <span aria-label="pray" class="emoji emoji-1f64f" role="img" title="pray">:pray:</span></p>



<a name="268061650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268061650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Taucher <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268061650">(Jan 14 2022 at 19:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/Guide.20to.20writing.20tactics/near/268058565">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="366057">Eric Taucher</span> <a href="#narrow/stream/113488-general/topic/Guide.20to.20writing.20tactics/near/268058073">said</a>:</p>
<blockquote>
<p>Could this be the start of a new book?</p>
</blockquote>
<p>There's always the old book: </p>
</blockquote>
<p>I knew someone would think that, I didn't expect it would be you. Dan knows what I am talking about.</p>



<a name="268062040"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268062040" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268062040">(Jan 14 2022 at 19:40)</a>:</h4>
<p>Continuing the discussion of <code>tactic string</code>:  I take it that a more accurate explanation of the meaning of <code>s \leftarrow T</code> would be something like:  Run T.  Apply the returned tactic string to the current proof state to get a box containing the new state and a string.  Remove the string from the box and assign it to s, and pass the new state on to the next step?</p>



<a name="268062298"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268062298" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268062298">(Jan 14 2022 at 19:42)</a>:</h4>
<p>"Run <code>T</code>" only makes sense with the current proof state. A term of type <code>tactic s</code> is like a function from <code>tactic_state</code> to <code>s × tactic_state</code> (with the possibility of failure, as discussed).</p>



<a name="268062444"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268062444" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268062444">(Jan 14 2022 at 19:44)</a>:</h4>
<p>So the meaning of <code>s ← T</code> is "run <code>T</code> on the current proof state. Unbox the result; assign the string component to <code>s</code>, and update the proof state to the new one returned by <code>T</code>."</p>



<a name="268062469"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268062469" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268062469">(Jan 14 2022 at 19:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="366057">Eric Taucher</span> <a href="#narrow/stream/113488-general/topic/Guide.20to.20writing.20tactics/near/268061650">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/Guide.20to.20writing.20tactics/near/268058565">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="366057">Eric Taucher</span> <a href="#narrow/stream/113488-general/topic/Guide.20to.20writing.20tactics/near/268058073">said</a>:</p>
<blockquote>
<p>Could this be the start of a new book?</p>
</blockquote>
<p>There's always the old book: </p>
</blockquote>
<p>I knew someone would think that, I didn't expect it would be you. Dan knows what I am talking about.</p>
</blockquote>
<p>Oh you mean Dan's old book :-) Yeah I was just pointing out the abandoned "Programming in Lean" book which nobody ever talks about any more but which has some info about tactic writing. Sorry for the crossed wires!</p>



<a name="268062529"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268062529" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268062529">(Jan 14 2022 at 19:44)</a>:</h4>
<p>Or "pass on the proof state to the next step" instead of "update," if you prefer!</p>



<a name="268062817"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268062817" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268062817">(Jan 14 2022 at 19:47)</a>:</h4>
<p>PiL was the book which taught me what a monad was, which is pretty much the limit of my understanding of what <code>tactic X</code> means.</p>



<a name="268106051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268106051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268106051">(Jan 15 2022 at 05:21)</a>:</h4>
<p>I really like this document! It's the first thing I've read which clearly explains the description between pre-expressions and expressions.</p>



<a name="268148283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268148283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268148283">(Jan 15 2022 at 21:32)</a>:</h4>
<p>Here's an updated version with syntax highlighting (thanks Mario for the link to Jeremy's lstlean file), corrections to the explanation of <code>tactic string</code> (thanks Mario and Rob for explaining this; I hope I have it right now), and some additional material on how to call tactics in the library.<br>
<a href="/user_uploads/3121/9Zt_fQ_AbwyDrz_EAIQLBlNk/TacticGuidell.pdf">TacticGuidell.pdf</a></p>



<a name="268181286"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Guide%20to%20writing%20tactics/near/268181286" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Dan Velleman <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Guide.20to.20writing.20tactics.html#268181286">(Jan 16 2022 at 12:17)</a>:</h4>
<p>OK, final version, with an illustration of the use of &lt;|&gt; at the end.<br>
<a href="/user_uploads/3121/sTt0HtbubzJwl1ZYkLpLRetd/TacticGuide.pdf">TacticGuide.pdf</a></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>