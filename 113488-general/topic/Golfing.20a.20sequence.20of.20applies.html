---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html">Golfing a sequence of applies</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="279424262"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279424262" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279424262">(Apr 19 2022 at 15:23)</a>:</h4>
<p>I'm trying to get better at golfing proofs and I was wondering if there is some nice golfing one can do with things of the form:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">My_lem</span> <span class="o">:</span> <span class="n">foo</span>  <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">A</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">B</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">C</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">C</span><span class="o">,</span>
 <span class="kd">end</span>
</code></pre></div>
<p>I've got quite a few of these (specially when proving some function is continuous, like in <a href="https://github.com/leanprover-community/mathlib/pull/13500">#13500</a>) and it feels like there is just something basic I'm missing (or perhaps I shouldn't be proving things this way!).</p>



<a name="279424385"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279424385" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279424385">(Apr 19 2022 at 15:24)</a>:</h4>
<p><code>apply_rules</code> maybe?</p>



<a name="279424392"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279424392" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279424392">(Apr 19 2022 at 15:24)</a>:</h4>
<p><code>refine A (B $ C $ C _)</code> with maybe some more underscores in between?</p>



<a name="279425113"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279425113" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279425113">(Apr 19 2022 at 15:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies/near/279424385">said</a>:</p>
<blockquote>
<p><code>apply_rules</code> maybe?</p>
</blockquote>
<p>Oh I didn't know about this, it seems to help sometimes, thanks!</p>



<a name="279425176"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279425176" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Chris Birkbeck <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279425176">(Apr 19 2022 at 15:29)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies/near/279424392">said</a>:</p>
<blockquote>
<p><code>refine A (B $ C $ C _)</code> with maybe some more underscores in between?</p>
</blockquote>
<p>Ah thanks, I'd not thought of trying to use a refine here, it also works for some of them!</p>



<a name="279425614"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279425614" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279425614">(Apr 19 2022 at 15:32)</a>:</h4>
<p>Yael's tip, together with the use of projection notation (<code>continuous_on_const.smul hf</code> instead of <code>continuous_on.smul continuous_on_const hf</code>) can greatly shrink the size of some of your continuity proofs.</p>



<a name="279440025"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279440025" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279440025">(Apr 19 2022 at 17:10)</a>:</h4>
<p>Also lumping them together in a <code>show_term { tactics }</code> will give you a single expression.  Whether it is reasonable or not, depends on what you feed it!</p>
<p>In the case you give, it should return an output similar to what Yaël describes.  I'm not sure if it will use dot-notation aggressively, though.  It wi also fill in all the underscores, some of which you can replace again with underscores.</p>



<a name="279443813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279443813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Johnson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279443813">(Apr 19 2022 at 17:40)</a>:</h4>
<p>Maybe it would be useful if we had a tactic like this:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">section</span>
<span class="n">setup_tactic_parser</span>
<span class="kd">meta</span> <span class="kd">def</span> <span class="n">tactic.interactive.apply_list</span> <span class="o">:</span> <span class="n">parse</span> <span class="n">pexpr_list</span> <span class="bp">→</span> <span class="n">tactic</span> <span class="n">unit</span> <span class="o">:=</span>
<span class="n">monad.mapm'</span> <span class="n">tactic.interactive.apply</span>
<span class="kd">end</span>
</code></pre></div>
<p>The proof would simply be <code>apply_list [A, B, C, C]</code> and we don't need to worry about underscores.</p>



<a name="279446089"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279446089" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279446089">(Apr 19 2022 at 17:58)</a>:</h4>
<p>If I have a proof which is only <code>apply</code> and <code>use</code> and <code>refine</code> and <code>exact</code> I usually change all the <code>apply</code>s and <code>use</code>s to <code>refine</code>s and then start doing the jigsaw puzzle to make it all into one line.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">apply</span> <span class="n">A</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">B</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">C</span><span class="o">,</span>
  <span class="n">apply</span> <span class="n">C</span><span class="o">,</span>
</code></pre></div>
<p>-&gt;</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code>  <span class="n">refine</span> <span class="n">A</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">refine</span> <span class="n">B</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span>
    <span class="n">refine</span> <span class="n">C</span> <span class="n">_</span><span class="o">,</span>
  <span class="n">refine</span> <span class="n">C</span> <span class="n">_</span><span class="o">,</span>
</code></pre></div>
<p>-&gt;</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">exact</span> <span class="n">A</span> <span class="o">(</span><span class="n">B</span> <span class="o">(</span><span class="n">C</span> <span class="n">_</span><span class="o">)</span> <span class="o">(</span><span class="n">C</span> <span class="n">_</span><span class="o">)</span>
</code></pre></div>



<a name="279446270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279446270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279446270">(Apr 19 2022 at 17:59)</a>:</h4>
<p>Isn't this exactly what <code>show_term</code> is useful for though? (Admittedly, I always forget about <code>show_term</code> myself)</p>



<a name="279473675"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Golfing%20a%20sequence%20of%20applies/near/279473675" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Golfing.20a.20sequence.20of.20applies.html#279473675">(Apr 19 2022 at 21:51)</a>:</h4>
<p><code>show_term</code> won't tell you which underscores are allowed, although you can always just try replacing things with <code>_</code></p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>