---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html">by exact works, but not the term itself</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="218056049"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218056049" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218056049">(Nov 27 2020 at 04:27)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.quot</span>
<span class="kd">variables</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span><span class="o">)</span> <span class="o">(</span><span class="n">π</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="o">)</span>

<span class="kd">inductive</span> <span class="n">rel</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span> <span class="bp">→</span> <span class="kt">Prop</span>
<span class="bp">|</span> <span class="n">of</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span><span class="o">}</span> <span class="o">:</span> <span class="n">r</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">rel</span> <span class="n">x</span> <span class="n">y</span>
<span class="bp">|</span> <span class="n">compat</span> <span class="o">{</span><span class="n">x</span> <span class="n">y</span><span class="o">}</span> <span class="o">:</span> <span class="n">rel</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">rel</span> <span class="o">(</span><span class="n">π</span> <span class="n">x</span><span class="o">)</span> <span class="o">(</span><span class="n">π</span> <span class="n">y</span><span class="o">)</span>
<span class="bp">|</span> <span class="n">refl</span> <span class="o">(</span><span class="n">x</span><span class="o">)</span> <span class="o">:</span> <span class="n">rel</span> <span class="n">x</span> <span class="n">x</span>
<span class="bp">|</span> <span class="n">symm</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span><span class="o">)</span> <span class="o">:</span> <span class="n">rel</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">rel</span> <span class="n">y</span> <span class="n">x</span>
<span class="bp">|</span> <span class="n">trans</span> <span class="o">(</span><span class="n">x</span> <span class="n">y</span> <span class="n">z</span><span class="o">)</span> <span class="o">:</span> <span class="n">rel</span> <span class="n">x</span> <span class="n">y</span> <span class="bp">→</span> <span class="n">rel</span> <span class="n">y</span> <span class="n">z</span> <span class="bp">→</span> <span class="n">rel</span> <span class="n">x</span> <span class="n">z</span>

<span class="kd">def</span> <span class="n">thing</span> <span class="o">:</span> <span class="n">setoid</span> <span class="n">α</span> <span class="o">:=</span> <span class="o">⟨</span><span class="n">rel</span> <span class="n">r</span> <span class="n">π</span><span class="o">,</span> <span class="o">⟨</span><span class="n">rel.refl</span><span class="o">,</span> <span class="n">rel.symm</span><span class="o">,</span> <span class="n">rel.trans</span><span class="o">⟩⟩</span>

<span class="kd">def</span> <span class="n">β</span> <span class="o">:=</span> <span class="n">quotient</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span>

<span class="kd">variable</span> <span class="o">{</span><span class="n">γ</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="c1">-- This works.</span>
<span class="kd">def</span> <span class="n">δ0</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="bp">→</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">quotient.lift</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">quotient.mk'</span> <span class="bp">$</span> <span class="n">π</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="kd">by</span> <span class="n">exact</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="n">quotient.sound'</span> <span class="bp">$</span> <span class="n">rel.compat</span> <span class="n">h</span><span class="o">))</span>

<span class="c1">-- This fails.</span>
<span class="kd">def</span> <span class="n">δ1</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="bp">→</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">quotient.lift</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">quotient.mk'</span> <span class="bp">$</span> <span class="n">π</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="n">quotient.sound'</span> <span class="bp">$</span> <span class="n">rel.compat</span> <span class="n">h</span><span class="o">)</span>
</code></pre></div>



<a name="218056095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218056095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218056095">(Nov 27 2020 at 04:28)</a>:</h4>
<p>What's happening here? How come <code>(by exact (λ x y h, quotient.sound' $ rel.compat h))</code> works but <code>(λ x y h, quotient.sound' $ rel.compat h)</code> doesn't?</p>



<a name="218056309"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218056309" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bryan Gin-ge Chen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218056309">(Nov 27 2020 at 04:34)</a>:</h4>
<p>Using <code>by exact term</code> causes Lean to delay the elaboration of <code>term</code> until the end, and this is sometimes more successful because more instances and other stuff have been figured out. Gabriel explained it better <a href="#narrow/stream/113488-general/topic/division.20and.20numerals/near/151794384">here</a>.</p>



<a name="218056439"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218056439" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218056439">(Nov 27 2020 at 04:39)</a>:</h4>
<p>That makes sense. Thanks <span class="user-mention" data-user-id="123965">@Bryan Gin-ge Chen</span></p>



<a name="218058786"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218058786" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218058786">(Nov 27 2020 at 05:54)</a>:</h4>
<p>in other words, because Lean is weird and that's just how things work</p>



<a name="218064988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218064988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218064988">(Nov 27 2020 at 08:04)</a>:</h4>
<p>It's because elaboration is hard and just because humans know the order to do things doesn't mean that computers do.</p>



<a name="218066156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218066156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218066156">(Nov 27 2020 at 08:23)</a>:</h4>
<p>How far into the expression can you push the <code>by exact</code>?</p>



<a name="218090923"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218090923" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218090923">(Nov 27 2020 at 13:18)</a>:</h4>
<p>I think it's the <code>rel.compat</code> causing the issue here... So I think putting the exact to the left of <code>rel.compat</code> should work too</p>



<a name="218090974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218090974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218090974">(Nov 27 2020 at 13:18)</a>:</h4>
<p>Is it possible to define \delta0 without any tactic mode and without any other definitions?</p>



<a name="218091499"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091499" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091499">(Nov 27 2020 at 13:24)</a>:</h4>
<p>I can't seem to move the <code>by exact</code> at all</p>



<a name="218091513"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091513" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091513">(Nov 27 2020 at 13:24)</a>:</h4>
<p>Oh</p>



<a name="218091645"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091645" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091645">(Nov 27 2020 at 13:26)</a>:</h4>
<p>I suspect things are going wrong for you because <code>setoid</code> is usually used as a typeclass instance, and that's not what you're doing here</p>



<a name="218091711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091711">(Nov 27 2020 at 13:27)</a>:</h4>
<p>This works:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">δ0'</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="bp">→</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="o">:=</span>
<span class="bp">@</span><span class="n">quotient.lift</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">quotient.mk'</span> <span class="bp">$</span> <span class="n">π</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="bp">@</span><span class="n">quotient.sound'</span> <span class="n">_</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">rel.compat</span> <span class="n">h</span><span class="o">))</span>
</code></pre></div>



<a name="218091732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091732">(Nov 27 2020 at 13:27)</a>:</h4>
<p>Because it prevents <code>quotient.sound'</code> using typeclass search to find the setoid</p>



<a name="218091820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091820">(Nov 27 2020 at 13:28)</a>:</h4>
<p><code>quotient.sound'</code> has no <code>[...]</code> in its type</p>



<a name="218091849"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091849" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091849">(Nov 27 2020 at 13:28)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself/near/218090974">said</a>:</p>
<blockquote>
<p>Is it possible to define \delta0 without any tactic mode and without any other definitions?</p>
</blockquote>
<p>Why do you want to avoid tactic mode? You're filling in a proof so there's no harm in using tactic mode.</p>



<a name="218091890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091890">(Nov 27 2020 at 13:29)</a>:</h4>
<p><span class="user-mention" data-user-id="110038">@Kevin Buzzard</span> just for a sanity check</p>



<a name="218091924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218091924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218091924">(Nov 27 2020 at 13:29)</a>:</h4>
<p><code>quotient.sound</code> uses typeclasses to find the equivalence relation, <code>quotient.sound'</code> uses unification.</p>



<a name="218092047"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092047" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092047">(Nov 27 2020 at 13:30)</a>:</h4>
<p>typeclasses are not appropriate here because the equivalence relation depends on the variable <code>π</code>.</p>



<a name="218092081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092081">(Nov 27 2020 at 13:31)</a>:</h4>
<p>And it's strange that <span class="user-mention" data-user-id="310045">@Eric Wieser</span> 's definition works!</p>



<a name="218092087"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092087" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092087">(Nov 27 2020 at 13:31)</a>:</h4>
<p>I think it doesn't help that you build the second quotient with <code>quotient.mk'</code> and Lean has no way to see yet what kind of quotient it should be</p>



<a name="218092097"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092097" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092097">(Nov 27 2020 at 13:31)</a>:</h4>
<p><code>def pre (π : α → α) := α</code> would give you something you can stick a typeclass on</p>



<a name="218092106"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092106" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092106">(Nov 27 2020 at 13:31)</a>:</h4>
<p>Why is it strange? He's filling in the relation.</p>



<a name="218092169"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092169" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092169">(Nov 27 2020 at 13:32)</a>:</h4>
<p>Oh nevermind thats right</p>



<a name="218092177"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092177" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092177">(Nov 27 2020 at 13:32)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">δ1</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="bp">→</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="o">:=</span> <span class="bp">@</span><span class="n">quotient.lift</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="bp">@</span><span class="n">quotient.mk'</span> <span class="n">α</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="bp">$</span> <span class="n">π</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="n">quotient.sound'</span> <span class="o">(</span><span class="n">rel.compat</span> <span class="n">h</span><span class="o">))</span>   <span class="c1">-- also works</span>
</code></pre></div>



<a name="218092208"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092208" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092208">(Nov 27 2020 at 13:32)</a>:</h4>
<p>because you use <code>@quotient.lift</code>, Lean won't use the expected type of the whole body to elaborate the arguments</p>



<a name="218092228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092228">(Nov 27 2020 at 13:32)</a>:</h4>
<p>so there is a bit of a puzzle for it to solve</p>



<a name="218092283"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092283" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092283">(Nov 27 2020 at 13:33)</a>:</h4>
<p>in <code>quotient.mk'</code>, what quotient? in <code>quotient.sound'</code>, what quotient?</p>



<a name="218092379"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092379" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092379">(Nov 27 2020 at 13:34)</a>:</h4>
<p>But humans can figure it out from the type of Delta, so why can't lean?</p>



<a name="218092408"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092408" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092408">(Nov 27 2020 at 13:34)</a>:</h4>
<p>Lean is not a human</p>



<a name="218092431"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092431" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092431">(Nov 27 2020 at 13:34)</a>:</h4>
<p>It can, when you tell it to use a certain elaboration strategy (with <code>by exact</code>).</p>



<a name="218092530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092530">(Nov 27 2020 at 13:35)</a>:</h4>
<p>I think what happens is (because of the outer <code>@</code>) Lean tries to elaborate all the arguments of <code>quotient.lift</code> before attempting to unify its type with the declared type of the definition</p>



<a name="218092657"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092657" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092657">(Nov 27 2020 at 13:36)</a>:</h4>
<p>and this strategy can't work because Lean would need to invent the term <code>thing r π</code> as the setoid on the target that it can prove using <code>rel.compat</code></p>



<a name="218092705"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092705" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092705">(Nov 27 2020 at 13:37)</a>:</h4>
<p>if you stick <code>by exact</code> in a certain place then Lean says "we'll figure this stuff out later" and then once it looks at the type of the <code>def</code> it knows what to do</p>



<a name="218092752"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218092752" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218092752">(Nov 27 2020 at 13:37)</a>:</h4>
<p>I see. So with Eric's code all lean has to do is unify the <code>thing ...</code> with the <code>setoid.r</code></p>



<a name="218093111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218093111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218093111">(Nov 27 2020 at 13:40)</a>:</h4>
<p>I'm not sure why there isn't a <code>quotient.lift'</code> to go with <code>mk'</code> and <code>sound'</code></p>



<a name="218093165"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218093165" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218093165">(Nov 27 2020 at 13:41)</a>:</h4>
<p>Sometimes (like here) it's annoying that using <code>@</code> to specify some implicit argument also changes the overall elaboration strategy</p>



<a name="218093187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218093187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218093187">(Nov 27 2020 at 13:41)</a>:</h4>
<p>I don't understand why setoid is a class anyway...</p>



<a name="218093461"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218093461" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218093461">(Nov 27 2020 at 13:44)</a>:</h4>
<p>With a <code>quotient.lift'</code> the natural thing with no <code>@</code>s or other funny business does work.</p>



<a name="218093485"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218093485" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218093485">(Nov 27 2020 at 13:44)</a>:</h4>
<p>I guess it just never came up before</p>



<a name="218093514"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218093514" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218093514">(Nov 27 2020 at 13:44)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself/near/218093187">said</a>:</p>
<blockquote>
<p>I don't understand why setoid is a class anyway...</p>
</blockquote>
<p>The old answer was "because it's in core".</p>



<a name="218094388"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218094388" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218094388">(Nov 27 2020 at 13:53)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">δ2</span> <span class="o">(</span><span class="n">q</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="o">:=</span> <span class="n">quotient.lift_on'</span> <span class="n">q</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">quotient.mk'</span> <span class="bp">$</span> <span class="n">π</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="bp">@</span><span class="n">quotient.sound'</span> <span class="n">_</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="n">_</span> <span class="n">_</span> <span class="o">(</span><span class="n">rel.compat</span> <span class="n">h</span><span class="o">))</span>
</code></pre></div>
<p>Only one <code>@</code></p>



<a name="218094435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218094435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218094435">(Nov 27 2020 at 13:53)</a>:</h4>
<p>but I couldn't get it down to 0</p>



<a name="218094828"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218094828" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218094828">(Nov 27 2020 at 13:57)</a>:</h4>
<p>does this count?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">local</span> <span class="kn">attribute</span> <span class="o">[</span><span class="n">elab_with_expected_type</span><span class="o">]</span> <span class="n">quotient.lift_on'</span>

<span class="kd">def</span> <span class="n">δ1</span> <span class="o">(</span><span class="n">q</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="o">:=</span> <span class="n">quotient.lift_on'</span> <span class="n">q</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">quotient.mk'</span> <span class="bp">$</span> <span class="n">π</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="n">quotient.sound'</span> <span class="o">(</span><span class="n">rel.compat</span> <span class="n">h</span><span class="o">))</span>
</code></pre></div>



<a name="218094957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218094957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218094957">(Nov 27 2020 at 13:58)</a>:</h4>
<p>for nondependent eliminators it's better not to use <code>elab_as_eliminator</code> I think</p>



<a name="218095371"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218095371" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218095371">(Nov 27 2020 at 14:02)</a>:</h4>
<p><a href="#narrow/stream/113488-general/topic/elab_as_eliminator/near/128740170">https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/elab_as_eliminator/near/128740170</a></p>



<a name="218095623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218095623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218095623">(Nov 27 2020 at 14:05)</a>:</h4>
<p>This works too</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">δ1</span> <span class="o">:</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="bp">→</span> <span class="n">β</span> <span class="n">r</span> <span class="n">π</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">quotient.lift_on'</span> <span class="n">x</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">a</span><span class="o">,</span> <span class="n">quot.mk</span> <span class="o">(</span><span class="n">thing</span> <span class="n">r</span> <span class="n">π</span><span class="o">)</span><span class="bp">.</span><span class="n">r</span> <span class="bp">$</span> <span class="n">π</span> <span class="n">a</span><span class="o">)</span>
<span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">h</span><span class="o">,</span> <span class="n">quot.sound</span> <span class="bp">$</span> <span class="n">rel.compat</span> <span class="n">h</span><span class="o">)</span>
</code></pre></div>



<a name="218095652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218095652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218095652">(Nov 27 2020 at 14:05)</a>:</h4>
<p>But the mixing of <code>quot</code> and <code>quotient</code> might make some people uneasy...</p>



<a name="218096325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218096325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218096325">(Nov 27 2020 at 14:12)</a>:</h4>
<p>I think the name <code>setoid</code> itself (and not something along the lines of <code>equivalence_relation</code>) partly explains why it would be a class</p>



<a name="218096393"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218096393" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218096393">(Nov 27 2020 at 14:13)</a>:</h4>
<p>but since Lean has quotients, it's sort of a vestigial thing</p>



<a name="218096525"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218096525" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218096525">(Nov 27 2020 at 14:14)</a>:</h4>
<p>Are there any guidelines for picking between <code>quotient</code> and <code>quot</code> in definitions?</p>



<a name="218096749"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218096749" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218096749">(Nov 27 2020 at 14:17)</a>:</h4>
<p>One reason (and this is why I'm using quotient in my case) is that I want to use <code>quotient.exact</code> in a proof somewhere in a nontrivial way. And using <code>quot.exact</code> instead would be annoying.</p>



<a name="218097237"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218097237" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218097237">(Nov 27 2020 at 14:22)</a>:</h4>
<p>The definition of the free algebra on a monoid used <code>quot</code> I believe, because after you make the polynomial ring with a variable for every element of the monoid you have a clear idea about which relations you _want_, but you don't have a handle on the equivalence relation generated by those relations, so <code>quot</code> is forced on you.</p>



<a name="218097316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218097316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218097316">(Nov 27 2020 at 14:23)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/f30200e5b17a3265b638103e7d47f8e4c83d6b07/src/linear_algebra/tensor_algebra.lean#L64">https://github.com/leanprover-community/mathlib/blob/f30200e5b17a3265b638103e7d47f8e4c83d6b07/src/linear_algebra/tensor_algebra.lean#L64</a></p>



<a name="218097433"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218097433" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218097433">(Nov 27 2020 at 14:25)</a>:</h4>
<p>This is probably a better example:<br>
<a href="https://github.com/leanprover-community/mathlib/blob/f30200e5b17a3265b638103e7d47f8e4c83d6b07/src/algebra/free_algebra.lean">https://github.com/leanprover-community/mathlib/blob/f30200e5b17a3265b638103e7d47f8e4c83d6b07/src/algebra/free_algebra.lean</a></p>



<a name="218097435"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218097435" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218097435">(Nov 27 2020 at 14:25)</a>:</h4>
<p>The issue that Amelia ran into with this definition was that now injectivity of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup><mo>→</mo><mi>R</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">M^{\otimes n}\to R[M]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span> was not clear, and with no handle on the actual equivalence relation seemed very difficult to prove.</p>



<a name="218097550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218097550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218097550">(Nov 27 2020 at 14:26)</a>:</h4>
<p>Amelia is now making another model for the tensor algebra, as a direct sum of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">M^{\otimes n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>. I found it interesting that even with the universal property and an explicit model, one still needed another model in order to prove some theorems (Amelia now has this second model in a branch of mathlib).</p>



<a name="218097636"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218097636" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218097636">(Nov 27 2020 at 14:27)</a>:</h4>
<p>On the other hand, in the representation theory of reductive groups, there is the theory of the Whittaker model and the theory of the Kirillov model, both of which are an explicit function space isomorphic to a given (generic) smooth admissible irreducible complex representation of (say) <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><msub><mi>L</mi><mn>2</mn></msub><mo stretchy="false">(</mo><msub><mi mathvariant="double-struck">Q</mi><mi>p</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">GL_2(\mathbb{Q}_p)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathnormal">G</span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbb">Q</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>.</p>



<a name="218097769"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218097769" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218097769">(Nov 27 2020 at 14:29)</a>:</h4>
<p>Another approach would have been to put a grading on the gigantic gadget, proved that all the relations were between things of the same grading, deduced that the associated ideal was graded and then got an induced grading on the quotient.</p>



<a name="218098310"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218098310" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218098310">(Nov 27 2020 at 14:35)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself/near/218097435">said</a>:</p>
<blockquote>
<p>The issue that Amelia ran into with this definition was that now injectivity of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup><mo>→</mo><mi>R</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">M^{\otimes n}\to R[M]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span> was not clear, and with no handle on the actual equivalence relation seemed very difficult to prove.</p>
</blockquote>
<p>I think I made a start on trying to prove this in <a href="https://github.com/leanprover-community/mathlib/issues/5034">#5034</a> via <a href="https://leanprover-community.github.io/mathlib_docs/find/free_algebra.equiv_monoid_algebra_free_monoid">docs#free_algebra.equiv_monoid_algebra_free_monoid</a>, but somehow got waylaid trying to prove <a href="https://leanprover-community.github.io/mathlib_docs/find/free_abelian_group.of">docs#free_abelian_group.of</a> was injective, which I couldn't do but also don't remember why I needed</p>



<a name="218098391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218098391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218098391">(Nov 27 2020 at 14:36)</a>:</h4>
<p>But that's ultimately the case you describe, of needing another model</p>



<a name="218098929"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218098929" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218098929">(Nov 27 2020 at 14:42)</a>:</h4>
<p>I was quite surprised by this from a psychological point of view -- the model in my head was that the universal property tells you that there's at most one object with the properties you want, and the construction -- any construction -- tells you that there's at least one. Here there seemed to be a benefit of more than one construction.</p>



<a name="218099130"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218099130" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218099130">(Nov 27 2020 at 14:45)</a>:</h4>
<p>The direct sum representation of the tensor algebra comes with its own headaches, right? For example, in proving associativity you need to show that two terms in a dependent type <code>T n</code>, <code>n : nat</code>, are equal for <code>n = (a + b) + c</code> and <code>n = a + (b + c)</code>.</p>



<a name="218099164"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218099164" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218099164">(Nov 27 2020 at 14:45)</a>:</h4>
<p>How did you avoid <code>heq</code> in this case?</p>



<a name="218099803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218099803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218099803">(Nov 27 2020 at 14:51)</a>:</h4>
<p>In my experience facing that, the proofs aren't impossible, it just makes your theorem statement ugly</p>



<a name="218099983"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218099983" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218099983">(Nov 27 2020 at 14:53)</a>:</h4>
<p>And using <code>heq</code> is not the end of the world</p>



<a name="218100556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218100556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218100556">(Nov 27 2020 at 14:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="310045">Eric Wieser</span> <a href="#narrow/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself/near/218098310">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="110038">Kevin Buzzard</span> <a href="#narrow/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself/near/218097435">said</a>:</p>
<blockquote>
<p>The issue that Amelia ran into with this definition was that now injectivity of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup><mo>→</mo><mi>R</mi><mo stretchy="false">[</mo><mi>M</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">M^{\otimes n}\to R[M]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">]</span></span></span></span> was not clear, and with no handle on the actual equivalence relation seemed very difficult to prove.</p>
</blockquote>
<p>I think I made a start on trying to prove this in <a href="https://github.com/leanprover-community/mathlib/issues/5034">#5034</a> via <a href="https://leanprover-community.github.io/mathlib_docs/find/free_algebra.equiv_monoid_algebra_free_monoid">docs#free_algebra.equiv_monoid_algebra_free_monoid</a>, but somehow got waylaid trying to prove <a href="https://leanprover-community.github.io/mathlib_docs/find/free_abelian_group.of">docs#free_abelian_group.of</a> was injective, which I couldn't do but also don't remember why I needed</p>
</blockquote>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">group_theory.free_abelian_group</span>

<span class="kd">universe</span> <span class="n">u</span>

<span class="kn">namespace</span> <span class="n">free_abelian_group</span>

<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kd">lemma</span> <span class="n">of_injective</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">:</span> <span class="n">function.injective</span> <span class="o">(</span><span class="n">of</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">free_abelian_group</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span>
<span class="bp">λ</span> <span class="n">x</span> <span class="n">y</span> <span class="n">hoxy</span><span class="o">,</span> <span class="n">classical.by_contradiction</span> <span class="bp">$</span> <span class="k">assume</span> <span class="n">hxy</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≠</span> <span class="n">y</span><span class="o">,</span>
<span class="k">let</span> <span class="n">f</span> <span class="o">:</span> <span class="n">free_abelian_group</span> <span class="n">α</span> <span class="bp">→+</span> <span class="n">ℤ</span> <span class="o">:=</span> <span class="n">lift</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">z</span><span class="o">,</span> <span class="k">if</span> <span class="n">x</span> <span class="bp">=</span> <span class="n">z</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span><span class="o">)</span> <span class="k">in</span>
<span class="k">have</span> <span class="n">hfx1</span> <span class="o">:</span> <span class="n">f</span> <span class="o">(</span><span class="n">of</span> <span class="n">x</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span><span class="n">lift.of</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="bp">$</span> <span class="n">if_pos</span> <span class="n">rfl</span><span class="o">,</span>
<span class="k">have</span> <span class="n">hfy1</span> <span class="o">:</span> <span class="n">f</span> <span class="o">(</span><span class="n">of</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span><span class="o">,</span> <span class="k">from</span> <span class="n">hoxy</span> <span class="bp">▸</span> <span class="n">hfx1</span><span class="o">,</span>
<span class="k">have</span> <span class="n">hfy0</span> <span class="o">:</span> <span class="n">f</span> <span class="o">(</span><span class="n">of</span> <span class="n">y</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">0</span><span class="o">,</span> <span class="k">from</span> <span class="o">(</span><span class="n">lift.of</span> <span class="n">_</span> <span class="n">_</span><span class="o">)</span><span class="bp">.</span><span class="n">trans</span> <span class="bp">$</span> <span class="n">if_neg</span> <span class="n">hxy</span><span class="o">,</span>
<span class="n">one_ne_zero</span> <span class="bp">$</span> <span class="n">hfy1.symm.trans</span> <span class="n">hfy0</span>

<span class="kd">end</span> <span class="n">free_abelian_group</span>
</code></pre></div>



<a name="218100841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218100841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218100841">(Nov 27 2020 at 15:01)</a>:</h4>
<p>You can play the same trick to prove the map from <code>M</code> to the tensor algebra is injective by mapping into the square-zero algebra generrated by <code>M</code>.</p>



<a name="218100928"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218100928" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218100928">(Nov 27 2020 at 15:02)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/5109">#5109</a></p>



<a name="218100976"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218100976" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218100976">(Nov 27 2020 at 15:02)</a>:</h4>
<p>but this doesn't scale to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">M^{\otimes n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> -- you might as well have used the direct sum construction</p>



<a name="218101043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218101043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218101043">(Nov 27 2020 at 15:03)</a>:</h4>
<p>Amelia has been dealing with <code>heq</code>. Chris Hughes knows some techniques for taming <code>heq</code>, he has been working with it for years, and Chris and Amelia are amongst a group of Imperial students all living in the same house share at the minute, so she's in a great position to pick up tips!</p>



<a name="218101129"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218101129" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218101129">(Nov 27 2020 at 15:04)</a>:</h4>
<p>@Kenny, is that PR'd anywhere?</p>



<a name="218101267"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218101267" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218101267">(Nov 27 2020 at 15:06)</a>:</h4>
<p>is what PR'd anywhere?</p>



<a name="218101316"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218101316" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218101316">(Nov 27 2020 at 15:06)</a>:</h4>
<p>The code snippet you pasted</p>



<a name="218101687"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218101687" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218101687">(Nov 27 2020 at 15:10)</a>:</h4>
<p>(I now remember that I wanted to prove that in order to prove that <a href="https://leanprover-community.github.io/mathlib_docs/find/free_ring.of">docs#free_ring.of</a> was injective)</p>



<a name="218102003"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218102003" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218102003">(Nov 27 2020 at 15:13)</a>:</h4>
<p>no, it is not PR'd anywhere</p>



<a name="218102020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218102020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218102020">(Nov 27 2020 at 15:13)</a>:</h4>
<p>feel free to PR it</p>



<a name="218102743"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218102743" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218102743">(Nov 27 2020 at 15:20)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/issues/5131">#5131</a></p>



<a name="218106517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218106517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218106517">(Nov 27 2020 at 16:01)</a>:</h4>
<p>Thanks for the hint <span class="user-mention" data-user-id="110064">@Kenny Lau</span>, that strategy works to prove that <code>free_algebra.ι</code> is injective too</p>



<a name="218106552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218106552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218106552">(Nov 27 2020 at 16:01)</a>:</h4>
<p>great</p>



<a name="218106686"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218106686" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218106686">(Nov 27 2020 at 16:03)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110064">Kenny Lau</span> <a href="#narrow/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself/near/218100976">said</a>:</p>
<blockquote>
<p>but this doesn't scale to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">M^{\otimes n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> -- you might as well have used the direct sum construction</p>
</blockquote>
<p>What is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">M^{\otimes n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span>?</p>



<a name="218106731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218106731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218106731">(Nov 27 2020 at 16:03)</a>:</h4>
<p>Assuming that's just the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>-th tensor powers, I don't see where the direct sum fits in</p>



<a name="218106804"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218106804" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218106804">(Nov 27 2020 at 16:04)</a>:</h4>
<p>because <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>⨁</mo><mrow><mi>n</mi><mo>=</mo><mn>0</mn></mrow><mi mathvariant="normal">∞</mi></msubsup><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">F(M) = \bigoplus_{n=0}^\infty M^{\otimes n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨁</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span></p>



<a name="218107085"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218107085" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218107085">(Nov 27 2020 at 16:07)</a>:</h4>
<p>Oh, were you talking about proving the injectivity of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mo>⊗</mo><mi>n</mi></mrow></msup><mo>→</mo><mi>F</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M^{\otimes n} \to F(M)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.771331em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.771331em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">⊗</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span>, which is difficult if you only have the universal property of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F(M)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span>?</p>



<a name="218107171"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218107171" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kenny Lau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218107171">(Nov 27 2020 at 16:08)</a>:</h4>
<p>yes</p>



<a name="218107251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/218107251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#218107251">(Nov 27 2020 at 16:09)</a>:</h4>
<p>Well thankfully we can't even state that yet using the definitions currently in mathlib...</p>



<a name="222461449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/by%20exact%20works%2C%20but%20not%20the%20term%20itself/near/222461449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself.html#222461449">(Jan 12 2021 at 17:00)</a>:</h4>
<p><span class="user-mention silent" data-user-id="243562">Adam Topaz</span> <a href="#narrow/stream/113488-general/topic/by.20exact.20works.2C.20but.20not.20the.20term.20itself/near/218100841">said</a>:</p>
<blockquote>
<p>You can play the same trick to prove the map from <code>M</code> to the tensor algebra is injective by mapping into the square-zero algebra generrated by <code>M</code>.</p>
</blockquote>
<p>Done in <a href="https://github.com/leanprover-community/mathlib/issues/5712">#5712</a>. Handily this works for the exterior_algebra too.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>