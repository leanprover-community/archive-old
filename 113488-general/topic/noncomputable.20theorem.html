---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/noncomputable.20theorem.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html">noncomputable theorem</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="136123067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136123067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136123067">(Oct 19 2018 at 16:38)</a>:</h4>
<p>Is there any sense in writing <code>noncomputable theorem</code>, as in mathlib <code>logic.basic</code> lines 516-519?</p>



<a name="136124051"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136124051" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136124051">(Oct 19 2018 at 16:52)</a>:</h4>
<p>What happens if you remove <code>noncomputable</code>?</p>



<a name="136124347"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136124347" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136124347">(Oct 19 2018 at 16:57)</a>:</h4>
<p>Probably I wait a long time for mathlib to rebuild and then nothing interesting happens--I've written lots of <code>theorem</code>s that use noncomputable things before.</p>



<a name="136124359"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136124359" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136124359">(Oct 19 2018 at 16:57)</a>:</h4>
<p>I wonder whether they should be <code>noncomputable def</code>, or just <code>theorem</code>, or maybe none of this matters</p>



<a name="136124519"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136124519" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136124519">(Oct 19 2018 at 16:59)</a>:</h4>
<p>Actually I could be wrong--these <code>theorem</code>s are special because their result types are not Props (that's why I'm looking at them), and maybe that is what triggers the <code>noncomputable</code> check</p>



<a name="136124688"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136124688" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136124688">(Oct 19 2018 at 17:01)</a>:</h4>
<p>Okay yes, that seems to be the case.</p>



<a name="136125141"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136125141" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136125141">(Oct 19 2018 at 17:08)</a>:</h4>
<p>I never thought about exactly what is going on with <code>def</code> and <code>theorem</code>. I guess the difference is like <code>let</code> vs <code>have</code>, that is, something defined with <code>def</code> can be replaced by its definition by one of the reduction rules, while something defined with <code>theorem</code> can't be replaced by, well, its proof?</p>



<a name="136125354"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136125354" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136125354">(Oct 19 2018 at 17:11)</a>:</h4>
<p>The VM can't reduce a <code>theorem</code> either, right? So why bother with the <code>noncomputable</code> check for theorems?</p>



<a name="136125488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136125488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136125488">(Oct 19 2018 at 17:13)</a>:</h4>
<p>In the case of <code>classical.dec</code> I guess someone decided that it was useless to allow it to be unfolded because it's essentially just an application of an axiom, and it's uniquely determined up to propositional equality, anyways?</p>



<a name="136125590"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136125590" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136125590">(Oct 19 2018 at 17:14)</a>:</h4>
<p>This all seems to make sense, I'm just not sure my mental picture is actually correct.</p>



<a name="136129728"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136129728" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136129728">(Oct 19 2018 at 18:21)</a>:</h4>
<p>I'm wondering if it's about generating byte code for the VM. If the theorem's type is in <code>Prop</code>, then, it doesn't matter.</p>



<a name="136129843"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136129843" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136129843">(Oct 19 2018 at 18:22)</a>:</h4>
<p>But otherwise, you may have to say explicitly "Don't generate code" with <code>noncomputable</code></p>



<a name="136143543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136143543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136143543">(Oct 19 2018 at 22:41)</a>:</h4>
<p>If you mark something as <em>either</em> <code>noncomputable</code> or <code>theorem</code>, then the VM does not generate code for the definition. This is why sometimes you get those errors about bytecode generation failed when you accidentally mark something as a <code>theorem</code></p>



<a name="136143755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136143755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136143755">(Oct 19 2018 at 22:45)</a>:</h4>
<p><code>noncomputable theorem</code> is almost always not needed, but it is used in a few specialized instances. One other consequence of defining something as a <code>theorem</code> is that it is "definition irrelevant", that is, lean will not generate or use the definitional equation for this definition. This is almost never appropriate for a <code>Type</code> valued expression, since it provides relations between definiendum and definiens that we can't otherwise recover. So the place where it makes sense is when the definition is already ambiguous, as in <code>classical.some</code> - unfolding it will not tell us any more about its value - and it is also using the axiom of choice so it should not have any code generation.</p>



<a name="136143757"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/136143757" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#136143757">(Oct 19 2018 at 22:45)</a>:</h4>
<p><span class="user-mention" data-user-id="110032">@Reid Barton</span></p>



<a name="177077487"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177077487" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177077487">(Oct 01 2019 at 17:23)</a>:</h4>
<p>As part of sanity_check cleanup, I tried making these theorems <code>dec</code>, <code>dec_eq</code>, <code>dec_rel</code> and <code>dec_pred</code> definitions, but it does cause an error later on:</p>
<div class="codehilite"><pre><span></span>D:\projects\mathlib2\src\ring_theory\unique_factorization_domain.lean:146:18: warning: failed to generate bytecode for &#39;of_unique_irreducible_factorization&#39;
</pre></div>


<p>Interestingly, when I mark that definition as <code>noncomputable</code>, I get two conflicting(?) errors:</p>
<div class="codehilite"><pre><span></span>D:\projects\mathlib2\src\ring_theory\unique_factorization_domain.lean:146:18: warning: definition &#39;of_unique_irreducible_factorization&#39; was incorrectly marked as noncomputable
D:\projects\mathlib2\src\ring_theory\unique_factorization_domain.lean:146:18: warning: failed to generate bytecode for &#39;of_unique_irreducible_factorization&#39;
</pre></div>


<p>For now, I just added the <code>sanity_skip</code> attribute to these decidability declarations.</p>



<a name="177087935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177087935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177087935">(Oct 01 2019 at 19:12)</a>:</h4>
<p>Hi, where are the definitions that you're trying to change from <code>theorem</code> to <code>def</code>? I mean, file/line.</p>



<a name="177087973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177087973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177087973">(Oct 01 2019 at 19:13)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/blob/master/src/logic/basic.lean#L593-L597" target="_blank" title="https://github.com/leanprover-community/mathlib/blob/master/src/logic/basic.lean#L593-L597">https://github.com/leanprover-community/mathlib/blob/master/src/logic/basic.lean#L593-L597</a></p>



<a name="177088346"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177088346" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177088346">(Oct 01 2019 at 19:17)</a>:</h4>
<p>BTW, is there any difference between <code>theorem</code> and <code>noncomputable theorem</code>? I mean, theorems do not generate bytecode anyway.</p>



<a name="177089515"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177089515" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177089515">(Oct 01 2019 at 19:30)</a>:</h4>
<p>Lean will try to generate bytecode for them, because their type is non a proposition. You get an error when you remove <code>noncomputable</code>.</p>



<a name="177089671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177089671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177089671">(Oct 01 2019 at 19:32)</a>:</h4>
<p>Does <code>noncomputable</code> infect the declarations that use them?</p>



<a name="177089848"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177089848" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177089848">(Oct 01 2019 at 19:34)</a>:</h4>
<p>I had a similar error when one of the dependencies of a <code>def</code> was marked as <code>theorem</code> instead of <code>def</code>. It was something like <code>induction_on</code> with output in <code>Sort</code>.</p>



<a name="177105951"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177105951" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177105951">(Oct 01 2019 at 23:01)</a>:</h4>
<p>The reason is that <code>letI</code> hides the definition behind <code>let ... in ...</code>, and Lean can't understand that <code>classical.choice</code> is used only in the proofs.</p>



<a name="177106045"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/177106045" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#177106045">(Oct 01 2019 at 23:03)</a>:</h4>
<p>A few ways to fix the problem: (a) use <code>haveI</code>; (b) move <code>letI</code> to the proof of <code>prime_factors</code>; (c) write <code>refine_struct { .. o }</code> before <code>letI</code>.</p>



<a name="261520332"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/noncomputable%20theorem/near/261520332" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/noncomputable.20theorem.html#261520332">(Nov 15 2021 at 16:18)</a>:</h4>
<p>It seems that the reason for using <code>noncomputable theorem</code> here no longer applies, as replacing it with <code>noncomputable def</code> as in <a href="https://github.com/leanprover-community/mathlib/issues/10292">#10292</a> seems to work just fine.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>