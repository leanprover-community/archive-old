---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Finding.20homes.20for.20lemmas.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html">Finding homes for lemmas</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="260255746"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260255746" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260255746">(Nov 04 2021 at 11:14)</a>:</h4>
<p>With the new <a href="https://eric-wieser.github.io/mathlib-import-graph/">import graph</a> and the corresponding <a href="https://leanprover-community.github.io/mathlib_docs/import.gexf">data file</a> hosted on the mathlib docs, it's now not too hard to answer the question "which file can my lemma go in":</p>
<div class="codehilite" data-code-language="Python"><pre><span></span><code><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="k">with</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"https://leanprover-community.github.io/mathlib_docs/import.gexf"</span><span class="p">)</span> <span class="k">as</span> <span class="n">r</span><span class="p">:</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gexf</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">))</span>

<span class="c1"># where you need the lemma, and which files it needs</span>
<span class="n">needed_in</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'mathlib:ring_theory.finiteness'</span><span class="p">,)</span>
<span class="n">needs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'mathlib:data.mv_polynomial.basic'</span><span class="p">,</span> <span class="s1">'mathlib:ring_theory.ideal.basic'</span><span class="p">)</span>

<span class="n">ok</span> <span class="o">=</span> <span class="p">(</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">,</span> <span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">needs</span><span class="p">])</span> <span class="o">&amp;</span>
      <span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">and_</span><span class="p">,</span> <span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">descendants</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">needed_in</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ok</span><span class="p">)</span>
</code></pre></div>
<p>This prints out</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">{</span><span class="bp">'</span><span class="n">mathlib</span><span class="o">:</span><span class="n">ring_theory.algebra_tower'</span><span class="o">,</span> <span class="bp">'</span><span class="n">mathlib</span><span class="o">:</span><span class="n">ring_theory.polynomial.basic'</span><span class="o">,</span> <span class="bp">'</span><span class="n">mathlib</span><span class="o">:</span><span class="n">ring_theory.adjoin.polynomial'</span><span class="o">,</span> <span class="bp">'</span><span class="n">mathlib</span><span class="o">:</span><span class="n">ring_theory.adjoin.fg'</span><span class="o">}</span>
</code></pre></div>



<a name="260256060"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256060" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256060">(Nov 04 2021 at 11:18)</a>:</h4>
<p>That's awesome! Can this become part of LP?</p>



<a name="260256081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256081">(Nov 04 2021 at 11:18)</a>:</h4>
<p>LP already has python API for this, but the problem is that it has to compute the import graph from scratch, and that's really slow</p>



<a name="260256111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256111">(Nov 04 2021 at 11:19)</a>:</h4>
<p>It could have a flag to use the online <code>gexf</code> file, instead of computing it from scratch.</p>



<a name="260256134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256134">(Nov 04 2021 at 11:19)</a>:</h4>
<p>Alternative, maybe we should output a gexf file or similar as part of the cache</p>



<a name="260256239"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256239" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256239">(Nov 04 2021 at 11:20)</a>:</h4>
<p>Maybe not as part of the same bundle, but it certainly makes sense to host them and reuse the caching mechanism.</p>



<a name="260256242"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256242" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256242">(Nov 04 2021 at 11:20)</a>:</h4>
<p>(also, note that the <code>gexf</code> file is incorrect, as it doesn't know about files with transitive imports but no definitions or docstrings, xref <a href="https://github.com/leanprover-community/lean/issues/645">leanprover-community/lean#645</a>)</p>



<a name="260256391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256391">(Nov 04 2021 at 11:22)</a>:</h4>
<p>I think it's fine to only compute these <code>gexf</code> files for master.</p>



<a name="260256740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256740">(Nov 04 2021 at 11:26)</a>:</h4>
<p>I guess to me <code>leanproject</code> is a tool for working on local projects, so any command line feature that ignores the local project name and revision and just looks at mathlib master is a bad fit</p>



<a name="260256914"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260256914" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260256914">(Nov 04 2021 at 11:29)</a>:</h4>
<p>We could also put this in a web UI somewhere (swapping <code>networkx</code> for <code>graphology</code> which is what the ball of yarn visualization uses), depending on people's attachment to the command line</p>



<a name="260259781"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260259781" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260259781">(Nov 04 2021 at 12:01)</a>:</h4>
<p>Most of all, I just want a very easy way to use this script. Web or cmdline, I don't care</p>



<a name="260259809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260259809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260259809">(Nov 04 2021 at 12:01)</a>:</h4>
<p>So maybe we can put it in <code>scripts/</code> for now?</p>



<a name="260260241"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260260241" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260260241">(Nov 04 2021 at 12:06)</a>:</h4>
<p>That's wonderful!!</p>



<a name="260260281"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260260281" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260260281">(Nov 04 2021 at 12:06)</a>:</h4>
<p><span class="user-mention silent" data-user-id="112680">Johan Commelin</span> <a href="#narrow/stream/113488-general/topic/Finding.20homes.20for.20lemmas/near/260259781">said</a>:</p>
<blockquote>
<p>Most of all, I just want a very easy way to use this script. Web or cmdline, I don't care</p>
</blockquote>
<p>We should really implement this as a lean user command!</p>



<a name="260260322"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260260322" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260260322">(Nov 04 2021 at 12:07)</a>:</h4>
<p>Is the import graph accessible to lean in an easy way?</p>



<a name="260260325"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260260325" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260260325">(Nov 04 2021 at 12:07)</a>:</h4>
<p>Iirc scott wrote a version called home_finder a while ago, that doesn't do any actual graph theory</p>



<a name="260260498"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260260498" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260260498">(Nov 04 2021 at 12:09)</a>:</h4>
<p>Actually <span class="user-mention" data-user-id="110596">@Rob Lewis</span> wrote the one I was thinking of, I think that <a href="#narrow/stream/239415-metaprogramming-.2F.20tactics/topic/lemma.20distribution/near/212269975">https://leanprover.zulipchat.com/#narrow/stream/239415-metaprogramming-.2F.20tactics/topic/lemma.20distribution/near/212269975</a> could be combined with something like <a href="https://github.com/alexjbest/lean-generalisation/blob/main/src/dag.lean#L247">https://github.com/alexjbest/lean-generalisation/blob/main/src/dag.lean#L247</a> to implement this in lean itself</p>



<a name="260797768"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260797768" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260797768">(Nov 09 2021 at 13:36)</a>:</h4>
<p>Where should those three lemmas about linear maps and topology go?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">analysis.normed_space.basic</span>

<span class="kd">variables</span> <span class="o">{</span><span class="bp">𝕜</span> <span class="n">E</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span>

<span class="kd">lemma</span> <span class="n">continuous_at_of_exists_open</span> <span class="o">[</span><span class="n">normed_ring</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">normed_group</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">E</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="bp">𝕜</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">ε</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">ε</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">U</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">),</span> <span class="o">(</span><span class="mi">0</span> <span class="o">:</span> <span class="n">E</span><span class="o">)</span> <span class="bp">∈</span> <span class="n">U</span> <span class="bp">∧</span> <span class="n">is_open</span> <span class="n">U</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">U</span><span class="o">,</span> <span class="bp">∥</span><span class="n">f</span> <span class="n">y</span><span class="bp">∥</span> <span class="bp">&lt;</span> <span class="n">ε</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">continuous_at</span> <span class="n">f</span> <span class="mi">0</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intros</span> <span class="n">U</span> <span class="n">hU</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">metric.nhds_basis_ball.1</span> <span class="n">at</span> <span class="n">hU</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">hU</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">ε</span><span class="o">,</span> <span class="n">hε₁</span><span class="o">,</span> <span class="n">hε₂</span><span class="o">⟩,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">filter.mem_map</span><span class="o">],</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">V</span><span class="o">,</span> <span class="n">hV₁</span><span class="o">,</span> <span class="n">hV₂</span><span class="o">,</span> <span class="n">hV₃</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hf</span> <span class="n">ε</span> <span class="n">hε₁</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mem_nhds_iff</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">V</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span> <span class="n">hε₂</span> <span class="n">_</span><span class="o">,</span> <span class="n">hV₂</span><span class="o">,</span> <span class="n">hV₁</span><span class="o">⟩,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">metric.mem_ball</span><span class="o">,</span> <span class="n">f.map_zero</span><span class="o">,</span> <span class="n">dist_zero_right</span><span class="o">],</span>
  <span class="n">exact</span> <span class="n">hV₃</span> <span class="n">_</span> <span class="n">hy</span><span class="o">,</span>
<span class="kd">end</span>

<span class="kd">lemma</span> <span class="n">continuous_at_of_exists_open'</span> <span class="o">[</span><span class="n">normed_ring</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">normed_group</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">E</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="o">{</span><span class="n">x</span> <span class="o">:</span> <span class="n">E</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="bp">∀</span> <span class="n">ε</span><span class="o">,</span> <span class="mi">0</span> <span class="bp">&lt;</span> <span class="n">ε</span> <span class="bp">→</span> <span class="bp">∃</span> <span class="o">(</span><span class="n">U</span> <span class="o">:</span> <span class="n">set</span> <span class="n">E</span><span class="o">),</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">U</span> <span class="bp">∧</span> <span class="n">is_open</span> <span class="n">U</span> <span class="bp">∧</span> <span class="bp">∀</span> <span class="n">y</span> <span class="bp">∈</span> <span class="n">U</span><span class="o">,</span> <span class="bp">∥</span><span class="n">f</span> <span class="n">y</span> <span class="bp">-</span> <span class="n">f</span> <span class="n">x</span><span class="bp">∥</span> <span class="bp">&lt;</span> <span class="n">ε</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">continuous_at</span> <span class="n">f</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">intros</span> <span class="n">U</span> <span class="n">hU</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">metric.nhds_basis_ball.1</span> <span class="n">at</span> <span class="n">hU</span><span class="o">,</span>
  <span class="n">rcases</span> <span class="n">hU</span> <span class="k">with</span> <span class="o">⟨</span><span class="n">ε</span><span class="o">,</span> <span class="n">hε₁</span><span class="o">,</span> <span class="n">hε₂</span><span class="o">⟩,</span>
  <span class="n">simp</span> <span class="n">only</span> <span class="o">[</span><span class="n">filter.mem_map</span><span class="o">],</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">V</span><span class="o">,</span> <span class="n">hV₁</span><span class="o">,</span> <span class="n">hV₂</span><span class="o">,</span> <span class="n">hV₃</span><span class="o">⟩</span> <span class="o">:=</span> <span class="n">hf</span> <span class="n">ε</span> <span class="n">hε₁</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">mem_nhds_iff</span><span class="o">,</span>
  <span class="n">refine</span> <span class="o">⟨</span><span class="n">V</span><span class="o">,</span> <span class="bp">λ</span> <span class="n">y</span> <span class="n">hy</span><span class="o">,</span> <span class="n">hε₂</span> <span class="n">_</span><span class="o">,</span> <span class="n">hV₂</span><span class="o">,</span> <span class="n">hV₁</span><span class="o">⟩,</span>
  <span class="n">rw</span> <span class="o">[</span><span class="n">metric.mem_ball</span><span class="o">,</span> <span class="n">dist_eq_norm</span><span class="o">],</span>
  <span class="n">exact</span> <span class="n">hV₃</span> <span class="n">_</span> <span class="n">hy</span><span class="o">,</span>
<span class="kd">end</span>

<span class="sd">/-- A nonzero continuous linear functional is open. -/</span>
<span class="kd">lemma</span> <span class="n">nonzero_linear_map_is_open_map</span> <span class="o">[</span><span class="n">topological_space</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">division_ring</span> <span class="bp">𝕜</span><span class="o">]</span>
  <span class="o">[</span><span class="n">topological_ring</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_add_group</span> <span class="n">E</span><span class="o">]</span>
  <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">has_continuous_smul</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">E</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_open_map</span> <span class="n">f</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x₀</span><span class="o">,</span> <span class="n">hx₀</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">x₀</span><span class="o">,</span> <span class="n">f</span> <span class="n">x₀</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">by_contra</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">push_neg</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hf</span> <span class="o">(</span><span class="n">continuous_linear_map.ext</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">])</span> <span class="o">)},</span>
  <span class="n">intros</span> <span class="n">A</span> <span class="n">hA</span><span class="o">,</span>
  <span class="n">rw</span> <span class="n">is_open_iff_mem_nhds</span><span class="o">,</span>
  <span class="n">rintro</span> <span class="n">_</span> <span class="o">⟨</span><span class="n">a</span><span class="o">,</span> <span class="n">ha</span><span class="o">,</span> <span class="n">rfl</span><span class="o">⟩,</span>
  <span class="k">let</span> <span class="n">g</span> <span class="o">:</span> <span class="bp">𝕜</span> <span class="bp">→</span> <span class="n">E</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">a</span> <span class="bp">+</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">f</span> <span class="n">a</span><span class="o">)</span> <span class="bp">•</span> <span class="o">(</span><span class="n">f</span> <span class="n">x₀</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">•</span> <span class="n">x₀</span><span class="o">,</span>
  <span class="k">have</span> <span class="o">:=</span> <span class="o">(</span><span class="k">show</span> <span class="n">continuous</span> <span class="n">g</span><span class="o">,</span> <span class="kd">by</span> <span class="n">continuity</span><span class="o">)</span><span class="bp">.</span><span class="n">is_open_preimage</span> <span class="n">_</span> <span class="o">‹</span><span class="n">is_open</span> <span class="n">A</span><span class="o">›,</span>
  <span class="n">rw</span> <span class="n">is_open_iff_mem_nhds</span> <span class="n">at</span> <span class="n">this</span><span class="o">,</span>
  <span class="n">exact</span> <span class="n">filter.sets_of_superset</span> <span class="n">_</span> <span class="o">(</span><span class="n">this</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span><span class="o">)</span> <span class="o">(</span><span class="kd">by</span> <span class="n">simpa</span> <span class="o">[</span><span class="n">set.mem_preimage</span><span class="o">,</span> <span class="n">g</span><span class="o">]))</span>
    <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span> <span class="n">hx</span><span class="o">,</span> <span class="o">⟨</span><span class="n">_</span><span class="o">,</span> <span class="n">hx</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hx₀</span><span class="o">]⟩),</span>
<span class="kd">end</span>
</code></pre></div>
<p>I'm happy to hear any golf.</p>



<a name="260800823"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260800823" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260800823">(Nov 09 2021 at 14:01)</a>:</h4>
<p>I would say the first two lemmas probably shouldn't go anywhere. Why do you want them?</p>



<a name="260800973"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260800973" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260800973">(Nov 09 2021 at 14:01)</a>:</h4>
<p>They are used in <a href="https://github.com/leanprover-community/mathlib/issues/7288">#7288</a> but I can probably inline them.</p>



<a name="260801263"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260801263" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260801263">(Nov 09 2021 at 14:03)</a>:</h4>
<p><del>I think I'm not parsing your statement right, can you help me?  Why is projection from <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span> onto the first coordinate an open map?  Or why does the last statement not apply to that function?</del> oh i see</p>



<a name="260801391"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260801391" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260801391">(Nov 09 2021 at 14:04)</a>:</h4>
<p>OK, can't you get the last result from the Banach open mapping theorem? <a href="https://leanprover-community.github.io/mathlib_docs/find/open_mapping">docs#open_mapping</a></p>



<a name="260801502"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260801502" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260801502">(Nov 09 2021 at 14:05)</a>:</h4>
<p>You just need to establish that a nonzero functional onto <code>𝕜</code> is surjective ...</p>



<a name="260802075"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260802075" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260802075">(Nov 09 2021 at 14:09)</a>:</h4>
<p>Hmm... that's an interesting result.</p>



<a name="260808390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260808390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260808390">(Nov 09 2021 at 14:53)</a>:</h4>
<p>Sorry, I got interrupted. You can rewrite a cleaner proof:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="sd">/-- A nonzero continuous linear functional is open. -/</span>
<span class="kd">lemma</span> <span class="n">nonzero_linear_map_is_open_map</span> <span class="o">[</span><span class="n">topological_space</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">division_ring</span> <span class="bp">𝕜</span><span class="o">]</span>
  <span class="o">[</span><span class="n">topological_ring</span> <span class="bp">𝕜</span><span class="o">]</span> <span class="o">[</span><span class="n">add_comm_group</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_space</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">topological_add_group</span> <span class="n">E</span><span class="o">]</span>
  <span class="o">[</span><span class="n">module</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span> <span class="o">[</span><span class="n">has_continuous_smul</span> <span class="bp">𝕜</span> <span class="n">E</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">E</span> <span class="bp">→</span><span class="n">L</span><span class="o">[</span><span class="bp">𝕜</span><span class="o">]</span> <span class="bp">𝕜</span><span class="o">)</span> <span class="o">(</span><span class="n">hf</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">is_open_map</span> <span class="n">f</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">obtain</span> <span class="o">⟨</span><span class="n">x₀</span><span class="o">,</span> <span class="n">hx₀</span><span class="o">⟩</span> <span class="o">:</span> <span class="bp">∃</span> <span class="n">x₀</span><span class="o">,</span> <span class="n">f</span> <span class="n">x₀</span> <span class="bp">≠</span> <span class="mi">0</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">by_contra</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">push_neg</span> <span class="n">at</span> <span class="n">h</span><span class="o">,</span>
    <span class="n">exact</span> <span class="n">hf</span> <span class="o">(</span><span class="n">continuous_linear_map.ext</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">h</span><span class="o">])</span> <span class="o">)},</span>
  <span class="n">apply</span> <span class="n">is_open_map.of_nhds_le</span><span class="o">,</span>
  <span class="n">intros</span> <span class="n">a</span><span class="o">,</span>
  <span class="k">let</span> <span class="n">g</span> <span class="o">:</span> <span class="bp">𝕜</span> <span class="bp">→</span> <span class="n">E</span> <span class="o">:=</span> <span class="bp">λ</span> <span class="n">x</span><span class="o">,</span> <span class="n">a</span> <span class="bp">+</span> <span class="o">(</span><span class="n">x</span> <span class="bp">-</span> <span class="n">f</span> <span class="n">a</span><span class="o">)</span> <span class="bp">•</span> <span class="o">(</span><span class="n">f</span> <span class="n">x₀</span><span class="o">)</span><span class="bp">⁻¹</span> <span class="bp">•</span> <span class="n">x₀</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">cont_g</span> <span class="o">:</span> <span class="n">continuous</span> <span class="n">g</span><span class="o">,</span> <span class="kd">by</span> <span class="n">continuity</span><span class="o">,</span>
  <span class="k">have</span> <span class="n">comp</span> <span class="o">:</span> <span class="n">f</span> <span class="bp">∘</span> <span class="n">g</span> <span class="bp">=</span> <span class="n">id</span><span class="o">,</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">ext</span><span class="o">,</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hx₀</span><span class="o">]</span> <span class="o">},</span>
  <span class="k">have</span> <span class="n">comp_a</span> <span class="o">:</span> <span class="n">g</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">a</span><span class="o">,</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">hx₀</span><span class="o">],</span>
  <span class="k">calc</span> <span class="bp">𝓝</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">map</span> <span class="n">f</span> <span class="o">(</span><span class="n">map</span> <span class="n">g</span> <span class="o">(</span><span class="bp">𝓝</span> <span class="bp">$</span> <span class="n">f</span> <span class="n">a</span><span class="o">))</span> <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="o">[</span><span class="n">map_map</span><span class="o">,</span> <span class="n">comp</span><span class="o">,</span> <span class="n">map_id</span><span class="o">]</span>
           <span class="bp">...</span> <span class="bp">≤</span> <span class="n">map</span> <span class="n">f</span> <span class="o">(</span><span class="bp">𝓝</span> <span class="bp">$</span> <span class="n">g</span> <span class="o">(</span><span class="n">f</span> <span class="n">a</span><span class="o">))</span>      <span class="o">:</span> <span class="n">map_mono</span> <span class="n">cont_g.continuous_at</span>
           <span class="bp">...</span> <span class="bp">=</span> <span class="n">map</span> <span class="n">f</span> <span class="o">(</span><span class="bp">𝓝</span> <span class="n">a</span><span class="o">)</span>              <span class="o">:</span> <span class="kd">by</span> <span class="n">rw</span> <span class="n">comp_a</span>
<span class="kd">end</span>
</code></pre></div>



<a name="260808437"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260808437" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260808437">(Nov 09 2021 at 14:53)</a>:</h4>
<p>I'll have a look at what you try to do with the other two lemmas later.</p>



<a name="260808666"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260808666" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260808666">(Nov 09 2021 at 14:54)</a>:</h4>
<p>In the mean time you can extract two lemmas from the above proof (one for the obtain and one from the calc block which has clearly nothing to do with linear maps).</p>



<a name="260808966"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260808966" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260808966">(Nov 09 2021 at 14:56)</a>:</h4>
<p><span class="user-mention" data-user-id="110031">@Patrick Massot</span> I think it's easier to use the open mapping theorem, though.</p>



<a name="260810105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260810105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260810105">(Nov 09 2021 at 15:02)</a>:</h4>
<p>I agree but OTOH Patrick's proof doesn't require completeness (or indeed any structure beyond a topology).</p>



<a name="260819495"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260819495" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260819495">(Nov 09 2021 at 16:03)</a>:</h4>
<p>Heather, I don't see why you would want a completeness assumption here.</p>



<a name="260821820"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260821820" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260821820">(Nov 09 2021 at 16:18)</a>:</h4>
<p>Yaël, I had a look at the proof where you use <code>continuous_at_of_exists_open</code> and I don't understand why it's so complicated. Since C is open and contains zero, it contains some <code>ball 0 r</code> for a positive <code>r</code>. Hence <code>gauge X &lt;= gauge (ball 0 r) = norm/r</code>, right? Then your assumption on <code>phi</code> implies that phi is a bounded linear map hence continuous. Am I missing something?</p>



<a name="260822035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260822035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260822035">(Nov 09 2021 at 16:20)</a>:</h4>
<p>I'm pretty sure we've all written proofs that used unnecessary assumptions or started out more complicated than they needed to be.</p>



<a name="260822069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260822069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260822069">(Nov 09 2021 at 16:20)</a>:</h4>
<p>By the way, what is this <code>seminorm.lean</code> which seems completely unrelated to our <code>semi_normed_group</code>?</p>



<a name="260822101"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260822101" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260822101">(Nov 09 2021 at 16:21)</a>:</h4>
<p>Is it because you typically want to study a family of seminorms on a given type?</p>



<a name="260822228"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260822228" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Bhavik Mehta <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260822228">(Nov 09 2021 at 16:22)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113488-general/topic/Finding.20homes.20for.20lemmas/near/260821820">said</a>:</p>
<blockquote>
<p>Yaël, I had a look at the proof where you use <code>continuous_at_of_exists_open</code> and I don't understand why it's so complicated. Since C is open and contains zero, it contains some <code>ball 0 r</code> for a positive <code>r</code>. Hence <code>gauge X &lt;= gauge (ball 0 r) = norm/r</code>, right? Then your assumption on <code>phi</code> implies that phi is a bounded linear map hence continuous. Am I missing something?</p>
</blockquote>
<p>I think I wrote the original version of some of these proofs, the answer is that it's complicated because I didn't understand how to use analysis in mathlib properly, I just needed some version of that result for later things</p>



<a name="260822481"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260822481" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260822481">(Nov 09 2021 at 16:24)</a>:</h4>
<p>It is not <em>completely</em> unrelated. The situation is the same as between <code>ring_hom</code> and <code>algebra</code>. <code>semi_normed_group</code> gives a distinguished seminorm through TC inference (although it's not using <code>seminorm</code> currently because Riccardo didn't know about <code>analysis.seminorm</code> at the time, so we could probably use a refactor) while <code>seminorm</code> is a way to create and consume several seminorms on the same group. That's what the proof does.</p>



<a name="260822553"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260822553" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260822553">(Nov 09 2021 at 16:25)</a>:</h4>
<p>Problem is, up to first order approximation I'm the only one aware of that file.</p>



<a name="260823840"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260823840" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260823840">(Nov 09 2021 at 16:36)</a>:</h4>
<p><span class="user-mention silent" data-user-id="240862">Oliver Nash</span> <a href="#narrow/stream/113488-general/topic/Finding.20homes.20for.20lemmas/near/260822035">said</a>:</p>
<blockquote>
<p>I'm pretty sure we've all written proofs that used unnecessary assumptions or started out more complicated than they needed to be.</p>
</blockquote>
<p>Yes, of course. I'm not blaming anyone, I'm still trying to answer Yaël's question about those lemmas.</p>



<a name="260824642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/260824642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#260824642">(Nov 09 2021 at 16:43)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113488-general/topic/Finding.20homes.20for.20lemmas/near/260822101">said</a>:</p>
<blockquote>
<p>Is it because you typically want to study a family of seminorms on a given type?</p>
</blockquote>
<p>My internet is pretty bad, hadn't seen that message. Yes, you're exactly right.</p>



<a name="261195245"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/261195245" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#261195245">(Nov 11 2021 at 23:19)</a>:</h4>
<p>I tried splitting your proof into 3 lemmas but I am not convinced.</p>



<a name="262188722"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/262188722" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#262188722">(Nov 20 2021 at 15:23)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110031">Patrick Massot</span> <a href="#narrow/stream/113488-general/topic/Finding.20homes.20for.20lemmas/near/260821820">said</a>:</p>
<blockquote>
<p>Yaël, I had a look at the proof where you use <code>continuous_at_of_exists_open</code> and I don't understand why it's so complicated. Since C is open and contains zero, it contains some <code>ball 0 r</code> for a positive <code>r</code>. Hence <code>gauge X &lt;= gauge (ball 0 r) = norm/r</code>, right? Then your assumption on <code>phi</code> implies that phi is a bounded linear map hence continuous. Am I missing something?</p>
</blockquote>
<p>Aren't we missing some API for that?</p>



<a name="262189352"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/262189352" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Heather Macbeth <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#262189352">(Nov 20 2021 at 15:36)</a>:</h4>
<p>Have you seen <a href="https://leanprover-community.github.io/mathlib_docs/find/linear_map.mk_continuous">docs#linear_map.mk_continuous</a></p>



<a name="262189565"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/262189565" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#262189565">(Nov 20 2021 at 15:40)</a>:</h4>
<p>Oh interesting! But my assumption is <code>∀ x, φ x ≤ gauge C x</code>, so I somehow need to prove that <code>gauge C</code> is continuous?</p>



<a name="269854026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/269854026" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Andrew Yang <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#269854026">(Jan 29 2022 at 10:09)</a>:</h4>
<p>Should this lemma be provided? If so, where should it go? Should it go in one of the four imports (which?), or should it go into a new file containing this lemma only?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">category_theory.limits.constructions.finite_products_of_binary_products</span>
<span class="kn">import</span> <span class="n">category_theory.limits.constructions.equalizers</span>
<span class="kn">import</span> <span class="n">category_theory.limits.constructions.binary_products</span>
<span class="kn">import</span> <span class="n">category_theory.limits.constructions.limits_of_products_and_equalizers</span>

<span class="kn">open</span> <span class="n">category_theory</span> <span class="n">category_theory.limits</span>

<span class="kn">namespace</span> <span class="n">category_theory.limits</span>

<span class="kd">lemma</span> <span class="n">has_finite_limits_of_has_terminal_has_pullbacks</span>
  <span class="o">{</span><span class="n">C</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">category</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">has_terminal</span> <span class="n">C</span><span class="o">]</span> <span class="o">[</span><span class="n">has_pullbacks</span> <span class="n">C</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_finite_limits</span> <span class="n">C</span> <span class="o">:=</span>
<span class="bp">@@</span><span class="n">finite_limits_from_equalizers_and_finite_products</span> <span class="n">_</span>
  <span class="o">(</span><span class="bp">@@</span><span class="n">has_finite_products_of_has_binary_and_terminal</span> <span class="n">_</span>
    <span class="o">(</span><span class="n">has_binary_products_of_terminal_and_pullbacks</span> <span class="n">C</span><span class="o">)</span> <span class="n">infer_instance</span><span class="o">)</span>
  <span class="o">(</span><span class="bp">@@</span><span class="n">has_equalizers_of_pullbacks_and_binary_products</span> <span class="n">_</span>
    <span class="o">(</span><span class="n">has_binary_products_of_terminal_and_pullbacks</span> <span class="n">C</span><span class="o">)</span> <span class="n">infer_instance</span><span class="o">)</span>

<span class="kd">end</span> <span class="n">category_theory.limits</span>
</code></pre></div>



<a name="269854693"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/269854693" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#269854693">(Jan 29 2022 at 10:23)</a>:</h4>
<p>IMO in the same file that provides finite limits from binary products and equalizers.</p>



<a name="269854762"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Finding%20homes%20for%20lemmas/near/269854762" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Finding.20homes.20for.20lemmas.html#269854762">(Jan 29 2022 at 10:24)</a>:</h4>
<p>The analogous lemma for preserving finite limits would also be useful.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>