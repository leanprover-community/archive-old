---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Redirecting.20dot.20notation.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html">Redirecting dot notation</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="296318573"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296318573" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296318573">(Aug 31 2022 at 12:55)</a>:</h4>
<p>Would it be possible to make dot notation resolve <code>s.nonempty</code>, <code>s.subsingleton</code>, <code>s.nontrivial</code> to <code>set.nonempty (s : set α)</code>, <code>set.subsingleton (s : set α)</code>, <code>set.nontrivial (s : set α)</code> when <code>s : finset α</code>? This would avoid another lot of duplication.</p>



<a name="296320168"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296320168" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296320168">(Aug 31 2022 at 13:04)</a>:</h4>
<p>These probably all boil down to the <code>has_mem</code> instance, <del>which is not defeq to <code>has_mem</code> for the coercion to set,</del> which is presumably due to computational reasons.</p>



<a name="296320311"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296320311" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296320311">(Aug 31 2022 at 13:05)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/finset.mem_coe/src">src#finset.mem_coe</a> is refl, though.</p>



<a name="296320445"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296320445" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296320445">(Aug 31 2022 at 13:06)</a>:</h4>
<p>Oh great</p>



<a name="296320488"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296320488" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296320488">(Aug 31 2022 at 13:06)</a>:</h4>
<p>I guess the coercion to set is via the has mem ;)</p>



<a name="296328567"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296328567" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296328567">(Aug 31 2022 at 13:48)</a>:</h4>
<p>Is there any dot notation exclusive to finset? Would that cause issues with this?</p>



<a name="296328711"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296328711" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296328711">(Aug 31 2022 at 13:49)</a>:</h4>
<p>There currently is <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.nonempty">docs#finset.nonempty</a> but the above idea would get rid of it, if that's what you meant.</p>



<a name="296328867"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296328867" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296328867">(Aug 31 2022 at 13:50)</a>:</h4>
<p>Well what I was thinking was, obviously we don't want to redirect every <code>s.foo</code> where <code>s</code> is a finset.</p>



<a name="296329373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296329373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296329373">(Aug 31 2022 at 13:52)</a>:</h4>
<p>I think the idea is desirable though. These predicates are really set-like, in the sense that they are not about properties of the finset structure but simply whether or not certain elements have mem.</p>
<p>(You probably need to duplicate things like <code>finset.mem_off_diag</code> and <code>set.mem_off_diag</code> for your <code>off_diag</code> PR, for instance, because <code>finset.off_diag</code> and <code>set.off_diag</code> are constructed in different ways.)</p>



<a name="296329576"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296329576" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296329576">(Aug 31 2022 at 13:54)</a>:</h4>
<p>(That being said, one is a filtered finset and one is set comprehension, which are morally "the same", so go figure.)</p>



<a name="296330957"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296330957" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296330957">(Aug 31 2022 at 14:01)</a>:</h4>
<p>Basically I agree with your goal here and that we should minimise duplication as much as possible. I'm sure there's more one could do but perfect shouldn't be the enemy of good. Things should line up, though, unless there's a good reason why they ought not to.</p>



<a name="296355018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296355018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296355018">(Aug 31 2022 at 15:21)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span> If you promise not to use this feature in any mathlib PR's until we know whether it can be ported to Lean 4, I'll show you a consequence to the new dot notation that essentially gives you this. There are no guarantees the feature will last long -- this works because we were preserving a (misused?) Lean 3 feature to make it easier to do the Lean version bump.</p>
<p>Lean 4 has a way to use dot notation with aliases, which was backported. However, Lean 3 will currently insert the object of the dot notation as the first argument if the usual rule doesn't succeed (insert it at the first explicit argument whose head matches), which is not compatible with Lean 4. For example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>

<span class="kn">protected</span> <span class="kd">def</span> <span class="n">has_mem.nonempty'</span> <span class="o">{</span><span class="n">α</span> <span class="n">β</span><span class="o">}</span> <span class="o">[</span><span class="n">has_mem</span> <span class="n">α</span> <span class="n">β</span><span class="o">]</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">β</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="bp">∃</span> <span class="n">x</span><span class="o">,</span> <span class="n">x</span> <span class="bp">∈</span> <span class="n">s</span>

<span class="kn">export</span> <span class="n">has_mem</span> <span class="o">(</span><span class="kn">renaming</span> <span class="n">nonempty'</span> <span class="bp">→</span> <span class="n">finset.nonempty'</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">s.nonempty'</span>
</code></pre></div>
<p>For the alias feature to work, the field name must match (renaming <code>nonempty' -&gt; finset.my_nonempty</code> won't work)</p>
<p>I would have written it the following way, but it's triggering an error for reasons I don't understand at the moment:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- redefine so that it has a name that won't conflict with `finset.nonempty` once we export it</span>
<span class="kn">protected</span> <span class="kd">def</span> <span class="n">set.nonempty'</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">s.nonempty</span>

<span class="kn">export</span> <span class="n">set</span> <span class="o">(</span><span class="kn">renaming</span> <span class="n">nonempty'</span> <span class="bp">→</span> <span class="n">finset.nonempty'</span><span class="o">)</span>

<span class="kd">example</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">(</span><span class="n">s</span> <span class="o">:</span> <span class="n">finset</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Prop</span> <span class="o">:=</span> <span class="n">s.nonempty'</span>
<span class="c1">-- failure (switched to simple elaboration procedure)</span>
</code></pre></div>



<a name="296358633"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296358633" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296358633">(Aug 31 2022 at 15:30)</a>:</h4>
<p>I should mention that this <code>export</code> line in Lean 4 would be</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">namespace</span> <span class="n">finset</span>
<span class="kn">export</span> <span class="n">has_mem</span> <span class="o">(</span><span class="n">nonempty'</span><span class="o">)</span>
<span class="kd">end</span> <span class="n">finset</span>
</code></pre></div>
<p>I don't understand Lean 3 aliases well enough to know why <code>#check finset.nonempty'</code> doesn't resolve. But if it did, then this <code>namespace</code>/<code>export</code> block should work in place of the <code>export ... (renaming ...)</code> command.</p>



<a name="296372270"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296372270" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296372270">(Aug 31 2022 at 15:52)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span> it occurs to me that (though I suppose this might lose the dot notation?) you could define <code>has_mem.nonempty</code>  etc.? Like make it so that anything which <code>has_mem</code> would get it.</p>



<a name="296373139"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296373139" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296373139">(Aug 31 2022 at 15:52)</a>:</h4>
<p>Dot notation is the only reason <a href="https://leanprover-community.github.io/mathlib_docs/find/finset.nonempty">docs#finset.nonempty</a> exists, so it's definitely important.</p>



<a name="296416883"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Redirecting%20dot%20notation/near/296416883" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Wrenna Robson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Redirecting.20dot.20notation.html#296416883">(Aug 31 2022 at 17:45)</a>:</h4>
<p>Aye. I couldn't remember if the way it worked for typeclasses, dot notation would work on anything whose type was of the right typeclass.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>