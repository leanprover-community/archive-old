---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/protected.20as.20attribute.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html">protected as attribute</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="197396756"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197396756" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197396756">(May 13 2020 at 11:07)</a>:</h4>
<p>I think it has been discussed, but before the community fork: can we make <code>protected</code> an attribute? And if so, how hard would it be? (Maybe we can still support the current syntax of <code>protected lemma ...</code>?)</p>



<a name="197397400"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197397400" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197397400">(May 13 2020 at 11:14)</a>:</h4>
<p>Can you elaborate on what the advantages of <code>@[protected]</code> would be?</p>



<a name="197398105"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197398105" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197398105">(May 13 2020 at 11:22)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> One example would be: copy <code>init.algebra.ring</code>, replace all alphas by <code>int</code>, and mark all the proven lemmas as <code>protected</code> at the end. This way you don't have to replace every occurence of <code>add_comm</code> by <code>int.add_comm</code>, etc...</p>



<a name="197398149"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197398149" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197398149">(May 13 2020 at 11:22)</a>:</h4>
<p>Better example: we have <code>topological_space.is_open</code> and <code>_root_.is_open</code>. Currently, if you <code>open topological_space</code>, this leads to conflicts.</p>



<a name="197398185"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197398185" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197398185">(May 13 2020 at 11:23)</a>:</h4>
<p>Really, we would want to mark <code>topological_space.is_open</code> as protected after creating the class.</p>



<a name="197398326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197398326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197398326">(May 13 2020 at 11:24)</a>:</h4>
<p>Oh, and also <code>local attribute [protected]</code> I guess.</p>



<a name="197398471"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197398471" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197398471">(May 13 2020 at 11:26)</a>:</h4>
<p>It's not an attribute, but there's <code>environment.mk_protected</code> right now, so you can do this with a command. Can't remove it though.</p>



<a name="197399156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197399156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197399156">(May 13 2020 at 11:33)</a>:</h4>
<p>Aha, maybe that's good enough for now.</p>



<a name="197401826"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197401826" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197401826">(May 13 2020 at 12:00)</a>:</h4>
<p>I don't think you can remove an attribute either. (Would you really want to make something <code>protected</code> locally? There's also <code>open hiding</code>.)</p>



<a name="197402634"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197402634" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197402634">(May 13 2020 at 12:08)</a>:</h4>
<p>What does <code>open hiding</code> do? Does it locally unprotect things?</p>



<a name="197402660"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197402660" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197402660">(May 13 2020 at 12:09)</a>:</h4>
<p>Because I might want to locally unprotect things</p>



<a name="197402698"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197402698" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Rob Lewis <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197402698">(May 13 2020 at 12:09)</a>:</h4>
<p>Hmm, the doc string for <code>user_attribute</code> says something about attributes being unremovable if you give an <code>after_set</code> without a <code>before_unset</code>. I thought this had to do with when you could use <code>local attribute</code>, but apparently not.</p>



<a name="197402813"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197402813" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197402813">(May 13 2020 at 12:10)</a>:</h4>
<p>No, it locally protects things (I think?)</p>



<a name="197402851"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197402851" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197402851">(May 13 2020 at 12:10)</a>:</h4>
<p>Locally unprotecting would be more like <code>open showing</code> (which doesn't exist)</p>



<a name="197402900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197402900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197402900">(May 13 2020 at 12:10)</a>:</h4>
<p>"Even though the person who wrote the library says I don't want to automatically import these names to top-level, I want to do it anyways"</p>



<a name="197402935"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197402935" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197402935">(May 13 2020 at 12:11)</a>:</h4>
<p>With an attribute you couldn't locally unprotect things anyways, could you?</p>



<a name="197403550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197403550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197403550">(May 13 2020 at 12:16)</a>:</h4>
<p>Yeah, I see now</p>



<a name="197404427"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197404427" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197404427">(May 13 2020 at 12:25)</a>:</h4>
<p>Why, would <code>local attribute [-protected]</code> not work?</p>



<a name="197404568"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197404568" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197404568">(May 13 2020 at 12:26)</a>:</h4>
<p>Oh, I was under the impression that syntax doesn't exist or doesn't actually do anything or something like that.</p>



<a name="197408234"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197408234" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastian Ullrich <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197408234">(May 13 2020 at 13:00)</a>:</h4>
<p>It doesn't work for all attributes, but there's no reason it shouldn't for a <code>[protected]</code> attribute</p>



<a name="197786072"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197786072" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197786072">(May 16 2020 at 09:14)</a>:</h4>
<p>What should I do to make lean happy?</p>
<div class="codehilite"><pre><span></span><code><span class="n">run_cmd</span> <span class="n">environment</span><span class="bp">.</span><span class="n">mk_protected</span> <span class="n">int</span><span class="bp">.</span><span class="n">neg_mul_eq_mul_neg</span>
<span class="c">/-</span><span class="cm"></span>
<span class="cm">basic.lean:47:0: error</span>
<span class="cm">don&#39;t know how to synthesize placeholder</span>
<span class="cm">context:</span>
<span class="cm">⊢ Type</span>
<span class="cm">basic.lean:47:8: error</span>
<span class="cm">type mismatch at application</span>
<span class="cm">  environment.mk_protected int.neg_mul_eq_mul_neg</span>
<span class="cm">term</span>
<span class="cm">  int.neg_mul_eq_mul_neg</span>
<span class="cm">has type</span>
<span class="cm">  ∀ (a b : ℤ), -(a * b) = a * -b : Prop</span>
<span class="cm">but is expected to have type</span>
<span class="cm">  environment : Type</span>
<span class="cm">Additional information:</span>
<span class="cm">/home/jmc/data/math/mathlib/src/init_/data/int/basic.lean:47:8: context: switched to simple application elaboration procedure because failed to use expected type to elaborate it, error message</span>
<span class="cm">  type mismatch, term</span>
<span class="cm">    ?m_1.mk_protected</span>
<span class="cm">  has type</span>
<span class="cm">    name → environment</span>
<span class="cm">  but is expected to have type</span>
<span class="cm">    tactic ?m_1</span>
<span class="cm">-/</span>
</code></pre></div>



<a name="197786154"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197786154" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197786154">(May 16 2020 at 09:16)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">run_cmd</span> <span class="n">do</span> <span class="n">env</span> <span class="err">←</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">get_env</span><span class="o">,</span>
  <span class="n">tactic</span><span class="bp">.</span><span class="n">set_env</span> <span class="err">$</span> <span class="n">env</span><span class="bp">.</span><span class="n">mk_protected</span> <span class="bp">``</span><span class="n">int</span><span class="bp">.</span><span class="n">neg_mul_eq_mul_neg</span>
</code></pre></div>



<a name="197786174"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197786174" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197786174">(May 16 2020 at 09:17)</a>:</h4>
<p>Thanks! And when I want to do this for a whole list of names?</p>



<a name="197786181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197786181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197786181">(May 16 2020 at 09:17)</a>:</h4>
<p>I'll need some <code>fold</code>, I guess?</p>



<a name="197786232"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197786232" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197786232">(May 16 2020 at 09:18)</a>:</h4>
<div class="codehilite"><pre><span></span><code><span class="n">run_cmd</span> <span class="n">do</span> <span class="n">env</span> <span class="err">←</span> <span class="n">tactic</span><span class="bp">.</span><span class="n">get_env</span><span class="o">,</span>
  <span class="n">tactic</span><span class="bp">.</span><span class="n">set_env</span> <span class="err">$</span> <span class="o">[</span><span class="bp">``</span><span class="n">nat</span><span class="o">,</span> <span class="bp">``</span><span class="n">int</span><span class="o">]</span><span class="bp">.</span><span class="n">foldl</span> <span class="n">environment</span><span class="bp">.</span><span class="n">mk_protected</span> <span class="n">env</span>
</code></pre></div>



<a name="197786294"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/protected%20as%20attribute/near/197786294" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/protected.20as.20attribute.html#197786294">(May 16 2020 at 09:20)</a>:</h4>
<p>Thanks again!</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>