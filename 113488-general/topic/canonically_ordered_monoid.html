---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/canonically_ordered_monoid.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html">canonically_ordered_monoid</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="260215440"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260215440" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260215440">(Nov 04 2021 at 00:25)</a>:</h4>
<p>What's the <code>to_additive</code> tag on <a href="https://leanprover-community.github.io/mathlib_docs/find/canonically_ordered_monoid">docs#canonically_ordered_monoid</a> supposed to achieve? <a href="https://leanprover-community.github.io/mathlib_docs/find/canonically_ordered_add_monoid">docs#canonically_ordered_add_monoid</a> already exists by that point.</p>



<a name="260216924"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260216924" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260216924">(Nov 04 2021 at 00:51)</a>:</h4>
<p>It registers the fact that <code>canonically_ordered_add_monoid</code> is the additive version of <code>canonically_ordered_monoid</code>.</p>



<a name="260242114"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260242114" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260242114">(Nov 04 2021 at 08:46)</a>:</h4>
<p>To expand on what Yury said: <code>to_additive</code> cannot automatically create an additive structure/class (there are some automatically generated declarations - like the projections - that we cannot easily generate using metaprogramming). <br>
But we still need tot tell <code>to_additive</code> that <code>canonically_ordered_add_monoid</code> is the additive version of <code>canonically_ordered_monoid</code> and that the declarations generated automatically by <code>canonically_ordered_monoid</code> also are matched up with their additive counterparts.</p>



<a name="260280648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260280648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260280648">(Nov 04 2021 at 14:52)</a>:</h4>
<p>Interesting! I didn't know about that.</p>



<a name="260281028"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260281028" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260281028">(Nov 04 2021 at 14:54)</a>:</h4>
<p>However it doesn't work on <code>def</code>?</p>



<a name="260282631"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260282631" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260282631">(Nov 04 2021 at 15:03)</a>:</h4>
<p>It also works on <code>def</code>. We sometimes first give the additive <code>def</code>, and then the multiplicative <code>def</code> marked with a <code>to_additive</code> attribute. This is sometimes necessary when we hit one of the limitations to <code>to_additive</code>.</p>



<a name="260282844"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260282844" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260282844">(Nov 04 2021 at 15:05)</a>:</h4>
<p>I tried to do this in <code>data.list.defs</code> but it doesn't work. Is it just because <code>to_additive</code> doesn't exist yet at that point?</p>



<a name="260283018"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260283018" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260283018">(Nov 04 2021 at 15:06)</a>:</h4>
<p>Most likely. Note that you can also do it in the other direction if the file is a dependency of <code>to_additive</code>, i.e. you can add the attribute to all the core files inside the file that declares <code>to_additive</code></p>



<a name="260283111"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260283111" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260283111">(Nov 04 2021 at 15:06)</a>:</h4>
<p>Most likely. I think the file that defines to_additive adds the attribute on a bunch of things that appeared earlier in the import graph for exactly this reason</p>



<a name="260283170"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260283170" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260283170">(Nov 04 2021 at 15:07)</a>:</h4>
<p>I don't think <code>data.list.defs</code> even knows the vocabulary to talk about groups and additive groups</p>



<a name="260283396"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260283396" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260283396">(Nov 04 2021 at 15:08)</a>:</h4>
<p>It was to link <code>alternating_sum</code> and <code>alternating_prod</code>.</p>



<a name="260293410"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260293410" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260293410">(Nov 04 2021 at 16:09)</a>:</h4>
<p>You should probably do this retroactively in some list file that has basic tactics (maybe <code>data.list.basic</code>?)</p>



<a name="260293613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260293613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260293613">(Nov 04 2021 at 16:10)</a>:</h4>
<p>similar: <a href="https://github.com/leanprover-community/mathlib/blob/de79226c64ab6177029fdbd069fdfe40d252f7cd/src/data/list/basic.lean#L2396">https://github.com/leanprover-community/mathlib/blob/de79226c64ab6177029fdbd069fdfe40d252f7cd/src/data/list/basic.lean#L2396</a></p>



<a name="260293651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260293651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260293651">(Nov 04 2021 at 16:10)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="c1">-- list.sum was already defined in defs.lean, but we couldn't tag it with `to_additive` yet.</span>
</code></pre></div>



<a name="260295187"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260295187" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260295187">(Nov 04 2021 at 16:20)</a>:</h4>
<p>Yeah, that's what was being done, and that's how I kept it: <a href="https://github.com/leanprover-community/mathlib/issues/10164">#10164</a></p>



<a name="260295618"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260295618" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260295618">(Nov 04 2021 at 16:22)</a>:</h4>
<p>Given that this confused you, can you add a docstring to <code>list.alternating_prod</code> that the <code>to_additive</code> is added later and why.</p>



<a name="260306727"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260306727" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260306727">(Nov 04 2021 at 17:33)</a>:</h4>
<p>A regular comment would make more sense IMO</p>



<a name="260307150"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/canonically_ordered_monoid/near/260307150" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/canonically_ordered_monoid.html#260307150">(Nov 04 2021 at 17:36)</a>:</h4>
<p>I've put both <code>to_additive</code>ization in a section with a comment.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>