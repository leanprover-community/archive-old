---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html">module from semimodule over a ring</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="235628146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235628146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235628146">(Apr 22 2021 at 06:55)</a>:</h4>
<p>Am I allowed to ask for</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span>

<span class="kd">instance</span> <span class="n">foo</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="n">M</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="gr">sorry</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="n">M</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="gr">sorry</span>
</code></pre></div>
<p>these days, or is that verboten?</p>



<a name="235628694"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235628694" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235628694">(Apr 22 2021 at 07:00)</a>:</h4>
<p>I'm trying to match up the abstract and concrete definitions of <code>projective</code> that we now have. The problem is that <code>Module R</code> is the category of modules over <code>R</code> (so <code>R</code> must be a ring, not a semiring), while in <code>is_projective.of_lifting_property</code>, we quantify over semimodules. So in order to show that an <code>X : Module R</code> with <code>projective X</code> also has <code>is_projective X</code>, I need to know those semimodules are actually modules.</p>



<a name="235629275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235629275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235629275">(Apr 22 2021 at 07:03)</a>:</h4>
<p>So I'm happy if these are evil instances: I promise not to ever release them from a <code>Prop</code>-valued goal. :-)</p>



<a name="235629659"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235629659" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235629659">(Apr 22 2021 at 07:04)</a>:</h4>
<p>Another alternative is to give up on this silly semimodule nonsense completely. I'm well aware that you can have semimodules over a semiring but honestly, do semimodule theorists (if such people actually exist) really study projective semimodules?</p>



<a name="235629732"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235629732" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235629732">(Apr 22 2021 at 07:05)</a>:</h4>
<p>I would support not caring about whether semimodules are projective. :-)</p>



<a name="235629797"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235629797" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235629797">(Apr 22 2021 at 07:05)</a>:</h4>
<p>What I'm saying is that I was just conforming to mathlib principles when I defined projective semimodules, and have 0 applications in mind</p>



<a name="235630250"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235630250" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235630250">(Apr 22 2021 at 07:09)</a>:</h4>
<p><a href="https://leanprover-community.github.io/mathlib_docs/find/semimodule.add_comm_monoid_to_add_comm_group/src">src#semimodule.add_comm_monoid_to_add_comm_group</a></p>



<a name="235630253"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235630253" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235630253">(Apr 22 2021 at 07:09)</a>:</h4>
<p>found it!</p>



<a name="235630974"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235630974" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235630974">(Apr 22 2021 at 07:15)</a>:</h4>
<p>Oh, but <a href="https://github.com/leanprover-community/mathlib/issues/7255">#7255</a> is about to change all this.</p>



<a name="235631156"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235631156" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235631156">(Apr 22 2021 at 07:17)</a>:</h4>
<p>maybe not.</p>



<a name="235635010"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235635010" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235635010">(Apr 22 2021 at 07:54)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring/near/235628146">said</a>:</p>
<blockquote>
<p>Am I allowed to ask for</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>

<span class="kd">variables</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span>

<span class="kd">instance</span> <span class="n">foo</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">add_comm_group</span> <span class="n">M</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="gr">sorry</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="n">M</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="gr">sorry</span>
</code></pre></div>
<p>these days, or is that verboten?</p>
</blockquote>
<p>The first one can not be a global instance, as <code>R</code> is not determined from the target, so there would be some unknown metavariable in the instance search, which is very bad. But you can use it in proofs with explicit declarations as you like. The second one is already an instance, since <code>semimodule</code> and <code>module</code> are the same thing.</p>



<a name="235644107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235644107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235644107">(Apr 22 2021 at 09:13)</a>:</h4>
<p>I'm still not getting this to work.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.module.basic</span>

<span class="kn">local</span> <span class="kn">attribute</span> <span class="o">[</span><span class="kd">instance</span><span class="o">]</span> <span class="n">semimodule.add_comm_monoid_to_add_comm_group</span>

<span class="kd">example</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">mM</span><span class="o">:</span> <span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">sM</span> <span class="o">:</span> <span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="n">M</span> <span class="o">:=</span>
<span class="bp">???</span>
</code></pre></div>



<a name="235644192"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235644192" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235644192">(Apr 22 2021 at 09:14)</a>:</h4>
<p>(This is post <a href="https://github.com/leanprover-community/mathlib/issues/7255">#7255</a>.)</p>



<a name="235644390"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235644390" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oliver Nash <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235644390">(Apr 22 2021 at 09:16)</a>:</h4>
<p>How about:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">(</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span><span class="o">)</span> <span class="o">[</span><span class="n">mM</span><span class="o">:</span> <span class="n">add_comm_monoid</span> <span class="n">M</span><span class="o">]</span> <span class="o">[</span><span class="n">sM</span> <span class="o">:</span> <span class="n">semimodule</span> <span class="n">R</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="n">M</span> <span class="o">:=</span>
<span class="o">{</span><span class="bp">..</span><span class="n">sM</span><span class="o">}</span> <span class="c1">-- (or `{..(infer_instance : semimodule R M)}` or even `{..‹semimodule R M›}`)</span>
</code></pre></div>



<a name="235645014"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235645014" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235645014">(Apr 22 2021 at 09:22)</a>:</h4>
<p>Wouldn't it be a nicer solution to just get rid of <code>module</code> altogether and rename <code>semimodule</code> to <code>module</code>? Whenever you need a <code>-</code> on <code>R</code> or <code>M</code> you can add it back in through the other typeclasses.</p>



<a name="235647822"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235647822" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Sebastien Gouezel <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235647822">(Apr 22 2021 at 09:42)</a>:</h4>
<p>Abbreviations are really weird. As Anne suggests, I would just ditch <code>semimodule</code> and rename it to <code>module</code>, since as far as I can see the abbreviation we currently have doesn't buy us anything, and is creating problems sometimes.</p>



<a name="235649761"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235649761" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235649761">(Apr 22 2021 at 09:58)</a>:</h4>
<p>Shall I make a PR to try it out (and do the same for <code>vector_space</code>)?</p>



<a name="235651520"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235651520" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235651520">(Apr 22 2021 at 10:13)</a>:</h4>
<p>I ran <code>sed -i s/semimodule/module/g s/vector_space/module/g **/*.lean</code>, see <a href="https://github.com/leanprover-community/mathlib/issues/7322">#7322</a> for the result.</p>



<a name="235656323"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235656323" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235656323">(Apr 22 2021 at 10:59)</a>:</h4>
<p>I went through all changes. My main question: it would be okay to keep <code>dim</code> in the <code>vector_space</code> namespace, even though there is no definition called <code>vector_space</code>?</p>



<a name="235656416"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235656416" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235656416">(Apr 22 2021 at 11:00)</a>:</h4>
<p>(Or should I just go ahead and move it to the <code>free_module</code> namespace, in anticipation of a <code>free_module</code> typeclass?)</p>



<a name="235657559"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235657559" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235657559">(Apr 22 2021 at 11:11)</a>:</h4>
<p>My guess is that the typeclass would be called <code>module.free</code></p>



<a name="235657623"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235657623" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235657623">(Apr 22 2021 at 11:12)</a>:</h4>
<p>We could just have <code>module.rank</code> and never use <code>dim</code>?</p>



<a name="235657990"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235657990" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235657990">(Apr 22 2021 at 11:15)</a>:</h4>
<p>I'm not sure the abbreviation is a problem here - Scott's example just seems like a weird thing to want to do</p>



<a name="235658344"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235658344" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Mario Carneiro <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235658344">(Apr 22 2021 at 11:19)</a>:</h4>
<p><span class="user-mention silent" data-user-id="238446">Anne Baanen</span> <a href="#narrow/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring/near/235649761">said</a>:</p>
<blockquote>
<p>Shall I make a PR to try it out (and do the same for <code>vector_space</code>)?</p>
</blockquote>
<p>Heh, we're coming full circle</p>



<a name="235659927"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235659927" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235659927">(Apr 22 2021 at 11:32)</a>:</h4>
<p><span class="user-mention" data-user-id="112680">@Johan Commelin</span>'s suggestion sounds good. I'll see if calling it <code>rank</code> works, and then add a TODO that this should be defined for modules that are not over a field.</p>



<a name="235662809"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235662809" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235662809">(Apr 22 2021 at 11:56)</a>:</h4>
<p>One drawback: <code>_root_.rank</code> already exists, the rank of a linear map. So <code>module.rank</code> will have to be a protected definition (until we rename <code>_root_.rank</code> to <code>linear_map.rank</code>).</p>



<a name="235665449"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235665449" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235665449">(Apr 22 2021 at 12:15)</a>:</h4>
<p>By the way, I found an example of the <code>instance : module := {.. infer_instance : semimodule}</code> pattern at <a href="https://leanprover-community.github.io/mathlib_docs/find/triv_sq_zero_ext.module">docs#triv_sq_zero_ext.module</a></p>



<a name="235665760"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235665760" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235665760">(Apr 22 2021 at 12:17)</a>:</h4>
<p>Does that instance break if you change it to <code>:= infer_instance</code>?</p>



<a name="235665945"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235665945" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235665945">(Apr 22 2021 at 12:19)</a>:</h4>
<p>I'm currently compiling mathlib with (among others) that entire instance removed, so could you check that yourself? :)</p>



<a name="235691533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235691533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235691533">(Apr 22 2021 at 14:51)</a>:</h4>
<p>On the <code>semimodule_to_module</code> branch, I'm getting a timeout in <code>Module.limit_module</code> (<code>src/algebra/category/Module/limits.lean</code>):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">limit_module</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">J</span> <span class="bp">⥤</span> <span class="n">Module</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">types.limit_cone</span> <span class="o">(</span><span class="n">F</span> <span class="bp">⋙</span> <span class="n">forget</span> <span class="o">(</span><span class="n">Module.</span><span class="o">{</span><span class="n">v</span><span class="o">}</span> <span class="n">R</span><span class="o">)))</span><span class="bp">.</span><span class="n">X</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">change</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">sections_submodule</span> <span class="n">F</span><span class="o">),</span>
  <span class="n">apply_instance</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>Doing this in term mode makes it almost instant (60ms elaboration time):</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">instance</span> <span class="n">limit_module</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">J</span> <span class="bp">⥤</span> <span class="n">Module</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">types.limit_cone</span> <span class="o">(</span><span class="n">F</span> <span class="bp">⋙</span> <span class="n">forget</span> <span class="o">(</span><span class="n">Module.</span><span class="o">{</span><span class="n">v</span><span class="o">}</span> <span class="n">R</span><span class="o">)))</span><span class="bp">.</span><span class="n">X</span> <span class="o">:=</span>
<span class="o">(</span><span class="n">infer_instance</span> <span class="o">:</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">sections_submodule</span> <span class="n">F</span><span class="o">))</span>
<span class="c1">-- or:</span>
<span class="kd">instance</span> <span class="n">limit_module</span> <span class="o">(</span><span class="n">F</span> <span class="o">:</span> <span class="n">J</span> <span class="bp">⥤</span> <span class="n">Module</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">types.limit_cone</span> <span class="o">(</span><span class="n">F</span> <span class="bp">⋙</span> <span class="n">forget</span> <span class="o">(</span><span class="n">Module.</span><span class="o">{</span><span class="n">v</span><span class="o">}</span> <span class="n">R</span><span class="o">)))</span><span class="bp">.</span><span class="n">X</span> <span class="o">:=</span>
<span class="k">show</span> <span class="n">module</span> <span class="n">R</span> <span class="o">(</span><span class="n">sections_submodule</span> <span class="n">F</span><span class="o">),</span> <span class="kd">by</span> <span class="n">apply_instance</span>
</code></pre></div>



<a name="235691695"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235691695" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235691695">(Apr 22 2021 at 14:52)</a>:</h4>
<p>And if you change <code>change</code> to <code>show</code> in tactic mode?</p>



<a name="235691808"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235691808" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235691808">(Apr 22 2021 at 14:53)</a>:</h4>
<p>Also times out.</p>



<a name="235692425"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235692425" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235692425">(Apr 22 2021 at 14:57)</a>:</h4>
<p>I've found, in my large refactors like the nat-mul one, or trying things with the nsmul and gsmul ones, that <code>change</code> tactic proofs are often a troublemaker.</p>



<a name="235692521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235692521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235692521">(Apr 22 2021 at 14:57)</a>:</h4>
<p>They're good at getting the goal to be something human readable, and perhaps <code>rw</code>able, but really they usually hide heavy-rfl steps.</p>



<a name="235692550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235692550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yakov Pechersky <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235692550">(Apr 22 2021 at 14:57)</a>:</h4>
<p>And are particularly brittle to changes in defeq</p>



<a name="235692683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235692683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235692683">(Apr 22 2021 at 14:58)</a>:</h4>
<p>I tried using <code>rw (rfl : ... = ...)</code> instead, but that gives an incorrect motive error.</p>



<a name="235692839"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235692839" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235692839">(Apr 22 2021 at 14:59)</a>:</h4>
<p>Looking at the <code>is_def_eq_detail</code> trace, looks like it really is the <code>limit_add_comm_group</code> that is being unified badly.</p>



<a name="235695793"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/module%20from%20semimodule%20over%20a%20ring/near/235695793" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/module.20from.20semimodule.20over.20a.20ring.html#235695793">(Apr 22 2021 at 15:10)</a>:</h4>
<p>Aha, defining <code>limit_add_comm_monoid</code> analogous to <code>limit_add_comm_group</code> solves the timeout almost instantly.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>