---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/has_repr.20for.20.60ulift.60.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html">has_repr for `ulift`</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="260614965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260614965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260614965">(Nov 08 2021 at 04:47)</a>:</h4>
<p>Can we pretty print <code>ulift.up x</code> as <code>up x</code>, not <code>{ down := x}</code> while printing other terms <code>x : ulift α</code> as <code>x</code>?</p>



<a name="260650642"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260650642" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260650642">(Nov 08 2021 at 12:35)</a>:</h4>
<p>(you're talking about the pretty-printer output, like in the tactic state view, right? is that really controlled by <code>has_repr</code>?)</p>



<a name="260650778"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260650778" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260650778">(Nov 08 2021 at 12:36)</a>:</h4>
<p>Probably yes, and I wonder if it's clever enough to tell <code>ulift.up x</code> from anything else.</p>



<a name="260650842"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260650842" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260650842">(Nov 08 2021 at 12:37)</a>:</h4>
<p>No those two are different.</p>



<a name="260650876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260650876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260650876">(Nov 08 2021 at 12:37)</a>:</h4>
<p>What does <code>has_repr</code> control?</p>



<a name="260650878"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260650878" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260650878">(Nov 08 2021 at 12:37)</a>:</h4>
<p>Does <code>attribute [pp_using_anonymous_constructor] ulift</code> help?</p>



<a name="260650942"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260650942" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260650942">(Nov 08 2021 at 12:38)</a>:</h4>
<p>The <code>has_repr</code> instance controls what <code>#eval ulift.up 42</code> prints.</p>



<a name="260650953"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260650953" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260650953">(Nov 08 2021 at 12:38)</a>:</h4>
<p>And which function/class is responsible for <code>#print</code>/goals output?</p>



<a name="260650999"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260650999" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260650999">(Nov 08 2021 at 12:39)</a>:</h4>
<p>Lean itself, I think</p>



<a name="260651009"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260651009" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260651009">(Nov 08 2021 at 12:39)</a>:</h4>
<p>Yup: <a href="https://github.com/leanprover-community/lean/blob/master/src/frontends/lean/pp.cpp">https://github.com/leanprover-community/lean/blob/master/src/frontends/lean/pp.cpp</a></p>



<a name="260651020"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260651020" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260651020">(Nov 08 2021 at 12:39)</a>:</h4>
<p>It sounds like we want a variant of the attribute that <a href="https://leanprover-community.github.io/mathlib_docs/find/sigma/src">src#sigma</a> has, <code>pp_using_anonymous_constructor</code>?</p>



<a name="260651152"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260651152" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260651152">(Nov 08 2021 at 12:40)</a>:</h4>
<p>Perhaps <code>pp_using_named_constructor</code>? It would need to be added <a href="https://github.com/leanprover-community/lean/blob/ace65343cf502bbfeee82a0bc54c47a76b2a3dfd/src/frontends/lean/pp.cpp#L894">around here</a>.</p>



<a name="260651231"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260651231" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Massot <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260651231">(Nov 08 2021 at 12:41)</a>:</h4>
<p>Note that the widget framework can also tweak how the tactic state is displayed. See the wonderful <a href="https://github.com/leanprover-community/mathlib/issues/5440">#5440</a> that sadly was never merged for ideological reasons.</p>



<a name="260651530"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260651530" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260651530">(Nov 08 2021 at 12:44)</a>:</h4>
<p>In particular from <a href="https://github.com/leanprover-community/mathlib/issues/5440">#5440</a>:</p>
<blockquote>
<p>Even better, I'd prefer it implemented as part of the pretty-printer so it interacted right with pp options.</p>
</blockquote>
<p>Having it only be part of widgets also stops it being used in error messages (although you could rightfully argue those should support widgets too)</p>



<a name="260652193"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260652193" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260652193">(Nov 08 2021 at 12:51)</a>:</h4>
<p>or by emacs users <img alt=":emacs:" class="emoji" src="https://zulip-avatars.s3.amazonaws.com/3121/emoji/images/17846.png" title="emacs"></p>



<a name="260652348"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260652348" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Johan Commelin <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260652348">(Nov 08 2021 at 12:53)</a>:</h4>
<p>... although you could rightfully argue emacs should support widgets too <span aria-label="wink" class="emoji emoji-1f609" role="img" title="wink">:wink:</span></p>



<a name="260652652"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260652652" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260652652">(Nov 08 2021 at 12:56)</a>:</h4>
<p>Sure, then at some point it comes down to organizational reasons like pretty-printing should be handled by the pretty-printer.</p>



<a name="260713389"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260713389" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260713389">(Nov 08 2021 at 20:21)</a>:</h4>
<p><span class="user-mention" data-user-id="110043">@Gabriel Ebner</span> My actual use case is <a href="https://leanprover-community.github.io/mathlib_docs/find/opposite">docs#opposite</a>. I am separating multiplicative opposite from category theory opposite, and I'd like to define the former as</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">mul_opposite</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="n">op</span> <span class="o">::</span> <span class="o">(</span><span class="n">unop</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>
</code></pre></div>
<p>With <code>pp_using_anonymous_constructor</code>, it prints <code>op x</code> as <code>⟨x⟩</code>. It would be nice to have <code>op x</code> instead. Currently I use</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">structure</span> <span class="n">mul_opposite</span> <span class="o">(</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">)</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span> <span class="o">:=</span> <span class="o">(</span><span class="n">unop</span> <span class="o">:</span> <span class="n">α</span><span class="o">)</span>

<span class="kd">postfix</span> <span class="bp">`ᵐᵒᵖ`</span><span class="o">:</span><span class="n">std.prec.max_plus</span> <span class="o">:=</span> <span class="n">mul_opposite</span>

<span class="kn">namespace</span> <span class="n">mul_opposite</span>

<span class="kd">def</span> <span class="n">op</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="bp">ᵐᵒᵖ</span> <span class="o">:=</span> <span class="n">mk</span>
<span class="kd">@[simp]</span> <span class="kd">lemma</span> <span class="n">mk_eq_op</span> <span class="o">:</span> <span class="o">(</span><span class="n">mk</span> <span class="o">:</span> <span class="n">α</span> <span class="bp">→</span> <span class="n">α</span><span class="bp">ᵐᵒᵖ</span><span class="o">)</span> <span class="bp">=</span> <span class="n">op</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>
<p>as a workaround.</p>



<a name="260771272"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/has_repr%20for%20%60ulift%60/near/260771272" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/has_repr.20for.20.60ulift.60.html#260771272">(Nov 09 2021 at 09:16)</a>:</h4>
<p>I understand.  It wouldn't be hard to implement (a <code>pp_using_named_constructor</code> attribute as Eric suggested sound like the best design), but I think the easiest approach here is to just wait for Lean 4.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>