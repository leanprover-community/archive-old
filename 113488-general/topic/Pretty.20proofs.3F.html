---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/Pretty.20proofs.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html">Pretty proofs?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="308976148"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/308976148" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#308976148">(Nov 10 2022 at 12:18)</a>:</h4>
<p>[soft question]<br>
A friend of mine asked me:<br>
"Isn't the whole point of computer proofs that they aren't pretty, and it's just the result that matters?"</p>
<p>I know that mathlib has pretty high standards regarding what proofs are added to mathlib. I could probably generate a few answers why. However, I don't know what is really important. So I thought it would be better to forward the question to you guys.</p>
<p>Why do we care about how proofs in Lean are written?</p>



<a name="308977023"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/308977023" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#308977023">(Nov 10 2022 at 12:24)</a>:</h4>
<p>One argument is that we're basically writing a giant textbook and readability is thus important. Another is maintainability. A badly written proof is much harder to understand, hence to fix. Your friend seems to be thinking about one-time proofs, which you can just throw away once you're done. This is not the case in mathlib, where definitions change and we concretely have to keep everything coherent.</p>



<a name="308977222"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/308977222" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#308977222">(Nov 10 2022 at 12:26)</a>:</h4>
<p>Note that this doesn't actually argue for pretty proofs, but rather for short and simple proofs. They are quite correlated though.</p>



<a name="309253551"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309253551" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Sánchez Terraf <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309253551">(Nov 11 2022 at 19:58)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113488-general/topic/Pretty.20proofs.3F/near/308977222">said</a>:</p>
<blockquote>
<p>Note that this doesn't actually argue for pretty proofs, but rather for short and simple proofs. They are quite correlated though.</p>
</blockquote>
<p>I think I disagree with the correlation. Before continuing, <strong>full disclosure</strong>: I'm new to Lean and I come from the Isabelle camp, but from rare corner of if (<em>not</em> a user of HOL).</p>



<a name="309254024"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309254024" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Sánchez Terraf <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309254024">(Nov 11 2022 at 20:02)</a>:</h4>
<p>There, I used to write in an extremely verbose way, in such a way that in the ideal situation you wouldn't need to look at the Infoview/proof state to understand what is going on</p>



<a name="309254740"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309254740" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Sánchez Terraf <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309254740">(Nov 11 2022 at 20:09)</a>:</h4>
<p>So, my (perhaps repeated) question is whether here in mathlib we are going <em>against</em> the “giant textbook” approach by golfing proofs.</p>
<p>The extreme opposite would be to have proofs written in a style similar to that used in the tutorials. I really do not know if there are some technical limitations (such as speed of processing the code) that make this prohibitive.</p>
<p>I understand that this will result in proofs that are very long , but (again, using the “textbook“ analogy), perhaps someone could learn the math underlying some mathlib proof by reading just the code.</p>



<a name="309255648"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309255648" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309255648">(Nov 11 2022 at 20:17)</a>:</h4>
<p>In some ways the hope is that you do have access to the info view, and there's been tooling developed to help with this such as Alectryon.</p>



<a name="309266643"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309266643" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309266643">(Nov 11 2022 at 22:09)</a>:</h4>
<p>I really disagree with the characterisation that we're writing a giant textbook and consider readability important. Only a handful of proofs in all of mathlib even approach readability.</p>



<a name="309266683"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309266683" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309266683">(Nov 11 2022 at 22:09)</a>:</h4>
<p>(I'm not saying I think we're doing the right thing, by ignoring readability.)</p>



<a name="309274043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309274043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Pedro Sánchez Terraf <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309274043">(Nov 11 2022 at 23:37)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110087">Scott Morrison</span> <a href="#narrow/stream/113488-general/topic/Pretty.20proofs.3F/near/309266683">said</a>:</p>
<blockquote>
<p>(I'm not saying I think we're doing the right thing, by ignoring readability.)</p>
</blockquote>
<p>It is very reassuring that people at least give some thought to the matter. On the other hand, writing readable proofs is extremely, painfully slower.</p>



<a name="309275521"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309275521" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309275521">(Nov 11 2022 at 23:57)</a>:</h4>
<blockquote>
<p>I really disagree with the characterisation that we're writing a giant textbook and consider readability important.</p>
</blockquote>
<p>I think <a href="https://leanprover-community.github.io/mathlib_docs/find/Set.powerset/src">src#Set.powerset</a> is a good example of how terse it can get</p>



<a name="309275649"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309275649" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Matt Diamond <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309275649">(Nov 11 2022 at 23:59)</a>:</h4>
<p>on the other hand, it's nice to find the most elegant solution</p>



<a name="309284076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309284076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309284076">(Nov 12 2022 at 02:15)</a>:</h4>
<p>I think a good/realistic target would be: any proof less than 10 lines with no "mathematical content" (i.e. that you would never find yourself explaining to a human) can be golfed to the point of abscurity. Any proof longer than that should either be split (after which the first rule applies!) or it should have human readable comments explaining the proof structure in informal text, at least every few lines.</p>



<a name="309284160"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309284160" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309284160">(Nov 12 2022 at 02:16)</a>:</h4>
<p>I like this as a compromise as it gives authors considerable leeway in how they structure their work, but avoids the monolithic impenetrable proofs that we know can't be maintained.</p>



<a name="309343308"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309343308" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309343308">(Nov 12 2022 at 13:58)</a>:</h4>
<p>Adding to this, I think mathlib proofs aim to be at a higher level than just what comes after the <code>:=</code>, and instead it's in the statements of all the lemmas. It reminds me somewhat of the <a href="https://ncatlab.org/nlab/show/The+Rising+Sea">rising sea metaphor</a>.</p>



<a name="309362432"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309362432" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309362432">(Nov 12 2022 at 16:35)</a>:</h4>
<p>If we want mathlib proofs to be readable (using infoview) we should use more <code>rw</code> and less <code>simp</code> IMO.</p>



<a name="309377818"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309377818" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309377818">(Nov 12 2022 at 19:08)</a>:</h4>
<p>That unfortunately makes proofs longer and more brittle overall.</p>



<a name="309391081"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309391081" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309391081">(Nov 12 2022 at 21:49)</a>:</h4>
<p>I'm not certain about this. I feel like long rw chains are superficially more brittle (i.e. a little change will break them, in an easily fixed way), but a big <code>simp</code> can be traumatic to fix: it's robust to small changes, but then once it breaks you have little idea of how it was meant to be working.</p>



<a name="309392043"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309392043" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jireh Loreaux <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309392043">(Nov 12 2022 at 22:02)</a>:</h4>
<p>That should be less true of <code>simp</code> if we had a way to distinguish among <code>simp</code> lemmas vs. non-<code>simp</code> lemmas within the braces (i.e., with coloring) as we had discussed in the other thread, along with code folding (so that all <code>simp</code>s could be <code>simp only</code> under the hood).</p>



<a name="309437988"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309437988" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309437988">(Nov 13 2022 at 10:30)</a>:</h4>
<p><span class="user-mention silent" data-user-id="387244">Yaël Dillies</span> <a href="#narrow/stream/113488-general/topic/Pretty.20proofs.3F/near/309377818">said</a>:</p>
<blockquote>
<p>That unfortunately makes proofs longer and more brittle overall.</p>
</blockquote>
<p>Is the consensus that length and robustness are more important than readability then?</p>



<a name="309438543"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309438543" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309438543">(Nov 13 2022 at 10:38)</a>:</h4>
<p>When I read <code>simp only [foo, bar, baz],</code> I have no idea what happened (some magic probably).<br>
If someone writes <code>rw [foo, bar, foo, baz, foo],</code> instead, I click my mouse after each comma and see the transformation step by step.</p>



<a name="309438899"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309438899" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Michael Stoll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309438899">(Nov 13 2022 at 10:42)</a>:</h4>
<p>To bring in another aspect: is there any expected difference in efficiency between <code>rw [foo, bar, foo, baz, foo]</code> and <code>simp only [foo, bar, baz]</code>? (I assume <code>simp [foo, bar, baz]</code> would be less efficient, since it has to find the relevant lemmas first?)</p>



<a name="309439096"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309439096" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309439096">(Nov 13 2022 at 10:44)</a>:</h4>
<p>My intuition says <code>rw [foo, bar, foo, baz, foo],</code> must be more efficient, but my intuition has been wrong many times.</p>



<a name="309439110"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309439110" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309439110">(Nov 13 2022 at 10:44)</a>:</h4>
<p>Yes and no, because <code>simp</code> calls are much shorter, so take less parsing time. This is quite noticeable in very long lists of rewrite.</p>



<a name="309439120"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309439120" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309439120">(Nov 13 2022 at 10:44)</a>:</h4>
<p>Sometimes you don't get the choice; <code>rw foo</code> works sometimes where <code>simp only [foo]</code> doesn't, and vice versa</p>



<a name="309439748"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309439748" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Johnson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309439748">(Nov 13 2022 at 10:51)</a>:</h4>
<p><span class="user-mention silent" data-user-id="417654">Martin Dvořák</span> <a href="#narrow/stream/113488-general/topic/Pretty.20proofs.3F/near/309438543">said</a>:</p>
<blockquote>
<p>When I read <code>simp only [foo, bar, baz],</code> I have no idea what happened (some magic probably).</p>
</blockquote>
<p><code>set_option trace.simplify.rewrite true</code> can be helpful.</p>



<a name="309440873"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309440873" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Patrick Johnson <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309440873">(Nov 13 2022 at 11:03)</a>:</h4>
<p>Hm.. Seems like there is always 0 in the simp rewrite list numbering. For example:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">tactic</span>
<span class="kn">open</span> <span class="n">nat</span> <span class="n">set</span>
<span class="kd">set_option</span> <span class="n">trace.simplify.rewrite</span> <span class="n">true</span>
<span class="kd">example</span> <span class="o">:</span> <span class="mi">0</span> <span class="bp">∈</span> <span class="o">{</span><span class="mi">0</span><span class="o">}</span> <span class="bp">∪</span> <span class="n">range</span> <span class="n">succ</span> <span class="bp">↔</span> <span class="mi">0</span> <span class="bp">∈</span> <span class="bp">@</span><span class="n">univ</span> <span class="n">ℕ</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span>
</code></pre></div>
<p>Produces:</p>
<div class="codehilite" data-code-language="txt"><pre><span></span><code>0. [simplify.rewrite] [nat.range_succ]: range succ ==&gt; {i : ℕ | 0 &lt; i}
0. [simplify.rewrite] [set.singleton_union]: {0} ∪ set_of (has_lt.lt 0) ==&gt; insert 0 (set_of (has_lt.lt 0))
0. [simplify.rewrite] [set.mem_set_of_eq]: 0 ∈ set_of (has_lt.lt 0) ==&gt; 0 &lt; 0
0. [simplify.rewrite] [nat.not_lt_zero]: 0 &lt; 0 ==&gt; false
0. [simplify.rewrite] [set.mem_insert_iff]: 0 ∈ insert 0 (set_of (has_lt.lt 0)) ==&gt; 0 = 0 ∨ 0 ∈ set_of (has_lt.lt 0)
0. [simplify.rewrite] [eq_self_iff_true]: 0 = 0 ==&gt; true
0. [simplify.rewrite] [or_false]: true ∨ false ==&gt; true
0. [simplify.rewrite] [set.mem_univ]: 0 ∈ univ ==&gt; true
0. [simplify.rewrite] [iff_self]: true ↔ true ==&gt; true
</code></pre></div>
<p>Shouldn't it be <code>1. 2. 3. ...</code> instead of <code>0. 0. 0. ...</code>? Or do these <code>0</code>s stand for something else?</p>



<a name="309442963"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/309442963" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#309442963">(Nov 13 2022 at 11:26)</a>:</h4>
<p>Here's where that trace message is generated: <a href="https://github.com/leanprover-community/lean/blob/master/src/library/tactic/simplify.cpp#L523">https://github.com/leanprover-community/lean/blob/master/src/library/tactic/simplify.cpp#L523</a></p>
<p>If I understand things correctly, the number before the <code>.</code> gives the "depth" of the trace message, which keeps track of how deeply nested of a context the trace message comes from. So for <code>simplify.rewrite</code> there's no nesting of this type. <a href="https://github.com/leanprover-community/lean/blob/master/src/library/trace.cpp#L170">https://github.com/leanprover-community/lean/blob/master/src/library/trace.cpp#L170</a></p>



<a name="310210226"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310210226" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310210226">(Nov 15 2022 at 14:15)</a>:</h4>
<p>Do you think I use too much <code>rw</code>s?<br>
<a href="https://github.com/leanprover-community/mathlib/pull/17554/files">https://github.com/leanprover-community/mathlib/pull/17554/files</a><br>
Many people would probably prove these two lemmata by <code>simp</code>s.</p>



<a name="310210625"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310210625" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310210625">(Nov 15 2022 at 14:17)</a>:</h4>
<p>Are a lot of declaration used in <code>rw</code> tagged <code>simp</code>? I mean, if just <code>simp [foo]</code> is enough then it's probably better, but I don't see any problem with <code>rw</code>.</p>



<a name="310211965"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310211965" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310211965">(Nov 15 2022 at 14:23)</a>:</h4>
<p>I think they are all <code>simp</code> lemmas. Both proofs can be replaced by:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">begin</span>
  <span class="n">induction</span> <span class="n">L</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">},</span>
  <span class="o">{</span> <span class="n">simp</span> <span class="o">[</span><span class="n">L_ih</span><span class="o">]</span> <span class="o">},</span>
<span class="kd">end</span>
</code></pre></div>
<p>Do you think it is better to PR it with these <code>simp</code>s instead?</p>



<a name="310212462"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310212462" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310212462">(Nov 15 2022 at 14:25)</a>:</h4>
<p>Is the lemma obvious? Then <code>simp</code> is a pretty proof. You can probably just do</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">append_join_append</span> <span class="o">(</span><span class="n">L</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">list</span> <span class="n">α</span><span class="o">))</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">++</span> <span class="o">(</span><span class="n">list.map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">l</span><span class="o">,</span> <span class="n">l</span> <span class="bp">++</span> <span class="n">x</span><span class="o">)</span> <span class="n">L</span><span class="o">)</span><span class="bp">.</span><span class="n">join</span> <span class="bp">=</span> <span class="o">(</span><span class="n">list.map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">l</span><span class="o">,</span> <span class="n">x</span> <span class="bp">++</span> <span class="n">l</span><span class="o">)</span> <span class="n">L</span><span class="o">)</span><span class="bp">.</span><span class="n">join</span> <span class="bp">++</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">induction</span> <span class="n">L</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">}</span>
</code></pre></div>



<a name="310212650"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310212650" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310212650">(Nov 15 2022 at 14:26)</a>:</h4>
<p>It is obvious to me, yes.</p>



<a name="310212832"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310212832" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310212832">(Nov 15 2022 at 14:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/113488-general/topic/Pretty.20proofs.3F/near/310212462">said</a>:</p>
<blockquote>
<p>Is the lemma obvious? Then <code>simp</code> is a pretty proof. You can probably just do</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">append_join_append</span> <span class="o">(</span><span class="n">L</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">list</span> <span class="n">α</span><span class="o">))</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">++</span> <span class="o">(</span><span class="n">list.map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">l</span><span class="o">,</span> <span class="n">l</span> <span class="bp">++</span> <span class="n">x</span><span class="o">)</span> <span class="n">L</span><span class="o">)</span><span class="bp">.</span><span class="n">join</span> <span class="bp">=</span> <span class="o">(</span><span class="n">list.map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">l</span><span class="o">,</span> <span class="n">x</span> <span class="bp">++</span> <span class="n">l</span><span class="o">)</span> <span class="n">L</span><span class="o">)</span><span class="bp">.</span><span class="n">join</span> <span class="bp">++</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">induction</span> <span class="n">L</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">}</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Your code doesn't pass the induction hypothesis into the <code>simp</code> does it?</p>



<a name="310212900"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310212900" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310212900">(Nov 15 2022 at 14:27)</a>:</h4>
<p>The idea is that we don't care about readability of obvious results (meaning that no human will ever want to see the proof.</p>



<a name="310213794"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310213794" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310213794">(Nov 15 2022 at 14:32)</a>:</h4>
<p><span class="user-mention silent" data-user-id="417654">Martin Dvořák</span> <a href="#narrow/stream/113488-general/topic/Pretty.20proofs.3F/near/310212832">said</a>:</p>
<blockquote>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/113488-general/topic/Pretty.20proofs.3F/near/310212462">said</a>:</p>
<blockquote>
<p>Is the lemma obvious? Then <code>simp</code> is a pretty proof. You can probably just do</p>
<p><div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">append_join_append</span> <span class="o">(</span><span class="n">L</span> <span class="o">:</span> <span class="n">list</span> <span class="o">(</span><span class="n">list</span> <span class="n">α</span><span class="o">))</span> <span class="o">(</span><span class="n">x</span> <span class="o">:</span> <span class="n">list</span> <span class="n">α</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">x</span> <span class="bp">++</span> <span class="o">(</span><span class="n">list.map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">l</span><span class="o">,</span> <span class="n">l</span> <span class="bp">++</span> <span class="n">x</span><span class="o">)</span> <span class="n">L</span><span class="o">)</span><span class="bp">.</span><span class="n">join</span> <span class="bp">=</span> <span class="o">(</span><span class="n">list.map</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">l</span><span class="o">,</span> <span class="n">x</span> <span class="bp">++</span> <span class="n">l</span><span class="o">)</span> <span class="n">L</span><span class="o">)</span><span class="bp">.</span><span class="n">join</span> <span class="bp">++</span> <span class="n">x</span> <span class="o">:=</span>
<span class="kd">by</span> <span class="o">{</span> <span class="n">induction</span> <span class="n">L</span><span class="bp">;</span> <span class="n">simp</span> <span class="o">}</span>
</code></pre></div><br>
</p>
</blockquote>
<p>Your code doesn't pass the induction hypothesis into the <code>simp</code> does it?</p>
</blockquote>
<p>Ops: <code>by { induction L; simp * }</code></p>



<a name="310213841"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310213841" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310213841">(Nov 15 2022 at 14:32)</a>:</h4>
<p>I think the <code>rw</code>s are good here, as they make it obvious what the API is, and they make the proof less fragile</p>



<a name="310213894"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310213894" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310213894">(Nov 15 2022 at 14:32)</a>:</h4>
<p>If you've gone to the effort of finding the rewrites you may as well commit them</p>



<a name="310213995"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310213995" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310213995">(Nov 15 2022 at 14:32)</a>:</h4>
<p>It's a lot more annoying to move proofs between (or within) files if you don't know what lemmas the proof uses</p>



<a name="310227376"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310227376" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310227376">(Nov 15 2022 at 15:37)</a>:</h4>
<p>Surely the <code>rw</code> make the proof <em>more</em> fragile?</p>



<a name="310228220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310228220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Martin Dvořák <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310228220">(Nov 15 2022 at 15:41)</a>:</h4>
<p>I think <code>rw</code> makes it more likely to need a fix but easier to fix it when it happens.</p>



<a name="310228603"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/Pretty%20proofs%3F/near/310228603" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/Pretty.20proofs.3F.html#310228603">(Nov 15 2022 at 15:43)</a>:</h4>
<p><code>rw</code>s are also good at informing if the result you're looking for might already exist somewhere  else</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>