---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html">What should set.has_inv do?</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="271643067"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271643067" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271643067">(Feb 11 2022 at 21:53)</a>:</h4>
<p>Given the following setup</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">linear_algebra.matrix.nonsingular_inverse</span>
<span class="kn">import</span> <span class="n">algebra.pointwise</span>
<span class="n">open_locale</span> <span class="n">pointwise</span> <span class="n">cardinal</span>
</code></pre></div>
<p>and knowing that:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="bp">#↥</span><span class="o">(({</span><span class="mi">0</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="n">ℚ</span><span class="o">)</span><span class="bp">⁻¹</span><span class="o">)</span> <span class="bp">=</span> <span class="mi">1</span> <span class="o">:=</span> <span class="kd">by</span> <span class="n">simp</span> <span class="o">[</span><span class="n">set.inv_singleton</span><span class="o">]</span>
</code></pre></div>
<p>What would you expect right choice of <code>_</code> to be here?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">example</span> <span class="o">:</span> <span class="bp">#↥</span><span class="o">(({</span><span class="mi">0</span><span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">matrix</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="o">(</span><span class="n">fin</span> <span class="mi">2</span><span class="o">)</span> <span class="n">ℚ</span><span class="o">))</span><span class="bp">⁻¹</span><span class="o">)</span> <span class="bp">=</span> <span class="n">_</span> <span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="271643209"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271643209" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271643209">(Feb 11 2022 at 21:54)</a>:</h4>
<p>/poll What <em>should</em> the _ be?</p>
<ul>
<li>0</li>
<li>1</li>
<li>ω</li>
</ul>



<a name="271643321"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271643321" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271643321">(Feb 11 2022 at 21:55)</a>:</h4>
<div class="spoiler-block"><div class="spoiler-header">
</div><div class="spoiler-content" aria-hidden="true">
<p>It's currently the preimage of <code>inv</code> not the image like <code>*</code> is...</p>
</div></div>



<a name="271643419"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271643419" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271643419">(Feb 11 2022 at 21:56)</a>:</h4>
<p>Having it be the preimage is nice, right? at least when it's involutive...</p>



<a name="271644850"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271644850" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271644850">(Feb 11 2022 at 22:08)</a>:</h4>
<p>I think this operation should apply <code>has_inv.inv</code> to everything in the set.</p>



<a name="271644870"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271644870" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271644870">(Feb 11 2022 at 22:08)</a>:</h4>
<p>By default it should not exist unless someone has a use for it</p>



<a name="271644904"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271644904" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271644904">(Feb 11 2022 at 22:09)</a>:</h4>
<p>Yeah, that too.</p>



<a name="271645373"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271645373" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271645373">(Feb 11 2022 at 22:12)</a>:</h4>
<p>It's very common, e.g. in group theory, to write <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>S</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">S^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mo>⋅</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">g \cdot S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⋅</mo><mi>g</mi></mrow><annotation encoding="application/x-tex">S \cdot g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>⋅</mo><mi>S</mi></mrow><annotation encoding="application/x-tex">S \cdot S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>, etc., where <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> is a subset and <code>g</code> is an element of some group.</p>



<a name="271646026"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271646026" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Reid Barton <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271646026">(Feb 11 2022 at 22:17)</a>:</h4>
<p>Great, then give the instance a <code>group</code> constraint.</p>



<a name="271646184"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271646184" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271646184">(Feb 11 2022 at 22:18)</a>:</h4>
<p>Can we make something like this work in Lean4?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">variable</span> <span class="o">(</span><span class="n">G</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">Mul</span> <span class="n">G</span><span class="o">]</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">Monad</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">Mul</span> <span class="o">(</span><span class="n">M</span> <span class="n">G</span><span class="o">)</span> <span class="n">where</span>
  <span class="n">mul</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">return</span> <span class="o">(</span><span class="bp">←</span> <span class="n">a</span><span class="o">)</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">←</span> <span class="n">b</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">Monad</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">HMul</span> <span class="n">G</span> <span class="o">(</span><span class="n">M</span> <span class="n">G</span><span class="o">)</span> <span class="o">(</span><span class="n">M</span> <span class="n">G</span><span class="o">)</span> <span class="n">where</span>
  <span class="n">hMul</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">return</span> <span class="n">a</span> <span class="bp">*</span> <span class="o">(</span><span class="bp">←</span> <span class="n">b</span><span class="o">)</span>

<span class="kd">instance</span> <span class="o">(</span><span class="n">M</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u</span> <span class="bp">→</span> <span class="kt">Type</span> <span class="n">u</span><span class="o">)</span> <span class="o">[</span><span class="n">Monad</span> <span class="n">M</span><span class="o">]</span> <span class="o">:</span> <span class="n">HMul</span> <span class="o">(</span><span class="n">M</span> <span class="n">G</span><span class="o">)</span> <span class="n">G</span> <span class="o">(</span><span class="n">M</span> <span class="n">G</span><span class="o">)</span> <span class="n">where</span>
  <span class="n">hMul</span> <span class="n">a</span> <span class="n">b</span> <span class="o">:=</span> <span class="n">return</span> <span class="o">(</span><span class="bp">←</span> <span class="n">a</span><span class="o">)</span> <span class="bp">*</span> <span class="n">b</span>
</code></pre></div>
<p>This typechecks, but it is a good idea?</p>



<a name="271646984"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271646984" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271646984">(Feb 11 2022 at 22:27)</a>:</h4>
<p>Anyway, I think this is a perfectly reasonable instance:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">data.set.basic</span>
<span class="kd">instance</span> <span class="o">{</span><span class="n">α</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">has_inv</span> <span class="n">α</span><span class="o">]</span> <span class="o">:</span> <span class="n">has_inv</span> <span class="o">(</span><span class="n">set</span> <span class="n">α</span><span class="o">)</span> <span class="o">:=</span> <span class="o">⟨</span><span class="bp">λ</span> <span class="n">S</span><span class="o">,</span> <span class="o">(</span><span class="bp">λ</span> <span class="n">t</span> <span class="o">:</span> <span class="n">α</span><span class="o">,</span> <span class="n">t</span><span class="bp">⁻¹</span><span class="o">)</span> <span class="bp">''</span> <span class="n">S</span><span class="o">⟩</span>
</code></pre></div>



<a name="271655293"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271655293" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yury G. Kudryashov <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271655293">(Feb 12 2022 at 00:01)</a>:</h4>
<p><span class="user-mention silent" data-user-id="110032">Reid Barton</span> <a href="#narrow/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F/near/271644870">said</a>:</p>
<blockquote>
<p>By default it should not exist unless someone has a use for it</p>
</blockquote>
<p>You need to <code>open_locale pointwise</code> to have this and other instances.</p>



<a name="271659146"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/What%20should%20set.has_inv%20do%3F/near/271659146" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Adam Topaz <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/What.20should.20set.2Ehas_inv.20do.3F.html#271659146">(Feb 12 2022 at 01:02)</a>:</h4>
<p>Oh, I didn't know that existed.</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>