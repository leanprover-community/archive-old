---
layout: archive
title: Zulip Chat Archive
permalink: /stream/113488-general/topic/deterministic.20timeout.html
---

<h2>Stream: <a href="https://leanprover-community.github.io/archive/stream/113488-general/index.html">general</a></h2>
<h3>Topic: <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html">deterministic timeout</a></h3>

<hr>

<base href="https://leanprover.zulipchat.com/">

<head><link href="/style.css" rel="stylesheet"></head>

{% raw %}

<a name="128748875"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/128748875" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Zesen Qian <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#128748875">(Jun 28 2018 at 01:32)</a>:</h4>
<p>In general, how to solve "(deterministic) timeout" error?</p>



<a name="128749202"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/128749202" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Zesen Qian <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#128749202">(Jun 28 2018 at 01:45)</a>:</h4>
<p>I have tried increasing the timeout limit, so it must be my code.</p>



<a name="128751744"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/128751744" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Simon Hudon <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#128751744">(Jun 28 2018 at 03:10)</a>:</h4>
<p>Yes and it depends on the tactics that you use. Often, <code>simp</code> is the offender. When you give it a list of rules that do not converge, it will just keep going.</p>



<a name="244453107"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/244453107" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#244453107">(Jun 30 2021 at 16:45)</a>:</h4>
<p>I am working on a program verification project that automatically generates Lean files with large proofs. They use the simplifier in an essential way, and elaboration often takes on the order of 30 seconds or more.</p>
<p>Now I have a large proof that fails with a <code>deterministic timeout</code>. By manually breaking it into smaller proofs, I can get it to elaborate. By commenting out parts of the original proof, I can find the part that puts Lean over the edge. </p>
<p>I tried putting <code>set_option timeout 300000</code> before the proof (and using other big numbers), but it still fails at exactly the same place. Is there anything else I can do to get Lean to try harder? Or is it possible that the <code>deterministic timeout</code> message is standing proxy for some other problem?</p>



<a name="244454654"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/244454654" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Gabriel Ebner <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#244454654">(Jun 30 2021 at 16:56)</a>:</h4>
<p><code>set_option timeout</code> is completely ignored as far I can remember.  The timeout setting is set by a command line argument.  In vscode you can configure it using the <code>Lean: Time Limit</code> setting.</p>



<a name="244456936"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/244456936" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Jeremy Avigad <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#244456936">(Jun 30 2021 at 17:10)</a>:</h4>
<p>That worked! Many thanks.</p>



<a name="275939868"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/275939868" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#275939868">(Mar 20 2022 at 01:12)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/runs/5614214805?check_suite_focus=true">getting some</a> in <a href="https://github.com/leanprover-community/mathlib/pull/12836">#12836</a> which adds zero new <code>simp</code> lemmas - does anyone know what's going on? I'm trying to reerun CI as I can't reproduce locally</p>



<a name="275943526"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/275943526" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kyle Miller <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#275943526">(Mar 20 2022 at 02:59)</a>:</h4>
<p>On my machine, <code>set_option profiler true</code> for <a href="https://leanprover-community.github.io/mathlib_docs/find/topological_vector_bundle.trivialization.prod">docs#topological_vector_bundle.trivialization.prod</a> gives</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="mi">662</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">parsing</span> <span class="n">took</span> <span class="mi">373</span><span class="n">ms</span>

<span class="mi">662</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">elaboration</span> <span class="n">of</span> <span class="n">prod</span> <span class="n">took</span> <span class="mi">20</span><span class="bp">.</span><span class="mi">9</span><span class="n">s</span>

<span class="mi">662</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">type</span> <span class="n">checking</span> <span class="n">of</span> <span class="n">prod</span> <span class="n">took</span> <span class="mi">345</span><span class="n">ms</span>

<span class="mi">662</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">decl</span> <span class="n">post</span><span class="bp">-</span><span class="n">processing</span> <span class="n">of</span> <span class="n">prod</span> <span class="n">took</span> <span class="mi">344</span><span class="n">ms</span>
</code></pre></div>
<p>I don't know how the deterministic timeout system works, but 20.9s is pretty long and maybe you were just unlucky and by chance it timed out.</p>
<p>I wonder if it's worth splitting that definition up somehow so that it elaborates proofs and the definition separately.</p>



<a name="275961289"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/275961289" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Rodriguez <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#275961289">(Mar 20 2022 at 11:03)</a>:</h4>
<p>I re-ran and it went away, so it doesn't seem very deterministic :/ but maybe it's worth splitting up that proof anyways</p>



<a name="275994134"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/275994134" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oleksandr Manzyuk <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#275994134">(Mar 20 2022 at 23:50)</a>:</h4>
<p>A Lean n00b here.  I'm working through the exercises for LFTCM2020, which are a lot of fun!  (I was a mathematician before making a career switch 10 years ago and starting working as a software developer.  I've started picking up Lean recently as a hobby at the intersection of mathematics and computer science/type theory/functional programming.)  Unfortunately, once I've reached the exercises in category theory, things have become very slow and I often get "(deterministic) timeout", which significantly degrades the experience interacting with the theorem prover making it a lot less responsive and sometimes I simply don't know how to make progress because the obvious thing doesn't work.</p>
<p>For example, <a href="https://gist.github.com/manzyuk/495b9c45303d96d687c42302d518f44e">here</a> is my attempt at exercise 4.  At line 56, the goal is as follows:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">R</span> <span class="o">:</span> <span class="n">CommRing</span><span class="o">,</span>
<span class="n">f</span> <span class="o">:</span> <span class="o">(</span><span class="n">coyoneda.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">(</span><span class="n">CommRing.of</span> <span class="o">(</span><span class="n">polynomial</span> <span class="n">ℤ</span><span class="o">))))</span><span class="bp">.</span><span class="n">obj</span> <span class="n">R</span>
<span class="bp">⊢</span> <span class="n">eval₂</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">ℤ</span> <span class="bp">↥</span><span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">f.to_fun</span> <span class="n">X</span><span class="o">)</span> <span class="n">X</span> <span class="bp">=</span> <span class="n">f.to_fun</span> <span class="n">X</span>
</code></pre></div>
<p>which seems to match the <code>polynomial.eval₂_X</code> lemma, but applying or rewriting with it causes the dreaded deterministic timeout.  Does anyone have an idea what might be going on here?  Am I missing anything?</p>



<a name="275994770"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/275994770" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Thomas Browning <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#275994770">(Mar 21 2022 at 00:06)</a>:</h4>
<p>I have no idea why, but it seems that <code>hom := { app := λ R, λ r, polynomial.eval₂_ring_hom (algebra_map ℤ R) r },</code>is a major contributor to the timeout.</p>



<a name="276002671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/276002671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#276002671">(Mar 21 2022 at 03:24)</a>:</h4>
<p>If that's the case then probably it's because the tactic that automatically fils in the <code>naturality'</code> fields runs too slowly, and you might consider supplying an explicit proof.</p>
<p>You may also split out the individual fields <code>hom</code>, <code>inv</code> etc. as individual <code>def</code>s.</p>



<a name="276018384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/276018384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oleksandr Manzyuk <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#276018384">(Mar 21 2022 at 08:31)</a>:</h4>
<p>Thank you.  I suspected that the automation was to blame.  I'll try providing explicit proofs.  I'm curious what the approach to working with the category theory part of the library should be.  Should one begin by writing out every proof manually and then try and see which of those could be filled in by automation?  Or should one try to leave out as much as possible and only manually fill in the proofs that the automation is failing to provide?  I'm leaning towards the former option but I'm curious to hear about other people's experience with the category theory library.  (I was a category theorist in the previous life, and I was hoping to eventually contribute something to mathlib, e.g., formalisation of multicategories, so I'm trying to learn and understand how the existing category theory library is structured.)</p>



<a name="276020613"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/276020613" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#276020613">(Mar 21 2022 at 08:54)</a>:</h4>
<p>It seems like mostly the latter approach looking in from the outside</p>



<a name="276022876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/276022876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oleksandr Manzyuk <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#276022876">(Mar 21 2022 at 09:16)</a>:</h4>
<p>Interesting.  Filling in the proof of naturality of <code>hom</code> did indeed allow me to finish the proof of <code>inv_hom_id'</code> and complete the definition of <code>CommRing_forget_representable</code>.  At the moment, the proof of naturality also relies on automation but apparently fleshes out enough structure to prune the search?  I just did <code>intros R S f</code>, and then the goal is equality of two morphisms, so I used <code>ext</code>, which created two subgoals.  I tried to use <code>simp</code> to clean them up a little but it just solved them (after some crunching).  Once <code>simp</code> succeeded, is it useful to use <code>simp?</code> to get a list of simplification lemmas used and replace <code>simp</code> with <code>simp only [...]</code>?</p>



<a name="276023442"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/276023442" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Arthur Paulino <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#276023442">(Mar 21 2022 at 09:22)</a>:</h4>
<p>Yes, and you can also try <code>squeeze_simp</code>, which might be slower but gets it right more often</p>



<a name="276030236"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/276030236" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oleksandr Manzyuk <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#276030236">(Mar 21 2022 at 10:27)</a>:</h4>
<p><span class="user-mention silent" data-user-id="451983">Arthur Paulino</span> <a href="#narrow/stream/113488-general/topic/deterministic.20timeout/near/276023442">said</a>:</p>
<blockquote>
<p>Yes, and you can also try <code>squeeze_simp</code>, which might be slower but gets it right more often</p>
</blockquote>
<p>Thank you, I didn't know about <code>squeeze_simp</code>!  I tried to use it and  something amusing happened: when proving naturality of <code>hom</code>, after <code>intros R S f, ext r c</code>, the first goal is</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">RS</span><span class="o">:</span> <span class="n">CommRing</span>
<span class="n">f</span><span class="o">:</span> <span class="n">R</span> <span class="bp">⟶</span> <span class="n">S</span>
<span class="n">r</span><span class="o">:</span> <span class="o">(</span><span class="n">forget</span> <span class="n">CommRing</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">R</span>
<span class="n">c</span><span class="o">:</span> <span class="n">ℤ</span>
<span class="bp">⊢</span> <span class="bp">⇑</span><span class="o">(</span><span class="n">ring_hom.comp</span> <span class="o">(((</span><span class="n">forget</span> <span class="n">CommRing</span><span class="o">)</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span> <span class="bp">≫</span> <span class="bp">λ</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="o">(</span><span class="n">forget</span> <span class="n">CommRing</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">S</span><span class="o">),</span> <span class="n">eval₂_ring_hom</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">ℤ</span> <span class="bp">↥</span><span class="n">S</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span> <span class="n">C</span><span class="o">)</span> <span class="n">c</span> <span class="bp">=</span> <span class="bp">⇑</span><span class="o">(</span><span class="n">ring_hom.comp</span> <span class="o">(((</span><span class="bp">λ</span> <span class="o">(</span><span class="n">r</span> <span class="o">:</span> <span class="o">(</span><span class="n">forget</span> <span class="n">CommRing</span><span class="o">)</span><span class="bp">.</span><span class="n">obj</span> <span class="n">R</span><span class="o">),</span> <span class="n">eval₂_ring_hom</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">ℤ</span> <span class="bp">↥</span><span class="n">R</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span> <span class="bp">≫</span> <span class="o">(</span><span class="n">coyoneda.obj</span> <span class="o">(</span><span class="n">op</span> <span class="o">(</span><span class="n">CommRing.of</span> <span class="o">(</span><span class="n">polynomial</span> <span class="n">ℤ</span><span class="o">))))</span><span class="bp">.</span><span class="n">map</span> <span class="n">f</span><span class="o">)</span> <span class="n">r</span><span class="o">)</span> <span class="n">C</span><span class="o">)</span> <span class="n">c</span>
</code></pre></div>
<p>and <code>squeeze_simp</code> suggested <code>simp only [ring_hom.eq_int_cast]</code>.  My first thought when looking at that goal was "That's a mouthful, let me clean it up first to see what's going on."  So, I tried to insert <code>dsimp</code> before <code>simp only [ring_hom.eq_int_cast]</code>, and the proof stopped working!  It took me a while to realise that the original goal was of the form <code>⇑g c = ⇑h c</code>, where <code>g</code> and <code>h</code> are two homomorphisms from <code>ℤ</code>, so that <code>ring_hom.eq_int_cast</code> could be applied directly, whereas <code>dsimp</code> destroyed this property of the goal (even though it made it look simpler).</p>



<a name="276158907"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/276158907" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Scott Morrison <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#276158907">(Mar 22 2022 at 09:01)</a>:</h4>
<p>Unless I have some reason to be confident or optimistic that the automation will fill in fields, I tend to fill them in with sorries while I write the data fields (and any proof fields which I know will need human attention). After that, you can try deleting the sorried fields to see if automation handles them.</p>



<a name="276197220"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/276197220" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Oleksandr Manzyuk <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#276197220">(Mar 22 2022 at 14:33)</a>:</h4>
<p>Thank you very much, <span class="user-mention" data-user-id="110087">@Scott Morrison</span> I was hoping to hear your take on this.</p>



<a name="284381635"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284381635" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284381635">(May 30 2022 at 15:33)</a>:</h4>
<p>I'm getting one on Dedekind domains: <a href="https://github.com/leanprover-community/mathlib/pull/14442/files">https://github.com/leanprover-community/mathlib/pull/14442/files</a></p>



<a name="284383701"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284383701" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Anne Baanen <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284383701">(May 30 2022 at 15:51)</a>:</h4>
<p>This is probably related to <a href="#narrow/stream/116395-maths/topic/normalized_factors/near/284291719">https://leanprover.zulipchat.com/#narrow/stream/116395-maths/topic/normalized_factors/near/284291719</a>. I'd like to investigate this, but my schedule the coming week is very full...</p>



<a name="284950861"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284950861" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284950861">(Jun 04 2022 at 02:03)</a>:</h4>
<p>Hasn't been fixed, and it's affecting various of my PRs</p>



<a name="284950908"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284950908" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284950908">(Jun 04 2022 at 02:04)</a>:</h4>
<p>This is the lemma in question: </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">ideal.count_normalized_factors_eq</span> <span class="o">{</span><span class="n">p</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">hp0</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="bp">⊥</span><span class="o">)</span> <span class="o">[</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p.is_prime</span><span class="o">]</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hle</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">p</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hlt</span> <span class="o">:</span> <span class="bp">¬</span> <span class="o">(</span><span class="n">x</span> <span class="bp">≤</span> <span class="n">p</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)))</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">normalized_factors</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">count</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="n">count_normalized_factors_eq</span> <span class="o">((</span><span class="n">ideal.prime_iff_is_prime</span> <span class="n">hp0</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">hp</span><span class="o">)</span><span class="bp">.</span><span class="n">irreducible</span> <span class="o">(</span><span class="n">normalize_eq</span> <span class="n">_</span><span class="o">)</span>
  <span class="o">(</span><span class="n">ideal.dvd_iff_le.mpr</span> <span class="n">hle</span><span class="o">)</span> <span class="o">(</span><span class="n">mt</span> <span class="n">ideal.le_of_dvd</span> <span class="n">hlt</span><span class="o">)</span>
</code></pre></div>



<a name="284950913"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284950913" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284950913">(Jun 04 2022 at 02:05)</a>:</h4>
<p>I have no idea how to golf this, it looks very concise?</p>



<a name="284950922"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284950922" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284950922">(Jun 04 2022 at 02:05)</a>:</h4>
<p>I have no idea why it's even timing out</p>



<a name="284951037"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284951037" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284951037">(Jun 04 2022 at 02:08)</a>:</h4>
<p>This is purely term-mode, right? So why does it take so long?</p>



<a name="284957166"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284957166" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284957166">(Jun 04 2022 at 04:19)</a>:</h4>
<p>And why do unrelated changes push it over the edge? It's not like this is calling some simp lemma or whatever</p>



<a name="284959629"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284959629" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284959629">(Jun 04 2022 at 05:15)</a>:</h4>
<p>I do not know the source of the timeout, but I would start looking at instance searches, if you've added typeclasses.</p>
<p>Regarding term-mode: such proofs tend to be faster, but that is not a rule.  I've seen situations where a lemma application form in term mode times out, but <code>by apply &lt;same lemma&gt;</code> works instantly.  Again, I think that it usually has to do with instance search.</p>



<a name="284959714"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284959714" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284959714">(Jun 04 2022 at 05:17)</a>:</h4>
<p>Try seeing if <code>by apply/exact/convert</code> make the lemma faster.  Sometimes it works...</p>



<a name="284960080"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960080" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960080">(Jun 04 2022 at 05:27)</a>:</h4>
<p>None of them seem to make it significantly faster</p>



<a name="284960082"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960082" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960082">(Jun 04 2022 at 05:27)</a>:</h4>
<p>In fact, <code>apply</code> and <code>convert</code> cause it to time-out on <code>master</code></p>



<a name="284960326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960326">(Jun 04 2022 at 05:35)</a>:</h4>
<p>By testing with a few sorries, it seems like all of the three arguments take up a lot of the runtime</p>



<a name="284960448"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960448" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960448">(Jun 04 2022 at 05:38)</a>:</h4>
<p>By the way, is it intentional that we have the hypotheses <code>(hle : x ≤ p^n)</code> and <code>(hlt : ¬ (x ≤ p^(n+1)))</code>? These seem to imply <code>p &lt; 1</code> which seems weird, but I don't know what ideal exponentiation nor comparison is supposed to be so...</p>



<a name="284960538"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960538" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960538">(Jun 04 2022 at 05:40)</a>:</h4>
<p>(not to mention, <code>hlt</code> should be written <code>p^(n+1) &lt; x</code> instead)</p>



<a name="284960607"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960607" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Ruben Van de Velde <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960607">(Jun 04 2022 at 05:42)</a>:</h4>
<p>I \le J means J dvd I, iirc</p>



<a name="284960671"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960671" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960671">(Jun 04 2022 at 05:44)</a>:</h4>
<p>What happens if you fill in the hole?</p>



<a name="284960672"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960672" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960672">(Jun 04 2022 at 05:44)</a>:</h4>
<p>Which in turn should mean contain.  You can probably interpret the order as containment of sets.</p>



<a name="284960738"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960738" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960738">(Jun 04 2022 at 05:46)</a>:</h4>
<p>If the timeout is due to <code>zero_le_one_class</code>, then I would look for typeclass issues having to do with the order.</p>



<a name="284960890"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284960890" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Damiano Testa <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284960890">(Jun 04 2022 at 05:50)</a>:</h4>
<blockquote>
<p>(not to mention, <code>hlt</code> should be written <code>p^(n+1) &lt; x</code> instead)</p>
</blockquote>
<p>I'm not sure that follows: the order is not linear.  It is more like the order on <code>order_dual (set α)</code>.</p>



<a name="284996536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284996536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284996536">(Jun 04 2022 at 19:43)</a>:</h4>
<p>Yet another one of my PRs, a very big one no less, has succumbed to this same timeout</p>



<a name="284996552"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284996552" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284996552">(Jun 04 2022 at 19:43)</a>:</h4>
<p>I wonder if the best solution here is to make the last three arguments into separate private lemmas</p>



<a name="284996555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/284996555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#284996555">(Jun 04 2022 at 19:43)</a>:</h4>
<p>I'm not familiar with the file, so I don't know if these lemmas are anything of standalone interest</p>



<a name="285248854"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285248854" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285248854">(Jun 07 2022 at 13:18)</a>:</h4>
<p><code>convert ideal.dvd_iff_le.mpr hle</code> seems faster than <code>exact</code></p>



<a name="285248921"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285248921" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285248921">(Jun 07 2022 at 13:18)</a>:</h4>
<p>same for <code>convert mt ideal.le_of_dvd hlt</code></p>



<a name="285250056"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285250056" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285250056">(Jun 07 2022 at 13:27)</a>:</h4>
<p>potential diamond?</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">type</span> <span class="n">mismatch</span> <span class="n">at</span> <span class="n">application</span>
  <span class="n">normalize_eq</span>
<span class="n">term</span>
  <span class="n">ideal.unique_units</span>
<span class="n">has</span> <span class="n">type</span>
  <span class="n">unique</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span> <span class="bp">?</span><span class="n">m_1</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_semiring.to_semiring</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">?</span><span class="n">m_2</span><span class="o">))</span><span class="bp">ˣ</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span>
<span class="n">but</span> <span class="n">is</span> <span class="n">expected</span> <span class="n">to</span> <span class="k">have</span> <span class="n">type</span>
  <span class="n">unique</span> <span class="o">(</span><span class="bp">@</span><span class="n">ideal</span> <span class="bp">?</span><span class="n">m_1</span> <span class="o">(</span><span class="bp">@</span><span class="n">ring.to_semiring</span> <span class="bp">?</span><span class="n">m_1</span> <span class="o">(</span><span class="bp">@</span><span class="n">comm_ring.to_ring</span> <span class="bp">?</span><span class="n">m_1</span> <span class="bp">?</span><span class="n">m_2</span><span class="o">)))</span><span class="bp">ˣ</span> <span class="o">:</span> <span class="kt">Type</span> <span class="bp">?</span>
</code></pre></div>



<a name="285250095"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285250095" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285250095">(Jun 07 2022 at 13:27)</a>:</h4>
<p>from </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">ideal.count_normalized_factors_eq</span> <span class="o">{</span><span class="n">p</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">hp0</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="bp">⊥</span><span class="o">)</span> <span class="o">[</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p.is_prime</span><span class="o">]</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hle</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">p</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hlt</span> <span class="o">:</span> <span class="bp">¬</span> <span class="o">(</span><span class="n">x</span> <span class="bp">≤</span> <span class="n">p</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)))</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">normalized_factors</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">count</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">count_normalized_factors_eq</span> <span class="o">((</span><span class="n">ideal.prime_iff_is_prime</span> <span class="n">hp0</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">hp</span><span class="o">)</span><span class="bp">.</span><span class="n">irreducible</span><span class="o">,</span>
  <span class="n">apply</span> <span class="bp">@</span><span class="n">normalize_eq</span> <span class="n">_</span> <span class="n">ideal.cancel_comm_monoid_with_zero</span> <span class="n">ideal.unique_units</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>



<a name="285251595"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285251595" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285251595">(Jun 07 2022 at 13:39)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">ideal.count_normalized_factors_eq</span> <span class="o">{</span><span class="n">p</span> <span class="n">x</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">}</span> <span class="o">(</span><span class="n">hp0</span> <span class="o">:</span> <span class="n">p</span> <span class="bp">≠</span> <span class="bp">⊥</span><span class="o">)</span> <span class="o">[</span><span class="n">hp</span> <span class="o">:</span> <span class="n">p.is_prime</span><span class="o">]</span> <span class="o">{</span><span class="n">n</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">}</span>
  <span class="o">(</span><span class="n">hle</span> <span class="o">:</span> <span class="n">x</span> <span class="bp">≤</span> <span class="n">p</span><span class="bp">^</span><span class="n">n</span><span class="o">)</span> <span class="o">(</span><span class="n">hlt</span> <span class="o">:</span> <span class="bp">¬</span> <span class="o">(</span><span class="n">x</span> <span class="bp">≤</span> <span class="n">p</span><span class="bp">^</span><span class="o">(</span><span class="n">n</span><span class="bp">+</span><span class="mi">1</span><span class="o">)))</span> <span class="o">:</span>
  <span class="o">(</span><span class="n">normalized_factors</span> <span class="n">x</span><span class="o">)</span><span class="bp">.</span><span class="n">count</span> <span class="n">p</span> <span class="bp">=</span> <span class="n">n</span> <span class="o">:=</span>
<span class="kd">begin</span>
  <span class="n">apply</span> <span class="n">count_normalized_factors_eq</span> <span class="o">((</span><span class="n">ideal.prime_iff_is_prime</span> <span class="n">hp0</span><span class="o">)</span><span class="bp">.</span><span class="n">mpr</span> <span class="n">hp</span><span class="o">)</span><span class="bp">.</span><span class="n">irreducible</span><span class="o">,</span>
  <span class="o">{</span> <span class="n">haveI</span> <span class="o">:</span> <span class="n">unique</span> <span class="o">(</span><span class="n">ideal</span> <span class="n">R</span><span class="o">)</span><span class="bp">ˣ</span> <span class="o">:=</span> <span class="n">ideal.unique_units</span><span class="o">,</span> <span class="n">apply</span> <span class="n">normalize_eq</span> <span class="o">},</span>
  <span class="n">convert</span> <span class="n">ideal.dvd_iff_le.mpr</span> <span class="n">hle</span><span class="o">,</span>
  <span class="n">convert</span> <span class="n">mt</span> <span class="n">ideal.le_of_dvd</span> <span class="n">hlt</span><span class="o">,</span>
<span class="kd">end</span>
</code></pre></div>
<p>This seems fast enough (1-2s), so I'm gonna PR it! <a href="https://github.com/leanprover-community/mathlib/pull/14590">#14590</a></p>



<a name="285263261"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285263261" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285263261">(Jun 07 2022 at 14:56)</a>:</h4>
<p>Doesn't look like a diamond in the usual sense, lean just can't guess what ring you're talking about.</p>



<a name="285792556"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285792556" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285792556">(Jun 11 2022 at 18:48)</a>:</h4>
<p>Does anyone know what's up with <a href="https://github.com/leanprover-community/mathlib/pull/14683">#14683</a>? I'm getting a timeout on <a href="https://leanprover-community.github.io/mathlib_docs/find/intermediate_field.intermediate_field_map">docs#intermediate_field.intermediate_field_map</a>. It's <code>decls post-processing</code> that takes 39s and nothing I tried did anything.</p>



<a name="285796581"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285796581" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285796581">(Jun 11 2022 at 20:33)</a>:</h4>
<p>Update, I'm htting it in <a href="https://github.com/leanprover-community/mathlib/pull/14686">#14686</a> as well <span aria-label="confused" class="emoji emoji-1f615" role="img" title="confused">:confused:</span></p>



<a name="285839503"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285839503" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285839503">(Jun 12 2022 at 12:25)</a>:</h4>
<p>Remove <code>@[simps]</code>: compiles in an instant<br>
Use <code>@[simps] noncomputable!</code>: decl post-processing of intermediate_field_map took 19.5s</p>



<a name="285839533"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285839533" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285839533">(Jun 12 2022 at 12:25)</a>:</h4>
<p><span class="user-mention" data-user-id="387244">@Yaël Dillies</span></p>



<a name="285839540"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285839540" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285839540">(Jun 12 2022 at 12:25)</a>:</h4>
<p><code>noncomputable!</code> still timed out for me <span aria-label="thinking" class="emoji emoji-1f914" role="img" title="thinking">:thinking:</span></p>



<a name="285839555"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285839555" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285839555">(Jun 12 2022 at 12:26)</a>:</h4>
<p>Can you see what <code>simps</code> generates? <code>simps?</code> timed out as well for me.</p>



<a name="285839803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285839803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285839803">(Jun 12 2022 at 12:31)</a>:</h4>
<p>generated with <code>[simps?] noncomputable!</code></p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="o">[</span><span class="n">simps</span><span class="o">]</span> <span class="bp">&gt;</span> <span class="n">The</span> <span class="n">given</span> <span class="kd">definition</span> <span class="n">is</span> <span class="n">not</span> <span class="n">a</span> <span class="n">constructor</span> <span class="n">application</span><span class="o">:</span>
        <span class="bp">&gt;</span>   <span class="n">e.subalgebra_map</span> <span class="n">E.to_subalgebra</span>
        <span class="bp">&gt;</span> <span class="n">Retrying</span> <span class="k">with</span> <span class="n">the</span> <span class="n">options</span> <span class="o">{</span> <span class="n">rhs_md</span> <span class="o">:=</span> <span class="n">semireducible</span><span class="o">,</span> <span class="n">simp_rhs</span> <span class="o">:=</span> <span class="n">tt</span><span class="o">}</span><span class="bp">.</span>
<span class="o">[</span><span class="n">simps</span><span class="o">]</span> <span class="bp">&gt;</span> <span class="n">adding</span> <span class="n">projection</span> <span class="n">intermediate_field.intermediate_field_map_apply_coe</span><span class="o">:</span>
        <span class="bp">&gt;</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">{</span><span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">[</span><span class="n">_inst_1</span> <span class="o">:</span> <span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_2</span> <span class="o">:</span> <span class="n">field</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_3</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span>
<span class="o">{</span><span class="n">L'</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_3</span><span class="o">}</span> <span class="o">[</span><span class="n">_inst_4</span> <span class="o">:</span> <span class="n">field</span> <span class="n">L'</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_5</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">K</span> <span class="n">L'</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">L</span> <span class="bp">≃ₐ</span><span class="o">[</span><span class="n">K</span><span class="o">]</span> <span class="n">L'</span><span class="o">)</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="n">intermediate_field</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span>
<span class="o">(</span><span class="n">ᾰ</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">E.to_subalgebra.to_subsemiring</span><span class="o">)),</span> <span class="bp">↑</span><span class="o">(</span><span class="bp">⇑</span><span class="o">(</span><span class="n">intermediate_field_map</span> <span class="n">e</span> <span class="n">E</span><span class="o">)</span> <span class="n">ᾰ</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">⇑</span><span class="n">e</span> <span class="bp">↑</span><span class="n">ᾰ</span>
<span class="o">[</span><span class="n">simps</span><span class="o">]</span> <span class="bp">&gt;</span> <span class="n">adding</span> <span class="n">projection</span> <span class="n">intermediate_field.intermediate_field_map_symm_apply_coe</span><span class="o">:</span>
        <span class="bp">&gt;</span> <span class="bp">∀</span> <span class="o">{</span><span class="n">K</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_1</span><span class="o">}</span> <span class="o">{</span><span class="n">L</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_2</span><span class="o">}</span> <span class="o">[</span><span class="n">_inst_1</span> <span class="o">:</span> <span class="n">field</span> <span class="n">K</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_2</span> <span class="o">:</span> <span class="n">field</span> <span class="n">L</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_3</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">K</span> <span class="n">L</span><span class="o">]</span>
<span class="o">{</span><span class="n">L'</span> <span class="o">:</span> <span class="kt">Type</span> <span class="n">u_3</span><span class="o">}</span> <span class="o">[</span><span class="n">_inst_4</span> <span class="o">:</span> <span class="n">field</span> <span class="n">L'</span><span class="o">]</span> <span class="o">[</span><span class="n">_inst_5</span> <span class="o">:</span> <span class="n">algebra</span> <span class="n">K</span> <span class="n">L'</span><span class="o">]</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">L</span> <span class="bp">≃ₐ</span><span class="o">[</span><span class="n">K</span><span class="o">]</span> <span class="n">L'</span><span class="o">)</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="n">intermediate_field</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span>
<span class="o">(</span><span class="n">ᾰ</span> <span class="o">:</span> <span class="bp">↥</span><span class="o">(</span><span class="n">subsemiring.map</span> <span class="n">e.to_ring_equiv.to_ring_hom</span> <span class="n">E.to_subalgebra.to_subsemiring</span><span class="o">)),</span>
  <span class="bp">↑</span><span class="o">(</span><span class="bp">⇑</span><span class="o">((</span><span class="n">intermediate_field_map</span> <span class="n">e</span> <span class="n">E</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span><span class="o">)</span> <span class="n">ᾰ</span><span class="o">)</span> <span class="bp">=</span> <span class="bp">⇑</span><span class="o">(</span><span class="bp">↑↑</span><span class="n">e.symm</span><span class="o">)</span> <span class="bp">↑</span><span class="n">ᾰ</span>
</code></pre></div>



<a name="285840070"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285840070" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285840070">(Jun 12 2022 at 12:37)</a>:</h4>
<p>Sorry, it seems <code>decl post-processing of intermediate_field_map</code> takes 18-20s on my machine no matter whether there's <code>noncomputable!</code> or not, and <code>[simps?]</code> gives the same output. But I do get a deterministic timeout without the <code>noncomputable!</code>. So it seems <code>@[simps]</code> takes 18-20s, and <del>computability related stuff (VM code generation?) takes much longer and yields a timeout</del>. But why removing <code>@[simps]</code> makes it instant? There should still be VM code generation, no?</p>



<a name="285840275"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285840275" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285840275">(Jun 12 2022 at 12:40)</a>:</h4>
<p>Anyway, it's easy enough to add the two auto-generated simp lemmas manually.</p>



<a name="285843985"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285843985" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285843985">(Jun 12 2022 at 13:55)</a>:</h4>
<p>I increased time limit so that the timeout goes away, and it seems it just take 1-2 more seconds (19-20s total) for the whole declaration to compile.</p>



<a name="285845035"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285845035" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285845035">(Jun 12 2022 at 14:17)</a>:</h4>
<p>Do you mind filing the fix as a PR?</p>



<a name="285847905"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285847905" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285847905">(Jun 12 2022 at 15:25)</a>:</h4>
<p>I'll attend <a href="https://mathemalchemy.org/">this exhibition</a> this afternoon (leaving in 1 hour) and don't have the time at the moment. You are welcome to submit the PR! So we've decided to go with the manual simp lemmas approach?</p>



<a name="285850420"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285850420" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285850420">(Jun 12 2022 at 16:31)</a>:</h4>
<p>I've got some time to work out the proper forms of the two auto-generated simp lemmas in the context, but I'm leaving soon!</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">lemma</span> <span class="n">intermediate_field_map_apply_coe</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">L</span> <span class="bp">≃ₐ</span><span class="o">[</span><span class="n">K</span><span class="o">]</span> <span class="n">L'</span><span class="o">)</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="n">intermediate_field</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span> <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">E</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">↑</span><span class="o">(</span><span class="n">intermediate_field_map</span> <span class="n">e</span> <span class="n">E</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">e</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span>

<span class="kd">lemma</span> <span class="n">intermediate_field_map_symm_apply_coe</span> <span class="o">(</span><span class="n">e</span> <span class="o">:</span> <span class="n">L</span> <span class="bp">≃ₐ</span><span class="o">[</span><span class="n">K</span><span class="o">]</span> <span class="n">L'</span><span class="o">)</span> <span class="o">(</span><span class="n">E</span> <span class="o">:</span> <span class="n">intermediate_field</span> <span class="n">K</span> <span class="n">L</span><span class="o">)</span>
  <span class="o">(</span><span class="n">a</span> <span class="o">:</span> <span class="n">subsemiring.map</span> <span class="n">e.to_ring_equiv.to_ring_hom</span> <span class="n">E.to_subalgebra.to_subsemiring</span><span class="o">)</span> <span class="o">:</span>
  <span class="bp">↑</span><span class="o">((</span><span class="n">intermediate_field_map</span> <span class="n">e</span> <span class="n">E</span><span class="o">)</span><span class="bp">.</span><span class="n">symm</span> <span class="n">a</span><span class="o">)</span> <span class="bp">=</span> <span class="n">e.symm</span> <span class="n">a</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>



<a name="285850483"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285850483" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285850483">(Jun 12 2022 at 16:33)</a>:</h4>
<p>Is the second one really ever going to fire?</p>



<a name="285881350"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285881350" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285881350">(Jun 13 2022 at 04:46)</a>:</h4>
<p>I don't know if it's going to fire but it looks like a reasonable simp lemma. I just pushed to <a href="https://github.com/leanprover-community/mathlib/tree/intermediate_field_map_timeout">branch#intermediate_field_map_timeout</a> without <code>simp</code> attribute on either lemma to see if and where they fire.</p>
<p>On master, removing the <code>simps</code> from <code>intermediate_field_map</code>also reduces <br>
<code>decl post-processing of intermediate_field_map</code> from 18.3s to 46.4ms on my machine.</p>



<a name="285881489"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/285881489" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#285881489">(Jun 13 2022 at 04:50)</a>:</h4>
<p>Seems the <a href="https://github.com/leanprover-community/mathlib/runs/6855281685?check_suite_focus=true">build already succeded in 4m 53s...</a></p>



<a name="286011708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/286011708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#286011708">(Jun 14 2022 at 02:00)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/14725">#14725</a></p>



<a name="286712536"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/286712536" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Yaël Dillies <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#286712536">(Jun 19 2022 at 14:27)</a>:</h4>
<p>Yet <a href="https://github.com/leanprover-community/mathlib/runs/6943776118?check_suite_focus=true">another timeout</a> in <a href="https://tqft.net/mathlib/algebraic_geometry/function_field">file#algebraic_geometry/function_field</a> this time. It's <a href="https://leanprover-community.github.io/mathlib_docs/find/algebraic_geometry.function_field.algebra">docs#algebraic_geometry.function_field.algebra</a>. Any idea?</p>



<a name="286714162"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/286714162" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#286714162">(Jun 19 2022 at 15:00)</a>:</h4>
<p>first observation: <code>apply structure_sheaf.to_stalk R</code> is about 2x faster (11.1s) than <code>exact structure_sheaf.to_stalk R _</code> (29.3s). Will try to speed up it further.</p>
<p>Interestingly <code>convert structure_sheaf.to_stalk R _</code> (11.3s) is similar to <code>apply</code> (but probably bad for building data instance).</p>



<a name="286716299"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/286716299" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#286716299">(Jun 19 2022 at 15:46)</a>:</h4>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="n">ring_hom.to_algebra</span> <span class="bp">$</span> <span class="kd">by</span> <span class="o">{</span> <span class="n">change</span> <span class="n">CommRing.of</span> <span class="n">R</span> <span class="bp">⟶</span> <span class="n">_</span><span class="o">,</span> <span class="n">apply</span> <span class="n">structure_sheaf.to_stalk</span> <span class="o">}</span>
</code></pre></div>
<p>about 0.4s now!</p>



<a name="286716704"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/286716704" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#286716704">(Jun 19 2022 at 15:57)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/14830">#14830</a></p>



<a name="286996731"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/286996731" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#286996731">(Jun 22 2022 at 02:23)</a>:</h4>
<p>One of my PRs is getting a timeout on <a href="https://leanprover-community.github.io/mathlib_docs/find/exterior_algebra.graded_algebra">docs#exterior_algebra.graded_algebra</a></p>



<a name="286996734"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/286996734" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#286996734">(Jun 22 2022 at 02:23)</a>:</h4>
<p><span class="user-mention" data-user-id="310045">@Eric Wieser</span></p>



<a name="287034630"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287034630" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287034630">(Jun 22 2022 at 10:39)</a>:</h4>
<p>Which PR?</p>



<a name="287037708"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287037708" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287037708">(Jun 22 2022 at 11:13)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/14884">#14884</a></p>



<a name="287441563"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287441563" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287441563">(Jun 25 2022 at 15:37)</a>:</h4>
<p>Got this on <a href="https://github.com/leanprover-community/mathlib/pull/14707">#14707</a> too</p>



<a name="287441575"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287441575" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Violeta Hernández <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287441575">(Jun 25 2022 at 15:37)</a>:</h4>
<p>I'm not at all familiar with this API or even the math here</p>



<a name="287444512"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287444512" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287444512">(Jun 25 2022 at 16:47)</a>:</h4>
<p>I guess this might have been made worse by the <code>exterior_algebra R M = clifford_algebra 0</code> refactor</p>



<a name="287444579"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287444579" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287444579">(Jun 25 2022 at 16:49)</a>:</h4>
<p>Does replacing either begin/end block with sorry help?</p>



<a name="287473395"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287473395" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287473395">(Jun 26 2022 at 05:14)</a>:</h4>
<p>No, it's typechecking <code>graded_algebra.ι R M</code> that is slow.</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">by</span> <span class="o">{</span> <span class="n">fapply</span> <span class="n">graded_algebra.of_alg_hom</span><span class="o">,</span> <span class="n">apply</span> <span class="n">lift</span> <span class="n">_</span> <span class="n">_</span><span class="o">,</span> <span class="n">fsplit</span><span class="o">,</span> <span class="n">convert</span> <span class="n">graded_algebra.ι</span> <span class="n">R</span> <span class="n">M</span> <span class="o">}</span>
</code></pre></div>
<p>is very fast, but we certainly don't want to convert data ...</p>



<a name="287473458"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287473458" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287473458">(Jun 26 2022 at 05:16)</a>:</h4>
<p>It's weird that the types look exactly the same but <code>exact</code> takes so long (10+ seconds) ...</p>



<a name="287475076"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287475076" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287475076">(Jun 26 2022 at 06:04)</a>:</h4>
<p>It seems Lean is spending time checking the following defeq:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">algebra.direct_sum.algebra</span>
<span class="kn">import</span> <span class="n">algebra.direct_sum.internal</span>

<span class="n">open_locale</span> <span class="n">direct_sum</span>
<span class="kd">example</span> <span class="o">{</span><span class="n">S</span> <span class="n">R</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_semiring</span> <span class="n">S</span><span class="o">]</span> <span class="o">[</span><span class="n">semiring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">algebra</span> <span class="n">S</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">p</span> <span class="o">:</span> <span class="n">submodule</span> <span class="n">S</span> <span class="n">R</span><span class="o">)</span> <span class="o">:</span>
  <span class="n">non_unital_non_assoc_semiring.to_add_comm_monoid</span> <span class="o">(</span><span class="bp">⨁</span> <span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">,</span> <span class="bp">↥</span><span class="o">(</span><span class="n">p</span> <span class="bp">^</span> <span class="n">i</span><span class="o">))</span> <span class="bp">=</span>
  <span class="n">direct_sum.add_comm_monoid</span> <span class="n">_</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">rfl</span>
</code></pre></div>
<p>This <code>rfl</code> is fast (typechecking 15ms, elaboration 200ms), but maybe Lean is unfolding too much in the exterior algebra situation.<br>
(cf. <a href="https://leanprover-community.github.io/mathlib_docs/find/submodule.nat_power_graded_monoid">docs#submodule.nat_power_graded_monoid</a>, <a href="https://leanprover-community.github.io/mathlib_docs/find/direct_sum.algebra">docs#direct_sum.algebra</a> )</p>



<a name="287475198"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287475198" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287475198">(Jun 26 2022 at 06:07)</a>:</h4>
<p>Wow, <code>let := graded_algebra.ι R M, exact this, </code> is also super fast! Why is it different from <code>exact graded_algebra.ι R M</code>??<br>
I see the produced term is different:</p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code> <span class="n">exact</span> <span class="k">let</span> <span class="n">this</span> <span class="o">:</span> <span class="n">M</span> <span class="bp">→ₗ</span><span class="o">[</span><span class="n">R</span><span class="o">]</span> <span class="bp">⨁</span> <span class="o">(</span><span class="n">i</span> <span class="o">:</span> <span class="n">ℕ</span><span class="o">),</span> <span class="bp">↥</span><span class="o">((</span><span class="n">ι</span> <span class="n">R</span><span class="o">)</span><span class="bp">.</span><span class="n">range</span> <span class="bp">^</span> <span class="n">i</span><span class="o">)</span> <span class="o">:=</span> <span class="n">graded_algebra.ι</span> <span class="n">R</span> <span class="n">M</span>
<span class="k">in</span> <span class="n">this</span>
</code></pre></div>



<a name="287475264"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287475264" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Kevin Buzzard <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287475264">(Jun 26 2022 at 06:08)</a>:</h4>
<p>With the <code>let</code> version, laan is free to let the type be whatever it wants, so unification is happening in a different order</p>



<a name="287475331"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287475331" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287475331">(Jun 26 2022 at 06:10)</a>:</h4>
<p>I hope terms lilke <code>exact let this : ... in this</code> won't pose much an annoyance? If so then maybe that's the solution to be PR'd...</p>



<a name="287475387"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287475387" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287475387">(Jun 26 2022 at 06:12)</a>:</h4>
<p>Or maybe there's some easy <code>change</code> that can be inserted ..</p>



<a name="287475886"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287475886" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287475886">(Jun 26 2022 at 06:27)</a>:</h4>
<p>OK, <code>apply</code> works, as easy as that!</p>



<a name="287477069"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287477069" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287477069">(Jun 26 2022 at 06:59)</a>:</h4>
<p>Another fix needs to be applied to the proofs: <code>graded_algebra.ι_apply</code> needs to be replaced by <code>graded_algebra.ι_apply R M</code> at two places (reduces from 10-12s to 3s).</p>



<a name="287478676"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287478676" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Junyan Xu <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287478676">(Jun 26 2022 at 07:38)</a>:</h4>
<p><a href="https://github.com/leanprover-community/mathlib/pull/14967">#14967</a></p>



<a name="287480384"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287480384" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287480384">(Jun 26 2022 at 08:18)</a>:</h4>
<p>Thanks!</p>



<a name="287951071"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287951071" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Eric Wieser <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287951071">(Jun 29 2022 at 22:47)</a>:</h4>
<p>A new one in <a href="https://tqft.net/mathlib/number_theory/cyclotomic/primitive_roots">file#number_theory/cyclotomic/primitive_roots</a> here (and some other builds): <a href="https://github.com/leanprover-community/mathlib/runs/7120067385?check_suite_focus=true#step:6:12">https://github.com/leanprover-community/mathlib/runs/7120067385?check_suite_focus=true#step:6:12</a></p>



<a name="287953651"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/287953651" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#287953651">(Jun 29 2022 at 23:14)</a>:</h4>
<p>I am going to sleep now, but I bet this is caused by <code>simps</code>.</p>



<a name="288002181"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/288002181" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#288002181">(Jun 30 2022 at 09:54)</a>:</h4>
<p>I'm running into a timeout on <a href="https://github.com/leanprover-community/mathlib/pull/15000">#15000</a> when working with polynomial rings. An mwe would be something like </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kn">import</span> <span class="n">ring_theory.dedekind_domain.ideal</span>
<span class="kn">import</span> <span class="n">ring_theory.ideal.operations</span>
<span class="kn">import</span> <span class="n">ring_theory.polynomial.basic</span>
<span class="kn">import</span> <span class="n">ring_theory.unique_factorization_domain</span>

<span class="kn">open</span> <span class="n">ideal</span> <span class="n">polynomial</span> <span class="n">unique_factorization_monoid</span>
<span class="n">open_locale</span> <span class="n">classical</span>

<span class="kd">variables</span> <span class="o">{</span><span class="n">R</span> <span class="o">:</span> <span class="kt">Type</span><span class="bp">*</span><span class="o">}</span> <span class="o">[</span><span class="n">comm_ring</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_domain</span> <span class="n">R</span><span class="o">]</span>  <span class="o">[</span><span class="n">is_dedekind_domain</span> <span class="n">R</span><span class="o">]</span>

<span class="kd">noncomputable</span> <span class="kd">instance</span> <span class="o">{</span><span class="n">I</span><span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">}</span> <span class="o">[</span><span class="n">hI</span> <span class="o">:</span> <span class="n">is_maximal</span><span class="o">]</span>  <span class="o">:</span> <span class="n">field</span> <span class="o">(</span><span class="n">R</span> <span class="bp">⧸</span> <span class="n">I</span><span class="o">)</span> <span class="o">:=</span>
 <span class="o">((</span><span class="n">ideal.quotient.maximal_ideal_iff_is_field_quotient</span> <span class="n">I</span><span class="o">)</span><span class="bp">.</span><span class="n">mp</span> <span class="n">hI</span><span class="o">)</span><span class="bp">.</span><span class="n">to_field</span>

<span class="c1">--deterministic timeout</span>
<span class="kd">def</span> <span class="n">problematic_definition</span> <span class="o">{</span><span class="n">I</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">}</span>  <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span>
 <span class="o">(</span><span class="n">hI</span> <span class="o">:</span> <span class="n">is_maximal</span> <span class="n">I</span><span class="o">)</span> <span class="o">:</span>
  <span class="o">{</span><span class="n">J</span> <span class="o">:</span> <span class="n">ideal</span> <span class="o">(</span><span class="n">polynomial</span> <span class="bp">$</span> <span class="n">R</span> <span class="bp">⧸</span> <span class="n">I</span> <span class="o">)</span> <span class="bp">|</span>
    <span class="n">J</span> <span class="bp">∈</span> <span class="n">normalized_factors</span> <span class="o">(</span><span class="n">ideal.span</span> <span class="o">({</span> <span class="n">map</span> <span class="n">I</span><span class="bp">^.</span><span class="n">quotient.mk</span> <span class="n">f</span> <span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">polynomial</span> <span class="bp">$</span> <span class="n">R</span> <span class="bp">⧸</span> <span class="n">I</span><span class="o">)))</span> <span class="o">}</span>
<span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>
<p>The issue seems to come from <code>normalized_factors</code>, since removing it makes the statement work fine. <br>
For context, I am trying to construct an <code>equiv</code> of the form </p>
<div class="codehilite" data-code-language="Lean"><pre><span></span><code><span class="kd">def</span> <span class="n">normalized_factors_equiv</span> <span class="o">[</span><span class="n">is_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">[</span><span class="n">is_dedekind_domain</span> <span class="n">R</span><span class="o">]</span> <span class="o">(</span><span class="n">f</span> <span class="o">:</span> <span class="n">polynomial</span> <span class="n">R</span><span class="o">)</span> <span class="o">(</span><span class="n">I</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">R</span><span class="o">)</span>
  <span class="o">(</span><span class="n">hI</span> <span class="o">:</span> <span class="n">is_prime</span> <span class="n">I</span><span class="o">)</span> <span class="o">(</span><span class="n">hI'</span> <span class="o">:</span> <span class="n">I</span>  <span class="bp">≠</span> <span class="bp">⊥</span> <span class="o">)</span> <span class="o">:</span>
  <span class="o">{</span><span class="n">J</span> <span class="o">:</span> <span class="n">ideal</span> <span class="n">S</span> <span class="bp">|</span> <span class="n">J</span> <span class="bp">∈</span> <span class="n">normalized_factors</span> <span class="o">(</span><span class="n">I.map</span> <span class="o">(</span><span class="n">algebra_map</span> <span class="n">R</span> <span class="n">S</span><span class="o">))</span> <span class="o">}</span> <span class="bp">≃</span>
  <span class="o">{</span><span class="n">J</span> <span class="o">:</span> <span class="n">ideal</span> <span class="o">(</span><span class="n">polynomial</span> <span class="bp">$</span> <span class="n">R</span> <span class="bp">⧸</span> <span class="n">I</span> <span class="o">)</span> <span class="bp">|</span>
    <span class="n">J</span> <span class="bp">∈</span> <span class="n">normalized_factors</span> <span class="o">(</span><span class="n">ideal.span</span> <span class="o">({</span> <span class="n">map</span> <span class="n">I</span><span class="bp">^.</span><span class="n">quotient.mk</span> <span class="n">f</span> <span class="o">}</span> <span class="o">:</span> <span class="n">set</span> <span class="o">(</span><span class="n">polynomial</span> <span class="bp">$</span> <span class="n">R</span> <span class="bp">⧸</span> <span class="n">I</span><span class="o">)))</span> <span class="o">}</span>
<span class="o">:=</span> <span class="gr">sorry</span>
</code></pre></div>



<a name="288002517"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/288002517" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#288002517">(Jun 30 2022 at 09:57)</a>:</h4>
<p>Does anyone know what might be causing this?</p>



<a name="288005251"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/288005251" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Alex J. Best <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#288005251">(Jun 30 2022 at 10:21)</a>:</h4>
<p>Did you try adding <code>noncomputable! def</code>?</p>



<a name="288008383"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/288008383" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#288008383">(Jun 30 2022 at 10:50)</a>:</h4>
<p>I'll try that now!</p>



<a name="288009876"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/288009876" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Riccardo Brasca <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#288009876">(Jun 30 2022 at 11:05)</a>:</h4>
<p>You can also make it a <code>lemma</code> until it is <code>sorry</code> free, this sometimes helps.</p>



<a name="288010326"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/288010326" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#288010326">(Jun 30 2022 at 11:10)</a>:</h4>
<p>The <code>noncomputable! def</code> fix worked, thanks !</p>



<a name="288010477"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/288010477" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Paul Lezeau <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#288010477">(Jun 30 2022 at 11:11)</a>:</h4>
<p><span class="user-mention silent" data-user-id="130384">Riccardo Brasca</span> <a href="#narrow/stream/113488-general/topic/deterministic.20timeout/near/288009876">said</a>:</p>
<blockquote>
<p>You can also make it a <code>lemma</code> until it is <code>sorry</code> free, this sometimes helps.</p>
</blockquote>
<p>I'll keep that in mind!</p>



<a name="307883429"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/307883429" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#307883429">(Nov 04 2022 at 04:45)</a>:</h4>
<p>Sorry, stupid question time: how do I increase the time limit in VSCode, the tips and tricks say there is a setting Lean Time Limit, but <code>ctrl+shift+p</code> and <code>Lean: Time Limit</code> does not work</p>



<a name="307883506"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/307883506" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#307883506">(Nov 04 2022 at 04:46)</a>:</h4>
<p>less stupid question: why does <code>squeeze_simp</code> take so much longer than <code>simp</code>?</p>



<a name="307883934"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/307883934" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Moritz Doll <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#307883934">(Nov 04 2022 at 04:51)</a>:</h4>
<p>answer to first question is <code>ctrl+,</code> and then searching for lean time limit</p>



<a name="307905550"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/307905550" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#307905550">(Nov 04 2022 at 08:38)</a>:</h4>
<p>It should be "Settings (<code>ctrl+,</code>) -&gt; search for <code>lean time limit</code>"</p>



<a name="307905601"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/307905601" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#307905601">(Nov 04 2022 at 08:39)</a>:</h4>
<p>(please also make a PR to tips and tricks fixing the tip)</p>



<a name="307905755"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/307905755" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#307905755">(Nov 04 2022 at 08:40)</a>:</h4>
<p>I believe <code>squeeze_simp</code> does some work after the <code>simp</code> is done minimizing the list lemmas it found (maybe it rewrote with <code>foo</code>, but the <code>simp</code> will result in the same state if <code>foo</code> was never applied).</p>



<a name="307905803"></a>
<h4><a href="https://leanprover.zulipchat.com/#narrow/stream/113488-general/topic/deterministic%20timeout/near/307905803" class="zl"><img src="https://leanprover-community.github.io/archive/assets/img/zulip2.png" alt="view this post on Zulip"></a> Floris van Doorn <a href="https://leanprover-community.github.io/archive/stream/113488-general/topic/deterministic.20timeout.html#307905803">(Nov 04 2022 at 08:40)</a>:</h4>
<p>Oh, I should have read your third message before answering your first :-)</p>



{% endraw %}

<hr><p>Last updated: Jan 25 2023 at 00:06 UTC</p>